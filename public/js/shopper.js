/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/@alpinejs/focus/dist/module.esm.js":
/*!*********************************************************!*\
  !*** ./node_modules/@alpinejs/focus/dist/module.esm.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ module_default)
/* harmony export */ });
// node_modules/tabbable/dist/index.esm.js
var candidateSelectors = ["input", "select", "textarea", "a[href]", "button", "[tabindex]", "audio[controls]", "video[controls]", '[contenteditable]:not([contenteditable="false"])', "details>summary:first-of-type", "details"];
var candidateSelector = /* @__PURE__ */ candidateSelectors.join(",");
var matches = typeof Element === "undefined" ? function() {
} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
var getCandidates = function getCandidates2(el, includeContainer, filter) {
  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));
  if (includeContainer && matches.call(el, candidateSelector)) {
    candidates.unshift(el);
  }
  candidates = candidates.filter(filter);
  return candidates;
};
var isContentEditable = function isContentEditable2(node) {
  return node.contentEditable === "true";
};
var getTabindex = function getTabindex2(node) {
  var tabindexAttr = parseInt(node.getAttribute("tabindex"), 10);
  if (!isNaN(tabindexAttr)) {
    return tabindexAttr;
  }
  if (isContentEditable(node)) {
    return 0;
  }
  if ((node.nodeName === "AUDIO" || node.nodeName === "VIDEO" || node.nodeName === "DETAILS") && node.getAttribute("tabindex") === null) {
    return 0;
  }
  return node.tabIndex;
};
var sortOrderedTabbables = function sortOrderedTabbables2(a, b) {
  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;
};
var isInput = function isInput2(node) {
  return node.tagName === "INPUT";
};
var isHiddenInput = function isHiddenInput2(node) {
  return isInput(node) && node.type === "hidden";
};
var isDetailsWithSummary = function isDetailsWithSummary2(node) {
  var r = node.tagName === "DETAILS" && Array.prototype.slice.apply(node.children).some(function(child) {
    return child.tagName === "SUMMARY";
  });
  return r;
};
var getCheckedRadio = function getCheckedRadio2(nodes, form) {
  for (var i = 0; i < nodes.length; i++) {
    if (nodes[i].checked && nodes[i].form === form) {
      return nodes[i];
    }
  }
};
var isTabbableRadio = function isTabbableRadio2(node) {
  if (!node.name) {
    return true;
  }
  var radioScope = node.form || node.ownerDocument;
  var queryRadios = function queryRadios2(name) {
    return radioScope.querySelectorAll('input[type="radio"][name="' + name + '"]');
  };
  var radioSet;
  if (typeof window !== "undefined" && typeof window.CSS !== "undefined" && typeof window.CSS.escape === "function") {
    radioSet = queryRadios(window.CSS.escape(node.name));
  } else {
    try {
      radioSet = queryRadios(node.name);
    } catch (err) {
      console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s", err.message);
      return false;
    }
  }
  var checked = getCheckedRadio(radioSet, node.form);
  return !checked || checked === node;
};
var isRadio = function isRadio2(node) {
  return isInput(node) && node.type === "radio";
};
var isNonTabbableRadio = function isNonTabbableRadio2(node) {
  return isRadio(node) && !isTabbableRadio(node);
};
var isHidden = function isHidden2(node, displayCheck) {
  if (getComputedStyle(node).visibility === "hidden") {
    return true;
  }
  var isDirectSummary = matches.call(node, "details>summary:first-of-type");
  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;
  if (matches.call(nodeUnderDetails, "details:not([open]) *")) {
    return true;
  }
  if (!displayCheck || displayCheck === "full") {
    while (node) {
      if (getComputedStyle(node).display === "none") {
        return true;
      }
      node = node.parentElement;
    }
  } else if (displayCheck === "non-zero-area") {
    var _node$getBoundingClie = node.getBoundingClientRect(), width = _node$getBoundingClie.width, height = _node$getBoundingClie.height;
    return width === 0 && height === 0;
  }
  return false;
};
var isDisabledFromFieldset = function isDisabledFromFieldset2(node) {
  if (isInput(node) || node.tagName === "SELECT" || node.tagName === "TEXTAREA" || node.tagName === "BUTTON") {
    var parentNode = node.parentElement;
    while (parentNode) {
      if (parentNode.tagName === "FIELDSET" && parentNode.disabled) {
        for (var i = 0; i < parentNode.children.length; i++) {
          var child = parentNode.children.item(i);
          if (child.tagName === "LEGEND") {
            if (child.contains(node)) {
              return false;
            }
            return true;
          }
        }
        return true;
      }
      parentNode = parentNode.parentElement;
    }
  }
  return false;
};
var isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable2(options, node) {
  if (node.disabled || isHiddenInput(node) || isHidden(node, options.displayCheck) || // For a details element with a summary, the summary element gets the focus
  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {
    return false;
  }
  return true;
};
var isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable2(options, node) {
  if (!isNodeMatchingSelectorFocusable(options, node) || isNonTabbableRadio(node) || getTabindex(node) < 0) {
    return false;
  }
  return true;
};
var tabbable = function tabbable2(el, options) {
  options = options || {};
  var regularTabbables = [];
  var orderedTabbables = [];
  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));
  candidates.forEach(function(candidate, i) {
    var candidateTabindex = getTabindex(candidate);
    if (candidateTabindex === 0) {
      regularTabbables.push(candidate);
    } else {
      orderedTabbables.push({
        documentOrder: i,
        tabIndex: candidateTabindex,
        node: candidate
      });
    }
  });
  var tabbableNodes = orderedTabbables.sort(sortOrderedTabbables).map(function(a) {
    return a.node;
  }).concat(regularTabbables);
  return tabbableNodes;
};
var focusable = function focusable2(el, options) {
  options = options || {};
  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));
  return candidates;
};
var focusableCandidateSelector = /* @__PURE__ */ candidateSelectors.concat("iframe").join(",");
var isFocusable = function isFocusable2(node, options) {
  options = options || {};
  if (!node) {
    throw new Error("No node provided");
  }
  if (matches.call(node, focusableCandidateSelector) === false) {
    return false;
  }
  return isNodeMatchingSelectorFocusable(options, node);
};

// node_modules/focus-trap/dist/focus-trap.esm.js
function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);
  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) {
      symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    }
    keys.push.apply(keys, symbols);
  }
  return keys;
}
function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    if (i % 2) {
      ownKeys(Object(source), true).forEach(function(key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }
  return target;
}
function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
var activeFocusTraps = function() {
  var trapQueue = [];
  return {
    activateTrap: function activateTrap(trap) {
      if (trapQueue.length > 0) {
        var activeTrap = trapQueue[trapQueue.length - 1];
        if (activeTrap !== trap) {
          activeTrap.pause();
        }
      }
      var trapIndex = trapQueue.indexOf(trap);
      if (trapIndex === -1) {
        trapQueue.push(trap);
      } else {
        trapQueue.splice(trapIndex, 1);
        trapQueue.push(trap);
      }
    },
    deactivateTrap: function deactivateTrap(trap) {
      var trapIndex = trapQueue.indexOf(trap);
      if (trapIndex !== -1) {
        trapQueue.splice(trapIndex, 1);
      }
      if (trapQueue.length > 0) {
        trapQueue[trapQueue.length - 1].unpause();
      }
    }
  };
}();
var isSelectableInput = function isSelectableInput2(node) {
  return node.tagName && node.tagName.toLowerCase() === "input" && typeof node.select === "function";
};
var isEscapeEvent = function isEscapeEvent2(e) {
  return e.key === "Escape" || e.key === "Esc" || e.keyCode === 27;
};
var isTabEvent = function isTabEvent2(e) {
  return e.key === "Tab" || e.keyCode === 9;
};
var delay = function delay2(fn) {
  return setTimeout(fn, 0);
};
var findIndex = function findIndex2(arr, fn) {
  var idx = -1;
  arr.every(function(value, i) {
    if (fn(value)) {
      idx = i;
      return false;
    }
    return true;
  });
  return idx;
};
var valueOrHandler = function valueOrHandler2(value) {
  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    params[_key - 1] = arguments[_key];
  }
  return typeof value === "function" ? value.apply(void 0, params) : value;
};
var createFocusTrap = function createFocusTrap2(elements, userOptions) {
  var doc = document;
  var config = _objectSpread2({
    returnFocusOnDeactivate: true,
    escapeDeactivates: true,
    delayInitialFocus: true
  }, userOptions);
  var state = {
    // @type {Array<HTMLElement>}
    containers: [],
    // list of objects identifying the first and last tabbable nodes in all containers/groups in
    //  the trap
    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap
    //  is active, but the trap should never get to a state where there isn't at least one group
    //  with at least one tabbable node in it (that would lead to an error condition that would
    //  result in an error being thrown)
    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}
    tabbableGroups: [],
    nodeFocusedBeforeActivation: null,
    mostRecentlyFocusedNode: null,
    active: false,
    paused: false,
    // timer ID for when delayInitialFocus is true and initial focus in this trap
    //  has been delayed during activation
    delayInitialFocusTimer: void 0
  };
  var trap;
  var getOption = function getOption2(configOverrideOptions, optionName, configOptionName) {
    return configOverrideOptions && configOverrideOptions[optionName] !== void 0 ? configOverrideOptions[optionName] : config[configOptionName || optionName];
  };
  var containersContain = function containersContain2(element) {
    return state.containers.some(function(container) {
      return container.contains(element);
    });
  };
  var getNodeForOption = function getNodeForOption2(optionName) {
    var optionValue = config[optionName];
    if (!optionValue) {
      return null;
    }
    var node = optionValue;
    if (typeof optionValue === "string") {
      node = doc.querySelector(optionValue);
      if (!node) {
        throw new Error("`".concat(optionName, "` refers to no known node"));
      }
    }
    if (typeof optionValue === "function") {
      node = optionValue();
      if (!node) {
        throw new Error("`".concat(optionName, "` did not return a node"));
      }
    }
    return node;
  };
  var getInitialFocusNode = function getInitialFocusNode2() {
    var node;
    if (getOption({}, "initialFocus") === false) {
      return false;
    }
    if (getNodeForOption("initialFocus") !== null) {
      node = getNodeForOption("initialFocus");
    } else if (containersContain(doc.activeElement)) {
      node = doc.activeElement;
    } else {
      var firstTabbableGroup = state.tabbableGroups[0];
      var firstTabbableNode = firstTabbableGroup && firstTabbableGroup.firstTabbableNode;
      node = firstTabbableNode || getNodeForOption("fallbackFocus");
    }
    if (!node) {
      throw new Error("Your focus-trap needs to have at least one focusable element");
    }
    return node;
  };
  var updateTabbableNodes = function updateTabbableNodes2() {
    state.tabbableGroups = state.containers.map(function(container) {
      var tabbableNodes = tabbable(container);
      if (tabbableNodes.length > 0) {
        return {
          container,
          firstTabbableNode: tabbableNodes[0],
          lastTabbableNode: tabbableNodes[tabbableNodes.length - 1]
        };
      }
      return void 0;
    }).filter(function(group) {
      return !!group;
    });
    if (state.tabbableGroups.length <= 0 && !getNodeForOption("fallbackFocus")) {
      throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");
    }
  };
  var tryFocus = function tryFocus2(node) {
    if (node === false) {
      return;
    }
    if (node === doc.activeElement) {
      return;
    }
    if (!node || !node.focus) {
      tryFocus2(getInitialFocusNode());
      return;
    }
    node.focus({
      preventScroll: !!config.preventScroll
    });
    state.mostRecentlyFocusedNode = node;
    if (isSelectableInput(node)) {
      node.select();
    }
  };
  var getReturnFocusNode = function getReturnFocusNode2(previousActiveElement) {
    var node = getNodeForOption("setReturnFocus");
    return node ? node : previousActiveElement;
  };
  var checkPointerDown = function checkPointerDown2(e) {
    if (containersContain(e.target)) {
      return;
    }
    if (valueOrHandler(config.clickOutsideDeactivates, e)) {
      trap.deactivate({
        // if, on deactivation, we should return focus to the node originally-focused
        //  when the trap was activated (or the configured `setReturnFocus` node),
        //  then assume it's also OK to return focus to the outside node that was
        //  just clicked, causing deactivation, as long as that node is focusable;
        //  if it isn't focusable, then return focus to the original node focused
        //  on activation (or the configured `setReturnFocus` node)
        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,
        //  which will result in the outside click setting focus to the node
        //  that was clicked, whether it's focusable or not; by setting
        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused
        //  on activation (or the configured `setReturnFocus` node)
        returnFocus: config.returnFocusOnDeactivate && !isFocusable(e.target)
      });
      return;
    }
    if (valueOrHandler(config.allowOutsideClick, e)) {
      return;
    }
    e.preventDefault();
  };
  var checkFocusIn = function checkFocusIn2(e) {
    var targetContained = containersContain(e.target);
    if (targetContained || e.target instanceof Document) {
      if (targetContained) {
        state.mostRecentlyFocusedNode = e.target;
      }
    } else {
      e.stopImmediatePropagation();
      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());
    }
  };
  var checkTab = function checkTab2(e) {
    updateTabbableNodes();
    var destinationNode = null;
    if (state.tabbableGroups.length > 0) {
      var containerIndex = findIndex(state.tabbableGroups, function(_ref) {
        var container = _ref.container;
        return container.contains(e.target);
      });
      if (containerIndex < 0) {
        if (e.shiftKey) {
          destinationNode = state.tabbableGroups[state.tabbableGroups.length - 1].lastTabbableNode;
        } else {
          destinationNode = state.tabbableGroups[0].firstTabbableNode;
        }
      } else if (e.shiftKey) {
        var startOfGroupIndex = findIndex(state.tabbableGroups, function(_ref2) {
          var firstTabbableNode = _ref2.firstTabbableNode;
          return e.target === firstTabbableNode;
        });
        if (startOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === e.target) {
          startOfGroupIndex = containerIndex;
        }
        if (startOfGroupIndex >= 0) {
          var destinationGroupIndex = startOfGroupIndex === 0 ? state.tabbableGroups.length - 1 : startOfGroupIndex - 1;
          var destinationGroup = state.tabbableGroups[destinationGroupIndex];
          destinationNode = destinationGroup.lastTabbableNode;
        }
      } else {
        var lastOfGroupIndex = findIndex(state.tabbableGroups, function(_ref3) {
          var lastTabbableNode = _ref3.lastTabbableNode;
          return e.target === lastTabbableNode;
        });
        if (lastOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === e.target) {
          lastOfGroupIndex = containerIndex;
        }
        if (lastOfGroupIndex >= 0) {
          var _destinationGroupIndex = lastOfGroupIndex === state.tabbableGroups.length - 1 ? 0 : lastOfGroupIndex + 1;
          var _destinationGroup = state.tabbableGroups[_destinationGroupIndex];
          destinationNode = _destinationGroup.firstTabbableNode;
        }
      }
    } else {
      destinationNode = getNodeForOption("fallbackFocus");
    }
    if (destinationNode) {
      e.preventDefault();
      tryFocus(destinationNode);
    }
  };
  var checkKey = function checkKey2(e) {
    if (isEscapeEvent(e) && valueOrHandler(config.escapeDeactivates) !== false) {
      e.preventDefault();
      trap.deactivate();
      return;
    }
    if (isTabEvent(e)) {
      checkTab(e);
      return;
    }
  };
  var checkClick = function checkClick2(e) {
    if (valueOrHandler(config.clickOutsideDeactivates, e)) {
      return;
    }
    if (containersContain(e.target)) {
      return;
    }
    if (valueOrHandler(config.allowOutsideClick, e)) {
      return;
    }
    e.preventDefault();
    e.stopImmediatePropagation();
  };
  var addListeners = function addListeners2() {
    if (!state.active) {
      return;
    }
    activeFocusTraps.activateTrap(trap);
    state.delayInitialFocusTimer = config.delayInitialFocus ? delay(function() {
      tryFocus(getInitialFocusNode());
    }) : tryFocus(getInitialFocusNode());
    doc.addEventListener("focusin", checkFocusIn, true);
    doc.addEventListener("mousedown", checkPointerDown, {
      capture: true,
      passive: false
    });
    doc.addEventListener("touchstart", checkPointerDown, {
      capture: true,
      passive: false
    });
    doc.addEventListener("click", checkClick, {
      capture: true,
      passive: false
    });
    doc.addEventListener("keydown", checkKey, {
      capture: true,
      passive: false
    });
    return trap;
  };
  var removeListeners = function removeListeners2() {
    if (!state.active) {
      return;
    }
    doc.removeEventListener("focusin", checkFocusIn, true);
    doc.removeEventListener("mousedown", checkPointerDown, true);
    doc.removeEventListener("touchstart", checkPointerDown, true);
    doc.removeEventListener("click", checkClick, true);
    doc.removeEventListener("keydown", checkKey, true);
    return trap;
  };
  trap = {
    activate: function activate(activateOptions) {
      if (state.active) {
        return this;
      }
      var onActivate = getOption(activateOptions, "onActivate");
      var onPostActivate = getOption(activateOptions, "onPostActivate");
      var checkCanFocusTrap = getOption(activateOptions, "checkCanFocusTrap");
      if (!checkCanFocusTrap) {
        updateTabbableNodes();
      }
      state.active = true;
      state.paused = false;
      state.nodeFocusedBeforeActivation = doc.activeElement;
      if (onActivate) {
        onActivate();
      }
      var finishActivation = function finishActivation2() {
        if (checkCanFocusTrap) {
          updateTabbableNodes();
        }
        addListeners();
        if (onPostActivate) {
          onPostActivate();
        }
      };
      if (checkCanFocusTrap) {
        checkCanFocusTrap(state.containers.concat()).then(finishActivation, finishActivation);
        return this;
      }
      finishActivation();
      return this;
    },
    deactivate: function deactivate(deactivateOptions) {
      if (!state.active) {
        return this;
      }
      clearTimeout(state.delayInitialFocusTimer);
      state.delayInitialFocusTimer = void 0;
      removeListeners();
      state.active = false;
      state.paused = false;
      activeFocusTraps.deactivateTrap(trap);
      var onDeactivate = getOption(deactivateOptions, "onDeactivate");
      var onPostDeactivate = getOption(deactivateOptions, "onPostDeactivate");
      var checkCanReturnFocus = getOption(deactivateOptions, "checkCanReturnFocus");
      if (onDeactivate) {
        onDeactivate();
      }
      var returnFocus = getOption(deactivateOptions, "returnFocus", "returnFocusOnDeactivate");
      var finishDeactivation = function finishDeactivation2() {
        delay(function() {
          if (returnFocus) {
            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));
          }
          if (onPostDeactivate) {
            onPostDeactivate();
          }
        });
      };
      if (returnFocus && checkCanReturnFocus) {
        checkCanReturnFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation)).then(finishDeactivation, finishDeactivation);
        return this;
      }
      finishDeactivation();
      return this;
    },
    pause: function pause() {
      if (state.paused || !state.active) {
        return this;
      }
      state.paused = true;
      removeListeners();
      return this;
    },
    unpause: function unpause() {
      if (!state.paused || !state.active) {
        return this;
      }
      state.paused = false;
      updateTabbableNodes();
      addListeners();
      return this;
    },
    updateContainerElements: function updateContainerElements(containerElements) {
      var elementsAsArray = [].concat(containerElements).filter(Boolean);
      state.containers = elementsAsArray.map(function(element) {
        return typeof element === "string" ? doc.querySelector(element) : element;
      });
      if (state.active) {
        updateTabbableNodes();
      }
      return this;
    }
  };
  trap.updateContainerElements(elements);
  return trap;
};

// packages/focus/src/index.js
function src_default(Alpine) {
  let lastFocused;
  let currentFocused;
  window.addEventListener("focusin", () => {
    lastFocused = currentFocused;
    currentFocused = document.activeElement;
  });
  Alpine.magic("focus", (el) => {
    let within = el;
    return {
      __noscroll: false,
      __wrapAround: false,
      within(el2) {
        within = el2;
        return this;
      },
      withoutScrolling() {
        this.__noscroll = true;
        return this;
      },
      noscroll() {
        this.__noscroll = true;
        return this;
      },
      withWrapAround() {
        this.__wrapAround = true;
        return this;
      },
      wrap() {
        return this.withWrapAround();
      },
      focusable(el2) {
        return isFocusable(el2);
      },
      previouslyFocused() {
        return lastFocused;
      },
      lastFocused() {
        return lastFocused;
      },
      focused() {
        return currentFocused;
      },
      focusables() {
        if (Array.isArray(within))
          return within;
        return focusable(within, { displayCheck: "none" });
      },
      all() {
        return this.focusables();
      },
      isFirst(el2) {
        let els = this.all();
        return els[0] && els[0].isSameNode(el2);
      },
      isLast(el2) {
        let els = this.all();
        return els.length && els.slice(-1)[0].isSameNode(el2);
      },
      getFirst() {
        return this.all()[0];
      },
      getLast() {
        return this.all().slice(-1)[0];
      },
      getNext() {
        let list = this.all();
        let current = document.activeElement;
        if (list.indexOf(current) === -1)
          return;
        if (this.__wrapAround && list.indexOf(current) === list.length - 1) {
          return list[0];
        }
        return list[list.indexOf(current) + 1];
      },
      getPrevious() {
        let list = this.all();
        let current = document.activeElement;
        if (list.indexOf(current) === -1)
          return;
        if (this.__wrapAround && list.indexOf(current) === 0) {
          return list.slice(-1)[0];
        }
        return list[list.indexOf(current) - 1];
      },
      first() {
        this.focus(this.getFirst());
      },
      last() {
        this.focus(this.getLast());
      },
      next() {
        this.focus(this.getNext());
      },
      previous() {
        this.focus(this.getPrevious());
      },
      prev() {
        return this.previous();
      },
      focus(el2) {
        if (!el2)
          return;
        setTimeout(() => {
          if (!el2.hasAttribute("tabindex"))
            el2.setAttribute("tabindex", "0");
          el2.focus({ preventScroll: this._noscroll });
        });
      }
    };
  });
  Alpine.directive("trap", Alpine.skipDuringClone(
    (el, { expression, modifiers }, { effect, evaluateLater, cleanup }) => {
      let evaluator = evaluateLater(expression);
      let oldValue = false;
      let trap = createFocusTrap(el, {
        escapeDeactivates: false,
        allowOutsideClick: true,
        fallbackFocus: () => el,
        initialFocus: el.querySelector("[autofocus]")
      });
      let undoInert = () => {
      };
      let undoDisableScrolling = () => {
      };
      const releaseFocus = () => {
        undoInert();
        undoInert = () => {
        };
        undoDisableScrolling();
        undoDisableScrolling = () => {
        };
        trap.deactivate({
          returnFocus: !modifiers.includes("noreturn")
        });
      };
      effect(() => evaluator((value) => {
        if (oldValue === value)
          return;
        if (value && !oldValue) {
          setTimeout(() => {
            if (modifiers.includes("inert"))
              undoInert = setInert(el);
            if (modifiers.includes("noscroll"))
              undoDisableScrolling = disableScrolling();
            trap.activate();
          });
        }
        if (!value && oldValue) {
          releaseFocus();
        }
        oldValue = !!value;
      }));
      cleanup(releaseFocus);
    },
    // When cloning, we only want to add aria-hidden attributes to the
    // DOM and not try to actually trap, as trapping can mess with the
    // live DOM and isn't just isolated to the cloned DOM.
    (el, { expression, modifiers }, { evaluate }) => {
      if (modifiers.includes("inert") && evaluate(expression))
        setInert(el);
    }
  ));
}
function setInert(el) {
  let undos = [];
  crawlSiblingsUp(el, (sibling) => {
    let cache = sibling.hasAttribute("aria-hidden");
    sibling.setAttribute("aria-hidden", "true");
    undos.push(() => cache || sibling.removeAttribute("aria-hidden"));
  });
  return () => {
    while (undos.length)
      undos.pop()();
  };
}
function crawlSiblingsUp(el, callback) {
  if (el.isSameNode(document.body) || !el.parentNode)
    return;
  Array.from(el.parentNode.children).forEach((sibling) => {
    if (sibling.isSameNode(el)) {
      crawlSiblingsUp(el.parentNode, callback);
    } else {
      callback(sibling);
    }
  });
}
function disableScrolling() {
  let overflow = document.documentElement.style.overflow;
  let paddingRight = document.documentElement.style.paddingRight;
  let scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;
  document.documentElement.style.overflow = "hidden";
  document.documentElement.style.paddingRight = `${scrollbarWidth}px`;
  return () => {
    document.documentElement.style.overflow = overflow;
    document.documentElement.style.paddingRight = paddingRight;
  };
}

// packages/focus/builds/module.js
var module_default = src_default;

/*! Bundled license information:

tabbable/dist/index.esm.js:
  (*!
  * tabbable 5.2.1
  * @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
  *)

focus-trap/dist/focus-trap.esm.js:
  (*!
  * focus-trap 6.6.1
  * @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
  *)
*/


/***/ }),

/***/ "./node_modules/@babel/runtime/regenerator/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/regenerator/index.js ***!
  \**********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

module.exports = __webpack_require__(/*! regenerator-runtime */ "./node_modules/regenerator-runtime/runtime.js");


/***/ }),

/***/ "./node_modules/alpinejs/dist/module.esm.js":
/*!**************************************************!*\
  !*** ./node_modules/alpinejs/dist/module.esm.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ module_default)
/* harmony export */ });
// packages/alpinejs/src/scheduler.js
var flushPending = false;
var flushing = false;
var queue = [];
function scheduler(callback) {
  queueJob(callback);
}
function queueJob(job) {
  if (!queue.includes(job))
    queue.push(job);
  queueFlush();
}
function dequeueJob(job) {
  let index = queue.indexOf(job);
  if (index !== -1)
    queue.splice(index, 1);
}
function queueFlush() {
  if (!flushing && !flushPending) {
    flushPending = true;
    queueMicrotask(flushJobs);
  }
}
function flushJobs() {
  flushPending = false;
  flushing = true;
  for (let i = 0; i < queue.length; i++) {
    queue[i]();
  }
  queue.length = 0;
  flushing = false;
}

// packages/alpinejs/src/reactivity.js
var reactive;
var effect;
var release;
var raw;
var shouldSchedule = true;
function disableEffectScheduling(callback) {
  shouldSchedule = false;
  callback();
  shouldSchedule = true;
}
function setReactivityEngine(engine) {
  reactive = engine.reactive;
  release = engine.release;
  effect = (callback) => engine.effect(callback, {scheduler: (task) => {
    if (shouldSchedule) {
      scheduler(task);
    } else {
      task();
    }
  }});
  raw = engine.raw;
}
function overrideEffect(override) {
  effect = override;
}
function elementBoundEffect(el) {
  let cleanup2 = () => {
  };
  let wrappedEffect = (callback) => {
    let effectReference = effect(callback);
    if (!el._x_effects) {
      el._x_effects = new Set();
      el._x_runEffects = () => {
        el._x_effects.forEach((i) => i());
      };
    }
    el._x_effects.add(effectReference);
    cleanup2 = () => {
      if (effectReference === void 0)
        return;
      el._x_effects.delete(effectReference);
      release(effectReference);
    };
    return effectReference;
  };
  return [wrappedEffect, () => {
    cleanup2();
  }];
}

// packages/alpinejs/src/mutation.js
var onAttributeAddeds = [];
var onElRemoveds = [];
var onElAddeds = [];
function onElAdded(callback) {
  onElAddeds.push(callback);
}
function onElRemoved(el, callback) {
  if (typeof callback === "function") {
    if (!el._x_cleanups)
      el._x_cleanups = [];
    el._x_cleanups.push(callback);
  } else {
    callback = el;
    onElRemoveds.push(callback);
  }
}
function onAttributesAdded(callback) {
  onAttributeAddeds.push(callback);
}
function onAttributeRemoved(el, name, callback) {
  if (!el._x_attributeCleanups)
    el._x_attributeCleanups = {};
  if (!el._x_attributeCleanups[name])
    el._x_attributeCleanups[name] = [];
  el._x_attributeCleanups[name].push(callback);
}
function cleanupAttributes(el, names) {
  if (!el._x_attributeCleanups)
    return;
  Object.entries(el._x_attributeCleanups).forEach(([name, value]) => {
    if (names === void 0 || names.includes(name)) {
      value.forEach((i) => i());
      delete el._x_attributeCleanups[name];
    }
  });
}
var observer = new MutationObserver(onMutate);
var currentlyObserving = false;
function startObservingMutations() {
  observer.observe(document, {subtree: true, childList: true, attributes: true, attributeOldValue: true});
  currentlyObserving = true;
}
function stopObservingMutations() {
  flushObserver();
  observer.disconnect();
  currentlyObserving = false;
}
var recordQueue = [];
var willProcessRecordQueue = false;
function flushObserver() {
  recordQueue = recordQueue.concat(observer.takeRecords());
  if (recordQueue.length && !willProcessRecordQueue) {
    willProcessRecordQueue = true;
    queueMicrotask(() => {
      processRecordQueue();
      willProcessRecordQueue = false;
    });
  }
}
function processRecordQueue() {
  onMutate(recordQueue);
  recordQueue.length = 0;
}
function mutateDom(callback) {
  if (!currentlyObserving)
    return callback();
  stopObservingMutations();
  let result = callback();
  startObservingMutations();
  return result;
}
var isCollecting = false;
var deferredMutations = [];
function deferMutations() {
  isCollecting = true;
}
function flushAndStopDeferringMutations() {
  isCollecting = false;
  onMutate(deferredMutations);
  deferredMutations = [];
}
function onMutate(mutations) {
  if (isCollecting) {
    deferredMutations = deferredMutations.concat(mutations);
    return;
  }
  let addedNodes = [];
  let removedNodes = [];
  let addedAttributes = new Map();
  let removedAttributes = new Map();
  for (let i = 0; i < mutations.length; i++) {
    if (mutations[i].target._x_ignoreMutationObserver)
      continue;
    if (mutations[i].type === "childList") {
      mutations[i].addedNodes.forEach((node) => node.nodeType === 1 && addedNodes.push(node));
      mutations[i].removedNodes.forEach((node) => node.nodeType === 1 && removedNodes.push(node));
    }
    if (mutations[i].type === "attributes") {
      let el = mutations[i].target;
      let name = mutations[i].attributeName;
      let oldValue = mutations[i].oldValue;
      let add2 = () => {
        if (!addedAttributes.has(el))
          addedAttributes.set(el, []);
        addedAttributes.get(el).push({name, value: el.getAttribute(name)});
      };
      let remove = () => {
        if (!removedAttributes.has(el))
          removedAttributes.set(el, []);
        removedAttributes.get(el).push(name);
      };
      if (el.hasAttribute(name) && oldValue === null) {
        add2();
      } else if (el.hasAttribute(name)) {
        remove();
        add2();
      } else {
        remove();
      }
    }
  }
  removedAttributes.forEach((attrs, el) => {
    cleanupAttributes(el, attrs);
  });
  addedAttributes.forEach((attrs, el) => {
    onAttributeAddeds.forEach((i) => i(el, attrs));
  });
  for (let node of removedNodes) {
    if (addedNodes.includes(node))
      continue;
    onElRemoveds.forEach((i) => i(node));
    if (node._x_cleanups) {
      while (node._x_cleanups.length)
        node._x_cleanups.pop()();
    }
  }
  addedNodes.forEach((node) => {
    node._x_ignoreSelf = true;
    node._x_ignore = true;
  });
  for (let node of addedNodes) {
    if (removedNodes.includes(node))
      continue;
    if (!node.isConnected)
      continue;
    delete node._x_ignoreSelf;
    delete node._x_ignore;
    onElAddeds.forEach((i) => i(node));
    node._x_ignore = true;
    node._x_ignoreSelf = true;
  }
  addedNodes.forEach((node) => {
    delete node._x_ignoreSelf;
    delete node._x_ignore;
  });
  addedNodes = null;
  removedNodes = null;
  addedAttributes = null;
  removedAttributes = null;
}

// packages/alpinejs/src/scope.js
function scope(node) {
  return mergeProxies(closestDataStack(node));
}
function addScopeToNode(node, data2, referenceNode) {
  node._x_dataStack = [data2, ...closestDataStack(referenceNode || node)];
  return () => {
    node._x_dataStack = node._x_dataStack.filter((i) => i !== data2);
  };
}
function refreshScope(element, scope2) {
  let existingScope = element._x_dataStack[0];
  Object.entries(scope2).forEach(([key, value]) => {
    existingScope[key] = value;
  });
}
function closestDataStack(node) {
  if (node._x_dataStack)
    return node._x_dataStack;
  if (typeof ShadowRoot === "function" && node instanceof ShadowRoot) {
    return closestDataStack(node.host);
  }
  if (!node.parentNode) {
    return [];
  }
  return closestDataStack(node.parentNode);
}
function mergeProxies(objects) {
  let thisProxy = new Proxy({}, {
    ownKeys: () => {
      return Array.from(new Set(objects.flatMap((i) => Object.keys(i))));
    },
    has: (target, name) => {
      return objects.some((obj) => obj.hasOwnProperty(name));
    },
    get: (target, name) => {
      return (objects.find((obj) => {
        if (obj.hasOwnProperty(name)) {
          let descriptor = Object.getOwnPropertyDescriptor(obj, name);
          if (descriptor.get && descriptor.get._x_alreadyBound || descriptor.set && descriptor.set._x_alreadyBound) {
            return true;
          }
          if ((descriptor.get || descriptor.set) && descriptor.enumerable) {
            let getter = descriptor.get;
            let setter = descriptor.set;
            let property = descriptor;
            getter = getter && getter.bind(thisProxy);
            setter = setter && setter.bind(thisProxy);
            if (getter)
              getter._x_alreadyBound = true;
            if (setter)
              setter._x_alreadyBound = true;
            Object.defineProperty(obj, name, {
              ...property,
              get: getter,
              set: setter
            });
          }
          return true;
        }
        return false;
      }) || {})[name];
    },
    set: (target, name, value) => {
      let closestObjectWithKey = objects.find((obj) => obj.hasOwnProperty(name));
      if (closestObjectWithKey) {
        closestObjectWithKey[name] = value;
      } else {
        objects[objects.length - 1][name] = value;
      }
      return true;
    }
  });
  return thisProxy;
}

// packages/alpinejs/src/interceptor.js
function initInterceptors(data2) {
  let isObject2 = (val) => typeof val === "object" && !Array.isArray(val) && val !== null;
  let recurse = (obj, basePath = "") => {
    Object.entries(Object.getOwnPropertyDescriptors(obj)).forEach(([key, {value, enumerable}]) => {
      if (enumerable === false || value === void 0)
        return;
      let path = basePath === "" ? key : `${basePath}.${key}`;
      if (typeof value === "object" && value !== null && value._x_interceptor) {
        obj[key] = value.initialize(data2, path, key);
      } else {
        if (isObject2(value) && value !== obj && !(value instanceof Element)) {
          recurse(value, path);
        }
      }
    });
  };
  return recurse(data2);
}
function interceptor(callback, mutateObj = () => {
}) {
  let obj = {
    initialValue: void 0,
    _x_interceptor: true,
    initialize(data2, path, key) {
      return callback(this.initialValue, () => get(data2, path), (value) => set(data2, path, value), path, key);
    }
  };
  mutateObj(obj);
  return (initialValue) => {
    if (typeof initialValue === "object" && initialValue !== null && initialValue._x_interceptor) {
      let initialize = obj.initialize.bind(obj);
      obj.initialize = (data2, path, key) => {
        let innerValue = initialValue.initialize(data2, path, key);
        obj.initialValue = innerValue;
        return initialize(data2, path, key);
      };
    } else {
      obj.initialValue = initialValue;
    }
    return obj;
  };
}
function get(obj, path) {
  return path.split(".").reduce((carry, segment) => carry[segment], obj);
}
function set(obj, path, value) {
  if (typeof path === "string")
    path = path.split(".");
  if (path.length === 1)
    obj[path[0]] = value;
  else if (path.length === 0)
    throw error;
  else {
    if (obj[path[0]])
      return set(obj[path[0]], path.slice(1), value);
    else {
      obj[path[0]] = {};
      return set(obj[path[0]], path.slice(1), value);
    }
  }
}

// packages/alpinejs/src/magics.js
var magics = {};
function magic(name, callback) {
  magics[name] = callback;
}
function injectMagics(obj, el) {
  Object.entries(magics).forEach(([name, callback]) => {
    Object.defineProperty(obj, `$${name}`, {
      get() {
        let [utilities, cleanup2] = getElementBoundUtilities(el);
        utilities = {interceptor, ...utilities};
        onElRemoved(el, cleanup2);
        return callback(el, utilities);
      },
      enumerable: false
    });
  });
  return obj;
}

// packages/alpinejs/src/utils/error.js
function tryCatch(el, expression, callback, ...args) {
  try {
    return callback(...args);
  } catch (e) {
    handleError(e, el, expression);
  }
}
function handleError(error2, el, expression = void 0) {
  Object.assign(error2, {el, expression});
  console.warn(`Alpine Expression Error: ${error2.message}

${expression ? 'Expression: "' + expression + '"\n\n' : ""}`, el);
  setTimeout(() => {
    throw error2;
  }, 0);
}

// packages/alpinejs/src/evaluator.js
var shouldAutoEvaluateFunctions = true;
function dontAutoEvaluateFunctions(callback) {
  let cache = shouldAutoEvaluateFunctions;
  shouldAutoEvaluateFunctions = false;
  callback();
  shouldAutoEvaluateFunctions = cache;
}
function evaluate(el, expression, extras = {}) {
  let result;
  evaluateLater(el, expression)((value) => result = value, extras);
  return result;
}
function evaluateLater(...args) {
  return theEvaluatorFunction(...args);
}
var theEvaluatorFunction = normalEvaluator;
function setEvaluator(newEvaluator) {
  theEvaluatorFunction = newEvaluator;
}
function normalEvaluator(el, expression) {
  let overriddenMagics = {};
  injectMagics(overriddenMagics, el);
  let dataStack = [overriddenMagics, ...closestDataStack(el)];
  if (typeof expression === "function") {
    return generateEvaluatorFromFunction(dataStack, expression);
  }
  let evaluator = generateEvaluatorFromString(dataStack, expression, el);
  return tryCatch.bind(null, el, expression, evaluator);
}
function generateEvaluatorFromFunction(dataStack, func) {
  return (receiver = () => {
  }, {scope: scope2 = {}, params = []} = {}) => {
    let result = func.apply(mergeProxies([scope2, ...dataStack]), params);
    runIfTypeOfFunction(receiver, result);
  };
}
var evaluatorMemo = {};
function generateFunctionFromString(expression, el) {
  if (evaluatorMemo[expression]) {
    return evaluatorMemo[expression];
  }
  let AsyncFunction = Object.getPrototypeOf(async function() {
  }).constructor;
  let rightSideSafeExpression = /^[\n\s]*if.*\(.*\)/.test(expression) || /^(let|const)\s/.test(expression) ? `(() => { ${expression} })()` : expression;
  const safeAsyncFunction = () => {
    try {
      return new AsyncFunction(["__self", "scope"], `with (scope) { __self.result = ${rightSideSafeExpression} }; __self.finished = true; return __self.result;`);
    } catch (error2) {
      handleError(error2, el, expression);
      return Promise.resolve();
    }
  };
  let func = safeAsyncFunction();
  evaluatorMemo[expression] = func;
  return func;
}
function generateEvaluatorFromString(dataStack, expression, el) {
  let func = generateFunctionFromString(expression, el);
  return (receiver = () => {
  }, {scope: scope2 = {}, params = []} = {}) => {
    func.result = void 0;
    func.finished = false;
    let completeScope = mergeProxies([scope2, ...dataStack]);
    if (typeof func === "function") {
      let promise = func(func, completeScope).catch((error2) => handleError(error2, el, expression));
      if (func.finished) {
        runIfTypeOfFunction(receiver, func.result, completeScope, params, el);
        func.result = void 0;
      } else {
        promise.then((result) => {
          runIfTypeOfFunction(receiver, result, completeScope, params, el);
        }).catch((error2) => handleError(error2, el, expression)).finally(() => func.result = void 0);
      }
    }
  };
}
function runIfTypeOfFunction(receiver, value, scope2, params, el) {
  if (shouldAutoEvaluateFunctions && typeof value === "function") {
    let result = value.apply(scope2, params);
    if (result instanceof Promise) {
      result.then((i) => runIfTypeOfFunction(receiver, i, scope2, params)).catch((error2) => handleError(error2, el, value));
    } else {
      receiver(result);
    }
  } else {
    receiver(value);
  }
}

// packages/alpinejs/src/directives.js
var prefixAsString = "x-";
function prefix(subject = "") {
  return prefixAsString + subject;
}
function setPrefix(newPrefix) {
  prefixAsString = newPrefix;
}
var directiveHandlers = {};
function directive(name, callback) {
  directiveHandlers[name] = callback;
}
function directives(el, attributes, originalAttributeOverride) {
  attributes = Array.from(attributes);
  if (el._x_virtualDirectives) {
    let vAttributes = Object.entries(el._x_virtualDirectives).map(([name, value]) => ({name, value}));
    let staticAttributes = attributesOnly(vAttributes);
    vAttributes = vAttributes.map((attribute) => {
      if (staticAttributes.find((attr) => attr.name === attribute.name)) {
        return {
          name: `x-bind:${attribute.name}`,
          value: `"${attribute.value}"`
        };
      }
      return attribute;
    });
    attributes = attributes.concat(vAttributes);
  }
  let transformedAttributeMap = {};
  let directives2 = attributes.map(toTransformedAttributes((newName, oldName) => transformedAttributeMap[newName] = oldName)).filter(outNonAlpineAttributes).map(toParsedDirectives(transformedAttributeMap, originalAttributeOverride)).sort(byPriority);
  return directives2.map((directive2) => {
    return getDirectiveHandler(el, directive2);
  });
}
function attributesOnly(attributes) {
  return Array.from(attributes).map(toTransformedAttributes()).filter((attr) => !outNonAlpineAttributes(attr));
}
var isDeferringHandlers = false;
var directiveHandlerStacks = new Map();
var currentHandlerStackKey = Symbol();
function deferHandlingDirectives(callback) {
  isDeferringHandlers = true;
  let key = Symbol();
  currentHandlerStackKey = key;
  directiveHandlerStacks.set(key, []);
  let flushHandlers = () => {
    while (directiveHandlerStacks.get(key).length)
      directiveHandlerStacks.get(key).shift()();
    directiveHandlerStacks.delete(key);
  };
  let stopDeferring = () => {
    isDeferringHandlers = false;
    flushHandlers();
  };
  callback(flushHandlers);
  stopDeferring();
}
function getElementBoundUtilities(el) {
  let cleanups = [];
  let cleanup2 = (callback) => cleanups.push(callback);
  let [effect3, cleanupEffect] = elementBoundEffect(el);
  cleanups.push(cleanupEffect);
  let utilities = {
    Alpine: alpine_default,
    effect: effect3,
    cleanup: cleanup2,
    evaluateLater: evaluateLater.bind(evaluateLater, el),
    evaluate: evaluate.bind(evaluate, el)
  };
  let doCleanup = () => cleanups.forEach((i) => i());
  return [utilities, doCleanup];
}
function getDirectiveHandler(el, directive2) {
  let noop = () => {
  };
  let handler3 = directiveHandlers[directive2.type] || noop;
  let [utilities, cleanup2] = getElementBoundUtilities(el);
  onAttributeRemoved(el, directive2.original, cleanup2);
  let fullHandler = () => {
    if (el._x_ignore || el._x_ignoreSelf)
      return;
    handler3.inline && handler3.inline(el, directive2, utilities);
    handler3 = handler3.bind(handler3, el, directive2, utilities);
    isDeferringHandlers ? directiveHandlerStacks.get(currentHandlerStackKey).push(handler3) : handler3();
  };
  fullHandler.runCleanups = cleanup2;
  return fullHandler;
}
var startingWith = (subject, replacement) => ({name, value}) => {
  if (name.startsWith(subject))
    name = name.replace(subject, replacement);
  return {name, value};
};
var into = (i) => i;
function toTransformedAttributes(callback = () => {
}) {
  return ({name, value}) => {
    let {name: newName, value: newValue} = attributeTransformers.reduce((carry, transform) => {
      return transform(carry);
    }, {name, value});
    if (newName !== name)
      callback(newName, name);
    return {name: newName, value: newValue};
  };
}
var attributeTransformers = [];
function mapAttributes(callback) {
  attributeTransformers.push(callback);
}
function outNonAlpineAttributes({name}) {
  return alpineAttributeRegex().test(name);
}
var alpineAttributeRegex = () => new RegExp(`^${prefixAsString}([^:^.]+)\\b`);
function toParsedDirectives(transformedAttributeMap, originalAttributeOverride) {
  return ({name, value}) => {
    let typeMatch = name.match(alpineAttributeRegex());
    let valueMatch = name.match(/:([a-zA-Z0-9\-:]+)/);
    let modifiers = name.match(/\.[^.\]]+(?=[^\]]*$)/g) || [];
    let original = originalAttributeOverride || transformedAttributeMap[name] || name;
    return {
      type: typeMatch ? typeMatch[1] : null,
      value: valueMatch ? valueMatch[1] : null,
      modifiers: modifiers.map((i) => i.replace(".", "")),
      expression: value,
      original
    };
  };
}
var DEFAULT = "DEFAULT";
var directiveOrder = [
  "ignore",
  "ref",
  "data",
  "id",
  "radio",
  "tabs",
  "switch",
  "disclosure",
  "menu",
  "listbox",
  "list",
  "item",
  "combobox",
  "bind",
  "init",
  "for",
  "mask",
  "model",
  "modelable",
  "transition",
  "show",
  "if",
  DEFAULT,
  "teleport"
];
function byPriority(a, b) {
  let typeA = directiveOrder.indexOf(a.type) === -1 ? DEFAULT : a.type;
  let typeB = directiveOrder.indexOf(b.type) === -1 ? DEFAULT : b.type;
  return directiveOrder.indexOf(typeA) - directiveOrder.indexOf(typeB);
}

// packages/alpinejs/src/utils/dispatch.js
function dispatch(el, name, detail = {}) {
  el.dispatchEvent(new CustomEvent(name, {
    detail,
    bubbles: true,
    composed: true,
    cancelable: true
  }));
}

// packages/alpinejs/src/nextTick.js
var tickStack = [];
var isHolding = false;
function nextTick(callback = () => {
}) {
  queueMicrotask(() => {
    isHolding || setTimeout(() => {
      releaseNextTicks();
    });
  });
  return new Promise((res) => {
    tickStack.push(() => {
      callback();
      res();
    });
  });
}
function releaseNextTicks() {
  isHolding = false;
  while (tickStack.length)
    tickStack.shift()();
}
function holdNextTicks() {
  isHolding = true;
}

// packages/alpinejs/src/utils/walk.js
function walk(el, callback) {
  if (typeof ShadowRoot === "function" && el instanceof ShadowRoot) {
    Array.from(el.children).forEach((el2) => walk(el2, callback));
    return;
  }
  let skip = false;
  callback(el, () => skip = true);
  if (skip)
    return;
  let node = el.firstElementChild;
  while (node) {
    walk(node, callback, false);
    node = node.nextElementSibling;
  }
}

// packages/alpinejs/src/utils/warn.js
function warn(message, ...args) {
  console.warn(`Alpine Warning: ${message}`, ...args);
}

// packages/alpinejs/src/lifecycle.js
function start() {
  if (!document.body)
    warn("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?");
  dispatch(document, "alpine:init");
  dispatch(document, "alpine:initializing");
  startObservingMutations();
  onElAdded((el) => initTree(el, walk));
  onElRemoved((el) => destroyTree(el));
  onAttributesAdded((el, attrs) => {
    directives(el, attrs).forEach((handle) => handle());
  });
  let outNestedComponents = (el) => !closestRoot(el.parentElement, true);
  Array.from(document.querySelectorAll(allSelectors())).filter(outNestedComponents).forEach((el) => {
    initTree(el);
  });
  dispatch(document, "alpine:initialized");
}
var rootSelectorCallbacks = [];
var initSelectorCallbacks = [];
function rootSelectors() {
  return rootSelectorCallbacks.map((fn) => fn());
}
function allSelectors() {
  return rootSelectorCallbacks.concat(initSelectorCallbacks).map((fn) => fn());
}
function addRootSelector(selectorCallback) {
  rootSelectorCallbacks.push(selectorCallback);
}
function addInitSelector(selectorCallback) {
  initSelectorCallbacks.push(selectorCallback);
}
function closestRoot(el, includeInitSelectors = false) {
  return findClosest(el, (element) => {
    const selectors = includeInitSelectors ? allSelectors() : rootSelectors();
    if (selectors.some((selector) => element.matches(selector)))
      return true;
  });
}
function findClosest(el, callback) {
  if (!el)
    return;
  if (callback(el))
    return el;
  if (el._x_teleportBack)
    el = el._x_teleportBack;
  if (!el.parentElement)
    return;
  return findClosest(el.parentElement, callback);
}
function isRoot(el) {
  return rootSelectors().some((selector) => el.matches(selector));
}
function initTree(el, walker = walk) {
  deferHandlingDirectives(() => {
    walker(el, (el2, skip) => {
      directives(el2, el2.attributes).forEach((handle) => handle());
      el2._x_ignore && skip();
    });
  });
}
function destroyTree(root) {
  walk(root, (el) => cleanupAttributes(el));
}

// packages/alpinejs/src/utils/classes.js
function setClasses(el, value) {
  if (Array.isArray(value)) {
    return setClassesFromString(el, value.join(" "));
  } else if (typeof value === "object" && value !== null) {
    return setClassesFromObject(el, value);
  } else if (typeof value === "function") {
    return setClasses(el, value());
  }
  return setClassesFromString(el, value);
}
function setClassesFromString(el, classString) {
  let split = (classString2) => classString2.split(" ").filter(Boolean);
  let missingClasses = (classString2) => classString2.split(" ").filter((i) => !el.classList.contains(i)).filter(Boolean);
  let addClassesAndReturnUndo = (classes) => {
    el.classList.add(...classes);
    return () => {
      el.classList.remove(...classes);
    };
  };
  classString = classString === true ? classString = "" : classString || "";
  return addClassesAndReturnUndo(missingClasses(classString));
}
function setClassesFromObject(el, classObject) {
  let split = (classString) => classString.split(" ").filter(Boolean);
  let forAdd = Object.entries(classObject).flatMap(([classString, bool]) => bool ? split(classString) : false).filter(Boolean);
  let forRemove = Object.entries(classObject).flatMap(([classString, bool]) => !bool ? split(classString) : false).filter(Boolean);
  let added = [];
  let removed = [];
  forRemove.forEach((i) => {
    if (el.classList.contains(i)) {
      el.classList.remove(i);
      removed.push(i);
    }
  });
  forAdd.forEach((i) => {
    if (!el.classList.contains(i)) {
      el.classList.add(i);
      added.push(i);
    }
  });
  return () => {
    removed.forEach((i) => el.classList.add(i));
    added.forEach((i) => el.classList.remove(i));
  };
}

// packages/alpinejs/src/utils/styles.js
function setStyles(el, value) {
  if (typeof value === "object" && value !== null) {
    return setStylesFromObject(el, value);
  }
  return setStylesFromString(el, value);
}
function setStylesFromObject(el, value) {
  let previousStyles = {};
  Object.entries(value).forEach(([key, value2]) => {
    previousStyles[key] = el.style[key];
    if (!key.startsWith("--")) {
      key = kebabCase(key);
    }
    el.style.setProperty(key, value2);
  });
  setTimeout(() => {
    if (el.style.length === 0) {
      el.removeAttribute("style");
    }
  });
  return () => {
    setStyles(el, previousStyles);
  };
}
function setStylesFromString(el, value) {
  let cache = el.getAttribute("style", value);
  el.setAttribute("style", value);
  return () => {
    el.setAttribute("style", cache || "");
  };
}
function kebabCase(subject) {
  return subject.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
}

// packages/alpinejs/src/utils/once.js
function once(callback, fallback = () => {
}) {
  let called = false;
  return function() {
    if (!called) {
      called = true;
      callback.apply(this, arguments);
    } else {
      fallback.apply(this, arguments);
    }
  };
}

// packages/alpinejs/src/directives/x-transition.js
directive("transition", (el, {value, modifiers, expression}, {evaluate: evaluate2}) => {
  if (typeof expression === "function")
    expression = evaluate2(expression);
  if (!expression) {
    registerTransitionsFromHelper(el, modifiers, value);
  } else {
    registerTransitionsFromClassString(el, expression, value);
  }
});
function registerTransitionsFromClassString(el, classString, stage) {
  registerTransitionObject(el, setClasses, "");
  let directiveStorageMap = {
    enter: (classes) => {
      el._x_transition.enter.during = classes;
    },
    "enter-start": (classes) => {
      el._x_transition.enter.start = classes;
    },
    "enter-end": (classes) => {
      el._x_transition.enter.end = classes;
    },
    leave: (classes) => {
      el._x_transition.leave.during = classes;
    },
    "leave-start": (classes) => {
      el._x_transition.leave.start = classes;
    },
    "leave-end": (classes) => {
      el._x_transition.leave.end = classes;
    }
  };
  directiveStorageMap[stage](classString);
}
function registerTransitionsFromHelper(el, modifiers, stage) {
  registerTransitionObject(el, setStyles);
  let doesntSpecify = !modifiers.includes("in") && !modifiers.includes("out") && !stage;
  let transitioningIn = doesntSpecify || modifiers.includes("in") || ["enter"].includes(stage);
  let transitioningOut = doesntSpecify || modifiers.includes("out") || ["leave"].includes(stage);
  if (modifiers.includes("in") && !doesntSpecify) {
    modifiers = modifiers.filter((i, index) => index < modifiers.indexOf("out"));
  }
  if (modifiers.includes("out") && !doesntSpecify) {
    modifiers = modifiers.filter((i, index) => index > modifiers.indexOf("out"));
  }
  let wantsAll = !modifiers.includes("opacity") && !modifiers.includes("scale");
  let wantsOpacity = wantsAll || modifiers.includes("opacity");
  let wantsScale = wantsAll || modifiers.includes("scale");
  let opacityValue = wantsOpacity ? 0 : 1;
  let scaleValue = wantsScale ? modifierValue(modifiers, "scale", 95) / 100 : 1;
  let delay = modifierValue(modifiers, "delay", 0);
  let origin = modifierValue(modifiers, "origin", "center");
  let property = "opacity, transform";
  let durationIn = modifierValue(modifiers, "duration", 150) / 1e3;
  let durationOut = modifierValue(modifiers, "duration", 75) / 1e3;
  let easing = `cubic-bezier(0.4, 0.0, 0.2, 1)`;
  if (transitioningIn) {
    el._x_transition.enter.during = {
      transformOrigin: origin,
      transitionDelay: delay,
      transitionProperty: property,
      transitionDuration: `${durationIn}s`,
      transitionTimingFunction: easing
    };
    el._x_transition.enter.start = {
      opacity: opacityValue,
      transform: `scale(${scaleValue})`
    };
    el._x_transition.enter.end = {
      opacity: 1,
      transform: `scale(1)`
    };
  }
  if (transitioningOut) {
    el._x_transition.leave.during = {
      transformOrigin: origin,
      transitionDelay: delay,
      transitionProperty: property,
      transitionDuration: `${durationOut}s`,
      transitionTimingFunction: easing
    };
    el._x_transition.leave.start = {
      opacity: 1,
      transform: `scale(1)`
    };
    el._x_transition.leave.end = {
      opacity: opacityValue,
      transform: `scale(${scaleValue})`
    };
  }
}
function registerTransitionObject(el, setFunction, defaultValue = {}) {
  if (!el._x_transition)
    el._x_transition = {
      enter: {during: defaultValue, start: defaultValue, end: defaultValue},
      leave: {during: defaultValue, start: defaultValue, end: defaultValue},
      in(before = () => {
      }, after = () => {
      }) {
        transition(el, setFunction, {
          during: this.enter.during,
          start: this.enter.start,
          end: this.enter.end
        }, before, after);
      },
      out(before = () => {
      }, after = () => {
      }) {
        transition(el, setFunction, {
          during: this.leave.during,
          start: this.leave.start,
          end: this.leave.end
        }, before, after);
      }
    };
}
window.Element.prototype._x_toggleAndCascadeWithTransitions = function(el, value, show, hide) {
  const nextTick2 = document.visibilityState === "visible" ? requestAnimationFrame : setTimeout;
  let clickAwayCompatibleShow = () => nextTick2(show);
  if (value) {
    if (el._x_transition && (el._x_transition.enter || el._x_transition.leave)) {
      el._x_transition.enter && (Object.entries(el._x_transition.enter.during).length || Object.entries(el._x_transition.enter.start).length || Object.entries(el._x_transition.enter.end).length) ? el._x_transition.in(show) : clickAwayCompatibleShow();
    } else {
      el._x_transition ? el._x_transition.in(show) : clickAwayCompatibleShow();
    }
    return;
  }
  el._x_hidePromise = el._x_transition ? new Promise((resolve, reject) => {
    el._x_transition.out(() => {
    }, () => resolve(hide));
    el._x_transitioning.beforeCancel(() => reject({isFromCancelledTransition: true}));
  }) : Promise.resolve(hide);
  queueMicrotask(() => {
    let closest = closestHide(el);
    if (closest) {
      if (!closest._x_hideChildren)
        closest._x_hideChildren = [];
      closest._x_hideChildren.push(el);
    } else {
      nextTick2(() => {
        let hideAfterChildren = (el2) => {
          let carry = Promise.all([
            el2._x_hidePromise,
            ...(el2._x_hideChildren || []).map(hideAfterChildren)
          ]).then(([i]) => i());
          delete el2._x_hidePromise;
          delete el2._x_hideChildren;
          return carry;
        };
        hideAfterChildren(el).catch((e) => {
          if (!e.isFromCancelledTransition)
            throw e;
        });
      });
    }
  });
};
function closestHide(el) {
  let parent = el.parentNode;
  if (!parent)
    return;
  return parent._x_hidePromise ? parent : closestHide(parent);
}
function transition(el, setFunction, {during, start: start2, end} = {}, before = () => {
}, after = () => {
}) {
  if (el._x_transitioning)
    el._x_transitioning.cancel();
  if (Object.keys(during).length === 0 && Object.keys(start2).length === 0 && Object.keys(end).length === 0) {
    before();
    after();
    return;
  }
  let undoStart, undoDuring, undoEnd;
  performTransition(el, {
    start() {
      undoStart = setFunction(el, start2);
    },
    during() {
      undoDuring = setFunction(el, during);
    },
    before,
    end() {
      undoStart();
      undoEnd = setFunction(el, end);
    },
    after,
    cleanup() {
      undoDuring();
      undoEnd();
    }
  });
}
function performTransition(el, stages) {
  let interrupted, reachedBefore, reachedEnd;
  let finish = once(() => {
    mutateDom(() => {
      interrupted = true;
      if (!reachedBefore)
        stages.before();
      if (!reachedEnd) {
        stages.end();
        releaseNextTicks();
      }
      stages.after();
      if (el.isConnected)
        stages.cleanup();
      delete el._x_transitioning;
    });
  });
  el._x_transitioning = {
    beforeCancels: [],
    beforeCancel(callback) {
      this.beforeCancels.push(callback);
    },
    cancel: once(function() {
      while (this.beforeCancels.length) {
        this.beforeCancels.shift()();
      }
      ;
      finish();
    }),
    finish
  };
  mutateDom(() => {
    stages.start();
    stages.during();
  });
  holdNextTicks();
  requestAnimationFrame(() => {
    if (interrupted)
      return;
    let duration = Number(getComputedStyle(el).transitionDuration.replace(/,.*/, "").replace("s", "")) * 1e3;
    let delay = Number(getComputedStyle(el).transitionDelay.replace(/,.*/, "").replace("s", "")) * 1e3;
    if (duration === 0)
      duration = Number(getComputedStyle(el).animationDuration.replace("s", "")) * 1e3;
    mutateDom(() => {
      stages.before();
    });
    reachedBefore = true;
    requestAnimationFrame(() => {
      if (interrupted)
        return;
      mutateDom(() => {
        stages.end();
      });
      releaseNextTicks();
      setTimeout(el._x_transitioning.finish, duration + delay);
      reachedEnd = true;
    });
  });
}
function modifierValue(modifiers, key, fallback) {
  if (modifiers.indexOf(key) === -1)
    return fallback;
  const rawValue = modifiers[modifiers.indexOf(key) + 1];
  if (!rawValue)
    return fallback;
  if (key === "scale") {
    if (isNaN(rawValue))
      return fallback;
  }
  if (key === "duration") {
    let match = rawValue.match(/([0-9]+)ms/);
    if (match)
      return match[1];
  }
  if (key === "origin") {
    if (["top", "right", "left", "center", "bottom"].includes(modifiers[modifiers.indexOf(key) + 2])) {
      return [rawValue, modifiers[modifiers.indexOf(key) + 2]].join(" ");
    }
  }
  return rawValue;
}

// packages/alpinejs/src/clone.js
var isCloning = false;
function skipDuringClone(callback, fallback = () => {
}) {
  return (...args) => isCloning ? fallback(...args) : callback(...args);
}
function clone(oldEl, newEl) {
  if (!newEl._x_dataStack)
    newEl._x_dataStack = oldEl._x_dataStack;
  isCloning = true;
  dontRegisterReactiveSideEffects(() => {
    cloneTree(newEl);
  });
  isCloning = false;
}
function cloneTree(el) {
  let hasRunThroughFirstEl = false;
  let shallowWalker = (el2, callback) => {
    walk(el2, (el3, skip) => {
      if (hasRunThroughFirstEl && isRoot(el3))
        return skip();
      hasRunThroughFirstEl = true;
      callback(el3, skip);
    });
  };
  initTree(el, shallowWalker);
}
function dontRegisterReactiveSideEffects(callback) {
  let cache = effect;
  overrideEffect((callback2, el) => {
    let storedEffect = cache(callback2);
    release(storedEffect);
    return () => {
    };
  });
  callback();
  overrideEffect(cache);
}

// packages/alpinejs/src/utils/bind.js
function bind(el, name, value, modifiers = []) {
  if (!el._x_bindings)
    el._x_bindings = reactive({});
  el._x_bindings[name] = value;
  name = modifiers.includes("camel") ? camelCase(name) : name;
  switch (name) {
    case "value":
      bindInputValue(el, value);
      break;
    case "style":
      bindStyles(el, value);
      break;
    case "class":
      bindClasses(el, value);
      break;
    default:
      bindAttribute(el, name, value);
      break;
  }
}
function bindInputValue(el, value) {
  if (el.type === "radio") {
    if (el.attributes.value === void 0) {
      el.value = value;
    }
    if (window.fromModel) {
      el.checked = checkedAttrLooseCompare(el.value, value);
    }
  } else if (el.type === "checkbox") {
    if (Number.isInteger(value)) {
      el.value = value;
    } else if (!Number.isInteger(value) && !Array.isArray(value) && typeof value !== "boolean" && ![null, void 0].includes(value)) {
      el.value = String(value);
    } else {
      if (Array.isArray(value)) {
        el.checked = value.some((val) => checkedAttrLooseCompare(val, el.value));
      } else {
        el.checked = !!value;
      }
    }
  } else if (el.tagName === "SELECT") {
    updateSelect(el, value);
  } else {
    if (el.value === value)
      return;
    el.value = value;
  }
}
function bindClasses(el, value) {
  if (el._x_undoAddedClasses)
    el._x_undoAddedClasses();
  el._x_undoAddedClasses = setClasses(el, value);
}
function bindStyles(el, value) {
  if (el._x_undoAddedStyles)
    el._x_undoAddedStyles();
  el._x_undoAddedStyles = setStyles(el, value);
}
function bindAttribute(el, name, value) {
  if ([null, void 0, false].includes(value) && attributeShouldntBePreservedIfFalsy(name)) {
    el.removeAttribute(name);
  } else {
    if (isBooleanAttr(name))
      value = name;
    setIfChanged(el, name, value);
  }
}
function setIfChanged(el, attrName, value) {
  if (el.getAttribute(attrName) != value) {
    el.setAttribute(attrName, value);
  }
}
function updateSelect(el, value) {
  const arrayWrappedValue = [].concat(value).map((value2) => {
    return value2 + "";
  });
  Array.from(el.options).forEach((option) => {
    option.selected = arrayWrappedValue.includes(option.value);
  });
}
function camelCase(subject) {
  return subject.toLowerCase().replace(/-(\w)/g, (match, char) => char.toUpperCase());
}
function checkedAttrLooseCompare(valueA, valueB) {
  return valueA == valueB;
}
function isBooleanAttr(attrName) {
  const booleanAttributes = [
    "disabled",
    "checked",
    "required",
    "readonly",
    "hidden",
    "open",
    "selected",
    "autofocus",
    "itemscope",
    "multiple",
    "novalidate",
    "allowfullscreen",
    "allowpaymentrequest",
    "formnovalidate",
    "autoplay",
    "controls",
    "loop",
    "muted",
    "playsinline",
    "default",
    "ismap",
    "reversed",
    "async",
    "defer",
    "nomodule"
  ];
  return booleanAttributes.includes(attrName);
}
function attributeShouldntBePreservedIfFalsy(name) {
  return !["aria-pressed", "aria-checked", "aria-expanded", "aria-selected"].includes(name);
}
function getBinding(el, name, fallback) {
  if (el._x_bindings && el._x_bindings[name] !== void 0)
    return el._x_bindings[name];
  let attr = el.getAttribute(name);
  if (attr === null)
    return typeof fallback === "function" ? fallback() : fallback;
  if (attr === "")
    return true;
  if (isBooleanAttr(name)) {
    return !![name, "true"].includes(attr);
  }
  return attr;
}

// packages/alpinejs/src/utils/debounce.js
function debounce(func, wait) {
  var timeout;
  return function() {
    var context = this, args = arguments;
    var later = function() {
      timeout = null;
      func.apply(context, args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// packages/alpinejs/src/utils/throttle.js
function throttle(func, limit) {
  let inThrottle;
  return function() {
    let context = this, args = arguments;
    if (!inThrottle) {
      func.apply(context, args);
      inThrottle = true;
      setTimeout(() => inThrottle = false, limit);
    }
  };
}

// packages/alpinejs/src/plugin.js
function plugin(callback) {
  callback(alpine_default);
}

// packages/alpinejs/src/store.js
var stores = {};
var isReactive = false;
function store(name, value) {
  if (!isReactive) {
    stores = reactive(stores);
    isReactive = true;
  }
  if (value === void 0) {
    return stores[name];
  }
  stores[name] = value;
  if (typeof value === "object" && value !== null && value.hasOwnProperty("init") && typeof value.init === "function") {
    stores[name].init();
  }
  initInterceptors(stores[name]);
}
function getStores() {
  return stores;
}

// packages/alpinejs/src/binds.js
var binds = {};
function bind2(name, bindings) {
  let getBindings = typeof bindings !== "function" ? () => bindings : bindings;
  if (name instanceof Element) {
    applyBindingsObject(name, getBindings());
  } else {
    binds[name] = getBindings;
  }
}
function injectBindingProviders(obj) {
  Object.entries(binds).forEach(([name, callback]) => {
    Object.defineProperty(obj, name, {
      get() {
        return (...args) => {
          return callback(...args);
        };
      }
    });
  });
  return obj;
}
function applyBindingsObject(el, obj, original) {
  let cleanupRunners = [];
  while (cleanupRunners.length)
    cleanupRunners.pop()();
  let attributes = Object.entries(obj).map(([name, value]) => ({name, value}));
  let staticAttributes = attributesOnly(attributes);
  attributes = attributes.map((attribute) => {
    if (staticAttributes.find((attr) => attr.name === attribute.name)) {
      return {
        name: `x-bind:${attribute.name}`,
        value: `"${attribute.value}"`
      };
    }
    return attribute;
  });
  directives(el, attributes, original).map((handle) => {
    cleanupRunners.push(handle.runCleanups);
    handle();
  });
}

// packages/alpinejs/src/datas.js
var datas = {};
function data(name, callback) {
  datas[name] = callback;
}
function injectDataProviders(obj, context) {
  Object.entries(datas).forEach(([name, callback]) => {
    Object.defineProperty(obj, name, {
      get() {
        return (...args) => {
          return callback.bind(context)(...args);
        };
      },
      enumerable: false
    });
  });
  return obj;
}

// packages/alpinejs/src/alpine.js
var Alpine = {
  get reactive() {
    return reactive;
  },
  get release() {
    return release;
  },
  get effect() {
    return effect;
  },
  get raw() {
    return raw;
  },
  version: "3.10.5",
  flushAndStopDeferringMutations,
  dontAutoEvaluateFunctions,
  disableEffectScheduling,
  setReactivityEngine,
  closestDataStack,
  skipDuringClone,
  addRootSelector,
  addInitSelector,
  addScopeToNode,
  deferMutations,
  mapAttributes,
  evaluateLater,
  setEvaluator,
  mergeProxies,
  findClosest,
  closestRoot,
  interceptor,
  transition,
  setStyles,
  mutateDom,
  directive,
  throttle,
  debounce,
  evaluate,
  initTree,
  nextTick,
  prefixed: prefix,
  prefix: setPrefix,
  plugin,
  magic,
  store,
  start,
  clone,
  bound: getBinding,
  $data: scope,
  data,
  bind: bind2
};
var alpine_default = Alpine;

// node_modules/@vue/shared/dist/shared.esm-bundler.js
function makeMap(str, expectsLowerCase) {
  const map = Object.create(null);
  const list = str.split(",");
  for (let i = 0; i < list.length; i++) {
    map[list[i]] = true;
  }
  return expectsLowerCase ? (val) => !!map[val.toLowerCase()] : (val) => !!map[val];
}
var PatchFlagNames = {
  [1]: `TEXT`,
  [2]: `CLASS`,
  [4]: `STYLE`,
  [8]: `PROPS`,
  [16]: `FULL_PROPS`,
  [32]: `HYDRATE_EVENTS`,
  [64]: `STABLE_FRAGMENT`,
  [128]: `KEYED_FRAGMENT`,
  [256]: `UNKEYED_FRAGMENT`,
  [512]: `NEED_PATCH`,
  [1024]: `DYNAMIC_SLOTS`,
  [2048]: `DEV_ROOT_FRAGMENT`,
  [-1]: `HOISTED`,
  [-2]: `BAIL`
};
var slotFlagsText = {
  [1]: "STABLE",
  [2]: "DYNAMIC",
  [3]: "FORWARDED"
};
var specialBooleanAttrs = `itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`;
var isBooleanAttr2 = /* @__PURE__ */ makeMap(specialBooleanAttrs + `,async,autofocus,autoplay,controls,default,defer,disabled,hidden,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected`);
var EMPTY_OBJ =  true ? Object.freeze({}) : 0;
var EMPTY_ARR =  true ? Object.freeze([]) : 0;
var extend = Object.assign;
var hasOwnProperty = Object.prototype.hasOwnProperty;
var hasOwn = (val, key) => hasOwnProperty.call(val, key);
var isArray = Array.isArray;
var isMap = (val) => toTypeString(val) === "[object Map]";
var isString = (val) => typeof val === "string";
var isSymbol = (val) => typeof val === "symbol";
var isObject = (val) => val !== null && typeof val === "object";
var objectToString = Object.prototype.toString;
var toTypeString = (value) => objectToString.call(value);
var toRawType = (value) => {
  return toTypeString(value).slice(8, -1);
};
var isIntegerKey = (key) => isString(key) && key !== "NaN" && key[0] !== "-" && "" + parseInt(key, 10) === key;
var cacheStringFunction = (fn) => {
  const cache = Object.create(null);
  return (str) => {
    const hit = cache[str];
    return hit || (cache[str] = fn(str));
  };
};
var camelizeRE = /-(\w)/g;
var camelize = cacheStringFunction((str) => {
  return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : "");
});
var hyphenateRE = /\B([A-Z])/g;
var hyphenate = cacheStringFunction((str) => str.replace(hyphenateRE, "-$1").toLowerCase());
var capitalize = cacheStringFunction((str) => str.charAt(0).toUpperCase() + str.slice(1));
var toHandlerKey = cacheStringFunction((str) => str ? `on${capitalize(str)}` : ``);
var hasChanged = (value, oldValue) => value !== oldValue && (value === value || oldValue === oldValue);

// node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js
var targetMap = new WeakMap();
var effectStack = [];
var activeEffect;
var ITERATE_KEY = Symbol( true ? "iterate" : 0);
var MAP_KEY_ITERATE_KEY = Symbol( true ? "Map key iterate" : 0);
function isEffect(fn) {
  return fn && fn._isEffect === true;
}
function effect2(fn, options = EMPTY_OBJ) {
  if (isEffect(fn)) {
    fn = fn.raw;
  }
  const effect3 = createReactiveEffect(fn, options);
  if (!options.lazy) {
    effect3();
  }
  return effect3;
}
function stop(effect3) {
  if (effect3.active) {
    cleanup(effect3);
    if (effect3.options.onStop) {
      effect3.options.onStop();
    }
    effect3.active = false;
  }
}
var uid = 0;
function createReactiveEffect(fn, options) {
  const effect3 = function reactiveEffect() {
    if (!effect3.active) {
      return fn();
    }
    if (!effectStack.includes(effect3)) {
      cleanup(effect3);
      try {
        enableTracking();
        effectStack.push(effect3);
        activeEffect = effect3;
        return fn();
      } finally {
        effectStack.pop();
        resetTracking();
        activeEffect = effectStack[effectStack.length - 1];
      }
    }
  };
  effect3.id = uid++;
  effect3.allowRecurse = !!options.allowRecurse;
  effect3._isEffect = true;
  effect3.active = true;
  effect3.raw = fn;
  effect3.deps = [];
  effect3.options = options;
  return effect3;
}
function cleanup(effect3) {
  const {deps} = effect3;
  if (deps.length) {
    for (let i = 0; i < deps.length; i++) {
      deps[i].delete(effect3);
    }
    deps.length = 0;
  }
}
var shouldTrack = true;
var trackStack = [];
function pauseTracking() {
  trackStack.push(shouldTrack);
  shouldTrack = false;
}
function enableTracking() {
  trackStack.push(shouldTrack);
  shouldTrack = true;
}
function resetTracking() {
  const last = trackStack.pop();
  shouldTrack = last === void 0 ? true : last;
}
function track(target, type, key) {
  if (!shouldTrack || activeEffect === void 0) {
    return;
  }
  let depsMap = targetMap.get(target);
  if (!depsMap) {
    targetMap.set(target, depsMap = new Map());
  }
  let dep = depsMap.get(key);
  if (!dep) {
    depsMap.set(key, dep = new Set());
  }
  if (!dep.has(activeEffect)) {
    dep.add(activeEffect);
    activeEffect.deps.push(dep);
    if (activeEffect.options.onTrack) {
      activeEffect.options.onTrack({
        effect: activeEffect,
        target,
        type,
        key
      });
    }
  }
}
function trigger(target, type, key, newValue, oldValue, oldTarget) {
  const depsMap = targetMap.get(target);
  if (!depsMap) {
    return;
  }
  const effects = new Set();
  const add2 = (effectsToAdd) => {
    if (effectsToAdd) {
      effectsToAdd.forEach((effect3) => {
        if (effect3 !== activeEffect || effect3.allowRecurse) {
          effects.add(effect3);
        }
      });
    }
  };
  if (type === "clear") {
    depsMap.forEach(add2);
  } else if (key === "length" && isArray(target)) {
    depsMap.forEach((dep, key2) => {
      if (key2 === "length" || key2 >= newValue) {
        add2(dep);
      }
    });
  } else {
    if (key !== void 0) {
      add2(depsMap.get(key));
    }
    switch (type) {
      case "add":
        if (!isArray(target)) {
          add2(depsMap.get(ITERATE_KEY));
          if (isMap(target)) {
            add2(depsMap.get(MAP_KEY_ITERATE_KEY));
          }
        } else if (isIntegerKey(key)) {
          add2(depsMap.get("length"));
        }
        break;
      case "delete":
        if (!isArray(target)) {
          add2(depsMap.get(ITERATE_KEY));
          if (isMap(target)) {
            add2(depsMap.get(MAP_KEY_ITERATE_KEY));
          }
        }
        break;
      case "set":
        if (isMap(target)) {
          add2(depsMap.get(ITERATE_KEY));
        }
        break;
    }
  }
  const run = (effect3) => {
    if (effect3.options.onTrigger) {
      effect3.options.onTrigger({
        effect: effect3,
        target,
        key,
        type,
        newValue,
        oldValue,
        oldTarget
      });
    }
    if (effect3.options.scheduler) {
      effect3.options.scheduler(effect3);
    } else {
      effect3();
    }
  };
  effects.forEach(run);
}
var isNonTrackableKeys = /* @__PURE__ */ makeMap(`__proto__,__v_isRef,__isVue`);
var builtInSymbols = new Set(Object.getOwnPropertyNames(Symbol).map((key) => Symbol[key]).filter(isSymbol));
var get2 = /* @__PURE__ */ createGetter();
var shallowGet = /* @__PURE__ */ createGetter(false, true);
var readonlyGet = /* @__PURE__ */ createGetter(true);
var shallowReadonlyGet = /* @__PURE__ */ createGetter(true, true);
var arrayInstrumentations = {};
["includes", "indexOf", "lastIndexOf"].forEach((key) => {
  const method = Array.prototype[key];
  arrayInstrumentations[key] = function(...args) {
    const arr = toRaw(this);
    for (let i = 0, l = this.length; i < l; i++) {
      track(arr, "get", i + "");
    }
    const res = method.apply(arr, args);
    if (res === -1 || res === false) {
      return method.apply(arr, args.map(toRaw));
    } else {
      return res;
    }
  };
});
["push", "pop", "shift", "unshift", "splice"].forEach((key) => {
  const method = Array.prototype[key];
  arrayInstrumentations[key] = function(...args) {
    pauseTracking();
    const res = method.apply(this, args);
    resetTracking();
    return res;
  };
});
function createGetter(isReadonly = false, shallow = false) {
  return function get3(target, key, receiver) {
    if (key === "__v_isReactive") {
      return !isReadonly;
    } else if (key === "__v_isReadonly") {
      return isReadonly;
    } else if (key === "__v_raw" && receiver === (isReadonly ? shallow ? shallowReadonlyMap : readonlyMap : shallow ? shallowReactiveMap : reactiveMap).get(target)) {
      return target;
    }
    const targetIsArray = isArray(target);
    if (!isReadonly && targetIsArray && hasOwn(arrayInstrumentations, key)) {
      return Reflect.get(arrayInstrumentations, key, receiver);
    }
    const res = Reflect.get(target, key, receiver);
    if (isSymbol(key) ? builtInSymbols.has(key) : isNonTrackableKeys(key)) {
      return res;
    }
    if (!isReadonly) {
      track(target, "get", key);
    }
    if (shallow) {
      return res;
    }
    if (isRef(res)) {
      const shouldUnwrap = !targetIsArray || !isIntegerKey(key);
      return shouldUnwrap ? res.value : res;
    }
    if (isObject(res)) {
      return isReadonly ? readonly(res) : reactive2(res);
    }
    return res;
  };
}
var set2 = /* @__PURE__ */ createSetter();
var shallowSet = /* @__PURE__ */ createSetter(true);
function createSetter(shallow = false) {
  return function set3(target, key, value, receiver) {
    let oldValue = target[key];
    if (!shallow) {
      value = toRaw(value);
      oldValue = toRaw(oldValue);
      if (!isArray(target) && isRef(oldValue) && !isRef(value)) {
        oldValue.value = value;
        return true;
      }
    }
    const hadKey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key);
    const result = Reflect.set(target, key, value, receiver);
    if (target === toRaw(receiver)) {
      if (!hadKey) {
        trigger(target, "add", key, value);
      } else if (hasChanged(value, oldValue)) {
        trigger(target, "set", key, value, oldValue);
      }
    }
    return result;
  };
}
function deleteProperty(target, key) {
  const hadKey = hasOwn(target, key);
  const oldValue = target[key];
  const result = Reflect.deleteProperty(target, key);
  if (result && hadKey) {
    trigger(target, "delete", key, void 0, oldValue);
  }
  return result;
}
function has(target, key) {
  const result = Reflect.has(target, key);
  if (!isSymbol(key) || !builtInSymbols.has(key)) {
    track(target, "has", key);
  }
  return result;
}
function ownKeys(target) {
  track(target, "iterate", isArray(target) ? "length" : ITERATE_KEY);
  return Reflect.ownKeys(target);
}
var mutableHandlers = {
  get: get2,
  set: set2,
  deleteProperty,
  has,
  ownKeys
};
var readonlyHandlers = {
  get: readonlyGet,
  set(target, key) {
    if (true) {
      console.warn(`Set operation on key "${String(key)}" failed: target is readonly.`, target);
    }
    return true;
  },
  deleteProperty(target, key) {
    if (true) {
      console.warn(`Delete operation on key "${String(key)}" failed: target is readonly.`, target);
    }
    return true;
  }
};
var shallowReactiveHandlers = extend({}, mutableHandlers, {
  get: shallowGet,
  set: shallowSet
});
var shallowReadonlyHandlers = extend({}, readonlyHandlers, {
  get: shallowReadonlyGet
});
var toReactive = (value) => isObject(value) ? reactive2(value) : value;
var toReadonly = (value) => isObject(value) ? readonly(value) : value;
var toShallow = (value) => value;
var getProto = (v) => Reflect.getPrototypeOf(v);
function get$1(target, key, isReadonly = false, isShallow = false) {
  target = target["__v_raw"];
  const rawTarget = toRaw(target);
  const rawKey = toRaw(key);
  if (key !== rawKey) {
    !isReadonly && track(rawTarget, "get", key);
  }
  !isReadonly && track(rawTarget, "get", rawKey);
  const {has: has2} = getProto(rawTarget);
  const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;
  if (has2.call(rawTarget, key)) {
    return wrap(target.get(key));
  } else if (has2.call(rawTarget, rawKey)) {
    return wrap(target.get(rawKey));
  } else if (target !== rawTarget) {
    target.get(key);
  }
}
function has$1(key, isReadonly = false) {
  const target = this["__v_raw"];
  const rawTarget = toRaw(target);
  const rawKey = toRaw(key);
  if (key !== rawKey) {
    !isReadonly && track(rawTarget, "has", key);
  }
  !isReadonly && track(rawTarget, "has", rawKey);
  return key === rawKey ? target.has(key) : target.has(key) || target.has(rawKey);
}
function size(target, isReadonly = false) {
  target = target["__v_raw"];
  !isReadonly && track(toRaw(target), "iterate", ITERATE_KEY);
  return Reflect.get(target, "size", target);
}
function add(value) {
  value = toRaw(value);
  const target = toRaw(this);
  const proto = getProto(target);
  const hadKey = proto.has.call(target, value);
  if (!hadKey) {
    target.add(value);
    trigger(target, "add", value, value);
  }
  return this;
}
function set$1(key, value) {
  value = toRaw(value);
  const target = toRaw(this);
  const {has: has2, get: get3} = getProto(target);
  let hadKey = has2.call(target, key);
  if (!hadKey) {
    key = toRaw(key);
    hadKey = has2.call(target, key);
  } else if (true) {
    checkIdentityKeys(target, has2, key);
  }
  const oldValue = get3.call(target, key);
  target.set(key, value);
  if (!hadKey) {
    trigger(target, "add", key, value);
  } else if (hasChanged(value, oldValue)) {
    trigger(target, "set", key, value, oldValue);
  }
  return this;
}
function deleteEntry(key) {
  const target = toRaw(this);
  const {has: has2, get: get3} = getProto(target);
  let hadKey = has2.call(target, key);
  if (!hadKey) {
    key = toRaw(key);
    hadKey = has2.call(target, key);
  } else if (true) {
    checkIdentityKeys(target, has2, key);
  }
  const oldValue = get3 ? get3.call(target, key) : void 0;
  const result = target.delete(key);
  if (hadKey) {
    trigger(target, "delete", key, void 0, oldValue);
  }
  return result;
}
function clear() {
  const target = toRaw(this);
  const hadItems = target.size !== 0;
  const oldTarget =  true ? isMap(target) ? new Map(target) : new Set(target) : 0;
  const result = target.clear();
  if (hadItems) {
    trigger(target, "clear", void 0, void 0, oldTarget);
  }
  return result;
}
function createForEach(isReadonly, isShallow) {
  return function forEach(callback, thisArg) {
    const observed = this;
    const target = observed["__v_raw"];
    const rawTarget = toRaw(target);
    const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;
    !isReadonly && track(rawTarget, "iterate", ITERATE_KEY);
    return target.forEach((value, key) => {
      return callback.call(thisArg, wrap(value), wrap(key), observed);
    });
  };
}
function createIterableMethod(method, isReadonly, isShallow) {
  return function(...args) {
    const target = this["__v_raw"];
    const rawTarget = toRaw(target);
    const targetIsMap = isMap(rawTarget);
    const isPair = method === "entries" || method === Symbol.iterator && targetIsMap;
    const isKeyOnly = method === "keys" && targetIsMap;
    const innerIterator = target[method](...args);
    const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;
    !isReadonly && track(rawTarget, "iterate", isKeyOnly ? MAP_KEY_ITERATE_KEY : ITERATE_KEY);
    return {
      next() {
        const {value, done} = innerIterator.next();
        return done ? {value, done} : {
          value: isPair ? [wrap(value[0]), wrap(value[1])] : wrap(value),
          done
        };
      },
      [Symbol.iterator]() {
        return this;
      }
    };
  };
}
function createReadonlyMethod(type) {
  return function(...args) {
    if (true) {
      const key = args[0] ? `on key "${args[0]}" ` : ``;
      console.warn(`${capitalize(type)} operation ${key}failed: target is readonly.`, toRaw(this));
    }
    return type === "delete" ? false : this;
  };
}
var mutableInstrumentations = {
  get(key) {
    return get$1(this, key);
  },
  get size() {
    return size(this);
  },
  has: has$1,
  add,
  set: set$1,
  delete: deleteEntry,
  clear,
  forEach: createForEach(false, false)
};
var shallowInstrumentations = {
  get(key) {
    return get$1(this, key, false, true);
  },
  get size() {
    return size(this);
  },
  has: has$1,
  add,
  set: set$1,
  delete: deleteEntry,
  clear,
  forEach: createForEach(false, true)
};
var readonlyInstrumentations = {
  get(key) {
    return get$1(this, key, true);
  },
  get size() {
    return size(this, true);
  },
  has(key) {
    return has$1.call(this, key, true);
  },
  add: createReadonlyMethod("add"),
  set: createReadonlyMethod("set"),
  delete: createReadonlyMethod("delete"),
  clear: createReadonlyMethod("clear"),
  forEach: createForEach(true, false)
};
var shallowReadonlyInstrumentations = {
  get(key) {
    return get$1(this, key, true, true);
  },
  get size() {
    return size(this, true);
  },
  has(key) {
    return has$1.call(this, key, true);
  },
  add: createReadonlyMethod("add"),
  set: createReadonlyMethod("set"),
  delete: createReadonlyMethod("delete"),
  clear: createReadonlyMethod("clear"),
  forEach: createForEach(true, true)
};
var iteratorMethods = ["keys", "values", "entries", Symbol.iterator];
iteratorMethods.forEach((method) => {
  mutableInstrumentations[method] = createIterableMethod(method, false, false);
  readonlyInstrumentations[method] = createIterableMethod(method, true, false);
  shallowInstrumentations[method] = createIterableMethod(method, false, true);
  shallowReadonlyInstrumentations[method] = createIterableMethod(method, true, true);
});
function createInstrumentationGetter(isReadonly, shallow) {
  const instrumentations = shallow ? isReadonly ? shallowReadonlyInstrumentations : shallowInstrumentations : isReadonly ? readonlyInstrumentations : mutableInstrumentations;
  return (target, key, receiver) => {
    if (key === "__v_isReactive") {
      return !isReadonly;
    } else if (key === "__v_isReadonly") {
      return isReadonly;
    } else if (key === "__v_raw") {
      return target;
    }
    return Reflect.get(hasOwn(instrumentations, key) && key in target ? instrumentations : target, key, receiver);
  };
}
var mutableCollectionHandlers = {
  get: createInstrumentationGetter(false, false)
};
var shallowCollectionHandlers = {
  get: createInstrumentationGetter(false, true)
};
var readonlyCollectionHandlers = {
  get: createInstrumentationGetter(true, false)
};
var shallowReadonlyCollectionHandlers = {
  get: createInstrumentationGetter(true, true)
};
function checkIdentityKeys(target, has2, key) {
  const rawKey = toRaw(key);
  if (rawKey !== key && has2.call(target, rawKey)) {
    const type = toRawType(target);
    console.warn(`Reactive ${type} contains both the raw and reactive versions of the same object${type === `Map` ? ` as keys` : ``}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`);
  }
}
var reactiveMap = new WeakMap();
var shallowReactiveMap = new WeakMap();
var readonlyMap = new WeakMap();
var shallowReadonlyMap = new WeakMap();
function targetTypeMap(rawType) {
  switch (rawType) {
    case "Object":
    case "Array":
      return 1;
    case "Map":
    case "Set":
    case "WeakMap":
    case "WeakSet":
      return 2;
    default:
      return 0;
  }
}
function getTargetType(value) {
  return value["__v_skip"] || !Object.isExtensible(value) ? 0 : targetTypeMap(toRawType(value));
}
function reactive2(target) {
  if (target && target["__v_isReadonly"]) {
    return target;
  }
  return createReactiveObject(target, false, mutableHandlers, mutableCollectionHandlers, reactiveMap);
}
function readonly(target) {
  return createReactiveObject(target, true, readonlyHandlers, readonlyCollectionHandlers, readonlyMap);
}
function createReactiveObject(target, isReadonly, baseHandlers, collectionHandlers, proxyMap) {
  if (!isObject(target)) {
    if (true) {
      console.warn(`value cannot be made reactive: ${String(target)}`);
    }
    return target;
  }
  if (target["__v_raw"] && !(isReadonly && target["__v_isReactive"])) {
    return target;
  }
  const existingProxy = proxyMap.get(target);
  if (existingProxy) {
    return existingProxy;
  }
  const targetType = getTargetType(target);
  if (targetType === 0) {
    return target;
  }
  const proxy = new Proxy(target, targetType === 2 ? collectionHandlers : baseHandlers);
  proxyMap.set(target, proxy);
  return proxy;
}
function toRaw(observed) {
  return observed && toRaw(observed["__v_raw"]) || observed;
}
function isRef(r) {
  return Boolean(r && r.__v_isRef === true);
}

// packages/alpinejs/src/magics/$nextTick.js
magic("nextTick", () => nextTick);

// packages/alpinejs/src/magics/$dispatch.js
magic("dispatch", (el) => dispatch.bind(dispatch, el));

// packages/alpinejs/src/magics/$watch.js
magic("watch", (el, {evaluateLater: evaluateLater2, effect: effect3}) => (key, callback) => {
  let evaluate2 = evaluateLater2(key);
  let firstTime = true;
  let oldValue;
  let effectReference = effect3(() => evaluate2((value) => {
    JSON.stringify(value);
    if (!firstTime) {
      queueMicrotask(() => {
        callback(value, oldValue);
        oldValue = value;
      });
    } else {
      oldValue = value;
    }
    firstTime = false;
  }));
  el._x_effects.delete(effectReference);
});

// packages/alpinejs/src/magics/$store.js
magic("store", getStores);

// packages/alpinejs/src/magics/$data.js
magic("data", (el) => scope(el));

// packages/alpinejs/src/magics/$root.js
magic("root", (el) => closestRoot(el));

// packages/alpinejs/src/magics/$refs.js
magic("refs", (el) => {
  if (el._x_refs_proxy)
    return el._x_refs_proxy;
  el._x_refs_proxy = mergeProxies(getArrayOfRefObject(el));
  return el._x_refs_proxy;
});
function getArrayOfRefObject(el) {
  let refObjects = [];
  let currentEl = el;
  while (currentEl) {
    if (currentEl._x_refs)
      refObjects.push(currentEl._x_refs);
    currentEl = currentEl.parentNode;
  }
  return refObjects;
}

// packages/alpinejs/src/ids.js
var globalIdMemo = {};
function findAndIncrementId(name) {
  if (!globalIdMemo[name])
    globalIdMemo[name] = 0;
  return ++globalIdMemo[name];
}
function closestIdRoot(el, name) {
  return findClosest(el, (element) => {
    if (element._x_ids && element._x_ids[name])
      return true;
  });
}
function setIdRoot(el, name) {
  if (!el._x_ids)
    el._x_ids = {};
  if (!el._x_ids[name])
    el._x_ids[name] = findAndIncrementId(name);
}

// packages/alpinejs/src/magics/$id.js
magic("id", (el) => (name, key = null) => {
  let root = closestIdRoot(el, name);
  let id = root ? root._x_ids[name] : findAndIncrementId(name);
  return key ? `${name}-${id}-${key}` : `${name}-${id}`;
});

// packages/alpinejs/src/magics/$el.js
magic("el", (el) => el);

// packages/alpinejs/src/magics/index.js
warnMissingPluginMagic("Focus", "focus", "focus");
warnMissingPluginMagic("Persist", "persist", "persist");
function warnMissingPluginMagic(name, magicName, slug) {
  magic(magicName, (el) => warn(`You can't use [$${directiveName}] without first installing the "${name}" plugin here: https://alpinejs.dev/plugins/${slug}`, el));
}

// packages/alpinejs/src/directives/x-modelable.js
directive("modelable", (el, {expression}, {effect: effect3, evaluateLater: evaluateLater2}) => {
  let func = evaluateLater2(expression);
  let innerGet = () => {
    let result;
    func((i) => result = i);
    return result;
  };
  let evaluateInnerSet = evaluateLater2(`${expression} = __placeholder`);
  let innerSet = (val) => evaluateInnerSet(() => {
  }, {scope: {__placeholder: val}});
  let initialValue = innerGet();
  innerSet(initialValue);
  queueMicrotask(() => {
    if (!el._x_model)
      return;
    el._x_removeModelListeners["default"]();
    let outerGet = el._x_model.get;
    let outerSet = el._x_model.set;
    effect3(() => innerSet(outerGet()));
    effect3(() => outerSet(innerGet()));
  });
});

// packages/alpinejs/src/directives/x-teleport.js
directive("teleport", (el, {expression}, {cleanup: cleanup2}) => {
  if (el.tagName.toLowerCase() !== "template")
    warn("x-teleport can only be used on a <template> tag", el);
  let target = document.querySelector(expression);
  if (!target)
    warn(`Cannot find x-teleport element for selector: "${expression}"`);
  let clone2 = el.content.cloneNode(true).firstElementChild;
  el._x_teleport = clone2;
  clone2._x_teleportBack = el;
  if (el._x_forwardEvents) {
    el._x_forwardEvents.forEach((eventName) => {
      clone2.addEventListener(eventName, (e) => {
        e.stopPropagation();
        el.dispatchEvent(new e.constructor(e.type, e));
      });
    });
  }
  addScopeToNode(clone2, {}, el);
  mutateDom(() => {
    target.appendChild(clone2);
    initTree(clone2);
    clone2._x_ignore = true;
  });
  cleanup2(() => clone2.remove());
});

// packages/alpinejs/src/directives/x-ignore.js
var handler = () => {
};
handler.inline = (el, {modifiers}, {cleanup: cleanup2}) => {
  modifiers.includes("self") ? el._x_ignoreSelf = true : el._x_ignore = true;
  cleanup2(() => {
    modifiers.includes("self") ? delete el._x_ignoreSelf : delete el._x_ignore;
  });
};
directive("ignore", handler);

// packages/alpinejs/src/directives/x-effect.js
directive("effect", (el, {expression}, {effect: effect3}) => effect3(evaluateLater(el, expression)));

// packages/alpinejs/src/utils/on.js
function on(el, event, modifiers, callback) {
  let listenerTarget = el;
  let handler3 = (e) => callback(e);
  let options = {};
  let wrapHandler = (callback2, wrapper) => (e) => wrapper(callback2, e);
  if (modifiers.includes("dot"))
    event = dotSyntax(event);
  if (modifiers.includes("camel"))
    event = camelCase2(event);
  if (modifiers.includes("passive"))
    options.passive = true;
  if (modifiers.includes("capture"))
    options.capture = true;
  if (modifiers.includes("window"))
    listenerTarget = window;
  if (modifiers.includes("document"))
    listenerTarget = document;
  if (modifiers.includes("prevent"))
    handler3 = wrapHandler(handler3, (next, e) => {
      e.preventDefault();
      next(e);
    });
  if (modifiers.includes("stop"))
    handler3 = wrapHandler(handler3, (next, e) => {
      e.stopPropagation();
      next(e);
    });
  if (modifiers.includes("self"))
    handler3 = wrapHandler(handler3, (next, e) => {
      e.target === el && next(e);
    });
  if (modifiers.includes("away") || modifiers.includes("outside")) {
    listenerTarget = document;
    handler3 = wrapHandler(handler3, (next, e) => {
      if (el.contains(e.target))
        return;
      if (e.target.isConnected === false)
        return;
      if (el.offsetWidth < 1 && el.offsetHeight < 1)
        return;
      if (el._x_isShown === false)
        return;
      next(e);
    });
  }
  if (modifiers.includes("once")) {
    handler3 = wrapHandler(handler3, (next, e) => {
      next(e);
      listenerTarget.removeEventListener(event, handler3, options);
    });
  }
  handler3 = wrapHandler(handler3, (next, e) => {
    if (isKeyEvent(event)) {
      if (isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers)) {
        return;
      }
    }
    next(e);
  });
  if (modifiers.includes("debounce")) {
    let nextModifier = modifiers[modifiers.indexOf("debounce") + 1] || "invalid-wait";
    let wait = isNumeric(nextModifier.split("ms")[0]) ? Number(nextModifier.split("ms")[0]) : 250;
    handler3 = debounce(handler3, wait);
  }
  if (modifiers.includes("throttle")) {
    let nextModifier = modifiers[modifiers.indexOf("throttle") + 1] || "invalid-wait";
    let wait = isNumeric(nextModifier.split("ms")[0]) ? Number(nextModifier.split("ms")[0]) : 250;
    handler3 = throttle(handler3, wait);
  }
  listenerTarget.addEventListener(event, handler3, options);
  return () => {
    listenerTarget.removeEventListener(event, handler3, options);
  };
}
function dotSyntax(subject) {
  return subject.replace(/-/g, ".");
}
function camelCase2(subject) {
  return subject.toLowerCase().replace(/-(\w)/g, (match, char) => char.toUpperCase());
}
function isNumeric(subject) {
  return !Array.isArray(subject) && !isNaN(subject);
}
function kebabCase2(subject) {
  return subject.replace(/([a-z])([A-Z])/g, "$1-$2").replace(/[_\s]/, "-").toLowerCase();
}
function isKeyEvent(event) {
  return ["keydown", "keyup"].includes(event);
}
function isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers) {
  let keyModifiers = modifiers.filter((i) => {
    return !["window", "document", "prevent", "stop", "once"].includes(i);
  });
  if (keyModifiers.includes("debounce")) {
    let debounceIndex = keyModifiers.indexOf("debounce");
    keyModifiers.splice(debounceIndex, isNumeric((keyModifiers[debounceIndex + 1] || "invalid-wait").split("ms")[0]) ? 2 : 1);
  }
  if (keyModifiers.length === 0)
    return false;
  if (keyModifiers.length === 1 && keyToModifiers(e.key).includes(keyModifiers[0]))
    return false;
  const systemKeyModifiers = ["ctrl", "shift", "alt", "meta", "cmd", "super"];
  const selectedSystemKeyModifiers = systemKeyModifiers.filter((modifier) => keyModifiers.includes(modifier));
  keyModifiers = keyModifiers.filter((i) => !selectedSystemKeyModifiers.includes(i));
  if (selectedSystemKeyModifiers.length > 0) {
    const activelyPressedKeyModifiers = selectedSystemKeyModifiers.filter((modifier) => {
      if (modifier === "cmd" || modifier === "super")
        modifier = "meta";
      return e[`${modifier}Key`];
    });
    if (activelyPressedKeyModifiers.length === selectedSystemKeyModifiers.length) {
      if (keyToModifiers(e.key).includes(keyModifiers[0]))
        return false;
    }
  }
  return true;
}
function keyToModifiers(key) {
  if (!key)
    return [];
  key = kebabCase2(key);
  let modifierToKeyMap = {
    ctrl: "control",
    slash: "/",
    space: "-",
    spacebar: "-",
    cmd: "meta",
    esc: "escape",
    up: "arrow-up",
    down: "arrow-down",
    left: "arrow-left",
    right: "arrow-right",
    period: ".",
    equal: "="
  };
  modifierToKeyMap[key] = key;
  return Object.keys(modifierToKeyMap).map((modifier) => {
    if (modifierToKeyMap[modifier] === key)
      return modifier;
  }).filter((modifier) => modifier);
}

// packages/alpinejs/src/directives/x-model.js
directive("model", (el, {modifiers, expression}, {effect: effect3, cleanup: cleanup2}) => {
  let evaluate2 = evaluateLater(el, expression);
  let assignmentExpression = `${expression} = rightSideOfExpression($event, ${expression})`;
  let evaluateAssignment = evaluateLater(el, assignmentExpression);
  var event = el.tagName.toLowerCase() === "select" || ["checkbox", "radio"].includes(el.type) || modifiers.includes("lazy") ? "change" : "input";
  let assigmentFunction = generateAssignmentFunction(el, modifiers, expression);
  let removeListener = on(el, event, modifiers, (e) => {
    evaluateAssignment(() => {
    }, {scope: {
      $event: e,
      rightSideOfExpression: assigmentFunction
    }});
  });
  if (!el._x_removeModelListeners)
    el._x_removeModelListeners = {};
  el._x_removeModelListeners["default"] = removeListener;
  cleanup2(() => el._x_removeModelListeners["default"]());
  let evaluateSetModel = evaluateLater(el, `${expression} = __placeholder`);
  el._x_model = {
    get() {
      let result;
      evaluate2((value) => result = value);
      return result;
    },
    set(value) {
      evaluateSetModel(() => {
      }, {scope: {__placeholder: value}});
    }
  };
  el._x_forceModelUpdate = () => {
    evaluate2((value) => {
      if (value === void 0 && expression.match(/\./))
        value = "";
      window.fromModel = true;
      mutateDom(() => bind(el, "value", value));
      delete window.fromModel;
    });
  };
  effect3(() => {
    if (modifiers.includes("unintrusive") && document.activeElement.isSameNode(el))
      return;
    el._x_forceModelUpdate();
  });
});
function generateAssignmentFunction(el, modifiers, expression) {
  if (el.type === "radio") {
    mutateDom(() => {
      if (!el.hasAttribute("name"))
        el.setAttribute("name", expression);
    });
  }
  return (event, currentValue) => {
    return mutateDom(() => {
      if (event instanceof CustomEvent && event.detail !== void 0) {
        return event.detail || event.target.value;
      } else if (el.type === "checkbox") {
        if (Array.isArray(currentValue)) {
          let newValue = modifiers.includes("number") ? safeParseNumber(event.target.value) : event.target.value;
          return event.target.checked ? currentValue.concat([newValue]) : currentValue.filter((el2) => !checkedAttrLooseCompare2(el2, newValue));
        } else {
          return event.target.checked;
        }
      } else if (el.tagName.toLowerCase() === "select" && el.multiple) {
        return modifiers.includes("number") ? Array.from(event.target.selectedOptions).map((option) => {
          let rawValue = option.value || option.text;
          return safeParseNumber(rawValue);
        }) : Array.from(event.target.selectedOptions).map((option) => {
          return option.value || option.text;
        });
      } else {
        let rawValue = event.target.value;
        return modifiers.includes("number") ? safeParseNumber(rawValue) : modifiers.includes("trim") ? rawValue.trim() : rawValue;
      }
    });
  };
}
function safeParseNumber(rawValue) {
  let number = rawValue ? parseFloat(rawValue) : null;
  return isNumeric2(number) ? number : rawValue;
}
function checkedAttrLooseCompare2(valueA, valueB) {
  return valueA == valueB;
}
function isNumeric2(subject) {
  return !Array.isArray(subject) && !isNaN(subject);
}

// packages/alpinejs/src/directives/x-cloak.js
directive("cloak", (el) => queueMicrotask(() => mutateDom(() => el.removeAttribute(prefix("cloak")))));

// packages/alpinejs/src/directives/x-init.js
addInitSelector(() => `[${prefix("init")}]`);
directive("init", skipDuringClone((el, {expression}, {evaluate: evaluate2}) => {
  if (typeof expression === "string") {
    return !!expression.trim() && evaluate2(expression, {}, false);
  }
  return evaluate2(expression, {}, false);
}));

// packages/alpinejs/src/directives/x-text.js
directive("text", (el, {expression}, {effect: effect3, evaluateLater: evaluateLater2}) => {
  let evaluate2 = evaluateLater2(expression);
  effect3(() => {
    evaluate2((value) => {
      mutateDom(() => {
        el.textContent = value;
      });
    });
  });
});

// packages/alpinejs/src/directives/x-html.js
directive("html", (el, {expression}, {effect: effect3, evaluateLater: evaluateLater2}) => {
  let evaluate2 = evaluateLater2(expression);
  effect3(() => {
    evaluate2((value) => {
      mutateDom(() => {
        el.innerHTML = value;
        el._x_ignoreSelf = true;
        initTree(el);
        delete el._x_ignoreSelf;
      });
    });
  });
});

// packages/alpinejs/src/directives/x-bind.js
mapAttributes(startingWith(":", into(prefix("bind:"))));
directive("bind", (el, {value, modifiers, expression, original}, {effect: effect3}) => {
  if (!value) {
    let bindingProviders = {};
    injectBindingProviders(bindingProviders);
    let getBindings = evaluateLater(el, expression);
    getBindings((bindings) => {
      applyBindingsObject(el, bindings, original);
    }, {scope: bindingProviders});
    return;
  }
  if (value === "key")
    return storeKeyForXFor(el, expression);
  let evaluate2 = evaluateLater(el, expression);
  effect3(() => evaluate2((result) => {
    if (result === void 0 && typeof expression === "string" && expression.match(/\./)) {
      result = "";
    }
    mutateDom(() => bind(el, value, result, modifiers));
  }));
});
function storeKeyForXFor(el, expression) {
  el._x_keyExpression = expression;
}

// packages/alpinejs/src/directives/x-data.js
addRootSelector(() => `[${prefix("data")}]`);
directive("data", skipDuringClone((el, {expression}, {cleanup: cleanup2}) => {
  expression = expression === "" ? "{}" : expression;
  let magicContext = {};
  injectMagics(magicContext, el);
  let dataProviderContext = {};
  injectDataProviders(dataProviderContext, magicContext);
  let data2 = evaluate(el, expression, {scope: dataProviderContext});
  if (data2 === void 0)
    data2 = {};
  injectMagics(data2, el);
  let reactiveData = reactive(data2);
  initInterceptors(reactiveData);
  let undo = addScopeToNode(el, reactiveData);
  reactiveData["init"] && evaluate(el, reactiveData["init"]);
  cleanup2(() => {
    reactiveData["destroy"] && evaluate(el, reactiveData["destroy"]);
    undo();
  });
}));

// packages/alpinejs/src/directives/x-show.js
directive("show", (el, {modifiers, expression}, {effect: effect3}) => {
  let evaluate2 = evaluateLater(el, expression);
  if (!el._x_doHide)
    el._x_doHide = () => {
      mutateDom(() => {
        el.style.setProperty("display", "none", modifiers.includes("important") ? "important" : void 0);
      });
    };
  if (!el._x_doShow)
    el._x_doShow = () => {
      mutateDom(() => {
        if (el.style.length === 1 && el.style.display === "none") {
          el.removeAttribute("style");
        } else {
          el.style.removeProperty("display");
        }
      });
    };
  let hide = () => {
    el._x_doHide();
    el._x_isShown = false;
  };
  let show = () => {
    el._x_doShow();
    el._x_isShown = true;
  };
  let clickAwayCompatibleShow = () => setTimeout(show);
  let toggle = once((value) => value ? show() : hide(), (value) => {
    if (typeof el._x_toggleAndCascadeWithTransitions === "function") {
      el._x_toggleAndCascadeWithTransitions(el, value, show, hide);
    } else {
      value ? clickAwayCompatibleShow() : hide();
    }
  });
  let oldValue;
  let firstTime = true;
  effect3(() => evaluate2((value) => {
    if (!firstTime && value === oldValue)
      return;
    if (modifiers.includes("immediate"))
      value ? clickAwayCompatibleShow() : hide();
    toggle(value);
    oldValue = value;
    firstTime = false;
  }));
});

// packages/alpinejs/src/directives/x-for.js
directive("for", (el, {expression}, {effect: effect3, cleanup: cleanup2}) => {
  let iteratorNames = parseForExpression(expression);
  let evaluateItems = evaluateLater(el, iteratorNames.items);
  let evaluateKey = evaluateLater(el, el._x_keyExpression || "index");
  el._x_prevKeys = [];
  el._x_lookup = {};
  effect3(() => loop(el, iteratorNames, evaluateItems, evaluateKey));
  cleanup2(() => {
    Object.values(el._x_lookup).forEach((el2) => el2.remove());
    delete el._x_prevKeys;
    delete el._x_lookup;
  });
});
function loop(el, iteratorNames, evaluateItems, evaluateKey) {
  let isObject2 = (i) => typeof i === "object" && !Array.isArray(i);
  let templateEl = el;
  evaluateItems((items) => {
    if (isNumeric3(items) && items >= 0) {
      items = Array.from(Array(items).keys(), (i) => i + 1);
    }
    if (items === void 0)
      items = [];
    let lookup = el._x_lookup;
    let prevKeys = el._x_prevKeys;
    let scopes = [];
    let keys = [];
    if (isObject2(items)) {
      items = Object.entries(items).map(([key, value]) => {
        let scope2 = getIterationScopeVariables(iteratorNames, value, key, items);
        evaluateKey((value2) => keys.push(value2), {scope: {index: key, ...scope2}});
        scopes.push(scope2);
      });
    } else {
      for (let i = 0; i < items.length; i++) {
        let scope2 = getIterationScopeVariables(iteratorNames, items[i], i, items);
        evaluateKey((value) => keys.push(value), {scope: {index: i, ...scope2}});
        scopes.push(scope2);
      }
    }
    let adds = [];
    let moves = [];
    let removes = [];
    let sames = [];
    for (let i = 0; i < prevKeys.length; i++) {
      let key = prevKeys[i];
      if (keys.indexOf(key) === -1)
        removes.push(key);
    }
    prevKeys = prevKeys.filter((key) => !removes.includes(key));
    let lastKey = "template";
    for (let i = 0; i < keys.length; i++) {
      let key = keys[i];
      let prevIndex = prevKeys.indexOf(key);
      if (prevIndex === -1) {
        prevKeys.splice(i, 0, key);
        adds.push([lastKey, i]);
      } else if (prevIndex !== i) {
        let keyInSpot = prevKeys.splice(i, 1)[0];
        let keyForSpot = prevKeys.splice(prevIndex - 1, 1)[0];
        prevKeys.splice(i, 0, keyForSpot);
        prevKeys.splice(prevIndex, 0, keyInSpot);
        moves.push([keyInSpot, keyForSpot]);
      } else {
        sames.push(key);
      }
      lastKey = key;
    }
    for (let i = 0; i < removes.length; i++) {
      let key = removes[i];
      if (!!lookup[key]._x_effects) {
        lookup[key]._x_effects.forEach(dequeueJob);
      }
      lookup[key].remove();
      lookup[key] = null;
      delete lookup[key];
    }
    for (let i = 0; i < moves.length; i++) {
      let [keyInSpot, keyForSpot] = moves[i];
      let elInSpot = lookup[keyInSpot];
      let elForSpot = lookup[keyForSpot];
      let marker = document.createElement("div");
      mutateDom(() => {
        elForSpot.after(marker);
        elInSpot.after(elForSpot);
        elForSpot._x_currentIfEl && elForSpot.after(elForSpot._x_currentIfEl);
        marker.before(elInSpot);
        elInSpot._x_currentIfEl && elInSpot.after(elInSpot._x_currentIfEl);
        marker.remove();
      });
      refreshScope(elForSpot, scopes[keys.indexOf(keyForSpot)]);
    }
    for (let i = 0; i < adds.length; i++) {
      let [lastKey2, index] = adds[i];
      let lastEl = lastKey2 === "template" ? templateEl : lookup[lastKey2];
      if (lastEl._x_currentIfEl)
        lastEl = lastEl._x_currentIfEl;
      let scope2 = scopes[index];
      let key = keys[index];
      let clone2 = document.importNode(templateEl.content, true).firstElementChild;
      addScopeToNode(clone2, reactive(scope2), templateEl);
      mutateDom(() => {
        lastEl.after(clone2);
        initTree(clone2);
      });
      if (typeof key === "object") {
        warn("x-for key cannot be an object, it must be a string or an integer", templateEl);
      }
      lookup[key] = clone2;
    }
    for (let i = 0; i < sames.length; i++) {
      refreshScope(lookup[sames[i]], scopes[keys.indexOf(sames[i])]);
    }
    templateEl._x_prevKeys = keys;
  });
}
function parseForExpression(expression) {
  let forIteratorRE = /,([^,\}\]]*)(?:,([^,\}\]]*))?$/;
  let stripParensRE = /^\s*\(|\)\s*$/g;
  let forAliasRE = /([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/;
  let inMatch = expression.match(forAliasRE);
  if (!inMatch)
    return;
  let res = {};
  res.items = inMatch[2].trim();
  let item = inMatch[1].replace(stripParensRE, "").trim();
  let iteratorMatch = item.match(forIteratorRE);
  if (iteratorMatch) {
    res.item = item.replace(forIteratorRE, "").trim();
    res.index = iteratorMatch[1].trim();
    if (iteratorMatch[2]) {
      res.collection = iteratorMatch[2].trim();
    }
  } else {
    res.item = item;
  }
  return res;
}
function getIterationScopeVariables(iteratorNames, item, index, items) {
  let scopeVariables = {};
  if (/^\[.*\]$/.test(iteratorNames.item) && Array.isArray(item)) {
    let names = iteratorNames.item.replace("[", "").replace("]", "").split(",").map((i) => i.trim());
    names.forEach((name, i) => {
      scopeVariables[name] = item[i];
    });
  } else if (/^\{.*\}$/.test(iteratorNames.item) && !Array.isArray(item) && typeof item === "object") {
    let names = iteratorNames.item.replace("{", "").replace("}", "").split(",").map((i) => i.trim());
    names.forEach((name) => {
      scopeVariables[name] = item[name];
    });
  } else {
    scopeVariables[iteratorNames.item] = item;
  }
  if (iteratorNames.index)
    scopeVariables[iteratorNames.index] = index;
  if (iteratorNames.collection)
    scopeVariables[iteratorNames.collection] = items;
  return scopeVariables;
}
function isNumeric3(subject) {
  return !Array.isArray(subject) && !isNaN(subject);
}

// packages/alpinejs/src/directives/x-ref.js
function handler2() {
}
handler2.inline = (el, {expression}, {cleanup: cleanup2}) => {
  let root = closestRoot(el);
  if (!root._x_refs)
    root._x_refs = {};
  root._x_refs[expression] = el;
  cleanup2(() => delete root._x_refs[expression]);
};
directive("ref", handler2);

// packages/alpinejs/src/directives/x-if.js
directive("if", (el, {expression}, {effect: effect3, cleanup: cleanup2}) => {
  let evaluate2 = evaluateLater(el, expression);
  let show = () => {
    if (el._x_currentIfEl)
      return el._x_currentIfEl;
    let clone2 = el.content.cloneNode(true).firstElementChild;
    addScopeToNode(clone2, {}, el);
    mutateDom(() => {
      el.after(clone2);
      initTree(clone2);
    });
    el._x_currentIfEl = clone2;
    el._x_undoIf = () => {
      walk(clone2, (node) => {
        if (!!node._x_effects) {
          node._x_effects.forEach(dequeueJob);
        }
      });
      clone2.remove();
      delete el._x_currentIfEl;
    };
    return clone2;
  };
  let hide = () => {
    if (!el._x_undoIf)
      return;
    el._x_undoIf();
    delete el._x_undoIf;
  };
  effect3(() => evaluate2((value) => {
    value ? show() : hide();
  }));
  cleanup2(() => el._x_undoIf && el._x_undoIf());
});

// packages/alpinejs/src/directives/x-id.js
directive("id", (el, {expression}, {evaluate: evaluate2}) => {
  let names = evaluate2(expression);
  names.forEach((name) => setIdRoot(el, name));
});

// packages/alpinejs/src/directives/x-on.js
mapAttributes(startingWith("@", into(prefix("on:"))));
directive("on", skipDuringClone((el, {value, modifiers, expression}, {cleanup: cleanup2}) => {
  let evaluate2 = expression ? evaluateLater(el, expression) : () => {
  };
  if (el.tagName.toLowerCase() === "template") {
    if (!el._x_forwardEvents)
      el._x_forwardEvents = [];
    if (!el._x_forwardEvents.includes(value))
      el._x_forwardEvents.push(value);
  }
  let removeListener = on(el, value, modifiers, (e) => {
    evaluate2(() => {
    }, {scope: {$event: e}, params: [e]});
  });
  cleanup2(() => removeListener());
}));

// packages/alpinejs/src/directives/index.js
warnMissingPluginDirective("Collapse", "collapse", "collapse");
warnMissingPluginDirective("Intersect", "intersect", "intersect");
warnMissingPluginDirective("Focus", "trap", "focus");
warnMissingPluginDirective("Mask", "mask", "mask");
function warnMissingPluginDirective(name, directiveName2, slug) {
  directive(directiveName2, (el) => warn(`You can't use [x-${directiveName2}] without first installing the "${name}" plugin here: https://alpinejs.dev/plugins/${slug}`, el));
}

// packages/alpinejs/src/index.js
alpine_default.setEvaluator(normalEvaluator);
alpine_default.setReactivityEngine({reactive: reactive2, effect: effect2, release: stop, raw: toRaw});
var src_default = alpine_default;

// packages/alpinejs/builds/module.js
var module_default = src_default;



/***/ }),

/***/ "./resources/js/helpers/darkMode.js":
/*!******************************************!*\
  !*** ./resources/js/helpers/darkMode.js ***!
  \******************************************/
/***/ (() => {

/**
 * Make dark mode switch.
 *
 * @type {HTMLCollectionOf<Element>}
 */
var darkModeToggles = document.getElementsByClassName('darkModeToggle');

if (localStorage.theme === 'dark' || !('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches) {
  document.documentElement.classList.add('dark');
} else {
  document.documentElement.classList.remove('dark');
}

for (var i = 0; i < darkModeToggles.length; i++) {
  darkModeToggles[i].onclick = function () {
    if (localStorage.theme === 'light') {
      localStorage.theme = 'dark';
      document.querySelector('html').classList.add('dark');
      document.querySelector('html').classList.remove('light');
    } else {
      localStorage.theme = 'light';
      document.querySelector('html').classList.remove('dark');
      document.querySelector('html').classList.add('light');
    }
  };
}

/***/ }),

/***/ "./resources/js/helpers/window.js":
/*!****************************************!*\
  !*** ./resources/js/helpers/window.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var choices_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! choices.js */ "./node_modules/choices.js/public/assets/scripts/choices.js");
/* harmony import */ var choices_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(choices_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var tom_select__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tom-select */ "./node_modules/tom-select/dist/js/tom-select.complete.js");
/* harmony import */ var tom_select__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(tom_select__WEBPACK_IMPORTED_MODULE_1__);



window.choices = function (element) {
  return new (choices_js__WEBPACK_IMPORTED_MODULE_0___default())(element, {
    removeItemButton: true
  });
};

window.tomSelect = function (element) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  return new (tom_select__WEBPACK_IMPORTED_MODULE_1___default())(element, options);
};

window.scrollToPosition = function (selector) {
  return document.querySelector(selector).scrollIntoView({
    behavior: 'smooth',
    block: 'end'
  });
};

/***/ }),

/***/ "./resources/js/plugins/internationalNumber.js":
/*!*****************************************************!*\
  !*** ./resources/js/plugins/internationalNumber.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var intl_tel_input__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! intl-tel-input */ "./node_modules/intl-tel-input/index.js");
/* harmony import */ var intl_tel_input__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(intl_tel_input__WEBPACK_IMPORTED_MODULE_0__);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (element) {
  return {
    input: element,
    init: function init() {
      var phoneNumber = document.querySelector(this.input);
      var iti = intl_tel_input__WEBPACK_IMPORTED_MODULE_0___default()(phoneNumber, {
        nationalMode: true,
        geoIpLookup: function geoIpLookup(success, failure) {
          fetch('https://ipinfo.io').then(function (response) {
            var countryCode = response && response.country ? response.country : 'CM';
            success(countryCode);
          });
        },
        utilsScript: 'https://unpkg.com/intl-tel-input@17.0.3/build/js/utils.js'
      });

      var handleChange = function handleChange() {
        if (iti.isValidNumber()) {
          phoneNumber.value = iti.getNumber();
        }
      };

      phoneNumber.addEventListener('change', handleChange);
      phoneNumber.addEventListener('keyup', handleChange);
    }
  };
});

/***/ }),

/***/ "./resources/js/plugins/mapBox.js":
/*!****************************************!*\
  !*** ./resources/js/plugins/mapBox.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var mapbox_gl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mapbox-gl */ "./node_modules/mapbox-gl/dist/mapbox-gl.js");
/* harmony import */ var mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mapbox_gl__WEBPACK_IMPORTED_MODULE_0__);

/**
 * MapBox Alpine plugin.
 *
 * @param {string} element
 * @param {string} token
 * @returns {{container, init(): void, lng: number, zoom: number, lat: number, token}}
 */

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (element, token) {
  return {
    container: element,
    token: token,
    lng: 9.9237,
    lat: 4.26397,
    zoom: 5,
    marker: null,
    init: function init() {
      var _this = this;

      (mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default().accessToken) = token;
      var map = new (mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default().Map)({
        container: this.container,
        style: 'mapbox://styles/mapbox/streets-v11',
        center: [this.lng, this.lat],
        zoom: this.zoom
      }); // Add navigation control (the +/- zoom buttons)

      map.addControl(new (mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default().NavigationControl)(), 'top-right'); // Add geolocate control to the map.

      map.addControl(new (mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default().GeolocateControl)({
        positionOptions: {
          enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true
      })); // Create a new marker.

      this.marker = new (mapbox_gl__WEBPACK_IMPORTED_MODULE_0___default().Marker)({
        draggable: true
      }).setLngLat([this.lng, this.lat]).addTo(map);
      this.marker.on('drag', function () {
        var lngLat = _this.marker.getLngLat();

        _this.lng = lngLat.lng.toFixed(4);
        _this.lat = lngLat.lat.toFixed(4);
      });
    }
  };
});

/***/ }),

/***/ "./resources/js/shopper.js":
/*!*********************************!*\
  !*** ./resources/js/shopper.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var alpinejs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! alpinejs */ "./node_modules/alpinejs/dist/module.esm.js");
/* harmony import */ var _alpinejs_focus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @alpinejs/focus */ "./node_modules/@alpinejs/focus/dist/module.esm.js");
/* harmony import */ var sortablejs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sortablejs */ "./node_modules/sortablejs/modular/sortable.esm.js");
/* harmony import */ var filepond__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! filepond */ "./node_modules/filepond/dist/filepond.js");
/* harmony import */ var filepond__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(filepond__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _ryangjchandler_alpine_tooltip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ryangjchandler/alpine-tooltip */ "./node_modules/@ryangjchandler/alpine-tooltip/dist/module.esm.js");
/* harmony import */ var _vendor_filament_forms_dist_module_esm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../vendor/filament/forms/dist/module.esm */ "./vendor/filament/forms/dist/module.esm.js");
/* harmony import */ var _vendor_filament_notifications_dist_module_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../vendor/filament/notifications/dist/module.esm */ "./vendor/filament/notifications/dist/module.esm.js");
/* harmony import */ var _helpers_window__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @helpers/window */ "./resources/js/helpers/window.js");
/* harmony import */ var _helpers_darkMode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @helpers/darkMode */ "./resources/js/helpers/darkMode.js");
/* harmony import */ var _helpers_darkMode__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_helpers_darkMode__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _plugins_internationalNumber__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./plugins/internationalNumber */ "./resources/js/plugins/internationalNumber.js");
/* harmony import */ var _plugins_mapBox__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./plugins/mapBox */ "./resources/js/plugins/mapBox.js");











alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].plugin(_ryangjchandler_alpine_tooltip__WEBPACK_IMPORTED_MODULE_4__["default"]);
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].plugin(_alpinejs_focus__WEBPACK_IMPORTED_MODULE_1__["default"]);
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].plugin(_vendor_filament_forms_dist_module_esm__WEBPACK_IMPORTED_MODULE_5__["default"]);
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].plugin(_vendor_filament_notifications_dist_module_esm__WEBPACK_IMPORTED_MODULE_6__["default"]);
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].data('internationalNumber', _plugins_internationalNumber__WEBPACK_IMPORTED_MODULE_9__["default"]);
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].data('mapBox', _plugins_mapBox__WEBPACK_IMPORTED_MODULE_10__["default"]);
window.Alpine = alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"];
window.Sortable = sortablejs__WEBPACK_IMPORTED_MODULE_2__["default"];
window.FilePond = filepond__WEBPACK_IMPORTED_MODULE_3__;
alpinejs__WEBPACK_IMPORTED_MODULE_0__["default"].start();

/***/ }),

/***/ "./vendor/filament/forms/dist/module.esm.js":
/*!**************************************************!*\
  !*** ./vendor/filament/forms/dist/module.esm.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AlpineFloatingUI": () => (/* binding */ module_default),
/* harmony export */   "ColorPickerFormComponentAlpinePlugin": () => (/* binding */ color_picker_default2),
/* harmony export */   "DateTimePickerFormComponentAlpinePlugin": () => (/* binding */ date_time_picker_default),
/* harmony export */   "FileUploadFormComponentAlpinePlugin": () => (/* binding */ file_upload_default),
/* harmony export */   "KeyValueFormComponentAlpinePlugin": () => (/* binding */ key_value_default),
/* harmony export */   "MarkdownEditorFormComponentAlpinePlugin": () => (/* binding */ markdown_editor_default),
/* harmony export */   "RichEditorFormComponentAlpinePlugin": () => (/* binding */ rich_editor_default),
/* harmony export */   "SelectFormComponentAlpinePlugin": () => (/* binding */ select_default),
/* harmony export */   "SortableAlpinePlugin": () => (/* binding */ sortable_default),
/* harmony export */   "TagsInputFormComponentAlpinePlugin": () => (/* binding */ tags_input_default),
/* harmony export */   "TextInputFormComponentAlpinePlugin": () => (/* binding */ text_input_default),
/* harmony export */   "TextareaFormComponentAlpinePlugin": () => (/* binding */ textarea_default),
/* harmony export */   "default": () => (/* binding */ js_default)
/* harmony export */ });
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js");
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);
var _class,_temp2;var _excluded7=["query","success","failure"],_excluded8=["alignment","allowedPlacements","autoAlignment"],_excluded9=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","flipAlignment"],_excluded10=["strategy"],_excluded11=["mainAxis","crossAxis","limiter"],_excluded12=["apply"];function set(target,property,value,receiver){if(typeof Reflect!=="undefined"&&Reflect.set){set=Reflect.set;}else{set=function set(target,property,value,receiver){var base=_superPropBase(target,property);var desc;if(base){desc=Object.getOwnPropertyDescriptor(base,property);if(desc.set){desc.set.call(receiver,value);return true;}else if(!desc.writable){return false;}}desc=Object.getOwnPropertyDescriptor(receiver,property);if(desc){if(!desc.writable){return false;}desc.value=value;Object.defineProperty(receiver,property,desc);}else{_defineProperty3(receiver,property,value);}return true;};}return set(target,property,value,receiver);}function _set(target,property,value,receiver,isStrict){var s=set(target,property,value,receiver||target);if(!s&&isStrict){throw new Error('failed to set property');}return value;}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray2(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _objectWithoutProperties2(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose3(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}function _objectWithoutPropertiesLoose3(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}function _get(){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(arguments.length<3?target:receiver);}return desc.value;};}return _get.apply(this,arguments);}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map():undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function");}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper);}function Wrapper(){return _construct3(Class,arguments,_getPrototypeOf(this).constructor);}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf3(Wrapper,Class);};return _wrapNativeSuper(Class);}function _construct3(Parent,args,Class){if(_isNativeReflectConstruct2()){_construct3=Reflect.construct;}else{_construct3=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor();if(Class)_setPrototypeOf3(instance,Class.prototype);return instance;};}return _construct3.apply(null,arguments);}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf3(subClass,superClass);}function _setPrototypeOf3(o,p){_setPrototypeOf3=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf3(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct2();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof4(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct2(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _toConsumableArray2(arr){return _arrayWithoutHoles2(arr)||_iterableToArray2(arr)||_unsupportedIterableToArray2(arr)||_nonIterableSpread2();}function _nonIterableSpread2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray2(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles2(arr){if(Array.isArray(arr))return _arrayLikeToArray2(arr);}function _ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){_ownKeys(Object(source),true).forEach(function(key){_defineProperty3(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty3(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray2(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e2){throw _e2;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e3){didErr=true;err=_e3;},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray2(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray2(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray2(o,minLen);}function _arrayLikeToArray2(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _typeof4(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof4=function _typeof4(obj){return typeof obj;};}else{_typeof4=function _typeof4(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof4(obj);}var __create=Object.create;var __defProp=Object.defineProperty;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __getOwnPropNames=Object.getOwnPropertyNames;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __markAsModule=function __markAsModule(target){return __defProp(target,"__esModule",{value:true});};var __commonJS=function __commonJS(callback,module){return function(){if(!module){module={exports:{}};callback(module.exports,module);}return module.exports;};};var __export=function __export(target,all){for(var name2 in all){__defProp(target,name2,{get:all[name2],enumerable:true});}};var __exportStar=function __exportStar(target,module,desc){if(module&&_typeof4(module)==="object"||typeof module==="function"){var _iterator=_createForOfIteratorHelper(__getOwnPropNames(module)),_step;try{var _loop=function _loop(){var key=_step.value;if(!__hasOwnProp.call(target,key)&&key!=="default")__defProp(target,key,{get:function get(){return module[key];},enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}}return target;};var __toModule=function __toModule(module){return __exportStar(__markAsModule(__defProp(module!=null?__create(__getProtoOf(module)):{},"default",module&&module.__esModule&&"default"in module?{get:function get(){return module["default"];},enumerable:true}:{value:module,enumerable:true})),module);};// node_modules/dayjs/plugin/customParseFormat.js
var require_customParseFormat=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2():typeof define=="function"&&__webpack_require__.amdO?define(t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_plugin_customParseFormat=t2();}(exports,function(){"use strict";var e2={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t2=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n2=/\d\d/,r2=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o2={},s2=function s2(e3){return(e3=+e3)+(e3>68?1900:2e3);};var a2=function a2(e3){return function(t3){this[e3]=+t3;};},f=[/[+-]\d\d:?(\d\d)?|Z/,function(e3){(this.zone||(this.zone={})).offset=function(e4){if(!e4)return 0;if(e4==="Z")return 0;var t3=e4.match(/([+-]|\d\d)/g),n3=60*t3[1]+(+t3[2]||0);return n3===0?0:t3[0]==="+"?-n3:n3;}(e3);}],h=function h(e3){var t3=o2[e3];return t3&&(t3.indexOf?t3:t3.s.concat(t3.f));},u=function u(e3,t3){var n3,r3=o2.meridiem;if(r3){for(var i2=1;i2<=24;i2+=1){if(e3.indexOf(r3(i2,0,t3))>-1){n3=i2>12;break;}}}else n3=e3===(t3?"pm":"PM");return n3;},d={A:[i,function(e3){this.afternoon=u(e3,false);}],a:[i,function(e3){this.afternoon=u(e3,true);}],S:[/\d/,function(e3){this.milliseconds=100*+e3;}],SS:[n2,function(e3){this.milliseconds=10*+e3;}],SSS:[/\d{3}/,function(e3){this.milliseconds=+e3;}],s:[r2,a2("seconds")],ss:[r2,a2("seconds")],m:[r2,a2("minutes")],mm:[r2,a2("minutes")],H:[r2,a2("hours")],h:[r2,a2("hours")],HH:[r2,a2("hours")],hh:[r2,a2("hours")],D:[r2,a2("day")],DD:[n2,a2("day")],Do:[i,function(e3){var t3=o2.ordinal,n3=e3.match(/\d+/);if(this.day=n3[0],t3)for(var r3=1;r3<=31;r3+=1){t3(r3).replace(/\[|\]/g,"")===e3&&(this.day=r3);}}],M:[r2,a2("month")],MM:[n2,a2("month")],MMM:[i,function(e3){var t3=h("months"),n3=(h("monthsShort")||t3.map(function(e4){return e4.slice(0,3);})).indexOf(e3)+1;if(n3<1)throw new Error();this.month=n3%12||n3;}],MMMM:[i,function(e3){var t3=h("months").indexOf(e3)+1;if(t3<1)throw new Error();this.month=t3%12||t3;}],Y:[/[+-]?\d+/,a2("year")],YY:[n2,function(e3){this.year=s2(e3);}],YYYY:[/\d{4}/,a2("year")],Z:f,ZZ:f};function c2(n3){var r3,i2;r3=n3,i2=o2&&o2.formats;for(var s3=(n3=r3.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(t3,n4,r4){var o3=r4&&r4.toUpperCase();return n4||i2[r4]||e2[r4]||i2[o3].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e3,t4,n5){return t4||n5.slice(1);});})).match(t2),a3=s3.length,f2=0;f2<a3;f2+=1){var h2=s3[f2],u2=d[h2],c3=u2&&u2[0],l=u2&&u2[1];s3[f2]=l?{regex:c3,parser:l}:h2.replace(/^\[|\]$/g,"");}return function(e3){for(var t3={},n4=0,r4=0;n4<a3;n4+=1){var i3=s3[n4];if(typeof i3=="string")r4+=i3.length;else{var o3=i3.regex,f3=i3.parser,h3=e3.slice(r4),u3=o3.exec(h3)[0];f3.call(t3,u3),e3=e3.replace(u3,"");}}return function(e4){var t4=e4.afternoon;if(t4!==void 0){var n5=e4.hours;t4?n5<12&&(e4.hours+=12):n5===12&&(e4.hours=0),delete e4.afternoon;}}(t3),t3;};}return function(e3,t3,n3){n3.p.customParseFormat=true,e3&&e3.parseTwoDigitYear&&(s2=e3.parseTwoDigitYear);var r3=t3.prototype,i2=r3.parse;r3.parse=function(e4){var t4=e4.date,r4=e4.utc,s3=e4.args;this.$u=r4;var a3=s3[1];if(typeof a3=="string"){var f2=s3[2]===true,h2=s3[3]===true,u2=f2||h2,d2=s3[2];h2&&(d2=s3[2]),o2=this.$locale(),!f2&&d2&&(o2=n3.Ls[d2]),this.$d=function(e5,t5,n4){try{if(["x","X"].indexOf(t5)>-1)return new Date((t5==="X"?1e3:1)*e5);var r5=c2(t5)(e5),i3=r5.year,o3=r5.month,s4=r5.day,a4=r5.hours,f3=r5.minutes,h3=r5.seconds,u3=r5.milliseconds,d3=r5.zone,l2=new Date(),m2=s4||(i3||o3?1:l2.getDate()),M3=i3||l2.getFullYear(),Y2=0;i3&&!o3||(Y2=o3>0?o3-1:l2.getMonth());var p2=a4||0,v=f3||0,D2=h3||0,g=u3||0;return d3?new Date(Date.UTC(M3,Y2,m2,p2,v,D2,g+60*d3.offset*1e3)):n4?new Date(Date.UTC(M3,Y2,m2,p2,v,D2,g)):new Date(M3,Y2,m2,p2,v,D2,g);}catch(e6){return new Date("");}}(t4,a3,r4),this.init(),d2&&d2!==true&&(this.$L=this.locale(d2).$L),u2&&t4!=this.format(a3)&&(this.$d=new Date("")),o2={};}else if(a3 instanceof Array)for(var l=a3.length,m=1;m<=l;m+=1){s3[1]=a3[m-1];var M2=n3.apply(this,s3);if(M2.isValid()){this.$d=M2.$d,this.$L=M2.$L,this.init();break;}m===l&&(this.$d=new Date(""));}else i2.call(this,e4);};};});});// node_modules/dayjs/plugin/localeData.js
var require_localeData=__commonJS(function(exports,module){!function(n2,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2():typeof define=="function"&&__webpack_require__.amdO?define(e2):(n2=typeof globalThis!="undefined"?globalThis:n2||self).dayjs_plugin_localeData=e2();}(exports,function(){"use strict";return function(n2,e2,t2){var r2=e2.prototype,o2=function o2(n3){return n3&&(n3.indexOf?n3:n3.s);},u=function u(n3,e3,t3,r3,u2){var i2=n3.name?n3:n3.$locale(),a3=o2(i2[e3]),s3=o2(i2[t3]),f=a3||s3.map(function(n4){return n4.slice(0,r3);});if(!u2)return f;var d=i2.weekStart;return f.map(function(n4,e4){return f[(e4+(d||0))%7];});},i=function i(){return t2.Ls[t2.locale()];},a2=function a2(n3,e3){return n3.formats[e3]||function(n4){return n4.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(n5,e4,t3){return e4||t3.slice(1);});}(n3.formats[e3.toUpperCase()]);},s2=function s2(){var n3=this;return{months:function months(e3){return e3?e3.format("MMMM"):u(n3,"months");},monthsShort:function monthsShort(e3){return e3?e3.format("MMM"):u(n3,"monthsShort","months",3);},firstDayOfWeek:function firstDayOfWeek(){return n3.$locale().weekStart||0;},weekdays:function weekdays(e3){return e3?e3.format("dddd"):u(n3,"weekdays");},weekdaysMin:function weekdaysMin(e3){return e3?e3.format("dd"):u(n3,"weekdaysMin","weekdays",2);},weekdaysShort:function weekdaysShort(e3){return e3?e3.format("ddd"):u(n3,"weekdaysShort","weekdays",3);},longDateFormat:function longDateFormat(e3){return a2(n3.$locale(),e3);},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal};};r2.localeData=function(){return s2.bind(this)();},t2.localeData=function(){var n3=i();return{firstDayOfWeek:function firstDayOfWeek(){return n3.weekStart||0;},weekdays:function weekdays(){return t2.weekdays();},weekdaysShort:function weekdaysShort(){return t2.weekdaysShort();},weekdaysMin:function weekdaysMin(){return t2.weekdaysMin();},months:function months(){return t2.months();},monthsShort:function monthsShort(){return t2.monthsShort();},longDateFormat:function longDateFormat(e3){return a2(n3,e3);},meridiem:n3.meridiem,ordinal:n3.ordinal};},t2.months=function(){return u(i(),"months");},t2.monthsShort=function(){return u(i(),"monthsShort","months",3);},t2.weekdays=function(n3){return u(i(),"weekdays",null,null,n3);},t2.weekdaysShort=function(n3){return u(i(),"weekdaysShort","weekdays",3,n3);},t2.weekdaysMin=function(n3){return u(i(),"weekdaysMin","weekdays",2,n3);};};});});// node_modules/dayjs/plugin/timezone.js
var require_timezone=__commonJS(function(exports,module){!function(t2,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2():typeof define=="function"&&__webpack_require__.amdO?define(e2):(t2=typeof globalThis!="undefined"?globalThis:t2||self).dayjs_plugin_timezone=e2();}(exports,function(){"use strict";var t2={year:0,month:1,day:2,hour:3,minute:4,second:5},e2={};return function(n2,i,o2){var r2,a2=function a2(t3,n3,i2){i2===void 0&&(i2={});var o3=new Date(t3),r3=function(t4,n4){n4===void 0&&(n4={});var i3=n4.timeZoneName||"short",o4=t4+"|"+i3,r4=e2[o4];return r4||(r4=new Intl.DateTimeFormat("en-US",{hour12:false,timeZone:t4,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:i3}),e2[o4]=r4),r4;}(n3,i2);return r3.formatToParts(o3);},u=function u(e3,n3){for(var i2=a2(e3,n3),r3=[],u2=0;u2<i2.length;u2+=1){var f2=i2[u2],s3=f2.type,m=f2.value,c2=t2[s3];c2>=0&&(r3[c2]=parseInt(m,10));}var d=r3[3],l=d===24?0:d,v=r3[0]+"-"+r3[1]+"-"+r3[2]+" "+l+":"+r3[4]+":"+r3[5]+":000",h=+e3;return(o2.utc(v).valueOf()-(h-=h%1e3))/6e4;},f=i.prototype;f.tz=function(t3,e3){t3===void 0&&(t3=r2);var n3=this.utcOffset(),i2=this.toDate(),a3=i2.toLocaleString("en-US",{timeZone:t3}),u2=Math.round((i2-new Date(a3))/1e3/60),f2=o2(a3).$set("millisecond",this.$ms).utcOffset(15*-Math.round(i2.getTimezoneOffset()/15)-u2,true);if(e3){var s3=f2.utcOffset();f2=f2.add(n3-s3,"minute");}return f2.$x.$timezone=t3,f2;},f.offsetName=function(t3){var e3=this.$x.$timezone||o2.tz.guess(),n3=a2(this.valueOf(),e3,{timeZoneName:t3}).find(function(t4){return t4.type.toLowerCase()==="timezonename";});return n3&&n3.value;};var s2=f.startOf;f.startOf=function(t3,e3){if(!this.$x||!this.$x.$timezone)return s2.call(this,t3,e3);var n3=o2(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return s2.call(n3,t3,e3).tz(this.$x.$timezone,true);},o2.tz=function(t3,e3,n3){var i2=n3&&e3,a3=n3||e3||r2,f2=u(+o2(),a3);if(typeof t3!="string")return o2(t3).tz(a3);var s3=function(t4,e4,n4){var i3=t4-60*e4*1e3,o3=u(i3,n4);if(e4===o3)return[i3,e4];var r3=u(i3-=60*(o3-e4)*1e3,n4);return o3===r3?[i3,o3]:[t4-60*Math.min(o3,r3)*1e3,Math.max(o3,r3)];}(o2.utc(t3,i2).valueOf(),f2,a3),m=s3[0],c2=s3[1],d=o2(m).utcOffset(c2);return d.$x.$timezone=a3,d;},o2.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone;},o2.tz.setDefault=function(t3){r2=t3;};};});});// node_modules/dayjs/plugin/utc.js
var require_utc=__commonJS(function(exports,module){!function(t2,i){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=i():typeof define=="function"&&__webpack_require__.amdO?define(i):(t2=typeof globalThis!="undefined"?globalThis:t2||self).dayjs_plugin_utc=i();}(exports,function(){"use strict";var t2="minute",i=/[+-]\d\d(?::?\d\d)?/g,e2=/([+-]|\d\d)/g;return function(s2,f,n2){var u=f.prototype;n2.utc=function(t3){var i2={date:t3,utc:true,args:arguments};return new f(i2);},u.utc=function(i2){var e3=n2(this.toDate(),{locale:this.$L,utc:true});return i2?e3.add(this.utcOffset(),t2):e3;},u.local=function(){return n2(this.toDate(),{locale:this.$L,utc:false});};var o2=u.parse;u.parse=function(t3){t3.utc&&(this.$u=true),this.$utils().u(t3.$offset)||(this.$offset=t3.$offset),o2.call(this,t3);};var r2=u.init;u.init=function(){if(this.$u){var t3=this.$d;this.$y=t3.getUTCFullYear(),this.$M=t3.getUTCMonth(),this.$D=t3.getUTCDate(),this.$W=t3.getUTCDay(),this.$H=t3.getUTCHours(),this.$m=t3.getUTCMinutes(),this.$s=t3.getUTCSeconds(),this.$ms=t3.getUTCMilliseconds();}else r2.call(this);};var a2=u.utcOffset;u.utcOffset=function(s3,f2){var n3=this.$utils().u;if(n3(s3))return this.$u?0:n3(this.$offset)?a2.call(this):this.$offset;if(typeof s3=="string"&&(s3=function(t3){t3===void 0&&(t3="");var s4=t3.match(i);if(!s4)return null;var f3=(""+s4[0]).match(e2)||["-",0,0],n4=f3[0],u3=60*+f3[1]+ +f3[2];return u3===0?0:n4==="+"?u3:-u3;}(s3),s3===null))return this;var u2=Math.abs(s3)<=16?60*s3:s3,o3=this;if(f2)return o3.$offset=u2,o3.$u=s3===0,o3;if(s3!==0){var r3=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o3=this.local().add(u2+r3,t2)).$offset=u2,o3.$x.$localOffset=r3;}else o3=this.utc();return o3;};var h=u.format;u.format=function(t3){var i2=t3||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,i2);},u.valueOf=function(){var t3=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t3;},u.isUTC=function(){return!!this.$u;},u.toISOString=function(){return this.toDate().toISOString();},u.toString=function(){return this.toDate().toUTCString();};var l=u.toDate;u.toDate=function(t3){return t3==="s"&&this.$offset?n2(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():l.call(this);};var c2=u.diff;u.diff=function(t3,i2,e3){if(t3&&this.$u===t3.$u)return c2.call(this,t3,i2,e3);var s3=this.local(),f2=n2(t3).local();return c2.call(s3,f2,i2,e3);};};});});// node_modules/dayjs/dayjs.min.js
var require_dayjs_min=__commonJS(function(exports,module){!function(t2,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2():typeof define=="function"&&__webpack_require__.amdO?define(e2):(t2=typeof globalThis!="undefined"?globalThis:t2||self).dayjs=e2();}(exports,function(){"use strict";var t2=1e3,e2=6e4,n2=36e5,r2="millisecond",i="second",s2="minute",u="hour",a2="day",o2="week",f="month",h="quarter",c2="year",d="date",l="Invalid Date",$=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M2={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function ordinal(t3){var e3=["th","st","nd","rd"],n3=t3%100;return"["+t3+(e3[(n3-20)%10]||e3[n3]||e3[0])+"]";}},m=function m(t3,e3,n3){var r3=String(t3);return!r3||r3.length>=e3?t3:""+Array(e3+1-r3.length).join(n3)+t3;},v={s:m,z:function z(t3){var e3=-t3.utcOffset(),n3=Math.abs(e3),r3=Math.floor(n3/60),i2=n3%60;return(e3<=0?"+":"-")+m(r3,2,"0")+":"+m(i2,2,"0");},m:function t3(e3,n3){if(e3.date()<n3.date())return-t3(n3,e3);var r3=12*(n3.year()-e3.year())+(n3.month()-e3.month()),i2=e3.clone().add(r3,f),s3=n3-i2<0,u2=e3.clone().add(r3+(s3?-1:1),f);return+(-(r3+(n3-i2)/(s3?i2-u2:u2-i2))||0);},a:function a(t3){return t3<0?Math.ceil(t3)||0:Math.floor(t3);},p:function p(t3){return{M:f,y:c2,w:o2,d:a2,D:d,h:u,m:s2,s:i,ms:r2,Q:h}[t3]||String(t3||"").toLowerCase().replace(/s$/,"");},u:function u(t3){return t3===void 0;}},g="en",D2={};D2[g]=M2;var p2=function p2(t3){return t3 instanceof _;},S2=function t3(e3,n3,r3){var i2;if(!e3)return g;if(typeof e3=="string"){var s3=e3.toLowerCase();D2[s3]&&(i2=s3),n3&&(D2[s3]=n3,i2=s3);var u2=e3.split("-");if(!i2&&u2.length>1)return t3(u2[0]);}else{var a3=e3.name;D2[a3]=e3,i2=a3;}return!r3&&i2&&(g=i2),i2||!r3&&g;},w=function w(t3,e3){if(p2(t3))return t3.clone();var n3=_typeof4(e3)=="object"?e3:{};return n3.date=t3,n3.args=arguments,new _(n3);},O=v;O.l=S2,O.i=p2,O.w=function(t3,e3){return w(t3,{locale:e3.$L,utc:e3.$u,x:e3.$x,$offset:e3.$offset});};var _=function(){function M3(t3){this.$L=S2(t3.locale,null,true),this.parse(t3);}var m2=M3.prototype;return m2.parse=function(t3){this.$d=function(t4){var e3=t4.date,n3=t4.utc;if(e3===null)return new Date(NaN);if(O.u(e3))return new Date();if(e3 instanceof Date)return new Date(e3);if(typeof e3=="string"&&!/Z$/i.test(e3)){var r3=e3.match($);if(r3){var i2=r3[2]-1||0,s3=(r3[7]||"0").substring(0,3);return n3?new Date(Date.UTC(r3[1],i2,r3[3]||1,r3[4]||0,r3[5]||0,r3[6]||0,s3)):new Date(r3[1],i2,r3[3]||1,r3[4]||0,r3[5]||0,r3[6]||0,s3);}}return new Date(e3);}(t3),this.$x=t3.x||{},this.init();},m2.init=function(){var t3=this.$d;this.$y=t3.getFullYear(),this.$M=t3.getMonth(),this.$D=t3.getDate(),this.$W=t3.getDay(),this.$H=t3.getHours(),this.$m=t3.getMinutes(),this.$s=t3.getSeconds(),this.$ms=t3.getMilliseconds();},m2.$utils=function(){return O;},m2.isValid=function(){return!(this.$d.toString()===l);},m2.isSame=function(t3,e3){var n3=w(t3);return this.startOf(e3)<=n3&&n3<=this.endOf(e3);},m2.isAfter=function(t3,e3){return w(t3)<this.startOf(e3);},m2.isBefore=function(t3,e3){return this.endOf(e3)<w(t3);},m2.$g=function(t3,e3,n3){return O.u(t3)?this[e3]:this.set(n3,t3);},m2.unix=function(){return Math.floor(this.valueOf()/1e3);},m2.valueOf=function(){return this.$d.getTime();},m2.startOf=function(t3,e3){var n3=this,r3=!!O.u(e3)||e3,h2=O.p(t3),l2=function l2(t4,e4){var i2=O.w(n3.$u?Date.UTC(n3.$y,e4,t4):new Date(n3.$y,e4,t4),n3);return r3?i2:i2.endOf(a2);},$2=function $2(t4,e4){return O.w(n3.toDate()[t4].apply(n3.toDate("s"),(r3?[0,0,0,0]:[23,59,59,999]).slice(e4)),n3);},y2=this.$W,M4=this.$M,m3=this.$D,v2="set"+(this.$u?"UTC":"");switch(h2){case c2:return r3?l2(1,0):l2(31,11);case f:return r3?l2(1,M4):l2(0,M4+1);case o2:var g2=this.$locale().weekStart||0,D3=(y2<g2?y2+7:y2)-g2;return l2(r3?m3-D3:m3+(6-D3),M4);case a2:case d:return $2(v2+"Hours",0);case u:return $2(v2+"Minutes",1);case s2:return $2(v2+"Seconds",2);case i:return $2(v2+"Milliseconds",3);default:return this.clone();}},m2.endOf=function(t3){return this.startOf(t3,false);},m2.$set=function(t3,e3){var n3,o3=O.p(t3),h2="set"+(this.$u?"UTC":""),l2=(n3={},n3[a2]=h2+"Date",n3[d]=h2+"Date",n3[f]=h2+"Month",n3[c2]=h2+"FullYear",n3[u]=h2+"Hours",n3[s2]=h2+"Minutes",n3[i]=h2+"Seconds",n3[r2]=h2+"Milliseconds",n3)[o3],$2=o3===a2?this.$D+(e3-this.$W):e3;if(o3===f||o3===c2){var y2=this.clone().set(d,1);y2.$d[l2]($2),y2.init(),this.$d=y2.set(d,Math.min(this.$D,y2.daysInMonth())).$d;}else l2&&this.$d[l2]($2);return this.init(),this;},m2.set=function(t3,e3){return this.clone().$set(t3,e3);},m2.get=function(t3){return this[O.p(t3)]();},m2.add=function(r3,h2){var d2,l2=this;r3=Number(r3);var $2=O.p(h2),y2=function y2(t3){var e3=w(l2);return O.w(e3.date(e3.date()+Math.round(t3*r3)),l2);};if($2===f)return this.set(f,this.$M+r3);if($2===c2)return this.set(c2,this.$y+r3);if($2===a2)return y2(1);if($2===o2)return y2(7);var M4=(d2={},d2[s2]=e2,d2[u]=n2,d2[i]=t2,d2)[$2]||1,m3=this.$d.getTime()+r3*M4;return O.w(m3,this);},m2.subtract=function(t3,e3){return this.add(-1*t3,e3);},m2.format=function(t3){var e3=this,n3=this.$locale();if(!this.isValid())return n3.invalidDate||l;var r3=t3||"YYYY-MM-DDTHH:mm:ssZ",i2=O.z(this),s3=this.$H,u2=this.$m,a3=this.$M,o3=n3.weekdays,f2=n3.months,h2=function h2(t4,n4,i3,s4){return t4&&(t4[n4]||t4(e3,r3))||i3[n4].slice(0,s4);},c3=function c3(t4){return O.s(s3%12||12,t4,"0");},d2=n3.meridiem||function(t4,e4,n4){var r4=t4<12?"AM":"PM";return n4?r4.toLowerCase():r4;},$2={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a3+1,MM:O.s(a3+1,2,"0"),MMM:h2(n3.monthsShort,a3,f2,3),MMMM:h2(f2,a3),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h2(n3.weekdaysMin,this.$W,o3,2),ddd:h2(n3.weekdaysShort,this.$W,o3,3),dddd:o3[this.$W],H:String(s3),HH:O.s(s3,2,"0"),h:c3(1),hh:c3(2),a:d2(s3,u2,true),A:d2(s3,u2,false),m:String(u2),mm:O.s(u2,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:i2};return r3.replace(y,function(t4,e4){return e4||$2[t4]||i2.replace(":","");});},m2.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15);},m2.diff=function(r3,d2,l2){var $2,y2=O.p(d2),M4=w(r3),m3=(M4.utcOffset()-this.utcOffset())*e2,v2=this-M4,g2=O.m(this,M4);return g2=($2={},$2[c2]=g2/12,$2[f]=g2,$2[h]=g2/3,$2[o2]=(v2-m3)/6048e5,$2[a2]=(v2-m3)/864e5,$2[u]=v2/n2,$2[s2]=v2/e2,$2[i]=v2/t2,$2)[y2]||v2,l2?g2:O.a(g2);},m2.daysInMonth=function(){return this.endOf(f).$D;},m2.$locale=function(){return D2[this.$L];},m2.locale=function(t3,e3){if(!t3)return this.$L;var n3=this.clone(),r3=S2(t3,e3,true);return r3&&(n3.$L=r3),n3;},m2.clone=function(){return O.w(this.$d,this);},m2.toDate=function(){return new Date(this.valueOf());},m2.toJSON=function(){return this.isValid()?this.toISOString():null;},m2.toISOString=function(){return this.$d.toISOString();},m2.toString=function(){return this.$d.toUTCString();},M3;}(),T=_.prototype;return w.prototype=T,[["$ms",r2],["$s",i],["$m",s2],["$H",u],["$W",a2],["$M",f],["$y",c2],["$D",d]].forEach(function(t3){T[t3[1]]=function(e3){return this.$g(e3,t3[0],t3[1]);};}),w.extend=function(t3,e3){return t3.$i||(t3(e3,_,w),t3.$i=true),w;},w.locale=S2,w.isDayjs=p2,w.unix=function(t3){return w(1e3*t3);},w.en=D2[g],w.Ls=D2,w.p={},w;});});// node_modules/dayjs/locale/ar.js
var require_ar=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ar=t2(e2.dayjs);}(exports,function(e2){"use strict";function t2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var n2=t2(e2),r2="\u064A\u0646\u0627\u064A\u0631_\u0641\u0628\u0631\u0627\u064A\u0631_\u0645\u0627\u0631\u0633_\u0623\u0628\u0631\u064A\u0644_\u0645\u0627\u064A\u0648_\u064A\u0648\u0646\u064A\u0648_\u064A\u0648\u0644\u064A\u0648_\u0623\u063A\u0633\u0637\u0633_\u0633\u0628\u062A\u0645\u0628\u0631_\u0623\u0643\u062A\u0648\u0628\u0631_\u0646\u0648\u0641\u0645\u0628\u0631_\u062F\u064A\u0633\u0645\u0628\u0631".split("_"),_={1:"\u0661",2:"\u0662",3:"\u0663",4:"\u0664",5:"\u0665",6:"\u0666",7:"\u0667",8:"\u0668",9:"\u0669",0:"\u0660"},d={"\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u0660":"0"},o2={name:"ar",weekdays:"\u0627\u0644\u0623\u062D\u062F_\u0627\u0644\u0625\u062B\u0646\u064A\u0646_\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621_\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621_\u0627\u0644\u062E\u0645\u064A\u0633_\u0627\u0644\u062C\u0645\u0639\u0629_\u0627\u0644\u0633\u0628\u062A".split("_"),weekdaysShort:"\u0623\u062D\u062F_\u0625\u062B\u0646\u064A\u0646_\u062B\u0644\u0627\u062B\u0627\u0621_\u0623\u0631\u0628\u0639\u0627\u0621_\u062E\u0645\u064A\u0633_\u062C\u0645\u0639\u0629_\u0633\u0628\u062A".split("_"),weekdaysMin:"\u062D_\u0646_\u062B_\u0631_\u062E_\u062C_\u0633".split("_"),months:r2,monthsShort:r2,weekStart:6,relativeTime:{future:"\u0628\u0639\u062F %s",past:"\u0645\u0646\u0630 %s",s:"\u062B\u0627\u0646\u064A\u0629 \u0648\u0627\u062D\u062F\u0629",m:"\u062F\u0642\u064A\u0642\u0629 \u0648\u0627\u062D\u062F\u0629",mm:"%d \u062F\u0642\u0627\u0626\u0642",h:"\u0633\u0627\u0639\u0629 \u0648\u0627\u062D\u062F\u0629",hh:"%d \u0633\u0627\u0639\u0627\u062A",d:"\u064A\u0648\u0645 \u0648\u0627\u062D\u062F",dd:"%d \u0623\u064A\u0627\u0645",M:"\u0634\u0647\u0631 \u0648\u0627\u062D\u062F",MM:"%d \u0623\u0634\u0647\u0631",y:"\u0639\u0627\u0645 \u0648\u0627\u062D\u062F",yy:"%d \u0623\u0639\u0648\u0627\u0645"},preparse:function preparse(e3){return e3.replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(e4){return d[e4];}).replace(/،/g,",");},postformat:function postformat(e3){return e3.replace(/\d/g,function(e4){return _[e4];}).replace(/,/g,"\u060C");},ordinal:function ordinal(e3){return e3;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/\u200FM/\u200FYYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"}};return n2["default"].locale(o2,null,true),o2;});});// node_modules/dayjs/locale/bs.js
var require_bs=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_bs=t2(e2.dayjs);}(exports,function(e2){"use strict";function t2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var _=t2(e2),a2={name:"bs",weekdays:"nedjelja_ponedjeljak_utorak_srijeda_\u010Detvrtak_petak_subota".split("_"),months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),weekStart:1,weekdaysShort:"ned._pon._uto._sri._\u010Det._pet._sub.".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),weekdaysMin:"ne_po_ut_sr_\u010De_pe_su".split("_"),ordinal:function ordinal(e3){return e3;},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"}};return _["default"].locale(a2,null,true),a2;});});// node_modules/dayjs/locale/ca.js
var require_ca=__commonJS(function(exports,module){!function(e2,s2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=s2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],s2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ca=s2(e2.dayjs);}(exports,function(e2){"use strict";function s2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=s2(e2),_={name:"ca",weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),months:"Gener_Febrer_Mar\xE7_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar\xE7_Abr._Maig_Juny_Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",ll:"D MMM YYYY",lll:"D MMM YYYY, H:mm",llll:"ddd D MMM YYYY, H:mm"},relativeTime:{future:"d'aqu\xED %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:function ordinal(e3){return""+e3+(e3===1||e3===3?"r":e3===2?"n":e3===4?"t":"\xE8");}};return t2["default"].locale(_,null,true),_;});});// node_modules/dayjs/locale/cs.js
var require_cs=__commonJS(function(exports,module){!function(e2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],n2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_cs=n2(e2.dayjs);}(exports,function(e2){"use strict";function n2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=n2(e2);function s2(e3){return e3>1&&e3<5&&~~(e3/10)!=1;}function r2(e3,n3,t3,r3){var d2=e3+" ";switch(t3){case"s":return n3||r3?"p\xE1r sekund":"p\xE1r sekundami";case"m":return n3?"minuta":r3?"minutu":"minutou";case"mm":return n3||r3?d2+(s2(e3)?"minuty":"minut"):d2+"minutami";case"h":return n3?"hodina":r3?"hodinu":"hodinou";case"hh":return n3||r3?d2+(s2(e3)?"hodiny":"hodin"):d2+"hodinami";case"d":return n3||r3?"den":"dnem";case"dd":return n3||r3?d2+(s2(e3)?"dny":"dn\xED"):d2+"dny";case"M":return n3||r3?"m\u011Bs\xEDc":"m\u011Bs\xEDcem";case"MM":return n3||r3?d2+(s2(e3)?"m\u011Bs\xEDce":"m\u011Bs\xEDc\u016F"):d2+"m\u011Bs\xEDci";case"y":return n3||r3?"rok":"rokem";case"yy":return n3||r3?d2+(s2(e3)?"roky":"let"):d2+"lety";}}var d={name:"cs",weekdays:"ned\u011Ble_pond\u011Bl\xED_\xFAter\xFD_st\u0159eda_\u010Dtvrtek_p\xE1tek_sobota".split("_"),weekdaysShort:"ne_po_\xFAt_st_\u010Dt_p\xE1_so".split("_"),weekdaysMin:"ne_po_\xFAt_st_\u010Dt_p\xE1_so".split("_"),months:"leden_\xFAnor_b\u0159ezen_duben_kv\u011Bten_\u010Derven_\u010Dervenec_srpen_z\xE1\u0159\xED_\u0159\xEDjen_listopad_prosinec".split("_"),monthsShort:"led_\xFAno_b\u0159e_dub_kv\u011B_\u010Dvn_\u010Dvc_srp_z\xE1\u0159_\u0159\xEDj_lis_pro".split("_"),weekStart:1,yearStart:4,ordinal:function ordinal(e3){return e3+".";},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"p\u0159ed %s",s:r2,m:r2,mm:r2,h:r2,hh:r2,d:r2,dd:r2,M:r2,MM:r2,y:r2,yy:r2}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/da.js
var require_da=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_da=t2(e2.dayjs);}(exports,function(e2){"use strict";function t2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var d=t2(e2),n2={name:"da",weekdays:"s\xF8ndag_mandag_tirsdag_onsdag_torsdag_fredag_l\xF8rdag".split("_"),weekdaysShort:"s\xF8n._man._tirs._ons._tors._fre._l\xF8r.".split("_"),weekdaysMin:"s\xF8._ma._ti._on._to._fr._l\xF8.".split("_"),months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj_juni_juli_aug._sept._okt._nov._dec.".split("_"),weekStart:1,ordinal:function ordinal(e3){return e3+".";},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"f\xE5 sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en m\xE5ned",MM:"%d m\xE5neder",y:"et \xE5r",yy:"%d \xE5r"}};return d["default"].locale(n2,null,true),n2;});});// node_modules/dayjs/locale/de.js
var require_de=__commonJS(function(exports,module){!function(e2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],n2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_de=n2(e2.dayjs);}(exports,function(e2){"use strict";function n2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=n2(e2),a2={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function i(e3,n3,t3){var i2=a2[t3];return Array.isArray(i2)&&(i2=i2[n3?0:1]),i2.replace("%d",e3);}var r2={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_M\xE4rz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._M\xE4rz_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function ordinal(e3){return e3+".";},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i}};return t2["default"].locale(r2,null,true),r2;});});// node_modules/dayjs/locale/en.js
var require_en=__commonJS(function(exports,module){!function(e2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2():typeof define=="function"&&__webpack_require__.amdO?define(n2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_en=n2();}(exports,function(){"use strict";return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function ordinal(e2){var n2=["th","st","nd","rd"],t2=e2%100;return"["+e2+(n2[(t2-20)%10]||n2[t2]||n2[0])+"]";}};});});// node_modules/dayjs/locale/es.js
var require_es=__commonJS(function(exports,module){!function(e2,o2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=o2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],o2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_es=o2(e2.dayjs);}(exports,function(e2){"use strict";function o2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var s2=o2(e2),d={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},ordinal:function ordinal(e3){return e3+"\xBA";}};return s2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/fa.js
var require_fa=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_fa=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"fa",weekdays:"\u06CC\u06A9\u200C\u0634\u0646\u0628\u0647_\u062F\u0648\u0634\u0646\u0628\u0647_\u0633\u0647\u200C\u0634\u0646\u0628\u0647_\u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647_\u067E\u0646\u062C\u200C\u0634\u0646\u0628\u0647_\u062C\u0645\u0639\u0647_\u0634\u0646\u0628\u0647".split("_"),weekdaysShort:"\u06CC\u06A9\u200C_\u062F\u0648_\u0633\u0647\u200C_\u0686\u0647_\u067E\u0646_\u062C\u0645_\u0634\u0646".split("_"),weekdaysMin:"\u06CC_\u062F_\u0633_\u0686_\u067E_\u062C_\u0634".split("_"),weekStart:6,months:"\u0641\u0631\u0648\u0631\u062F\u06CC\u0646_\u0627\u0631\u062F\u06CC\u0628\u0647\u0634\u062A_\u062E\u0631\u062F\u0627\u062F_\u062A\u06CC\u0631_\u0645\u0631\u062F\u0627\u062F_\u0634\u0647\u0631\u06CC\u0648\u0631_\u0645\u0647\u0631_\u0622\u0628\u0627\u0646_\u0622\u0630\u0631_\u062F\u06CC_\u0628\u0647\u0645\u0646_\u0627\u0633\u0641\u0646\u062F".split("_"),monthsShort:"\u0641\u0631\u0648_\u0627\u0631\u062F_\u062E\u0631\u062F_\u062A\u06CC\u0631_\u0645\u0631\u062F_\u0634\u0647\u0631_\u0645\u0647\u0631_\u0622\u0628\u0627_\u0622\u0630\u0631_\u062F\u06CC_\u0628\u0647\u0645_\u0627\u0633\u0641".split("_"),ordinal:function ordinal(_2){return _2;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"\u062F\u0631 %s",past:"%s \u0642\u0628\u0644",s:"\u0686\u0646\u062F \u062B\u0627\u0646\u06CC\u0647",m:"\u06CC\u06A9 \u062F\u0642\u06CC\u0642\u0647",mm:"%d \u062F\u0642\u06CC\u0642\u0647",h:"\u06CC\u06A9 \u0633\u0627\u0639\u062A",hh:"%d \u0633\u0627\u0639\u062A",d:"\u06CC\u06A9 \u0631\u0648\u0632",dd:"%d \u0631\u0648\u0632",M:"\u06CC\u06A9 \u0645\u0627\u0647",MM:"%d \u0645\u0627\u0647",y:"\u06CC\u06A9 \u0633\u0627\u0644",yy:"%d \u0633\u0627\u0644"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/fi.js
var require_fi=__commonJS(function(exports,module){!function(u,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(u=typeof globalThis!="undefined"?globalThis:u||self).dayjs_locale_fi=e2(u.dayjs);}(exports,function(u){"use strict";function e2(u2){return u2&&_typeof4(u2)=="object"&&"default"in u2?u2:{"default":u2};}var t2=e2(u);function n2(u2,e3,t3,n3){var i2={s:"muutama sekunti",m:"minuutti",mm:"%d minuuttia",h:"tunti",hh:"%d tuntia",d:"p\xE4iv\xE4",dd:"%d p\xE4iv\xE4\xE4",M:"kuukausi",MM:"%d kuukautta",y:"vuosi",yy:"%d vuotta",numbers:"nolla_yksi_kaksi_kolme_nelj\xE4_viisi_kuusi_seitsem\xE4n_kahdeksan_yhdeks\xE4n".split("_")},a2={s:"muutaman sekunnin",m:"minuutin",mm:"%d minuutin",h:"tunnin",hh:"%d tunnin",d:"p\xE4iv\xE4n",dd:"%d p\xE4iv\xE4n",M:"kuukauden",MM:"%d kuukauden",y:"vuoden",yy:"%d vuoden",numbers:"nollan_yhden_kahden_kolmen_nelj\xE4n_viiden_kuuden_seitsem\xE4n_kahdeksan_yhdeks\xE4n".split("_")},s2=n3&&!e3?a2:i2,_=s2[t3];return u2<10?_.replace("%d",s2.numbers[u2]):_.replace("%d",u2);}var i={name:"fi",weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kes\xE4kuu_hein\xE4kuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes\xE4_hein\xE4_elo_syys_loka_marras_joulu".split("_"),ordinal:function ordinal(u2){return u2+".";},weekStart:1,yearStart:4,relativeTime:{future:"%s p\xE4\xE4st\xE4",past:"%s sitten",s:n2,m:n2,mm:n2,h:n2,hh:n2,d:n2,dd:n2,M:n2,MM:n2,y:n2,yy:n2},formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM[ta] YYYY",LLL:"D. MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, D. MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"D. MMM YYYY",lll:"D. MMM YYYY, [klo] HH.mm",llll:"ddd, D. MMM YYYY, [klo] HH.mm"}};return t2["default"].locale(i,null,true),i;});});// node_modules/dayjs/locale/fr.js
var require_fr=__commonJS(function(exports,module){!function(e2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],n2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_fr=n2(e2.dayjs);}(exports,function(e2){"use strict";function n2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=n2(e2),i={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_f\xE9vrier_mars_avril_mai_juin_juillet_ao\xFBt_septembre_octobre_novembre_d\xE9cembre".split("_"),monthsShort:"janv._f\xE9vr._mars_avr._mai_juin_juil._ao\xFBt_sept._oct._nov._d\xE9c.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function ordinal(e3){return""+e3+(e3===1?"er":"");}};return t2["default"].locale(i,null,true),i;});});// node_modules/dayjs/locale/hi.js
var require_hi=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_hi=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"hi",weekdays:"\u0930\u0935\u093F\u0935\u093E\u0930_\u0938\u094B\u092E\u0935\u093E\u0930_\u092E\u0902\u0917\u0932\u0935\u093E\u0930_\u092C\u0941\u0927\u0935\u093E\u0930_\u0917\u0941\u0930\u0942\u0935\u093E\u0930_\u0936\u0941\u0915\u094D\u0930\u0935\u093E\u0930_\u0936\u0928\u093F\u0935\u093E\u0930".split("_"),months:"\u091C\u0928\u0935\u0930\u0940_\u092B\u093C\u0930\u0935\u0930\u0940_\u092E\u093E\u0930\u094D\u091A_\u0905\u092A\u094D\u0930\u0948\u0932_\u092E\u0908_\u091C\u0942\u0928_\u091C\u0941\u0932\u093E\u0908_\u0905\u0917\u0938\u094D\u0924_\u0938\u093F\u0924\u092E\u094D\u092C\u0930_\u0905\u0915\u094D\u091F\u0942\u092C\u0930_\u0928\u0935\u092E\u094D\u092C\u0930_\u0926\u093F\u0938\u092E\u094D\u092C\u0930".split("_"),weekdaysShort:"\u0930\u0935\u093F_\u0938\u094B\u092E_\u092E\u0902\u0917\u0932_\u092C\u0941\u0927_\u0917\u0941\u0930\u0942_\u0936\u0941\u0915\u094D\u0930_\u0936\u0928\u093F".split("_"),monthsShort:"\u091C\u0928._\u092B\u093C\u0930._\u092E\u093E\u0930\u094D\u091A_\u0905\u092A\u094D\u0930\u0948._\u092E\u0908_\u091C\u0942\u0928_\u091C\u0941\u0932._\u0905\u0917._\u0938\u093F\u0924._\u0905\u0915\u094D\u091F\u0942._\u0928\u0935._\u0926\u093F\u0938.".split("_"),weekdaysMin:"\u0930_\u0938\u094B_\u092E\u0902_\u092C\u0941_\u0917\u0941_\u0936\u0941_\u0936".split("_"),ordinal:function ordinal(_2){return _2;},formats:{LT:"A h:mm \u092C\u091C\u0947",LTS:"A h:mm:ss \u092C\u091C\u0947",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm \u092C\u091C\u0947",LLLL:"dddd, D MMMM YYYY, A h:mm \u092C\u091C\u0947"},relativeTime:{future:"%s \u092E\u0947\u0902",past:"%s \u092A\u0939\u0932\u0947",s:"\u0915\u0941\u091B \u0939\u0940 \u0915\u094D\u0937\u0923",m:"\u090F\u0915 \u092E\u093F\u0928\u091F",mm:"%d \u092E\u093F\u0928\u091F",h:"\u090F\u0915 \u0918\u0902\u091F\u093E",hh:"%d \u0918\u0902\u091F\u0947",d:"\u090F\u0915 \u0926\u093F\u0928",dd:"%d \u0926\u093F\u0928",M:"\u090F\u0915 \u092E\u0939\u0940\u0928\u0947",MM:"%d \u092E\u0939\u0940\u0928\u0947",y:"\u090F\u0915 \u0935\u0930\u094D\u0937",yy:"%d \u0935\u0930\u094D\u0937"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/hu.js
var require_hu=__commonJS(function(exports,module){!function(e2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],n2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_hu=n2(e2.dayjs);}(exports,function(e2){"use strict";function n2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=n2(e2),r2={name:"hu",weekdays:"vas\xE1rnap_h\xE9tf\u0151_kedd_szerda_cs\xFCt\xF6rt\xF6k_p\xE9ntek_szombat".split("_"),weekdaysShort:"vas_h\xE9t_kedd_sze_cs\xFCt_p\xE9n_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),months:"janu\xE1r_febru\xE1r_m\xE1rcius_\xE1prilis_m\xE1jus_j\xFAnius_j\xFAlius_augusztus_szeptember_okt\xF3ber_november_december".split("_"),monthsShort:"jan_feb_m\xE1rc_\xE1pr_m\xE1j_j\xFAn_j\xFAl_aug_szept_okt_nov_dec".split("_"),ordinal:function ordinal(e3){return e3+".";},weekStart:1,relativeTime:{future:"%s m\xFAlva",past:"%s",s:function s(e3,n3,t3,r3){return"n\xE9h\xE1ny m\xE1sodperc"+(r3||n3?"":"e");},m:function m(e3,n3,t3,r3){return"egy perc"+(r3||n3?"":"e");},mm:function mm(e3,n3,t3,r3){return e3+" perc"+(r3||n3?"":"e");},h:function h(e3,n3,t3,r3){return"egy "+(r3||n3?"\xF3ra":"\xF3r\xE1ja");},hh:function hh(e3,n3,t3,r3){return e3+" "+(r3||n3?"\xF3ra":"\xF3r\xE1ja");},d:function d(e3,n3,t3,r3){return"egy "+(r3||n3?"nap":"napja");},dd:function dd(e3,n3,t3,r3){return e3+" "+(r3||n3?"nap":"napja");},M:function M(e3,n3,t3,r3){return"egy "+(r3||n3?"h\xF3nap":"h\xF3napja");},MM:function MM(e3,n3,t3,r3){return e3+" "+(r3||n3?"h\xF3nap":"h\xF3napja");},y:function y(e3,n3,t3,r3){return"egy "+(r3||n3?"\xE9v":"\xE9ve");},yy:function yy(e3,n3,t3,r3){return e3+" "+(r3||n3?"\xE9v":"\xE9ve");}},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"}};return t2["default"].locale(r2,null,true),r2;});});// node_modules/dayjs/locale/hy-am.js
var require_hy_am=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_hy_am=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"hy-am",weekdays:"\u056F\u056B\u0580\u0561\u056F\u056B_\u0565\u0580\u056F\u0578\u0582\u0577\u0561\u0562\u0569\u056B_\u0565\u0580\u0565\u0584\u0577\u0561\u0562\u0569\u056B_\u0579\u0578\u0580\u0565\u0584\u0577\u0561\u0562\u0569\u056B_\u0570\u056B\u0576\u0563\u0577\u0561\u0562\u0569\u056B_\u0578\u0582\u0580\u0562\u0561\u0569_\u0577\u0561\u0562\u0561\u0569".split("_"),months:"\u0570\u0578\u0582\u0576\u057E\u0561\u0580\u056B_\u0583\u0565\u057F\u0580\u057E\u0561\u0580\u056B_\u0574\u0561\u0580\u057F\u056B_\u0561\u057A\u0580\u056B\u056C\u056B_\u0574\u0561\u0575\u056B\u057D\u056B_\u0570\u0578\u0582\u0576\u056B\u057D\u056B_\u0570\u0578\u0582\u056C\u056B\u057D\u056B_\u0585\u0563\u0578\u057D\u057F\u0578\u057D\u056B_\u057D\u0565\u057A\u057F\u0565\u0574\u0562\u0565\u0580\u056B_\u0570\u0578\u056F\u057F\u0565\u0574\u0562\u0565\u0580\u056B_\u0576\u0578\u0575\u0565\u0574\u0562\u0565\u0580\u056B_\u0564\u0565\u056F\u057F\u0565\u0574\u0562\u0565\u0580\u056B".split("_"),weekStart:1,weekdaysShort:"\u056F\u0580\u056F_\u0565\u0580\u056F_\u0565\u0580\u0584_\u0579\u0580\u0584_\u0570\u0576\u0563_\u0578\u0582\u0580\u0562_\u0577\u0562\u0569".split("_"),monthsShort:"\u0570\u0576\u057E_\u0583\u057F\u0580_\u0574\u0580\u057F_\u0561\u057A\u0580_\u0574\u0575\u057D_\u0570\u0576\u057D_\u0570\u056C\u057D_\u0585\u0563\u057D_\u057D\u057A\u057F_\u0570\u056F\u057F_\u0576\u0574\u0562_\u0564\u056F\u057F".split("_"),weekdaysMin:"\u056F\u0580\u056F_\u0565\u0580\u056F_\u0565\u0580\u0584_\u0579\u0580\u0584_\u0570\u0576\u0563_\u0578\u0582\u0580\u0562_\u0577\u0562\u0569".split("_"),ordinal:function ordinal(_2){return _2;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0569.",LLL:"D MMMM YYYY \u0569., HH:mm",LLLL:"dddd, D MMMM YYYY \u0569., HH:mm"},relativeTime:{future:"%s \u0570\u0565\u057F\u0578",past:"%s \u0561\u057C\u0561\u057B",s:"\u0574\u056B \u0584\u0561\u0576\u056B \u057E\u0561\u0575\u0580\u056F\u0575\u0561\u0576",m:"\u0580\u0578\u057A\u0565",mm:"%d \u0580\u0578\u057A\u0565",h:"\u056A\u0561\u0574",hh:"%d \u056A\u0561\u0574",d:"\u0585\u0580",dd:"%d \u0585\u0580",M:"\u0561\u0574\u056B\u057D",MM:"%d \u0561\u0574\u056B\u057D",y:"\u057F\u0561\u0580\u056B",yy:"%d \u057F\u0561\u0580\u056B"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/id.js
var require_id=__commonJS(function(exports,module){!function(e2,a2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=a2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],a2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_id=a2(e2.dayjs);}(exports,function(e2){"use strict";function a2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=a2(e2),_={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function ordinal(e3){return e3+".";}};return t2["default"].locale(_,null,true),_;});});// node_modules/dayjs/locale/it.js
var require_it=__commonJS(function(exports,module){!function(e2,o2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=o2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],o2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_it=o2(e2.dayjs);}(exports,function(e2){"use strict";function o2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=o2(e2),n2={name:"it",weekdays:"domenica_luned\xEC_marted\xEC_mercoled\xEC_gioved\xEC_venerd\xEC_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function ordinal(e3){return e3+"\xBA";}};return t2["default"].locale(n2,null,true),n2;});});// node_modules/dayjs/locale/ja.js
var require_ja=__commonJS(function(exports,module){!function(e2,_){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=_(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],_):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ja=_(e2.dayjs);}(exports,function(e2){"use strict";function _(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=_(e2),d={name:"ja",weekdays:"\u65E5\u66DC\u65E5_\u6708\u66DC\u65E5_\u706B\u66DC\u65E5_\u6C34\u66DC\u65E5_\u6728\u66DC\u65E5_\u91D1\u66DC\u65E5_\u571F\u66DC\u65E5".split("_"),weekdaysShort:"\u65E5_\u6708_\u706B_\u6C34_\u6728_\u91D1_\u571F".split("_"),weekdaysMin:"\u65E5_\u6708_\u706B_\u6C34_\u6728_\u91D1_\u571F".split("_"),months:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function ordinal(e3){return e3+"\u65E5";},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5 HH:mm",LLLL:"YYYY\u5E74M\u6708D\u65E5 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5(ddd) HH:mm"},meridiem:function meridiem(e3){return e3<12?"\u5348\u524D":"\u5348\u5F8C";},relativeTime:{future:"%s\u5F8C",past:"%s\u524D",s:"\u6570\u79D2",m:"1\u5206",mm:"%d\u5206",h:"1\u6642\u9593",hh:"%d\u6642\u9593",d:"1\u65E5",dd:"%d\u65E5",M:"1\u30F6\u6708",MM:"%d\u30F6\u6708",y:"1\u5E74",yy:"%d\u5E74"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/ka.js
var require_ka=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_ka=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"ka",weekdays:"\u10D9\u10D5\u10D8\u10E0\u10D0_\u10DD\u10E0\u10E8\u10D0\u10D1\u10D0\u10D7\u10D8_\u10E1\u10D0\u10DB\u10E8\u10D0\u10D1\u10D0\u10D7\u10D8_\u10DD\u10D7\u10EE\u10E8\u10D0\u10D1\u10D0\u10D7\u10D8_\u10EE\u10E3\u10D7\u10E8\u10D0\u10D1\u10D0\u10D7\u10D8_\u10DE\u10D0\u10E0\u10D0\u10E1\u10D9\u10D4\u10D5\u10D8_\u10E8\u10D0\u10D1\u10D0\u10D7\u10D8".split("_"),weekdaysShort:"\u10D9\u10D5\u10D8_\u10DD\u10E0\u10E8_\u10E1\u10D0\u10DB_\u10DD\u10D7\u10EE_\u10EE\u10E3\u10D7_\u10DE\u10D0\u10E0_\u10E8\u10D0\u10D1".split("_"),weekdaysMin:"\u10D9\u10D5_\u10DD\u10E0_\u10E1\u10D0_\u10DD\u10D7_\u10EE\u10E3_\u10DE\u10D0_\u10E8\u10D0".split("_"),months:"\u10D8\u10D0\u10DC\u10D5\u10D0\u10E0\u10D8_\u10D7\u10D4\u10D1\u10D4\u10E0\u10D5\u10D0\u10DA\u10D8_\u10DB\u10D0\u10E0\u10E2\u10D8_\u10D0\u10DE\u10E0\u10D8\u10DA\u10D8_\u10DB\u10D0\u10D8\u10E1\u10D8_\u10D8\u10D5\u10DC\u10D8\u10E1\u10D8_\u10D8\u10D5\u10DA\u10D8\u10E1\u10D8_\u10D0\u10D2\u10D5\u10D8\u10E1\u10E2\u10DD_\u10E1\u10D4\u10E5\u10E2\u10D4\u10DB\u10D1\u10D4\u10E0\u10D8_\u10DD\u10E5\u10E2\u10DD\u10DB\u10D1\u10D4\u10E0\u10D8_\u10DC\u10DD\u10D4\u10DB\u10D1\u10D4\u10E0\u10D8_\u10D3\u10D4\u10D9\u10D4\u10DB\u10D1\u10D4\u10E0\u10D8".split("_"),monthsShort:"\u10D8\u10D0\u10DC_\u10D7\u10D4\u10D1_\u10DB\u10D0\u10E0_\u10D0\u10DE\u10E0_\u10DB\u10D0\u10D8_\u10D8\u10D5\u10DC_\u10D8\u10D5\u10DA_\u10D0\u10D2\u10D5_\u10E1\u10D4\u10E5_\u10DD\u10E5\u10E2_\u10DC\u10DD\u10D4_\u10D3\u10D4\u10D9".split("_"),weekStart:1,formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},relativeTime:{future:"%s \u10E8\u10D4\u10DB\u10D3\u10D4\u10D2",past:"%s \u10EC\u10D8\u10DC",s:"\u10EC\u10D0\u10DB\u10D8",m:"\u10EC\u10E3\u10D7\u10D8",mm:"%d \u10EC\u10E3\u10D7\u10D8",h:"\u10E1\u10D0\u10D0\u10D7\u10D8",hh:"%d \u10E1\u10D0\u10D0\u10D7\u10D8\u10E1",d:"\u10D3\u10E6\u10D4\u10E1",dd:"%d \u10D3\u10E6\u10D8\u10E1 \u10D2\u10D0\u10DC\u10DB\u10D0\u10D5\u10DA\u10DD\u10D1\u10D0\u10E8\u10D8",M:"\u10D7\u10D5\u10D8\u10E1",MM:"%d \u10D7\u10D5\u10D8\u10E1",y:"\u10EC\u10D4\u10DA\u10D8",yy:"%d \u10EC\u10DA\u10D8\u10E1"},ordinal:function ordinal(_2){return _2;}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/km.js
var require_km=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_km=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"km",weekdays:"\u17A2\u17B6\u1791\u17B7\u178F\u17D2\u1799_\u1785\u17D0\u1793\u17D2\u1791_\u17A2\u1784\u17D2\u1782\u17B6\u179A_\u1796\u17BB\u1792_\u1796\u17D2\u179A\u17A0\u179F\u17D2\u1794\u178F\u17B7\u17CD_\u179F\u17BB\u1780\u17D2\u179A_\u179F\u17C5\u179A\u17CD".split("_"),months:"\u1798\u1780\u179A\u17B6_\u1780\u17BB\u1798\u17D2\u1797\u17C8_\u1798\u17B8\u1793\u17B6_\u1798\u17C1\u179F\u17B6_\u17A7\u179F\u1797\u17B6_\u1798\u17B7\u1790\u17BB\u1793\u17B6_\u1780\u1780\u17D2\u1780\u178A\u17B6_\u179F\u17B8\u17A0\u17B6_\u1780\u1789\u17D2\u1789\u17B6_\u178F\u17BB\u179B\u17B6_\u179C\u17B7\u1785\u17D2\u1786\u17B7\u1780\u17B6_\u1792\u17D2\u1793\u17BC".split("_"),weekStart:1,weekdaysShort:"\u17A2\u17B6_\u1785_\u17A2_\u1796_\u1796\u17D2\u179A_\u179F\u17BB_\u179F".split("_"),monthsShort:"\u1798\u1780\u179A\u17B6_\u1780\u17BB\u1798\u17D2\u1797\u17C8_\u1798\u17B8\u1793\u17B6_\u1798\u17C1\u179F\u17B6_\u17A7\u179F\u1797\u17B6_\u1798\u17B7\u1790\u17BB\u1793\u17B6_\u1780\u1780\u17D2\u1780\u178A\u17B6_\u179F\u17B8\u17A0\u17B6_\u1780\u1789\u17D2\u1789\u17B6_\u178F\u17BB\u179B\u17B6_\u179C\u17B7\u1785\u17D2\u1786\u17B7\u1780\u17B6_\u1792\u17D2\u1793\u17BC".split("_"),weekdaysMin:"\u17A2\u17B6_\u1785_\u17A2_\u1796_\u1796\u17D2\u179A_\u179F\u17BB_\u179F".split("_"),ordinal:function ordinal(_2){return _2;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"%s\u1791\u17C0\u178F",past:"%s\u1798\u17BB\u1793",s:"\u1794\u17C9\u17BB\u1793\u17D2\u1798\u17B6\u1793\u179C\u17B7\u1793\u17B6\u1791\u17B8",m:"\u1798\u17BD\u1799\u1793\u17B6\u1791\u17B8",mm:"%d \u1793\u17B6\u1791\u17B8",h:"\u1798\u17BD\u1799\u1798\u17C9\u17C4\u1784",hh:"%d \u1798\u17C9\u17C4\u1784",d:"\u1798\u17BD\u1799\u1790\u17D2\u1784\u17C3",dd:"%d \u1790\u17D2\u1784\u17C3",M:"\u1798\u17BD\u1799\u1781\u17C2",MM:"%d \u1781\u17C2",y:"\u1798\u17BD\u1799\u1786\u17D2\u1793\u17B6\u17C6",yy:"%d \u1786\u17D2\u1793\u17B6\u17C6"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/ku.js
var require_ku=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?t2(exports,require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["exports","dayjs"],t2):t2((e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ku={},e2.dayjs);}(exports,function(e2,t2){"use strict";function n2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var r2=n2(t2),d={1:"\u0661",2:"\u0662",3:"\u0663",4:"\u0664",5:"\u0665",6:"\u0666",7:"\u0667",8:"\u0668",9:"\u0669",0:"\u0660"},o2={"\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u0660":"0"},u=["\u06A9\u0627\u0646\u0648\u0648\u0646\u06CC \u062F\u0648\u0648\u06D5\u0645","\u0634\u0648\u0628\u0627\u062A","\u0626\u0627\u062F\u0627\u0631","\u0646\u06CC\u0633\u0627\u0646","\u0626\u0627\u06CC\u0627\u0631","\u062D\u0648\u0632\u06D5\u06CC\u0631\u0627\u0646","\u062A\u06D5\u0645\u0645\u0648\u0648\u0632","\u0626\u0627\u0628","\u0626\u06D5\u06CC\u0644\u0648\u0648\u0644","\u062A\u0634\u0631\u06CC\u0646\u06CC \u06CC\u06D5\u06A9\u06D5\u0645","\u062A\u0634\u0631\u06CC\u0646\u06CC \u062F\u0648\u0648\u06D5\u0645","\u06A9\u0627\u0646\u0648\u0648\u0646\u06CC \u06CC\u06D5\u06A9\u06D5\u0645"],i={name:"ku",months:u,monthsShort:u,weekdays:"\u06CC\u06D5\u06A9\u0634\u06D5\u0645\u0645\u06D5_\u062F\u0648\u0648\u0634\u06D5\u0645\u0645\u06D5_\u0633\u06CE\u0634\u06D5\u0645\u0645\u06D5_\u0686\u0648\u0627\u0631\u0634\u06D5\u0645\u0645\u06D5_\u067E\u06CE\u0646\u062C\u0634\u06D5\u0645\u0645\u06D5_\u0647\u06D5\u06CC\u0646\u06CC_\u0634\u06D5\u0645\u0645\u06D5".split("_"),weekdaysShort:"\u06CC\u06D5\u06A9\u0634\u06D5\u0645_\u062F\u0648\u0648\u0634\u06D5\u0645_\u0633\u06CE\u0634\u06D5\u0645_\u0686\u0648\u0627\u0631\u0634\u06D5\u0645_\u067E\u06CE\u0646\u062C\u0634\u06D5\u0645_\u0647\u06D5\u06CC\u0646\u06CC_\u0634\u06D5\u0645\u0645\u06D5".split("_"),weekStart:6,weekdaysMin:"\u06CC_\u062F_\u0633_\u0686_\u067E_\u0647\u0640_\u0634".split("_"),preparse:function preparse(e3){return e3.replace(/[١٢٣٤٥٦٧٨٩٠]/g,function(e4){return o2[e4];}).replace(/،/g,",");},postformat:function postformat(e3){return e3.replace(/\d/g,function(e4){return d[e4];}).replace(/,/g,"\u060C");},ordinal:function ordinal(e3){return e3;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiem:function meridiem(e3){return e3<12?"\u067E.\u0646":"\u062F.\u0646";},relativeTime:{future:"\u0644\u06D5 %s",past:"\u0644\u06D5\u0645\u06D5\u0648\u067E\u06CE\u0634 %s",s:"\u0686\u06D5\u0646\u062F \u0686\u0631\u06A9\u06D5\u06CC\u06D5\u06A9",m:"\u06CC\u06D5\u06A9 \u062E\u0648\u0644\u06D5\u06A9",mm:"%d \u062E\u0648\u0644\u06D5\u06A9",h:"\u06CC\u06D5\u06A9 \u06A9\u0627\u062A\u0698\u0645\u06CE\u0631",hh:"%d \u06A9\u0627\u062A\u0698\u0645\u06CE\u0631",d:"\u06CC\u06D5\u06A9 \u0695\u06C6\u0698",dd:"%d \u0695\u06C6\u0698",M:"\u06CC\u06D5\u06A9 \u0645\u0627\u0646\u06AF",MM:"%d \u0645\u0627\u0646\u06AF",y:"\u06CC\u06D5\u06A9 \u0633\u0627\u06B5",yy:"%d \u0633\u0627\u06B5"}};r2["default"].locale(i,null,true),e2["default"]=i,e2.englishToArabicNumbersMap=d,Object.defineProperty(e2,"__esModule",{value:true});});});// node_modules/dayjs/locale/ms.js
var require_ms=__commonJS(function(exports,module){!function(e2,a2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=a2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],a2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ms=a2(e2.dayjs);}(exports,function(e2){"use strict";function a2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=a2(e2),s2={name:"ms",weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH.mm",LLLL:"dddd, D MMMM YYYY HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function ordinal(e3){return e3+".";}};return t2["default"].locale(s2,null,true),s2;});});// node_modules/dayjs/locale/my.js
var require_my=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_my=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"my",weekdays:"\u1010\u1014\u1004\u103A\u1039\u1002\u1014\u103D\u1031_\u1010\u1014\u1004\u103A\u1039\u101C\u102C_\u1021\u1004\u103A\u1039\u1002\u102B_\u1017\u102F\u1012\u1039\u1013\u101F\u1030\u1038_\u1000\u103C\u102C\u101E\u1015\u1010\u1031\u1038_\u101E\u1031\u102C\u1000\u103C\u102C_\u1005\u1014\u1031".split("_"),months:"\u1007\u1014\u103A\u1014\u101D\u102B\u101B\u102E_\u1016\u1031\u1016\u1031\u102C\u103A\u101D\u102B\u101B\u102E_\u1019\u1010\u103A_\u1027\u1015\u103C\u102E_\u1019\u1031_\u1007\u103D\u1014\u103A_\u1007\u1030\u101C\u102D\u102F\u1004\u103A_\u101E\u103C\u1002\u102F\u1010\u103A_\u1005\u1000\u103A\u1010\u1004\u103A\u1018\u102C_\u1021\u1031\u102C\u1000\u103A\u1010\u102D\u102F\u1018\u102C_\u1014\u102D\u102F\u101D\u1004\u103A\u1018\u102C_\u1012\u102E\u1007\u1004\u103A\u1018\u102C".split("_"),weekStart:1,weekdaysShort:"\u1014\u103D\u1031_\u101C\u102C_\u1002\u102B_\u101F\u1030\u1038_\u1000\u103C\u102C_\u101E\u1031\u102C_\u1014\u1031".split("_"),monthsShort:"\u1007\u1014\u103A_\u1016\u1031_\u1019\u1010\u103A_\u1015\u103C\u102E_\u1019\u1031_\u1007\u103D\u1014\u103A_\u101C\u102D\u102F\u1004\u103A_\u101E\u103C_\u1005\u1000\u103A_\u1021\u1031\u102C\u1000\u103A_\u1014\u102D\u102F_\u1012\u102E".split("_"),weekdaysMin:"\u1014\u103D\u1031_\u101C\u102C_\u1002\u102B_\u101F\u1030\u1038_\u1000\u103C\u102C_\u101E\u1031\u102C_\u1014\u1031".split("_"),ordinal:function ordinal(_2){return _2;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"\u101C\u102C\u1019\u100A\u103A\u1037 %s \u1019\u103E\u102C",past:"\u101C\u103D\u1014\u103A\u1001\u1032\u1037\u101E\u1031\u102C %s \u1000",s:"\u1005\u1000\u1039\u1000\u1014\u103A.\u1021\u1014\u100A\u103A\u1038\u1004\u101A\u103A",m:"\u1010\u1005\u103A\u1019\u102D\u1014\u1005\u103A",mm:"%d \u1019\u102D\u1014\u1005\u103A",h:"\u1010\u1005\u103A\u1014\u102C\u101B\u102E",hh:"%d \u1014\u102C\u101B\u102E",d:"\u1010\u1005\u103A\u101B\u1000\u103A",dd:"%d \u101B\u1000\u103A",M:"\u1010\u1005\u103A\u101C",MM:"%d \u101C",y:"\u1010\u1005\u103A\u1014\u103E\u1005\u103A",yy:"%d \u1014\u103E\u1005\u103A"}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/nl.js
var require_nl=__commonJS(function(exports,module){!function(e2,a2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=a2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],a2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_nl=a2(e2.dayjs);}(exports,function(e2){"use strict";function a2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var d=a2(e2),n2={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function ordinal(e3){return"["+e3+(e3===1||e3===8||e3>=20?"ste":"de")+"]";},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};return d["default"].locale(n2,null,true),n2;});});// node_modules/dayjs/locale/pl.js
var require_pl=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_pl=t2(e2.dayjs);}(exports,function(e2){"use strict";function t2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var i=t2(e2);function a2(e3){return e3%10<5&&e3%10>1&&~~(e3/10)%10!=1;}function n2(e3,t3,i2){var n3=e3+" ";switch(i2){case"m":return t3?"minuta":"minut\u0119";case"mm":return n3+(a2(e3)?"minuty":"minut");case"h":return t3?"godzina":"godzin\u0119";case"hh":return n3+(a2(e3)?"godziny":"godzin");case"MM":return n3+(a2(e3)?"miesi\u0105ce":"miesi\u0119cy");case"yy":return n3+(a2(e3)?"lata":"lat");}}var r2="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrze\u015Bnia_pa\u017Adziernika_listopada_grudnia".split("_"),_="stycze\u0144_luty_marzec_kwiecie\u0144_maj_czerwiec_lipiec_sierpie\u0144_wrzesie\u0144_pa\u017Adziernik_listopad_grudzie\u0144".split("_"),s2=/D MMMM/,d=function d(e3,t3){return s2.test(t3)?r2[e3.month()]:_[e3.month()];};d.s=_,d.f=r2;var o2={name:"pl",weekdays:"niedziela_poniedzia\u0142ek_wtorek_\u015Broda_czwartek_pi\u0105tek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_\u015Br_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_\u015Ar_Cz_Pt_So".split("_"),months:d,monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa\u017A_lis_gru".split("_"),ordinal:function ordinal(e3){return e3+".";},weekStart:1,yearStart:4,relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:n2,mm:n2,h:n2,hh:n2,d:"1 dzie\u0144",dd:"%d dni",M:"miesi\u0105c",MM:n2,y:"rok",yy:n2},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};return i["default"].locale(o2,null,true),o2;});});// node_modules/dayjs/locale/pt-br.js
var require_pt_br=__commonJS(function(exports,module){!function(e2,o2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=o2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],o2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_pt_br=o2(e2.dayjs);}(exports,function(e2){"use strict";function o2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var a2=o2(e2),s2={name:"pt-br",weekdays:"domingo_segunda-feira_ter\xE7a-feira_quarta-feira_quinta-feira_sexta-feira_s\xE1bado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_s\xE1b".split("_"),weekdaysMin:"Do_2\xAA_3\xAA_4\xAA_5\xAA_6\xAA_S\xE1".split("_"),months:"janeiro_fevereiro_mar\xE7o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function ordinal(e3){return e3+"\xBA";},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [\xE0s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [\xE0s] HH:mm"},relativeTime:{future:"em %s",past:"h\xE1 %s",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um m\xEAs",MM:"%d meses",y:"um ano",yy:"%d anos"}};return a2["default"].locale(s2,null,true),s2;});});// node_modules/dayjs/locale/pt.js
var require_pt=__commonJS(function(exports,module){!function(e2,a2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=a2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],a2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_pt=a2(e2.dayjs);}(exports,function(e2){"use strict";function a2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var o2=a2(e2),t2={name:"pt",weekdays:"domingo_segunda-feira_ter\xE7a-feira_quarta-feira_quinta-feira_sexta-feira_s\xE1bado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sab".split("_"),weekdaysMin:"Do_2\xAA_3\xAA_4\xAA_5\xAA_6\xAA_Sa".split("_"),months:"janeiro_fevereiro_mar\xE7o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function ordinal(e3){return e3+"\xBA";},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [\xE0s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [\xE0s] HH:mm"},relativeTime:{future:"em %s",past:"h\xE1 %s",s:"alguns segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um m\xEAs",MM:"%d meses",y:"um ano",yy:"%d anos"}};return o2["default"].locale(t2,null,true),t2;});});// node_modules/dayjs/locale/ro.js
var require_ro=__commonJS(function(exports,module){!function(e2,i){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=i(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],i):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_ro=i(e2.dayjs);}(exports,function(e2){"use strict";function i(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=i(e2),_={name:"ro",weekdays:"Duminic\u0103_Luni_Mar\u021Bi_Miercuri_Joi_Vineri_S\xE2mb\u0103t\u0103".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_S\xE2m".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S\xE2".split("_"),months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian._Febr._Mart._Apr._Mai_Iun._Iul._Aug._Sept._Oct._Nov._Dec.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:"peste %s",past:"acum %s",s:"c\xE2teva secunde",m:"un minut",mm:"%d minute",h:"o or\u0103",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lun\u0103",MM:"%d luni",y:"un an",yy:"%d ani"},ordinal:function ordinal(e3){return e3;}};return t2["default"].locale(_,null,true),_;});});// node_modules/dayjs/locale/ru.js
var require_ru=__commonJS(function(exports,module){!function(_,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_ru=t2(_.dayjs);}(exports,function(_){"use strict";function t2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var e2=t2(_),n2="\u044F\u043D\u0432\u0430\u0440\u044F_\u0444\u0435\u0432\u0440\u0430\u043B\u044F_\u043C\u0430\u0440\u0442\u0430_\u0430\u043F\u0440\u0435\u043B\u044F_\u043C\u0430\u044F_\u0438\u044E\u043D\u044F_\u0438\u044E\u043B\u044F_\u0430\u0432\u0433\u0443\u0441\u0442\u0430_\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F_\u043E\u043A\u0442\u044F\u0431\u0440\u044F_\u043D\u043E\u044F\u0431\u0440\u044F_\u0434\u0435\u043A\u0430\u0431\u0440\u044F".split("_"),s2="\u044F\u043D\u0432\u0430\u0440\u044C_\u0444\u0435\u0432\u0440\u0430\u043B\u044C_\u043C\u0430\u0440\u0442_\u0430\u043F\u0440\u0435\u043B\u044C_\u043C\u0430\u0439_\u0438\u044E\u043D\u044C_\u0438\u044E\u043B\u044C_\u0430\u0432\u0433\u0443\u0441\u0442_\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044C_\u043E\u043A\u0442\u044F\u0431\u0440\u044C_\u043D\u043E\u044F\u0431\u0440\u044C_\u0434\u0435\u043A\u0430\u0431\u0440\u044C".split("_"),r2="\u044F\u043D\u0432._\u0444\u0435\u0432\u0440._\u043C\u0430\u0440._\u0430\u043F\u0440._\u043C\u0430\u044F_\u0438\u044E\u043D\u044F_\u0438\u044E\u043B\u044F_\u0430\u0432\u0433._\u0441\u0435\u043D\u0442._\u043E\u043A\u0442._\u043D\u043E\u044F\u0431._\u0434\u0435\u043A.".split("_"),o2="\u044F\u043D\u0432._\u0444\u0435\u0432\u0440._\u043C\u0430\u0440\u0442_\u0430\u043F\u0440._\u043C\u0430\u0439_\u0438\u044E\u043D\u044C_\u0438\u044E\u043B\u044C_\u0430\u0432\u0433._\u0441\u0435\u043D\u0442._\u043E\u043A\u0442._\u043D\u043E\u044F\u0431._\u0434\u0435\u043A.".split("_"),i=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function d(_2,t3,e3){var n3,s3;return e3==="m"?t3?"\u043C\u0438\u043D\u0443\u0442\u0430":"\u043C\u0438\u043D\u0443\u0442\u0443":_2+" "+(n3=+_2,s3={mm:t3?"\u043C\u0438\u043D\u0443\u0442\u0430_\u043C\u0438\u043D\u0443\u0442\u044B_\u043C\u0438\u043D\u0443\u0442":"\u043C\u0438\u043D\u0443\u0442\u0443_\u043C\u0438\u043D\u0443\u0442\u044B_\u043C\u0438\u043D\u0443\u0442",hh:"\u0447\u0430\u0441_\u0447\u0430\u0441\u0430_\u0447\u0430\u0441\u043E\u0432",dd:"\u0434\u0435\u043D\u044C_\u0434\u043D\u044F_\u0434\u043D\u0435\u0439",MM:"\u043C\u0435\u0441\u044F\u0446_\u043C\u0435\u0441\u044F\u0446\u0430_\u043C\u0435\u0441\u044F\u0446\u0435\u0432",yy:"\u0433\u043E\u0434_\u0433\u043E\u0434\u0430_\u043B\u0435\u0442"}[e3].split("_"),n3%10==1&&n3%100!=11?s3[0]:n3%10>=2&&n3%10<=4&&(n3%100<10||n3%100>=20)?s3[1]:s3[2]);}var u=function u(_2,t3){return i.test(t3)?n2[_2.month()]:s2[_2.month()];};u.s=s2,u.f=n2;var a2=function a2(_2,t3){return i.test(t3)?r2[_2.month()]:o2[_2.month()];};a2.s=o2,a2.f=r2;var m={name:"ru",weekdays:"\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435_\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A_\u0432\u0442\u043E\u0440\u043D\u0438\u043A_\u0441\u0440\u0435\u0434\u0430_\u0447\u0435\u0442\u0432\u0435\u0440\u0433_\u043F\u044F\u0442\u043D\u0438\u0446\u0430_\u0441\u0443\u0431\u0431\u043E\u0442\u0430".split("_"),weekdaysShort:"\u0432\u0441\u043A_\u043F\u043D\u0434_\u0432\u0442\u0440_\u0441\u0440\u0434_\u0447\u0442\u0432_\u043F\u0442\u043D_\u0441\u0431\u0442".split("_"),weekdaysMin:"\u0432\u0441_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),months:u,monthsShort:a2,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0433.",LLL:"D MMMM YYYY \u0433., H:mm",LLLL:"dddd, D MMMM YYYY \u0433., H:mm"},relativeTime:{future:"\u0447\u0435\u0440\u0435\u0437 %s",past:"%s \u043D\u0430\u0437\u0430\u0434",s:"\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0441\u0435\u043A\u0443\u043D\u0434",m:d,mm:d,h:"\u0447\u0430\u0441",hh:d,d:"\u0434\u0435\u043D\u044C",dd:d,M:"\u043C\u0435\u0441\u044F\u0446",MM:d,y:"\u0433\u043E\u0434",yy:d},ordinal:function ordinal(_2){return _2;},meridiem:function meridiem(_2){return _2<4?"\u043D\u043E\u0447\u0438":_2<12?"\u0443\u0442\u0440\u0430":_2<17?"\u0434\u043D\u044F":"\u0432\u0435\u0447\u0435\u0440\u0430";}};return e2["default"].locale(m,null,true),m;});});// node_modules/dayjs/locale/sv.js
var require_sv=__commonJS(function(exports,module){!function(e2,t2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=t2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],t2):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_sv=t2(e2.dayjs);}(exports,function(e2){"use strict";function t2(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var a2=t2(e2),d={name:"sv",weekdays:"s\xF6ndag_m\xE5ndag_tisdag_onsdag_torsdag_fredag_l\xF6rdag".split("_"),weekdaysShort:"s\xF6n_m\xE5n_tis_ons_tor_fre_l\xF6r".split("_"),weekdaysMin:"s\xF6_m\xE5_ti_on_to_fr_l\xF6".split("_"),months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function ordinal(e3){var t3=e3%10;return"["+e3+(t3===1||t3===2?"a":"e")+"]";},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},relativeTime:{future:"om %s",past:"f\xF6r %s sedan",s:"n\xE5gra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en m\xE5nad",MM:"%d m\xE5nader",y:"ett \xE5r",yy:"%d \xE5r"}};return a2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/tr.js
var require_tr=__commonJS(function(exports,module){!function(a2,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(a2=typeof globalThis!="undefined"?globalThis:a2||self).dayjs_locale_tr=e2(a2.dayjs);}(exports,function(a2){"use strict";function e2(a3){return a3&&_typeof4(a3)=="object"&&"default"in a3?a3:{"default":a3};}var t2=e2(a2),_={name:"tr",weekdays:"Pazar_Pazartesi_Sal\u0131_\xC7ar\u015Famba_Per\u015Fembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_\xC7ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_\xC7a_Pe_Cu_Ct".split("_"),months:"Ocak_\u015Eubat_Mart_Nisan_May\u0131s_Haziran_Temmuz_A\u011Fustos_Eyl\xFCl_Ekim_Kas\u0131m_Aral\u0131k".split("_"),monthsShort:"Oca_\u015Eub_Mar_Nis_May_Haz_Tem_A\u011Fu_Eyl_Eki_Kas_Ara".split("_"),weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"%s sonra",past:"%s \xF6nce",s:"birka\xE7 saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir g\xFCn",dd:"%d g\xFCn",M:"bir ay",MM:"%d ay",y:"bir y\u0131l",yy:"%d y\u0131l"},ordinal:function ordinal(a3){return a3+".";}};return t2["default"].locale(_,null,true),_;});});// node_modules/dayjs/locale/uk.js
var require_uk=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_uk=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),s2="\u0441\u0456\u0447\u043D\u044F_\u043B\u044E\u0442\u043E\u0433\u043E_\u0431\u0435\u0440\u0435\u0437\u043D\u044F_\u043A\u0432\u0456\u0442\u043D\u044F_\u0442\u0440\u0430\u0432\u043D\u044F_\u0447\u0435\u0440\u0432\u043D\u044F_\u043B\u0438\u043F\u043D\u044F_\u0441\u0435\u0440\u043F\u043D\u044F_\u0432\u0435\u0440\u0435\u0441\u043D\u044F_\u0436\u043E\u0432\u0442\u043D\u044F_\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434\u0430_\u0433\u0440\u0443\u0434\u043D\u044F".split("_"),n2="\u0441\u0456\u0447\u0435\u043D\u044C_\u043B\u044E\u0442\u0438\u0439_\u0431\u0435\u0440\u0435\u0437\u0435\u043D\u044C_\u043A\u0432\u0456\u0442\u0435\u043D\u044C_\u0442\u0440\u0430\u0432\u0435\u043D\u044C_\u0447\u0435\u0440\u0432\u0435\u043D\u044C_\u043B\u0438\u043F\u0435\u043D\u044C_\u0441\u0435\u0440\u043F\u0435\u043D\u044C_\u0432\u0435\u0440\u0435\u0441\u0435\u043D\u044C_\u0436\u043E\u0432\u0442\u0435\u043D\u044C_\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434_\u0433\u0440\u0443\u0434\u0435\u043D\u044C".split("_"),o2=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function d(_2,e3,t3){var s3,n3;return t3==="m"?e3?"\u0445\u0432\u0438\u043B\u0438\u043D\u0430":"\u0445\u0432\u0438\u043B\u0438\u043D\u0443":t3==="h"?e3?"\u0433\u043E\u0434\u0438\u043D\u0430":"\u0433\u043E\u0434\u0438\u043D\u0443":_2+" "+(s3=+_2,n3={ss:e3?"\u0441\u0435\u043A\u0443\u043D\u0434\u0430_\u0441\u0435\u043A\u0443\u043D\u0434\u0438_\u0441\u0435\u043A\u0443\u043D\u0434":"\u0441\u0435\u043A\u0443\u043D\u0434\u0443_\u0441\u0435\u043A\u0443\u043D\u0434\u0438_\u0441\u0435\u043A\u0443\u043D\u0434",mm:e3?"\u0445\u0432\u0438\u043B\u0438\u043D\u0430_\u0445\u0432\u0438\u043B\u0438\u043D\u0438_\u0445\u0432\u0438\u043B\u0438\u043D":"\u0445\u0432\u0438\u043B\u0438\u043D\u0443_\u0445\u0432\u0438\u043B\u0438\u043D\u0438_\u0445\u0432\u0438\u043B\u0438\u043D",hh:e3?"\u0433\u043E\u0434\u0438\u043D\u0430_\u0433\u043E\u0434\u0438\u043D\u0438_\u0433\u043E\u0434\u0438\u043D":"\u0433\u043E\u0434\u0438\u043D\u0443_\u0433\u043E\u0434\u0438\u043D\u0438_\u0433\u043E\u0434\u0438\u043D",dd:"\u0434\u0435\u043D\u044C_\u0434\u043D\u0456_\u0434\u043D\u0456\u0432",MM:"\u043C\u0456\u0441\u044F\u0446\u044C_\u043C\u0456\u0441\u044F\u0446\u0456_\u043C\u0456\u0441\u044F\u0446\u0456\u0432",yy:"\u0440\u0456\u043A_\u0440\u043E\u043A\u0438_\u0440\u043E\u043A\u0456\u0432"}[t3].split("_"),s3%10==1&&s3%100!=11?n3[0]:s3%10>=2&&s3%10<=4&&(s3%100<10||s3%100>=20)?n3[1]:n3[2]);}var i=function i(_2,e3){return o2.test(e3)?s2[_2.month()]:n2[_2.month()];};i.s=n2,i.f=s2;var r2={name:"uk",weekdays:"\u043D\u0435\u0434\u0456\u043B\u044F_\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A_\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A_\u0441\u0435\u0440\u0435\u0434\u0430_\u0447\u0435\u0442\u0432\u0435\u0440_\u043F\u2019\u044F\u0442\u043D\u0438\u0446\u044F_\u0441\u0443\u0431\u043E\u0442\u0430".split("_"),weekdaysShort:"\u043D\u0434\u043B_\u043F\u043D\u0434_\u0432\u0442\u0440_\u0441\u0440\u0434_\u0447\u0442\u0432_\u043F\u0442\u043D_\u0441\u0431\u0442".split("_"),weekdaysMin:"\u043D\u0434_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),months:i,monthsShort:"\u0441\u0456\u0447_\u043B\u044E\u0442_\u0431\u0435\u0440_\u043A\u0432\u0456\u0442_\u0442\u0440\u0430\u0432_\u0447\u0435\u0440\u0432_\u043B\u0438\u043F_\u0441\u0435\u0440\u043F_\u0432\u0435\u0440_\u0436\u043E\u0432\u0442_\u043B\u0438\u0441\u0442_\u0433\u0440\u0443\u0434".split("_"),weekStart:1,relativeTime:{future:"\u0437\u0430 %s",past:"%s \u0442\u043E\u043C\u0443",s:"\u0434\u0435\u043A\u0456\u043B\u044C\u043A\u0430 \u0441\u0435\u043A\u0443\u043D\u0434",m:d,mm:d,h:d,hh:d,d:"\u0434\u0435\u043D\u044C",dd:d,M:"\u043C\u0456\u0441\u044F\u0446\u044C",MM:d,y:"\u0440\u0456\u043A",yy:d},ordinal:function ordinal(_2){return _2;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0440.",LLL:"D MMMM YYYY \u0440., HH:mm",LLLL:"dddd, D MMMM YYYY \u0440., HH:mm"}};return t2["default"].locale(r2,null,true),r2;});});// node_modules/dayjs/locale/vi.js
var require_vi=__commonJS(function(exports,module){!function(t2,n2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=n2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],n2):(t2=typeof globalThis!="undefined"?globalThis:t2||self).dayjs_locale_vi=n2(t2.dayjs);}(exports,function(t2){"use strict";function n2(t3){return t3&&_typeof4(t3)=="object"&&"default"in t3?t3:{"default":t3};}var h=n2(t2),_={name:"vi",weekdays:"ch\u1EE7 nh\u1EADt_th\u1EE9 hai_th\u1EE9 ba_th\u1EE9 t\u01B0_th\u1EE9 n\u0103m_th\u1EE9 s\xE1u_th\u1EE9 b\u1EA3y".split("_"),months:"th\xE1ng 1_th\xE1ng 2_th\xE1ng 3_th\xE1ng 4_th\xE1ng 5_th\xE1ng 6_th\xE1ng 7_th\xE1ng 8_th\xE1ng 9_th\xE1ng 10_th\xE1ng 11_th\xE1ng 12".split("_"),weekStart:1,weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),ordinal:function ordinal(t3){return t3;},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [n\u0103m] YYYY",LLL:"D MMMM [n\u0103m] YYYY HH:mm",LLLL:"dddd, D MMMM [n\u0103m] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},relativeTime:{future:"%s t\u1EDBi",past:"%s tr\u01B0\u1EDBc",s:"v\xE0i gi\xE2y",m:"m\u1ED9t ph\xFAt",mm:"%d ph\xFAt",h:"m\u1ED9t gi\u1EDD",hh:"%d gi\u1EDD",d:"m\u1ED9t ng\xE0y",dd:"%d ng\xE0y",M:"m\u1ED9t th\xE1ng",MM:"%d th\xE1ng",y:"m\u1ED9t n\u0103m",yy:"%d n\u0103m"}};return h["default"].locale(_,null,true),_;});});// node_modules/dayjs/locale/zh-cn.js
var require_zh_cn=__commonJS(function(exports,module){!function(e2,_){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=_(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],_):(e2=typeof globalThis!="undefined"?globalThis:e2||self).dayjs_locale_zh_cn=_(e2.dayjs);}(exports,function(e2){"use strict";function _(e3){return e3&&_typeof4(e3)=="object"&&"default"in e3?e3:{"default":e3};}var t2=_(e2),d={name:"zh-cn",weekdays:"\u661F\u671F\u65E5_\u661F\u671F\u4E00_\u661F\u671F\u4E8C_\u661F\u671F\u4E09_\u661F\u671F\u56DB_\u661F\u671F\u4E94_\u661F\u671F\u516D".split("_"),weekdaysShort:"\u5468\u65E5_\u5468\u4E00_\u5468\u4E8C_\u5468\u4E09_\u5468\u56DB_\u5468\u4E94_\u5468\u516D".split("_"),weekdaysMin:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_"),months:"\u4E00\u6708_\u4E8C\u6708_\u4E09\u6708_\u56DB\u6708_\u4E94\u6708_\u516D\u6708_\u4E03\u6708_\u516B\u6708_\u4E5D\u6708_\u5341\u6708_\u5341\u4E00\u6708_\u5341\u4E8C\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function ordinal(e3,_2){return _2==="W"?e3+"\u5468":e3+"\u65E5";},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5Ah\u70B9mm\u5206",LLLL:"YYYY\u5E74M\u6708D\u65E5ddddAh\u70B9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524D",s:"\u51E0\u79D2",m:"1 \u5206\u949F",mm:"%d \u5206\u949F",h:"1 \u5C0F\u65F6",hh:"%d \u5C0F\u65F6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4E2A\u6708",MM:"%d \u4E2A\u6708",y:"1 \u5E74",yy:"%d \u5E74"},meridiem:function meridiem(e3,_2){var t3=100*e3+_2;return t3<600?"\u51CC\u6668":t3<900?"\u65E9\u4E0A":t3<1100?"\u4E0A\u5348":t3<1300?"\u4E2D\u5348":t3<1800?"\u4E0B\u5348":"\u665A\u4E0A";}};return t2["default"].locale(d,null,true),d;});});// node_modules/dayjs/locale/zh-tw.js
var require_zh_tw=__commonJS(function(exports,module){!function(_,e2){_typeof4(exports)=="object"&&typeof module!="undefined"?module.exports=e2(require_dayjs_min()):typeof define=="function"&&__webpack_require__.amdO?define(["dayjs"],e2):(_=typeof globalThis!="undefined"?globalThis:_||self).dayjs_locale_zh_tw=e2(_.dayjs);}(exports,function(_){"use strict";function e2(_2){return _2&&_typeof4(_2)=="object"&&"default"in _2?_2:{"default":_2};}var t2=e2(_),d={name:"zh-tw",weekdays:"\u661F\u671F\u65E5_\u661F\u671F\u4E00_\u661F\u671F\u4E8C_\u661F\u671F\u4E09_\u661F\u671F\u56DB_\u661F\u671F\u4E94_\u661F\u671F\u516D".split("_"),weekdaysShort:"\u9031\u65E5_\u9031\u4E00_\u9031\u4E8C_\u9031\u4E09_\u9031\u56DB_\u9031\u4E94_\u9031\u516D".split("_"),weekdaysMin:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_"),months:"\u4E00\u6708_\u4E8C\u6708_\u4E09\u6708_\u56DB\u6708_\u4E94\u6708_\u516D\u6708_\u4E03\u6708_\u516B\u6708_\u4E5D\u6708_\u5341\u6708_\u5341\u4E00\u6708_\u5341\u4E8C\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function ordinal(_2,e3){return e3==="W"?_2+"\u9031":_2+"\u65E5";},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5 HH:mm",LLLL:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm",l:"YYYY/M/D",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm"},relativeTime:{future:"%s\u5167",past:"%s\u524D",s:"\u5E7E\u79D2",m:"1 \u5206\u9418",mm:"%d \u5206\u9418",h:"1 \u5C0F\u6642",hh:"%d \u5C0F\u6642",d:"1 \u5929",dd:"%d \u5929",M:"1 \u500B\u6708",MM:"%d \u500B\u6708",y:"1 \u5E74",yy:"%d \u5E74"},meridiem:function meridiem(_2,e3){var t3=100*_2+e3;return t3<600?"\u51CC\u6668":t3<900?"\u65E9\u4E0A":t3<1100?"\u4E0A\u5348":t3<1300?"\u4E2D\u5348":t3<1800?"\u4E0B\u5348":"\u665A\u4E0A";}};return t2["default"].locale(d,null,true),d;});});// node_modules/trix/dist/trix.js
var require_trix=__commonJS(function(exports,module){(function(){}).call(exports),function(){var t2;window.Set==null&&(window.Set=t2=function(){function t3(){this.clear();}return t3.prototype.clear=function(){return this.values=[];},t3.prototype.has=function(t4){return this.values.indexOf(t4)!==-1;},t3.prototype.add=function(t4){return this.has(t4)||this.values.push(t4),this;},t3.prototype["delete"]=function(t4){var e2;return(e2=this.values.indexOf(t4))===-1?false:(this.values.splice(e2,1),true);},t3.prototype.forEach=function(){var t4;return(t4=this.values).forEach.apply(t4,arguments);},t3;}());}.call(exports),function(t2){function e2(){}function n2(t3,e3){return function(){t3.apply(e3,arguments);};}function i(t3){if(_typeof4(this)!="object")throw new TypeError("Promises must be constructed via new");if(typeof t3!="function")throw new TypeError("not a function");this._state=0,this._handled=false,this._value=void 0,this._deferreds=[],c2(t3,this);}function o2(t3,e3){for(;t3._state===3;){t3=t3._value;}return t3._state===0?void t3._deferreds.push(e3):(t3._handled=true,void h(function(){var n3=t3._state===1?e3.onFulfilled:e3.onRejected;if(n3===null)return void(t3._state===1?r2:s2)(e3.promise,t3._value);var i2;try{i2=n3(t3._value);}catch(o3){return void s2(e3.promise,o3);}r2(e3.promise,i2);}));}function r2(t3,e3){try{if(e3===t3)throw new TypeError("A promise cannot be resolved with itself.");if(e3&&(_typeof4(e3)=="object"||typeof e3=="function")){var o3=e3.then;if(e3 instanceof i)return t3._state=3,t3._value=e3,void a2(t3);if(typeof o3=="function")return void c2(n2(o3,e3),t3);}t3._state=1,t3._value=e3,a2(t3);}catch(r3){s2(t3,r3);}}function s2(t3,e3){t3._state=2,t3._value=e3,a2(t3);}function a2(t3){t3._state===2&&t3._deferreds.length===0&&setTimeout(function(){t3._handled||p2(t3._value);},1);for(var e3=0,n3=t3._deferreds.length;n3>e3;e3++){o2(t3,t3._deferreds[e3]);}t3._deferreds=null;}function u(t3,e3,n3){this.onFulfilled=typeof t3=="function"?t3:null,this.onRejected=typeof e3=="function"?e3:null,this.promise=n3;}function c2(t3,e3){var n3=false;try{t3(function(t4){n3||(n3=true,r2(e3,t4));},function(t4){n3||(n3=true,s2(e3,t4));});}catch(i2){if(n3)return;n3=true,s2(e3,i2);}}var l=setTimeout,h=typeof setImmediate=="function"&&setImmediate||function(t3){l(t3,1);},p2=function p2(t3){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",t3);};i.prototype["catch"]=function(t3){return this.then(null,t3);},i.prototype.then=function(t3,n3){var r3=new i(e2);return o2(this,new u(t3,n3,r3)),r3;},i.all=function(t3){var e3=Array.prototype.slice.call(t3);return new i(function(t4,n3){function i2(r4,s3){try{if(s3&&(_typeof4(s3)=="object"||typeof s3=="function")){var a3=s3.then;if(typeof a3=="function")return void a3.call(s3,function(t5){i2(r4,t5);},n3);}e3[r4]=s3,--o3===0&&t4(e3);}catch(u2){n3(u2);}}if(e3.length===0)return t4([]);for(var o3=e3.length,r3=0;r3<e3.length;r3++){i2(r3,e3[r3]);}});},i.resolve=function(t3){return t3&&_typeof4(t3)=="object"&&t3.constructor===i?t3:new i(function(e3){e3(t3);});},i.reject=function(t3){return new i(function(e3,n3){n3(t3);});},i.race=function(t3){return new i(function(e3,n3){for(var i2=0,o3=t3.length;o3>i2;i2++){t3[i2].then(e3,n3);}});},i._setImmediateFn=function(t3){h=t3;},i._setUnhandledRejectionFn=function(t3){p2=t3;},typeof module!="undefined"&&module.exports?module.exports=i:t2.Promise||(t2.Promise=i);}(exports),function(){var t2=_typeof4(window.customElements)=="object",e2=typeof document.registerElement=="function",n2=t2||e2;n2||(typeof WeakMap=="undefined"&&!function(){var t3=Object.defineProperty,e3=Date.now()%1e9,n3=function n3(){this.name="__st"+(1e9*Math.random()>>>0)+(e3++ +"__");};n3.prototype={set:function set(e4,n4){var i=e4[this.name];return i&&i[0]===e4?i[1]=n4:t3(e4,this.name,{value:[e4,n4],writable:true}),this;},get:function get(t4){var e4;return(e4=t4[this.name])&&e4[0]===t4?e4[1]:void 0;},"delete":function _delete(t4){var e4=t4[this.name];return e4&&e4[0]===t4?(e4[0]=e4[1]=void 0,true):false;},has:function has(t4){var e4=t4[this.name];return e4?e4[0]===t4:false;}},window.WeakMap=n3;}(),function(t3){function e3(t4){A.push(t4),b||(b=true,g(i));}function n3(t4){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(t4)||t4;}function i(){b=false;var t4=A;A=[],t4.sort(function(t5,e5){return t5.uid_-e5.uid_;});var e4=false;t4.forEach(function(t5){var n4=t5.takeRecords();o2(t5),n4.length&&(t5.callback_(n4,t5),e4=true);}),e4&&i();}function o2(t4){t4.nodes_.forEach(function(e4){var n4=m.get(e4);n4&&n4.forEach(function(e5){e5.observer===t4&&e5.removeTransientObservers();});});}function r2(t4,e4){for(var n4=t4;n4;n4=n4.parentNode){var i2=m.get(n4);if(i2)for(var o3=0;o3<i2.length;o3++){var r3=i2[o3],s3=r3.options;if(n4===t4||s3.subtree){var a3=e4(s3);a3&&r3.enqueue(a3);}}}}function s2(t4){this.callback_=t4,this.nodes_=[],this.records_=[],this.uid_=++C3;}function a2(t4,e4){this.type=t4,this.target=e4,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null;}function u(t4){var e4=new a2(t4.type,t4.target);return e4.addedNodes=t4.addedNodes.slice(),e4.removedNodes=t4.removedNodes.slice(),e4.previousSibling=t4.previousSibling,e4.nextSibling=t4.nextSibling,e4.attributeName=t4.attributeName,e4.attributeNamespace=t4.attributeNamespace,e4.oldValue=t4.oldValue,e4;}function c2(t4,e4){return x=new a2(t4,e4);}function l(t4){return w?w:(w=u(x),w.oldValue=t4,w);}function h(){x=w=void 0;}function p2(t4){return t4===w||t4===x;}function d(t4,e4){return t4===e4?t4:w&&p2(t4)?w:null;}function f(t4,e4,n4){this.observer=t4,this.target=e4,this.options=n4,this.transientObservedNodes=[];}if(!t3.JsMutationObserver){var g,m=new WeakMap();if(/Trident|Edge/.test(navigator.userAgent))g=setTimeout;else if(window.setImmediate)g=window.setImmediate;else{var v=[],y=String(Math.random());window.addEventListener("message",function(t4){if(t4.data===y){var e4=v;v=[],e4.forEach(function(t5){t5();});}}),g=function g(t4){v.push(t4),window.postMessage(y,"*");};}var b=false,A=[],C3=0;s2.prototype={observe:function observe(t4,e4){if(t4=n3(t4),!e4.childList&&!e4.attributes&&!e4.characterData||e4.attributeOldValue&&!e4.attributes||e4.attributeFilter&&e4.attributeFilter.length&&!e4.attributes||e4.characterDataOldValue&&!e4.characterData)throw new SyntaxError();var i2=m.get(t4);i2||m.set(t4,i2=[]);for(var o3,r3=0;r3<i2.length;r3++){if(i2[r3].observer===this){o3=i2[r3],o3.removeListeners(),o3.options=e4;break;}}o3||(o3=new f(this,t4,e4),i2.push(o3),this.nodes_.push(t4)),o3.addListeners();},disconnect:function disconnect(){this.nodes_.forEach(function(t4){for(var e4=m.get(t4),n4=0;n4<e4.length;n4++){var i2=e4[n4];if(i2.observer===this){i2.removeListeners(),e4.splice(n4,1);break;}}},this),this.records_=[];},takeRecords:function takeRecords(){var t4=this.records_;return this.records_=[],t4;}};var x,w;f.prototype={enqueue:function enqueue(t4){var n4=this.observer.records_,i2=n4.length;if(n4.length>0){var o3=n4[i2-1],r3=d(o3,t4);if(r3)return void(n4[i2-1]=r3);}else e3(this.observer);n4[i2]=t4;},addListeners:function addListeners(){this.addListeners_(this.target);},addListeners_:function addListeners_(t4){var e4=this.options;e4.attributes&&t4.addEventListener("DOMAttrModified",this,true),e4.characterData&&t4.addEventListener("DOMCharacterDataModified",this,true),e4.childList&&t4.addEventListener("DOMNodeInserted",this,true),(e4.childList||e4.subtree)&&t4.addEventListener("DOMNodeRemoved",this,true);},removeListeners:function removeListeners(){this.removeListeners_(this.target);},removeListeners_:function removeListeners_(t4){var e4=this.options;e4.attributes&&t4.removeEventListener("DOMAttrModified",this,true),e4.characterData&&t4.removeEventListener("DOMCharacterDataModified",this,true),e4.childList&&t4.removeEventListener("DOMNodeInserted",this,true),(e4.childList||e4.subtree)&&t4.removeEventListener("DOMNodeRemoved",this,true);},addTransientObserver:function addTransientObserver(t4){if(t4!==this.target){this.addListeners_(t4),this.transientObservedNodes.push(t4);var e4=m.get(t4);e4||m.set(t4,e4=[]),e4.push(this);}},removeTransientObservers:function removeTransientObservers(){var t4=this.transientObservedNodes;this.transientObservedNodes=[],t4.forEach(function(t5){this.removeListeners_(t5);for(var e4=m.get(t5),n4=0;n4<e4.length;n4++){if(e4[n4]===this){e4.splice(n4,1);break;}}},this);},handleEvent:function handleEvent(t4){switch(t4.stopImmediatePropagation(),t4.type){case"DOMAttrModified":var e4=t4.attrName,n4=t4.relatedNode.namespaceURI,i2=t4.target,o3=new c2("attributes",i2);o3.attributeName=e4,o3.attributeNamespace=n4;var s3=t4.attrChange===MutationEvent.ADDITION?null:t4.prevValue;r2(i2,function(t5){return!t5.attributes||t5.attributeFilter&&t5.attributeFilter.length&&t5.attributeFilter.indexOf(e4)===-1&&t5.attributeFilter.indexOf(n4)===-1?void 0:t5.attributeOldValue?l(s3):o3;});break;case"DOMCharacterDataModified":var i2=t4.target,o3=c2("characterData",i2),s3=t4.prevValue;r2(i2,function(t5){return t5.characterData?t5.characterDataOldValue?l(s3):o3:void 0;});break;case"DOMNodeRemoved":this.addTransientObserver(t4.target);case"DOMNodeInserted":var a3,u2,p3=t4.target;t4.type==="DOMNodeInserted"?(a3=[p3],u2=[]):(a3=[],u2=[p3]);var d2=p3.previousSibling,f2=p3.nextSibling,o3=c2("childList",t4.target.parentNode);o3.addedNodes=a3,o3.removedNodes=u2,o3.previousSibling=d2,o3.nextSibling=f2,r2(t4.relatedNode,function(t5){return t5.childList?o3:void 0;});}h();}},t3.JsMutationObserver=s2,t3.MutationObserver||(t3.MutationObserver=s2,s2._isPolyfilled=true);}}(self),function(){"use strict";if(!window.performance||!window.performance.now){var t3=Date.now();window.performance={now:function now(){return Date.now()-t3;}};}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var t4=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return t4?function(e4){return t4(function(){e4(performance.now());});}:function(t5){return window.setTimeout(t5,1e3/60);};}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t4){clearTimeout(t4);};}());var e3=function(){var t4=document.createEvent("Event");return t4.initEvent("foo",true,true),t4.preventDefault(),t4.defaultPrevented;}();if(!e3){var n3=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(n3.call(this),Object.defineProperty(this,"defaultPrevented",{get:function get(){return true;},configurable:true}));};}var i=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||i&&typeof window.CustomEvent!="function")&&(window.CustomEvent=function(t4,e4){e4=e4||{};var n4=document.createEvent("CustomEvent");return n4.initCustomEvent(t4,Boolean(e4.bubbles),Boolean(e4.cancelable),e4.detail),n4;},window.CustomEvent.prototype=window.Event.prototype),!window.Event||i&&typeof window.Event!="function"){var o2=window.Event;window.Event=function(t4,e4){e4=e4||{};var n4=document.createEvent("Event");return n4.initEvent(t4,Boolean(e4.bubbles),Boolean(e4.cancelable)),n4;},window.Event.prototype=o2.prototype;}}(window.WebComponents),window.CustomElements=window.CustomElements||{flags:{}},function(t3){var e3=t3.flags,n3=[],i=function i(t4){n3.push(t4);},o2=function o2(){n3.forEach(function(e4){e4(t3);});};t3.addModule=i,t3.initializeModules=o2,t3.hasNative=Boolean(document.registerElement),t3.isIE=/Trident/.test(navigator.userAgent),t3.useNative=!e3.register&&t3.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative);}(window.CustomElements),window.CustomElements.addModule(function(t3){function e3(t4,e4){n3(t4,function(t5){return e4(t5)?true:void i(t5,e4);}),i(t4,e4);}function n3(t4,e4,i2){var o3=t4.firstElementChild;if(!o3)for(o3=t4.firstChild;o3&&o3.nodeType!==Node.ELEMENT_NODE;){o3=o3.nextSibling;}for(;o3;){e4(o3,i2)!==true&&n3(o3,e4,i2),o3=o3.nextElementSibling;}return null;}function i(t4,n4){for(var i2=t4.shadowRoot;i2;){e3(i2,n4),i2=i2.olderShadowRoot;}}function o2(t4,e4){r2(t4,e4,[]);}function r2(t4,e4,n4){if(t4=window.wrap(t4),!(n4.indexOf(t4)>=0)){n4.push(t4);for(var i2,o3=t4.querySelectorAll("link[rel="+s2+"]"),a2=0,u=o3.length;u>a2&&(i2=o3[a2]);a2++){i2["import"]&&r2(i2["import"],e4,n4);}e4(t4);}}var s2=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";t3.forDocumentTree=o2,t3.forSubtree=e3;}),window.CustomElements.addModule(function(t3){function e3(t4,e4){return n3(t4,e4)||i(t4,e4);}function n3(e4,n4){return t3.upgrade(e4,n4)?true:void(n4&&s2(e4));}function i(t4,e4){b(t4,function(t5){return n3(t5,e4)?true:void 0;});}function o2(t4){w.push(t4),x||(x=true,setTimeout(r2));}function r2(){x=false;for(var t4,e4=w,n4=0,i2=e4.length;i2>n4&&(t4=e4[n4]);n4++){t4();}w=[];}function s2(t4){C3?o2(function(){a2(t4);}):a2(t4);}function a2(t4){t4.__upgraded__&&!t4.__attached&&(t4.__attached=true,t4.attachedCallback&&t4.attachedCallback());}function u(t4){c2(t4),b(t4,function(t5){c2(t5);});}function c2(t4){C3?o2(function(){l(t4);}):l(t4);}function l(t4){t4.__upgraded__&&t4.__attached&&(t4.__attached=false,t4.detachedCallback&&t4.detachedCallback());}function h(t4){for(var e4=t4,n4=window.wrap(document);e4;){if(e4==n4)return true;e4=e4.parentNode||e4.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e4.host;}}function p2(t4){if(t4.shadowRoot&&!t4.shadowRoot.__watched){y.dom&&console.log("watching shadow-root for: ",t4.localName);for(var e4=t4.shadowRoot;e4;){g(e4),e4=e4.olderShadowRoot;}}}function d(t4,n4){if(y.dom){var i2=n4[0];if(i2&&i2.type==="childList"&&i2.addedNodes&&i2.addedNodes){for(var o3=i2.addedNodes[0];o3&&o3!==document&&!o3.host;){o3=o3.parentNode;}var r3=o3&&(o3.URL||o3._URL||o3.host&&o3.host.localName)||"";r3=r3.split("/?").shift().split("/").pop();}console.group("mutations (%d) [%s]",n4.length,r3||"");}var s3=h(t4);n4.forEach(function(t5){t5.type==="childList"&&(E(t5.addedNodes,function(t6){t6.localName&&e3(t6,s3);}),E(t5.removedNodes,function(t6){t6.localName&&u(t6);}));}),y.dom&&console.groupEnd();}function f(t4){for(t4=window.wrap(t4),t4||(t4=window.wrap(document));t4.parentNode;){t4=t4.parentNode;}var e4=t4.__observer;e4&&(d(t4,e4.takeRecords()),r2());}function g(t4){if(!t4.__observer){var e4=new MutationObserver(d.bind(this,t4));e4.observe(t4,{childList:true,subtree:true}),t4.__observer=e4;}}function m(t4){t4=window.wrap(t4),y.dom&&console.group("upgradeDocument: ",t4.baseURI.split("/").pop());var n4=t4===window.wrap(document);e3(t4,n4),g(t4),y.dom&&console.groupEnd();}function v(t4){A(t4,m);}var y=t3.flags,b=t3.forSubtree,A=t3.forDocumentTree,C3=window.MutationObserver._isPolyfilled&&y["throttle-attached"];t3.hasPolyfillMutations=C3,t3.hasThrottledAttached=C3;var x=false,w=[],E=Array.prototype.forEach.call.bind(Array.prototype.forEach),S2=Element.prototype.createShadowRoot;S2&&(Element.prototype.createShadowRoot=function(){var t4=S2.call(this);return window.CustomElements.watchShadow(this),t4;}),t3.watchShadow=p2,t3.upgradeDocumentTree=v,t3.upgradeDocument=m,t3.upgradeSubtree=i,t3.upgradeAll=e3,t3.attached=s2,t3.takeRecords=f;}),window.CustomElements.addModule(function(t3){function e3(e4,i2){if(e4.localName==="template"&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e4),!e4.__upgraded__&&e4.nodeType===Node.ELEMENT_NODE){var o3=e4.getAttribute("is"),r3=t3.getRegisteredDefinition(e4.localName)||t3.getRegisteredDefinition(o3);if(r3&&(o3&&r3.tag==e4.localName||!o3&&!r3["extends"]))return n3(e4,r3,i2);}}function n3(e4,n4,o3){return s2.upgrade&&console.group("upgrade:",e4.localName),n4.is&&e4.setAttribute("is",n4.is),i(e4,n4),e4.__upgraded__=true,r2(e4),o3&&t3.attached(e4),t3.upgradeSubtree(e4,o3),s2.upgrade&&console.groupEnd(),e4;}function i(t4,e4){Object.__proto__?t4.__proto__=e4.prototype:(o2(t4,e4.prototype,e4["native"]),t4.__proto__=e4.prototype);}function o2(t4,e4,n4){for(var i2={},o3=e4;o3!==n4&&o3!==HTMLElement.prototype;){for(var r3,s3=Object.getOwnPropertyNames(o3),a2=0;r3=s3[a2];a2++){i2[r3]||(Object.defineProperty(t4,r3,Object.getOwnPropertyDescriptor(o3,r3)),i2[r3]=1);}o3=Object.getPrototypeOf(o3);}}function r2(t4){t4.createdCallback&&t4.createdCallback();}var s2=t3.flags;t3.upgrade=e3,t3.upgradeWithDefinition=n3,t3.implementPrototype=i;}),window.CustomElements.addModule(function(t3){function e3(e4,i2){var u2=i2||{};if(!e4)throw new Error("document.registerElement: first argument `name` must not be empty");if(e4.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(e4)+"'.");if(o2(e4))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(e4)+"'. The type name is invalid.");if(c2(e4))throw new Error("DuplicateDefinitionError: a type with name '"+String(e4)+"' is already registered");return u2.prototype||(u2.prototype=Object.create(HTMLElement.prototype)),u2.__name=e4.toLowerCase(),u2["extends"]&&(u2["extends"]=u2["extends"].toLowerCase()),u2.lifecycle=u2.lifecycle||{},u2.ancestry=r2(u2["extends"]),s2(u2),a2(u2),n3(u2.prototype),l(u2.__name,u2),u2.ctor=h(u2),u2.ctor.prototype=u2.prototype,u2.prototype.constructor=u2.ctor,t3.ready&&m(document),u2.ctor;}function n3(t4){if(!t4.setAttribute._polyfilled){var e4=t4.setAttribute;t4.setAttribute=function(t5,n5){i.call(this,t5,n5,e4);};var n4=t4.removeAttribute;t4.removeAttribute=function(t5){i.call(this,t5,null,n4);},t4.setAttribute._polyfilled=true;}}function i(t4,e4,n4){t4=t4.toLowerCase();var i2=this.getAttribute(t4);n4.apply(this,arguments);var o3=this.getAttribute(t4);this.attributeChangedCallback&&o3!==i2&&this.attributeChangedCallback(t4,i2,o3);}function o2(t4){for(var e4=0;e4<C3.length;e4++){if(t4===C3[e4])return true;}}function r2(t4){var e4=c2(t4);return e4?r2(e4["extends"]).concat([e4]):[];}function s2(t4){for(var e4,n4=t4["extends"],i2=0;e4=t4.ancestry[i2];i2++){n4=e4.is&&e4.tag;}t4.tag=n4||t4.__name,n4&&(t4.is=t4.__name);}function a2(t4){if(!Object.__proto__){var e4=HTMLElement.prototype;if(t4.is){var n4=document.createElement(t4.tag);e4=Object.getPrototypeOf(n4);}for(var i2,o3=t4.prototype,r3=false;o3;){o3==e4&&(r3=true),i2=Object.getPrototypeOf(o3),i2&&(o3.__proto__=i2),o3=i2;}r3||console.warn(t4.tag+" prototype not found in prototype chain for "+t4.is),t4["native"]=e4;}}function u(t4){return y(E(t4.tag),t4);}function c2(t4){return t4?x[t4.toLowerCase()]:void 0;}function l(t4,e4){x[t4]=e4;}function h(t4){return function(){return u(t4);};}function p2(t4,e4,n4){return t4===w?d(e4,n4):S2(t4,e4);}function d(t4,e4){t4&&(t4=t4.toLowerCase()),e4&&(e4=e4.toLowerCase());var n4=c2(e4||t4);if(n4){if(t4==n4.tag&&e4==n4.is)return new n4.ctor();if(!e4&&!n4.is)return new n4.ctor();}var i2;return e4?(i2=d(t4),i2.setAttribute("is",e4),i2):(i2=E(t4),t4.indexOf("-")>=0&&b(i2,HTMLElement),i2);}function f(t4,e4){var n4=t4[e4];t4[e4]=function(){var t5=n4.apply(this,arguments);return v(t5),t5;};}var g,m=(t3.isIE,t3.upgradeDocumentTree),v=t3.upgradeAll,y=t3.upgradeWithDefinition,b=t3.implementPrototype,A=t3.useNative,C3=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],x={},w="http://www.w3.org/1999/xhtml",E=document.createElement.bind(document),S2=document.createElementNS.bind(document);g=Object.__proto__||A?function(t4,e4){return t4 instanceof e4;}:function(t4,e4){if(t4 instanceof e4)return true;for(var n4=t4;n4;){if(n4===e4.prototype)return true;n4=n4.__proto__;}return false;},f(Node.prototype,"cloneNode"),f(document,"importNode"),document.registerElement=e3,document.createElement=d,document.createElementNS=p2,t3.registry=x,t3["instanceof"]=g,t3.reservedTagList=C3,t3.getRegisteredDefinition=c2,document.register=document.registerElement;}),function(t3){function e3(){r2(window.wrap(document)),window.CustomElements.ready=true;var t4=window.requestAnimationFrame||function(t5){setTimeout(t5,16);};t4(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:true}));});});}var n3=t3.useNative,i=t3.initializeModules;if(t3.isIE,n3){var o2=function o2(){};t3.watchShadow=o2,t3.upgrade=o2,t3.upgradeAll=o2,t3.upgradeDocumentTree=o2,t3.upgradeSubtree=o2,t3.takeRecords=o2,t3["instanceof"]=function(t4,e4){return t4 instanceof e4;};}else i();var r2=t3.upgradeDocumentTree,s2=t3.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(t4){return t4;}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(t4){t4["import"]&&s2(wrap(t4["import"]));}),document.readyState==="complete"||t3.flags.eager)e3();else if(document.readyState!=="interactive"||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var a2=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(a2,e3);}else e3();}(window.CustomElements));}.call(exports),function(){}.call(exports),function(){var t2=this;(function(){(function(){this.Trix={VERSION:"1.3.1",ZERO_WIDTH_SPACE:"\uFEFF",NON_BREAKING_SPACE:"\xA0",OBJECT_REPLACEMENT_CHARACTER:"\uFFFC",browser:{composesExistingText:/Android.*Chrome/.test(navigator.userAgent),forcesObjectResizing:/Trident.*rv:11/.test(navigator.userAgent),supportsInputEvents:function(){var t3,e3,n2,i;if(typeof InputEvent=="undefined")return false;for(i=["data","getTargetRanges","inputType"],t3=0,e3=i.length;e3>t3;t3++){if(n2=i[t3],!(n2 in InputEvent.prototype))return false;}return true;}()},config:{}};}).call(this);}).call(t2);var e2=t2.Trix;(function(){(function(){e2.BasicObject=function(){function t3(){}var e3,n2,i;return t3.proxyMethod=function(t4){var i2,o2,r2,s2,a2;return r2=n2(t4),i2=r2.name,s2=r2.toMethod,a2=r2.toProperty,o2=r2.optional,this.prototype[i2]=function(){var t5,n3;return t5=s2!=null?o2?typeof this[s2]=="function"?this[s2]():void 0:this[s2]():a2!=null?this[a2]:void 0,o2?(n3=t5!=null?t5[i2]:void 0,n3!=null?e3.call(n3,t5,arguments):void 0):(n3=t5[i2],e3.call(n3,t5,arguments));};},n2=function n2(t4){var e4,n3;if(!(n3=t4.match(i)))throw new Error("can't parse @proxyMethod expression: "+t4);return e4={name:n3[4]},n3[2]!=null?e4.toMethod=n3[1]:e4.toProperty=n3[1],n3[3]!=null&&(e4.optional=true),e4;},e3=Function.prototype.apply,i=/^(.+?)(\(\))?(\?)?\.(.+?)$/,t3;}();}).call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Object=function(n3){function i(){this.id=++o2;}var o2;return t3(i,n3),o2=0,i.fromJSONString=function(t4){return this.fromJSON(JSON.parse(t4));},i.prototype.hasSameConstructorAs=function(t4){return this.constructor===(t4!=null?t4.constructor:void 0);},i.prototype.isEqualTo=function(t4){return this===t4;},i.prototype.inspect=function(){var t4,e3,n4;return t4=function(){var t5,i2,o3;i2=(t5=this.contentsForInspection())!=null?t5:{},o3=[];for(e3 in i2){n4=i2[e3],o3.push(e3+"="+n4);}return o3;}.call(this),"#<"+this.constructor.name+":"+this.id+(t4.length?" "+t4.join(", "):"")+">";},i.prototype.contentsForInspection=function(){},i.prototype.toJSONString=function(){return JSON.stringify(this);},i.prototype.toUTF16String=function(){return e2.UTF16String.box(this);},i.prototype.getCacheKey=function(){return this.id.toString();},i;}(e2.BasicObject);}.call(this),function(){e2.extend=function(t3){var e3,n2;for(e3 in t3){n2=t3[e3],this[e3]=n2;}return this;};}.call(this),function(){e2.extend({defer:function defer(t3){return setTimeout(t3,1);}});}.call(this),function(){var t3,n2;e2.extend({normalizeSpaces:function normalizeSpaces(t4){return t4.replace(RegExp(""+e2.ZERO_WIDTH_SPACE,"g"),"").replace(RegExp(""+e2.NON_BREAKING_SPACE,"g")," ");},normalizeNewlines:function normalizeNewlines(t4){return t4.replace(/\r\n/g,"\n");},breakableWhitespacePattern:RegExp("[^\\S"+e2.NON_BREAKING_SPACE+"]"),squishBreakableWhitespace:function squishBreakableWhitespace(t4){return t4.replace(RegExp(""+e2.breakableWhitespacePattern.source,"g")," ").replace(/\ {2,}/g," ");},summarizeStringChange:function summarizeStringChange(t4,i){var o2,r2,s2,a2;return t4=e2.UTF16String.box(t4),i=e2.UTF16String.box(i),i.length<t4.length?(r2=n2(t4,i),a2=r2[0],o2=r2[1]):(s2=n2(i,t4),o2=s2[0],a2=s2[1]),{added:o2,removed:a2};}}),n2=function n2(n3,i){var o2,r2,s2,a2,u;return n3.isEqualTo(i)?["",""]:(r2=t3(n3,i),a2=r2.utf16String.length,s2=a2?(u=r2.offset,r2,o2=n3.codepoints.slice(0,u).concat(n3.codepoints.slice(u+a2)),t3(i,e2.UTF16String.fromCodepoints(o2))):t3(i,n3),[r2.utf16String.toString(),s2.utf16String.toString()]);},t3=function t3(t4,e3){var n3,i,o2;for(n3=0,i=t4.length,o2=e3.length;i>n3&&t4.charAt(n3).isEqualTo(e3.charAt(n3));){n3++;}for(;i>n3+1&&t4.charAt(i-1).isEqualTo(e3.charAt(o2-1));){i--,o2--;}return{utf16String:t4.slice(n3,i),offset:n3};};}.call(this),function(){e2.extend({copyObject:function copyObject(t3){var e3,n2,i;t3==null&&(t3={}),n2={};for(e3 in t3){i=t3[e3],n2[e3]=i;}return n2;},objectsAreEqual:function objectsAreEqual(t3,e3){var n2,i;if(t3==null&&(t3={}),e3==null&&(e3={}),Object.keys(t3).length!==Object.keys(e3).length)return false;for(n2 in t3){if(i=t3[n2],i!==e3[n2])return false;}return true;}});}.call(this),function(){var t3=[].slice;e2.extend({arraysAreEqual:function arraysAreEqual(t4,e3){var n2,i,o2,r2;if(t4==null&&(t4=[]),e3==null&&(e3=[]),t4.length!==e3.length)return false;for(i=n2=0,o2=t4.length;o2>n2;i=++n2){if(r2=t4[i],r2!==e3[i])return false;}return true;},arrayStartsWith:function arrayStartsWith(t4,n2){return t4==null&&(t4=[]),n2==null&&(n2=[]),e2.arraysAreEqual(t4.slice(0,n2.length),n2);},spliceArray:function spliceArray(){var e3,n2,i;return n2=arguments[0],e3=2<=arguments.length?t3.call(arguments,1):[],i=n2.slice(0),i.splice.apply(i,e3),i;},summarizeArrayChange:function summarizeArrayChange(t4,e3){var n2,i,o2,r2,s2,a2,u,c2,l,h,p2;for(t4==null&&(t4=[]),e3==null&&(e3=[]),n2=[],h=[],o2=new Set(),r2=0,u=t4.length;u>r2;r2++){p2=t4[r2],o2.add(p2);}for(i=new Set(),s2=0,c2=e3.length;c2>s2;s2++){p2=e3[s2],i.add(p2),o2.has(p2)||n2.push(p2);}for(a2=0,l=t4.length;l>a2;a2++){p2=t4[a2],i.has(p2)||h.push(p2);}return{added:n2,removed:h};}});}.call(this),function(){var t3,n2,i,o2;t3=null,n2=null,o2=null,i=null,e2.extend({getAllAttributeNames:function getAllAttributeNames(){return t3!=null?t3:t3=e2.getTextAttributeNames().concat(e2.getBlockAttributeNames());},getBlockConfig:function getBlockConfig(t4){return e2.config.blockAttributes[t4];},getBlockAttributeNames:function getBlockAttributeNames(){return n2!=null?n2:n2=Object.keys(e2.config.blockAttributes);},getTextConfig:function getTextConfig(t4){return e2.config.textAttributes[t4];},getTextAttributeNames:function getTextAttributeNames(){return o2!=null?o2:o2=Object.keys(e2.config.textAttributes);},getListAttributeNames:function getListAttributeNames(){var t4,n3;return i!=null?i:i=function(){var i2,o3;i2=e2.config.blockAttributes,o3=[];for(t4 in i2){n3=i2[t4].listAttribute,n3!=null&&o3.push(n3);}return o3;}();}});}.call(this),function(){var t3,n2,i,o2,r2,s2=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=document.documentElement,n2=(i=(o2=(r2=t3.matchesSelector)!=null?r2:t3.webkitMatchesSelector)!=null?o2:t3.msMatchesSelector)!=null?i:t3.mozMatchesSelector,e2.extend({handleEvent:function handleEvent(n3,i2){var o3,r3,_s,a2,u,c2,l,h,p2,d,f,g;return h=i2!=null?i2:{},c2=h.onElement,u=h.matchingSelector,g=h.withCallback,a2=h.inPhase,l=h.preventDefault,d=h.times,r3=c2!=null?c2:t3,p2=u,o3=g,f=a2==="capturing",_s=function s3(t4){var n4;return d!=null&&--d===0&&_s.destroy(),n4=e2.findClosestElementFromNode(t4.target,{matchingSelector:p2}),n4!=null&&(g!=null&&g.call(n4,t4,n4),l)?t4.preventDefault():void 0;},_s.destroy=function(){return r3.removeEventListener(n3,_s,f);},r3.addEventListener(n3,_s,f),_s;},handleEventOnce:function handleEventOnce(t4,n3){return n3==null&&(n3={}),n3.times=1,e2.handleEvent(t4,n3);},triggerEvent:function triggerEvent(n3,i2){var o3,r3,s3,a2,u,c2,l;return l=i2!=null?i2:{},c2=l.onElement,r3=l.bubbles,s3=l.cancelable,o3=l.attributes,a2=c2!=null?c2:t3,r3=r3!==false,s3=s3!==false,u=document.createEvent("Events"),u.initEvent(n3,r3,s3),o3!=null&&e2.extend.call(u,o3),a2.dispatchEvent(u);},elementMatchesSelector:function elementMatchesSelector(t4,e3){return(t4!=null?t4.nodeType:void 0)===1?n2.call(t4,e3):void 0;},findClosestElementFromNode:function findClosestElementFromNode(t4,n3){var i2,o3,r3;for(o3=n3!=null?n3:{},i2=o3.matchingSelector,r3=o3.untilNode;t4!=null&&t4.nodeType!==Node.ELEMENT_NODE;){t4=t4.parentNode;}if(t4!=null){if(i2==null)return t4;if(t4.closest&&r3==null)return t4.closest(i2);for(;t4&&t4!==r3;){if(e2.elementMatchesSelector(t4,i2))return t4;t4=t4.parentNode;}}},findInnerElement:function findInnerElement(t4){for(;t4!=null?t4.firstElementChild:void 0;){t4=t4.firstElementChild;}return t4;},innerElementIsActive:function innerElementIsActive(t4){return document.activeElement!==t4&&e2.elementContainsNode(t4,document.activeElement);},elementContainsNode:function elementContainsNode(t4,e3){if(t4&&e3)for(;e3;){if(e3===t4)return true;e3=e3.parentNode;}},findNodeFromContainerAndOffset:function findNodeFromContainerAndOffset(t4,e3){var n3;if(t4)return t4.nodeType===Node.TEXT_NODE?t4:e3===0?(n3=t4.firstChild)!=null?n3:t4:t4.childNodes.item(e3-1);},findElementFromContainerAndOffset:function findElementFromContainerAndOffset(t4,n3){var i2;return i2=e2.findNodeFromContainerAndOffset(t4,n3),e2.findClosestElementFromNode(i2);},findChildIndexOfNode:function findChildIndexOfNode(t4){var e3;if(t4!=null?t4.parentNode:void 0){for(e3=0;t4=t4.previousSibling;){e3++;}return e3;}},removeNode:function removeNode(t4){var e3;return t4!=null&&(e3=t4.parentNode)!=null?e3.removeChild(t4):void 0;},walkTree:function walkTree(t4,e3){var n3,i2,o3,r3,s3;return o3=e3!=null?e3:{},i2=o3.onlyNodesOfType,r3=o3.usingFilter,n3=o3.expandEntityReferences,s3=function(){switch(i2){case"element":return NodeFilter.SHOW_ELEMENT;case"text":return NodeFilter.SHOW_TEXT;case"comment":return NodeFilter.SHOW_COMMENT;default:return NodeFilter.SHOW_ALL;}}(),document.createTreeWalker(t4,s3,r3!=null?r3:null,n3===true);},tagName:function tagName(t4){var e3;return t4!=null&&(e3=t4.tagName)!=null?e3.toLowerCase():void 0;},makeElement:function makeElement(t4,e3){var n3,i2,o3,r3,s3,a2,u,c2,l,h,p2,d,f,g;if(e3==null&&(e3={}),_typeof4(t4)=="object"?(e3=t4,t4=e3.tagName):e3={attributes:e3},o3=document.createElement(t4),e3.editable!=null&&(e3.attributes==null&&(e3.attributes={}),e3.attributes.contenteditable=e3.editable),e3.attributes){l=e3.attributes;for(a2 in l){g=l[a2],o3.setAttribute(a2,g);}}if(e3.style){h=e3.style;for(a2 in h){g=h[a2],o3.style[a2]=g;}}if(e3.data){p2=e3.data;for(a2 in p2){g=p2[a2],o3.dataset[a2]=g;}}if(e3.className)for(d=e3.className.split(" "),r3=0,u=d.length;u>r3;r3++){i2=d[r3],o3.classList.add(i2);}if(e3.textContent&&(o3.textContent=e3.textContent),e3.childNodes)for(f=[].concat(e3.childNodes),s3=0,c2=f.length;c2>s3;s3++){n3=f[s3],o3.appendChild(n3);}return o3;},getBlockTagNames:function getBlockTagNames(){var t4,n3;return e2.blockTagNames!=null?e2.blockTagNames:e2.blockTagNames=function(){var i2,o3;i2=e2.config.blockAttributes,o3=[];for(t4 in i2){n3=i2[t4].tagName,n3&&o3.push(n3);}return o3;}();},nodeIsBlockContainer:function nodeIsBlockContainer(t4){return e2.nodeIsBlockStartComment(t4!=null?t4.firstChild:void 0);},nodeProbablyIsBlockContainer:function nodeProbablyIsBlockContainer(t4){var n3,i2;return n3=e2.tagName(t4),s2.call(e2.getBlockTagNames(),n3)>=0&&(i2=e2.tagName(t4.firstChild),s2.call(e2.getBlockTagNames(),i2)<0);},nodeIsBlockStart:function nodeIsBlockStart(t4,n3){var i2;return i2=(n3!=null?n3:{strict:true}).strict,i2?e2.nodeIsBlockStartComment(t4):e2.nodeIsBlockStartComment(t4)||!e2.nodeIsBlockStartComment(t4.firstChild)&&e2.nodeProbablyIsBlockContainer(t4);},nodeIsBlockStartComment:function nodeIsBlockStartComment(t4){return e2.nodeIsCommentNode(t4)&&(t4!=null?t4.data:void 0)==="block";},nodeIsCommentNode:function nodeIsCommentNode(t4){return(t4!=null?t4.nodeType:void 0)===Node.COMMENT_NODE;},nodeIsCursorTarget:function nodeIsCursorTarget(t4,n3){var i2;return i2=(n3!=null?n3:{}).name,t4?e2.nodeIsTextNode(t4)?t4.data===e2.ZERO_WIDTH_SPACE?i2?t4.parentNode.dataset.trixCursorTarget===i2:true:void 0:e2.nodeIsCursorTarget(t4.firstChild):void 0;},nodeIsAttachmentElement:function nodeIsAttachmentElement(t4){return e2.elementMatchesSelector(t4,e2.AttachmentView.attachmentSelector);},nodeIsEmptyTextNode:function nodeIsEmptyTextNode(t4){return e2.nodeIsTextNode(t4)&&(t4!=null?t4.data:void 0)==="";},nodeIsTextNode:function nodeIsTextNode(t4){return(t4!=null?t4.nodeType:void 0)===Node.TEXT_NODE;}});}.call(this),function(){var t3,n2,i,o2,r2;t3=e2.copyObject,o2=e2.objectsAreEqual,e2.extend({normalizeRange:i=function i(t4){var e3;if(t4!=null)return Array.isArray(t4)||(t4=[t4,t4]),[n2(t4[0]),n2((e3=t4[1])!=null?e3:t4[0])];},rangeIsCollapsed:function rangeIsCollapsed(t4){var e3,n3,o3;if(t4!=null)return n3=i(t4),o3=n3[0],e3=n3[1],r2(o3,e3);},rangesAreEqual:function rangesAreEqual(t4,e3){var n3,o3,s2,a2,u,c2;if(t4!=null&&e3!=null)return s2=i(t4),o3=s2[0],n3=s2[1],a2=i(e3),c2=a2[0],u=a2[1],r2(o3,c2)&&r2(n3,u);}}),n2=function n2(e3){return typeof e3=="number"?e3:t3(e3);},r2=function r2(t4,e3){return typeof t4=="number"?t4===e3:o2(t4,e3);};}.call(this),function(){var t3,n2,i,o2,r2,s2,a2;e2.registerElement=function(t4,e3){var n3,i2;return e3==null&&(e3={}),t4=t4.toLowerCase(),e3=a2(e3),i2=s2(e3),(n3=i2.defaultCSS)&&(delete i2.defaultCSS,o2(n3,t4)),r2(t4,i2);},o2=function o2(t4,e3){var n3;return n3=i(e3),n3.textContent=t4.replace(/%t/g,e3);},i=function i(e3){var n3,i2;return n3=document.createElement("style"),n3.setAttribute("type","text/css"),n3.setAttribute("data-tag-name",e3.toLowerCase()),(i2=t3())&&n3.setAttribute("nonce",i2),document.head.insertBefore(n3,document.head.firstChild),n3;},t3=function t3(){var t4;return(t4=n2("trix-csp-nonce")||n2("csp-nonce"))?t4.getAttribute("content"):void 0;},n2=function n2(t4){return document.head.querySelector("meta[name="+t4+"]");},s2=function s2(t4){var e3,n3,i2;n3={};for(e3 in t4){i2=t4[e3],n3[e3]=typeof i2=="function"?{value:i2}:i2;}return n3;},a2=function(){var t4;return t4=function t4(t5){var e3,n3,i2,o3,r3;for(e3={},r3=["initialize","connect","disconnect"],n3=0,o3=r3.length;o3>n3;n3++){i2=r3[n3],e3[i2]=t5[i2],delete t5[i2];}return e3;},window.customElements?function(e3){var n3,i2,o3,r3,s3;return s3=t4(e3),o3=s3.initialize,n3=s3.connect,i2=s3.disconnect,o3&&(r3=n3,n3=function n3(){return this.initialized||(this.initialized=true,o3.call(this)),r3!=null?r3.call(this):void 0;}),n3&&(e3.connectedCallback=n3),i2&&(e3.disconnectedCallback=i2),e3;}:function(e3){var n3,i2,o3,r3;return r3=t4(e3),o3=r3.initialize,n3=r3.connect,i2=r3.disconnect,o3&&(e3.createdCallback=o3),n3&&(e3.attachedCallback=n3),i2&&(e3.detachedCallback=i2),e3;};}(),r2=function(){return window.customElements?function(t4,e3){var _n;return _n=function n3(){return(typeof Reflect==="undefined"?"undefined":_typeof4(Reflect))=="object"?Reflect.construct(HTMLElement,[],_n):HTMLElement.apply(this);},Object.setPrototypeOf(_n.prototype,HTMLElement.prototype),Object.setPrototypeOf(_n,HTMLElement),Object.defineProperties(_n.prototype,e3),window.customElements.define(t4,_n),_n;}:function(t4,e3){var n3,i2;return i2=Object.create(HTMLElement.prototype,e3),n3=document.registerElement(t4,{prototype:i2}),Object.defineProperty(i2,"constructor",{value:n3}),n3;};}();}.call(this),function(){var t3,n2;e2.extend({getDOMSelection:function getDOMSelection(){var t4;return t4=window.getSelection(),t4.rangeCount>0?t4:void 0;},getDOMRange:function getDOMRange(){var n3,i;return(n3=(i=e2.getDOMSelection())!=null?i.getRangeAt(0):void 0)&&!t3(n3)?n3:void 0;},setDOMRange:function setDOMRange(t4){var n3;return n3=window.getSelection(),n3.removeAllRanges(),n3.addRange(t4),e2.selectionChangeObserver.update();}}),t3=function t3(t4){return n2(t4.startContainer)||n2(t4.endContainer);},n2=function n2(t4){return!Object.getPrototypeOf(t4);};}.call(this),function(){var t3;t3={"application/x-trix-feature-detection":"test"},e2.extend({dataTransferIsPlainText:function dataTransferIsPlainText(t4){var e3,n2,i;return i=t4.getData("text/plain"),n2=t4.getData("text/html"),i&&n2?(e3=new DOMParser().parseFromString(n2,"text/html").body,e3.textContent===i?!e3.querySelector("*"):void 0):i!=null?i.length:void 0;},dataTransferIsWritable:function dataTransferIsWritable(e3){var n2,i;if((e3!=null?e3.setData:void 0)!=null){for(n2 in t3){if(i=t3[n2],!function(){try{return e3.setData(n2,i),e3.getData(n2)===i;}catch(t4){}}())return;}return true;}},keyEventIsKeyboardCommand:function(){return /Mac|^iP/.test(navigator.platform)?function(t4){return t4.metaKey;}:function(t4){return t4.ctrlKey;};}()});}.call(this),function(){e2.extend({RTL_PATTERN:/[\u05BE\u05C0\u05C3\u05D0-\u05EA\u05F0-\u05F4\u061B\u061F\u0621-\u063A\u0640-\u064A\u066D\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D5\u06E5\u06E6\u200F\u202B\u202E\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE72\uFE74\uFE76-\uFEFC]/,getDirection:function(){var t3,n2,i,o2;return n2=e2.makeElement("input",{dir:"auto",name:"x",dirName:"x.dir"}),t3=e2.makeElement("form"),t3.appendChild(n2),i=function(){try{return new FormData(t3).has(n2.dirName);}catch(e3){}}(),o2=function(){try{return n2.matches(":dir(ltr),:dir(rtl)");}catch(t4){}}(),i?function(e3){return n2.value=e3,new FormData(t3).get(n2.dirName);}:o2?function(t4){return n2.value=t4,n2.matches(":dir(rtl)")?"rtl":"ltr";}:function(t4){var n3;return n3=t4.trim().charAt(0),e2.RTL_PATTERN.test(n3)?"rtl":"ltr";};}()});}.call(this),function(){}.call(this),function(){var t3,n2=function n2(t4,e3){function n3(){this.constructor=t4;}for(var o2 in e3){i.call(e3,o2)&&(t4[o2]=e3[o2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},i={}.hasOwnProperty;t3=e2.arraysAreEqual,e2.Hash=function(i2){function o2(t4){t4==null&&(t4={}),this.values=s2(t4),o2.__super__.constructor.apply(this,arguments);}var r2,s2,a2,u,c2;return n2(o2,i2),o2.fromCommonAttributesOfObjects=function(t4){var e3,n3,i3,o3,s3,a3;if(t4==null&&(t4=[]),!t4.length)return new this();for(e3=r2(t4[0]),i3=e3.getKeys(),a3=t4.slice(1),n3=0,o3=a3.length;o3>n3;n3++){s3=a3[n3],i3=e3.getKeysCommonToHash(r2(s3)),e3=e3.slice(i3);}return e3;},o2.box=function(t4){return r2(t4);},o2.prototype.add=function(t4,e3){return this.merge(u(t4,e3));},o2.prototype.remove=function(t4){return new e2.Hash(s2(this.values,t4));},o2.prototype.get=function(t4){return this.values[t4];},o2.prototype.has=function(t4){return t4 in this.values;},o2.prototype.merge=function(t4){return new e2.Hash(a2(this.values,c2(t4)));},o2.prototype.slice=function(t4){var n3,i3,o3,r3;for(r3={},n3=0,o3=t4.length;o3>n3;n3++){i3=t4[n3],this.has(i3)&&(r3[i3]=this.values[i3]);}return new e2.Hash(r3);},o2.prototype.getKeys=function(){return Object.keys(this.values);},o2.prototype.getKeysCommonToHash=function(t4){var e3,n3,i3,o3,s3;for(t4=r2(t4),o3=this.getKeys(),s3=[],e3=0,i3=o3.length;i3>e3;e3++){n3=o3[e3],this.values[n3]===t4.values[n3]&&s3.push(n3);}return s3;},o2.prototype.isEqualTo=function(e3){return t3(this.toArray(),r2(e3).toArray());},o2.prototype.isEmpty=function(){return this.getKeys().length===0;},o2.prototype.toArray=function(){var t4,e3,n3;return(this.array!=null?this.array:this.array=function(){var i3;e3=[],i3=this.values;for(t4 in i3){n3=i3[t4],e3.push(t4,n3);}return e3;}.call(this)).slice(0);},o2.prototype.toObject=function(){return s2(this.values);},o2.prototype.toJSON=function(){return this.toObject();},o2.prototype.contentsForInspection=function(){return{values:JSON.stringify(this.values)};},u=function u(t4,e3){var n3;return n3={},n3[t4]=e3,n3;},a2=function a2(t4,e3){var n3,i3,o3;i3=s2(t4);for(n3 in e3){o3=e3[n3],i3[n3]=o3;}return i3;},s2=function s2(t4,e3){var n3,i3,o3,r3,s3;for(r3={},s3=Object.keys(t4).sort(),n3=0,o3=s3.length;o3>n3;n3++){i3=s3[n3],i3!==e3&&(r3[i3]=t4[i3]);}return r3;},r2=function r2(t4){return t4 instanceof e2.Hash?t4:new e2.Hash(t4);},c2=function c2(t4){return t4 instanceof e2.Hash?t4.values:t4;},o2;}(e2.Object);}.call(this),function(){e2.ObjectGroup=function(){function t3(t4,e3){var n2,i;this.objects=t4!=null?t4:[],i=e3.depth,n2=e3.asTree,n2&&(this.depth=i,this.objects=this.constructor.groupObjects(this.objects,{asTree:n2,depth:this.depth+1}));}return t3.groupObjects=function(t4,e3){var n2,i,o2,r2,s2,a2,u,c2,l;for(t4==null&&(t4=[]),l=e3!=null?e3:{},o2=l.depth,n2=l.asTree,n2&&o2==null&&(o2=0),c2=[],s2=0,a2=t4.length;a2>s2;s2++){if(u=t4[s2],r2){if((typeof u.canBeGrouped=="function"?u.canBeGrouped(o2):void 0)&&(typeof(i=r2[r2.length-1]).canBeGroupedWith=="function"?i.canBeGroupedWith(u,o2):void 0)){r2.push(u);continue;}c2.push(new this(r2,{depth:o2,asTree:n2})),r2=null;}(typeof u.canBeGrouped=="function"?u.canBeGrouped(o2):void 0)?r2=[u]:c2.push(u);}return r2&&c2.push(new this(r2,{depth:o2,asTree:n2})),c2;},t3.prototype.getObjects=function(){return this.objects;},t3.prototype.getDepth=function(){return this.depth;},t3.prototype.getCacheKey=function(){var t4,e3,n2,i,o2;for(e3=["objectGroup"],o2=this.getObjects(),t4=0,n2=o2.length;n2>t4;t4++){i=o2[t4],e3.push(i.getCacheKey());}return e3.join("/");},t3;}();}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.ObjectMap=function(e3){function n3(t4){var e4,n4,i,o2,r2;for(t4==null&&(t4=[]),this.objects={},i=0,o2=t4.length;o2>i;i++){r2=t4[i],n4=JSON.stringify(r2),(e4=this.objects)[n4]==null&&(e4[n4]=r2);}}return t3(n3,e3),n3.prototype.find=function(t4){var e4;return e4=JSON.stringify(t4),this.objects[e4];},n3;}(e2.BasicObject);}.call(this),function(){e2.ElementStore=function(){function t3(t4){this.reset(t4);}var e3;return t3.prototype.add=function(t4){var n2;return n2=e3(t4),this.elements[n2]=t4;},t3.prototype.remove=function(t4){var n2,i;return n2=e3(t4),(i=this.elements[n2])?(delete this.elements[n2],i):void 0;},t3.prototype.reset=function(t4){var e4,n2,i;for(t4==null&&(t4=[]),this.elements={},n2=0,i=t4.length;i>n2;n2++){e4=t4[n2],this.add(e4);}return t4;},e3=function e3(t4){return t4.dataset.trixStoreKey;},t3;}();}.call(this),function(){}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Operation=function(e3){function n3(){return n3.__super__.constructor.apply(this,arguments);}return t3(n3,e3),n3.prototype.isPerforming=function(){return this.performing===true;},n3.prototype.hasPerformed=function(){return this.performed===true;},n3.prototype.hasSucceeded=function(){return this.performed&&this.succeeded;},n3.prototype.hasFailed=function(){return this.performed&&!this.succeeded;},n3.prototype.getPromise=function(){return this.promise!=null?this.promise:this.promise=new Promise(function(t4){return function(e4,n4){return t4.performing=true,t4.perform(function(i,o2){return t4.succeeded=i,t4.performing=false,t4.performed=true,t4.succeeded?e4(o2):n4(o2);});};}(this));},n3.prototype.perform=function(t4){return t4(false);},n3.prototype.release=function(){var t4;return(t4=this.promise)!=null&&typeof t4.cancel=="function"&&t4.cancel(),this.promise=null,this.performing=null,this.performed=null,this.succeeded=null;},n3.proxyMethod("getPromise().then"),n3.proxyMethod("getPromise().catch"),n3;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2,s2=function s2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){a2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},a2={}.hasOwnProperty;e2.UTF16String=function(t4){function e3(t5,e4){this.ucs2String=t5,this.codepoints=e4,this.length=this.codepoints.length,this.ucs2Length=this.ucs2String.length;}return s2(e3,t4),e3.box=function(t5){return t5==null&&(t5=""),t5 instanceof this?t5:this.fromUCS2String(t5!=null?t5.toString():void 0);},e3.fromUCS2String=function(t5){return new this(t5,o2(t5));},e3.fromCodepoints=function(t5){return new this(r2(t5),t5);},e3.prototype.offsetToUCS2Offset=function(t5){return r2(this.codepoints.slice(0,Math.max(0,t5))).length;},e3.prototype.offsetFromUCS2Offset=function(t5){return o2(this.ucs2String.slice(0,Math.max(0,t5))).length;},e3.prototype.slice=function(){var t5;return this.constructor.fromCodepoints((t5=this.codepoints).slice.apply(t5,arguments));},e3.prototype.charAt=function(t5){return this.slice(t5,t5+1);},e3.prototype.isEqualTo=function(t5){return this.constructor.box(t5).ucs2String===this.ucs2String;},e3.prototype.toJSON=function(){return this.ucs2String;},e3.prototype.getCacheKey=function(){return this.ucs2String;},e3.prototype.toString=function(){return this.ucs2String;},e3;}(e2.BasicObject),t3=(typeof Array.from=="function"?Array.from("\uD83D\uDC7C").length:void 0)===1,n2=(typeof" ".codePointAt=="function"?" ".codePointAt(0):void 0)!=null,i=(typeof String.fromCodePoint=="function"?String.fromCodePoint(32,128124):void 0)===" \uD83D\uDC7C",o2=t3&&n2?function(t4){return Array.from(t4).map(function(t5){return t5.codePointAt(0);});}:function(t4){var e3,n3,i2,o3,r3;for(o3=[],e3=0,i2=t4.length;i2>e3;){r3=t4.charCodeAt(e3++),r3>=55296&&56319>=r3&&i2>e3&&(n3=t4.charCodeAt(e3++),(64512&n3)===56320?r3=((1023&r3)<<10)+(1023&n3)+65536:e3--),o3.push(r3);}return o3;},r2=i?function(t4){return String.fromCodePoint.apply(String,t4);}:function(t4){var e3,n3,i2;return e3=function(){var e4,o3,r3;for(r3=[],e4=0,o3=t4.length;o3>e4;e4++){i2=t4[e4],n3="",i2>65535&&(i2-=65536,n3+=String.fromCharCode(i2>>>10&1023|55296),i2=56320|1023&i2),r3.push(n3+String.fromCharCode(i2));}return r3;}(),e3.join("");};}.call(this),function(){}.call(this),function(){}.call(this),function(){e2.config.lang={attachFiles:"Attach Files",bold:"Bold",bullets:"Bullets","byte":"Byte",bytes:"Bytes",captionPlaceholder:"Add a caption\u2026",code:"Code",heading1:"Heading",indent:"Increase Level",italic:"Italic",link:"Link",numbers:"Numbers",outdent:"Decrease Level",quote:"Quote",redo:"Redo",remove:"Remove",strike:"Strikethrough",undo:"Undo",unlink:"Unlink",url:"URL",urlPlaceholder:"Enter a URL\u2026",GB:"GB",KB:"KB",MB:"MB",PB:"PB",TB:"TB"};}.call(this),function(){e2.config.css={attachment:"attachment",attachmentCaption:"attachment__caption",attachmentCaptionEditor:"attachment__caption-editor",attachmentMetadata:"attachment__metadata",attachmentMetadataContainer:"attachment__metadata-container",attachmentName:"attachment__name",attachmentProgress:"attachment__progress",attachmentSize:"attachment__size",attachmentToolbar:"attachment__toolbar",attachmentGallery:"attachment-gallery"};}.call(this),function(){var t3;e2.config.blockAttributes=t3={"default":{tagName:"div",parse:false},quote:{tagName:"blockquote",nestable:true},heading1:{tagName:"h1",terminal:true,breakOnReturn:true,group:false},code:{tagName:"pre",terminal:true,text:{plaintext:true}},bulletList:{tagName:"ul",parse:false},bullet:{tagName:"li",listAttribute:"bulletList",group:false,nestable:true,test:function test(n2){return e2.tagName(n2.parentNode)===t3[this.listAttribute].tagName;}},numberList:{tagName:"ol",parse:false},number:{tagName:"li",listAttribute:"numberList",group:false,nestable:true,test:function test(n2){return e2.tagName(n2.parentNode)===t3[this.listAttribute].tagName;}},attachmentGallery:{tagName:"div",exclusive:true,terminal:true,parse:false,group:false}};}.call(this),function(){var t3,n2;t3=e2.config.lang,n2=[t3.bytes,t3.KB,t3.MB,t3.GB,t3.TB,t3.PB],e2.config.fileSize={prefix:"IEC",precision:2,formatter:function formatter(e3){var i,o2,r2,s2,a2;switch(e3){case 0:return"0 "+t3.bytes;case 1:return"1 "+t3["byte"];default:return i=function(){switch(this.prefix){case"SI":return 1e3;case"IEC":return 1024;}}.call(this),o2=Math.floor(Math.log(e3)/Math.log(i)),r2=e3/Math.pow(i,o2),s2=r2.toFixed(this.precision),a2=s2.replace(/0*$/,"").replace(/\.$/,""),a2+" "+n2[o2];}}};}.call(this),function(){e2.config.textAttributes={bold:{tagName:"strong",inheritable:true,parser:function parser(t3){var e3;return e3=window.getComputedStyle(t3),e3.fontWeight==="bold"||e3.fontWeight>=600;}},italic:{tagName:"em",inheritable:true,parser:function parser(t3){var e3;return e3=window.getComputedStyle(t3),e3.fontStyle==="italic";}},href:{groupTagName:"a",parser:function parser(t3){var n2,i,o2;return n2=e2.AttachmentView.attachmentSelector,o2="a:not("+n2+")",(i=e2.findClosestElementFromNode(t3,{matchingSelector:o2}))?i.getAttribute("href"):void 0;}},strike:{tagName:"del",inheritable:true},frozen:{style:{backgroundColor:"highlight"}}};}.call(this),function(){var t3,n2,i,o2,r2;r2="[data-trix-serialize=false]",o2=["contenteditable","data-trix-id","data-trix-store-key","data-trix-mutable","data-trix-placeholder","tabindex"],n2="data-trix-serialized-attributes",i="["+n2+"]",t3=new RegExp("<!--block-->","g"),e2.extend({serializers:{"application/json":function applicationJson(t4){var n3;if(t4 instanceof e2.Document)n3=t4;else{if(!(t4 instanceof HTMLElement))throw new Error("unserializable object");n3=e2.Document.fromHTML(t4.innerHTML);}return n3.toSerializableDocument().toJSONString();},"text/html":function textHtml(s2){var a2,u,c2,l,h,p2,d,f,g,m,v,y,b,A,C3,x,w;if(s2 instanceof e2.Document)l=e2.DocumentView.render(s2);else{if(!(s2 instanceof HTMLElement))throw new Error("unserializable object");l=s2.cloneNode(true);}for(A=l.querySelectorAll(r2),h=0,g=A.length;g>h;h++){c2=A[h],e2.removeNode(c2);}for(p2=0,m=o2.length;m>p2;p2++){for(a2=o2[p2],C3=l.querySelectorAll("["+a2+"]"),d=0,v=C3.length;v>d;d++){c2=C3[d],c2.removeAttribute(a2);}}for(x=l.querySelectorAll(i),f=0,y=x.length;y>f;f++){c2=x[f];try{u=JSON.parse(c2.getAttribute(n2)),c2.removeAttribute(n2);for(b in u){w=u[b],c2.setAttribute(b,w);}}catch(E){}}return l.innerHTML.replace(t3,"");}},deserializers:{"application/json":function applicationJson(t4){return e2.Document.fromJSONString(t4);},"text/html":function textHtml(t4){return e2.Document.fromHTML(t4);}},serializeToContentType:function serializeToContentType(t4,n3){var i2;if(i2=e2.serializers[n3])return i2(t4);throw new Error("unknown content type: "+n3);},deserializeFromContentType:function deserializeFromContentType(t4,n3){var i2;if(i2=e2.deserializers[n3])return i2(t4);throw new Error("unknown content type: "+n3);}});}.call(this),function(){var t3;t3=e2.config.lang,e2.config.toolbar={getDefaultHTML:function getDefaultHTML(){return'<div class="trix-button-row">\n  <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="'+t3.bold+'" tabindex="-1">'+t3.bold+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="'+t3.italic+'" tabindex="-1">'+t3.italic+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="'+t3.strike+'" tabindex="-1">'+t3.strike+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="'+t3.link+'" tabindex="-1">'+t3.link+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-heading-1" data-trix-attribute="heading1" title="'+t3.heading1+'" tabindex="-1">'+t3.heading1+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="'+t3.quote+'" tabindex="-1">'+t3.quote+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="'+t3.code+'" tabindex="-1">'+t3.code+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="'+t3.bullets+'" tabindex="-1">'+t3.bullets+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="'+t3.numbers+'" tabindex="-1">'+t3.numbers+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="'+t3.outdent+'" tabindex="-1">'+t3.outdent+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="'+t3.indent+'" tabindex="-1">'+t3.indent+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--file-tools" data-trix-button-group="file-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-attach" data-trix-action="attachFiles" title="'+t3.attachFiles+'" tabindex="-1">'+t3.attachFiles+'</button>\n  </span>\n\n  <span class="trix-button-group-spacer"></span>\n\n  <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="'+t3.undo+'" tabindex="-1">'+t3.undo+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="'+t3.redo+'" tabindex="-1">'+t3.redo+'</button>\n  </span>\n</div>\n\n<div class="trix-dialogs" data-trix-dialogs>\n  <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">\n    <div class="trix-dialog__link-fields">\n      <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="'+t3.urlPlaceholder+'" aria-label="'+t3.url+'" required data-trix-input>\n      <div class="trix-button-group">\n        <input type="button" class="trix-button trix-button--dialog" value="'+t3.link+'" data-trix-method="setAttribute">\n        <input type="button" class="trix-button trix-button--dialog" value="'+t3.unlink+'" data-trix-method="removeAttribute">\n      </div>\n    </div>\n  </div>\n</div>';}};}.call(this),function(){e2.config.undoInterval=5e3;}.call(this),function(){e2.config.attachments={preview:{presentation:"gallery",caption:{name:true,size:true}},file:{caption:{size:true}}};}.call(this),function(){e2.config.keyNames={8:"backspace",9:"tab",13:"return",27:"escape",37:"left",39:"right",46:"delete",68:"d",72:"h",79:"o"};}.call(this),function(){e2.config.input={level2Enabled:true,getLevel:function getLevel(){return this.level2Enabled&&e2.browser.supportsInputEvents?2:0;},pickFiles:function pickFiles(t3){var n2;return n2=e2.makeElement("input",{type:"file",multiple:true,hidden:true,id:this.fileInputId}),n2.addEventListener("change",function(){return t3(n2.files),e2.removeNode(n2);}),e2.removeNode(document.getElementById(this.fileInputId)),document.body.appendChild(n2),n2.click();},fileInputId:"trix-file-input-"+Date.now().toString(16)};}.call(this),function(){}.call(this),function(){e2.registerElement("trix-toolbar",{defaultCSS:"%t {\n  display: block;\n}\n\n%t {\n  white-space: nowrap;\n}\n\n%t [data-trix-dialog] {\n  display: none;\n}\n\n%t [data-trix-dialog][data-trix-active] {\n  display: block;\n}\n\n%t [data-trix-dialog] [data-trix-validate]:invalid {\n  background-color: #ffdddd;\n}",initialize:function initialize(){return this.innerHTML===""?this.innerHTML=e2.config.toolbar.getDefaultHTML():void 0;}});}.call(this),function(){var t3=function t3(t4,e3){function i2(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i2.prototype=e3.prototype,t4.prototype=new i2(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty,i=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};e2.ObjectView=function(n3){function o2(t4,e3){this.object=t4,this.options=e3!=null?e3:{},this.childViews=[],this.rootView=this;}return t3(o2,n3),o2.prototype.getNodes=function(){var t4,e3,n4,i2,o3;for(this.nodes==null&&(this.nodes=this.createNodes()),i2=this.nodes,o3=[],t4=0,e3=i2.length;e3>t4;t4++){n4=i2[t4],o3.push(n4.cloneNode(true));}return o3;},o2.prototype.invalidate=function(){var t4;return this.nodes=null,this.childViews=[],(t4=this.parentView)!=null?t4.invalidate():void 0;},o2.prototype.invalidateViewForObject=function(t4){var e3;return(e3=this.findViewForObject(t4))!=null?e3.invalidate():void 0;},o2.prototype.findOrCreateCachedChildView=function(t4,e3){var n4;return(n4=this.getCachedViewForObject(e3))?this.recordChildView(n4):(n4=this.createChildView.apply(this,arguments),this.cacheViewForObject(n4,e3)),n4;},o2.prototype.createChildView=function(t4,n4,i2){var o3;return i2==null&&(i2={}),n4 instanceof e2.ObjectGroup&&(i2.viewClass=t4,t4=e2.ObjectGroupView),o3=new t4(n4,i2),this.recordChildView(o3);},o2.prototype.recordChildView=function(t4){return t4.parentView=this,t4.rootView=this.rootView,this.childViews.push(t4),t4;},o2.prototype.getAllChildViews=function(){var t4,e3,n4,i2,o3;for(o3=[],i2=this.childViews,e3=0,n4=i2.length;n4>e3;e3++){t4=i2[e3],o3.push(t4),o3=o3.concat(t4.getAllChildViews());}return o3;},o2.prototype.findElement=function(){return this.findElementForObject(this.object);},o2.prototype.findElementForObject=function(t4){var e3;return(e3=t4!=null?t4.id:void 0)?this.rootView.element.querySelector("[data-trix-id='"+e3+"']"):void 0;},o2.prototype.findViewForObject=function(t4){var e3,n4,i2,o3;for(i2=this.getAllChildViews(),e3=0,n4=i2.length;n4>e3;e3++){if(o3=i2[e3],o3.object===t4)return o3;}},o2.prototype.getViewCache=function(){return this.rootView!==this?this.rootView.getViewCache():this.isViewCachingEnabled()?this.viewCache!=null?this.viewCache:this.viewCache={}:void 0;},o2.prototype.isViewCachingEnabled=function(){return this.shouldCacheViews!==false;},o2.prototype.enableViewCaching=function(){return this.shouldCacheViews=true;},o2.prototype.disableViewCaching=function(){return this.shouldCacheViews=false;},o2.prototype.getCachedViewForObject=function(t4){var e3;return(e3=this.getViewCache())!=null?e3[t4.getCacheKey()]:void 0;},o2.prototype.cacheViewForObject=function(t4,e3){var n4;return(n4=this.getViewCache())!=null?n4[e3.getCacheKey()]=t4:void 0;},o2.prototype.garbageCollectCachedViews=function(){var t4,e3,n4,o3,r2,s2;if(t4=this.getViewCache()){s2=this.getAllChildViews().concat(this),n4=function(){var t5,e4,n5;for(n5=[],t5=0,e4=s2.length;e4>t5;t5++){r2=s2[t5],n5.push(r2.object.getCacheKey());}return n5;}(),o3=[];for(e3 in t4){i.call(n4,e3)<0&&o3.push(delete t4[e3]);}return o3;}},o2;}(e2.BasicObject);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.ObjectGroupView=function(e3){function n3(){n3.__super__.constructor.apply(this,arguments),this.objectGroup=this.object,this.viewClass=this.options.viewClass,delete this.options.viewClass;}return t3(n3,e3),n3.prototype.getChildViews=function(){var t4,e4,n4,i;if(!this.childViews.length)for(i=this.objectGroup.getObjects(),t4=0,e4=i.length;e4>t4;t4++){n4=i[t4],this.findOrCreateCachedChildView(this.viewClass,n4,this.options);}return this.childViews;},n3.prototype.createNodes=function(){var t4,e4,n4,i,o2,r2,s2,a2,u;for(t4=this.createContainerElement(),s2=this.getChildViews(),e4=0,i=s2.length;i>e4;e4++){for(u=s2[e4],a2=u.getNodes(),n4=0,o2=a2.length;o2>n4;n4++){r2=a2[n4],t4.appendChild(r2);}}return[t4];},n3.prototype.createContainerElement=function(t4){return t4==null&&(t4=this.objectGroup.getDepth()),this.getChildViews()[0].createContainerElement(t4);},n3;}(e2.ObjectView);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Controller=function(e3){function n3(){return n3.__super__.constructor.apply(this,arguments);}return t3(n3,e3),n3;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2=function a2(t4,e3){return function(){return t4.apply(e3,arguments);};},u=function u(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){c2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},c2={}.hasOwnProperty,l=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=e2.findClosestElementFromNode,i=e2.nodeIsEmptyTextNode,n2=e2.nodeIsBlockStartComment,o2=e2.normalizeSpaces,r2=e2.summarizeStringChange,s2=e2.tagName,e2.MutationObserver=function(e3){function c3(t4){this.element=t4,this.didMutate=a2(this.didMutate,this),this.observer=new window.MutationObserver(this.didMutate),this.start();}var _h2,p2,d,f;return u(c3,e3),p2="data-trix-mutable",d="["+p2+"]",f={attributes:true,childList:true,characterData:true,characterDataOldValue:true,subtree:true},c3.prototype.start=function(){return this.reset(),this.observer.observe(this.element,f);},c3.prototype.stop=function(){return this.observer.disconnect();},c3.prototype.didMutate=function(t4){var e4,n3;return(e4=this.mutations).push.apply(e4,this.findSignificantMutations(t4)),this.mutations.length?((n3=this.delegate)!=null&&typeof n3.elementDidMutate=="function"&&n3.elementDidMutate(this.getMutationSummary()),this.reset()):void 0;},c3.prototype.reset=function(){return this.mutations=[];},c3.prototype.findSignificantMutations=function(t4){var e4,n3,i2,o3;for(o3=[],e4=0,n3=t4.length;n3>e4;e4++){i2=t4[e4],this.mutationIsSignificant(i2)&&o3.push(i2);}return o3;},c3.prototype.mutationIsSignificant=function(t4){var e4,n3,i2,o3;if(this.nodeIsMutable(t4.target))return false;for(o3=this.nodesModifiedByMutation(t4),e4=0,n3=o3.length;n3>e4;e4++){if(i2=o3[e4],this.nodeIsSignificant(i2))return true;}return false;},c3.prototype.nodeIsSignificant=function(t4){return t4!==this.element&&!this.nodeIsMutable(t4)&&!i(t4);},c3.prototype.nodeIsMutable=function(e4){return t3(e4,{matchingSelector:d});},c3.prototype.nodesModifiedByMutation=function(t4){var e4;switch(e4=[],t4.type){case"attributes":t4.attributeName!==p2&&e4.push(t4.target);break;case"characterData":e4.push(t4.target.parentNode),e4.push(t4.target);break;case"childList":e4.push.apply(e4,t4.addedNodes),e4.push.apply(e4,t4.removedNodes);}return e4;},c3.prototype.getMutationSummary=function(){return this.getTextMutationSummary();},c3.prototype.getTextMutationSummary=function(){var t4,e4,n3,i2,o3,r3,s3,a3,u2,c4,h2;for(a3=this.getTextChangesFromCharacterData(),n3=a3.additions,o3=a3.deletions,h2=this.getTextChangesFromChildList(),u2=h2.additions,r3=0,s3=u2.length;s3>r3;r3++){e4=u2[r3],l.call(n3,e4)<0&&n3.push(e4);}return o3.push.apply(o3,h2.deletions),c4={},(t4=n3.join(""))&&(c4.textAdded=t4),(i2=o3.join(""))&&(c4.textDeleted=i2),c4;},c3.prototype.getMutationsByType=function(t4){var e4,n3,i2,o3,r3;for(o3=this.mutations,r3=[],e4=0,n3=o3.length;n3>e4;e4++){i2=o3[e4],i2.type===t4&&r3.push(i2);}return r3;},c3.prototype.getTextChangesFromChildList=function(){var t4,e4,i2,r3,s3,a3,u2,c4,l2,p3,d2;for(t4=[],u2=[],a3=this.getMutationsByType("childList"),e4=0,r3=a3.length;r3>e4;e4++){s3=a3[e4],t4.push.apply(t4,s3.addedNodes),u2.push.apply(u2,s3.removedNodes);}return c4=t4.length===0&&u2.length===1&&n2(u2[0]),c4?(p3=[],d2=["\n"]):(p3=_h2(t4),d2=_h2(u2)),{additions:function(){var t5,e5,n3;for(n3=[],i2=t5=0,e5=p3.length;e5>t5;i2=++t5){l2=p3[i2],l2!==d2[i2]&&n3.push(o2(l2));}return n3;}(),deletions:function(){var t5,e5,n3;for(n3=[],i2=t5=0,e5=d2.length;e5>t5;i2=++t5){l2=d2[i2],l2!==p3[i2]&&n3.push(o2(l2));}return n3;}()};},c3.prototype.getTextChangesFromCharacterData=function(){var t4,e4,n3,i2,s3,a3,u2,c4;return e4=this.getMutationsByType("characterData"),e4.length&&(c4=e4[0],n3=e4[e4.length-1],s3=o2(c4.oldValue),i2=o2(n3.target.data),a3=r2(s3,i2),t4=a3.added,u2=a3.removed),{additions:t4?[t4]:[],deletions:u2?[u2]:[]};},_h2=function h(t4){var e4,n3,i2,o3;for(t4==null&&(t4=[]),o3=[],e4=0,n3=t4.length;n3>e4;e4++){switch(i2=t4[e4],i2.nodeType){case Node.TEXT_NODE:o3.push(i2.data);break;case Node.ELEMENT_NODE:s2(i2)==="br"?o3.push("\n"):o3.push.apply(o3,_h2(i2.childNodes));}}return o3;},c3;}(e2.BasicObject);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.FileVerificationOperation=function(e3){function n3(t4){this.file=t4;}return t3(n3,e3),n3.prototype.perform=function(t4){var e4;return e4=new FileReader(),e4.onerror=function(){return t4(false);},e4.onload=function(n4){return function(){e4.onerror=null;try{e4.abort();}catch(i){}return t4(true,n4.file);};}(this),e4.readAsArrayBuffer(this.file);},n3;}(e2.Operation);}.call(this),function(){var t3,n2,i=function i(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){o2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},o2={}.hasOwnProperty;t3=e2.handleEvent,n2=e2.innerElementIsActive,e2.InputController=function(o3){function r2(n3){var i2;this.element=n3,this.mutationObserver=new e2.MutationObserver(this.element),this.mutationObserver.delegate=this;for(i2 in this.events){t3(i2,{onElement:this.element,withCallback:this.handlerFor(i2)});}}return i(r2,o3),r2.prototype.events={},r2.prototype.elementDidMutate=function(){},r2.prototype.editorWillSyncDocumentView=function(){return this.mutationObserver.stop();},r2.prototype.editorDidSyncDocumentView=function(){return this.mutationObserver.start();},r2.prototype.requestRender=function(){var t4;return(t4=this.delegate)!=null&&typeof t4.inputControllerDidRequestRender=="function"?t4.inputControllerDidRequestRender():void 0;},r2.prototype.requestReparse=function(){var t4;return(t4=this.delegate)!=null&&typeof t4.inputControllerDidRequestReparse=="function"&&t4.inputControllerDidRequestReparse(),this.requestRender();},r2.prototype.attachFiles=function(t4){var n3,i2;return i2=function(){var i3,o4,r3;for(r3=[],i3=0,o4=t4.length;o4>i3;i3++){n3=t4[i3],r3.push(new e2.FileVerificationOperation(n3));}return r3;}(),Promise.all(i2).then(function(t5){return function(e3){return t5.handleInput(function(){var t6,n4;return(t6=this.delegate)!=null&&t6.inputControllerWillAttachFiles(),(n4=this.responder)!=null&&n4.insertFiles(e3),this.requestRender();});};}(this));},r2.prototype.handlerFor=function(t4){return function(e3){return function(i2){return i2.defaultPrevented?void 0:e3.handleInput(function(){return n2(this.element)?void 0:(this.eventName=t4,this.events[t4].call(this,i2));});};}(this);},r2.prototype.handleInput=function(t4){var e3,n3;try{return(e3=this.delegate)!=null&&e3.inputControllerWillHandleInput(),t4.call(this);}finally{(n3=this.delegate)!=null&&n3.inputControllerDidHandleInput();}},r2.prototype.createLinkHTML=function(t4,e3){var n3;return n3=document.createElement("a"),n3.href=t4,n3.textContent=e3!=null?e3:t4,n3.outerHTML;},r2;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2,l,h,p2,d,f=function f(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){g.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},g={}.hasOwnProperty,m=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};c2=e2.makeElement,l=e2.objectsAreEqual,d=e2.tagName,n2=e2.browser,a2=e2.keyEventIsKeyboardCommand,o2=e2.dataTransferIsWritable,i=e2.dataTransferIsPlainText,u=e2.config.keyNames,e2.Level0InputController=function(n3){function s3(){s3.__super__.constructor.apply(this,arguments),this.resetInputSummary();}var d2;return f(s3,n3),d2=0,s3.prototype.setInputSummary=function(t4){var e3,n4;t4==null&&(t4={}),this.inputSummary.eventName=this.eventName;for(e3 in t4){n4=t4[e3],this.inputSummary[e3]=n4;}return this.inputSummary;},s3.prototype.resetInputSummary=function(){return this.inputSummary={};},s3.prototype.reset=function(){return this.resetInputSummary(),e2.selectionChangeObserver.reset();},s3.prototype.elementDidMutate=function(t4){var e3;return this.isComposing()?(e3=this.delegate)!=null&&typeof e3.inputControllerDidAllowUnhandledInput=="function"?e3.inputControllerDidAllowUnhandledInput():void 0:this.handleInput(function(){return this.mutationIsSignificant(t4)&&(this.mutationIsExpected(t4)?this.requestRender():this.requestReparse()),this.reset();});},s3.prototype.mutationIsExpected=function(t4){var e3,n4,i2,o3,r3,s4,a3,u2,c3,l2;return a3=t4.textAdded,u2=t4.textDeleted,this.inputSummary.preferDocument?true:(e3=a3!=null?a3===this.inputSummary.textAdded:!this.inputSummary.textAdded,n4=u2!=null?this.inputSummary.didDelete:!this.inputSummary.didDelete,c3=(a3==="\n"||a3===" \n")&&!e3,l2=u2==="\n"&&!n4,s4=c3&&!l2||l2&&!c3,s4&&(o3=this.getSelectedRange())&&(i2=c3?a3.replace(/\n$/,"").length||-1:(a3!=null?a3.length:void 0)||1,(r3=this.responder)!=null?r3.positionIsBlockBreak(o3[1]+i2):void 0)?true:e3&&n4);},s3.prototype.mutationIsSignificant=function(t4){var e3,n4,i2;return i2=Object.keys(t4).length>0,e3=((n4=this.compositionInput)!=null?n4.getEndData():void 0)==="",i2||!e3;},s3.prototype.events={keydown:function keydown(t4){var n4,i2,o3,r3,s4,c3,l2,h2,p3;if(this.isComposing()||this.resetInputSummary(),this.inputSummary.didInput=true,r3=u[t4.keyCode]){for(i2=this.keys,h2=["ctrl","alt","shift","meta"],o3=0,c3=h2.length;c3>o3;o3++){l2=h2[o3],t4[l2+"Key"]&&(l2==="ctrl"&&(l2="control"),i2=i2!=null?i2[l2]:void 0);}(i2!=null?i2[r3]:void 0)!=null&&(this.setInputSummary({keyName:r3}),e2.selectionChangeObserver.reset(),i2[r3].call(this,t4));}return a2(t4)&&(n4=String.fromCharCode(t4.keyCode).toLowerCase())&&(s4=function(){var e3,n5,i3,o4;for(i3=["alt","shift"],o4=[],e3=0,n5=i3.length;n5>e3;e3++){l2=i3[e3],t4[l2+"Key"]&&o4.push(l2);}return o4;}(),s4.push(n4),(p3=this.delegate)!=null?p3.inputControllerDidReceiveKeyboardCommand(s4):void 0)?t4.preventDefault():void 0;},keypress:function keypress(t4){var e3,n4,i2;if(this.inputSummary.eventName==null&&!t4.metaKey&&(!t4.ctrlKey||t4.altKey))return(i2=p2(t4))?((e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),(n4=this.responder)!=null&&n4.insertString(i2),this.setInputSummary({textAdded:i2,didDelete:this.selectionIsExpanded()})):void 0;},textInput:function textInput(t4){var e3,n4,i2,o3;return e3=t4.data,o3=this.inputSummary.textAdded,o3&&o3!==e3&&o3.toUpperCase()===e3?(n4=this.getSelectedRange(),this.setSelectedRange([n4[0],n4[1]+o3.length]),(i2=this.responder)!=null&&i2.insertString(e3),this.setInputSummary({textAdded:e3}),this.setSelectedRange(n4)):void 0;},dragenter:function dragenter(t4){return t4.preventDefault();},dragstart:function dragstart(t4){var e3,n4;return n4=t4.target,this.serializeSelectionToDataTransfer(t4.dataTransfer),this.draggedRange=this.getSelectedRange(),(e3=this.delegate)!=null&&typeof e3.inputControllerDidStartDrag=="function"?e3.inputControllerDidStartDrag():void 0;},dragover:function dragover(t4){var e3,n4;return!this.draggedRange&&!this.canAcceptDataTransfer(t4.dataTransfer)||(t4.preventDefault(),e3={x:t4.clientX,y:t4.clientY},l(e3,this.draggingPoint))?void 0:(this.draggingPoint=e3,(n4=this.delegate)!=null&&typeof n4.inputControllerDidReceiveDragOverPoint=="function"?n4.inputControllerDidReceiveDragOverPoint(this.draggingPoint):void 0);},dragend:function dragend(){var t4;return(t4=this.delegate)!=null&&typeof t4.inputControllerDidCancelDrag=="function"&&t4.inputControllerDidCancelDrag(),this.draggedRange=null,this.draggingPoint=null;},drop:function drop(t4){var n4,i2,o3,r3,s4,a3,u2,c3,l2;return t4.preventDefault(),o3=(s4=t4.dataTransfer)!=null?s4.files:void 0,r3={x:t4.clientX,y:t4.clientY},(a3=this.responder)!=null&&a3.setLocationRangeFromPointRange(r3),(o3!=null?o3.length:void 0)?this.attachFiles(o3):this.draggedRange?((u2=this.delegate)!=null&&u2.inputControllerWillMoveText(),(c3=this.responder)!=null&&c3.moveTextFromRange(this.draggedRange),this.draggedRange=null,this.requestRender()):(i2=t4.dataTransfer.getData("application/x-trix-document"))&&(n4=e2.Document.fromJSONString(i2),(l2=this.responder)!=null&&l2.insertDocument(n4),this.requestRender()),this.draggedRange=null,this.draggingPoint=null;},cut:function cut(t4){var e3,n4;return((e3=this.responder)!=null?e3.selectionIsExpanded():void 0)&&(this.serializeSelectionToDataTransfer(t4.clipboardData)&&t4.preventDefault(),(n4=this.delegate)!=null&&n4.inputControllerWillCutText(),this.deleteInDirection("backward"),t4.defaultPrevented)?this.requestRender():void 0;},copy:function copy(t4){var e3;return((e3=this.responder)!=null?e3.selectionIsExpanded():void 0)&&this.serializeSelectionToDataTransfer(t4.clipboardData)?t4.preventDefault():void 0;},paste:function paste(t4){var n4,o3,s4,a3,u2,c3,l2,p3,f2,g2,v,y,b,A,C3,x,w,E,S2,R,k,D2,L2;return n4=(p3=t4.clipboardData)!=null?p3:t4.testClipboardData,l2={clipboard:n4},n4==null||h(t4)?void this.getPastedHTMLUsingHiddenElement(function(t5){return function(e3){var n5,i2,o4;return l2.type="text/html",l2.html=e3,(n5=t5.delegate)!=null&&n5.inputControllerWillPaste(l2),(i2=t5.responder)!=null&&i2.insertHTML(l2.html),t5.requestRender(),(o4=t5.delegate)!=null?o4.inputControllerDidPaste(l2):void 0;};}(this)):((a3=n4.getData("URL"))?(l2.type="text/html",L2=(c3=n4.getData("public.url-name"))?e2.squishBreakableWhitespace(c3).trim():a3,l2.html=this.createLinkHTML(a3,L2),(f2=this.delegate)!=null&&f2.inputControllerWillPaste(l2),this.setInputSummary({textAdded:L2,didDelete:this.selectionIsExpanded()}),(C3=this.responder)!=null&&C3.insertHTML(l2.html),this.requestRender(),(x=this.delegate)!=null&&x.inputControllerDidPaste(l2)):i(n4)?(l2.type="text/plain",l2.string=n4.getData("text/plain"),(w=this.delegate)!=null&&w.inputControllerWillPaste(l2),this.setInputSummary({textAdded:l2.string,didDelete:this.selectionIsExpanded()}),(E=this.responder)!=null&&E.insertString(l2.string),this.requestRender(),(S2=this.delegate)!=null&&S2.inputControllerDidPaste(l2)):(u2=n4.getData("text/html"))?(l2.type="text/html",l2.html=u2,(R=this.delegate)!=null&&R.inputControllerWillPaste(l2),(k=this.responder)!=null&&k.insertHTML(l2.html),this.requestRender(),(D2=this.delegate)!=null&&D2.inputControllerDidPaste(l2)):m.call(n4.types,"Files")>=0&&(s4=(g2=n4.items)!=null&&(v=g2[0])!=null&&typeof v.getAsFile=="function"?v.getAsFile():void 0)&&(!s4.name&&(o3=r2(s4))&&(s4.name="pasted-file-"+ ++d2+"."+o3),l2.type="File",l2.file=s4,(y=this.delegate)!=null&&y.inputControllerWillAttachFiles(),(b=this.responder)!=null&&b.insertFile(l2.file),this.requestRender(),(A=this.delegate)!=null&&A.inputControllerDidPaste(l2)),t4.preventDefault());},compositionstart:function compositionstart(t4){return this.getCompositionInput().start(t4.data);},compositionupdate:function compositionupdate(t4){return this.getCompositionInput().update(t4.data);},compositionend:function compositionend(t4){return this.getCompositionInput().end(t4.data);},beforeinput:function beforeinput(){return this.inputSummary.didInput=true;},input:function input(t4){return this.inputSummary.didInput=true,t4.stopPropagation();}},s3.prototype.keys={backspace:function backspace(t4){var e3;return(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),this.deleteInDirection("backward",t4);},"delete":function _delete(t4){var e3;return(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),this.deleteInDirection("forward",t4);},"return":function _return(){var t4,e3;return this.setInputSummary({preferDocument:true}),(t4=this.delegate)!=null&&t4.inputControllerWillPerformTyping(),(e3=this.responder)!=null?e3.insertLineBreak():void 0;},tab:function tab(t4){var e3,n4;return((e3=this.responder)!=null?e3.canIncreaseNestingLevel():void 0)?((n4=this.responder)!=null&&n4.increaseNestingLevel(),this.requestRender(),t4.preventDefault()):void 0;},left:function left(t4){var e3;return this.selectionIsInCursorTarget()?(t4.preventDefault(),(e3=this.responder)!=null?e3.moveCursorInDirection("backward"):void 0):void 0;},right:function right(t4){var e3;return this.selectionIsInCursorTarget()?(t4.preventDefault(),(e3=this.responder)!=null?e3.moveCursorInDirection("forward"):void 0):void 0;},control:{d:function d(t4){var e3;return(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),this.deleteInDirection("forward",t4);},h:function h(t4){var e3;return(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),this.deleteInDirection("backward",t4);},o:function o(t4){var e3,n4;return t4.preventDefault(),(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),(n4=this.responder)!=null&&n4.insertString("\n",{updatePosition:false}),this.requestRender();}},shift:{"return":function _return(t4){var e3,n4;return(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),(n4=this.responder)!=null&&n4.insertString("\n"),this.requestRender(),t4.preventDefault();},tab:function tab(t4){var e3,n4;return((e3=this.responder)!=null?e3.canDecreaseNestingLevel():void 0)?((n4=this.responder)!=null&&n4.decreaseNestingLevel(),this.requestRender(),t4.preventDefault()):void 0;},left:function left(t4){return this.selectionIsInCursorTarget()?(t4.preventDefault(),this.expandSelectionInDirection("backward")):void 0;},right:function right(t4){return this.selectionIsInCursorTarget()?(t4.preventDefault(),this.expandSelectionInDirection("forward")):void 0;}},alt:{backspace:function backspace(){var t4;return this.setInputSummary({preferDocument:false}),(t4=this.delegate)!=null?t4.inputControllerWillPerformTyping():void 0;}},meta:{backspace:function backspace(){var t4;return this.setInputSummary({preferDocument:false}),(t4=this.delegate)!=null?t4.inputControllerWillPerformTyping():void 0;}}},s3.prototype.getCompositionInput=function(){return this.isComposing()?this.compositionInput:this.compositionInput=new t3(this);},s3.prototype.isComposing=function(){return this.compositionInput!=null&&!this.compositionInput.isEnded();},s3.prototype.deleteInDirection=function(t4,e3){var n4;return((n4=this.responder)!=null?n4.deleteInDirection(t4):void 0)!==false?this.setInputSummary({didDelete:true}):e3?(e3.preventDefault(),this.requestRender()):void 0;},s3.prototype.serializeSelectionToDataTransfer=function(t4){var n4,i2;if(o2(t4))return n4=(i2=this.responder)!=null?i2.getSelectedDocument().toSerializableDocument():void 0,t4.setData("application/x-trix-document",JSON.stringify(n4)),t4.setData("text/html",e2.DocumentView.render(n4).innerHTML),t4.setData("text/plain",n4.toString().replace(/\n$/,"")),true;},s3.prototype.canAcceptDataTransfer=function(t4){var e3,n4,i2,o3,r3,s4;for(s4={},o3=(i2=t4!=null?t4.types:void 0)!=null?i2:[],e3=0,n4=o3.length;n4>e3;e3++){r3=o3[e3],s4[r3]=true;}return s4.Files||s4["application/x-trix-document"]||s4["text/html"]||s4["text/plain"];},s3.prototype.getPastedHTMLUsingHiddenElement=function(t4){var n4,i2,o3;return i2=this.getSelectedRange(),o3={position:"absolute",left:window.pageXOffset+"px",top:window.pageYOffset+"px",opacity:0},n4=c2({style:o3,tagName:"div",editable:true}),document.body.appendChild(n4),n4.focus(),requestAnimationFrame(function(o4){return function(){var r3;return r3=n4.innerHTML,e2.removeNode(n4),o4.setSelectedRange(i2),t4(r3);};}(this));},s3.proxyMethod("responder?.getSelectedRange"),s3.proxyMethod("responder?.setSelectedRange"),s3.proxyMethod("responder?.expandSelectionInDirection"),s3.proxyMethod("responder?.selectionIsInCursorTarget"),s3.proxyMethod("responder?.selectionIsExpanded"),s3;}(e2.InputController),r2=function r2(t4){var e3,n3;return(e3=t4.type)!=null&&(n3=e3.match(/\/(\w+)$/))!=null?n3[1]:void 0;},s2=(typeof" ".codePointAt=="function"?" ".codePointAt(0):void 0)!=null,p2=function p2(t4){var n3;return t4.key&&s2&&t4.key.codePointAt(0)===t4.keyCode?t4.key:(t4.which===null?n3=t4.keyCode:t4.which!==0&&t4.charCode!==0&&(n3=t4.charCode),n3!=null&&u[n3]!=="escape"?e2.UTF16String.fromCodepoints([n3]).toString():void 0);},h=function h(t4){var e3,n3,i2,o3,r3,s3,a3,u2,c3,l2;if(u2=t4.clipboardData){if(m.call(u2.types,"text/html")>=0){for(c3=u2.types,i2=0,s3=c3.length;s3>i2;i2++){if(l2=c3[i2],e3=/^CorePasteboardFlavorType/.test(l2),n3=/^dyn\./.test(l2)&&u2.getData(l2),a3=e3||n3)return true;}return false;}return o3=m.call(u2.types,"com.apple.webarchive")>=0,r3=m.call(u2.types,"com.apple.flat-rtfd")>=0,o3||r3;}},t3=function(t4){function e3(t5){var e4;this.inputController=t5,e4=this.inputController,this.responder=e4.responder,this.delegate=e4.delegate,this.inputSummary=e4.inputSummary,this.data={};}return f(e3,t4),e3.prototype.start=function(t5){var e4,n3;return this.data.start=t5,this.isSignificant()?(this.inputSummary.eventName==="keypress"&&this.inputSummary.textAdded&&(e4=this.responder)!=null&&e4.deleteInDirection("left"),this.selectionIsExpanded()||(this.insertPlaceholder(),this.requestRender()),this.range=(n3=this.responder)!=null?n3.getSelectedRange():void 0):void 0;},e3.prototype.update=function(t5){var e4;return this.data.update=t5,this.isSignificant()&&(e4=this.selectPlaceholder())?(this.forgetPlaceholder(),this.range=e4):void 0;},e3.prototype.end=function(t5){var e4,n3,i2,o3;return this.data.end=t5,this.isSignificant()?(this.forgetPlaceholder(),this.canApplyToDocument()?(this.setInputSummary({preferDocument:true,didInput:false}),(e4=this.delegate)!=null&&e4.inputControllerWillPerformTyping(),(n3=this.responder)!=null&&n3.setSelectedRange(this.range),(i2=this.responder)!=null&&i2.insertString(this.data.end),(o3=this.responder)!=null?o3.setSelectedRange(this.range[0]+this.data.end.length):void 0):this.data.start!=null||this.data.update!=null?(this.requestReparse(),this.inputController.reset()):void 0):this.inputController.reset();},e3.prototype.getEndData=function(){return this.data.end;},e3.prototype.isEnded=function(){return this.getEndData()!=null;},e3.prototype.isSignificant=function(){return n2.composesExistingText?this.inputSummary.didInput:true;},e3.prototype.canApplyToDocument=function(){var t5,e4;return((t5=this.data.start)!=null?t5.length:void 0)===0&&((e4=this.data.end)!=null?e4.length:void 0)>0&&this.range!=null;},e3.proxyMethod("inputController.setInputSummary"),e3.proxyMethod("inputController.requestRender"),e3.proxyMethod("inputController.requestReparse"),e3.proxyMethod("responder?.selectionIsExpanded"),e3.proxyMethod("responder?.insertPlaceholder"),e3.proxyMethod("responder?.selectPlaceholder"),e3.proxyMethod("responder?.forgetPlaceholder"),e3;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){return function(){return t4.apply(e3,arguments);};},r2=function r2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){s2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},s2={}.hasOwnProperty,a2=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=e2.dataTransferIsPlainText,n2=e2.keyEventIsKeyboardCommand,i=e2.objectsAreEqual,e2.Level2InputController=function(s3){function u(){return this.render=o2(this.render,this),u.__super__.constructor.apply(this,arguments);}var c2,l,h,p2,d,f;return r2(u,s3),u.prototype.elementDidMutate=function(){var t4;return this.scheduledRender?this.composing&&(t4=this.delegate)!=null&&typeof t4.inputControllerDidAllowUnhandledInput=="function"?t4.inputControllerDidAllowUnhandledInput():void 0:this.reparse();},u.prototype.scheduleRender=function(){return this.scheduledRender!=null?this.scheduledRender:this.scheduledRender=requestAnimationFrame(this.render);},u.prototype.render=function(){var t4;return cancelAnimationFrame(this.scheduledRender),this.scheduledRender=null,this.composing||(t4=this.delegate)!=null&&t4.render(),typeof this.afterRender=="function"&&this.afterRender(),this.afterRender=null;},u.prototype.reparse=function(){var t4;return(t4=this.delegate)!=null?t4.reparse():void 0;},u.prototype.events={keydown:function keydown(t4){var e3,i2,o3,r3;if(n2(t4)){if(e3=l(t4),(r3=this.delegate)!=null?r3.inputControllerDidReceiveKeyboardCommand(e3):void 0)return t4.preventDefault();}else if(o3=t4.key,t4.altKey&&(o3+="+Alt"),t4.shiftKey&&(o3+="+Shift"),i2=this.keys[o3])return this.withEvent(t4,i2);},paste:function paste(t4){var e3,n3,i2,o3,r3,s4,a3,u2,c3;return h(t4)?(t4.preventDefault(),this.attachFiles(t4.clipboardData.files)):p2(t4)?(t4.preventDefault(),n3={type:"text/plain",string:t4.clipboardData.getData("text/plain")},(i2=this.delegate)!=null&&i2.inputControllerWillPaste(n3),(o3=this.responder)!=null&&o3.insertString(n3.string),this.render(),(r3=this.delegate)!=null?r3.inputControllerDidPaste(n3):void 0):(e3=(s4=t4.clipboardData)!=null?s4.getData("URL"):void 0)?(t4.preventDefault(),n3={type:"text/html",html:this.createLinkHTML(e3)},(a3=this.delegate)!=null&&a3.inputControllerWillPaste(n3),(u2=this.responder)!=null&&u2.insertHTML(n3.html),this.render(),(c3=this.delegate)!=null?c3.inputControllerDidPaste(n3):void 0):void 0;},beforeinput:function beforeinput(t4){var e3;return(e3=this.inputTypes[t4.inputType])?(this.withEvent(t4,e3),this.scheduleRender()):void 0;},input:function input(){return e2.selectionChangeObserver.reset();},dragstart:function dragstart(t4){var e3,n3;return((e3=this.responder)!=null?e3.selectionContainsAttachments():void 0)?(t4.dataTransfer.setData("application/x-trix-dragging",true),this.dragging={range:(n3=this.responder)!=null?n3.getSelectedRange():void 0,point:d(t4)}):void 0;},dragenter:function dragenter(t4){return c2(t4)?t4.preventDefault():void 0;},dragover:function dragover(t4){var e3,n3;if(this.dragging){if(t4.preventDefault(),e3=d(t4),!i(e3,this.dragging.point))return this.dragging.point=e3,(n3=this.responder)!=null?n3.setLocationRangeFromPointRange(e3):void 0;}else if(c2(t4))return t4.preventDefault();},drop:function drop(t4){var e3,n3,i2,o3;return this.dragging?(t4.preventDefault(),(n3=this.delegate)!=null&&n3.inputControllerWillMoveText(),(i2=this.responder)!=null&&i2.moveTextFromRange(this.dragging.range),this.dragging=null,this.scheduleRender()):c2(t4)?(t4.preventDefault(),e3=d(t4),(o3=this.responder)!=null&&o3.setLocationRangeFromPointRange(e3),this.attachFiles(t4.dataTransfer.files)):void 0;},dragend:function dragend(){var t4;return this.dragging?((t4=this.responder)!=null&&t4.setSelectedRange(this.dragging.range),this.dragging=null):void 0;},compositionend:function compositionend(){return this.composing?(this.composing=false,this.scheduleRender()):void 0;}},u.prototype.keys={ArrowLeft:function ArrowLeft(){var t4,e3;return((t4=this.responder)!=null?t4.shouldManageMovingCursorInDirection("backward"):void 0)?(this.event.preventDefault(),(e3=this.responder)!=null?e3.moveCursorInDirection("backward"):void 0):void 0;},ArrowRight:function ArrowRight(){var t4,e3;return((t4=this.responder)!=null?t4.shouldManageMovingCursorInDirection("forward"):void 0)?(this.event.preventDefault(),(e3=this.responder)!=null?e3.moveCursorInDirection("forward"):void 0):void 0;},Backspace:function Backspace(){var t4,e3,n3;return((t4=this.responder)!=null?t4.shouldManageDeletingInDirection("backward"):void 0)?(this.event.preventDefault(),(e3=this.delegate)!=null&&e3.inputControllerWillPerformTyping(),(n3=this.responder)!=null&&n3.deleteInDirection("backward"),this.render()):void 0;},Tab:function Tab(){var t4,e3;return((t4=this.responder)!=null?t4.canIncreaseNestingLevel():void 0)?(this.event.preventDefault(),(e3=this.responder)!=null&&e3.increaseNestingLevel(),this.render()):void 0;},"Tab+Shift":function TabShift(){var t4,e3;return((t4=this.responder)!=null?t4.canDecreaseNestingLevel():void 0)?(this.event.preventDefault(),(e3=this.responder)!=null&&e3.decreaseNestingLevel(),this.render()):void 0;}},u.prototype.inputTypes={deleteByComposition:function deleteByComposition(){return this.deleteInDirection("backward",{recordUndoEntry:false});},deleteByCut:function deleteByCut(){return this.deleteInDirection("backward");},deleteByDrag:function deleteByDrag(){return this.event.preventDefault(),this.withTargetDOMRange(function(){var t4;return this.deleteByDragRange=(t4=this.responder)!=null?t4.getSelectedRange():void 0;});},deleteCompositionText:function deleteCompositionText(){return this.deleteInDirection("backward",{recordUndoEntry:false});},deleteContent:function deleteContent(){return this.deleteInDirection("backward");},deleteContentBackward:function deleteContentBackward(){return this.deleteInDirection("backward");},deleteContentForward:function deleteContentForward(){return this.deleteInDirection("forward");},deleteEntireSoftLine:function deleteEntireSoftLine(){return this.deleteInDirection("forward");},deleteHardLineBackward:function deleteHardLineBackward(){return this.deleteInDirection("backward");},deleteHardLineForward:function deleteHardLineForward(){return this.deleteInDirection("forward");},deleteSoftLineBackward:function deleteSoftLineBackward(){return this.deleteInDirection("backward");},deleteSoftLineForward:function deleteSoftLineForward(){return this.deleteInDirection("forward");},deleteWordBackward:function deleteWordBackward(){return this.deleteInDirection("backward");},deleteWordForward:function deleteWordForward(){return this.deleteInDirection("forward");},formatBackColor:function formatBackColor(){return this.activateAttributeIfSupported("backgroundColor",this.event.data);},formatBold:function formatBold(){return this.toggleAttributeIfSupported("bold");},formatFontColor:function formatFontColor(){return this.activateAttributeIfSupported("color",this.event.data);},formatFontName:function formatFontName(){return this.activateAttributeIfSupported("font",this.event.data);},formatIndent:function formatIndent(){var t4;return((t4=this.responder)!=null?t4.canIncreaseNestingLevel():void 0)?this.withTargetDOMRange(function(){var t5;return(t5=this.responder)!=null?t5.increaseNestingLevel():void 0;}):void 0;},formatItalic:function formatItalic(){return this.toggleAttributeIfSupported("italic");},formatJustifyCenter:function formatJustifyCenter(){return this.toggleAttributeIfSupported("justifyCenter");},formatJustifyFull:function formatJustifyFull(){return this.toggleAttributeIfSupported("justifyFull");},formatJustifyLeft:function formatJustifyLeft(){return this.toggleAttributeIfSupported("justifyLeft");},formatJustifyRight:function formatJustifyRight(){return this.toggleAttributeIfSupported("justifyRight");},formatOutdent:function formatOutdent(){var t4;return((t4=this.responder)!=null?t4.canDecreaseNestingLevel():void 0)?this.withTargetDOMRange(function(){var t5;return(t5=this.responder)!=null?t5.decreaseNestingLevel():void 0;}):void 0;},formatRemove:function formatRemove(){return this.withTargetDOMRange(function(){var t4,e3,n3,i2;i2=[];for(t4 in(e3=this.responder)!=null?e3.getCurrentAttributes():void 0){i2.push((n3=this.responder)!=null?n3.removeCurrentAttribute(t4):void 0);}return i2;});},formatSetBlockTextDirection:function formatSetBlockTextDirection(){return this.activateAttributeIfSupported("blockDir",this.event.data);},formatSetInlineTextDirection:function formatSetInlineTextDirection(){return this.activateAttributeIfSupported("textDir",this.event.data);},formatStrikeThrough:function formatStrikeThrough(){return this.toggleAttributeIfSupported("strike");},formatSubscript:function formatSubscript(){return this.toggleAttributeIfSupported("sub");},formatSuperscript:function formatSuperscript(){return this.toggleAttributeIfSupported("sup");},formatUnderline:function formatUnderline(){return this.toggleAttributeIfSupported("underline");},historyRedo:function historyRedo(){var t4;return(t4=this.delegate)!=null?t4.inputControllerWillPerformRedo():void 0;},historyUndo:function historyUndo(){var t4;return(t4=this.delegate)!=null?t4.inputControllerWillPerformUndo():void 0;},insertCompositionText:function insertCompositionText(){return this.composing=true,this.insertString(this.event.data);},insertFromComposition:function insertFromComposition(){return this.composing=false,this.insertString(this.event.data);},insertFromDrop:function insertFromDrop(){var t4,e3;return(t4=this.deleteByDragRange)?(this.deleteByDragRange=null,(e3=this.delegate)!=null&&e3.inputControllerWillMoveText(),this.withTargetDOMRange(function(){var e4;return(e4=this.responder)!=null?e4.moveTextFromRange(t4):void 0;})):void 0;},insertFromPaste:function insertFromPaste(){var n3,i2,o3,r3,s4,a3,u2,c3,l2,h2,p3;return n3=this.event.dataTransfer,s4={dataTransfer:n3},(i2=n3.getData("URL"))?(this.event.preventDefault(),s4.type="text/html",p3=(r3=n3.getData("public.url-name"))?e2.squishBreakableWhitespace(r3).trim():i2,s4.html=this.createLinkHTML(i2,p3),(a3=this.delegate)!=null&&a3.inputControllerWillPaste(s4),this.withTargetDOMRange(function(){var t4;return(t4=this.responder)!=null?t4.insertHTML(s4.html):void 0;}),this.afterRender=function(t4){return function(){var e3;return(e3=t4.delegate)!=null?e3.inputControllerDidPaste(s4):void 0;};}(this)):t3(n3)?(s4.type="text/plain",s4.string=n3.getData("text/plain"),(u2=this.delegate)!=null&&u2.inputControllerWillPaste(s4),this.withTargetDOMRange(function(){var t4;return(t4=this.responder)!=null?t4.insertString(s4.string):void 0;}),this.afterRender=function(t4){return function(){var e3;return(e3=t4.delegate)!=null?e3.inputControllerDidPaste(s4):void 0;};}(this)):(o3=n3.getData("text/html"))?(this.event.preventDefault(),s4.type="text/html",s4.html=o3,(c3=this.delegate)!=null&&c3.inputControllerWillPaste(s4),this.withTargetDOMRange(function(){var t4;return(t4=this.responder)!=null?t4.insertHTML(s4.html):void 0;}),this.afterRender=function(t4){return function(){var e3;return(e3=t4.delegate)!=null?e3.inputControllerDidPaste(s4):void 0;};}(this)):((l2=n3.files)!=null?l2.length:void 0)?(s4.type="File",s4.file=n3.files[0],(h2=this.delegate)!=null&&h2.inputControllerWillPaste(s4),this.withTargetDOMRange(function(){var t4;return(t4=this.responder)!=null?t4.insertFile(s4.file):void 0;}),this.afterRender=function(t4){return function(){var e3;return(e3=t4.delegate)!=null?e3.inputControllerDidPaste(s4):void 0;};}(this)):void 0;},insertFromYank:function insertFromYank(){return this.insertString(this.event.data);},insertLineBreak:function insertLineBreak(){return this.insertString("\n");},insertLink:function insertLink(){return this.activateAttributeIfSupported("href",this.event.data);},insertOrderedList:function insertOrderedList(){return this.toggleAttributeIfSupported("number");},insertParagraph:function insertParagraph(){var t4;return(t4=this.delegate)!=null&&t4.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var t5;return(t5=this.responder)!=null?t5.insertLineBreak():void 0;});},insertReplacementText:function insertReplacementText(){return this.insertString(this.event.dataTransfer.getData("text/plain"),{updatePosition:false});},insertText:function insertText(){var t4,e3;return this.insertString((t4=this.event.data)!=null?t4:(e3=this.event.dataTransfer)!=null?e3.getData("text/plain"):void 0);},insertTranspose:function insertTranspose(){return this.insertString(this.event.data);},insertUnorderedList:function insertUnorderedList(){return this.toggleAttributeIfSupported("bullet");}},u.prototype.insertString=function(t4,e3){var n3;return t4==null&&(t4=""),(n3=this.delegate)!=null&&n3.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var n4;return(n4=this.responder)!=null?n4.insertString(t4,e3):void 0;});},u.prototype.toggleAttributeIfSupported=function(t4){var n3;return a2.call(e2.getAllAttributeNames(),t4)>=0?((n3=this.delegate)!=null&&n3.inputControllerWillPerformFormatting(t4),this.withTargetDOMRange(function(){var e3;return(e3=this.responder)!=null?e3.toggleCurrentAttribute(t4):void 0;})):void 0;},u.prototype.activateAttributeIfSupported=function(t4,n3){var i2;return a2.call(e2.getAllAttributeNames(),t4)>=0?((i2=this.delegate)!=null&&i2.inputControllerWillPerformFormatting(t4),this.withTargetDOMRange(function(){var e3;return(e3=this.responder)!=null?e3.setCurrentAttribute(t4,n3):void 0;})):void 0;},u.prototype.deleteInDirection=function(t4,e3){var n3,i2,o3,r3;return o3=(e3!=null?e3:{recordUndoEntry:true}).recordUndoEntry,o3&&(r3=this.delegate)!=null&&r3.inputControllerWillPerformTyping(),i2=function(e4){return function(){var n4;return(n4=e4.responder)!=null?n4.deleteInDirection(t4):void 0;};}(this),(n3=this.getTargetDOMRange({minLength:2}))?this.withTargetDOMRange(n3,i2):i2();},u.prototype.withTargetDOMRange=function(t4,n3){var i2;return typeof t4=="function"&&(n3=t4,t4=this.getTargetDOMRange()),t4?(i2=this.responder)!=null?i2.withTargetDOMRange(t4,n3.bind(this)):void 0:(e2.selectionChangeObserver.reset(),n3.call(this));},u.prototype.getTargetDOMRange=function(t4){var e3,n3,i2,o3;return i2=(t4!=null?t4:{minLength:0}).minLength,(o3=typeof(e3=this.event).getTargetRanges=="function"?e3.getTargetRanges():void 0)&&o3.length&&(n3=f(o3[0]),i2===0||n3.toString().length>=i2)?n3:void 0;},f=function f(t4){var e3;return e3=document.createRange(),e3.setStart(t4.startContainer,t4.startOffset),e3.setEnd(t4.endContainer,t4.endOffset),e3;},u.prototype.withEvent=function(t4,e3){var n3;this.event=t4;try{n3=e3.call(this);}finally{this.event=null;}return n3;},c2=function c2(t4){var e3,n3;return a2.call((e3=(n3=t4.dataTransfer)!=null?n3.types:void 0)!=null?e3:[],"Files")>=0;},h=function h(t4){var e3;return(e3=t4.clipboardData)?a2.call(e3.types,"Files")>=0&&e3.types.length===1&&e3.files.length>=1:void 0;},p2=function p2(t4){var e3;return(e3=t4.clipboardData)?a2.call(e3.types,"text/plain")>=0&&e3.types.length===1:void 0;},l=function l(t4){var e3;return e3=[],t4.altKey&&e3.push("alt"),t4.shiftKey&&e3.push("shift"),e3.push(t4.key),e3;},d=function d(t4){return{x:t4.clientX,y:t4.clientY};},u;}(e2.InputController);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2=function c2(t4,e3){return function(){return t4.apply(e3,arguments);};},l=function l(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){h.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},h={}.hasOwnProperty;n2=e2.defer,i=e2.handleEvent,s2=e2.makeElement,u=e2.tagName,a2=e2.config,r2=a2.lang,t3=a2.css,o2=a2.keyNames,e2.AttachmentEditorController=function(a3){function h2(t4,e3,n3,i2){this.attachmentPiece=t4,this.element=e3,this.container=n3,this.options=i2!=null?i2:{},this.didBlurCaption=c2(this.didBlurCaption,this),this.didChangeCaption=c2(this.didChangeCaption,this),this.didInputCaption=c2(this.didInputCaption,this),this.didKeyDownCaption=c2(this.didKeyDownCaption,this),this.didClickActionButton=c2(this.didClickActionButton,this),this.didClickToolbar=c2(this.didClickToolbar,this),this.attachment=this.attachmentPiece.attachment,u(this.element)==="a"&&(this.element=this.element.firstChild),this.install();}var p2;return l(h2,a3),p2=function p2(t4){return function(){var e3;return e3=t4.apply(this,arguments),e3["do"](),this.undos==null&&(this.undos=[]),this.undos.push(e3.undo);};},h2.prototype.install=function(){return this.makeElementMutable(),this.addToolbar(),this.attachment.isPreviewable()?this.installCaptionEditor():void 0;},h2.prototype.uninstall=function(){var t4,e3;for(this.savePendingCaption();e3=this.undos.pop();){e3();}return(t4=this.delegate)!=null?t4.didUninstallAttachmentEditor(this):void 0;},h2.prototype.savePendingCaption=function(){var t4,e3,n3;return this.pendingCaption!=null?(t4=this.pendingCaption,this.pendingCaption=null,t4?(e3=this.delegate)!=null&&typeof e3.attachmentEditorDidRequestUpdatingAttributesForAttachment=="function"?e3.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption:t4},this.attachment):void 0:(n3=this.delegate)!=null&&typeof n3.attachmentEditorDidRequestRemovingAttributeForAttachment=="function"?n3.attachmentEditorDidRequestRemovingAttributeForAttachment("caption",this.attachment):void 0):void 0;},h2.prototype.makeElementMutable=p2(function(){return{"do":function(t4){return function(){return t4.element.dataset.trixMutable=true;};}(this),undo:function(t4){return function(){return delete t4.element.dataset.trixMutable;};}(this)};}),h2.prototype.addToolbar=p2(function(){var n3;return n3=s2({tagName:"div",className:t3.attachmentToolbar,data:{trixMutable:true},childNodes:s2({tagName:"div",className:"trix-button-row",childNodes:s2({tagName:"span",className:"trix-button-group trix-button-group--actions",childNodes:s2({tagName:"button",className:"trix-button trix-button--remove",textContent:r2.remove,attributes:{title:r2.remove},data:{trixAction:"remove"}})})})}),this.attachment.isPreviewable()&&n3.appendChild(s2({tagName:"div",className:t3.attachmentMetadataContainer,childNodes:s2({tagName:"span",className:t3.attachmentMetadata,childNodes:[s2({tagName:"span",className:t3.attachmentName,textContent:this.attachment.getFilename(),attributes:{title:this.attachment.getFilename()}}),s2({tagName:"span",className:t3.attachmentSize,textContent:this.attachment.getFormattedFilesize()})]})})),i("click",{onElement:n3,withCallback:this.didClickToolbar}),i("click",{onElement:n3,matchingSelector:"[data-trix-action]",withCallback:this.didClickActionButton}),{"do":function(t4){return function(){return t4.element.appendChild(n3);};}(this),undo:function(){return function(){return e2.removeNode(n3);};}(this)};}),h2.prototype.installCaptionEditor=p2(function(){var o3,a4,u2,c3,l2;return c3=s2({tagName:"textarea",className:t3.attachmentCaptionEditor,attributes:{placeholder:r2.captionPlaceholder},data:{trixMutable:true}}),c3.value=this.attachmentPiece.getCaption(),l2=c3.cloneNode(),l2.classList.add("trix-autoresize-clone"),l2.tabIndex=-1,o3=function o3(){return l2.value=c3.value,c3.style.height=l2.scrollHeight+"px";},i("input",{onElement:c3,withCallback:o3}),i("input",{onElement:c3,withCallback:this.didInputCaption}),i("keydown",{onElement:c3,withCallback:this.didKeyDownCaption}),i("change",{onElement:c3,withCallback:this.didChangeCaption}),i("blur",{onElement:c3,withCallback:this.didBlurCaption}),u2=this.element.querySelector("figcaption"),a4=u2.cloneNode(),{"do":function(e3){return function(){return u2.style.display="none",a4.appendChild(c3),a4.appendChild(l2),a4.classList.add(t3.attachmentCaption+"--editing"),u2.parentElement.insertBefore(a4,u2),o3(),e3.options.editCaption?n2(function(){return c3.focus();}):void 0;};}(this),undo:function undo(){return e2.removeNode(a4),u2.style.display=null;}};}),h2.prototype.didClickToolbar=function(t4){return t4.preventDefault(),t4.stopPropagation();},h2.prototype.didClickActionButton=function(t4){var e3,n3;switch(e3=t4.target.getAttribute("data-trix-action")){case"remove":return(n3=this.delegate)!=null?n3.attachmentEditorDidRequestRemovalOfAttachment(this.attachment):void 0;}},h2.prototype.didKeyDownCaption=function(t4){var e3;return o2[t4.keyCode]==="return"?(t4.preventDefault(),this.savePendingCaption(),(e3=this.delegate)!=null&&typeof e3.attachmentEditorDidRequestDeselectingAttachment=="function"?e3.attachmentEditorDidRequestDeselectingAttachment(this.attachment):void 0):void 0;},h2.prototype.didInputCaption=function(t4){return this.pendingCaption=t4.target.value.replace(/\s/g," ").trim();},h2.prototype.didChangeCaption=function(){return this.savePendingCaption();},h2.prototype.didBlurCaption=function(){return this.savePendingCaption();},h2;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){r2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},r2={}.hasOwnProperty;i=e2.makeElement,t3=e2.config.css,e2.AttachmentView=function(r3){function s2(){s2.__super__.constructor.apply(this,arguments),this.attachment=this.object,this.attachment.uploadProgressDelegate=this,this.attachmentPiece=this.options.piece;}var a2;return o2(s2,r3),s2.attachmentSelector="[data-trix-attachment]",s2.prototype.createContentNodes=function(){return[];},s2.prototype.createNodes=function(){var e3,n3,o3,r4,s3,u,c2;if(e3=r4=i({tagName:"figure",className:this.getClassName(),data:this.getData(),editable:false}),(n3=this.getHref())&&(r4=i({tagName:"a",editable:false,attributes:{href:n3,tabindex:-1}}),e3.appendChild(r4)),this.attachment.hasContent())r4.innerHTML=this.attachment.getContent();else for(c2=this.createContentNodes(),o3=0,s3=c2.length;s3>o3;o3++){u=c2[o3],r4.appendChild(u);}return r4.appendChild(this.createCaptionElement()),this.attachment.isPending()&&(this.progressElement=i({tagName:"progress",attributes:{"class":t3.attachmentProgress,value:this.attachment.getUploadProgress(),max:100},data:{trixMutable:true,trixStoreKey:["progressElement",this.attachment.id].join("/")}}),e3.appendChild(this.progressElement)),[a2("left"),e3,a2("right")];},s2.prototype.createCaptionElement=function(){var e3,n3,o3,r4,s3,a3,u;return o3=i({tagName:"figcaption",className:t3.attachmentCaption}),(e3=this.attachmentPiece.getCaption())?(o3.classList.add(t3.attachmentCaption+"--edited"),o3.textContent=e3):(n3=this.getCaptionConfig(),n3.name&&(r4=this.attachment.getFilename()),n3.size&&(a3=this.attachment.getFormattedFilesize()),r4&&(s3=i({tagName:"span",className:t3.attachmentName,textContent:r4}),o3.appendChild(s3)),a3&&(r4&&o3.appendChild(document.createTextNode(" ")),u=i({tagName:"span",className:t3.attachmentSize,textContent:a3}),o3.appendChild(u))),o3;},s2.prototype.getClassName=function(){var e3,n3;return n3=[t3.attachment,t3.attachment+"--"+this.attachment.getType()],(e3=this.attachment.getExtension())&&n3.push(t3.attachment+"--"+e3),n3.join(" ");},s2.prototype.getData=function(){var t4,e3;return e3={trixAttachment:JSON.stringify(this.attachment),trixContentType:this.attachment.getContentType(),trixId:this.attachment.id},t4=this.attachmentPiece.attributes,t4.isEmpty()||(e3.trixAttributes=JSON.stringify(t4)),this.attachment.isPending()&&(e3.trixSerialize=false),e3;},s2.prototype.getHref=function(){return n2(this.attachment.getContent(),"a")?void 0:this.attachment.getHref();},s2.prototype.getCaptionConfig=function(){var t4,n3,i2;return i2=this.attachment.getType(),t4=e2.copyObject((n3=e2.config.attachments[i2])!=null?n3.caption:void 0),i2==="file"&&(t4.name=true),t4;},s2.prototype.findProgressElement=function(){var t4;return(t4=this.findElement())!=null?t4.querySelector("progress"):void 0;},a2=function a2(t4){return i({tagName:"span",textContent:e2.ZERO_WIDTH_SPACE,data:{trixCursorTarget:t4,trixSerialize:false}});},s2.prototype.attachmentDidChangeUploadProgress=function(){var t4,e3;return e3=this.attachment.getUploadProgress(),(t4=this.findProgressElement())!=null?t4.value=e3:void 0;},s2;}(e2.ObjectView),n2=function n2(t4,e3){var n3;return n3=i("div"),n3.innerHTML=t4!=null?t4:"",n3.querySelector(e3);};}.call(this),function(){var t3,n2=function n2(t4,e3){function n3(){this.constructor=t4;}for(var o2 in e3){i.call(e3,o2)&&(t4[o2]=e3[o2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},i={}.hasOwnProperty;t3=e2.makeElement,e2.PreviewableAttachmentView=function(i2){function o2(){o2.__super__.constructor.apply(this,arguments),this.attachment.previewDelegate=this;}return n2(o2,i2),o2.prototype.createContentNodes=function(){return this.image=t3({tagName:"img",attributes:{src:""},data:{trixMutable:true}}),this.refresh(this.image),[this.image];},o2.prototype.createCaptionElement=function(){var t4;return t4=o2.__super__.createCaptionElement.apply(this,arguments),t4.textContent||t4.setAttribute("data-trix-placeholder",e2.config.lang.captionPlaceholder),t4;},o2.prototype.refresh=function(t4){var e3;return t4==null&&(t4=(e3=this.findElement())!=null?e3.querySelector("img"):void 0),t4?this.updateAttributesForImage(t4):void 0;},o2.prototype.updateAttributesForImage=function(t4){var e3,n3,i3,o3,r2,s2;return r2=this.attachment.getURL(),n3=this.attachment.getPreviewURL(),t4.src=n3||r2,n3===r2?t4.removeAttribute("data-trix-serialized-attributes"):(i3=JSON.stringify({src:r2}),t4.setAttribute("data-trix-serialized-attributes",i3)),s2=this.attachment.getWidth(),e3=this.attachment.getHeight(),s2!=null&&(t4.width=s2),e3!=null&&(t4.height=e3),o3=["imageElement",this.attachment.id,t4.src,t4.width,t4.height].join("/"),t4.dataset.trixStoreKey=o3;},o2.prototype.attachmentDidChangeAttributes=function(){return this.refresh(this.image),this.refresh();},o2;}(e2.AttachmentView);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){r2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},r2={}.hasOwnProperty;i=e2.makeElement,t3=e2.findInnerElement,n2=e2.getTextConfig,e2.PieceView=function(r3){function s2(){var t4;s2.__super__.constructor.apply(this,arguments),this.piece=this.object,this.attributes=this.piece.getAttributes(),t4=this.options,this.textConfig=t4.textConfig,this.context=t4.context,this.piece.attachment?this.attachment=this.piece.attachment:this.string=this.piece.toString();}var a2;return o2(s2,r3),s2.prototype.createNodes=function(){var e3,n3,i2,o3,r4,s3;if(s3=this.attachment?this.createAttachmentNodes():this.createStringNodes(),e3=this.createElement()){for(i2=t3(e3),n3=0,o3=s3.length;o3>n3;n3++){r4=s3[n3],i2.appendChild(r4);}s3=[e3];}return s3;},s2.prototype.createAttachmentNodes=function(){var t4,n3;return t4=this.attachment.isPreviewable()?e2.PreviewableAttachmentView:e2.AttachmentView,n3=this.createChildView(t4,this.piece.attachment,{piece:this.piece}),n3.getNodes();},s2.prototype.createStringNodes=function(){var t4,e3,n3,o3,r4,s3,a3,u,c2,l;if((u=this.textConfig)!=null?u.plaintext:void 0)return[document.createTextNode(this.string)];for(a3=[],c2=this.string.split("\n"),n3=e3=0,o3=c2.length;o3>e3;n3=++e3){l=c2[n3],n3>0&&(t4=i("br"),a3.push(t4)),(r4=l.length)&&(s3=document.createTextNode(this.preserveSpaces(l)),a3.push(s3));}return a3;},s2.prototype.createElement=function(){var t4,e3,o3,r4,s3,a3,u,c2,l;c2={},a3=this.attributes;for(r4 in a3){if(l=a3[r4],(t4=n2(r4))&&(t4.tagName&&(s3=i(t4.tagName),o3?(o3.appendChild(s3),o3=s3):e3=o3=s3),t4.styleProperty&&(c2[t4.styleProperty]=l),t4.style)){u=t4.style;for(r4 in u){l=u[r4],c2[r4]=l;}}}if(Object.keys(c2).length){e3==null&&(e3=i("span"));for(r4 in c2){l=c2[r4],e3.style[r4]=l;}}return e3;},s2.prototype.createContainerElement=function(){var t4,e3,o3,r4,s3;r4=this.attributes;for(o3 in r4){if(s3=r4[o3],(e3=n2(o3))&&e3.groupTagName)return t4={},t4[o3]=s3,i(e3.groupTagName,t4);}},a2=e2.NON_BREAKING_SPACE,s2.prototype.preserveSpaces=function(t4){return this.context.isLast&&(t4=t4.replace(/\ $/,a2)),t4=t4.replace(/(\S)\ {3}(\S)/g,"$1 "+a2+" $2").replace(/\ {2}/g,a2+" ").replace(/\ {2}/g," "+a2),(this.context.isFirst||this.context.followsWhitespace)&&(t4=t4.replace(/^\ /,a2)),t4;},s2;}(e2.ObjectView);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.TextView=function(n3){function i(){i.__super__.constructor.apply(this,arguments),this.text=this.object,this.textConfig=this.options.textConfig;}var o2;return t3(i,n3),i.prototype.createNodes=function(){var t4,n4,i2,r2,s2,a2,u,c2,l,h;for(a2=[],c2=e2.ObjectGroup.groupObjects(this.getPieces()),r2=c2.length-1,i2=n4=0,s2=c2.length;s2>n4;i2=++n4){u=c2[i2],t4={},i2===0&&(t4.isFirst=true),i2===r2&&(t4.isLast=true),o2(l)&&(t4.followsWhitespace=true),h=this.findOrCreateCachedChildView(e2.PieceView,u,{textConfig:this.textConfig,context:t4}),a2.push.apply(a2,h.getNodes()),l=u;}return a2;},i.prototype.getPieces=function(){var t4,e3,n4,i2,o3;for(i2=this.text.getPieces(),o3=[],t4=0,e3=i2.length;e3>t4;t4++){n4=i2[t4],n4.hasAttribute("blockBreak")||o3.push(n4);}return o3;},o2=function o2(t4){return /\s$/.test(t4!=null?t4.toString():void 0);},i;}(e2.ObjectView);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){r2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},r2={}.hasOwnProperty;i=e2.makeElement,n2=e2.getBlockConfig,t3=e2.config.css,e2.BlockView=function(r3){function s2(){s2.__super__.constructor.apply(this,arguments),this.block=this.object,this.attributes=this.block.getAttributes();}return o2(s2,r3),s2.prototype.createNodes=function(){var t4,o3,r4,s3,a2,u,c2,l,h,p2,d;if(o3=document.createComment("block"),c2=[o3],this.block.isEmpty()?c2.push(i("br")):(p2=(l=n2(this.block.getLastAttribute()))!=null?l.text:void 0,d=this.findOrCreateCachedChildView(e2.TextView,this.block.text,{textConfig:p2}),c2.push.apply(c2,d.getNodes()),this.shouldAddExtraNewlineElement()&&c2.push(i("br"))),this.attributes.length)return c2;for(h=e2.config.blockAttributes["default"].tagName,this.block.isRTL()&&(t4={dir:"rtl"}),r4=i({tagName:h,attributes:t4}),s3=0,a2=c2.length;a2>s3;s3++){u=c2[s3],r4.appendChild(u);}return[r4];},s2.prototype.createContainerElement=function(e3){var o3,r4,s3,a2,u;return o3=this.attributes[e3],u=n2(o3).tagName,e3===0&&this.block.isRTL()&&(r4={dir:"rtl"}),o3==="attachmentGallery"&&(a2=this.block.getBlockBreakPosition(),s3=t3.attachmentGallery+" "+t3.attachmentGallery+"--"+a2),i({tagName:u,className:s3,attributes:r4});},s2.prototype.shouldAddExtraNewlineElement=function(){return /\n\n$/.test(this.block.toString());},s2;}(e2.ObjectView);}.call(this),function(){var t3,n2,i=function i(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){o2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},o2={}.hasOwnProperty;t3=e2.defer,n2=e2.makeElement,e2.DocumentView=function(o3){function r2(){r2.__super__.constructor.apply(this,arguments),this.element=this.options.element,this.elementStore=new e2.ElementStore(),this.setDocument(this.object);}var s2,a2,u;return i(r2,o3),r2.render=function(t4){var e3,i2;return e3=n2("div"),i2=new this(t4,{element:e3}),i2.render(),i2.sync(),e3;},r2.prototype.setDocument=function(t4){return t4.isEqualTo(this.document)?void 0:this.document=this.object=t4;},r2.prototype.render=function(){var t4,i2,o4,r3,s3,a3,u2;if(this.childViews=[],this.shadowElement=n2("div"),!this.document.isEmpty()){for(s3=e2.ObjectGroup.groupObjects(this.document.getBlocks(),{asTree:true}),a3=[],t4=0,i2=s3.length;i2>t4;t4++){r3=s3[t4],u2=this.findOrCreateCachedChildView(e2.BlockView,r3),a3.push(function(){var t5,e3,n3,i3;for(n3=u2.getNodes(),i3=[],t5=0,e3=n3.length;e3>t5;t5++){o4=n3[t5],i3.push(this.shadowElement.appendChild(o4));}return i3;}.call(this));}return a3;}},r2.prototype.isSynced=function(){return s2(this.shadowElement,this.element);},r2.prototype.sync=function(){var t4;for(t4=this.createDocumentFragmentForSync();this.element.lastChild;){this.element.removeChild(this.element.lastChild);}return this.element.appendChild(t4),this.didSync();},r2.prototype.didSync=function(){return this.elementStore.reset(a2(this.element)),t3(function(t4){return function(){return t4.garbageCollectCachedViews();};}(this));},r2.prototype.createDocumentFragmentForSync=function(){var t4,e3,n3,i2,o4,r3,s3,u2,c2,l;for(e3=document.createDocumentFragment(),u2=this.shadowElement.childNodes,n3=0,o4=u2.length;o4>n3;n3++){s3=u2[n3],e3.appendChild(s3.cloneNode(true));}for(c2=a2(e3),i2=0,r3=c2.length;r3>i2;i2++){t4=c2[i2],(l=this.elementStore.remove(t4))&&t4.parentNode.replaceChild(l,t4);}return e3;},a2=function a2(t4){return t4.querySelectorAll("[data-trix-store-key]");},s2=function s2(t4,e3){return u(t4.innerHTML)===u(e3.innerHTML);},u=function u(t4){return t4.replace(/&nbsp;/g," ");},r2;}(e2.ObjectView);}.call(this),function(){var t3,n2,i,o2,r2,s2=function s2(t4,e3){return function(){return t4.apply(e3,arguments);};},a2=function a2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){u.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},u={}.hasOwnProperty;i=e2.findClosestElementFromNode,o2=e2.handleEvent,r2=e2.innerElementIsActive,n2=e2.defer,t3=e2.AttachmentView.attachmentSelector,e2.CompositionController=function(u2){function c2(n3,i2){this.element=n3,this.composition=i2,this.didClickAttachment=s2(this.didClickAttachment,this),this.didBlur=s2(this.didBlur,this),this.didFocus=s2(this.didFocus,this),this.documentView=new e2.DocumentView(this.composition.document,{element:this.element}),o2("focus",{onElement:this.element,withCallback:this.didFocus}),o2("blur",{onElement:this.element,withCallback:this.didBlur}),o2("click",{onElement:this.element,matchingSelector:"a[contenteditable=false]",preventDefault:true}),o2("mousedown",{onElement:this.element,matchingSelector:t3,withCallback:this.didClickAttachment}),o2("click",{onElement:this.element,matchingSelector:"a"+t3,preventDefault:true});}return a2(c2,u2),c2.prototype.didFocus=function(){var t4,e3,n3;return t4=function(t5){return function(){var e4;return t5.focused?void 0:(t5.focused=true,(e4=t5.delegate)!=null&&typeof e4.compositionControllerDidFocus=="function"?e4.compositionControllerDidFocus():void 0);};}(this),(e3=(n3=this.blurPromise)!=null?n3.then(t4):void 0)!=null?e3:t4();},c2.prototype.didBlur=function(){return this.blurPromise=new Promise(function(t4){return function(e3){return n2(function(){var n3;return r2(t4.element)||(t4.focused=null,(n3=t4.delegate)!=null&&typeof n3.compositionControllerDidBlur=="function"&&n3.compositionControllerDidBlur()),t4.blurPromise=null,e3();});};}(this));},c2.prototype.didClickAttachment=function(t4,e3){var n3,o3,r3;return n3=this.findAttachmentForElement(e3),o3=i(t4.target,{matchingSelector:"figcaption"})!=null,(r3=this.delegate)!=null&&typeof r3.compositionControllerDidSelectAttachment=="function"?r3.compositionControllerDidSelectAttachment(n3,{editCaption:o3}):void 0;},c2.prototype.getSerializableElement=function(){return this.isEditingAttachment()?this.documentView.shadowElement:this.element;},c2.prototype.render=function(){var t4,e3,n3;return this.revision!==this.composition.revision&&(this.documentView.setDocument(this.composition.document),this.documentView.render(),this.revision=this.composition.revision),this.canSyncDocumentView()&&!this.documentView.isSynced()&&((t4=this.delegate)!=null&&typeof t4.compositionControllerWillSyncDocumentView=="function"&&t4.compositionControllerWillSyncDocumentView(),this.documentView.sync(),(e3=this.delegate)!=null&&typeof e3.compositionControllerDidSyncDocumentView=="function"&&e3.compositionControllerDidSyncDocumentView()),(n3=this.delegate)!=null&&typeof n3.compositionControllerDidRender=="function"?n3.compositionControllerDidRender():void 0;},c2.prototype.rerenderViewForObject=function(t4){return this.invalidateViewForObject(t4),this.render();},c2.prototype.invalidateViewForObject=function(t4){return this.documentView.invalidateViewForObject(t4);},c2.prototype.isViewCachingEnabled=function(){return this.documentView.isViewCachingEnabled();},c2.prototype.enableViewCaching=function(){return this.documentView.enableViewCaching();},c2.prototype.disableViewCaching=function(){return this.documentView.disableViewCaching();},c2.prototype.refreshViewCache=function(){return this.documentView.garbageCollectCachedViews();},c2.prototype.isEditingAttachment=function(){return this.attachmentEditor!=null;},c2.prototype.installAttachmentEditorForAttachment=function(t4,n3){var i2,o3,r3;if(((r3=this.attachmentEditor)!=null?r3.attachment:void 0)!==t4&&(o3=this.documentView.findElementForObject(t4)))return this.uninstallAttachmentEditor(),i2=this.composition.document.getAttachmentPieceForAttachment(t4),this.attachmentEditor=new e2.AttachmentEditorController(i2,o3,this.element,n3),this.attachmentEditor.delegate=this;},c2.prototype.uninstallAttachmentEditor=function(){var t4;return(t4=this.attachmentEditor)!=null?t4.uninstall():void 0;},c2.prototype.didUninstallAttachmentEditor=function(){return this.attachmentEditor=null,this.render();},c2.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment=function(t4,e3){var n3;return(n3=this.delegate)!=null&&typeof n3.compositionControllerWillUpdateAttachment=="function"&&n3.compositionControllerWillUpdateAttachment(e3),this.composition.updateAttributesForAttachment(t4,e3);},c2.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment=function(t4,e3){var n3;return(n3=this.delegate)!=null&&typeof n3.compositionControllerWillUpdateAttachment=="function"&&n3.compositionControllerWillUpdateAttachment(e3),this.composition.removeAttributeForAttachment(t4,e3);},c2.prototype.attachmentEditorDidRequestRemovalOfAttachment=function(t4){var e3;return(e3=this.delegate)!=null&&typeof e3.compositionControllerDidRequestRemovalOfAttachment=="function"?e3.compositionControllerDidRequestRemovalOfAttachment(t4):void 0;},c2.prototype.attachmentEditorDidRequestDeselectingAttachment=function(t4){var e3;return(e3=this.delegate)!=null&&typeof e3.compositionControllerDidRequestDeselectingAttachment=="function"?e3.compositionControllerDidRequestDeselectingAttachment(t4):void 0;},c2.prototype.canSyncDocumentView=function(){return!this.isEditingAttachment();},c2.prototype.findAttachmentForElement=function(t4){return this.composition.document.getAttachmentById(parseInt(t4.dataset.trixId,10));},c2;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){return function(){return t4.apply(e3,arguments);};},r2=function r2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){s2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},s2={}.hasOwnProperty;n2=e2.handleEvent,i=e2.triggerEvent,t3=e2.findClosestElementFromNode,e2.ToolbarController=function(e3){function s3(t4){this.element=t4,this.didKeyDownDialogInput=o2(this.didKeyDownDialogInput,this),this.didClickDialogButton=o2(this.didClickDialogButton,this),this.didClickAttributeButton=o2(this.didClickAttributeButton,this),this.didClickActionButton=o2(this.didClickActionButton,this),this.attributes={},this.actions={},this.resetDialogInputs(),n2("mousedown",{onElement:this.element,matchingSelector:a2,withCallback:this.didClickActionButton}),n2("mousedown",{onElement:this.element,matchingSelector:c2,withCallback:this.didClickAttributeButton}),n2("click",{onElement:this.element,matchingSelector:v,preventDefault:true}),n2("click",{onElement:this.element,matchingSelector:l,withCallback:this.didClickDialogButton}),n2("keydown",{onElement:this.element,matchingSelector:h,withCallback:this.didKeyDownDialogInput});}var a2,u,c2,l,h,p2,d,f,g,m,v;return r2(s3,e3),c2="[data-trix-attribute]",a2="[data-trix-action]",v=c2+", "+a2,p2="[data-trix-dialog]",u=p2+"[data-trix-active]",l=p2+" [data-trix-method]",h=p2+" [data-trix-input]",s3.prototype.didClickActionButton=function(t4,e4){var n3,i2,o3;return(i2=this.delegate)!=null&&i2.toolbarDidClickButton(),t4.preventDefault(),n3=d(e4),this.getDialog(n3)?this.toggleDialog(n3):(o3=this.delegate)!=null?o3.toolbarDidInvokeAction(n3):void 0;},s3.prototype.didClickAttributeButton=function(t4,e4){var n3,i2,o3;return(i2=this.delegate)!=null&&i2.toolbarDidClickButton(),t4.preventDefault(),n3=f(e4),this.getDialog(n3)?this.toggleDialog(n3):(o3=this.delegate)!=null&&o3.toolbarDidToggleAttribute(n3),this.refreshAttributeButtons();},s3.prototype.didClickDialogButton=function(e4,n3){var i2,o3;return i2=t3(n3,{matchingSelector:p2}),o3=n3.getAttribute("data-trix-method"),this[o3].call(this,i2);},s3.prototype.didKeyDownDialogInput=function(t4,e4){var n3,i2;return t4.keyCode===13&&(t4.preventDefault(),n3=e4.getAttribute("name"),i2=this.getDialog(n3),this.setAttribute(i2)),t4.keyCode===27?(t4.preventDefault(),this.hideDialog()):void 0;},s3.prototype.updateActions=function(t4){return this.actions=t4,this.refreshActionButtons();},s3.prototype.refreshActionButtons=function(){return this.eachActionButton(function(t4){return function(e4,n3){return e4.disabled=t4.actions[n3]===false;};}(this));},s3.prototype.eachActionButton=function(t4){var e4,n3,i2,o3,r3;for(o3=this.element.querySelectorAll(a2),r3=[],n3=0,i2=o3.length;i2>n3;n3++){e4=o3[n3],r3.push(t4(e4,d(e4)));}return r3;},s3.prototype.updateAttributes=function(t4){return this.attributes=t4,this.refreshAttributeButtons();},s3.prototype.refreshAttributeButtons=function(){return this.eachAttributeButton(function(t4){return function(e4,n3){return e4.disabled=t4.attributes[n3]===false,t4.attributes[n3]||t4.dialogIsVisible(n3)?(e4.setAttribute("data-trix-active",""),e4.classList.add("trix-active")):(e4.removeAttribute("data-trix-active"),e4.classList.remove("trix-active"));};}(this));},s3.prototype.eachAttributeButton=function(t4){var e4,n3,i2,o3,r3;for(o3=this.element.querySelectorAll(c2),r3=[],n3=0,i2=o3.length;i2>n3;n3++){e4=o3[n3],r3.push(t4(e4,f(e4)));}return r3;},s3.prototype.applyKeyboardCommand=function(t4){var e4,n3,o3,r3,s4,a3,u2;for(s4=JSON.stringify(t4.sort()),u2=this.element.querySelectorAll("[data-trix-key]"),r3=0,a3=u2.length;a3>r3;r3++){if(e4=u2[r3],o3=e4.getAttribute("data-trix-key").split("+"),n3=JSON.stringify(o3.sort()),n3===s4)return i("mousedown",{onElement:e4}),true;}return false;},s3.prototype.dialogIsVisible=function(t4){var e4;return(e4=this.getDialog(t4))?e4.hasAttribute("data-trix-active"):void 0;},s3.prototype.toggleDialog=function(t4){return this.dialogIsVisible(t4)?this.hideDialog():this.showDialog(t4);},s3.prototype.showDialog=function(t4){var e4,n3,i2,o3,r3,s4,a3,u2,c3,l2;for(this.hideDialog(),(a3=this.delegate)!=null&&a3.toolbarWillShowDialog(),i2=this.getDialog(t4),i2.setAttribute("data-trix-active",""),i2.classList.add("trix-active"),u2=i2.querySelectorAll("input[disabled]"),o3=0,s4=u2.length;s4>o3;o3++){n3=u2[o3],n3.removeAttribute("disabled");}return(e4=f(i2))&&(r3=m(i2,t4))&&(r3.value=(c3=this.attributes[e4])!=null?c3:"",r3.select()),(l2=this.delegate)!=null?l2.toolbarDidShowDialog(t4):void 0;},s3.prototype.setAttribute=function(t4){var e4,n3,i2;return e4=f(t4),n3=m(t4,e4),n3.willValidate&&!n3.checkValidity()?(n3.setAttribute("data-trix-validate",""),n3.classList.add("trix-validate"),n3.focus()):((i2=this.delegate)!=null&&i2.toolbarDidUpdateAttribute(e4,n3.value),this.hideDialog());},s3.prototype.removeAttribute=function(t4){var e4,n3;return e4=f(t4),(n3=this.delegate)!=null&&n3.toolbarDidRemoveAttribute(e4),this.hideDialog();},s3.prototype.hideDialog=function(){var t4,e4;return(t4=this.element.querySelector(u))?(t4.removeAttribute("data-trix-active"),t4.classList.remove("trix-active"),this.resetDialogInputs(),(e4=this.delegate)!=null?e4.toolbarDidHideDialog(g(t4)):void 0):void 0;},s3.prototype.resetDialogInputs=function(){var t4,e4,n3,i2,o3;for(i2=this.element.querySelectorAll(h),o3=[],t4=0,n3=i2.length;n3>t4;t4++){e4=i2[t4],e4.setAttribute("disabled","disabled"),e4.removeAttribute("data-trix-validate"),o3.push(e4.classList.remove("trix-validate"));}return o3;},s3.prototype.getDialog=function(t4){return this.element.querySelector("[data-trix-dialog="+t4+"]");},m=function m(t4,e4){return e4==null&&(e4=f(t4)),t4.querySelector("[data-trix-input][name='"+e4+"']");},d=function d(t4){return t4.getAttribute("data-trix-action");},f=function f(t4){var e4;return(e4=t4.getAttribute("data-trix-attribute"))!=null?e4:t4.getAttribute("data-trix-dialog-attribute");},g=function g(t4){return t4.getAttribute("data-trix-dialog");},s3;}(e2.BasicObject);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.ImagePreloadOperation=function(e3){function n3(t4){this.url=t4;}return t3(n3,e3),n3.prototype.perform=function(t4){var e4;return e4=new Image(),e4.onload=function(n4){return function(){return e4.width=n4.width=e4.naturalWidth,e4.height=n4.height=e4.naturalHeight,t4(true,e4);};}(this),e4.onerror=function(){return t4(false);},e4.src=this.url;},n3;}(e2.Operation);}.call(this),function(){var t3=function t3(t4,e3){return function(){return t4.apply(e3,arguments);};},n2=function n2(t4,e3){function n3(){this.constructor=t4;}for(var o2 in e3){i.call(e3,o2)&&(t4[o2]=e3[o2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},i={}.hasOwnProperty;e2.Attachment=function(i2){function o2(n3){n3==null&&(n3={}),this.releaseFile=t3(this.releaseFile,this),o2.__super__.constructor.apply(this,arguments),this.attributes=e2.Hash.box(n3),this.didChangeAttributes();}return n2(o2,i2),o2.previewablePattern=/^image(\/(gif|png|jpe?g)|$)/,o2.attachmentForFile=function(t4){var e3,n3;return n3=this.attributesForFile(t4),e3=new this(n3),e3.setFile(t4),e3;},o2.attributesForFile=function(t4){return new e2.Hash({filename:t4.name,filesize:t4.size,contentType:t4.type});},o2.fromJSON=function(t4){return new this(t4);},o2.prototype.getAttribute=function(t4){return this.attributes.get(t4);},o2.prototype.hasAttribute=function(t4){return this.attributes.has(t4);},o2.prototype.getAttributes=function(){return this.attributes.toObject();},o2.prototype.setAttributes=function(t4){var e3,n3,i3;return t4==null&&(t4={}),e3=this.attributes.merge(t4),this.attributes.isEqualTo(e3)?void 0:(this.attributes=e3,this.didChangeAttributes(),(n3=this.previewDelegate)!=null&&typeof n3.attachmentDidChangeAttributes=="function"&&n3.attachmentDidChangeAttributes(this),(i3=this.delegate)!=null&&typeof i3.attachmentDidChangeAttributes=="function"?i3.attachmentDidChangeAttributes(this):void 0);},o2.prototype.didChangeAttributes=function(){return this.isPreviewable()?this.preloadURL():void 0;},o2.prototype.isPending=function(){return this.file!=null&&!(this.getURL()||this.getHref());},o2.prototype.isPreviewable=function(){return this.attributes.has("previewable")?this.attributes.get("previewable"):this.constructor.previewablePattern.test(this.getContentType());},o2.prototype.getType=function(){return this.hasContent()?"content":this.isPreviewable()?"preview":"file";},o2.prototype.getURL=function(){return this.attributes.get("url");},o2.prototype.getHref=function(){return this.attributes.get("href");},o2.prototype.getFilename=function(){var t4;return(t4=this.attributes.get("filename"))!=null?t4:"";},o2.prototype.getFilesize=function(){return this.attributes.get("filesize");},o2.prototype.getFormattedFilesize=function(){var t4;return t4=this.attributes.get("filesize"),typeof t4=="number"?e2.config.fileSize.formatter(t4):"";},o2.prototype.getExtension=function(){var t4;return(t4=this.getFilename().match(/\.(\w+)$/))!=null?t4[1].toLowerCase():void 0;},o2.prototype.getContentType=function(){return this.attributes.get("contentType");},o2.prototype.hasContent=function(){return this.attributes.has("content");},o2.prototype.getContent=function(){return this.attributes.get("content");},o2.prototype.getWidth=function(){return this.attributes.get("width");},o2.prototype.getHeight=function(){return this.attributes.get("height");},o2.prototype.getFile=function(){return this.file;},o2.prototype.setFile=function(t4){return this.file=t4,this.isPreviewable()?this.preloadFile():void 0;},o2.prototype.releaseFile=function(){return this.releasePreloadedFile(),this.file=null;},o2.prototype.getUploadProgress=function(){var t4;return(t4=this.uploadProgress)!=null?t4:0;},o2.prototype.setUploadProgress=function(t4){var e3;return this.uploadProgress!==t4?(this.uploadProgress=t4,(e3=this.uploadProgressDelegate)!=null&&typeof e3.attachmentDidChangeUploadProgress=="function"?e3.attachmentDidChangeUploadProgress(this):void 0):void 0;},o2.prototype.toJSON=function(){return this.getAttributes();},o2.prototype.getCacheKey=function(){return[o2.__super__.getCacheKey.apply(this,arguments),this.attributes.getCacheKey(),this.getPreviewURL()].join("/");},o2.prototype.getPreviewURL=function(){return this.previewURL||this.preloadingURL;},o2.prototype.setPreviewURL=function(t4){var e3,n3;return t4!==this.getPreviewURL()?(this.previewURL=t4,(e3=this.previewDelegate)!=null&&typeof e3.attachmentDidChangeAttributes=="function"&&e3.attachmentDidChangeAttributes(this),(n3=this.delegate)!=null&&typeof n3.attachmentDidChangePreviewURL=="function"?n3.attachmentDidChangePreviewURL(this):void 0):void 0;},o2.prototype.preloadURL=function(){return this.preload(this.getURL(),this.releaseFile);},o2.prototype.preloadFile=function(){return this.file?(this.fileObjectURL=URL.createObjectURL(this.file),this.preload(this.fileObjectURL)):void 0;},o2.prototype.releasePreloadedFile=function(){return this.fileObjectURL?(URL.revokeObjectURL(this.fileObjectURL),this.fileObjectURL=null):void 0;},o2.prototype.preload=function(t4,n3){var i3;return t4&&t4!==this.getPreviewURL()?(this.preloadingURL=t4,i3=new e2.ImagePreloadOperation(t4),i3.then(function(e3){return function(i4){var o3,r2;return r2=i4.width,o3=i4.height,e3.getWidth()&&e3.getHeight()||e3.setAttributes({width:r2,height:o3}),e3.preloadingURL=null,e3.setPreviewURL(t4),typeof n3=="function"?n3():void 0;};}(this))["catch"](function(t5){return function(){return t5.preloadingURL=null,typeof n3=="function"?n3():void 0;};}(this))):void 0;},o2;}(e2.Object);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Piece=function(n3){function i(t4,n4){n4==null&&(n4={}),i.__super__.constructor.apply(this,arguments),this.attributes=e2.Hash.box(n4);}return t3(i,n3),i.types={},i.registerType=function(t4,e3){return e3.type=t4,this.types[t4]=e3;},i.fromJSON=function(t4){var e3;return(e3=this.types[t4.type])?e3.fromJSON(t4):void 0;},i.prototype.copyWithAttributes=function(t4){return new this.constructor(this.getValue(),t4);},i.prototype.copyWithAdditionalAttributes=function(t4){return this.copyWithAttributes(this.attributes.merge(t4));},i.prototype.copyWithoutAttribute=function(t4){return this.copyWithAttributes(this.attributes.remove(t4));},i.prototype.copy=function(){return this.copyWithAttributes(this.attributes);},i.prototype.getAttribute=function(t4){return this.attributes.get(t4);},i.prototype.getAttributesHash=function(){return this.attributes;},i.prototype.getAttributes=function(){return this.attributes.toObject();},i.prototype.getCommonAttributes=function(){var t4,e3,n4;return(n4=pieceList.getPieceAtIndex(0))?(t4=n4.attributes,e3=t4.getKeys(),pieceList.eachPiece(function(n5){return e3=t4.getKeysCommonToHash(n5.attributes),t4=t4.slice(e3);}),t4.toObject()):{};},i.prototype.hasAttribute=function(t4){return this.attributes.has(t4);},i.prototype.hasSameStringValueAsPiece=function(t4){return t4!=null&&this.toString()===t4.toString();},i.prototype.hasSameAttributesAsPiece=function(t4){return t4!=null&&(this.attributes===t4.attributes||this.attributes.isEqualTo(t4.attributes));},i.prototype.isBlockBreak=function(){return false;},i.prototype.isEqualTo=function(t4){return i.__super__.isEqualTo.apply(this,arguments)||this.hasSameConstructorAs(t4)&&this.hasSameStringValueAsPiece(t4)&&this.hasSameAttributesAsPiece(t4);},i.prototype.isEmpty=function(){return this.length===0;},i.prototype.isSerializable=function(){return true;},i.prototype.toJSON=function(){return{type:this.constructor.type,attributes:this.getAttributes()};},i.prototype.contentsForInspection=function(){return{type:this.constructor.type,attributes:this.attributes.inspect()};},i.prototype.canBeGrouped=function(){return this.hasAttribute("href");},i.prototype.canBeGroupedWith=function(t4){return this.getAttribute("href")===t4.getAttribute("href");},i.prototype.getLength=function(){return this.length;},i.prototype.canBeConsolidatedWith=function(){return false;},i;}(e2.Object);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Piece.registerType("attachment",e2.AttachmentPiece=function(n3){function i(t4){this.attachment=t4,i.__super__.constructor.apply(this,arguments),this.length=1,this.ensureAttachmentExclusivelyHasAttribute("href"),this.attachment.hasContent()||this.removeProhibitedAttributes();}return t3(i,n3),i.fromJSON=function(t4){return new this(e2.Attachment.fromJSON(t4.attachment),t4.attributes);},i.permittedAttributes=["caption","presentation"],i.prototype.ensureAttachmentExclusivelyHasAttribute=function(t4){return this.hasAttribute(t4)?(this.attachment.hasAttribute(t4)||this.attachment.setAttributes(this.attributes.slice(t4)),this.attributes=this.attributes.remove(t4)):void 0;},i.prototype.removeProhibitedAttributes=function(){var t4;return t4=this.attributes.slice(this.constructor.permittedAttributes),t4.isEqualTo(this.attributes)?void 0:this.attributes=t4;},i.prototype.getValue=function(){return this.attachment;},i.prototype.isSerializable=function(){return!this.attachment.isPending();},i.prototype.getCaption=function(){var t4;return(t4=this.attributes.get("caption"))!=null?t4:"";},i.prototype.isEqualTo=function(t4){var e3;return i.__super__.isEqualTo.apply(this,arguments)&&this.attachment.id===(t4!=null&&(e3=t4.attachment)!=null?e3.id:void 0);},i.prototype.toString=function(){return e2.OBJECT_REPLACEMENT_CHARACTER;},i.prototype.toJSON=function(){var t4;return t4=i.__super__.toJSON.apply(this,arguments),t4.attachment=this.attachment,t4;},i.prototype.getCacheKey=function(){return[i.__super__.getCacheKey.apply(this,arguments),this.attachment.getCacheKey()].join("/");},i.prototype.toConsole=function(){return JSON.stringify(this.toString());},i;}(e2.Piece));}.call(this),function(){var t3,n2=function n2(t4,e3){function n3(){this.constructor=t4;}for(var o2 in e3){i.call(e3,o2)&&(t4[o2]=e3[o2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},i={}.hasOwnProperty;t3=e2.normalizeNewlines,e2.Piece.registerType("string",e2.StringPiece=function(e3){function i2(e4){i2.__super__.constructor.apply(this,arguments),this.string=t3(e4),this.length=this.string.length;}return n2(i2,e3),i2.fromJSON=function(t4){return new this(t4.string,t4.attributes);},i2.prototype.getValue=function(){return this.string;},i2.prototype.toString=function(){return this.string.toString();},i2.prototype.isBlockBreak=function(){return this.toString()==="\n"&&this.getAttribute("blockBreak")===true;},i2.prototype.toJSON=function(){var t4;return t4=i2.__super__.toJSON.apply(this,arguments),t4.string=this.string,t4;},i2.prototype.canBeConsolidatedWith=function(t4){return t4!=null&&this.hasSameConstructorAs(t4)&&this.hasSameAttributesAsPiece(t4);},i2.prototype.consolidateWith=function(t4){return new this.constructor(this.toString()+t4.toString(),this.attributes);},i2.prototype.splitAtOffset=function(t4){var e4,n3;return t4===0?(e4=null,n3=this):t4===this.length?(e4=this,n3=null):(e4=new this.constructor(this.string.slice(0,t4),this.attributes),n3=new this.constructor(this.string.slice(t4),this.attributes)),[e4,n3];},i2.prototype.toConsole=function(){var t4;return t4=this.string,t4.length>15&&(t4=t4.slice(0,14)+"\u2026"),JSON.stringify(t4.toString());},i2;}(e2.Piece));}.call(this),function(){var t3,n2=function n2(t4,e3){function n3(){this.constructor=t4;}for(var o3 in e3){i.call(e3,o3)&&(t4[o3]=e3[o3]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},i={}.hasOwnProperty,o2=[].slice;t3=e2.spliceArray,e2.SplittableList=function(e3){function i2(t4){t4==null&&(t4=[]),i2.__super__.constructor.apply(this,arguments),this.objects=t4.slice(0),this.length=this.objects.length;}var r2,s2,a2;return n2(i2,e3),i2.box=function(t4){return t4 instanceof this?t4:new this(t4);},i2.prototype.indexOf=function(t4){return this.objects.indexOf(t4);},i2.prototype.splice=function(){var e4;return e4=1<=arguments.length?o2.call(arguments,0):[],new this.constructor(t3.apply(null,[this.objects].concat(o2.call(e4))));},i2.prototype.eachObject=function(t4){var e4,n3,i3,o3,r3,s3;for(r3=this.objects,s3=[],n3=e4=0,i3=r3.length;i3>e4;n3=++e4){o3=r3[n3],s3.push(t4(o3,n3));}return s3;},i2.prototype.insertObjectAtIndex=function(t4,e4){return this.splice(e4,0,t4);},i2.prototype.insertSplittableListAtIndex=function(t4,e4){return this.splice.apply(this,[e4,0].concat(o2.call(t4.objects)));},i2.prototype.insertSplittableListAtPosition=function(t4,e4){var n3,i3,o3;return o3=this.splitObjectAtPosition(e4),i3=o3[0],n3=o3[1],new this.constructor(i3).insertSplittableListAtIndex(t4,n3);},i2.prototype.editObjectAtIndex=function(t4,e4){return this.replaceObjectAtIndex(e4(this.objects[t4]),t4);},i2.prototype.replaceObjectAtIndex=function(t4,e4){return this.splice(e4,1,t4);},i2.prototype.removeObjectAtIndex=function(t4){return this.splice(t4,1);},i2.prototype.getObjectAtIndex=function(t4){return this.objects[t4];},i2.prototype.getSplittableListInRange=function(t4){var e4,n3,i3,o3;return i3=this.splitObjectsAtRange(t4),n3=i3[0],e4=i3[1],o3=i3[2],new this.constructor(n3.slice(e4,o3+1));},i2.prototype.selectSplittableList=function(t4){var e4,n3;return n3=function(){var n4,i3,o3,r3;for(o3=this.objects,r3=[],n4=0,i3=o3.length;i3>n4;n4++){e4=o3[n4],t4(e4)&&r3.push(e4);}return r3;}.call(this),new this.constructor(n3);},i2.prototype.removeObjectsInRange=function(t4){var e4,n3,i3,o3;return i3=this.splitObjectsAtRange(t4),n3=i3[0],e4=i3[1],o3=i3[2],new this.constructor(n3).splice(e4,o3-e4+1);},i2.prototype.transformObjectsInRange=function(t4,e4){var n3,i3,o3,r3,s3,a3,u;return s3=this.splitObjectsAtRange(t4),r3=s3[0],i3=s3[1],a3=s3[2],u=function(){var t5,s4,u2;for(u2=[],n3=t5=0,s4=r3.length;s4>t5;n3=++t5){o3=r3[n3],u2.push(n3>=i3&&a3>=n3?e4(o3):o3);}return u2;}(),new this.constructor(u);},i2.prototype.splitObjectsAtRange=function(t4){var e4,n3,i3,o3,s3,u;return o3=this.splitObjectAtPosition(a2(t4)),n3=o3[0],e4=o3[1],i3=o3[2],s3=new this.constructor(n3).splitObjectAtPosition(r2(t4)+i3),n3=s3[0],u=s3[1],[n3,e4,u-1];},i2.prototype.getObjectAtPosition=function(t4){var e4,n3,i3;return i3=this.findIndexAndOffsetAtPosition(t4),e4=i3.index,n3=i3.offset,this.objects[e4];},i2.prototype.splitObjectAtPosition=function(t4){var e4,n3,i3,o3,r3,s3,a3,u,c2,l;return s3=this.findIndexAndOffsetAtPosition(t4),e4=s3.index,r3=s3.offset,o3=this.objects.slice(0),e4!=null?r3===0?(c2=e4,l=0):(i3=this.getObjectAtIndex(e4),a3=i3.splitAtOffset(r3),n3=a3[0],u=a3[1],o3.splice(e4,1,n3,u),c2=e4+1,l=n3.getLength()-r3):(c2=o3.length,l=0),[o3,c2,l];},i2.prototype.consolidate=function(){var t4,e4,n3,i3,o3,r3;for(i3=[],o3=this.objects[0],r3=this.objects.slice(1),t4=0,e4=r3.length;e4>t4;t4++){n3=r3[t4],(typeof o3.canBeConsolidatedWith=="function"?o3.canBeConsolidatedWith(n3):void 0)?o3=o3.consolidateWith(n3):(i3.push(o3),o3=n3);}return o3!=null&&i3.push(o3),new this.constructor(i3);},i2.prototype.consolidateFromIndexToIndex=function(t4,e4){var n3,i3,r3;return i3=this.objects.slice(0),r3=i3.slice(t4,e4+1),n3=new this.constructor(r3).consolidate().toArray(),this.splice.apply(this,[t4,r3.length].concat(o2.call(n3)));},i2.prototype.findIndexAndOffsetAtPosition=function(t4){var e4,n3,i3,o3,r3,s3,a3;for(e4=0,a3=this.objects,i3=n3=0,o3=a3.length;o3>n3;i3=++n3){if(s3=a3[i3],r3=e4+s3.getLength(),t4>=e4&&r3>t4)return{index:i3,offset:t4-e4};e4=r3;}return{index:null,offset:null};},i2.prototype.findPositionAtIndexAndOffset=function(t4,e4){var n3,i3,o3,r3,s3,a3;for(s3=0,a3=this.objects,n3=i3=0,o3=a3.length;o3>i3;n3=++i3){if(r3=a3[n3],t4>n3)s3+=r3.getLength();else if(n3===t4){s3+=e4;break;}}return s3;},i2.prototype.getEndPosition=function(){var t4,e4;return this.endPosition!=null?this.endPosition:this.endPosition=function(){var n3,i3,o3;for(e4=0,o3=this.objects,n3=0,i3=o3.length;i3>n3;n3++){t4=o3[n3],e4+=t4.getLength();}return e4;}.call(this);},i2.prototype.toString=function(){return this.objects.join("");},i2.prototype.toArray=function(){return this.objects.slice(0);},i2.prototype.toJSON=function(){return this.toArray();},i2.prototype.isEqualTo=function(t4){return i2.__super__.isEqualTo.apply(this,arguments)||s2(this.objects,t4!=null?t4.objects:void 0);},s2=function s2(t4,e4){var n3,i3,o3,r3,s3;if(e4==null&&(e4=[]),t4.length!==e4.length)return false;for(s3=true,i3=n3=0,o3=t4.length;o3>n3;i3=++n3){r3=t4[i3],s3&&!r3.isEqualTo(e4[i3])&&(s3=false);}return s3;},i2.prototype.contentsForInspection=function(){var t4;return{objects:"["+function(){var e4,n3,i3,o3;for(i3=this.objects,o3=[],e4=0,n3=i3.length;n3>e4;e4++){t4=i3[e4],o3.push(t4.inspect());}return o3;}.call(this).join(", ")+"]"};},a2=function a2(t4){return t4[0];},r2=function r2(t4){return t4[1];},i2;}(e2.Object);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.Text=function(n3){function i(t4){var n4;t4==null&&(t4=[]),i.__super__.constructor.apply(this,arguments),this.pieceList=new e2.SplittableList(function(){var e3,i2,o2;for(o2=[],e3=0,i2=t4.length;i2>e3;e3++){n4=t4[e3],n4.isEmpty()||o2.push(n4);}return o2;}());}return t3(i,n3),i.textForAttachmentWithAttributes=function(t4,n4){var i2;return i2=new e2.AttachmentPiece(t4,n4),new this([i2]);},i.textForStringWithAttributes=function(t4,n4){var i2;return i2=new e2.StringPiece(t4,n4),new this([i2]);},i.fromJSON=function(t4){var n4,i2;return i2=function(){var i3,o2,r2;for(r2=[],i3=0,o2=t4.length;o2>i3;i3++){n4=t4[i3],r2.push(e2.Piece.fromJSON(n4));}return r2;}(),new this(i2);},i.prototype.copy=function(){return this.copyWithPieceList(this.pieceList);},i.prototype.copyWithPieceList=function(t4){return new this.constructor(t4.consolidate().toArray());},i.prototype.copyUsingObjectMap=function(t4){var e3,n4;return n4=function(){var n5,i2,o2,r2,s2;for(o2=this.getPieces(),s2=[],n5=0,i2=o2.length;i2>n5;n5++){e3=o2[n5],s2.push((r2=t4.find(e3))!=null?r2:e3);}return s2;}.call(this),new this.constructor(n4);},i.prototype.appendText=function(t4){return this.insertTextAtPosition(t4,this.getLength());},i.prototype.insertTextAtPosition=function(t4,e3){return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(t4.pieceList,e3));},i.prototype.removeTextAtRange=function(t4){return this.copyWithPieceList(this.pieceList.removeObjectsInRange(t4));},i.prototype.replaceTextAtRange=function(t4,e3){return this.removeTextAtRange(e3).insertTextAtPosition(t4,e3[0]);},i.prototype.moveTextFromRangeToPosition=function(t4,e3){var n4,i2;if(!(t4[0]<=e3&&e3<=t4[1]))return i2=this.getTextAtRange(t4),n4=i2.getLength(),t4[0]<e3&&(e3-=n4),this.removeTextAtRange(t4).insertTextAtPosition(i2,e3);},i.prototype.addAttributeAtRange=function(t4,e3,n4){var i2;return i2={},i2[t4]=e3,this.addAttributesAtRange(i2,n4);},i.prototype.addAttributesAtRange=function(t4,e3){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e3,function(e4){return e4.copyWithAdditionalAttributes(t4);}));},i.prototype.removeAttributeAtRange=function(t4,e3){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e3,function(e4){return e4.copyWithoutAttribute(t4);}));},i.prototype.setAttributesAtRange=function(t4,e3){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e3,function(e4){return e4.copyWithAttributes(t4);}));},i.prototype.getAttributesAtPosition=function(t4){var e3,n4;return(e3=(n4=this.pieceList.getObjectAtPosition(t4))!=null?n4.getAttributes():void 0)!=null?e3:{};},i.prototype.getCommonAttributes=function(){var t4,n4;return t4=function(){var t5,e3,i2,o2;for(i2=this.pieceList.toArray(),o2=[],t5=0,e3=i2.length;e3>t5;t5++){n4=i2[t5],o2.push(n4.getAttributes());}return o2;}.call(this),e2.Hash.fromCommonAttributesOfObjects(t4).toObject();},i.prototype.getCommonAttributesAtRange=function(t4){var e3;return(e3=this.getTextAtRange(t4).getCommonAttributes())!=null?e3:{};},i.prototype.getExpandedRangeForAttributeAtOffset=function(t4,e3){var n4,i2,o2;for(n4=o2=e3,i2=this.getLength();n4>0&&this.getCommonAttributesAtRange([n4-1,o2])[t4];){n4--;}for(;i2>o2&&this.getCommonAttributesAtRange([e3,o2+1])[t4];){o2++;}return[n4,o2];},i.prototype.getTextAtRange=function(t4){return this.copyWithPieceList(this.pieceList.getSplittableListInRange(t4));},i.prototype.getStringAtRange=function(t4){return this.pieceList.getSplittableListInRange(t4).toString();},i.prototype.getStringAtPosition=function(t4){return this.getStringAtRange([t4,t4+1]);},i.prototype.startsWithString=function(t4){return this.getStringAtRange([0,t4.length])===t4;},i.prototype.endsWithString=function(t4){var e3;return e3=this.getLength(),this.getStringAtRange([e3-t4.length,e3])===t4;},i.prototype.getAttachmentPieces=function(){var t4,e3,n4,i2,o2;for(i2=this.pieceList.toArray(),o2=[],t4=0,e3=i2.length;e3>t4;t4++){n4=i2[t4],n4.attachment!=null&&o2.push(n4);}return o2;},i.prototype.getAttachments=function(){var t4,e3,n4,i2,o2;for(i2=this.getAttachmentPieces(),o2=[],t4=0,e3=i2.length;e3>t4;t4++){n4=i2[t4],o2.push(n4.attachment);}return o2;},i.prototype.getAttachmentAndPositionById=function(t4){var e3,n4,i2,o2,r2,s2;for(o2=0,r2=this.pieceList.toArray(),e3=0,n4=r2.length;n4>e3;e3++){if(i2=r2[e3],((s2=i2.attachment)!=null?s2.id:void 0)===t4)return{attachment:i2.attachment,position:o2};o2+=i2.length;}return{attachment:null,position:null};},i.prototype.getAttachmentById=function(t4){var e3,n4,i2;return i2=this.getAttachmentAndPositionById(t4),e3=i2.attachment,n4=i2.position,e3;},i.prototype.getRangeOfAttachment=function(t4){var e3,n4;return n4=this.getAttachmentAndPositionById(t4.id),t4=n4.attachment,e3=n4.position,t4!=null?[e3,e3+1]:void 0;},i.prototype.updateAttributesForAttachment=function(t4,e3){var n4;return(n4=this.getRangeOfAttachment(e3))?this.addAttributesAtRange(t4,n4):this;},i.prototype.getLength=function(){return this.pieceList.getEndPosition();},i.prototype.isEmpty=function(){return this.getLength()===0;},i.prototype.isEqualTo=function(t4){var e3;return i.__super__.isEqualTo.apply(this,arguments)||(t4!=null&&(e3=t4.pieceList)!=null?e3.isEqualTo(this.pieceList):void 0);},i.prototype.isBlockBreak=function(){return this.getLength()===1&&this.pieceList.getObjectAtIndex(0).isBlockBreak();},i.prototype.eachPiece=function(t4){return this.pieceList.eachObject(t4);},i.prototype.getPieces=function(){return this.pieceList.toArray();},i.prototype.getPieceAtPosition=function(t4){return this.pieceList.getObjectAtPosition(t4);},i.prototype.contentsForInspection=function(){return{pieceList:this.pieceList.inspect()};},i.prototype.toSerializableText=function(){var t4;return t4=this.pieceList.selectSplittableList(function(t5){return t5.isSerializable();}),this.copyWithPieceList(t4);},i.prototype.toString=function(){return this.pieceList.toString();},i.prototype.toJSON=function(){return this.pieceList.toJSON();},i.prototype.toConsole=function(){var t4;return JSON.stringify(function(){var e3,n4,i2,o2;for(i2=this.pieceList.toArray(),o2=[],e3=0,n4=i2.length;n4>e3;e3++){t4=i2[e3],o2.push(JSON.parse(t4.toConsole()));}return o2;}.call(this));},i.prototype.getDirection=function(){return e2.getDirection(this.toString());},i.prototype.isRTL=function(){return this.getDirection()==="rtl";},i;}(e2.Object);}.call(this),function(){var t3,n2,i,o2,r2,s2=function s2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){a2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},a2={}.hasOwnProperty,u=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;},c2=[].slice;t3=e2.arraysAreEqual,r2=e2.spliceArray,i=e2.getBlockConfig,n2=e2.getBlockAttributeNames,o2=e2.getListAttributeNames,e2.Block=function(n3){function a3(t4,n4){t4==null&&(t4=new e2.Text()),n4==null&&(n4=[]),a3.__super__.constructor.apply(this,arguments),this.text=h(t4),this.attributes=n4;}var l,h,p2,d,f,g,m,v,y;return s2(a3,n3),a3.fromJSON=function(t4){var n4;return n4=e2.Text.fromJSON(t4.text),new this(n4,t4.attributes);},a3.prototype.isEmpty=function(){return this.text.isBlockBreak();},a3.prototype.isEqualTo=function(e3){return a3.__super__.isEqualTo.apply(this,arguments)||this.text.isEqualTo(e3!=null?e3.text:void 0)&&t3(this.attributes,e3!=null?e3.attributes:void 0);},a3.prototype.copyWithText=function(t4){return new this.constructor(t4,this.attributes);},a3.prototype.copyWithoutText=function(){return this.copyWithText(null);},a3.prototype.copyWithAttributes=function(t4){return new this.constructor(this.text,t4);},a3.prototype.copyWithoutAttributes=function(){return this.copyWithAttributes(null);},a3.prototype.copyUsingObjectMap=function(t4){var e3;return this.copyWithText((e3=t4.find(this.text))?e3:this.text.copyUsingObjectMap(t4));},a3.prototype.addAttribute=function(t4){var e3;return e3=this.attributes.concat(d(t4)),this.copyWithAttributes(e3);},a3.prototype.removeAttribute=function(t4){var e3,n4;return n4=i(t4).listAttribute,e3=g(g(this.attributes,t4),n4),this.copyWithAttributes(e3);},a3.prototype.removeLastAttribute=function(){return this.removeAttribute(this.getLastAttribute());},a3.prototype.getLastAttribute=function(){return f(this.attributes);},a3.prototype.getAttributes=function(){return this.attributes.slice(0);},a3.prototype.getAttributeLevel=function(){return this.attributes.length;},a3.prototype.getAttributeAtLevel=function(t4){return this.attributes[t4-1];},a3.prototype.hasAttribute=function(t4){return u.call(this.attributes,t4)>=0;},a3.prototype.hasAttributes=function(){return this.getAttributeLevel()>0;},a3.prototype.getLastNestableAttribute=function(){return f(this.getNestableAttributes());},a3.prototype.getNestableAttributes=function(){var t4,e3,n4,o3,r3;for(o3=this.attributes,r3=[],e3=0,n4=o3.length;n4>e3;e3++){t4=o3[e3],i(t4).nestable&&r3.push(t4);}return r3;},a3.prototype.getNestingLevel=function(){return this.getNestableAttributes().length;},a3.prototype.decreaseNestingLevel=function(){var t4;return(t4=this.getLastNestableAttribute())?this.removeAttribute(t4):this;},a3.prototype.increaseNestingLevel=function(){var t4,e3,n4;return(t4=this.getLastNestableAttribute())?(n4=this.attributes.lastIndexOf(t4),e3=r2.apply(null,[this.attributes,n4+1,0].concat(c2.call(d(t4)))),this.copyWithAttributes(e3)):this;},a3.prototype.getListItemAttributes=function(){var t4,e3,n4,o3,r3;for(o3=this.attributes,r3=[],e3=0,n4=o3.length;n4>e3;e3++){t4=o3[e3],i(t4).listAttribute&&r3.push(t4);}return r3;},a3.prototype.isListItem=function(){var t4;return(t4=i(this.getLastAttribute()))!=null?t4.listAttribute:void 0;},a3.prototype.isTerminalBlock=function(){var t4;return(t4=i(this.getLastAttribute()))!=null?t4.terminal:void 0;},a3.prototype.breaksOnReturn=function(){var t4;return(t4=i(this.getLastAttribute()))!=null?t4.breakOnReturn:void 0;},a3.prototype.findLineBreakInDirectionFromPosition=function(t4,e3){var n4,i2;return i2=this.toString(),n4=function(){switch(t4){case"forward":return i2.indexOf("\n",e3);case"backward":return i2.slice(0,e3).lastIndexOf("\n");}}(),n4!==-1?n4:void 0;},a3.prototype.contentsForInspection=function(){return{text:this.text.inspect(),attributes:this.attributes};},a3.prototype.toString=function(){return this.text.toString();},a3.prototype.toJSON=function(){return{text:this.text,attributes:this.attributes};},a3.prototype.getDirection=function(){return this.text.getDirection();},a3.prototype.isRTL=function(){return this.text.isRTL();},a3.prototype.getLength=function(){return this.text.getLength();},a3.prototype.canBeConsolidatedWith=function(t4){return!this.hasAttributes()&&!t4.hasAttributes()&&this.getDirection()===t4.getDirection();},a3.prototype.consolidateWith=function(t4){var n4,i2;return n4=e2.Text.textForStringWithAttributes("\n"),i2=this.getTextWithoutBlockBreak().appendText(n4),this.copyWithText(i2.appendText(t4.text));},a3.prototype.splitAtOffset=function(t4){var e3,n4;return t4===0?(e3=null,n4=this):t4===this.getLength()?(e3=this,n4=null):(e3=this.copyWithText(this.text.getTextAtRange([0,t4])),n4=this.copyWithText(this.text.getTextAtRange([t4,this.getLength()]))),[e3,n4];},a3.prototype.getBlockBreakPosition=function(){return this.text.getLength()-1;},a3.prototype.getTextWithoutBlockBreak=function(){return m(this.text)?this.text.getTextAtRange([0,this.getBlockBreakPosition()]):this.text.copy();},a3.prototype.canBeGrouped=function(t4){return this.attributes[t4];},a3.prototype.canBeGroupedWith=function(t4,e3){var n4,r3,s3,a4;return s3=t4.getAttributes(),r3=s3[e3],n4=this.attributes[e3],!(n4!==r3||i(n4).group===false&&(a4=s3[e3+1],u.call(o2(),a4)<0)||this.getDirection()!==t4.getDirection()&&!t4.isEmpty());},h=function h(t4){return t4=y(t4),t4=l(t4);},y=function y(t4){var n4,i2,o3,r3,s3,a4;return r3=false,a4=t4.getPieces(),i2=2<=a4.length?c2.call(a4,0,n4=a4.length-1):(n4=0,[]),o3=a4[n4++],o3==null?t4:(i2=function(){var t5,e3,n5;for(n5=[],t5=0,e3=i2.length;e3>t5;t5++){s3=i2[t5],s3.isBlockBreak()?(r3=true,n5.push(v(s3))):n5.push(s3);}return n5;}(),r3?new e2.Text(c2.call(i2).concat([o3])):t4);},p2=e2.Text.textForStringWithAttributes("\n",{blockBreak:true}),l=function l(t4){return m(t4)?t4:t4.appendText(p2);},m=function m(t4){var e3,n4;return n4=t4.getLength(),n4===0?false:(e3=t4.getTextAtRange([n4-1,n4]),e3.isBlockBreak());},v=function v(t4){return t4.copyWithoutAttribute("blockBreak");},d=function d(t4){var e3;return e3=i(t4).listAttribute,e3!=null?[e3,t4]:[t4];},f=function f(t4){return t4.slice(-1)[0];},g=function g(t4,e3){var n4;return n4=t4.lastIndexOf(e3),n4===-1?t4:r2(t4,n4,1);},a3;}(e2.Object);}.call(this),function(){var t3,n2,i,o2=function o2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){r2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},r2={}.hasOwnProperty,s2=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;},a2=[].slice;n2=e2.tagName,i=e2.walkTree,t3=e2.nodeIsAttachmentElement,e2.HTMLSanitizer=function(r3){function u(t4,e3){var n3;n3=e3!=null?e3:{},this.allowedAttributes=n3.allowedAttributes,this.forbiddenProtocols=n3.forbiddenProtocols,this.forbiddenElements=n3.forbiddenElements,this.allowedAttributes==null&&(this.allowedAttributes=c2),this.forbiddenProtocols==null&&(this.forbiddenProtocols=h),this.forbiddenElements==null&&(this.forbiddenElements=l),this.body=p2(t4);}var c2,l,h,p2;return o2(u,r3),c2="style href src width height class".split(" "),h="javascript:".split(" "),l="script iframe".split(" "),u.sanitize=function(t4,e3){var n3;return n3=new this(t4,e3),n3.sanitize(),n3;},u.prototype.sanitize=function(){return this.sanitizeElements(),this.normalizeListElementNesting();},u.prototype.getHTML=function(){return this.body.innerHTML;},u.prototype.getBody=function(){return this.body;},u.prototype.sanitizeElements=function(){var t4,n3,o3,r4,s3;for(s3=i(this.body),r4=[];s3.nextNode();){switch(o3=s3.currentNode,o3.nodeType){case Node.ELEMENT_NODE:this.elementIsRemovable(o3)?r4.push(o3):this.sanitizeElement(o3);break;case Node.COMMENT_NODE:r4.push(o3);}}for(t4=0,n3=r4.length;n3>t4;t4++){o3=r4[t4],e2.removeNode(o3);}return this.body;},u.prototype.sanitizeElement=function(t4){var e3,n3,i2,o3,r4;for(t4.hasAttribute("href")&&(o3=t4.protocol,s2.call(this.forbiddenProtocols,o3)>=0&&t4.removeAttribute("href")),r4=a2.call(t4.attributes),e3=0,n3=r4.length;n3>e3;e3++){i2=r4[e3].name,s2.call(this.allowedAttributes,i2)>=0||i2.indexOf("data-trix")===0||t4.removeAttribute(i2);}return t4;},u.prototype.normalizeListElementNesting=function(){var t4,e3,i2,o3,r4;for(r4=a2.call(this.body.querySelectorAll("ul,ol")),t4=0,e3=r4.length;e3>t4;t4++){i2=r4[t4],(o3=i2.previousElementSibling)&&n2(o3)==="li"&&o3.appendChild(i2);}return this.body;},u.prototype.elementIsRemovable=function(t4){return(t4!=null?t4.nodeType:void 0)===Node.ELEMENT_NODE?this.elementIsForbidden(t4)||this.elementIsntSerializable(t4):void 0;},u.prototype.elementIsForbidden=function(t4){var e3;return e3=n2(t4),s2.call(this.forbiddenElements,e3)>=0;},u.prototype.elementIsntSerializable=function(e3){return e3.getAttribute("data-trix-serialize")==="false"&&!t3(e3);},p2=function p2(t4){var e3,n3,i2,o3,r4;for(t4==null&&(t4=""),t4=t4.replace(/<\/html[^>]*>[^]*$/i,"</html>"),e3=document.implementation.createHTMLDocument(""),e3.documentElement.innerHTML=t4,r4=e3.head.querySelectorAll("style"),i2=0,o3=r4.length;o3>i2;i2++){n3=r4[i2],e3.body.appendChild(n3);}return e3.body;},u;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2,l,h,p2=function p2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){d.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},d={}.hasOwnProperty,f=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=e2.arraysAreEqual,s2=e2.makeElement,l=e2.tagName,r2=e2.getBlockTagNames,h=e2.walkTree,o2=e2.findClosestElementFromNode,i=e2.elementContainsNode,a2=e2.nodeIsAttachmentElement,u=e2.normalizeSpaces,n2=e2.breakableWhitespacePattern,c2=e2.squishBreakableWhitespace,e2.HTMLParser=function(d2){function g(t4,e3){this.html=t4,this.referenceElement=(e3!=null?e3:{}).referenceElement,this.blocks=[],this.blockElements=[],this.processedElements=[];}var m,v,y,b,A,C3,x,w,E,S2,R,k;return p2(g,d2),g.parse=function(t4,e3){var n3;return n3=new this(t4,e3),n3.parse(),n3;},g.prototype.getDocument=function(){return e2.Document.fromJSON(this.blocks);},g.prototype.parse=function(){var t4,n3;try{for(this.createHiddenContainer(),t4=e2.HTMLSanitizer.sanitize(this.html).getHTML(),this.containerElement.innerHTML=t4,n3=h(this.containerElement,{usingFilter:x});n3.nextNode();){this.processNode(n3.currentNode);}return this.translateBlockElementMarginsToNewlines();}finally{this.removeHiddenContainer();}},g.prototype.createHiddenContainer=function(){return this.referenceElement?(this.containerElement=this.referenceElement.cloneNode(false),this.containerElement.removeAttribute("id"),this.containerElement.setAttribute("data-trix-internal",""),this.containerElement.style.display="none",this.referenceElement.parentNode.insertBefore(this.containerElement,this.referenceElement.nextSibling)):(this.containerElement=s2({tagName:"div",style:{display:"none"}}),document.body.appendChild(this.containerElement));},g.prototype.removeHiddenContainer=function(){return e2.removeNode(this.containerElement);},x=function x(t4){return l(t4)==="style"?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT;},g.prototype.processNode=function(t4){switch(t4.nodeType){case Node.TEXT_NODE:if(!this.isInsignificantTextNode(t4))return this.appendBlockForTextNode(t4),this.processTextNode(t4);break;case Node.ELEMENT_NODE:return this.appendBlockForElement(t4),this.processElement(t4);}},g.prototype.appendBlockForTextNode=function(e3){var n3,i2,o3;return i2=e3.parentNode,i2===this.currentBlockElement&&this.isBlockElement(e3.previousSibling)?this.appendStringWithAttributes("\n"):i2!==this.containerElement&&!this.isBlockElement(i2)||(n3=this.getBlockAttributes(i2),t3(n3,(o3=this.currentBlock)!=null?o3.attributes:void 0))?void 0:(this.currentBlock=this.appendBlockForAttributesWithElement(n3,i2),this.currentBlockElement=i2);},g.prototype.appendBlockForElement=function(e3){var n3,o3,r3,s3;if(r3=this.isBlockElement(e3),o3=i(this.currentBlockElement,e3),r3&&!this.isBlockElement(e3.firstChild)){if((!this.isInsignificantTextNode(e3.firstChild)||!this.isBlockElement(e3.firstElementChild))&&(n3=this.getBlockAttributes(e3),e3.firstChild))return o3&&t3(n3,this.currentBlock.attributes)?this.appendStringWithAttributes("\n"):(this.currentBlock=this.appendBlockForAttributesWithElement(n3,e3),this.currentBlockElement=e3);}else if(this.currentBlockElement&&!o3&&!r3)return(s3=this.findParentBlockElement(e3))?this.appendBlockForElement(s3):(this.currentBlock=this.appendEmptyBlock(),this.currentBlockElement=null);},g.prototype.findParentBlockElement=function(t4){var e3;for(e3=t4.parentElement;e3&&e3!==this.containerElement;){if(this.isBlockElement(e3)&&f.call(this.blockElements,e3)>=0)return e3;e3=e3.parentElement;}return null;},g.prototype.processTextNode=function(t4){var e3,n3;return n3=t4.data,v(t4.parentNode)||(n3=c2(n3),R((e3=t4.previousSibling)!=null?e3.textContent:void 0)&&(n3=A(n3))),this.appendStringWithAttributes(n3,this.getTextAttributes(t4.parentNode));},g.prototype.processElement=function(t4){var e3,n3,i2,o3,r3;if(a2(t4))return e3=w(t4,"attachment"),Object.keys(e3).length&&(o3=this.getTextAttributes(t4),this.appendAttachmentWithAttributes(e3,o3),t4.innerHTML=""),this.processedElements.push(t4);switch(l(t4)){case"br":return this.isExtraBR(t4)||this.isBlockElement(t4.nextSibling)||this.appendStringWithAttributes("\n",this.getTextAttributes(t4)),this.processedElements.push(t4);case"img":e3={url:t4.getAttribute("src"),contentType:"image"},i2=b(t4);for(n3 in i2){r3=i2[n3],e3[n3]=r3;}return this.appendAttachmentWithAttributes(e3,this.getTextAttributes(t4)),this.processedElements.push(t4);case"tr":if(t4.parentNode.firstChild!==t4)return this.appendStringWithAttributes("\n");break;case"td":if(t4.parentNode.firstChild!==t4)return this.appendStringWithAttributes(" | ");}},g.prototype.appendBlockForAttributesWithElement=function(t4,e3){var n3;return this.blockElements.push(e3),n3=m(t4),this.blocks.push(n3),n3;},g.prototype.appendEmptyBlock=function(){return this.appendBlockForAttributesWithElement([],null);},g.prototype.appendStringWithAttributes=function(t4,e3){return this.appendPiece(S2(t4,e3));},g.prototype.appendAttachmentWithAttributes=function(t4,e3){return this.appendPiece(E(t4,e3));},g.prototype.appendPiece=function(t4){return this.blocks.length===0&&this.appendEmptyBlock(),this.blocks[this.blocks.length-1].text.push(t4);},g.prototype.appendStringToTextAtIndex=function(t4,e3){var n3,i2;return i2=this.blocks[e3].text,n3=i2[i2.length-1],(n3!=null?n3.type:void 0)==="string"?n3.string+=t4:i2.push(S2(t4));},g.prototype.prependStringToTextAtIndex=function(t4,e3){var n3,i2;return i2=this.blocks[e3].text,n3=i2[0],(n3!=null?n3.type:void 0)==="string"?n3.string=t4+n3.string:i2.unshift(S2(t4));},S2=function S2(t4,e3){var n3;return e3==null&&(e3={}),n3="string",t4=u(t4),{string:t4,attributes:e3,type:n3};},E=function E(t4,e3){var n3;return e3==null&&(e3={}),n3="attachment",{attachment:t4,attributes:e3,type:n3};},m=function m(t4){var e3;return t4==null&&(t4={}),e3=[],{text:e3,attributes:t4};},g.prototype.getTextAttributes=function(t4){var n3,i2,r3,s3,u2,c3,l2,h2,p3,d3,f2,g2;r3={},p3=e2.config.textAttributes;for(n3 in p3){if(u2=p3[n3],u2.tagName&&o2(t4,{matchingSelector:u2.tagName,untilNode:this.containerElement}))r3[n3]=true;else if(u2.parser){if(g2=u2.parser(t4)){for(i2=false,d3=this.findBlockElementAncestors(t4),c3=0,h2=d3.length;h2>c3;c3++){if(s3=d3[c3],u2.parser(s3)===g2){i2=true;break;}}i2||(r3[n3]=g2);}}else u2.styleProperty&&(g2=t4.style[u2.styleProperty])&&(r3[n3]=g2);}if(a2(t4)){f2=w(t4,"attributes");for(l2 in f2){g2=f2[l2],r3[l2]=g2;}}return r3;},g.prototype.getBlockAttributes=function(t4){var n3,i2,o3,r3;for(i2=[];t4&&t4!==this.containerElement;){r3=e2.config.blockAttributes;for(n3 in r3){o3=r3[n3],o3.parse!==false&&l(t4)===o3.tagName&&((typeof o3.test=="function"?o3.test(t4):void 0)||!o3.test)&&(i2.push(n3),o3.listAttribute&&i2.push(o3.listAttribute));}t4=t4.parentNode;}return i2.reverse();},g.prototype.findBlockElementAncestors=function(t4){var e3,n3;for(e3=[];t4&&t4!==this.containerElement;){n3=l(t4),f.call(r2(),n3)>=0&&e3.push(t4),t4=t4.parentNode;}return e3;},w=function w(t4,e3){try{return JSON.parse(t4.getAttribute("data-trix-"+e3));}catch(n3){return{};}},b=function b(t4){var e3,n3,i2;return i2=t4.getAttribute("width"),n3=t4.getAttribute("height"),e3={},i2&&(e3.width=parseInt(i2,10)),n3&&(e3.height=parseInt(n3,10)),e3;},g.prototype.isBlockElement=function(t4){var e3;if((t4!=null?t4.nodeType:void 0)===Node.ELEMENT_NODE&&!a2(t4)&&!o2(t4,{matchingSelector:"td",untilNode:this.containerElement}))return e3=l(t4),f.call(r2(),e3)>=0||window.getComputedStyle(t4).display==="block";},g.prototype.isInsignificantTextNode=function(t4){var e3,n3,i2;if((t4!=null?t4.nodeType:void 0)===Node.TEXT_NODE&&k(t4.data)&&(n3=t4.parentNode,i2=t4.previousSibling,e3=t4.nextSibling,(!C3(n3.previousSibling)||this.isBlockElement(n3.previousSibling))&&!v(n3)))return!i2||this.isBlockElement(i2)||!e3||this.isBlockElement(e3);},g.prototype.isExtraBR=function(t4){return l(t4)==="br"&&this.isBlockElement(t4.parentNode)&&t4.parentNode.lastChild===t4;},v=function v(t4){var e3;return e3=window.getComputedStyle(t4).whiteSpace,e3==="pre"||e3==="pre-wrap"||e3==="pre-line";},C3=function C3(t4){return t4&&!R(t4.textContent);},g.prototype.translateBlockElementMarginsToNewlines=function(){var t4,e3,n3,i2,o3,r3,s3,a3;for(e3=this.getMarginOfDefaultBlockElement(),s3=this.blocks,a3=[],i2=n3=0,o3=s3.length;o3>n3;i2=++n3){t4=s3[i2],(r3=this.getMarginOfBlockElementAtIndex(i2))&&(r3.top>2*e3.top&&this.prependStringToTextAtIndex("\n",i2),a3.push(r3.bottom>2*e3.bottom?this.appendStringToTextAtIndex("\n",i2):void 0));}return a3;},g.prototype.getMarginOfBlockElementAtIndex=function(t4){var e3,n3;return!(e3=this.blockElements[t4])||!e3.textContent||(n3=l(e3),f.call(r2(),n3)>=0||f.call(this.processedElements,e3)>=0)?void 0:y(e3);},g.prototype.getMarginOfDefaultBlockElement=function(){var t4;return t4=s2(e2.config.blockAttributes["default"].tagName),this.containerElement.appendChild(t4),y(t4);},y=function y(t4){var e3;return e3=window.getComputedStyle(t4),e3.display==="block"?{top:parseInt(e3.marginTop),bottom:parseInt(e3.marginBottom)}:void 0;},A=function A(t4){return t4.replace(RegExp("^"+n2.source+"+"),"");},k=function k(t4){return RegExp("^"+n2.source+"*$").test(t4);},R=function R(t4){return /\s$/.test(t4);},g;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2=function r2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){s2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},s2={}.hasOwnProperty,a2=[].slice,u=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=e2.arraysAreEqual,i=e2.normalizeRange,o2=e2.rangeIsCollapsed,n2=e2.getBlockConfig,e2.Document=function(s3){function c2(t4){t4==null&&(t4=[]),c2.__super__.constructor.apply(this,arguments),t4.length===0&&(t4=[new e2.Block()]),this.blockList=e2.SplittableList.box(t4);}var l;return r2(c2,s3),c2.fromJSON=function(t4){var n3,i2;return i2=function(){var i3,o3,r3;for(r3=[],i3=0,o3=t4.length;o3>i3;i3++){n3=t4[i3],r3.push(e2.Block.fromJSON(n3));}return r3;}(),new this(i2);},c2.fromHTML=function(t4,n3){return e2.HTMLParser.parse(t4,n3).getDocument();},c2.fromString=function(t4,n3){var i2;return i2=e2.Text.textForStringWithAttributes(t4,n3),new this([new e2.Block(i2)]);},c2.prototype.isEmpty=function(){var t4;return this.blockList.length===1&&(t4=this.getBlockAtIndex(0),t4.isEmpty()&&!t4.hasAttributes());},c2.prototype.copy=function(t4){var e3;return t4==null&&(t4={}),e3=t4.consolidateBlocks?this.blockList.consolidate().toArray():this.blockList.toArray(),new this.constructor(e3);},c2.prototype.copyUsingObjectsFromDocument=function(t4){var n3;return n3=new e2.ObjectMap(t4.getObjects()),this.copyUsingObjectMap(n3);},c2.prototype.copyUsingObjectMap=function(t4){var e3,n3,i2;return n3=function(){var n4,o3,r3,s4;for(r3=this.getBlocks(),s4=[],n4=0,o3=r3.length;o3>n4;n4++){e3=r3[n4],s4.push((i2=t4.find(e3))?i2:e3.copyUsingObjectMap(t4));}return s4;}.call(this),new this.constructor(n3);},c2.prototype.copyWithBaseBlockAttributes=function(t4){var e3,n3,i2;return t4==null&&(t4=[]),i2=function(){var i3,o3,r3,s4;for(r3=this.getBlocks(),s4=[],i3=0,o3=r3.length;o3>i3;i3++){n3=r3[i3],e3=t4.concat(n3.getAttributes()),s4.push(n3.copyWithAttributes(e3));}return s4;}.call(this),new this.constructor(i2);},c2.prototype.replaceBlock=function(t4,e3){var n3;return n3=this.blockList.indexOf(t4),n3===-1?this:new this.constructor(this.blockList.replaceObjectAtIndex(e3,n3));},c2.prototype.insertDocumentAtRange=function(t4,e3){var n3,r3,s4,a3,u2,c3,l2;return r3=t4.blockList,u2=(e3=i(e3))[0],c3=this.locationFromPosition(u2),s4=c3.index,a3=c3.offset,l2=this,n3=this.getBlockAtPosition(u2),o2(e3)&&n3.isEmpty()&&!n3.hasAttributes()?l2=new this.constructor(l2.blockList.removeObjectAtIndex(s4)):n3.getBlockBreakPosition()===a3&&u2++,l2=l2.removeTextAtRange(e3),new this.constructor(l2.blockList.insertSplittableListAtPosition(r3,u2));},c2.prototype.mergeDocumentAtRange=function(e3,n3){var o3,r3,s4,a3,u2,c3,l2,h,p2,d,f,g;return f=(n3=i(n3))[0],d=this.locationFromPosition(f),r3=this.getBlockAtIndex(d.index).getAttributes(),o3=e3.getBaseBlockAttributes(),g=r3.slice(-o3.length),t3(o3,g)?(l2=r3.slice(0,-o3.length),c3=e3.copyWithBaseBlockAttributes(l2)):c3=e3.copy({consolidateBlocks:true}).copyWithBaseBlockAttributes(r3),s4=c3.getBlockCount(),a3=c3.getBlockAtIndex(0),t3(r3,a3.getAttributes())?(u2=a3.getTextWithoutBlockBreak(),p2=this.insertTextAtRange(u2,n3),s4>1&&(c3=new this.constructor(c3.getBlocks().slice(1)),h=f+u2.getLength(),p2=p2.insertDocumentAtRange(c3,h))):p2=this.insertDocumentAtRange(c3,n3),p2;},c2.prototype.insertTextAtRange=function(t4,e3){var n3,o3,r3,s4,a3;return a3=(e3=i(e3))[0],s4=this.locationFromPosition(a3),o3=s4.index,r3=s4.offset,n3=this.removeTextAtRange(e3),new this.constructor(n3.blockList.editObjectAtIndex(o3,function(e4){return e4.copyWithText(e4.text.insertTextAtPosition(t4,r3));}));},c2.prototype.removeTextAtRange=function(t4){var e3,n3,r3,s4,a3,u2,c3,l2,h,p2,d,f,g,m,v,y,b,A,C3,x,w;return p2=t4=i(t4),l2=p2[0],A=p2[1],o2(t4)?this:(d=this.locationRangeFromRange(t4),u2=d[0],y=d[1],a3=u2.index,c3=u2.offset,s4=this.getBlockAtIndex(a3),v=y.index,b=y.offset,m=this.getBlockAtIndex(v),f=A-l2===1&&s4.getBlockBreakPosition()===c3&&m.getBlockBreakPosition()!==b&&m.text.getStringAtPosition(b)==="\n",f?r3=this.blockList.editObjectAtIndex(v,function(t5){return t5.copyWithText(t5.text.removeTextAtRange([b,b+1]));}):(h=s4.text.getTextAtRange([0,c3]),C3=m.text.getTextAtRange([b,m.getLength()]),x=h.appendText(C3),g=a3!==v&&c3===0,w=g&&s4.getAttributeLevel()>=m.getAttributeLevel(),n3=w?m.copyWithText(x):s4.copyWithText(x),e3=v+1-a3,r3=this.blockList.splice(a3,e3,n3)),new this.constructor(r3));},c2.prototype.moveTextFromRangeToPosition=function(t4,e3){var n3,o3,r3,s4,u2,c3,l2,h,p2,d;return c3=t4=i(t4),p2=c3[0],r3=c3[1],e3>=p2&&r3>=e3?this:(o3=this.getDocumentAtRange(t4),h=this.removeTextAtRange(t4),u2=e3>p2,u2&&(e3-=o3.getLength()),l2=o3.getBlocks(),s4=l2[0],n3=2<=l2.length?a2.call(l2,1):[],n3.length===0?(d=s4.getTextWithoutBlockBreak(),u2&&(e3+=1)):d=s4.text,h=h.insertTextAtRange(d,e3),n3.length===0?h:(o3=new this.constructor(n3),e3+=d.getLength(),h.insertDocumentAtRange(o3,e3)));},c2.prototype.addAttributeAtRange=function(t4,e3,i2){var o3;return o3=this.blockList,this.eachBlockAtRange(i2,function(i3,r3,s4){return o3=o3.editObjectAtIndex(s4,function(){return n2(t4)?i3.addAttribute(t4,e3):r3[0]===r3[1]?i3:i3.copyWithText(i3.text.addAttributeAtRange(t4,e3,r3));});}),new this.constructor(o3);},c2.prototype.addAttribute=function(t4,e3){var n3;return n3=this.blockList,this.eachBlock(function(i2,o3){return n3=n3.editObjectAtIndex(o3,function(){return i2.addAttribute(t4,e3);});}),new this.constructor(n3);},c2.prototype.removeAttributeAtRange=function(t4,e3){var i2;return i2=this.blockList,this.eachBlockAtRange(e3,function(e4,o3,r3){return n2(t4)?i2=i2.editObjectAtIndex(r3,function(){return e4.removeAttribute(t4);}):o3[0]!==o3[1]?i2=i2.editObjectAtIndex(r3,function(){return e4.copyWithText(e4.text.removeAttributeAtRange(t4,o3));}):void 0;}),new this.constructor(i2);},c2.prototype.updateAttributesForAttachment=function(t4,e3){var n3,i2,o3,r3;return o3=(i2=this.getRangeOfAttachment(e3))[0],n3=this.locationFromPosition(o3).index,r3=this.getTextAtIndex(n3),new this.constructor(this.blockList.editObjectAtIndex(n3,function(n4){return n4.copyWithText(r3.updateAttributesForAttachment(t4,e3));}));},c2.prototype.removeAttributeForAttachment=function(t4,e3){var n3;return n3=this.getRangeOfAttachment(e3),this.removeAttributeAtRange(t4,n3);},c2.prototype.insertBlockBreakAtRange=function(t4){var n3,o3,r3,s4;return s4=(t4=i(t4))[0],r3=this.locationFromPosition(s4).offset,o3=this.removeTextAtRange(t4),r3===0&&(n3=[new e2.Block()]),new this.constructor(o3.blockList.insertSplittableListAtPosition(new e2.SplittableList(n3),s4));},c2.prototype.applyBlockAttributeAtRange=function(t4,e3,i2){var o3,r3,s4,a3;return s4=this.expandRangeToLineBreaksAndSplitBlocks(i2),r3=s4.document,i2=s4.range,o3=n2(t4),o3.listAttribute?(r3=r3.removeLastListAttributeAtRange(i2,{exceptAttributeName:t4}),a3=r3.convertLineBreaksToBlockBreaksInRange(i2),r3=a3.document,i2=a3.range):r3=o3.exclusive?r3.removeBlockAttributesAtRange(i2):o3.terminal?r3.removeLastTerminalAttributeAtRange(i2):r3.consolidateBlocksAtRange(i2),r3.addAttributeAtRange(t4,e3,i2);},c2.prototype.removeLastListAttributeAtRange=function(t4,e3){var i2;return e3==null&&(e3={}),i2=this.blockList,this.eachBlockAtRange(t4,function(t5,o3,r3){var s4;if((s4=t5.getLastAttribute())&&n2(s4).listAttribute&&s4!==e3.exceptAttributeName)return i2=i2.editObjectAtIndex(r3,function(){return t5.removeAttribute(s4);});}),new this.constructor(i2);},c2.prototype.removeLastTerminalAttributeAtRange=function(t4){var e3;return e3=this.blockList,this.eachBlockAtRange(t4,function(t5,i2,o3){var r3;if((r3=t5.getLastAttribute())&&n2(r3).terminal)return e3=e3.editObjectAtIndex(o3,function(){return t5.removeAttribute(r3);});}),new this.constructor(e3);},c2.prototype.removeBlockAttributesAtRange=function(t4){var e3;return e3=this.blockList,this.eachBlockAtRange(t4,function(t5,n3,i2){return t5.hasAttributes()?e3=e3.editObjectAtIndex(i2,function(){return t5.copyWithoutAttributes();}):void 0;}),new this.constructor(e3);},c2.prototype.expandRangeToLineBreaksAndSplitBlocks=function(t4){var e3,n3,o3,r3,s4,a3,u2,c3,l2;return a3=t4=i(t4),l2=a3[0],r3=a3[1],c3=this.locationFromPosition(l2),o3=this.locationFromPosition(r3),e3=this,u2=e3.getBlockAtIndex(c3.index),(c3.offset=u2.findLineBreakInDirectionFromPosition("backward",c3.offset))!=null&&(s4=e3.positionFromLocation(c3),e3=e3.insertBlockBreakAtRange([s4,s4+1]),o3.index+=1,o3.offset-=e3.getBlockAtIndex(c3.index).getLength(),c3.index+=1),c3.offset=0,o3.offset===0&&o3.index>c3.index?(o3.index-=1,o3.offset=e3.getBlockAtIndex(o3.index).getBlockBreakPosition()):(n3=e3.getBlockAtIndex(o3.index),n3.text.getStringAtRange([o3.offset-1,o3.offset])==="\n"?o3.offset-=1:o3.offset=n3.findLineBreakInDirectionFromPosition("forward",o3.offset),o3.offset!==n3.getBlockBreakPosition()&&(s4=e3.positionFromLocation(o3),e3=e3.insertBlockBreakAtRange([s4,s4+1]))),l2=e3.positionFromLocation(c3),r3=e3.positionFromLocation(o3),t4=i([l2,r3]),{document:e3,range:t4};},c2.prototype.convertLineBreaksToBlockBreaksInRange=function(t4){var e3,n3,o3;return n3=(t4=i(t4))[0],o3=this.getStringAtRange(t4).slice(0,-1),e3=this,o3.replace(/.*?\n/g,function(t5){return n3+=t5.length,e3=e3.insertBlockBreakAtRange([n3-1,n3]);}),{document:e3,range:t4};},c2.prototype.consolidateBlocksAtRange=function(t4){var e3,n3,o3,r3,s4;return o3=t4=i(t4),s4=o3[0],n3=o3[1],r3=this.locationFromPosition(s4).index,e3=this.locationFromPosition(n3).index,new this.constructor(this.blockList.consolidateFromIndexToIndex(r3,e3));},c2.prototype.getDocumentAtRange=function(t4){var e3;return t4=i(t4),e3=this.blockList.getSplittableListInRange(t4).toArray(),new this.constructor(e3);},c2.prototype.getStringAtRange=function(t4){var e3,n3,o3;return o3=t4=i(t4),n3=o3[o3.length-1],n3!==this.getLength()&&(e3=-1),this.getDocumentAtRange(t4).toString().slice(0,e3);},c2.prototype.getBlockAtIndex=function(t4){return this.blockList.getObjectAtIndex(t4);},c2.prototype.getBlockAtPosition=function(t4){var e3;return e3=this.locationFromPosition(t4).index,this.getBlockAtIndex(e3);},c2.prototype.getTextAtIndex=function(t4){var e3;return(e3=this.getBlockAtIndex(t4))!=null?e3.text:void 0;},c2.prototype.getTextAtPosition=function(t4){var e3;return e3=this.locationFromPosition(t4).index,this.getTextAtIndex(e3);},c2.prototype.getPieceAtPosition=function(t4){var e3,n3,i2;return i2=this.locationFromPosition(t4),e3=i2.index,n3=i2.offset,this.getTextAtIndex(e3).getPieceAtPosition(n3);},c2.prototype.getCharacterAtPosition=function(t4){var e3,n3,i2;return i2=this.locationFromPosition(t4),e3=i2.index,n3=i2.offset,this.getTextAtIndex(e3).getStringAtRange([n3,n3+1]);},c2.prototype.getLength=function(){return this.blockList.getEndPosition();},c2.prototype.getBlocks=function(){return this.blockList.toArray();},c2.prototype.getBlockCount=function(){return this.blockList.length;},c2.prototype.getEditCount=function(){return this.editCount;},c2.prototype.eachBlock=function(t4){return this.blockList.eachObject(t4);},c2.prototype.eachBlockAtRange=function(t4,e3){var n3,o3,r3,s4,a3,u2,c3,l2,h,p2,d,f;if(u2=t4=i(t4),d=u2[0],r3=u2[1],p2=this.locationFromPosition(d),o3=this.locationFromPosition(r3),p2.index===o3.index)return n3=this.getBlockAtIndex(p2.index),f=[p2.offset,o3.offset],e3(n3,f,p2.index);for(h=[],a3=s4=c3=p2.index,l2=o3.index;l2>=c3?l2>=s4:s4>=l2;a3=l2>=c3?++s4:--s4){(n3=this.getBlockAtIndex(a3))?(f=function(){switch(a3){case p2.index:return[p2.offset,n3.text.getLength()];case o3.index:return[0,o3.offset];default:return[0,n3.text.getLength()];}}(),h.push(e3(n3,f,a3))):h.push(void 0);}return h;},c2.prototype.getCommonAttributesAtRange=function(t4){var n3,r3,s4;return r3=(t4=i(t4))[0],o2(t4)?this.getCommonAttributesAtPosition(r3):(s4=[],n3=[],this.eachBlockAtRange(t4,function(t5,e3){return e3[0]!==e3[1]?(s4.push(t5.text.getCommonAttributesAtRange(e3)),n3.push(l(t5))):void 0;}),e2.Hash.fromCommonAttributesOfObjects(s4).merge(e2.Hash.fromCommonAttributesOfObjects(n3)).toObject());},c2.prototype.getCommonAttributesAtPosition=function(t4){var n3,i2,o3,r3,s4,a3,c3,h,p2,d;if(p2=this.locationFromPosition(t4),s4=p2.index,h=p2.offset,o3=this.getBlockAtIndex(s4),!o3)return{};r3=l(o3),n3=o3.text.getAttributesAtPosition(h),i2=o3.text.getAttributesAtPosition(h-1),a3=function(){var t5,n4;t5=e2.config.textAttributes,n4=[];for(c3 in t5){d=t5[c3],d.inheritable&&n4.push(c3);}return n4;}();for(c3 in i2){d=i2[c3],(d===n3[c3]||u.call(a3,c3)>=0)&&(r3[c3]=d);}return r3;},c2.prototype.getRangeOfCommonAttributeAtPosition=function(t4,e3){var n3,o3,r3,s4,a3,u2,c3,l2,h;return a3=this.locationFromPosition(e3),r3=a3.index,s4=a3.offset,h=this.getTextAtIndex(r3),u2=h.getExpandedRangeForAttributeAtOffset(t4,s4),l2=u2[0],o3=u2[1],c3=this.positionFromLocation({index:r3,offset:l2}),n3=this.positionFromLocation({index:r3,offset:o3}),i([c3,n3]);},c2.prototype.getBaseBlockAttributes=function(){var t4,e3,n3,i2,o3,r3,s4;for(t4=this.getBlockAtIndex(0).getAttributes(),n3=i2=1,s4=this.getBlockCount();s4>=1?s4>i2:i2>s4;n3=s4>=1?++i2:--i2){e3=this.getBlockAtIndex(n3).getAttributes(),r3=Math.min(t4.length,e3.length),t4=function(){var n4,i3,s5;for(s5=[],o3=n4=0,i3=r3;(i3>=0?i3>n4:n4>i3)&&e3[o3]===t4[o3];o3=i3>=0?++n4:--n4){s5.push(e3[o3]);}return s5;}();}return t4;},l=function l(t4){var e3,n3;return n3={},(e3=t4.getLastAttribute())&&(n3[e3]=true),n3;},c2.prototype.getAttachmentById=function(t4){var e3,n3,i2,o3;for(o3=this.getAttachments(),n3=0,i2=o3.length;i2>n3;n3++){if(e3=o3[n3],e3.id===t4)return e3;}},c2.prototype.getAttachmentPieces=function(){var t4;return t4=[],this.blockList.eachObject(function(e3){var n3;return n3=e3.text,t4=t4.concat(n3.getAttachmentPieces());}),t4;},c2.prototype.getAttachments=function(){var t4,e3,n3,i2,o3;for(i2=this.getAttachmentPieces(),o3=[],t4=0,e3=i2.length;e3>t4;t4++){n3=i2[t4],o3.push(n3.attachment);}return o3;},c2.prototype.getRangeOfAttachment=function(t4){var e3,n3,o3,r3,s4,a3,u2;for(r3=0,s4=this.blockList.toArray(),n3=e3=0,o3=s4.length;o3>e3;n3=++e3){if(a3=s4[n3].text,u2=a3.getRangeOfAttachment(t4))return i([r3+u2[0],r3+u2[1]]);r3+=a3.getLength();}},c2.prototype.getLocationRangeOfAttachment=function(t4){var e3;return e3=this.getRangeOfAttachment(t4),this.locationRangeFromRange(e3);},c2.prototype.getAttachmentPieceForAttachment=function(t4){var e3,n3,i2,o3;for(o3=this.getAttachmentPieces(),e3=0,n3=o3.length;n3>e3;e3++){if(i2=o3[e3],i2.attachment===t4)return i2;}},c2.prototype.findRangesForBlockAttribute=function(t4){var e3,n3,i2,o3,r3,s4,a3;for(r3=0,s4=[],a3=this.getBlocks(),n3=0,i2=a3.length;i2>n3;n3++){e3=a3[n3],o3=e3.getLength(),e3.hasAttribute(t4)&&s4.push([r3,r3+o3]),r3+=o3;}return s4;},c2.prototype.findRangesForTextAttribute=function(t4,e3){var n3,i2,o3,r3,s4,a3,u2,c3,l2,h;for(h=(e3!=null?e3:{}).withValue,a3=0,u2=[],c3=[],r3=function r3(e4){return h!=null?e4.getAttribute(t4)===h:e4.hasAttribute(t4);},l2=this.getPieces(),n3=0,i2=l2.length;i2>n3;n3++){s4=l2[n3],o3=s4.getLength(),r3(s4)&&(u2[1]===a3?u2[1]=a3+o3:c3.push(u2=[a3,a3+o3])),a3+=o3;}return c3;},c2.prototype.locationFromPosition=function(t4){var e3,n3;return n3=this.blockList.findIndexAndOffsetAtPosition(Math.max(0,t4)),n3.index!=null?n3:(e3=this.getBlocks(),{index:e3.length-1,offset:e3[e3.length-1].getLength()});},c2.prototype.positionFromLocation=function(t4){return this.blockList.findPositionAtIndexAndOffset(t4.index,t4.offset);},c2.prototype.locationRangeFromPosition=function(t4){return i(this.locationFromPosition(t4));},c2.prototype.locationRangeFromRange=function(t4){var e3,n3,o3,r3;if(t4=i(t4))return r3=t4[0],n3=t4[1],o3=this.locationFromPosition(r3),e3=this.locationFromPosition(n3),i([o3,e3]);},c2.prototype.rangeFromLocationRange=function(t4){var e3,n3;return t4=i(t4),e3=this.positionFromLocation(t4[0]),o2(t4)||(n3=this.positionFromLocation(t4[1])),i([e3,n3]);},c2.prototype.isEqualTo=function(t4){return this.blockList.isEqualTo(t4!=null?t4.blockList:void 0);},c2.prototype.getTexts=function(){var t4,e3,n3,i2,o3;for(i2=this.getBlocks(),o3=[],e3=0,n3=i2.length;n3>e3;e3++){t4=i2[e3],o3.push(t4.text);}return o3;},c2.prototype.getPieces=function(){var t4,e3,n3,i2,o3;for(n3=[],i2=this.getTexts(),t4=0,e3=i2.length;e3>t4;t4++){o3=i2[t4],n3.push.apply(n3,o3.getPieces());}return n3;},c2.prototype.getObjects=function(){return this.getBlocks().concat(this.getTexts()).concat(this.getPieces());},c2.prototype.toSerializableDocument=function(){var t4;return t4=[],this.blockList.eachObject(function(e3){return t4.push(e3.copyWithText(e3.text.toSerializableText()));}),new this.constructor(t4);},c2.prototype.toString=function(){return this.blockList.toString();},c2.prototype.toJSON=function(){return this.blockList.toJSON();},c2.prototype.toConsole=function(){var t4;return JSON.stringify(function(){var e3,n3,i2,o3;for(i2=this.blockList.toArray(),o3=[],e3=0,n3=i2.length;n3>e3;e3++){t4=i2[e3],o3.push(JSON.parse(t4.text.toConsole()));}return o3;}.call(this));},c2;}(e2.Object);}.call(this),function(){e2.LineBreakInsertion=function(){function t3(t4){var e3;this.composition=t4,this.document=this.composition.document,e3=this.composition.getSelectedRange(),this.startPosition=e3[0],this.endPosition=e3[1],this.startLocation=this.document.locationFromPosition(this.startPosition),this.endLocation=this.document.locationFromPosition(this.endPosition),this.block=this.document.getBlockAtIndex(this.endLocation.index),this.breaksOnReturn=this.block.breaksOnReturn(),this.previousCharacter=this.block.text.getStringAtPosition(this.endLocation.offset-1),this.nextCharacter=this.block.text.getStringAtPosition(this.endLocation.offset);}return t3.prototype.shouldInsertBlockBreak=function(){return this.block.hasAttributes()&&this.block.isListItem()&&!this.block.isEmpty()?this.startLocation.offset!==0:this.breaksOnReturn&&this.nextCharacter!=="\n";},t3.prototype.shouldBreakFormattedBlock=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&(this.breaksOnReturn&&this.nextCharacter==="\n"||this.previousCharacter==="\n");},t3.prototype.shouldDecreaseListLevel=function(){return this.block.hasAttributes()&&this.block.isListItem()&&this.block.isEmpty();},t3.prototype.shouldPrependListItem=function(){return this.block.isListItem()&&this.startLocation.offset===0&&!this.block.isEmpty();},t3.prototype.shouldRemoveLastBlockAttribute=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&this.block.isEmpty();},t3;}();}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2,l,h=function h(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){p2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},p2={}.hasOwnProperty;s2=e2.normalizeRange,c2=e2.rangesAreEqual,u=e2.rangeIsCollapsed,a2=e2.objectsAreEqual,t3=e2.arrayStartsWith,l=e2.summarizeArrayChange,i=e2.getAllAttributeNames,o2=e2.getBlockConfig,r2=e2.getTextConfig,n2=e2.extend,e2.Composition=function(p3){function d(){this.document=new e2.Document(),this.attachments=[],this.currentAttributes={},this.revision=0;}var f;return h(d,p3),d.prototype.setDocument=function(t4){var e3;return t4.isEqualTo(this.document)?void 0:(this.document=t4,this.refreshAttachments(),this.revision++,(e3=this.delegate)!=null&&typeof e3.compositionDidChangeDocument=="function"?e3.compositionDidChangeDocument(t4):void 0);},d.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.getSelectedRange()};},d.prototype.loadSnapshot=function(t4){var n3,i2,o3,r3;return n3=t4.document,r3=t4.selectedRange,(i2=this.delegate)!=null&&typeof i2.compositionWillLoadSnapshot=="function"&&i2.compositionWillLoadSnapshot(),this.setDocument(n3!=null?n3:new e2.Document()),this.setSelection(r3!=null?r3:[0,0]),(o3=this.delegate)!=null&&typeof o3.compositionDidLoadSnapshot=="function"?o3.compositionDidLoadSnapshot():void 0;},d.prototype.insertText=function(t4,e3){var n3,i2,o3,r3;return r3=(e3!=null?e3:{updatePosition:true}).updatePosition,i2=this.getSelectedRange(),this.setDocument(this.document.insertTextAtRange(t4,i2)),o3=i2[0],n3=o3+t4.getLength(),r3&&this.setSelection(n3),this.notifyDelegateOfInsertionAtRange([o3,n3]);},d.prototype.insertBlock=function(t4){var n3;return t4==null&&(t4=new e2.Block()),n3=new e2.Document([t4]),this.insertDocument(n3);},d.prototype.insertDocument=function(t4){var n3,i2,o3;return t4==null&&(t4=new e2.Document()),i2=this.getSelectedRange(),this.setDocument(this.document.insertDocumentAtRange(t4,i2)),o3=i2[0],n3=o3+t4.getLength(),this.setSelection(n3),this.notifyDelegateOfInsertionAtRange([o3,n3]);},d.prototype.insertString=function(t4,n3){var i2,o3;return i2=this.getCurrentTextAttributes(),o3=e2.Text.textForStringWithAttributes(t4,i2),this.insertText(o3,n3);},d.prototype.insertBlockBreak=function(){var t4,e3,n3;return e3=this.getSelectedRange(),this.setDocument(this.document.insertBlockBreakAtRange(e3)),n3=e3[0],t4=n3+1,this.setSelection(t4),this.notifyDelegateOfInsertionAtRange([n3,t4]);},d.prototype.insertLineBreak=function(){var t4,n3;return n3=new e2.LineBreakInsertion(this),n3.shouldDecreaseListLevel()?(this.decreaseListLevel(),this.setSelection(n3.startPosition)):n3.shouldPrependListItem()?(t4=new e2.Document([n3.block.copyWithoutText()]),this.insertDocument(t4)):n3.shouldInsertBlockBreak()?this.insertBlockBreak():n3.shouldRemoveLastBlockAttribute()?this.removeLastBlockAttribute():n3.shouldBreakFormattedBlock()?this.breakFormattedBlock(n3):this.insertString("\n");},d.prototype.insertHTML=function(t4){var n3,i2,o3,r3;return n3=e2.Document.fromHTML(t4),o3=this.getSelectedRange(),this.setDocument(this.document.mergeDocumentAtRange(n3,o3)),r3=o3[0],i2=r3+n3.getLength()-1,this.setSelection(i2),this.notifyDelegateOfInsertionAtRange([r3,i2]);},d.prototype.replaceHTML=function(t4){var n3,i2,o3;return n3=e2.Document.fromHTML(t4).copyUsingObjectsFromDocument(this.document),i2=this.getLocationRange({strict:false}),o3=this.document.rangeFromLocationRange(i2),this.setDocument(n3),this.setSelection(o3);},d.prototype.insertFile=function(t4){return this.insertFiles([t4]);},d.prototype.insertFiles=function(t4){var n3,i2,o3,r3,s3,a3;for(i2=[],r3=0,s3=t4.length;s3>r3;r3++){o3=t4[r3],((a3=this.delegate)!=null?a3.compositionShouldAcceptFile(o3):void 0)&&(n3=e2.Attachment.attachmentForFile(o3),i2.push(n3));}return this.insertAttachments(i2);},d.prototype.insertAttachment=function(t4){return this.insertAttachments([t4]);},d.prototype.insertAttachments=function(t4){var n3,i2,o3,r3,s3,a3,u2,c3,l2;for(c3=new e2.Text(),r3=0,s3=t4.length;s3>r3;r3++){n3=t4[r3],l2=n3.getType(),a3=(u2=e2.config.attachments[l2])!=null?u2.presentation:void 0,o3=this.getCurrentTextAttributes(),a3&&(o3.presentation=a3),i2=e2.Text.textForAttachmentWithAttributes(n3,o3),c3=c3.appendText(i2);}return this.insertText(c3);},d.prototype.shouldManageDeletingInDirection=function(t4){var e3;if(e3=this.getLocationRange(),u(e3)){if(t4==="backward"&&e3[0].offset===0)return true;if(this.shouldManageMovingCursorInDirection(t4))return true;}else if(e3[0].index!==e3[1].index)return true;return false;},d.prototype.deleteInDirection=function(t4,e3){var n3,i2,o3,r3,s3,a3,c3,l2;return r3=(e3!=null?e3:{}).length,s3=this.getLocationRange(),a3=this.getSelectedRange(),c3=u(a3),c3?o3=t4==="backward"&&s3[0].offset===0:l2=s3[0].index!==s3[1].index,o3&&this.canDecreaseBlockAttributeLevel()&&(i2=this.getBlock(),i2.isListItem()?this.decreaseListLevel():this.decreaseBlockAttributeLevel(),this.setSelection(a3[0]),i2.isEmpty())?false:(c3&&(a3=this.getExpandedRangeInDirection(t4,{length:r3}),t4==="backward"&&(n3=this.getAttachmentAtRange(a3))),n3?(this.editAttachment(n3),false):(this.setDocument(this.document.removeTextAtRange(a3)),this.setSelection(a3[0]),o3||l2?false:void 0));},d.prototype.moveTextFromRange=function(t4){var e3;return e3=this.getSelectedRange()[0],this.setDocument(this.document.moveTextFromRangeToPosition(t4,e3)),this.setSelection(e3);},d.prototype.removeAttachment=function(t4){var e3;return(e3=this.document.getRangeOfAttachment(t4))?(this.stopEditingAttachment(),this.setDocument(this.document.removeTextAtRange(e3)),this.setSelection(e3[0])):void 0;},d.prototype.removeLastBlockAttribute=function(){var t4,e3,n3,i2;return n3=this.getSelectedRange(),i2=n3[0],e3=n3[1],t4=this.document.getBlockAtPosition(e3),this.removeCurrentAttribute(t4.getLastAttribute()),this.setSelection(i2);},f=" ",d.prototype.insertPlaceholder=function(){return this.placeholderPosition=this.getPosition(),this.insertString(f);},d.prototype.selectPlaceholder=function(){return this.placeholderPosition!=null?(this.setSelectedRange([this.placeholderPosition,this.placeholderPosition+f.length]),this.getSelectedRange()):void 0;},d.prototype.forgetPlaceholder=function(){return this.placeholderPosition=null;},d.prototype.hasCurrentAttribute=function(t4){var e3;return e3=this.currentAttributes[t4],e3!=null&&e3!==false;},d.prototype.toggleCurrentAttribute=function(t4){var e3;return(e3=!this.currentAttributes[t4])?this.setCurrentAttribute(t4,e3):this.removeCurrentAttribute(t4);},d.prototype.canSetCurrentAttribute=function(t4){return o2(t4)?this.canSetCurrentBlockAttribute(t4):this.canSetCurrentTextAttribute(t4);},d.prototype.canSetCurrentTextAttribute=function(){var t4,e3,n3,i2,o3;if(e3=this.getSelectedDocument()){for(o3=e3.getAttachments(),n3=0,i2=o3.length;i2>n3;n3++){if(t4=o3[n3],!t4.hasContent())return false;}return true;}},d.prototype.canSetCurrentBlockAttribute=function(){var t4;if(t4=this.getBlock())return!t4.isTerminalBlock();},d.prototype.setCurrentAttribute=function(t4,e3){return o2(t4)?this.setBlockAttribute(t4,e3):(this.setTextAttribute(t4,e3),this.currentAttributes[t4]=e3,this.notifyDelegateOfCurrentAttributesChange());},d.prototype.setTextAttribute=function(t4,n3){var i2,o3,r3,s3;if(o3=this.getSelectedRange())return r3=o3[0],i2=o3[1],r3!==i2?this.setDocument(this.document.addAttributeAtRange(t4,n3,o3)):t4==="href"?(s3=e2.Text.textForStringWithAttributes(n3,{href:n3}),this.insertText(s3)):void 0;},d.prototype.setBlockAttribute=function(t4,e3){var n3,i2;if(i2=this.getSelectedRange())return this.canSetCurrentAttribute(t4)?(n3=this.getBlock(),this.setDocument(this.document.applyBlockAttributeAtRange(t4,e3,i2)),this.setSelection(i2)):void 0;},d.prototype.removeCurrentAttribute=function(t4){return o2(t4)?(this.removeBlockAttribute(t4),this.updateCurrentAttributes()):(this.removeTextAttribute(t4),delete this.currentAttributes[t4],this.notifyDelegateOfCurrentAttributesChange());},d.prototype.removeTextAttribute=function(t4){var e3;if(e3=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t4,e3));},d.prototype.removeBlockAttribute=function(t4){var e3;if(e3=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t4,e3));},d.prototype.canDecreaseNestingLevel=function(){var t4;return((t4=this.getBlock())!=null?t4.getNestingLevel():void 0)>0;},d.prototype.canIncreaseNestingLevel=function(){var e3,n3,i2;if(e3=this.getBlock())return((i2=o2(e3.getLastNestableAttribute()))!=null?i2.listAttribute:0)?(n3=this.getPreviousBlock())?t3(n3.getListItemAttributes(),e3.getListItemAttributes()):void 0:e3.getNestingLevel()>0;},d.prototype.decreaseNestingLevel=function(){var t4;if(t4=this.getBlock())return this.setDocument(this.document.replaceBlock(t4,t4.decreaseNestingLevel()));},d.prototype.increaseNestingLevel=function(){var t4;if(t4=this.getBlock())return this.setDocument(this.document.replaceBlock(t4,t4.increaseNestingLevel()));},d.prototype.canDecreaseBlockAttributeLevel=function(){var t4;return((t4=this.getBlock())!=null?t4.getAttributeLevel():void 0)>0;},d.prototype.decreaseBlockAttributeLevel=function(){var t4,e3;return(t4=(e3=this.getBlock())!=null?e3.getLastAttribute():void 0)?this.removeCurrentAttribute(t4):void 0;},d.prototype.decreaseListLevel=function(){var t4,e3,n3,i2,o3,r3;for(r3=this.getSelectedRange()[0],o3=this.document.locationFromPosition(r3).index,n3=o3,t4=this.getBlock().getAttributeLevel();(e3=this.document.getBlockAtIndex(n3+1))&&e3.isListItem()&&e3.getAttributeLevel()>t4;){n3++;}return r3=this.document.positionFromLocation({index:o3,offset:0}),i2=this.document.positionFromLocation({index:n3,offset:0}),this.setDocument(this.document.removeLastListAttributeAtRange([r3,i2]));},d.prototype.updateCurrentAttributes=function(){var t4,e3,n3,o3,r3,s3;if(s3=this.getSelectedRange({ignoreLock:true})){for(e3=this.document.getCommonAttributesAtRange(s3),r3=i(),n3=0,o3=r3.length;o3>n3;n3++){t4=r3[n3],e3[t4]||this.canSetCurrentAttribute(t4)||(e3[t4]=false);}if(!a2(e3,this.currentAttributes))return this.currentAttributes=e3,this.notifyDelegateOfCurrentAttributesChange();}},d.prototype.getCurrentAttributes=function(){return n2.call({},this.currentAttributes);},d.prototype.getCurrentTextAttributes=function(){var t4,e3,n3,i2;t4={},n3=this.currentAttributes;for(e3 in n3){i2=n3[e3],i2!==false&&r2(e3)&&(t4[e3]=i2);}return t4;},d.prototype.freezeSelection=function(){return this.setCurrentAttribute("frozen",true);},d.prototype.thawSelection=function(){return this.removeCurrentAttribute("frozen");},d.prototype.hasFrozenSelection=function(){return this.hasCurrentAttribute("frozen");},d.proxyMethod("getSelectionManager().getPointRange"),d.proxyMethod("getSelectionManager().setLocationRangeFromPointRange"),d.proxyMethod("getSelectionManager().createLocationRangeFromDOMRange"),d.proxyMethod("getSelectionManager().locationIsCursorTarget"),d.proxyMethod("getSelectionManager().selectionIsExpanded"),d.proxyMethod("delegate?.getSelectionManager"),d.prototype.setSelection=function(t4){var e3,n3;return e3=this.document.locationRangeFromRange(t4),(n3=this.delegate)!=null?n3.compositionDidRequestChangingSelectionToLocationRange(e3):void 0;},d.prototype.getSelectedRange=function(){var t4;return(t4=this.getLocationRange())?this.document.rangeFromLocationRange(t4):void 0;},d.prototype.setSelectedRange=function(t4){var e3;return e3=this.document.locationRangeFromRange(t4),this.getSelectionManager().setLocationRange(e3);},d.prototype.getPosition=function(){var t4;return(t4=this.getLocationRange())?this.document.positionFromLocation(t4[0]):void 0;},d.prototype.getLocationRange=function(t4){var e3,n3;return(e3=(n3=this.targetLocationRange)!=null?n3:this.getSelectionManager().getLocationRange(t4))!=null?e3:s2({index:0,offset:0});},d.prototype.withTargetLocationRange=function(t4,e3){var n3;this.targetLocationRange=t4;try{n3=e3();}finally{this.targetLocationRange=null;}return n3;},d.prototype.withTargetRange=function(t4,e3){var n3;return n3=this.document.locationRangeFromRange(t4),this.withTargetLocationRange(n3,e3);},d.prototype.withTargetDOMRange=function(t4,e3){var n3;return n3=this.createLocationRangeFromDOMRange(t4,{strict:false}),this.withTargetLocationRange(n3,e3);},d.prototype.getExpandedRangeInDirection=function(t4,e3){var n3,i2,o3,r3;return i2=(e3!=null?e3:{}).length,o3=this.getSelectedRange(),r3=o3[0],n3=o3[1],t4==="backward"?i2?r3-=i2:r3=this.translateUTF16PositionFromOffset(r3,-1):i2?n3+=i2:n3=this.translateUTF16PositionFromOffset(n3,1),s2([r3,n3]);},d.prototype.shouldManageMovingCursorInDirection=function(t4){var e3;return this.editingAttachment?true:(e3=this.getExpandedRangeInDirection(t4),this.getAttachmentAtRange(e3)!=null);},d.prototype.moveCursorInDirection=function(t4){var e3,n3,i2,o3;return this.editingAttachment?i2=this.document.getRangeOfAttachment(this.editingAttachment):(o3=this.getSelectedRange(),i2=this.getExpandedRangeInDirection(t4),n3=!c2(o3,i2)),this.setSelectedRange(t4==="backward"?i2[0]:i2[1]),n3&&(e3=this.getAttachmentAtRange(i2))?this.editAttachment(e3):void 0;},d.prototype.expandSelectionInDirection=function(t4,e3){var n3,i2;return n3=(e3!=null?e3:{}).length,i2=this.getExpandedRangeInDirection(t4,{length:n3}),this.setSelectedRange(i2);},d.prototype.expandSelectionForEditing=function(){return this.hasCurrentAttribute("href")?this.expandSelectionAroundCommonAttribute("href"):void 0;},d.prototype.expandSelectionAroundCommonAttribute=function(t4){var e3,n3;return e3=this.getPosition(),n3=this.document.getRangeOfCommonAttributeAtPosition(t4,e3),this.setSelectedRange(n3);},d.prototype.selectionContainsAttachments=function(){var t4;return((t4=this.getSelectedAttachments())!=null?t4.length:void 0)>0;},d.prototype.selectionIsInCursorTarget=function(){return this.editingAttachment||this.positionIsCursorTarget(this.getPosition());},d.prototype.positionIsCursorTarget=function(t4){var e3;return(e3=this.document.locationFromPosition(t4))?this.locationIsCursorTarget(e3):void 0;},d.prototype.positionIsBlockBreak=function(t4){var e3;return(e3=this.document.getPieceAtPosition(t4))!=null?e3.isBlockBreak():void 0;},d.prototype.getSelectedDocument=function(){var t4;return(t4=this.getSelectedRange())?this.document.getDocumentAtRange(t4):void 0;},d.prototype.getSelectedAttachments=function(){var t4;return(t4=this.getSelectedDocument())!=null?t4.getAttachments():void 0;},d.prototype.getAttachments=function(){return this.attachments.slice(0);},d.prototype.refreshAttachments=function(){var t4,e3,n3,i2,o3,r3,s3,a3,u2,c3,h2,p4;for(n3=this.document.getAttachments(),a3=l(this.attachments,n3),t4=a3.added,h2=a3.removed,this.attachments=n3,i2=0,r3=h2.length;r3>i2;i2++){e3=h2[i2],e3.delegate=null,(u2=this.delegate)!=null&&typeof u2.compositionDidRemoveAttachment=="function"&&u2.compositionDidRemoveAttachment(e3);}for(p4=[],o3=0,s3=t4.length;s3>o3;o3++){e3=t4[o3],e3.delegate=this,p4.push((c3=this.delegate)!=null&&typeof c3.compositionDidAddAttachment=="function"?c3.compositionDidAddAttachment(e3):void 0);}return p4;},d.prototype.attachmentDidChangeAttributes=function(t4){var e3;return this.revision++,(e3=this.delegate)!=null&&typeof e3.compositionDidEditAttachment=="function"?e3.compositionDidEditAttachment(t4):void 0;},d.prototype.attachmentDidChangePreviewURL=function(t4){var e3;return this.revision++,(e3=this.delegate)!=null&&typeof e3.compositionDidChangeAttachmentPreviewURL=="function"?e3.compositionDidChangeAttachmentPreviewURL(t4):void 0;},d.prototype.editAttachment=function(t4,e3){var n3;if(t4!==this.editingAttachment)return this.stopEditingAttachment(),this.editingAttachment=t4,(n3=this.delegate)!=null&&typeof n3.compositionDidStartEditingAttachment=="function"?n3.compositionDidStartEditingAttachment(this.editingAttachment,e3):void 0;},d.prototype.stopEditingAttachment=function(){var t4;if(this.editingAttachment)return(t4=this.delegate)!=null&&typeof t4.compositionDidStopEditingAttachment=="function"&&t4.compositionDidStopEditingAttachment(this.editingAttachment),this.editingAttachment=null;},d.prototype.updateAttributesForAttachment=function(t4,e3){return this.setDocument(this.document.updateAttributesForAttachment(t4,e3));},d.prototype.removeAttributeForAttachment=function(t4,e3){return this.setDocument(this.document.removeAttributeForAttachment(t4,e3));},d.prototype.breakFormattedBlock=function(t4){var n3,i2,o3,r3,s3;return i2=t4.document,n3=t4.block,r3=t4.startPosition,s3=[r3-1,r3],n3.getBlockBreakPosition()===t4.startLocation.offset?(n3.breaksOnReturn()&&t4.nextCharacter==="\n"?r3+=1:i2=i2.removeTextAtRange(s3),s3=[r3,r3]):t4.nextCharacter==="\n"?t4.previousCharacter==="\n"?s3=[r3-1,r3+1]:(s3=[r3,r3+1],r3+=1):t4.startLocation.offset-1!==0&&(r3+=1),o3=new e2.Document([n3.removeLastAttribute().copyWithoutText()]),this.setDocument(i2.insertDocumentAtRange(o3,s3)),this.setSelection(r3);},d.prototype.getPreviousBlock=function(){var t4,e3;return(e3=this.getLocationRange())&&(t4=e3[0].index,t4>0)?this.document.getBlockAtIndex(t4-1):void 0;},d.prototype.getBlock=function(){var t4;return(t4=this.getLocationRange())?this.document.getBlockAtIndex(t4[0].index):void 0;},d.prototype.getAttachmentAtRange=function(t4){var n3;return n3=this.document.getDocumentAtRange(t4),n3.toString()===e2.OBJECT_REPLACEMENT_CHARACTER+"\n"?n3.getAttachments()[0]:void 0;},d.prototype.notifyDelegateOfCurrentAttributesChange=function(){var t4;return(t4=this.delegate)!=null&&typeof t4.compositionDidChangeCurrentAttributes=="function"?t4.compositionDidChangeCurrentAttributes(this.currentAttributes):void 0;},d.prototype.notifyDelegateOfInsertionAtRange=function(t4){var e3;return(e3=this.delegate)!=null&&typeof e3.compositionDidPerformInsertionAtRange=="function"?e3.compositionDidPerformInsertionAtRange(t4):void 0;},d.prototype.translateUTF16PositionFromOffset=function(t4,e3){var n3,i2;return i2=this.document.toUTF16String(),n3=i2.offsetFromUCS2Offset(t4),i2.offsetToUCS2Offset(n3+e3);},d;}(e2.BasicObject);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.UndoManager=function(e3){function n3(t4){this.composition=t4,this.undoEntries=[],this.redoEntries=[];}var i;return t3(n3,e3),n3.prototype.recordUndoEntry=function(t4,e4){var n4,o2,r2,s2,a2;return s2=e4!=null?e4:{},o2=s2.context,n4=s2.consolidatable,r2=this.undoEntries.slice(-1)[0],n4&&i(r2,t4,o2)?void 0:(a2=this.createEntry({description:t4,context:o2}),this.undoEntries.push(a2),this.redoEntries=[]);},n3.prototype.undo=function(){var t4,e4;return(e4=this.undoEntries.pop())?(t4=this.createEntry(e4),this.redoEntries.push(t4),this.composition.loadSnapshot(e4.snapshot)):void 0;},n3.prototype.redo=function(){var t4,e4;return(t4=this.redoEntries.pop())?(e4=this.createEntry(t4),this.undoEntries.push(e4),this.composition.loadSnapshot(t4.snapshot)):void 0;},n3.prototype.canUndo=function(){return this.undoEntries.length>0;},n3.prototype.canRedo=function(){return this.redoEntries.length>0;},n3.prototype.createEntry=function(t4){var e4,n4,i2;return i2=t4!=null?t4:{},n4=i2.description,e4=i2.context,{description:n4!=null?n4.toString():void 0,context:JSON.stringify(e4),snapshot:this.composition.getSnapshot()};},i=function i(t4,e4,n4){return(t4!=null?t4.description:void 0)===(e4!=null?e4.toString():void 0)&&(t4!=null?t4.context:void 0)===JSON.stringify(n4);},n3;}(e2.BasicObject);}.call(this),function(){var t3;e2.attachmentGalleryFilter=function(e3){var n2;return n2=new t3(e3),n2.perform(),n2.getSnapshot();},t3=function(){function t4(t5){this.document=t5.document,this.selectedRange=t5.selectedRange;}var e3,n2,i;return e3="attachmentGallery",n2="presentation",i="gallery",t4.prototype.perform=function(){return this.removeBlockAttribute(),this.applyBlockAttribute();},t4.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.selectedRange};},t4.prototype.removeBlockAttribute=function(){var t5,n3,i2,o2,r2;for(o2=this.findRangesOfBlocks(),r2=[],t5=0,n3=o2.length;n3>t5;t5++){i2=o2[t5],r2.push(this.document=this.document.removeAttributeAtRange(e3,i2));}return r2;},t4.prototype.applyBlockAttribute=function(){var t5,n3,i2,o2,r2,s2;for(i2=0,r2=this.findRangesOfPieces(),s2=[],t5=0,n3=r2.length;n3>t5;t5++){o2=r2[t5],o2[1]-o2[0]>1&&(o2[0]+=i2,o2[1]+=i2,this.document.getCharacterAtPosition(o2[1])!=="\n"&&(this.document=this.document.insertBlockBreakAtRange(o2[1]),o2[1]<this.selectedRange[1]&&this.moveSelectedRangeForward(),o2[1]++,i2++),o2[0]!==0&&this.document.getCharacterAtPosition(o2[0]-1)!=="\n"&&(this.document=this.document.insertBlockBreakAtRange(o2[0]),o2[0]<this.selectedRange[0]&&this.moveSelectedRangeForward(),o2[0]++,i2++),s2.push(this.document=this.document.applyBlockAttributeAtRange(e3,true,o2)));}return s2;},t4.prototype.findRangesOfBlocks=function(){return this.document.findRangesForBlockAttribute(e3);},t4.prototype.findRangesOfPieces=function(){return this.document.findRangesForTextAttribute(n2,{withValue:i});},t4.prototype.moveSelectedRangeForward=function(){return this.selectedRange[0]+=1,this.selectedRange[1]+=1;},t4;}();}.call(this),function(){var t3=function t3(t4,e3){return function(){return t4.apply(e3,arguments);};};e2.Editor=function(){function n2(n3,o2,r2){this.composition=n3,this.selectionManager=o2,this.element=r2,this.insertFiles=t3(this.insertFiles,this),this.undoManager=new e2.UndoManager(this.composition),this.filters=i.slice(0);}var i;return i=[e2.attachmentGalleryFilter],n2.prototype.loadDocument=function(t4){return this.loadSnapshot({document:t4,selectedRange:[0,0]});},n2.prototype.loadHTML=function(t4){return t4==null&&(t4=""),this.loadDocument(e2.Document.fromHTML(t4,{referenceElement:this.element}));},n2.prototype.loadJSON=function(t4){var n3,i2;return n3=t4.document,i2=t4.selectedRange,n3=e2.Document.fromJSON(n3),this.loadSnapshot({document:n3,selectedRange:i2});},n2.prototype.loadSnapshot=function(t4){return this.undoManager=new e2.UndoManager(this.composition),this.composition.loadSnapshot(t4);},n2.prototype.getDocument=function(){return this.composition.document;},n2.prototype.getSelectedDocument=function(){return this.composition.getSelectedDocument();},n2.prototype.getSnapshot=function(){return this.composition.getSnapshot();},n2.prototype.toJSON=function(){return this.getSnapshot();},n2.prototype.deleteInDirection=function(t4){return this.composition.deleteInDirection(t4);},n2.prototype.insertAttachment=function(t4){return this.composition.insertAttachment(t4);},n2.prototype.insertAttachments=function(t4){return this.composition.insertAttachments(t4);},n2.prototype.insertDocument=function(t4){return this.composition.insertDocument(t4);},n2.prototype.insertFile=function(t4){return this.composition.insertFile(t4);},n2.prototype.insertFiles=function(t4){return this.composition.insertFiles(t4);},n2.prototype.insertHTML=function(t4){return this.composition.insertHTML(t4);},n2.prototype.insertString=function(t4){return this.composition.insertString(t4);},n2.prototype.insertText=function(t4){return this.composition.insertText(t4);},n2.prototype.insertLineBreak=function(){return this.composition.insertLineBreak();},n2.prototype.getSelectedRange=function(){return this.composition.getSelectedRange();},n2.prototype.getPosition=function(){return this.composition.getPosition();},n2.prototype.getClientRectAtPosition=function(t4){var e3;return e3=this.getDocument().locationRangeFromRange([t4,t4+1]),this.selectionManager.getClientRectAtLocationRange(e3);},n2.prototype.expandSelectionInDirection=function(t4){return this.composition.expandSelectionInDirection(t4);},n2.prototype.moveCursorInDirection=function(t4){return this.composition.moveCursorInDirection(t4);},n2.prototype.setSelectedRange=function(t4){return this.composition.setSelectedRange(t4);},n2.prototype.activateAttribute=function(t4,e3){return e3==null&&(e3=true),this.composition.setCurrentAttribute(t4,e3);},n2.prototype.attributeIsActive=function(t4){return this.composition.hasCurrentAttribute(t4);},n2.prototype.canActivateAttribute=function(t4){return this.composition.canSetCurrentAttribute(t4);},n2.prototype.deactivateAttribute=function(t4){return this.composition.removeCurrentAttribute(t4);},n2.prototype.canDecreaseNestingLevel=function(){return this.composition.canDecreaseNestingLevel();},n2.prototype.canIncreaseNestingLevel=function(){return this.composition.canIncreaseNestingLevel();},n2.prototype.decreaseNestingLevel=function(){return this.canDecreaseNestingLevel()?this.composition.decreaseNestingLevel():void 0;},n2.prototype.increaseNestingLevel=function(){return this.canIncreaseNestingLevel()?this.composition.increaseNestingLevel():void 0;},n2.prototype.canRedo=function(){return this.undoManager.canRedo();},n2.prototype.canUndo=function(){return this.undoManager.canUndo();},n2.prototype.recordUndoEntry=function(t4,e3){var n3,i2,o2;return o2=e3!=null?e3:{},i2=o2.context,n3=o2.consolidatable,this.undoManager.recordUndoEntry(t4,{context:i2,consolidatable:n3});},n2.prototype.redo=function(){return this.canRedo()?this.undoManager.redo():void 0;},n2.prototype.undo=function(){return this.canUndo()?this.undoManager.undo():void 0;},n2;}();}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.ManagedAttachment=function(e3){function n3(t4,e4){var n4;this.attachmentManager=t4,this.attachment=e4,n4=this.attachment,this.id=n4.id,this.file=n4.file;}return t3(n3,e3),n3.prototype.remove=function(){return this.attachmentManager.requestRemovalOfAttachment(this.attachment);},n3.proxyMethod("attachment.getAttribute"),n3.proxyMethod("attachment.hasAttribute"),n3.proxyMethod("attachment.setAttribute"),n3.proxyMethod("attachment.getAttributes"),n3.proxyMethod("attachment.setAttributes"),n3.proxyMethod("attachment.isPending"),n3.proxyMethod("attachment.isPreviewable"),n3.proxyMethod("attachment.getURL"),n3.proxyMethod("attachment.getHref"),n3.proxyMethod("attachment.getFilename"),n3.proxyMethod("attachment.getFilesize"),n3.proxyMethod("attachment.getFormattedFilesize"),n3.proxyMethod("attachment.getExtension"),n3.proxyMethod("attachment.getContentType"),n3.proxyMethod("attachment.getFile"),n3.proxyMethod("attachment.setFile"),n3.proxyMethod("attachment.releaseFile"),n3.proxyMethod("attachment.getUploadProgress"),n3.proxyMethod("attachment.setUploadProgress"),n3;}(e2.BasicObject);}.call(this),function(){var t3=function t3(t4,e3){function i(){this.constructor=t4;}for(var o2 in e3){n2.call(e3,o2)&&(t4[o2]=e3[o2]);}return i.prototype=e3.prototype,t4.prototype=new i(),t4.__super__=e3.prototype,t4;},n2={}.hasOwnProperty;e2.AttachmentManager=function(n3){function i(t4){var e3,n4,i2;for(t4==null&&(t4=[]),this.managedAttachments={},n4=0,i2=t4.length;i2>n4;n4++){e3=t4[n4],this.manageAttachment(e3);}}return t3(i,n3),i.prototype.getAttachments=function(){var t4,e3,n4,i2;n4=this.managedAttachments,i2=[];for(e3 in n4){t4=n4[e3],i2.push(t4);}return i2;},i.prototype.manageAttachment=function(t4){var n4,i2;return(n4=this.managedAttachments)[i2=t4.id]!=null?n4[i2]:n4[i2]=new e2.ManagedAttachment(this,t4);},i.prototype.attachmentIsManaged=function(t4){return t4.id in this.managedAttachments;},i.prototype.requestRemovalOfAttachment=function(t4){var e3;return this.attachmentIsManaged(t4)&&(e3=this.delegate)!=null&&typeof e3.attachmentManagerDidRequestRemovalOfAttachment=="function"?e3.attachmentManagerDidRequestRemovalOfAttachment(t4):void 0;},i.prototype.unmanageAttachment=function(t4){var e3;return e3=this.managedAttachments[t4.id],delete this.managedAttachments[t4.id],e3;},i;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2,l,h;t3=e2.elementContainsNode,n2=e2.findChildIndexOfNode,r2=e2.nodeIsBlockStart,s2=e2.nodeIsBlockStartComment,o2=e2.nodeIsBlockContainer,a2=e2.nodeIsCursorTarget,u=e2.nodeIsEmptyTextNode,c2=e2.nodeIsTextNode,i=e2.nodeIsAttachmentElement,l=e2.tagName,h=e2.walkTree,e2.LocationMapper=function(){function e3(t4){this.element=t4;}var p2,d,f,g;return e3.prototype.findLocationFromContainerAndOffset=function(e4,i2,o3){var s3,u2,l2,p3,g2,m,v;for(m=(o3!=null?o3:{strict:true}).strict,u2=0,l2=false,p3={index:0,offset:0},(s3=this.findAttachmentElementParentForNode(e4))&&(e4=s3.parentNode,i2=n2(s3)),v=h(this.element,{usingFilter:f});v.nextNode();){if(g2=v.currentNode,g2===e4&&c2(e4)){a2(g2)||(p3.offset+=i2);break;}if(g2.parentNode===e4){if(u2++===i2)break;}else if(!t3(e4,g2)&&u2>0)break;r2(g2,{strict:m})?(l2&&p3.index++,p3.offset=0,l2=true):p3.offset+=d(g2);}return p3;},e3.prototype.findContainerAndOffsetFromLocation=function(t4){var e4,i2,s3,u2,l2;if(t4.index===0&&t4.offset===0){for(e4=this.element,u2=0;e4.firstChild;){if(e4=e4.firstChild,o2(e4)){u2=1;break;}}return[e4,u2];}if(l2=this.findNodeAndOffsetFromLocation(t4),i2=l2[0],s3=l2[1],i2){if(c2(i2))d(i2)===0?(e4=i2.parentNode.parentNode,u2=n2(i2.parentNode),a2(i2,{name:"right"})&&u2++):(e4=i2,u2=t4.offset-s3);else{if(e4=i2.parentNode,!r2(i2.previousSibling)&&!o2(e4))for(;i2===e4.lastChild&&(i2=e4,e4=e4.parentNode,!o2(e4));){;}u2=n2(i2),t4.offset!==0&&u2++;}return[e4,u2];}},e3.prototype.findNodeAndOffsetFromLocation=function(t4){var e4,n3,i2,o3,r3,s3,u2,l2;for(u2=0,l2=this.getSignificantNodesForIndex(t4.index),n3=0,i2=l2.length;i2>n3;n3++){if(e4=l2[n3],o3=d(e4),t4.offset<=u2+o3)if(c2(e4)){if(r3=e4,s3=u2,t4.offset===s3&&a2(r3))break;}else r3||(r3=e4,s3=u2);if(u2+=o3,u2>t4.offset)break;}return[r3,s3];},e3.prototype.findAttachmentElementParentForNode=function(t4){for(;t4&&t4!==this.element;){if(i(t4))return t4;t4=t4.parentNode;}},e3.prototype.getSignificantNodesForIndex=function(t4){var e4,n3,i2,o3,r3;for(i2=[],r3=h(this.element,{usingFilter:p2}),o3=false;r3.nextNode();){if(n3=r3.currentNode,s2(n3)){if(typeof e4!="undefined"&&e4!==null?e4++:e4=0,e4===t4)o3=true;else if(o3)break;}else o3&&i2.push(n3);}return i2;},d=function d(t4){var e4;return t4.nodeType===Node.TEXT_NODE?a2(t4)?0:(e4=t4.textContent,e4.length):l(t4)==="br"||i(t4)?1:0;},p2=function p2(t4){return g(t4)===NodeFilter.FILTER_ACCEPT?f(t4):NodeFilter.FILTER_REJECT;},g=function g(t4){return u(t4)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT;},f=function f(t4){return i(t4.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT;},e3;}();}.call(this),function(){var t3,n2,i=[].slice;t3=e2.getDOMRange,n2=e2.setDOMRange,e2.PointMapper=function(){function e3(){}return e3.prototype.createDOMRangeFromPoint=function(e4){var i2,o2,r2,s2,a2,u,c2,l;if(c2=e4.x,l=e4.y,document.caretPositionFromPoint)return a2=document.caretPositionFromPoint(c2,l),r2=a2.offsetNode,o2=a2.offset,i2=document.createRange(),i2.setStart(r2,o2),i2;if(document.caretRangeFromPoint)return document.caretRangeFromPoint(c2,l);if(document.body.createTextRange){s2=t3();try{u=document.body.createTextRange(),u.moveToPoint(c2,l),u.select();}catch(h){}return i2=t3(),n2(s2),i2;}},e3.prototype.getClientRectsForDOMRange=function(t4){var e4,n3,o2;return n3=i.call(t4.getClientRects()),o2=n3[0],e4=n3[n3.length-1],[o2,e4];},e3;}();}.call(this),function(){var t3,n2=function n2(t4,e3){return function(){return t4.apply(e3,arguments);};},i=function i(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){o2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},o2={}.hasOwnProperty,r2=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};t3=e2.getDOMRange,e2.SelectionChangeObserver=function(e3){function o3(){this.run=n2(this.run,this),this.update=n2(this.update,this),this.selectionManagers=[];}var s2;return i(o3,e3),o3.prototype.start=function(){return this.started?void 0:(this.started=true,"onselectionchange"in document?document.addEventListener("selectionchange",this.update,true):this.run());},o3.prototype.stop=function(){return this.started?(this.started=false,document.removeEventListener("selectionchange",this.update,true)):void 0;},o3.prototype.registerSelectionManager=function(t4){return r2.call(this.selectionManagers,t4)<0?(this.selectionManagers.push(t4),this.start()):void 0;},o3.prototype.unregisterSelectionManager=function(t4){var e4;return this.selectionManagers=function(){var n3,i2,o4,r3;for(o4=this.selectionManagers,r3=[],n3=0,i2=o4.length;i2>n3;n3++){e4=o4[n3],e4!==t4&&r3.push(e4);}return r3;}.call(this),this.selectionManagers.length===0?this.stop():void 0;},o3.prototype.notifySelectionManagersOfSelectionChange=function(){var t4,e4,n3,i2,o4;for(n3=this.selectionManagers,i2=[],t4=0,e4=n3.length;e4>t4;t4++){o4=n3[t4],i2.push(o4.selectionDidChange());}return i2;},o3.prototype.update=function(){var e4;return e4=t3(),s2(e4,this.domRange)?void 0:(this.domRange=e4,this.notifySelectionManagersOfSelectionChange());},o3.prototype.reset=function(){return this.domRange=null,this.update();},o3.prototype.run=function(){return this.started?(this.update(),requestAnimationFrame(this.run)):void 0;},s2=function s2(t4,e4){return(t4!=null?t4.startContainer:void 0)===(e4!=null?e4.startContainer:void 0)&&(t4!=null?t4.startOffset:void 0)===(e4!=null?e4.startOffset:void 0)&&(t4!=null?t4.endContainer:void 0)===(e4!=null?e4.endContainer:void 0)&&(t4!=null?t4.endOffset:void 0)===(e4!=null?e4.endOffset:void 0);},o3;}(e2.BasicObject),e2.selectionChangeObserver==null&&(e2.selectionChangeObserver=new e2.SelectionChangeObserver());}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u,c2,l,h=function h(t4,e3){return function(){return t4.apply(e3,arguments);};},p2=function p2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){d.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},d={}.hasOwnProperty;i=e2.getDOMSelection,n2=e2.getDOMRange,l=e2.setDOMRange,t3=e2.elementContainsNode,s2=e2.nodeIsCursorTarget,r2=e2.innerElementIsActive,o2=e2.handleEvent,a2=e2.normalizeRange,u=e2.rangeIsCollapsed,c2=e2.rangesAreEqual,e2.SelectionManager=function(d2){function f(t4){this.element=t4,this.selectionDidChange=h(this.selectionDidChange,this),this.didMouseDown=h(this.didMouseDown,this),this.locationMapper=new e2.LocationMapper(this.element),this.pointMapper=new e2.PointMapper(),this.lockCount=0,o2("mousedown",{onElement:this.element,withCallback:this.didMouseDown});}return p2(f,d2),f.prototype.getLocationRange=function(t4){var e3,i2;return t4==null&&(t4={}),e3=t4.strict===false?this.createLocationRangeFromDOMRange(n2(),{strict:false}):t4.ignoreLock?this.currentLocationRange:(i2=this.lockedLocationRange)!=null?i2:this.currentLocationRange;},f.prototype.setLocationRange=function(t4){var e3;if(!this.lockedLocationRange)return t4=a2(t4),(e3=this.createDOMRangeFromLocationRange(t4))?(l(e3),this.updateCurrentLocationRange(t4)):void 0;},f.prototype.setLocationRangeFromPointRange=function(t4){var e3,n3;return t4=a2(t4),n3=this.getLocationAtPoint(t4[0]),e3=this.getLocationAtPoint(t4[1]),this.setLocationRange([n3,e3]);},f.prototype.getClientRectAtLocationRange=function(t4){var e3;return(e3=this.createDOMRangeFromLocationRange(t4))?this.getClientRectsForDOMRange(e3)[1]:void 0;},f.prototype.locationIsCursorTarget=function(t4){var e3,n3,i2;return i2=this.findNodeAndOffsetFromLocation(t4),e3=i2[0],n3=i2[1],s2(e3);},f.prototype.lock=function(){return this.lockCount++===0?(this.updateCurrentLocationRange(),this.lockedLocationRange=this.getLocationRange()):void 0;},f.prototype.unlock=function(){var t4;return--this.lockCount===0&&(t4=this.lockedLocationRange,this.lockedLocationRange=null,t4!=null)?this.setLocationRange(t4):void 0;},f.prototype.clearSelection=function(){var t4;return(t4=i())!=null?t4.removeAllRanges():void 0;},f.prototype.selectionIsCollapsed=function(){var t4;return((t4=n2())!=null?t4.collapsed:void 0)===true;},f.prototype.selectionIsExpanded=function(){return!this.selectionIsCollapsed();},f.prototype.createLocationRangeFromDOMRange=function(t4,e3){var n3,i2;if(t4!=null&&this.domRangeWithinElement(t4)&&(i2=this.findLocationFromContainerAndOffset(t4.startContainer,t4.startOffset,e3)))return t4.collapsed||(n3=this.findLocationFromContainerAndOffset(t4.endContainer,t4.endOffset,e3)),a2([i2,n3]);},f.proxyMethod("locationMapper.findLocationFromContainerAndOffset"),f.proxyMethod("locationMapper.findContainerAndOffsetFromLocation"),f.proxyMethod("locationMapper.findNodeAndOffsetFromLocation"),f.proxyMethod("pointMapper.createDOMRangeFromPoint"),f.proxyMethod("pointMapper.getClientRectsForDOMRange"),f.prototype.didMouseDown=function(){return this.pauseTemporarily();},f.prototype.pauseTemporarily=function(){var e3,n3,i2,r3;return this.paused=true,n3=function(e4){return function(){var n4,o3,s3;for(e4.paused=false,clearTimeout(r3),o3=0,s3=i2.length;s3>o3;o3++){n4=i2[o3],n4.destroy();}return t3(document,e4.element)?e4.selectionDidChange():void 0;};}(this),r3=setTimeout(n3,200),i2=function(){var t4,i3,r4,s3;for(r4=["mousemove","keydown"],s3=[],t4=0,i3=r4.length;i3>t4;t4++){e3=r4[t4],s3.push(o2(e3,{onElement:document,withCallback:n3}));}return s3;}();},f.prototype.selectionDidChange=function(){return this.paused||r2(this.element)?void 0:this.updateCurrentLocationRange();},f.prototype.updateCurrentLocationRange=function(t4){var e3;return(t4!=null?t4:t4=this.createLocationRangeFromDOMRange(n2()))&&!c2(t4,this.currentLocationRange)?(this.currentLocationRange=t4,(e3=this.delegate)!=null&&typeof e3.locationRangeDidChange=="function"?e3.locationRangeDidChange(this.currentLocationRange.slice(0)):void 0):void 0;},f.prototype.createDOMRangeFromLocationRange=function(t4){var e3,n3,i2,o3;return i2=this.findContainerAndOffsetFromLocation(t4[0]),n3=u(t4)?i2:(o3=this.findContainerAndOffsetFromLocation(t4[1]))!=null?o3:i2,i2!=null&&n3!=null?(e3=document.createRange(),e3.setStart.apply(e3,i2),e3.setEnd.apply(e3,n3),e3):void 0;},f.prototype.getLocationAtPoint=function(t4){var e3,n3;return(e3=this.createDOMRangeFromPoint(t4))&&(n3=this.createLocationRangeFromDOMRange(e3))!=null?n3[0]:void 0;},f.prototype.domRangeWithinElement=function(e3){return e3.collapsed?t3(this.element,e3.startContainer):t3(this.element,e3.startContainer)&&t3(this.element,e3.endContainer);},f;}(e2.BasicObject);}.call(this),function(){var t3,n2,i,o2,r2=function r2(t4,e3){function n3(){this.constructor=t4;}for(var i2 in e3){s2.call(e3,i2)&&(t4[i2]=e3[i2]);}return n3.prototype=e3.prototype,t4.prototype=new n3(),t4.__super__=e3.prototype,t4;},s2={}.hasOwnProperty,a2=[].slice;i=e2.rangeIsCollapsed,o2=e2.rangesAreEqual,n2=e2.objectsAreEqual,t3=e2.getBlockConfig,e2.EditorController=function(s3){function u(t4){var n3,i2;this.editorElement=t4.editorElement,n3=t4.document,i2=t4.html,this.selectionManager=new e2.SelectionManager(this.editorElement),this.selectionManager.delegate=this,this.composition=new e2.Composition(),this.composition.delegate=this,this.attachmentManager=new e2.AttachmentManager(this.composition.getAttachments()),this.attachmentManager.delegate=this,this.inputController=new e2["Level"+e2.config.input.getLevel()+"InputController"](this.editorElement),this.inputController.delegate=this,this.inputController.responder=this.composition,this.compositionController=new e2.CompositionController(this.editorElement,this.composition),this.compositionController.delegate=this,this.toolbarController=new e2.ToolbarController(this.editorElement.toolbarElement),this.toolbarController.delegate=this,this.editor=new e2.Editor(this.composition,this.selectionManager,this.editorElement),n3!=null?this.editor.loadDocument(n3):this.editor.loadHTML(i2);}var c2;return r2(u,s3),u.prototype.registerSelectionManager=function(){return e2.selectionChangeObserver.registerSelectionManager(this.selectionManager);},u.prototype.unregisterSelectionManager=function(){return e2.selectionChangeObserver.unregisterSelectionManager(this.selectionManager);},u.prototype.render=function(){return this.compositionController.render();},u.prototype.reparse=function(){return this.composition.replaceHTML(this.editorElement.innerHTML);},u.prototype.compositionDidChangeDocument=function(){return this.notifyEditorElement("document-change"),this.handlingInput?void 0:this.render();},u.prototype.compositionDidChangeCurrentAttributes=function(t4){return this.currentAttributes=t4,this.toolbarController.updateAttributes(this.currentAttributes),this.updateCurrentActions(),this.notifyEditorElement("attributes-change",{attributes:this.currentAttributes});},u.prototype.compositionDidPerformInsertionAtRange=function(t4){return this.pasting?this.pastedRange=t4:void 0;},u.prototype.compositionShouldAcceptFile=function(t4){return this.notifyEditorElement("file-accept",{file:t4});},u.prototype.compositionDidAddAttachment=function(t4){var e3;return e3=this.attachmentManager.manageAttachment(t4),this.notifyEditorElement("attachment-add",{attachment:e3});},u.prototype.compositionDidEditAttachment=function(t4){var e3;return this.compositionController.rerenderViewForObject(t4),e3=this.attachmentManager.manageAttachment(t4),this.notifyEditorElement("attachment-edit",{attachment:e3}),this.notifyEditorElement("change");},u.prototype.compositionDidChangeAttachmentPreviewURL=function(t4){return this.compositionController.invalidateViewForObject(t4),this.notifyEditorElement("change");},u.prototype.compositionDidRemoveAttachment=function(t4){var e3;return e3=this.attachmentManager.unmanageAttachment(t4),this.notifyEditorElement("attachment-remove",{attachment:e3});},u.prototype.compositionDidStartEditingAttachment=function(t4,e3){return this.attachmentLocationRange=this.composition.document.getLocationRangeOfAttachment(t4),this.compositionController.installAttachmentEditorForAttachment(t4,e3),this.selectionManager.setLocationRange(this.attachmentLocationRange);},u.prototype.compositionDidStopEditingAttachment=function(){return this.compositionController.uninstallAttachmentEditor(),this.attachmentLocationRange=null;},u.prototype.compositionDidRequestChangingSelectionToLocationRange=function(t4){return!this.loadingSnapshot||this.isFocused()?(this.requestedLocationRange=t4,this.compositionRevisionWhenLocationRangeRequested=this.composition.revision,this.handlingInput?void 0:this.render()):void 0;},u.prototype.compositionWillLoadSnapshot=function(){return this.loadingSnapshot=true;},u.prototype.compositionDidLoadSnapshot=function(){return this.compositionController.refreshViewCache(),this.render(),this.loadingSnapshot=false;},u.prototype.getSelectionManager=function(){return this.selectionManager;},u.proxyMethod("getSelectionManager().setLocationRange"),u.proxyMethod("getSelectionManager().getLocationRange"),u.prototype.attachmentManagerDidRequestRemovalOfAttachment=function(t4){return this.removeAttachment(t4);},u.prototype.compositionControllerWillSyncDocumentView=function(){return this.inputController.editorWillSyncDocumentView(),this.selectionManager.lock(),this.selectionManager.clearSelection();},u.prototype.compositionControllerDidSyncDocumentView=function(){return this.inputController.editorDidSyncDocumentView(),this.selectionManager.unlock(),this.updateCurrentActions(),this.notifyEditorElement("sync");},u.prototype.compositionControllerDidRender=function(){return this.requestedLocationRange!=null&&(this.compositionRevisionWhenLocationRangeRequested===this.composition.revision&&this.selectionManager.setLocationRange(this.requestedLocationRange),this.requestedLocationRange=null,this.compositionRevisionWhenLocationRangeRequested=null),this.renderedCompositionRevision!==this.composition.revision&&(this.runEditorFilters(),this.composition.updateCurrentAttributes(),this.notifyEditorElement("render")),this.renderedCompositionRevision=this.composition.revision;},u.prototype.compositionControllerDidFocus=function(){return this.isFocusedInvisibly()&&this.setLocationRange({index:0,offset:0}),this.toolbarController.hideDialog(),this.notifyEditorElement("focus");},u.prototype.compositionControllerDidBlur=function(){return this.notifyEditorElement("blur");},u.prototype.compositionControllerDidSelectAttachment=function(t4,e3){return this.toolbarController.hideDialog(),this.composition.editAttachment(t4,e3);},u.prototype.compositionControllerDidRequestDeselectingAttachment=function(t4){var e3,n3;return e3=(n3=this.attachmentLocationRange)!=null?n3:this.composition.document.getLocationRangeOfAttachment(t4),this.selectionManager.setLocationRange(e3[1]);},u.prototype.compositionControllerWillUpdateAttachment=function(t4){return this.editor.recordUndoEntry("Edit Attachment",{context:t4.id,consolidatable:true});},u.prototype.compositionControllerDidRequestRemovalOfAttachment=function(t4){return this.removeAttachment(t4);},u.prototype.inputControllerWillHandleInput=function(){return this.handlingInput=true,this.requestedRender=false;},u.prototype.inputControllerDidRequestRender=function(){return this.requestedRender=true;},u.prototype.inputControllerDidHandleInput=function(){return this.handlingInput=false,this.requestedRender?(this.requestedRender=false,this.render()):void 0;},u.prototype.inputControllerDidAllowUnhandledInput=function(){return this.notifyEditorElement("change");},u.prototype.inputControllerDidRequestReparse=function(){return this.reparse();},u.prototype.inputControllerWillPerformTyping=function(){return this.recordTypingUndoEntry();},u.prototype.inputControllerWillPerformFormatting=function(t4){return this.recordFormattingUndoEntry(t4);},u.prototype.inputControllerWillCutText=function(){return this.editor.recordUndoEntry("Cut");},u.prototype.inputControllerWillPaste=function(t4){return this.editor.recordUndoEntry("Paste"),this.pasting=true,this.notifyEditorElement("before-paste",{paste:t4});},u.prototype.inputControllerDidPaste=function(t4){return t4.range=this.pastedRange,this.pastedRange=null,this.pasting=null,this.notifyEditorElement("paste",{paste:t4});},u.prototype.inputControllerWillMoveText=function(){return this.editor.recordUndoEntry("Move");},u.prototype.inputControllerWillAttachFiles=function(){return this.editor.recordUndoEntry("Drop Files");},u.prototype.inputControllerWillPerformUndo=function(){return this.editor.undo();},u.prototype.inputControllerWillPerformRedo=function(){return this.editor.redo();},u.prototype.inputControllerDidReceiveKeyboardCommand=function(t4){return this.toolbarController.applyKeyboardCommand(t4);},u.prototype.inputControllerDidStartDrag=function(){return this.locationRangeBeforeDrag=this.selectionManager.getLocationRange();},u.prototype.inputControllerDidReceiveDragOverPoint=function(t4){return this.selectionManager.setLocationRangeFromPointRange(t4);},u.prototype.inputControllerDidCancelDrag=function(){return this.selectionManager.setLocationRange(this.locationRangeBeforeDrag),this.locationRangeBeforeDrag=null;},u.prototype.locationRangeDidChange=function(t4){return this.composition.updateCurrentAttributes(),this.updateCurrentActions(),this.attachmentLocationRange&&!o2(this.attachmentLocationRange,t4)&&this.composition.stopEditingAttachment(),this.notifyEditorElement("selection-change");},u.prototype.toolbarDidClickButton=function(){return this.getLocationRange()?void 0:this.setLocationRange({index:0,offset:0});},u.prototype.toolbarDidInvokeAction=function(t4){return this.invokeAction(t4);},u.prototype.toolbarDidToggleAttribute=function(t4){return this.recordFormattingUndoEntry(t4),this.composition.toggleCurrentAttribute(t4),this.render(),this.selectionFrozen?void 0:this.editorElement.focus();},u.prototype.toolbarDidUpdateAttribute=function(t4,e3){return this.recordFormattingUndoEntry(t4),this.composition.setCurrentAttribute(t4,e3),this.render(),this.selectionFrozen?void 0:this.editorElement.focus();},u.prototype.toolbarDidRemoveAttribute=function(t4){return this.recordFormattingUndoEntry(t4),this.composition.removeCurrentAttribute(t4),this.render(),this.selectionFrozen?void 0:this.editorElement.focus();},u.prototype.toolbarWillShowDialog=function(){return this.composition.expandSelectionForEditing(),this.freezeSelection();},u.prototype.toolbarDidShowDialog=function(t4){return this.notifyEditorElement("toolbar-dialog-show",{dialogName:t4});},u.prototype.toolbarDidHideDialog=function(t4){return this.thawSelection(),this.editorElement.focus(),this.notifyEditorElement("toolbar-dialog-hide",{dialogName:t4});},u.prototype.freezeSelection=function(){return this.selectionFrozen?void 0:(this.selectionManager.lock(),this.composition.freezeSelection(),this.selectionFrozen=true,this.render());},u.prototype.thawSelection=function(){return this.selectionFrozen?(this.composition.thawSelection(),this.selectionManager.unlock(),this.selectionFrozen=false,this.render()):void 0;},u.prototype.actions={undo:{test:function test(){return this.editor.canUndo();},perform:function perform(){return this.editor.undo();}},redo:{test:function test(){return this.editor.canRedo();},perform:function perform(){return this.editor.redo();}},link:{test:function test(){return this.editor.canActivateAttribute("href");}},increaseNestingLevel:{test:function test(){return this.editor.canIncreaseNestingLevel();},perform:function perform(){return this.editor.increaseNestingLevel()&&this.render();}},decreaseNestingLevel:{test:function test(){return this.editor.canDecreaseNestingLevel();},perform:function perform(){return this.editor.decreaseNestingLevel()&&this.render();}},attachFiles:{test:function test(){return true;},perform:function perform(){return e2.config.input.pickFiles(this.editor.insertFiles);}}},u.prototype.canInvokeAction=function(t4){var e3,n3;return this.actionIsExternal(t4)?true:!!((e3=this.actions[t4])!=null&&(n3=e3.test)!=null?n3.call(this):void 0);},u.prototype.invokeAction=function(t4){var e3,n3;return this.actionIsExternal(t4)?this.notifyEditorElement("action-invoke",{actionName:t4}):(e3=this.actions[t4])!=null&&(n3=e3.perform)!=null?n3.call(this):void 0;},u.prototype.actionIsExternal=function(t4){return /^x-./.test(t4);},u.prototype.getCurrentActions=function(){var t4,e3;e3={};for(t4 in this.actions){e3[t4]=this.canInvokeAction(t4);}return e3;},u.prototype.updateCurrentActions=function(){var t4;return t4=this.getCurrentActions(),n2(t4,this.currentActions)?void 0:(this.currentActions=t4,this.toolbarController.updateActions(this.currentActions),this.notifyEditorElement("actions-change",{actions:this.currentActions}));},u.prototype.runEditorFilters=function(){var t4,e3,n3,i2,o3,r3,s4,a3;for(a3=this.composition.getSnapshot(),o3=this.editor.filters,n3=0,i2=o3.length;i2>n3;n3++){e3=o3[n3],t4=a3.document,s4=a3.selectedRange,a3=(r3=e3.call(this.editor,a3))!=null?r3:{},a3.document==null&&(a3.document=t4),a3.selectedRange==null&&(a3.selectedRange=s4);}return c2(a3,this.composition.getSnapshot())?void 0:this.composition.loadSnapshot(a3);},c2=function c2(t4,e3){return o2(t4.selectedRange,e3.selectedRange)&&t4.document.isEqualTo(e3.document);},u.prototype.updateInputElement=function(){var t4,n3;return t4=this.compositionController.getSerializableElement(),n3=e2.serializeToContentType(t4,"text/html"),this.editorElement.setInputElementValue(n3);},u.prototype.notifyEditorElement=function(t4,e3){switch(t4){case"document-change":this.documentChangedSinceLastRender=true;break;case"render":this.documentChangedSinceLastRender&&(this.documentChangedSinceLastRender=false,this.notifyEditorElement("change"));break;case"change":case"attachment-add":case"attachment-edit":case"attachment-remove":this.updateInputElement();}return this.editorElement.notify(t4,e3);},u.prototype.removeAttachment=function(t4){return this.editor.recordUndoEntry("Delete Attachment"),this.composition.removeAttachment(t4),this.render();},u.prototype.recordFormattingUndoEntry=function(e3){var n3,o3;return n3=t3(e3),o3=this.selectionManager.getLocationRange(),n3||!i(o3)?this.editor.recordUndoEntry("Formatting",{context:this.getUndoContext(),consolidatable:true}):void 0;},u.prototype.recordTypingUndoEntry=function(){return this.editor.recordUndoEntry("Typing",{context:this.getUndoContext(this.currentAttributes),consolidatable:true});},u.prototype.getUndoContext=function(){var t4;return t4=1<=arguments.length?a2.call(arguments,0):[],[this.getLocationContext(),this.getTimeContext()].concat(a2.call(t4));},u.prototype.getLocationContext=function(){var t4;return t4=this.selectionManager.getLocationRange(),i(t4)?t4[0].index:t4;},u.prototype.getTimeContext=function(){return e2.config.undoInterval>0?Math.floor(new Date().getTime()/e2.config.undoInterval):0;},u.prototype.isFocused=function(){var t4;return this.editorElement===((t4=this.editorElement.ownerDocument)!=null?t4.activeElement:void 0);},u.prototype.isFocusedInvisibly=function(){return this.isFocused()&&!this.getLocationRange();},u;}(e2.Controller);}.call(this),function(){var t3,n2,i,o2,r2,s2,a2,u=[].indexOf||function(t4){for(var e3=0,n3=this.length;n3>e3;e3++){if(e3 in this&&this[e3]===t4)return e3;}return-1;};n2=e2.browser,s2=e2.makeElement,a2=e2.triggerEvent,o2=e2.handleEvent,r2=e2.handleEventOnce,i=e2.findClosestElementFromNode,t3=e2.AttachmentView.attachmentSelector,e2.registerElement("trix-editor",function(){var c2,l,h,p2,d,f,g,m,v;return g=0,l=function l(t4){return!document.querySelector(":focus")&&t4.hasAttribute("autofocus")&&document.querySelector("[autofocus]")===t4?t4.focus():void 0;},m=function m(t4){return t4.hasAttribute("contenteditable")?void 0:(t4.setAttribute("contenteditable",""),r2("focus",{onElement:t4,withCallback:function withCallback(){return h(t4);}}));},h=function h(t4){return d(t4),v(t4);},d=function d(t4){return(typeof document.queryCommandSupported=="function"?document.queryCommandSupported("enableObjectResizing"):void 0)?(document.execCommand("enableObjectResizing",false,false),o2("mscontrolselect",{onElement:t4,preventDefault:true})):void 0;},v=function v(){var t4;return(typeof document.queryCommandSupported=="function"?document.queryCommandSupported("DefaultParagraphSeparator"):void 0)&&(t4=e2.config.blockAttributes["default"].tagName,t4==="div"||t4==="p")?document.execCommand("DefaultParagraphSeparator",false,t4):void 0;},c2=function c2(t4){return t4.hasAttribute("role")?void 0:t4.setAttribute("role","textbox");},f=function f(t4){var e3;if(!t4.hasAttribute("aria-label")&&!t4.hasAttribute("aria-labelledby"))return(e3=function e3(){var e4,n3,i2;return i2=function(){var n4,i3,o3,r3;for(o3=t4.labels,r3=[],n4=0,i3=o3.length;i3>n4;n4++){e4=o3[n4],e4.contains(t4)||r3.push(e4.textContent);}return r3;}(),(n3=i2.join(" "))?t4.setAttribute("aria-label",n3):t4.removeAttribute("aria-label");})(),o2("focus",{onElement:t4,withCallback:e3});},p2=function(){return n2.forcesObjectResizing?{display:"inline",width:"auto"}:{display:"inline-block",width:"1px"};}(),{defaultCSS:"%t {\n  display: block;\n}\n\n%t:empty:not(:focus)::before {\n  content: attr(placeholder);\n  color: graytext;\n  cursor: text;\n  pointer-events: none;\n}\n\n%t a[contenteditable=false] {\n  cursor: text;\n}\n\n%t img {\n  max-width: 100%;\n  height: auto;\n}\n\n%t "+t3+" figcaption textarea {\n  resize: none;\n}\n\n%t "+t3+" figcaption textarea.trix-autoresize-clone {\n  position: absolute;\n  left: -9999px;\n  max-height: 0px;\n}\n\n%t "+t3+" figcaption[data-trix-placeholder]:empty::before {\n  content: attr(data-trix-placeholder);\n  color: graytext;\n}\n\n%t [data-trix-cursor-target] {\n  display: "+p2.display+" !important;\n  width: "+p2.width+" !important;\n  padding: 0 !important;\n  margin: 0 !important;\n  border: none !important;\n}\n\n%t [data-trix-cursor-target=left] {\n  vertical-align: top !important;\n  margin-left: -1px !important;\n}\n\n%t [data-trix-cursor-target=right] {\n  vertical-align: bottom !important;\n  margin-right: -1px !important;\n}",trixId:{get:function get(){return this.hasAttribute("trix-id")?this.getAttribute("trix-id"):(this.setAttribute("trix-id",++g),this.trixId);}},labels:{get:function get(){var t4,e3,n3;return e3=[],this.id&&this.ownerDocument&&e3.push.apply(e3,this.ownerDocument.querySelectorAll("label[for='"+this.id+"']")),(t4=i(this,{matchingSelector:"label"}))&&((n3=t4.control)===this||n3===null)&&e3.push(t4),e3;}},toolbarElement:{get:function get(){var t4,e3,n3;return this.hasAttribute("toolbar")?(e3=this.ownerDocument)!=null?e3.getElementById(this.getAttribute("toolbar")):void 0:this.parentNode?(n3="trix-toolbar-"+this.trixId,this.setAttribute("toolbar",n3),t4=s2("trix-toolbar",{id:n3}),this.parentNode.insertBefore(t4,this),t4):void 0;}},inputElement:{get:function get(){var t4,e3,n3;return this.hasAttribute("input")?(n3=this.ownerDocument)!=null?n3.getElementById(this.getAttribute("input")):void 0:this.parentNode?(e3="trix-input-"+this.trixId,this.setAttribute("input",e3),t4=s2("input",{type:"hidden",id:e3}),this.parentNode.insertBefore(t4,this.nextElementSibling),t4):void 0;}},editor:{get:function get(){var t4;return(t4=this.editorController)!=null?t4.editor:void 0;}},name:{get:function get(){var t4;return(t4=this.inputElement)!=null?t4.name:void 0;}},value:{get:function get(){var t4;return(t4=this.inputElement)!=null?t4.value:void 0;},set:function set(t4){var e3;return this.defaultValue=t4,(e3=this.editor)!=null?e3.loadHTML(this.defaultValue):void 0;}},notify:function notify(t4,e3){return this.editorController?a2("trix-"+t4,{onElement:this,attributes:e3}):void 0;},setInputElementValue:function setInputElementValue(t4){var e3;return(e3=this.inputElement)!=null?e3.value=t4:void 0;},initialize:function initialize(){return this.hasAttribute("data-trix-internal")?void 0:(m(this),c2(this),f(this));},connect:function connect(){return this.hasAttribute("data-trix-internal")?void 0:(this.editorController||(a2("trix-before-initialize",{onElement:this}),this.editorController=new e2.EditorController({editorElement:this,html:this.defaultValue=this.value}),requestAnimationFrame(function(t4){return function(){return a2("trix-initialize",{onElement:t4});};}(this))),this.editorController.registerSelectionManager(),this.registerResetListener(),this.registerClickListener(),l(this));},disconnect:function disconnect(){var t4;return(t4=this.editorController)!=null&&t4.unregisterSelectionManager(),this.unregisterResetListener(),this.unregisterClickListener();},registerResetListener:function registerResetListener(){return this.resetListener=this.resetBubbled.bind(this),window.addEventListener("reset",this.resetListener,false);},unregisterResetListener:function unregisterResetListener(){return window.removeEventListener("reset",this.resetListener,false);},registerClickListener:function registerClickListener(){return this.clickListener=this.clickBubbled.bind(this),window.addEventListener("click",this.clickListener,false);},unregisterClickListener:function unregisterClickListener(){return window.removeEventListener("click",this.clickListener,false);},resetBubbled:function resetBubbled(t4){var e3;if(!t4.defaultPrevented&&t4.target===((e3=this.inputElement)!=null?e3.form:void 0))return this.reset();},clickBubbled:function clickBubbled(t4){var e3;if(!(t4.defaultPrevented||this.contains(t4.target)||!(e3=i(t4.target,{matchingSelector:"label"}))||u.call(this.labels,e3)<0))return this.focus();},reset:function reset(){return this.value=this.defaultValue;}};}());}.call(this),function(){}.call(this);}).call(this),_typeof4(module)=="object"&&module.exports?module.exports=e2:typeof define=="function"&&__webpack_require__.amdO&&define(e2);}.call(exports);});// node_modules/choices.js/public/assets/scripts/choices.js
var require_choices=__commonJS(function(exports,module){/*! choices.js v10.2.0 | © 2022 Josh Johnson | https://github.com/jshjohnson/Choices#readme */(function webpackUniversalModuleDefinition(root2,factory){if(_typeof4(exports)==="object"&&_typeof4(module)==="object")module.exports=factory();else if(typeof define==="function"&&__webpack_require__.amdO)define([],factory);else if(_typeof4(exports)==="object")exports["Choices"]=factory();else root2["Choices"]=factory();})(window,function(){return function(){"use strict";var __webpack_modules__={282:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.clearChoices=exports2.activateChoices=exports2.filterChoices=exports2.addChoice=void 0;var constants_1=__webpack_require__2(883);var addChoice=function addChoice(_a){var value=_a.value,label=_a.label,id=_a.id,groupId=_a.groupId,disabled=_a.disabled,elementId=_a.elementId,customProperties=_a.customProperties,placeholder=_a.placeholder,keyCode=_a.keyCode;return{type:constants_1.ACTION_TYPES.ADD_CHOICE,value:value,label:label,id:id,groupId:groupId,disabled:disabled,elementId:elementId,customProperties:customProperties,placeholder:placeholder,keyCode:keyCode};};exports2.addChoice=addChoice;var filterChoices=function filterChoices(results){return{type:constants_1.ACTION_TYPES.FILTER_CHOICES,results:results};};exports2.filterChoices=filterChoices;var activateChoices=function activateChoices(active){if(active===void 0){active=true;}return{type:constants_1.ACTION_TYPES.ACTIVATE_CHOICES,active:active};};exports2.activateChoices=activateChoices;var clearChoices=function clearChoices(){return{type:constants_1.ACTION_TYPES.CLEAR_CHOICES};};exports2.clearChoices=clearChoices;},783:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.addGroup=void 0;var constants_1=__webpack_require__2(883);var addGroup=function addGroup(_a){var value=_a.value,id=_a.id,active=_a.active,disabled=_a.disabled;return{type:constants_1.ACTION_TYPES.ADD_GROUP,value:value,id:id,active:active,disabled:disabled};};exports2.addGroup=addGroup;},464:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.highlightItem=exports2.removeItem=exports2.addItem=void 0;var constants_1=__webpack_require__2(883);var addItem=function addItem(_a){var value=_a.value,label=_a.label,id=_a.id,choiceId=_a.choiceId,groupId=_a.groupId,customProperties=_a.customProperties,placeholder=_a.placeholder,keyCode=_a.keyCode;return{type:constants_1.ACTION_TYPES.ADD_ITEM,value:value,label:label,id:id,choiceId:choiceId,groupId:groupId,customProperties:customProperties,placeholder:placeholder,keyCode:keyCode};};exports2.addItem=addItem;var removeItem=function removeItem(id,choiceId){return{type:constants_1.ACTION_TYPES.REMOVE_ITEM,id:id,choiceId:choiceId};};exports2.removeItem=removeItem;var highlightItem=function highlightItem(id,highlighted){return{type:constants_1.ACTION_TYPES.HIGHLIGHT_ITEM,id:id,highlighted:highlighted};};exports2.highlightItem=highlightItem;},137:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.setIsLoading=exports2.resetTo=exports2.clearAll=void 0;var constants_1=__webpack_require__2(883);var clearAll=function clearAll(){return{type:constants_1.ACTION_TYPES.CLEAR_ALL};};exports2.clearAll=clearAll;var resetTo=function resetTo(state2){return{type:constants_1.ACTION_TYPES.RESET_TO,state:state2};};exports2.resetTo=resetTo;var setIsLoading=function setIsLoading(isLoading){return{type:constants_1.ACTION_TYPES.SET_IS_LOADING,isLoading:isLoading};};exports2.setIsLoading=setIsLoading;},373:function _(__unused_webpack_module,exports2,__webpack_require__2){var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}return to.concat(ar||Array.prototype.slice.call(from));};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});var deepmerge_1=__importDefault(__webpack_require__2(996));var fuse_js_1=__importDefault(__webpack_require__2(221));var choices_1=__webpack_require__2(282);var groups_1=__webpack_require__2(783);var items_1=__webpack_require__2(464);var misc_1=__webpack_require__2(137);var components_1=__webpack_require__2(520);var constants_1=__webpack_require__2(883);var defaults_1=__webpack_require__2(789);var utils_1=__webpack_require__2(799);var reducers_1=__webpack_require__2(655);var store_1=__importDefault(__webpack_require__2(744));var templates_1=__importDefault(__webpack_require__2(686));var IS_IE11="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style;var USER_DEFAULTS={};var Choices2=function(){function Choices3(element,userConfig){if(element===void 0){element="[data-choice]";}if(userConfig===void 0){userConfig={};}var _this=this;if(userConfig.allowHTML===void 0){console.warn("Deprecation warning: allowHTML will default to false in a future release. To render HTML in Choices, you will need to set it to true. Setting allowHTML will suppress this message.");}this.config=deepmerge_1["default"].all([defaults_1.DEFAULT_CONFIG,Choices3.defaults.options,userConfig],{arrayMerge:function arrayMerge(_,sourceArray){return __spreadArray([],sourceArray,true);}});var invalidConfigOptions=(0,utils_1.diff)(this.config,defaults_1.DEFAULT_CONFIG);if(invalidConfigOptions.length){console.warn("Unknown config option(s) passed",invalidConfigOptions.join(", "));}var passedElement=typeof element==="string"?document.querySelector(element):element;if(!(passedElement instanceof HTMLInputElement||passedElement instanceof HTMLSelectElement)){throw TypeError("Expected one of the following types text|select-one|select-multiple");}this._isTextElement=passedElement.type===constants_1.TEXT_TYPE;this._isSelectOneElement=passedElement.type===constants_1.SELECT_ONE_TYPE;this._isSelectMultipleElement=passedElement.type===constants_1.SELECT_MULTIPLE_TYPE;this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement;this.config.searchEnabled=this._isSelectMultipleElement||this.config.searchEnabled;if(!["auto","always"].includes("".concat(this.config.renderSelectedChoices))){this.config.renderSelectedChoices="auto";}if(userConfig.addItemFilter&&typeof userConfig.addItemFilter!=="function"){var re=userConfig.addItemFilter instanceof RegExp?userConfig.addItemFilter:new RegExp(userConfig.addItemFilter);this.config.addItemFilter=re.test.bind(re);}if(this._isTextElement){this.passedElement=new components_1.WrappedInput({element:passedElement,classNames:this.config.classNames,delimiter:this.config.delimiter});}else{this.passedElement=new components_1.WrappedSelect({element:passedElement,classNames:this.config.classNames,template:function template(data3){return _this._templates.option(data3);}});}this.initialised=false;this._store=new store_1["default"]();this._initialState=reducers_1.defaultState;this._currentState=reducers_1.defaultState;this._prevState=reducers_1.defaultState;this._currentValue="";this._canSearch=!!this.config.searchEnabled;this._isScrollingOnIe=false;this._highlightPosition=0;this._wasTap=true;this._placeholderValue=this._generatePlaceholderValue();this._baseId=(0,utils_1.generateId)(this.passedElement.element,"choices-");this._direction=this.passedElement.dir;if(!this._direction){var elementDirection=window.getComputedStyle(this.passedElement.element).direction;var documentDirection=window.getComputedStyle(document.documentElement).direction;if(elementDirection!==documentDirection){this._direction=elementDirection;}}this._idNames={itemChoice:"item-choice"};if(this._isSelectElement){this._presetGroups=this.passedElement.optionGroups;this._presetOptions=this.passedElement.options;}this._presetChoices=this.config.choices;this._presetItems=this.config.items;if(this.passedElement.value&&this._isTextElement){var splitValues=this.passedElement.value.split(this.config.delimiter);this._presetItems=this._presetItems.concat(splitValues);}if(this.passedElement.options){this.passedElement.options.forEach(function(option3){_this._presetChoices.push({value:option3.value,label:option3.innerHTML,selected:!!option3.selected,disabled:option3.disabled||option3.parentNode.disabled,placeholder:option3.value===""||option3.hasAttribute("placeholder"),customProperties:(0,utils_1.parseCustomProperties)(option3.dataset.customProperties)});});}this._render=this._render.bind(this);this._onFocus=this._onFocus.bind(this);this._onBlur=this._onBlur.bind(this);this._onKeyUp=this._onKeyUp.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this._onClick=this._onClick.bind(this);this._onTouchMove=this._onTouchMove.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);this._onMouseDown=this._onMouseDown.bind(this);this._onMouseOver=this._onMouseOver.bind(this);this._onFormReset=this._onFormReset.bind(this);this._onSelectKey=this._onSelectKey.bind(this);this._onEnterKey=this._onEnterKey.bind(this);this._onEscapeKey=this._onEscapeKey.bind(this);this._onDirectionKey=this._onDirectionKey.bind(this);this._onDeleteKey=this._onDeleteKey.bind(this);if(this.passedElement.isActive){if(!this.config.silent){console.warn("Trying to initialise Choices on element already initialised",{element:element});}this.initialised=true;return;}this.init();}Object.defineProperty(Choices3,"defaults",{get:function get(){return Object.preventExtensions({get options(){return USER_DEFAULTS;},get templates(){return templates_1["default"];}});},enumerable:false,configurable:true});Choices3.prototype.init=function(){if(this.initialised){return;}this._createTemplates();this._createElements();this._createStructure();this._store.subscribe(this._render);this._render();this._addEventListeners();var shouldDisable=!this.config.addItems||this.passedElement.element.hasAttribute("disabled");if(shouldDisable){this.disable();}this.initialised=true;var callbackOnInit=this.config.callbackOnInit;if(callbackOnInit&&typeof callbackOnInit==="function"){callbackOnInit.call(this);}};Choices3.prototype.destroy=function(){if(!this.initialised){return;}this._removeEventListeners();this.passedElement.reveal();this.containerOuter.unwrap(this.passedElement.element);this.clearStore();if(this._isSelectElement){this.passedElement.options=this._presetOptions;}this._templates=templates_1["default"];this.initialised=false;};Choices3.prototype.enable=function(){if(this.passedElement.isDisabled){this.passedElement.enable();}if(this.containerOuter.isDisabled){this._addEventListeners();this.input.enable();this.containerOuter.enable();}return this;};Choices3.prototype.disable=function(){if(!this.passedElement.isDisabled){this.passedElement.disable();}if(!this.containerOuter.isDisabled){this._removeEventListeners();this.input.disable();this.containerOuter.disable();}return this;};Choices3.prototype.highlightItem=function(item2,runEvent){if(runEvent===void 0){runEvent=true;}if(!item2||!item2.id){return this;}var id=item2.id,_a=item2.groupId,groupId=_a===void 0?-1:_a,_b=item2.value,value=_b===void 0?"":_b,_c=item2.label,label=_c===void 0?"":_c;var group=groupId>=0?this._store.getGroupById(groupId):null;this._store.dispatch((0,items_1.highlightItem)(id,true));if(runEvent){this.passedElement.triggerEvent(constants_1.EVENTS.highlightItem,{id:id,value:value,label:label,groupValue:group&&group.value?group.value:null});}return this;};Choices3.prototype.unhighlightItem=function(item2){if(!item2||!item2.id){return this;}var id=item2.id,_a=item2.groupId,groupId=_a===void 0?-1:_a,_b=item2.value,value=_b===void 0?"":_b,_c=item2.label,label=_c===void 0?"":_c;var group=groupId>=0?this._store.getGroupById(groupId):null;this._store.dispatch((0,items_1.highlightItem)(id,false));this.passedElement.triggerEvent(constants_1.EVENTS.highlightItem,{id:id,value:value,label:label,groupValue:group&&group.value?group.value:null});return this;};Choices3.prototype.highlightAll=function(){var _this=this;this._store.items.forEach(function(item2){return _this.highlightItem(item2);});return this;};Choices3.prototype.unhighlightAll=function(){var _this=this;this._store.items.forEach(function(item2){return _this.unhighlightItem(item2);});return this;};Choices3.prototype.removeActiveItemsByValue=function(value){var _this=this;this._store.activeItems.filter(function(item2){return item2.value===value;}).forEach(function(item2){return _this._removeItem(item2);});return this;};Choices3.prototype.removeActiveItems=function(excludedId){var _this=this;this._store.activeItems.filter(function(_a){var id=_a.id;return id!==excludedId;}).forEach(function(item2){return _this._removeItem(item2);});return this;};Choices3.prototype.removeHighlightedItems=function(runEvent){var _this=this;if(runEvent===void 0){runEvent=false;}this._store.highlightedActiveItems.forEach(function(item2){_this._removeItem(item2);if(runEvent){_this._triggerChange(item2.value);}});return this;};Choices3.prototype.showDropdown=function(preventInputFocus){var _this=this;if(this.dropdown.isActive){return this;}requestAnimationFrame(function(){_this.dropdown.show();_this.containerOuter.open(_this.dropdown.distanceFromTopWindow);if(!preventInputFocus&&_this._canSearch){_this.input.focus();}_this.passedElement.triggerEvent(constants_1.EVENTS.showDropdown,{});});return this;};Choices3.prototype.hideDropdown=function(preventInputBlur){var _this=this;if(!this.dropdown.isActive){return this;}requestAnimationFrame(function(){_this.dropdown.hide();_this.containerOuter.close();if(!preventInputBlur&&_this._canSearch){_this.input.removeActiveDescendant();_this.input.blur();}_this.passedElement.triggerEvent(constants_1.EVENTS.hideDropdown,{});});return this;};Choices3.prototype.getValue=function(valueOnly){if(valueOnly===void 0){valueOnly=false;}var values=this._store.activeItems.reduce(function(selectedItems,item2){var itemValue=valueOnly?item2.value:item2;selectedItems.push(itemValue);return selectedItems;},[]);return this._isSelectOneElement?values[0]:values;};Choices3.prototype.setValue=function(items){var _this=this;if(!this.initialised){return this;}items.forEach(function(value){return _this._setChoiceOrItem(value);});return this;};Choices3.prototype.setChoiceByValue=function(value){var _this=this;if(!this.initialised||this._isTextElement){return this;}var choiceValue=Array.isArray(value)?value:[value];choiceValue.forEach(function(val){return _this._findAndSelectChoiceByValue(val);});return this;};Choices3.prototype.setChoices=function(choicesArrayOrFetcher,value,label,replaceChoices){var _this=this;if(choicesArrayOrFetcher===void 0){choicesArrayOrFetcher=[];}if(value===void 0){value="value";}if(label===void 0){label="label";}if(replaceChoices===void 0){replaceChoices=false;}if(!this.initialised){throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");}if(!this._isSelectElement){throw new TypeError("setChoices can't be used with INPUT based Choices");}if(typeof value!=="string"||!value){throw new TypeError("value parameter must be a name of 'value' field in passed objects");}if(replaceChoices){this.clearChoices();}if(typeof choicesArrayOrFetcher==="function"){var fetcher_1=choicesArrayOrFetcher(this);if(typeof Promise==="function"&&fetcher_1 instanceof Promise){return new Promise(function(resolve){return requestAnimationFrame(resolve);}).then(function(){return _this._handleLoadingState(true);}).then(function(){return fetcher_1;}).then(function(data3){return _this.setChoices(data3,value,label,replaceChoices);})["catch"](function(err){if(!_this.config.silent){console.error(err);}}).then(function(){return _this._handleLoadingState(false);}).then(function(){return _this;});}if(!Array.isArray(fetcher_1)){throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(_typeof4(fetcher_1)));}return this.setChoices(fetcher_1,value,label,false);}if(!Array.isArray(choicesArrayOrFetcher)){throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");}this.containerOuter.removeLoadingState();this._startLoading();choicesArrayOrFetcher.forEach(function(groupOrChoice){if(groupOrChoice.choices){_this._addGroup({id:groupOrChoice.id?parseInt("".concat(groupOrChoice.id),10):null,group:groupOrChoice,valueKey:value,labelKey:label});}else{var choice=groupOrChoice;_this._addChoice({value:choice[value],label:choice[label],isSelected:!!choice.selected,isDisabled:!!choice.disabled,placeholder:!!choice.placeholder,customProperties:choice.customProperties});}});this._stopLoading();return this;};Choices3.prototype.clearChoices=function(){this._store.dispatch((0,choices_1.clearChoices)());return this;};Choices3.prototype.clearStore=function(){this._store.dispatch((0,misc_1.clearAll)());return this;};Choices3.prototype.clearInput=function(){var shouldSetInputWidth=!this._isSelectOneElement;this.input.clear(shouldSetInputWidth);if(!this._isTextElement&&this._canSearch){this._isSearching=false;this._store.dispatch((0,choices_1.activateChoices)(true));}return this;};Choices3.prototype._render=function(){if(this._store.isLoading()){return;}this._currentState=this._store.state;var stateChanged=this._currentState.choices!==this._prevState.choices||this._currentState.groups!==this._prevState.groups||this._currentState.items!==this._prevState.items;var shouldRenderChoices=this._isSelectElement;var shouldRenderItems=this._currentState.items!==this._prevState.items;if(!stateChanged){return;}if(shouldRenderChoices){this._renderChoices();}if(shouldRenderItems){this._renderItems();}this._prevState=this._currentState;};Choices3.prototype._renderChoices=function(){var _this=this;var _a=this._store,activeGroups=_a.activeGroups,activeChoices=_a.activeChoices;var choiceListFragment=document.createDocumentFragment();this.choiceList.clear();if(this.config.resetScrollPosition){requestAnimationFrame(function(){return _this.choiceList.scrollToTop();});}if(activeGroups.length>=1&&!this._isSearching){var activePlaceholders=activeChoices.filter(function(activeChoice){return activeChoice.placeholder===true&&activeChoice.groupId===-1;});if(activePlaceholders.length>=1){choiceListFragment=this._createChoicesFragment(activePlaceholders,choiceListFragment);}choiceListFragment=this._createGroupsFragment(activeGroups,activeChoices,choiceListFragment);}else if(activeChoices.length>=1){choiceListFragment=this._createChoicesFragment(activeChoices,choiceListFragment);}if(choiceListFragment.childNodes&&choiceListFragment.childNodes.length>0){var activeItems=this._store.activeItems;var canAddItem=this._canAddItem(activeItems,this.input.value);if(canAddItem.response){this.choiceList.append(choiceListFragment);this._highlightChoice();}else{var notice=this._getTemplate("notice",canAddItem.notice);this.choiceList.append(notice);}}else{var dropdownItem=void 0;var notice=void 0;if(this._isSearching){notice=typeof this.config.noResultsText==="function"?this.config.noResultsText():this.config.noResultsText;dropdownItem=this._getTemplate("notice",notice,"no-results");}else{notice=typeof this.config.noChoicesText==="function"?this.config.noChoicesText():this.config.noChoicesText;dropdownItem=this._getTemplate("notice",notice,"no-choices");}this.choiceList.append(dropdownItem);}};Choices3.prototype._renderItems=function(){var activeItems=this._store.activeItems||[];this.itemList.clear();var itemListFragment=this._createItemsFragment(activeItems);if(itemListFragment.childNodes){this.itemList.append(itemListFragment);}};Choices3.prototype._createGroupsFragment=function(groups,choices,fragment){var _this=this;if(fragment===void 0){fragment=document.createDocumentFragment();}var getGroupChoices=function getGroupChoices(group){return choices.filter(function(choice){if(_this._isSelectOneElement){return choice.groupId===group.id;}return choice.groupId===group.id&&(_this.config.renderSelectedChoices==="always"||!choice.selected);});};if(this.config.shouldSort){groups.sort(this.config.sorter);}groups.forEach(function(group){var groupChoices=getGroupChoices(group);if(groupChoices.length>=1){var dropdownGroup=_this._getTemplate("choiceGroup",group);fragment.appendChild(dropdownGroup);_this._createChoicesFragment(groupChoices,fragment,true);}});return fragment;};Choices3.prototype._createChoicesFragment=function(choices,fragment,withinGroup){var _this=this;if(fragment===void 0){fragment=document.createDocumentFragment();}if(withinGroup===void 0){withinGroup=false;}var _a=this.config,renderSelectedChoices=_a.renderSelectedChoices,searchResultLimit=_a.searchResultLimit,renderChoiceLimit=_a.renderChoiceLimit;var filter=this._isSearching?utils_1.sortByScore:this.config.sorter;var appendChoice=function appendChoice(choice){var shouldRender=renderSelectedChoices==="auto"?_this._isSelectOneElement||!choice.selected:true;if(shouldRender){var dropdownItem=_this._getTemplate("choice",choice,_this.config.itemSelectText);fragment.appendChild(dropdownItem);}};var rendererableChoices=choices;if(renderSelectedChoices==="auto"&&!this._isSelectOneElement){rendererableChoices=choices.filter(function(choice){return!choice.selected;});}var _b=rendererableChoices.reduce(function(acc,choice){if(choice.placeholder){acc.placeholderChoices.push(choice);}else{acc.normalChoices.push(choice);}return acc;},{placeholderChoices:[],normalChoices:[]}),placeholderChoices=_b.placeholderChoices,normalChoices=_b.normalChoices;if(this.config.shouldSort||this._isSearching){normalChoices.sort(filter);}var choiceLimit=rendererableChoices.length;var sortedChoices=this._isSelectOneElement?__spreadArray(__spreadArray([],placeholderChoices,true),normalChoices,true):normalChoices;if(this._isSearching){choiceLimit=searchResultLimit;}else if(renderChoiceLimit&&renderChoiceLimit>0&&!withinGroup){choiceLimit=renderChoiceLimit;}for(var i=0;i<choiceLimit;i+=1){if(sortedChoices[i]){appendChoice(sortedChoices[i]);}}return fragment;};Choices3.prototype._createItemsFragment=function(items,fragment){var _this=this;if(fragment===void 0){fragment=document.createDocumentFragment();}var _a=this.config,shouldSortItems=_a.shouldSortItems,sorter=_a.sorter,removeItemButton=_a.removeItemButton;if(shouldSortItems&&!this._isSelectOneElement){items.sort(sorter);}if(this._isTextElement){this.passedElement.value=items.map(function(_a2){var value=_a2.value;return value;}).join(this.config.delimiter);}else{this.passedElement.options=items;}var addItemToFragment=function addItemToFragment(item2){var listItem=_this._getTemplate("item",item2,removeItemButton);fragment.appendChild(listItem);};items.forEach(addItemToFragment);return fragment;};Choices3.prototype._triggerChange=function(value){if(value===void 0||value===null){return;}this.passedElement.triggerEvent(constants_1.EVENTS.change,{value:value});};Choices3.prototype._selectPlaceholderChoice=function(placeholderChoice){this._addItem({value:placeholderChoice.value,label:placeholderChoice.label,choiceId:placeholderChoice.id,groupId:placeholderChoice.groupId,placeholder:placeholderChoice.placeholder});this._triggerChange(placeholderChoice.value);};Choices3.prototype._handleButtonAction=function(activeItems,element){if(!activeItems||!element||!this.config.removeItems||!this.config.removeItemButton){return;}var itemId=element.parentNode&&element.parentNode.dataset.id;var itemToRemove=itemId&&activeItems.find(function(item2){return item2.id===parseInt(itemId,10);});if(!itemToRemove){return;}this._removeItem(itemToRemove);this._triggerChange(itemToRemove.value);if(this._isSelectOneElement&&this._store.placeholderChoice){this._selectPlaceholderChoice(this._store.placeholderChoice);}};Choices3.prototype._handleItemAction=function(activeItems,element,hasShiftKey){var _this=this;if(hasShiftKey===void 0){hasShiftKey=false;}if(!activeItems||!element||!this.config.removeItems||this._isSelectOneElement){return;}var passedId=element.dataset.id;activeItems.forEach(function(item2){if(item2.id===parseInt("".concat(passedId),10)&&!item2.highlighted){_this.highlightItem(item2);}else if(!hasShiftKey&&item2.highlighted){_this.unhighlightItem(item2);}});this.input.focus();};Choices3.prototype._handleChoiceAction=function(activeItems,element){if(!activeItems||!element){return;}var id=element.dataset.id;var choice=id&&this._store.getChoiceById(id);if(!choice){return;}var passedKeyCode=activeItems[0]&&activeItems[0].keyCode?activeItems[0].keyCode:void 0;var hasActiveDropdown=this.dropdown.isActive;choice.keyCode=passedKeyCode;this.passedElement.triggerEvent(constants_1.EVENTS.choice,{choice:choice});if(!choice.selected&&!choice.disabled){var canAddItem=this._canAddItem(activeItems,choice.value);if(canAddItem.response){this._addItem({value:choice.value,label:choice.label,choiceId:choice.id,groupId:choice.groupId,customProperties:choice.customProperties,placeholder:choice.placeholder,keyCode:choice.keyCode});this._triggerChange(choice.value);}}this.clearInput();if(hasActiveDropdown&&this._isSelectOneElement){this.hideDropdown(true);this.containerOuter.focus();}};Choices3.prototype._handleBackspace=function(activeItems){if(!this.config.removeItems||!activeItems){return;}var lastItem=activeItems[activeItems.length-1];var hasHighlightedItems=activeItems.some(function(item2){return item2.highlighted;});if(this.config.editItems&&!hasHighlightedItems&&lastItem){this.input.value=lastItem.value;this.input.setWidth();this._removeItem(lastItem);this._triggerChange(lastItem.value);}else{if(!hasHighlightedItems){this.highlightItem(lastItem,false);}this.removeHighlightedItems(true);}};Choices3.prototype._startLoading=function(){this._store.dispatch((0,misc_1.setIsLoading)(true));};Choices3.prototype._stopLoading=function(){this._store.dispatch((0,misc_1.setIsLoading)(false));};Choices3.prototype._handleLoadingState=function(setLoading){if(setLoading===void 0){setLoading=true;}var placeholderItem=this.itemList.getChild(".".concat(this.config.classNames.placeholder));if(setLoading){this.disable();this.containerOuter.addLoadingState();if(this._isSelectOneElement){if(!placeholderItem){placeholderItem=this._getTemplate("placeholder",this.config.loadingText);if(placeholderItem){this.itemList.append(placeholderItem);}}else{placeholderItem.innerHTML=this.config.loadingText;}}else{this.input.placeholder=this.config.loadingText;}}else{this.enable();this.containerOuter.removeLoadingState();if(this._isSelectOneElement){if(placeholderItem){placeholderItem.innerHTML=this._placeholderValue||"";}}else{this.input.placeholder=this._placeholderValue||"";}}};Choices3.prototype._handleSearch=function(value){if(!this.input.isFocussed){return;}var choices=this._store.choices;var _a=this.config,searchFloor=_a.searchFloor,searchChoices=_a.searchChoices;var hasUnactiveChoices=choices.some(function(option3){return!option3.active;});if(value!==null&&typeof value!=="undefined"&&value.length>=searchFloor){var resultCount=searchChoices?this._searchChoices(value):0;this.passedElement.triggerEvent(constants_1.EVENTS.search,{value:value,resultCount:resultCount});}else if(hasUnactiveChoices){this._isSearching=false;this._store.dispatch((0,choices_1.activateChoices)(true));}};Choices3.prototype._canAddItem=function(activeItems,value){var canAddItem=true;var notice=typeof this.config.addItemText==="function"?this.config.addItemText(value):this.config.addItemText;if(!this._isSelectOneElement){var isDuplicateValue=(0,utils_1.existsInArray)(activeItems,value);if(this.config.maxItemCount>0&&this.config.maxItemCount<=activeItems.length){canAddItem=false;notice=typeof this.config.maxItemText==="function"?this.config.maxItemText(this.config.maxItemCount):this.config.maxItemText;}if(!this.config.duplicateItemsAllowed&&isDuplicateValue&&canAddItem){canAddItem=false;notice=typeof this.config.uniqueItemText==="function"?this.config.uniqueItemText(value):this.config.uniqueItemText;}if(this._isTextElement&&this.config.addItems&&canAddItem&&typeof this.config.addItemFilter==="function"&&!this.config.addItemFilter(value)){canAddItem=false;notice=typeof this.config.customAddItemText==="function"?this.config.customAddItemText(value):this.config.customAddItemText;}}return{response:canAddItem,notice:notice};};Choices3.prototype._searchChoices=function(value){var newValue=typeof value==="string"?value.trim():value;var currentValue=typeof this._currentValue==="string"?this._currentValue.trim():this._currentValue;if(newValue.length<1&&newValue==="".concat(currentValue," ")){return 0;}var haystack=this._store.searchableChoices;var needle=newValue;var options2=Object.assign(this.config.fuseOptions,{keys:__spreadArray([],this.config.searchFields,true),includeMatches:true});var fuse=new fuse_js_1["default"](haystack,options2);var results=fuse.search(needle);this._currentValue=newValue;this._highlightPosition=0;this._isSearching=true;this._store.dispatch((0,choices_1.filterChoices)(results));return results.length;};Choices3.prototype._addEventListeners=function(){var documentElement=document.documentElement;documentElement.addEventListener("touchend",this._onTouchEnd,true);this.containerOuter.element.addEventListener("keydown",this._onKeyDown,true);this.containerOuter.element.addEventListener("mousedown",this._onMouseDown,true);documentElement.addEventListener("click",this._onClick,{passive:true});documentElement.addEventListener("touchmove",this._onTouchMove,{passive:true});this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:true});if(this._isSelectOneElement){this.containerOuter.element.addEventListener("focus",this._onFocus,{passive:true});this.containerOuter.element.addEventListener("blur",this._onBlur,{passive:true});}this.input.element.addEventListener("keyup",this._onKeyUp,{passive:true});this.input.element.addEventListener("focus",this._onFocus,{passive:true});this.input.element.addEventListener("blur",this._onBlur,{passive:true});if(this.input.element.form){this.input.element.form.addEventListener("reset",this._onFormReset,{passive:true});}this.input.addEventListeners();};Choices3.prototype._removeEventListeners=function(){var documentElement=document.documentElement;documentElement.removeEventListener("touchend",this._onTouchEnd,true);this.containerOuter.element.removeEventListener("keydown",this._onKeyDown,true);this.containerOuter.element.removeEventListener("mousedown",this._onMouseDown,true);documentElement.removeEventListener("click",this._onClick);documentElement.removeEventListener("touchmove",this._onTouchMove);this.dropdown.element.removeEventListener("mouseover",this._onMouseOver);if(this._isSelectOneElement){this.containerOuter.element.removeEventListener("focus",this._onFocus);this.containerOuter.element.removeEventListener("blur",this._onBlur);}this.input.element.removeEventListener("keyup",this._onKeyUp);this.input.element.removeEventListener("focus",this._onFocus);this.input.element.removeEventListener("blur",this._onBlur);if(this.input.element.form){this.input.element.form.removeEventListener("reset",this._onFormReset);}this.input.removeEventListeners();};Choices3.prototype._onKeyDown=function(event){var keyCode=event.keyCode;var activeItems=this._store.activeItems;var hasFocusedInput=this.input.isFocussed;var hasActiveDropdown=this.dropdown.isActive;var hasItems=this.itemList.hasChildren();var keyString=String.fromCharCode(keyCode);var wasPrintableChar=/[^\x00-\x1F]/.test(keyString);var BACK_KEY=constants_1.KEY_CODES.BACK_KEY,DELETE_KEY=constants_1.KEY_CODES.DELETE_KEY,ENTER_KEY=constants_1.KEY_CODES.ENTER_KEY,A_KEY=constants_1.KEY_CODES.A_KEY,ESC_KEY=constants_1.KEY_CODES.ESC_KEY,UP_KEY=constants_1.KEY_CODES.UP_KEY,DOWN_KEY=constants_1.KEY_CODES.DOWN_KEY,PAGE_UP_KEY=constants_1.KEY_CODES.PAGE_UP_KEY,PAGE_DOWN_KEY=constants_1.KEY_CODES.PAGE_DOWN_KEY;if(!this._isTextElement&&!hasActiveDropdown&&wasPrintableChar){this.showDropdown();if(!this.input.isFocussed){this.input.value+=event.key.toLowerCase();}}switch(keyCode){case A_KEY:return this._onSelectKey(event,hasItems);case ENTER_KEY:return this._onEnterKey(event,activeItems,hasActiveDropdown);case ESC_KEY:return this._onEscapeKey(hasActiveDropdown);case UP_KEY:case PAGE_UP_KEY:case DOWN_KEY:case PAGE_DOWN_KEY:return this._onDirectionKey(event,hasActiveDropdown);case DELETE_KEY:case BACK_KEY:return this._onDeleteKey(event,activeItems,hasFocusedInput);default:}};Choices3.prototype._onKeyUp=function(_a){var target=_a.target,keyCode=_a.keyCode;var value=this.input.value;var activeItems=this._store.activeItems;var canAddItem=this._canAddItem(activeItems,value);var backKey=constants_1.KEY_CODES.BACK_KEY,deleteKey=constants_1.KEY_CODES.DELETE_KEY;if(this._isTextElement){var canShowDropdownNotice=canAddItem.notice&&value;if(canShowDropdownNotice){var dropdownItem=this._getTemplate("notice",canAddItem.notice);this.dropdown.element.innerHTML=dropdownItem.outerHTML;this.showDropdown(true);}else{this.hideDropdown(true);}}else{var wasRemovalKeyCode=keyCode===backKey||keyCode===deleteKey;var userHasRemovedValue=wasRemovalKeyCode&&target&&!target.value;var canReactivateChoices=!this._isTextElement&&this._isSearching;var canSearch=this._canSearch&&canAddItem.response;if(userHasRemovedValue&&canReactivateChoices){this._isSearching=false;this._store.dispatch((0,choices_1.activateChoices)(true));}else if(canSearch){this._handleSearch(this.input.rawValue);}}this._canSearch=this.config.searchEnabled;};Choices3.prototype._onSelectKey=function(event,hasItems){var ctrlKey=event.ctrlKey,metaKey=event.metaKey;var hasCtrlDownKeyPressed=ctrlKey||metaKey;if(hasCtrlDownKeyPressed&&hasItems){this._canSearch=false;var shouldHightlightAll=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;if(shouldHightlightAll){this.highlightAll();}}};Choices3.prototype._onEnterKey=function(event,activeItems,hasActiveDropdown){var target=event.target;var enterKey=constants_1.KEY_CODES.ENTER_KEY;var targetWasButton=target&&target.hasAttribute("data-button");if(this._isTextElement&&target&&target.value){var value=this.input.value;var canAddItem=this._canAddItem(activeItems,value);if(canAddItem.response){this.hideDropdown(true);this._addItem({value:value});this._triggerChange(value);this.clearInput();}}if(targetWasButton){this._handleButtonAction(activeItems,target);event.preventDefault();}if(hasActiveDropdown){var highlightedChoice=this.dropdown.getChild(".".concat(this.config.classNames.highlightedState));if(highlightedChoice){if(activeItems[0]){activeItems[0].keyCode=enterKey;}this._handleChoiceAction(activeItems,highlightedChoice);}event.preventDefault();}else if(this._isSelectOneElement){this.showDropdown();event.preventDefault();}};Choices3.prototype._onEscapeKey=function(hasActiveDropdown){if(hasActiveDropdown){this.hideDropdown(true);this.containerOuter.focus();}};Choices3.prototype._onDirectionKey=function(event,hasActiveDropdown){var keyCode=event.keyCode,metaKey=event.metaKey;var downKey=constants_1.KEY_CODES.DOWN_KEY,pageUpKey=constants_1.KEY_CODES.PAGE_UP_KEY,pageDownKey=constants_1.KEY_CODES.PAGE_DOWN_KEY;if(hasActiveDropdown||this._isSelectOneElement){this.showDropdown();this._canSearch=false;var directionInt=keyCode===downKey||keyCode===pageDownKey?1:-1;var skipKey=metaKey||keyCode===pageDownKey||keyCode===pageUpKey;var selectableChoiceIdentifier="[data-choice-selectable]";var nextEl2=void 0;if(skipKey){if(directionInt>0){nextEl2=this.dropdown.element.querySelector("".concat(selectableChoiceIdentifier,":last-of-type"));}else{nextEl2=this.dropdown.element.querySelector(selectableChoiceIdentifier);}}else{var currentEl=this.dropdown.element.querySelector(".".concat(this.config.classNames.highlightedState));if(currentEl){nextEl2=(0,utils_1.getAdjacentEl)(currentEl,selectableChoiceIdentifier,directionInt);}else{nextEl2=this.dropdown.element.querySelector(selectableChoiceIdentifier);}}if(nextEl2){if(!(0,utils_1.isScrolledIntoView)(nextEl2,this.choiceList.element,directionInt)){this.choiceList.scrollToChildElement(nextEl2,directionInt);}this._highlightChoice(nextEl2);}event.preventDefault();}};Choices3.prototype._onDeleteKey=function(event,activeItems,hasFocusedInput){var target=event.target;if(!this._isSelectOneElement&&!target.value&&hasFocusedInput){this._handleBackspace(activeItems);event.preventDefault();}};Choices3.prototype._onTouchMove=function(){if(this._wasTap){this._wasTap=false;}};Choices3.prototype._onTouchEnd=function(event){var target=(event||event.touches[0]).target;var touchWasWithinContainer=this._wasTap&&this.containerOuter.element.contains(target);if(touchWasWithinContainer){var containerWasExactTarget=target===this.containerOuter.element||target===this.containerInner.element;if(containerWasExactTarget){if(this._isTextElement){this.input.focus();}else if(this._isSelectMultipleElement){this.showDropdown();}}event.stopPropagation();}this._wasTap=true;};Choices3.prototype._onMouseDown=function(event){var target=event.target;if(!(target instanceof HTMLElement)){return;}if(IS_IE11&&this.choiceList.element.contains(target)){var firstChoice=this.choiceList.element.firstElementChild;var isOnScrollbar=this._direction==="ltr"?event.offsetX>=firstChoice.offsetWidth:event.offsetX<firstChoice.offsetLeft;this._isScrollingOnIe=isOnScrollbar;}if(target===this.input.element){return;}var item2=target.closest("[data-button],[data-item],[data-choice]");if(item2 instanceof HTMLElement){var hasShiftKey=event.shiftKey;var activeItems=this._store.activeItems;var dataset=item2.dataset;if("button"in dataset){this._handleButtonAction(activeItems,item2);}else if("item"in dataset){this._handleItemAction(activeItems,item2,hasShiftKey);}else if("choice"in dataset){this._handleChoiceAction(activeItems,item2);}}event.preventDefault();};Choices3.prototype._onMouseOver=function(_a){var target=_a.target;if(target instanceof HTMLElement&&"choice"in target.dataset){this._highlightChoice(target);}};Choices3.prototype._onClick=function(_a){var target=_a.target;var clickWasWithinContainer=this.containerOuter.element.contains(target);if(clickWasWithinContainer){if(!this.dropdown.isActive&&!this.containerOuter.isDisabled){if(this._isTextElement){if(document.activeElement!==this.input.element){this.input.focus();}}else{this.showDropdown();this.containerOuter.focus();}}else if(this._isSelectOneElement&&target!==this.input.element&&!this.dropdown.element.contains(target)){this.hideDropdown();}}else{var hasHighlightedItems=this._store.highlightedActiveItems.length>0;if(hasHighlightedItems){this.unhighlightAll();}this.containerOuter.removeFocusState();this.hideDropdown(true);}};Choices3.prototype._onFocus=function(_a){var _b;var _this=this;var target=_a.target;var focusWasWithinContainer=target&&this.containerOuter.element.contains(target);if(!focusWasWithinContainer){return;}var focusActions=(_b={},_b[constants_1.TEXT_TYPE]=function(){if(target===_this.input.element){_this.containerOuter.addFocusState();}},_b[constants_1.SELECT_ONE_TYPE]=function(){_this.containerOuter.addFocusState();if(target===_this.input.element){_this.showDropdown(true);}},_b[constants_1.SELECT_MULTIPLE_TYPE]=function(){if(target===_this.input.element){_this.showDropdown(true);_this.containerOuter.addFocusState();}},_b);focusActions[this.passedElement.element.type]();};Choices3.prototype._onBlur=function(_a){var _b;var _this=this;var target=_a.target;var blurWasWithinContainer=target&&this.containerOuter.element.contains(target);if(blurWasWithinContainer&&!this._isScrollingOnIe){var activeItems=this._store.activeItems;var hasHighlightedItems_1=activeItems.some(function(item2){return item2.highlighted;});var blurActions=(_b={},_b[constants_1.TEXT_TYPE]=function(){if(target===_this.input.element){_this.containerOuter.removeFocusState();if(hasHighlightedItems_1){_this.unhighlightAll();}_this.hideDropdown(true);}},_b[constants_1.SELECT_ONE_TYPE]=function(){_this.containerOuter.removeFocusState();if(target===_this.input.element||target===_this.containerOuter.element&&!_this._canSearch){_this.hideDropdown(true);}},_b[constants_1.SELECT_MULTIPLE_TYPE]=function(){if(target===_this.input.element){_this.containerOuter.removeFocusState();_this.hideDropdown(true);if(hasHighlightedItems_1){_this.unhighlightAll();}}},_b);blurActions[this.passedElement.element.type]();}else{this._isScrollingOnIe=false;this.input.element.focus();}};Choices3.prototype._onFormReset=function(){this._store.dispatch((0,misc_1.resetTo)(this._initialState));};Choices3.prototype._highlightChoice=function(el){var _this=this;if(el===void 0){el=null;}var choices=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));if(!choices.length){return;}var passedEl=el;var highlightedChoices=Array.from(this.dropdown.element.querySelectorAll(".".concat(this.config.classNames.highlightedState)));highlightedChoices.forEach(function(choice){choice.classList.remove(_this.config.classNames.highlightedState);choice.setAttribute("aria-selected","false");});if(passedEl){this._highlightPosition=choices.indexOf(passedEl);}else{if(choices.length>this._highlightPosition){passedEl=choices[this._highlightPosition];}else{passedEl=choices[choices.length-1];}if(!passedEl){passedEl=choices[0];}}passedEl.classList.add(this.config.classNames.highlightedState);passedEl.setAttribute("aria-selected","true");this.passedElement.triggerEvent(constants_1.EVENTS.highlightChoice,{el:passedEl});if(this.dropdown.isActive){this.input.setActiveDescendant(passedEl.id);this.containerOuter.setActiveDescendant(passedEl.id);}};Choices3.prototype._addItem=function(_a){var value=_a.value,_b=_a.label,label=_b===void 0?null:_b,_c=_a.choiceId,choiceId=_c===void 0?-1:_c,_d=_a.groupId,groupId=_d===void 0?-1:_d,_e=_a.customProperties,customProperties=_e===void 0?{}:_e,_f=_a.placeholder,placeholder=_f===void 0?false:_f,_g=_a.keyCode,keyCode=_g===void 0?-1:_g;var passedValue=typeof value==="string"?value.trim():value;var items=this._store.items;var passedLabel=label||passedValue;var passedOptionId=choiceId||-1;var group=groupId>=0?this._store.getGroupById(groupId):null;var id=items?items.length+1:1;if(this.config.prependValue){passedValue=this.config.prependValue+passedValue.toString();}if(this.config.appendValue){passedValue+=this.config.appendValue.toString();}this._store.dispatch((0,items_1.addItem)({value:passedValue,label:passedLabel,id:id,choiceId:passedOptionId,groupId:groupId,customProperties:customProperties,placeholder:placeholder,keyCode:keyCode}));if(this._isSelectOneElement){this.removeActiveItems(id);}this.passedElement.triggerEvent(constants_1.EVENTS.addItem,{id:id,value:passedValue,label:passedLabel,customProperties:customProperties,groupValue:group&&group.value?group.value:null,keyCode:keyCode});};Choices3.prototype._removeItem=function(item2){var id=item2.id,value=item2.value,label=item2.label,customProperties=item2.customProperties,choiceId=item2.choiceId,groupId=item2.groupId;var group=groupId&&groupId>=0?this._store.getGroupById(groupId):null;if(!id||!choiceId){return;}this._store.dispatch((0,items_1.removeItem)(id,choiceId));this.passedElement.triggerEvent(constants_1.EVENTS.removeItem,{id:id,value:value,label:label,customProperties:customProperties,groupValue:group&&group.value?group.value:null});};Choices3.prototype._addChoice=function(_a){var value=_a.value,_b=_a.label,label=_b===void 0?null:_b,_c=_a.isSelected,isSelected=_c===void 0?false:_c,_d=_a.isDisabled,isDisabled=_d===void 0?false:_d,_e=_a.groupId,groupId=_e===void 0?-1:_e,_f=_a.customProperties,customProperties=_f===void 0?{}:_f,_g=_a.placeholder,placeholder=_g===void 0?false:_g,_h=_a.keyCode,keyCode=_h===void 0?-1:_h;if(typeof value==="undefined"||value===null){return;}var choices=this._store.choices;var choiceLabel=label||value;var choiceId=choices?choices.length+1:1;var choiceElementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(choiceId);this._store.dispatch((0,choices_1.addChoice)({id:choiceId,groupId:groupId,elementId:choiceElementId,value:value,label:choiceLabel,disabled:isDisabled,customProperties:customProperties,placeholder:placeholder,keyCode:keyCode}));if(isSelected){this._addItem({value:value,label:choiceLabel,choiceId:choiceId,customProperties:customProperties,placeholder:placeholder,keyCode:keyCode});}};Choices3.prototype._addGroup=function(_a){var _this=this;var group=_a.group,id=_a.id,_b=_a.valueKey,valueKey=_b===void 0?"value":_b,_c=_a.labelKey,labelKey=_c===void 0?"label":_c;var groupChoices=(0,utils_1.isType)("Object",group)?group.choices:Array.from(group.getElementsByTagName("OPTION"));var groupId=id||Math.floor(new Date().valueOf()*Math.random());var isDisabled=group.disabled?group.disabled:false;if(groupChoices){this._store.dispatch((0,groups_1.addGroup)({value:group.label,id:groupId,active:true,disabled:isDisabled}));var addGroupChoices=function addGroupChoices(choice){var isOptDisabled=choice.disabled||choice.parentNode&&choice.parentNode.disabled;_this._addChoice({value:choice[valueKey],label:(0,utils_1.isType)("Object",choice)?choice[labelKey]:choice.innerHTML,isSelected:choice.selected,isDisabled:isOptDisabled,groupId:groupId,customProperties:choice.customProperties,placeholder:choice.placeholder});};groupChoices.forEach(addGroupChoices);}else{this._store.dispatch((0,groups_1.addGroup)({value:group.label,id:group.id,active:false,disabled:group.disabled}));}};Choices3.prototype._getTemplate=function(template){var _a;var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i];}return(_a=this._templates[template]).call.apply(_a,__spreadArray([this,this.config],args,false));};Choices3.prototype._createTemplates=function(){var callbackOnCreateTemplates=this.config.callbackOnCreateTemplates;var userTemplates={};if(callbackOnCreateTemplates&&typeof callbackOnCreateTemplates==="function"){userTemplates=callbackOnCreateTemplates.call(this,utils_1.strToEl);}this._templates=(0,deepmerge_1["default"])(templates_1["default"],userTemplates);};Choices3.prototype._createElements=function(){this.containerOuter=new components_1.Container({element:this._getTemplate("containerOuter",this._direction,this._isSelectElement,this._isSelectOneElement,this.config.searchEnabled,this.passedElement.element.type,this.config.labelId),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position});this.containerInner=new components_1.Container({element:this._getTemplate("containerInner"),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position});this.input=new components_1.Input({element:this._getTemplate("input",this._placeholderValue),classNames:this.config.classNames,type:this.passedElement.element.type,preventPaste:!this.config.paste});this.choiceList=new components_1.List({element:this._getTemplate("choiceList",this._isSelectOneElement)});this.itemList=new components_1.List({element:this._getTemplate("itemList",this._isSelectOneElement)});this.dropdown=new components_1.Dropdown({element:this._getTemplate("dropdown"),classNames:this.config.classNames,type:this.passedElement.element.type});};Choices3.prototype._createStructure=function(){this.passedElement.conceal();this.containerInner.wrap(this.passedElement.element);this.containerOuter.wrap(this.containerInner.element);if(this._isSelectOneElement){this.input.placeholder=this.config.searchPlaceholderValue||"";}else if(this._placeholderValue){this.input.placeholder=this._placeholderValue;this.input.setWidth();}this.containerOuter.element.appendChild(this.containerInner.element);this.containerOuter.element.appendChild(this.dropdown.element);this.containerInner.element.appendChild(this.itemList.element);if(!this._isTextElement){this.dropdown.element.appendChild(this.choiceList.element);}if(!this._isSelectOneElement){this.containerInner.element.appendChild(this.input.element);}else if(this.config.searchEnabled){this.dropdown.element.insertBefore(this.input.element,this.dropdown.element.firstChild);}if(this._isSelectElement){this._highlightPosition=0;this._isSearching=false;this._startLoading();if(this._presetGroups.length){this._addPredefinedGroups(this._presetGroups);}else{this._addPredefinedChoices(this._presetChoices);}this._stopLoading();}if(this._isTextElement){this._addPredefinedItems(this._presetItems);}};Choices3.prototype._addPredefinedGroups=function(groups){var _this=this;var placeholderChoice=this.passedElement.placeholderOption;if(placeholderChoice&&placeholderChoice.parentNode&&placeholderChoice.parentNode.tagName==="SELECT"){this._addChoice({value:placeholderChoice.value,label:placeholderChoice.innerHTML,isSelected:placeholderChoice.selected,isDisabled:placeholderChoice.disabled,placeholder:true});}groups.forEach(function(group){return _this._addGroup({group:group,id:group.id||null});});};Choices3.prototype._addPredefinedChoices=function(choices){var _this=this;if(this.config.shouldSort){choices.sort(this.config.sorter);}var hasSelectedChoice=choices.some(function(choice){return choice.selected;});var firstEnabledChoiceIndex=choices.findIndex(function(choice){return choice.disabled===void 0||!choice.disabled;});choices.forEach(function(choice,index2){var _a=choice.value,value=_a===void 0?"":_a,label=choice.label,customProperties=choice.customProperties,placeholder=choice.placeholder;if(_this._isSelectElement){if(choice.choices){_this._addGroup({group:choice,id:choice.id||null});}else{var shouldPreselect=_this._isSelectOneElement&&!hasSelectedChoice&&index2===firstEnabledChoiceIndex;var isSelected=shouldPreselect?true:choice.selected;var isDisabled=choice.disabled;_this._addChoice({value:value,label:label,isSelected:!!isSelected,isDisabled:!!isDisabled,placeholder:!!placeholder,customProperties:customProperties});}}else{_this._addChoice({value:value,label:label,isSelected:!!choice.selected,isDisabled:!!choice.disabled,placeholder:!!choice.placeholder,customProperties:customProperties});}});};Choices3.prototype._addPredefinedItems=function(items){var _this=this;items.forEach(function(item2){if(_typeof4(item2)==="object"&&item2.value){_this._addItem({value:item2.value,label:item2.label,choiceId:item2.id,customProperties:item2.customProperties,placeholder:item2.placeholder});}if(typeof item2==="string"){_this._addItem({value:item2});}});};Choices3.prototype._setChoiceOrItem=function(item2){var _this=this;var itemType=(0,utils_1.getType)(item2).toLowerCase();var handleType={object:function object(){if(!item2.value){return;}if(!_this._isTextElement){_this._addChoice({value:item2.value,label:item2.label,isSelected:true,isDisabled:false,customProperties:item2.customProperties,placeholder:item2.placeholder});}else{_this._addItem({value:item2.value,label:item2.label,choiceId:item2.id,customProperties:item2.customProperties,placeholder:item2.placeholder});}},string:function string(){if(!_this._isTextElement){_this._addChoice({value:item2,label:item2,isSelected:true,isDisabled:false});}else{_this._addItem({value:item2});}}};handleType[itemType]();};Choices3.prototype._findAndSelectChoiceByValue=function(value){var _this=this;var choices=this._store.choices;var foundChoice=choices.find(function(choice){return _this.config.valueComparer(choice.value,value);});if(foundChoice&&!foundChoice.selected){this._addItem({value:foundChoice.value,label:foundChoice.label,choiceId:foundChoice.id,groupId:foundChoice.groupId,customProperties:foundChoice.customProperties,placeholder:foundChoice.placeholder,keyCode:foundChoice.keyCode});}};Choices3.prototype._generatePlaceholderValue=function(){if(this._isSelectElement&&this.passedElement.placeholderOption){var placeholderOption=this.passedElement.placeholderOption;return placeholderOption?placeholderOption.text:null;}var _a=this.config,placeholder=_a.placeholder,placeholderValue=_a.placeholderValue;var dataset=this.passedElement.element.dataset;if(placeholder){if(placeholderValue){return placeholderValue;}if(dataset.placeholder){return dataset.placeholder;}}return null;};return Choices3;}();exports2["default"]=Choices2;},613:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});var utils_1=__webpack_require__2(799);var constants_1=__webpack_require__2(883);var Container=function(){function Container2(_a){var element=_a.element,type=_a.type,classNames=_a.classNames,position=_a.position;this.element=element;this.classNames=classNames;this.type=type;this.position=position;this.isOpen=false;this.isFlipped=false;this.isFocussed=false;this.isDisabled=false;this.isLoading=false;this._onFocus=this._onFocus.bind(this);this._onBlur=this._onBlur.bind(this);}Container2.prototype.addEventListeners=function(){this.element.addEventListener("focus",this._onFocus);this.element.addEventListener("blur",this._onBlur);};Container2.prototype.removeEventListeners=function(){this.element.removeEventListener("focus",this._onFocus);this.element.removeEventListener("blur",this._onBlur);};Container2.prototype.shouldFlip=function(dropdownPos){if(typeof dropdownPos!=="number"){return false;}var shouldFlip=false;if(this.position==="auto"){shouldFlip=!window.matchMedia("(min-height: ".concat(dropdownPos+1,"px)")).matches;}else if(this.position==="top"){shouldFlip=true;}return shouldFlip;};Container2.prototype.setActiveDescendant=function(activeDescendantID){this.element.setAttribute("aria-activedescendant",activeDescendantID);};Container2.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant");};Container2.prototype.open=function(dropdownPos){this.element.classList.add(this.classNames.openState);this.element.setAttribute("aria-expanded","true");this.isOpen=true;if(this.shouldFlip(dropdownPos)){this.element.classList.add(this.classNames.flippedState);this.isFlipped=true;}};Container2.prototype.close=function(){this.element.classList.remove(this.classNames.openState);this.element.setAttribute("aria-expanded","false");this.removeActiveDescendant();this.isOpen=false;if(this.isFlipped){this.element.classList.remove(this.classNames.flippedState);this.isFlipped=false;}};Container2.prototype.focus=function(){if(!this.isFocussed){this.element.focus();}};Container2.prototype.addFocusState=function(){this.element.classList.add(this.classNames.focusState);};Container2.prototype.removeFocusState=function(){this.element.classList.remove(this.classNames.focusState);};Container2.prototype.enable=function(){this.element.classList.remove(this.classNames.disabledState);this.element.removeAttribute("aria-disabled");if(this.type===constants_1.SELECT_ONE_TYPE){this.element.setAttribute("tabindex","0");}this.isDisabled=false;};Container2.prototype.disable=function(){this.element.classList.add(this.classNames.disabledState);this.element.setAttribute("aria-disabled","true");if(this.type===constants_1.SELECT_ONE_TYPE){this.element.setAttribute("tabindex","-1");}this.isDisabled=true;};Container2.prototype.wrap=function(element){(0,utils_1.wrap)(element,this.element);};Container2.prototype.unwrap=function(element){if(this.element.parentNode){this.element.parentNode.insertBefore(element,this.element);this.element.parentNode.removeChild(this.element);}};Container2.prototype.addLoadingState=function(){this.element.classList.add(this.classNames.loadingState);this.element.setAttribute("aria-busy","true");this.isLoading=true;};Container2.prototype.removeLoadingState=function(){this.element.classList.remove(this.classNames.loadingState);this.element.removeAttribute("aria-busy");this.isLoading=false;};Container2.prototype._onFocus=function(){this.isFocussed=true;};Container2.prototype._onBlur=function(){this.isFocussed=false;};return Container2;}();exports2["default"]=Container;},217:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});var Dropdown=function(){function Dropdown2(_a){var element=_a.element,type=_a.type,classNames=_a.classNames;this.element=element;this.classNames=classNames;this.type=type;this.isActive=false;}Object.defineProperty(Dropdown2.prototype,"distanceFromTopWindow",{get:function get(){return this.element.getBoundingClientRect().bottom;},enumerable:false,configurable:true});Dropdown2.prototype.getChild=function(selector){return this.element.querySelector(selector);};Dropdown2.prototype.show=function(){this.element.classList.add(this.classNames.activeState);this.element.setAttribute("aria-expanded","true");this.isActive=true;return this;};Dropdown2.prototype.hide=function(){this.element.classList.remove(this.classNames.activeState);this.element.setAttribute("aria-expanded","false");this.isActive=false;return this;};return Dropdown2;}();exports2["default"]=Dropdown;},520:function _(__unused_webpack_module,exports2,__webpack_require__2){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});exports2.WrappedSelect=exports2.WrappedInput=exports2.List=exports2.Input=exports2.Container=exports2.Dropdown=void 0;var dropdown_1=__importDefault(__webpack_require__2(217));exports2.Dropdown=dropdown_1["default"];var container_1=__importDefault(__webpack_require__2(613));exports2.Container=container_1["default"];var input_1=__importDefault(__webpack_require__2(11));exports2.Input=input_1["default"];var list_1=__importDefault(__webpack_require__2(624));exports2.List=list_1["default"];var wrapped_input_1=__importDefault(__webpack_require__2(541));exports2.WrappedInput=wrapped_input_1["default"];var wrapped_select_1=__importDefault(__webpack_require__2(982));exports2.WrappedSelect=wrapped_select_1["default"];},11:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});var utils_1=__webpack_require__2(799);var constants_1=__webpack_require__2(883);var Input=function(){function Input2(_a){var element=_a.element,type=_a.type,classNames=_a.classNames,preventPaste=_a.preventPaste;this.element=element;this.type=type;this.classNames=classNames;this.preventPaste=preventPaste;this.isFocussed=this.element.isEqualNode(document.activeElement);this.isDisabled=element.disabled;this._onPaste=this._onPaste.bind(this);this._onInput=this._onInput.bind(this);this._onFocus=this._onFocus.bind(this);this._onBlur=this._onBlur.bind(this);}Object.defineProperty(Input2.prototype,"placeholder",{set:function set(placeholder){this.element.placeholder=placeholder;},enumerable:false,configurable:true});Object.defineProperty(Input2.prototype,"value",{get:function get(){return(0,utils_1.sanitise)(this.element.value);},set:function set(value){this.element.value=value;},enumerable:false,configurable:true});Object.defineProperty(Input2.prototype,"rawValue",{get:function get(){return this.element.value;},enumerable:false,configurable:true});Input2.prototype.addEventListeners=function(){this.element.addEventListener("paste",this._onPaste);this.element.addEventListener("input",this._onInput,{passive:true});this.element.addEventListener("focus",this._onFocus,{passive:true});this.element.addEventListener("blur",this._onBlur,{passive:true});};Input2.prototype.removeEventListeners=function(){this.element.removeEventListener("input",this._onInput);this.element.removeEventListener("paste",this._onPaste);this.element.removeEventListener("focus",this._onFocus);this.element.removeEventListener("blur",this._onBlur);};Input2.prototype.enable=function(){this.element.removeAttribute("disabled");this.isDisabled=false;};Input2.prototype.disable=function(){this.element.setAttribute("disabled","");this.isDisabled=true;};Input2.prototype.focus=function(){if(!this.isFocussed){this.element.focus();}};Input2.prototype.blur=function(){if(this.isFocussed){this.element.blur();}};Input2.prototype.clear=function(setWidth){if(setWidth===void 0){setWidth=true;}if(this.element.value){this.element.value="";}if(setWidth){this.setWidth();}return this;};Input2.prototype.setWidth=function(){var _a=this.element,style=_a.style,value=_a.value,placeholder=_a.placeholder;style.minWidth="".concat(placeholder.length+1,"ch");style.width="".concat(value.length+1,"ch");};Input2.prototype.setActiveDescendant=function(activeDescendantID){this.element.setAttribute("aria-activedescendant",activeDescendantID);};Input2.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant");};Input2.prototype._onInput=function(){if(this.type!==constants_1.SELECT_ONE_TYPE){this.setWidth();}};Input2.prototype._onPaste=function(event){if(this.preventPaste){event.preventDefault();}};Input2.prototype._onFocus=function(){this.isFocussed=true;};Input2.prototype._onBlur=function(){this.isFocussed=false;};return Input2;}();exports2["default"]=Input;},624:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});var constants_1=__webpack_require__2(883);var List=function(){function List2(_a){var element=_a.element;this.element=element;this.scrollPos=this.element.scrollTop;this.height=this.element.offsetHeight;}List2.prototype.clear=function(){this.element.innerHTML="";};List2.prototype.append=function(node){this.element.appendChild(node);};List2.prototype.getChild=function(selector){return this.element.querySelector(selector);};List2.prototype.hasChildren=function(){return this.element.hasChildNodes();};List2.prototype.scrollToTop=function(){this.element.scrollTop=0;};List2.prototype.scrollToChildElement=function(element,direction){var _this=this;if(!element){return;}var listHeight=this.element.offsetHeight;var listScrollPosition=this.element.scrollTop+listHeight;var elementHeight=element.offsetHeight;var elementPos=element.offsetTop+elementHeight;var destination=direction>0?this.element.scrollTop+elementPos-listScrollPosition:element.offsetTop;requestAnimationFrame(function(){_this._animateScroll(destination,direction);});};List2.prototype._scrollDown=function(scrollPos,strength,destination){var easing=(destination-scrollPos)/strength;var distance=easing>1?easing:1;this.element.scrollTop=scrollPos+distance;};List2.prototype._scrollUp=function(scrollPos,strength,destination){var easing=(scrollPos-destination)/strength;var distance=easing>1?easing:1;this.element.scrollTop=scrollPos-distance;};List2.prototype._animateScroll=function(destination,direction){var _this=this;var strength=constants_1.SCROLLING_SPEED;var choiceListScrollTop=this.element.scrollTop;var continueAnimation=false;if(direction>0){this._scrollDown(choiceListScrollTop,strength,destination);if(choiceListScrollTop<destination){continueAnimation=true;}}else{this._scrollUp(choiceListScrollTop,strength,destination);if(choiceListScrollTop>destination){continueAnimation=true;}}if(continueAnimation){requestAnimationFrame(function(){_this._animateScroll(destination,direction);});}};return List2;}();exports2["default"]=List;},730:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});var utils_1=__webpack_require__2(799);var WrappedElement=function(){function WrappedElement2(_a){var element=_a.element,classNames=_a.classNames;this.element=element;this.classNames=classNames;if(!(element instanceof HTMLInputElement)&&!(element instanceof HTMLSelectElement)){throw new TypeError("Invalid element passed");}this.isDisabled=false;}Object.defineProperty(WrappedElement2.prototype,"isActive",{get:function get(){return this.element.dataset.choice==="active";},enumerable:false,configurable:true});Object.defineProperty(WrappedElement2.prototype,"dir",{get:function get(){return this.element.dir;},enumerable:false,configurable:true});Object.defineProperty(WrappedElement2.prototype,"value",{get:function get(){return this.element.value;},set:function set(value){this.element.value=value;},enumerable:false,configurable:true});WrappedElement2.prototype.conceal=function(){this.element.classList.add(this.classNames.input);this.element.hidden=true;this.element.tabIndex=-1;var origStyle=this.element.getAttribute("style");if(origStyle){this.element.setAttribute("data-choice-orig-style",origStyle);}this.element.setAttribute("data-choice","active");};WrappedElement2.prototype.reveal=function(){this.element.classList.remove(this.classNames.input);this.element.hidden=false;this.element.removeAttribute("tabindex");var origStyle=this.element.getAttribute("data-choice-orig-style");if(origStyle){this.element.removeAttribute("data-choice-orig-style");this.element.setAttribute("style",origStyle);}else{this.element.removeAttribute("style");}this.element.removeAttribute("data-choice");this.element.value=this.element.value;};WrappedElement2.prototype.enable=function(){this.element.removeAttribute("disabled");this.element.disabled=false;this.isDisabled=false;};WrappedElement2.prototype.disable=function(){this.element.setAttribute("disabled","");this.element.disabled=true;this.isDisabled=true;};WrappedElement2.prototype.triggerEvent=function(eventType,data3){(0,utils_1.dispatchEvent)(this.element,eventType,data3);};return WrappedElement2;}();exports2["default"]=WrappedElement;},541:function _(__unused_webpack_module,exports2,__webpack_require__2){var __extends=this&&this.__extends||function(){var _extendStatics=function extendStatics(d,b){_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2;}||function(d2,b2){for(var p2 in b2){if(Object.prototype.hasOwnProperty.call(b2,p2))d2[p2]=b2[p2];}};return _extendStatics(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");_extendStatics(d,b);function __(){this.constructor=d;}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};}();var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});var wrapped_element_1=__importDefault(__webpack_require__2(730));var WrappedInput=function(_super){__extends(WrappedInput2,_super);function WrappedInput2(_a){var element=_a.element,classNames=_a.classNames,delimiter=_a.delimiter;var _this=_super.call(this,{element:element,classNames:classNames})||this;_this.delimiter=delimiter;return _this;}Object.defineProperty(WrappedInput2.prototype,"value",{get:function get(){return this.element.value;},set:function set(value){this.element.setAttribute("value",value);this.element.value=value;},enumerable:false,configurable:true});return WrappedInput2;}(wrapped_element_1["default"]);exports2["default"]=WrappedInput;},982:function _(__unused_webpack_module,exports2,__webpack_require__2){var __extends=this&&this.__extends||function(){var _extendStatics2=function extendStatics(d,b){_extendStatics2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2;}||function(d2,b2){for(var p2 in b2){if(Object.prototype.hasOwnProperty.call(b2,p2))d2[p2]=b2[p2];}};return _extendStatics2(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");_extendStatics2(d,b);function __(){this.constructor=d;}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};}();var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});var wrapped_element_1=__importDefault(__webpack_require__2(730));var WrappedSelect=function(_super){__extends(WrappedSelect2,_super);function WrappedSelect2(_a){var element=_a.element,classNames=_a.classNames,template=_a.template;var _this=_super.call(this,{element:element,classNames:classNames})||this;_this.template=template;return _this;}Object.defineProperty(WrappedSelect2.prototype,"placeholderOption",{get:function get(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]");},enumerable:false,configurable:true});Object.defineProperty(WrappedSelect2.prototype,"optionGroups",{get:function get(){return Array.from(this.element.getElementsByTagName("OPTGROUP"));},enumerable:false,configurable:true});Object.defineProperty(WrappedSelect2.prototype,"options",{get:function get(){return Array.from(this.element.options);},set:function set(options2){var _this=this;var fragment=document.createDocumentFragment();var addOptionToFragment=function addOptionToFragment(data3){var option3=_this.template(data3);fragment.appendChild(option3);};options2.forEach(function(optionData){return addOptionToFragment(optionData);});this.appendDocFragment(fragment);},enumerable:false,configurable:true});WrappedSelect2.prototype.appendDocFragment=function(fragment){this.element.innerHTML="";this.element.appendChild(fragment);};return WrappedSelect2;}(wrapped_element_1["default"]);exports2["default"]=WrappedSelect;},883:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.SCROLLING_SPEED=exports2.SELECT_MULTIPLE_TYPE=exports2.SELECT_ONE_TYPE=exports2.TEXT_TYPE=exports2.KEY_CODES=exports2.ACTION_TYPES=exports2.EVENTS=void 0;exports2.EVENTS={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"};exports2.ACTION_TYPES={ADD_CHOICE:"ADD_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM",CLEAR_ALL:"CLEAR_ALL",RESET_TO:"RESET_TO",SET_IS_LOADING:"SET_IS_LOADING"};exports2.KEY_CODES={BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34};exports2.TEXT_TYPE="text";exports2.SELECT_ONE_TYPE="select-one";exports2.SELECT_MULTIPLE_TYPE="select-multiple";exports2.SCROLLING_SPEED=4;},789:function _(__unused_webpack_module,exports2,__webpack_require__2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.DEFAULT_CONFIG=exports2.DEFAULT_CLASSNAMES=void 0;var utils_1=__webpack_require__2(799);exports2.DEFAULT_CLASSNAMES={containerOuter:"choices",containerInner:"choices__inner",input:"choices__input",inputCloned:"choices__input--cloned",list:"choices__list",listItems:"choices__list--multiple",listSingle:"choices__list--single",listDropdown:"choices__list--dropdown",item:"choices__item",itemSelectable:"choices__item--selectable",itemDisabled:"choices__item--disabled",itemChoice:"choices__item--choice",placeholder:"choices__placeholder",group:"choices__group",groupHeading:"choices__heading",button:"choices__button",activeState:"is-active",focusState:"is-focused",openState:"is-open",disabledState:"is-disabled",highlightedState:"is-highlighted",selectedState:"is-selected",flippedState:"is-flipped",loadingState:"is-loading",noResults:"has-no-results",noChoices:"has-no-choices"};exports2.DEFAULT_CONFIG={items:[],choices:[],silent:false,renderChoiceLimit:-1,maxItemCount:-1,addItems:true,addItemFilter:null,removeItems:true,removeItemButton:false,editItems:false,allowHTML:true,duplicateItemsAllowed:true,delimiter:",",paste:true,searchEnabled:true,searchChoices:true,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:true,shouldSort:true,shouldSortItems:false,sorter:utils_1.sortByAlpha,placeholder:true,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function addItemText(value){return'Press Enter to add <b>"'.concat((0,utils_1.sanitise)(value),'"</b>');},maxItemText:function maxItemText(maxItemCount){return"Only ".concat(maxItemCount," values can be added");},valueComparer:function valueComparer(value1,value2){return value1===value2;},fuseOptions:{includeScore:true},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:exports2.DEFAULT_CLASSNAMES};},18:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},978:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},948:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},359:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},285:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},533:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},187:function _(__unused_webpack_module,exports2,__webpack_require__2){var __createBinding=this&&this.__createBinding||(Object.create?function(o2,m,k,k2){if(k2===void 0)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k];}};}Object.defineProperty(o2,k2,desc);}:function(o2,m,k,k2){if(k2===void 0)k2=k;o2[k2]=m[k];});var __exportStar2=this&&this.__exportStar||function(m,exports3){for(var p2 in m){if(p2!=="default"&&!Object.prototype.hasOwnProperty.call(exports3,p2))__createBinding(exports3,m,p2);}};Object.defineProperty(exports2,"__esModule",{value:true});__exportStar2(__webpack_require__2(18),exports2);__exportStar2(__webpack_require__2(978),exports2);__exportStar2(__webpack_require__2(948),exports2);__exportStar2(__webpack_require__2(359),exports2);__exportStar2(__webpack_require__2(285),exports2);__exportStar2(__webpack_require__2(533),exports2);__exportStar2(__webpack_require__2(287),exports2);__exportStar2(__webpack_require__2(132),exports2);__exportStar2(__webpack_require__2(837),exports2);__exportStar2(__webpack_require__2(598),exports2);__exportStar2(__webpack_require__2(369),exports2);__exportStar2(__webpack_require__2(37),exports2);__exportStar2(__webpack_require__2(47),exports2);__exportStar2(__webpack_require__2(923),exports2);__exportStar2(__webpack_require__2(876),exports2);},287:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},132:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},837:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},598:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},37:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},369:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},47:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},923:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},876:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});},799:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.parseCustomProperties=exports2.diff=exports2.cloneObject=exports2.existsInArray=exports2.dispatchEvent=exports2.sortByScore=exports2.sortByAlpha=exports2.strToEl=exports2.sanitise=exports2.isScrolledIntoView=exports2.getAdjacentEl=exports2.wrap=exports2.isType=exports2.getType=exports2.generateId=exports2.generateChars=exports2.getRandomNumber=void 0;var getRandomNumber2=function getRandomNumber2(min3,max3){return Math.floor(Math.random()*(max3-min3)+min3);};exports2.getRandomNumber=getRandomNumber2;var generateChars=function generateChars(length){return Array.from({length:length},function(){return(0,exports2.getRandomNumber)(0,36).toString(36);}).join("");};exports2.generateChars=generateChars;var generateId=function generateId(element,prefix){var id=element.id||element.name&&"".concat(element.name,"-").concat((0,exports2.generateChars)(2))||(0,exports2.generateChars)(4);id=id.replace(/(:|\.|\[|\]|,)/g,"");id="".concat(prefix,"-").concat(id);return id;};exports2.generateId=generateId;var getType2=function getType2(obj){return Object.prototype.toString.call(obj).slice(8,-1);};exports2.getType=getType2;var isType=function isType(type,obj){return obj!==void 0&&obj!==null&&(0,exports2.getType)(obj)===type;};exports2.isType=isType;var wrap2=function wrap2(element,wrapper3){if(wrapper3===void 0){wrapper3=document.createElement("div");}if(element.parentNode){if(element.nextSibling){element.parentNode.insertBefore(wrapper3,element.nextSibling);}else{element.parentNode.appendChild(wrapper3);}}return wrapper3.appendChild(element);};exports2.wrap=wrap2;var getAdjacentEl=function getAdjacentEl(startEl,selector,direction){if(direction===void 0){direction=1;}var prop="".concat(direction>0?"next":"previous","ElementSibling");var sibling=startEl[prop];while(sibling){if(sibling.matches(selector)){return sibling;}sibling=sibling[prop];}return sibling;};exports2.getAdjacentEl=getAdjacentEl;var isScrolledIntoView=function isScrolledIntoView(element,parent,direction){if(direction===void 0){direction=1;}if(!element){return false;}var isVisible;if(direction>0){isVisible=parent.scrollTop+parent.offsetHeight>=element.offsetTop+element.offsetHeight;}else{isVisible=element.offsetTop>=parent.scrollTop;}return isVisible;};exports2.isScrolledIntoView=isScrolledIntoView;var sanitise=function sanitise(value){if(typeof value!=="string"){return value;}return value.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};exports2.sanitise=sanitise;exports2.strToEl=function(){var tmpEl=document.createElement("div");return function(str){var cleanedInput=str.trim();tmpEl.innerHTML=cleanedInput;var firldChild=tmpEl.children[0];while(tmpEl.firstChild){tmpEl.removeChild(tmpEl.firstChild);}return firldChild;};}();var sortByAlpha=function sortByAlpha(_a,_b){var value=_a.value,_c=_a.label,label=_c===void 0?value:_c;var value2=_b.value,_d=_b.label,label2=_d===void 0?value2:_d;return label.localeCompare(label2,[],{sensitivity:"base",ignorePunctuation:true,numeric:true});};exports2.sortByAlpha=sortByAlpha;var sortByScore=function sortByScore(a2,b){var _a=a2.score,scoreA=_a===void 0?0:_a;var _b=b.score,scoreB=_b===void 0?0:_b;return scoreA-scoreB;};exports2.sortByScore=sortByScore;var dispatchEvent2=function dispatchEvent2(element,type,customArgs){if(customArgs===void 0){customArgs=null;}var event=new CustomEvent(type,{detail:customArgs,bubbles:true,cancelable:true});return element.dispatchEvent(event);};exports2.dispatchEvent=dispatchEvent2;var existsInArray=function existsInArray(array,value,key){if(key===void 0){key="value";}return array.some(function(item2){if(typeof value==="string"){return item2[key]===value.trim();}return item2[key]===value;});};exports2.existsInArray=existsInArray;var cloneObject=function cloneObject(obj){return JSON.parse(JSON.stringify(obj));};exports2.cloneObject=cloneObject;var diff=function diff(a2,b){var aKeys=Object.keys(a2).sort();var bKeys=Object.keys(b).sort();return aKeys.filter(function(i){return bKeys.indexOf(i)<0;});};exports2.diff=diff;var parseCustomProperties=function parseCustomProperties(customProperties){if(typeof customProperties!=="undefined"){try{return JSON.parse(customProperties);}catch(e2){return customProperties;}}return{};};exports2.parseCustomProperties=parseCustomProperties;},273:function _(__unused_webpack_module,exports2){var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}return to.concat(ar||Array.prototype.slice.call(from));};Object.defineProperty(exports2,"__esModule",{value:true});exports2.defaultState=void 0;exports2.defaultState=[];function choices(state2,action){if(state2===void 0){state2=exports2.defaultState;}if(action===void 0){action={};}switch(action.type){case"ADD_CHOICE":{var addChoiceAction=action;var choice={id:addChoiceAction.id,elementId:addChoiceAction.elementId,groupId:addChoiceAction.groupId,value:addChoiceAction.value,label:addChoiceAction.label||addChoiceAction.value,disabled:addChoiceAction.disabled||false,selected:false,active:true,score:9999,customProperties:addChoiceAction.customProperties,placeholder:addChoiceAction.placeholder||false};return __spreadArray(__spreadArray([],state2,true),[choice],false);}case"ADD_ITEM":{var addItemAction_1=action;if(addItemAction_1.choiceId>-1){return state2.map(function(obj){var choice2=obj;if(choice2.id===parseInt("".concat(addItemAction_1.choiceId),10)){choice2.selected=true;}return choice2;});}return state2;}case"REMOVE_ITEM":{var removeItemAction_1=action;if(removeItemAction_1.choiceId&&removeItemAction_1.choiceId>-1){return state2.map(function(obj){var choice2=obj;if(choice2.id===parseInt("".concat(removeItemAction_1.choiceId),10)){choice2.selected=false;}return choice2;});}return state2;}case"FILTER_CHOICES":{var filterChoicesAction_1=action;return state2.map(function(obj){var choice2=obj;choice2.active=filterChoicesAction_1.results.some(function(_a){var item2=_a.item,score=_a.score;if(item2.id===choice2.id){choice2.score=score;return true;}return false;});return choice2;});}case"ACTIVATE_CHOICES":{var activateChoicesAction_1=action;return state2.map(function(obj){var choice2=obj;choice2.active=activateChoicesAction_1.active;return choice2;});}case"CLEAR_CHOICES":{return exports2.defaultState;}default:{return state2;}}}exports2["default"]=choices;},871:function _(__unused_webpack_module,exports2){var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}return to.concat(ar||Array.prototype.slice.call(from));};Object.defineProperty(exports2,"__esModule",{value:true});exports2.defaultState=void 0;exports2.defaultState=[];function groups(state2,action){if(state2===void 0){state2=exports2.defaultState;}if(action===void 0){action={};}switch(action.type){case"ADD_GROUP":{var addGroupAction=action;return __spreadArray(__spreadArray([],state2,true),[{id:addGroupAction.id,value:addGroupAction.value,active:addGroupAction.active,disabled:addGroupAction.disabled}],false);}case"CLEAR_CHOICES":{return[];}default:{return state2;}}}exports2["default"]=groups;},655:function _(__unused_webpack_module,exports2,__webpack_require__2){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});exports2.defaultState=void 0;var redux_1=__webpack_require__2(791);var items_1=__importDefault(__webpack_require__2(52));var groups_1=__importDefault(__webpack_require__2(871));var choices_1=__importDefault(__webpack_require__2(273));var loading_1=__importDefault(__webpack_require__2(502));var utils_1=__webpack_require__2(799);exports2.defaultState={groups:[],items:[],choices:[],loading:false};var appReducer=(0,redux_1.combineReducers)({items:items_1["default"],groups:groups_1["default"],choices:choices_1["default"],loading:loading_1["default"]});var rootReducer=function rootReducer(passedState,action){var state2=passedState;if(action.type==="CLEAR_ALL"){state2=exports2.defaultState;}else if(action.type==="RESET_TO"){return(0,utils_1.cloneObject)(action.state);}return appReducer(state2,action);};exports2["default"]=rootReducer;},52:function _(__unused_webpack_module,exports2){var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}return to.concat(ar||Array.prototype.slice.call(from));};Object.defineProperty(exports2,"__esModule",{value:true});exports2.defaultState=void 0;exports2.defaultState=[];function items(state2,action){if(state2===void 0){state2=exports2.defaultState;}if(action===void 0){action={};}switch(action.type){case"ADD_ITEM":{var addItemAction=action;var newState=__spreadArray(__spreadArray([],state2,true),[{id:addItemAction.id,choiceId:addItemAction.choiceId,groupId:addItemAction.groupId,value:addItemAction.value,label:addItemAction.label,active:true,highlighted:false,customProperties:addItemAction.customProperties,placeholder:addItemAction.placeholder||false,keyCode:null}],false);return newState.map(function(obj){var item2=obj;item2.highlighted=false;return item2;});}case"REMOVE_ITEM":{return state2.map(function(obj){var item2=obj;if(item2.id===action.id){item2.active=false;}return item2;});}case"HIGHLIGHT_ITEM":{var highlightItemAction_1=action;return state2.map(function(obj){var item2=obj;if(item2.id===highlightItemAction_1.id){item2.highlighted=highlightItemAction_1.highlighted;}return item2;});}default:{return state2;}}}exports2["default"]=items;},502:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});exports2.defaultState=void 0;exports2.defaultState=false;var general=function general(state2,action){if(state2===void 0){state2=exports2.defaultState;}if(action===void 0){action={};}switch(action.type){case"SET_IS_LOADING":{return action.isLoading;}default:{return state2;}}};exports2["default"]=general;},744:function _(__unused_webpack_module,exports2,__webpack_require__2){var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}return to.concat(ar||Array.prototype.slice.call(from));};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod};};Object.defineProperty(exports2,"__esModule",{value:true});var redux_1=__webpack_require__2(791);var index_1=__importDefault(__webpack_require__2(655));var Store=function(){function Store2(){this._store=(0,redux_1.createStore)(index_1["default"],window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());}Store2.prototype.subscribe=function(onChange2){this._store.subscribe(onChange2);};Store2.prototype.dispatch=function(action){this._store.dispatch(action);};Object.defineProperty(Store2.prototype,"state",{get:function get(){return this._store.getState();},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"items",{get:function get(){return this.state.items;},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"activeItems",{get:function get(){return this.items.filter(function(item2){return item2.active===true;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"highlightedActiveItems",{get:function get(){return this.items.filter(function(item2){return item2.active&&item2.highlighted;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"choices",{get:function get(){return this.state.choices;},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"activeChoices",{get:function get(){return this.choices.filter(function(choice){return choice.active===true;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"selectableChoices",{get:function get(){return this.choices.filter(function(choice){return choice.disabled!==true;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"searchableChoices",{get:function get(){return this.selectableChoices.filter(function(choice){return choice.placeholder!==true;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"placeholderChoice",{get:function get(){return __spreadArray([],this.choices,true).reverse().find(function(choice){return choice.placeholder===true;});},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"groups",{get:function get(){return this.state.groups;},enumerable:false,configurable:true});Object.defineProperty(Store2.prototype,"activeGroups",{get:function get(){var _a=this,groups=_a.groups,choices=_a.choices;return groups.filter(function(group){var isActive=group.active===true&&group.disabled===false;var hasActiveOptions=choices.some(function(choice){return choice.active===true&&choice.disabled===false;});return isActive&&hasActiveOptions;},[]);},enumerable:false,configurable:true});Store2.prototype.isLoading=function(){return this.state.loading;};Store2.prototype.getChoiceById=function(id){return this.activeChoices.find(function(choice){return choice.id===parseInt(id,10);});};Store2.prototype.getGroupById=function(id){return this.groups.find(function(group){return group.id===id;});};return Store2;}();exports2["default"]=Store;},686:function _(__unused_webpack_module,exports2){Object.defineProperty(exports2,"__esModule",{value:true});var templates={containerOuter:function containerOuter(_a,dir,isSelectElement,isSelectOneElement,searchEnabled,passedElementType,labelId){var containerOuter=_a.classNames.containerOuter;var div=Object.assign(document.createElement("div"),{className:containerOuter});div.dataset.type=passedElementType;if(dir){div.dir=dir;}if(isSelectOneElement){div.tabIndex=0;}if(isSelectElement){div.setAttribute("role",searchEnabled?"combobox":"listbox");if(searchEnabled){div.setAttribute("aria-autocomplete","list");}}div.setAttribute("aria-haspopup","true");div.setAttribute("aria-expanded","false");if(labelId){div.setAttribute("aria-labelledby",labelId);}return div;},containerInner:function containerInner(_a){var containerInner=_a.classNames.containerInner;return Object.assign(document.createElement("div"),{className:containerInner});},itemList:function itemList(_a,isSelectOneElement){var _b=_a.classNames,list2=_b.list,listSingle=_b.listSingle,listItems=_b.listItems;return Object.assign(document.createElement("div"),{className:"".concat(list2," ").concat(isSelectOneElement?listSingle:listItems)});},placeholder:function placeholder(_a,value){var _b;var allowHTML=_a.allowHTML,placeholder=_a.classNames.placeholder;return Object.assign(document.createElement("div"),(_b={className:placeholder},_b[allowHTML?"innerHTML":"innerText"]=value,_b));},item:function item(_a,_b,removeItemButton){var _c,_d;var allowHTML=_a.allowHTML,_e=_a.classNames,item2=_e.item,button=_e.button,highlightedState=_e.highlightedState,itemSelectable=_e.itemSelectable,placeholder=_e.placeholder;var id=_b.id,value=_b.value,label=_b.label,customProperties=_b.customProperties,active=_b.active,disabled=_b.disabled,highlighted=_b.highlighted,isPlaceholder=_b.placeholder;var div=Object.assign(document.createElement("div"),(_c={className:item2},_c[allowHTML?"innerHTML":"innerText"]=label,_c));Object.assign(div.dataset,{item:"",id:id,value:value,customProperties:customProperties});if(active){div.setAttribute("aria-selected","true");}if(disabled){div.setAttribute("aria-disabled","true");}if(isPlaceholder){div.classList.add(placeholder);}div.classList.add(highlighted?highlightedState:itemSelectable);if(removeItemButton){if(disabled){div.classList.remove(itemSelectable);}div.dataset.deletable="";var REMOVE_ITEM_TEXT="Remove item";var removeButton=Object.assign(document.createElement("button"),(_d={type:"button",className:button},_d[allowHTML?"innerHTML":"innerText"]=REMOVE_ITEM_TEXT,_d));removeButton.setAttribute("aria-label","".concat(REMOVE_ITEM_TEXT,": '").concat(value,"'"));removeButton.dataset.button="";div.appendChild(removeButton);}return div;},choiceList:function choiceList(_a,isSelectOneElement){var list2=_a.classNames.list;var div=Object.assign(document.createElement("div"),{className:list2});if(!isSelectOneElement){div.setAttribute("aria-multiselectable","true");}div.setAttribute("role","listbox");return div;},choiceGroup:function choiceGroup(_a,_b){var _c;var allowHTML=_a.allowHTML,_d=_a.classNames,group=_d.group,groupHeading=_d.groupHeading,itemDisabled=_d.itemDisabled;var id=_b.id,value=_b.value,disabled=_b.disabled;var div=Object.assign(document.createElement("div"),{className:"".concat(group," ").concat(disabled?itemDisabled:"")});div.setAttribute("role","group");Object.assign(div.dataset,{group:"",id:id,value:value});if(disabled){div.setAttribute("aria-disabled","true");}div.appendChild(Object.assign(document.createElement("div"),(_c={className:groupHeading},_c[allowHTML?"innerHTML":"innerText"]=value,_c)));return div;},choice:function choice(_a,_b,selectText){var _c;var allowHTML=_a.allowHTML,_d=_a.classNames,item2=_d.item,itemChoice=_d.itemChoice,itemSelectable=_d.itemSelectable,selectedState=_d.selectedState,itemDisabled=_d.itemDisabled,placeholder=_d.placeholder;var id=_b.id,value=_b.value,label=_b.label,groupId=_b.groupId,elementId=_b.elementId,isDisabled=_b.disabled,isSelected=_b.selected,isPlaceholder=_b.placeholder;var div=Object.assign(document.createElement("div"),(_c={id:elementId},_c[allowHTML?"innerHTML":"innerText"]=label,_c.className="".concat(item2," ").concat(itemChoice),_c));if(isSelected){div.classList.add(selectedState);}if(isPlaceholder){div.classList.add(placeholder);}div.setAttribute("role",groupId&&groupId>0?"treeitem":"option");Object.assign(div.dataset,{choice:"",id:id,value:value,selectText:selectText});if(isDisabled){div.classList.add(itemDisabled);div.dataset.choiceDisabled="";div.setAttribute("aria-disabled","true");}else{div.classList.add(itemSelectable);div.dataset.choiceSelectable="";}return div;},input:function input(_a,placeholderValue){var _b=_a.classNames,input=_b.input,inputCloned=_b.inputCloned;var inp=Object.assign(document.createElement("input"),{type:"search",name:"search_terms",className:"".concat(input," ").concat(inputCloned),autocomplete:"off",autocapitalize:"off",spellcheck:false});inp.setAttribute("role","textbox");inp.setAttribute("aria-autocomplete","list");inp.setAttribute("aria-label",placeholderValue);return inp;},dropdown:function dropdown(_a){var _b=_a.classNames,list2=_b.list,listDropdown=_b.listDropdown;var div=document.createElement("div");div.classList.add(list2,listDropdown);div.setAttribute("aria-expanded","false");return div;},notice:function notice(_a,innerText,type){var _b;var allowHTML=_a.allowHTML,_c=_a.classNames,item2=_c.item,itemChoice=_c.itemChoice,noResults=_c.noResults,noChoices=_c.noChoices;if(type===void 0){type="";}var classes=[item2,itemChoice];if(type==="no-choices"){classes.push(noChoices);}else if(type==="no-results"){classes.push(noResults);}return Object.assign(document.createElement("div"),(_b={},_b[allowHTML?"innerHTML":"innerText"]=innerText,_b.className=classes.join(" "),_b));},option:function option(_a){var label=_a.label,value=_a.value,customProperties=_a.customProperties,active=_a.active,disabled=_a.disabled;var opt=new Option(label,value,false,active);if(customProperties){opt.dataset.customProperties="".concat(customProperties);}opt.disabled=!!disabled;return opt;}};exports2["default"]=templates;},996:function _(module2){var isMergeableObject=function isMergeableObject2(value){return isNonNullObject(value)&&!isSpecial(value);};function isNonNullObject(value){return!!value&&_typeof4(value)==="object";}function isSpecial(value){var stringValue=Object.prototype.toString.call(value);return stringValue==="[object RegExp]"||stringValue==="[object Date]"||isReactElement(value);}var canUseSymbol=typeof Symbol==="function"&&Symbol["for"];var REACT_ELEMENT_TYPE=canUseSymbol?Symbol["for"]("react.element"):60103;function isReactElement(value){return value.$$typeof===REACT_ELEMENT_TYPE;}function emptyTarget(val){return Array.isArray(val)?[]:{};}function cloneUnlessOtherwiseSpecified(value,options2){return options2.clone!==false&&options2.isMergeableObject(value)?deepmerge(emptyTarget(value),value,options2):value;}function defaultArrayMerge(target,source,options2){return target.concat(source).map(function(element){return cloneUnlessOtherwiseSpecified(element,options2);});}function getMergeFunction(key,options2){if(!options2.customMerge){return deepmerge;}var customMerge=options2.customMerge(key);return typeof customMerge==="function"?customMerge:deepmerge;}function getEnumerableOwnPropertySymbols(target){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(target).filter(function(symbol){return target.propertyIsEnumerable(symbol);}):[];}function getKeys(target){return Object.keys(target).concat(getEnumerableOwnPropertySymbols(target));}function propertyIsOnObject(object,property){try{return property in object;}catch(_){return false;}}function propertyIsUnsafe(target,key){return propertyIsOnObject(target,key)&&!(Object.hasOwnProperty.call(target,key)&&Object.propertyIsEnumerable.call(target,key));}function mergeObject(target,source,options2){var destination={};if(options2.isMergeableObject(target)){getKeys(target).forEach(function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options2);});}getKeys(source).forEach(function(key){if(propertyIsUnsafe(target,key)){return;}if(propertyIsOnObject(target,key)&&options2.isMergeableObject(source[key])){destination[key]=getMergeFunction(key,options2)(target[key],source[key],options2);}else{destination[key]=cloneUnlessOtherwiseSpecified(source[key],options2);}});return destination;}function deepmerge(target,source,options2){options2=options2||{};options2.arrayMerge=options2.arrayMerge||defaultArrayMerge;options2.isMergeableObject=options2.isMergeableObject||isMergeableObject;options2.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var sourceIsArray=Array.isArray(source);var targetIsArray=Array.isArray(target);var sourceAndTargetTypesMatch=sourceIsArray===targetIsArray;if(!sourceAndTargetTypesMatch){return cloneUnlessOtherwiseSpecified(source,options2);}else if(sourceIsArray){return options2.arrayMerge(target,source,options2);}else{return mergeObject(target,source,options2);}}deepmerge.all=function deepmergeAll(array,options2){if(!Array.isArray(array)){throw new Error("first argument should be an array");}return array.reduce(function(prev,next){return deepmerge(prev,next,options2);},{});};var deepmerge_1=deepmerge;module2.exports=deepmerge_1;},221:function _(__unused_webpack_module,__webpack_exports__2,__webpack_require__2){__webpack_require__2.r(__webpack_exports__2);__webpack_require__2.d(__webpack_exports__2,{"default":function _default(){return Fuse;}});function isArray2(value){return!Array.isArray?getTag(value)==="[object Array]":Array.isArray(value);}var INFINITY=1/0;function baseToString(value){if(typeof value=="string"){return value;}var result=value+"";return result=="0"&&1/value==-INFINITY?"-0":result;}function toString2(value){return value==null?"":baseToString(value);}function isString3(value){return typeof value==="string";}function isNumber2(value){return typeof value==="number";}function isBoolean2(value){return value===true||value===false||isObjectLike(value)&&getTag(value)=="[object Boolean]";}function isObject2(value){return _typeof4(value)==="object";}function isObjectLike(value){return isObject2(value)&&value!==null;}function isDefined4(value){return value!==void 0&&value!==null;}function isBlank(value){return!value.trim().length;}function getTag(value){return value==null?value===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(value);}var EXTENDED_SEARCH_UNAVAILABLE="Extended search is not available";var INCORRECT_INDEX_TYPE="Incorrect 'index' type";var LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY=function LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key){return"Invalid value for key ".concat(key);};var PATTERN_LENGTH_TOO_LARGE=function PATTERN_LENGTH_TOO_LARGE(max3){return"Pattern length exceeds max of ".concat(max3,".");};var MISSING_KEY_PROPERTY=function MISSING_KEY_PROPERTY(name2){return"Missing ".concat(name2," property in key");};var INVALID_KEY_WEIGHT_VALUE=function INVALID_KEY_WEIGHT_VALUE(key){return"Property 'weight' in key '".concat(key,"' must be a positive integer");};var hasOwn=Object.prototype.hasOwnProperty;var KeyStore=/*#__PURE__*/function(){function KeyStore(keys){var _this4=this;_classCallCheck(this,KeyStore);this._keys=[];this._keyMap={};var totalWeight=0;keys.forEach(function(key){var obj=createKey(key);totalWeight+=obj.weight;_this4._keys.push(obj);_this4._keyMap[obj.id]=obj;totalWeight+=obj.weight;});this._keys.forEach(function(key){key.weight/=totalWeight;});}_createClass(KeyStore,[{key:"get",value:function get(keyId){return this._keyMap[keyId];}},{key:"keys",value:function keys(){return this._keys;}},{key:"toJSON",value:function toJSON(){return JSON.stringify(this._keys);}}]);return KeyStore;}();function createKey(key){var path=null;var id=null;var src=null;var weight=1;var getFn=null;if(isString3(key)||isArray2(key)){src=key;path=createKeyPath(key);id=createKeyId(key);}else{if(!hasOwn.call(key,"name")){throw new Error(MISSING_KEY_PROPERTY("name"));}var name2=key.name;src=name2;if(hasOwn.call(key,"weight")){weight=key.weight;if(weight<=0){throw new Error(INVALID_KEY_WEIGHT_VALUE(name2));}}path=createKeyPath(name2);id=createKeyId(name2);getFn=key.getFn;}return{path:path,id:id,weight:weight,src:src,getFn:getFn};}function createKeyPath(key){return isArray2(key)?key:key.split(".");}function createKeyId(key){return isArray2(key)?key.join("."):key;}function get(obj,path){var list2=[];var arr=false;var deepGet=function deepGet(obj2,path2,index2){if(!isDefined4(obj2)){return;}if(!path2[index2]){list2.push(obj2);}else{var key=path2[index2];var value=obj2[key];if(!isDefined4(value)){return;}if(index2===path2.length-1&&(isString3(value)||isNumber2(value)||isBoolean2(value))){list2.push(toString2(value));}else if(isArray2(value)){arr=true;for(var i=0,len=value.length;i<len;i+=1){deepGet(value[i],path2,index2+1);}}else if(path2.length){deepGet(value,path2,index2+1);}}};deepGet(obj,isString3(path)?path.split("."):path,0);return arr?list2:list2[0];}var MatchOptions={includeMatches:false,findAllMatches:false,minMatchCharLength:1};var BasicOptions={isCaseSensitive:false,includeScore:false,keys:[],shouldSort:true,sortFn:function sortFn(a2,b){return a2.score===b.score?a2.idx<b.idx?-1:1:a2.score<b.score?-1:1;}};var FuzzyOptions={location:0,threshold:0.6,distance:100};var AdvancedOptions={useExtendedSearch:false,getFn:get,ignoreLocation:false,ignoreFieldNorm:false,fieldNormWeight:1};var Config=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},BasicOptions),MatchOptions),FuzzyOptions),AdvancedOptions);var SPACE=/[^ ]+/g;function norm(){var weight=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var mantissa=arguments.length>1&&arguments[1]!==undefined?arguments[1]:3;var cache2=new Map();var m=Math.pow(10,mantissa);return{get:function get(value){var numTokens=value.match(SPACE).length;if(cache2.has(numTokens)){return cache2.get(numTokens);}var norm2=1/Math.pow(numTokens,0.5*weight);var n2=parseFloat(Math.round(norm2*m)/m);cache2.set(numTokens,n2);return n2;},clear:function clear(){cache2.clear();}};}var FuseIndex=/*#__PURE__*/function(){function FuseIndex(){var _ref5=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref5$getFn=_ref5.getFn,getFn=_ref5$getFn===void 0?Config.getFn:_ref5$getFn,_ref5$fieldNormWeight=_ref5.fieldNormWeight,fieldNormWeight=_ref5$fieldNormWeight===void 0?Config.fieldNormWeight:_ref5$fieldNormWeight;_classCallCheck(this,FuseIndex);this.norm=norm(fieldNormWeight,3);this.getFn=getFn;this.isCreated=false;this.setIndexRecords();}_createClass(FuseIndex,[{key:"setSources",value:function setSources(){var docs=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.docs=docs;}},{key:"setIndexRecords",value:function setIndexRecords(){var records=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.records=records;}},{key:"setKeys",value:function setKeys(){var _this5=this;var keys=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.keys=keys;this._keysMap={};keys.forEach(function(key,idx){_this5._keysMap[key.id]=idx;});}},{key:"create",value:function create(){var _this6=this;if(this.isCreated||!this.docs.length){return;}this.isCreated=true;if(isString3(this.docs[0])){this.docs.forEach(function(doc,docIndex){_this6._addString(doc,docIndex);});}else{this.docs.forEach(function(doc,docIndex){_this6._addObject(doc,docIndex);});}this.norm.clear();}},{key:"add",value:function add(doc){var idx=this.size();if(isString3(doc)){this._addString(doc,idx);}else{this._addObject(doc,idx);}}},{key:"removeAt",value:function removeAt(idx){this.records.splice(idx,1);for(var i=idx,len=this.size();i<len;i+=1){this.records[i].i-=1;}}},{key:"getValueForItemAtKeyId",value:function getValueForItemAtKeyId(item2,keyId){return item2[this._keysMap[keyId]];}},{key:"size",value:function size(){return this.records.length;}},{key:"_addString",value:function _addString(doc,docIndex){if(!isDefined4(doc)||isBlank(doc)){return;}var record={v:doc,i:docIndex,n:this.norm.get(doc)};this.records.push(record);}},{key:"_addObject",value:function _addObject(doc,docIndex){var _this7=this;var record={i:docIndex,$:{}};this.keys.forEach(function(key,keyIndex){var value=key.getFn?key.getFn(doc):_this7.getFn(doc,key.path);if(!isDefined4(value)){return;}if(isArray2(value)){(function(){var subRecords=[];var stack=[{nestedArrIndex:-1,value:value}];while(stack.length){var _stack$pop=stack.pop(),nestedArrIndex=_stack$pop.nestedArrIndex,value2=_stack$pop.value;if(!isDefined4(value2)){continue;}if(isString3(value2)&&!isBlank(value2)){var subRecord={v:value2,i:nestedArrIndex,n:_this7.norm.get(value2)};subRecords.push(subRecord);}else if(isArray2(value2)){value2.forEach(function(item2,k){stack.push({nestedArrIndex:k,value:item2});});}else;}record.$[keyIndex]=subRecords;})();}else if(isString3(value)&&!isBlank(value)){var subRecord={v:value,n:_this7.norm.get(value)};record.$[keyIndex]=subRecord;}});this.records.push(record);}},{key:"toJSON",value:function toJSON(){return{keys:this.keys,records:this.records};}}]);return FuseIndex;}();function createIndex(keys,docs){var _ref6=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref6$getFn=_ref6.getFn,getFn=_ref6$getFn===void 0?Config.getFn:_ref6$getFn,_ref6$fieldNormWeight=_ref6.fieldNormWeight,fieldNormWeight=_ref6$fieldNormWeight===void 0?Config.fieldNormWeight:_ref6$fieldNormWeight;var myIndex=new FuseIndex({getFn:getFn,fieldNormWeight:fieldNormWeight});myIndex.setKeys(keys.map(createKey));myIndex.setSources(docs);myIndex.create();return myIndex;}function parseIndex(data3){var _ref7=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref7$getFn=_ref7.getFn,getFn=_ref7$getFn===void 0?Config.getFn:_ref7$getFn,_ref7$fieldNormWeight=_ref7.fieldNormWeight,fieldNormWeight=_ref7$fieldNormWeight===void 0?Config.fieldNormWeight:_ref7$fieldNormWeight;var keys=data3.keys,records=data3.records;var myIndex=new FuseIndex({getFn:getFn,fieldNormWeight:fieldNormWeight});myIndex.setKeys(keys);myIndex.setIndexRecords(records);return myIndex;}function computeScore$1(pattern){var _ref8=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref8$errors=_ref8.errors,errors=_ref8$errors===void 0?0:_ref8$errors,_ref8$currentLocation=_ref8.currentLocation,currentLocation=_ref8$currentLocation===void 0?0:_ref8$currentLocation,_ref8$expectedLocatio=_ref8.expectedLocation,expectedLocation=_ref8$expectedLocatio===void 0?0:_ref8$expectedLocatio,_ref8$distance=_ref8.distance,distance=_ref8$distance===void 0?Config.distance:_ref8$distance,_ref8$ignoreLocation=_ref8.ignoreLocation,ignoreLocation=_ref8$ignoreLocation===void 0?Config.ignoreLocation:_ref8$ignoreLocation;var accuracy=errors/pattern.length;if(ignoreLocation){return accuracy;}var proximity=Math.abs(expectedLocation-currentLocation);if(!distance){return proximity?1:accuracy;}return accuracy+proximity/distance;}function convertMaskToIndices(){var matchmask=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var minMatchCharLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Config.minMatchCharLength;var indices=[];var start=-1;var end=-1;var i=0;for(var len=matchmask.length;i<len;i+=1){var match=matchmask[i];if(match&&start===-1){start=i;}else if(!match&&start!==-1){end=i-1;if(end-start+1>=minMatchCharLength){indices.push([start,end]);}start=-1;}}if(matchmask[i-1]&&i-start>=minMatchCharLength){indices.push([start,i-1]);}return indices;}var MAX_BITS=32;function search(text3,pattern,patternAlphabet){var _ref9=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},_ref9$location=_ref9.location,location2=_ref9$location===void 0?Config.location:_ref9$location,_ref9$distance=_ref9.distance,distance=_ref9$distance===void 0?Config.distance:_ref9$distance,_ref9$threshold=_ref9.threshold,threshold=_ref9$threshold===void 0?Config.threshold:_ref9$threshold,_ref9$findAllMatches=_ref9.findAllMatches,findAllMatches=_ref9$findAllMatches===void 0?Config.findAllMatches:_ref9$findAllMatches,_ref9$minMatchCharLen=_ref9.minMatchCharLength,minMatchCharLength=_ref9$minMatchCharLen===void 0?Config.minMatchCharLength:_ref9$minMatchCharLen,_ref9$includeMatches=_ref9.includeMatches,includeMatches=_ref9$includeMatches===void 0?Config.includeMatches:_ref9$includeMatches,_ref9$ignoreLocation=_ref9.ignoreLocation,ignoreLocation=_ref9$ignoreLocation===void 0?Config.ignoreLocation:_ref9$ignoreLocation;if(pattern.length>MAX_BITS){throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));}var patternLen=pattern.length;var textLen=text3.length;var expectedLocation=Math.max(0,Math.min(location2,textLen));var currentThreshold=threshold;var bestLocation=expectedLocation;var computeMatches=minMatchCharLength>1||includeMatches;var matchMask=computeMatches?Array(textLen):[];var index2;while((index2=text3.indexOf(pattern,bestLocation))>-1){var score=computeScore$1(pattern,{currentLocation:index2,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation});currentThreshold=Math.min(score,currentThreshold);bestLocation=index2+patternLen;if(computeMatches){var i=0;while(i<patternLen){matchMask[index2+i]=1;i+=1;}}}bestLocation=-1;var lastBitArr=[];var finalScore=1;var binMax=patternLen+textLen;var mask=1<<patternLen-1;for(var _i2=0;_i2<patternLen;_i2+=1){var binMin=0;var binMid=binMax;while(binMin<binMid){var score2=computeScore$1(pattern,{errors:_i2,currentLocation:expectedLocation+binMid,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation});if(score2<=currentThreshold){binMin=binMid;}else{binMax=binMid;}binMid=Math.floor((binMax-binMin)/2+binMin);}binMax=binMid;var start=Math.max(1,expectedLocation-binMid+1);var finish=findAllMatches?textLen:Math.min(expectedLocation+binMid,textLen)+patternLen;var bitArr=Array(finish+2);bitArr[finish+1]=(1<<_i2)-1;for(var j=finish;j>=start;j-=1){var currentLocation=j-1;var charMatch=patternAlphabet[text3.charAt(currentLocation)];if(computeMatches){matchMask[currentLocation]=+!!charMatch;}bitArr[j]=(bitArr[j+1]<<1|1)&charMatch;if(_i2){bitArr[j]|=(lastBitArr[j+1]|lastBitArr[j])<<1|1|lastBitArr[j+1];}if(bitArr[j]&mask){finalScore=computeScore$1(pattern,{errors:_i2,currentLocation:currentLocation,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation});if(finalScore<=currentThreshold){currentThreshold=finalScore;bestLocation=currentLocation;if(bestLocation<=expectedLocation){break;}start=Math.max(1,2*expectedLocation-bestLocation);}}}var _score=computeScore$1(pattern,{errors:_i2+1,currentLocation:expectedLocation,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation});if(_score>currentThreshold){break;}lastBitArr=bitArr;}var result={isMatch:bestLocation>=0,score:Math.max(1e-3,finalScore)};if(computeMatches){var indices=convertMaskToIndices(matchMask,minMatchCharLength);if(!indices.length){result.isMatch=false;}else if(includeMatches){result.indices=indices;}}return result;}function createPatternAlphabet(pattern){var mask={};for(var i=0,len=pattern.length;i<len;i+=1){var _char=pattern.charAt(i);mask[_char]=(mask[_char]||0)|1<<len-i-1;}return mask;}var BitapSearch=/*#__PURE__*/function(){function BitapSearch(pattern){var _this8=this;var _ref10=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref10$location=_ref10.location,location2=_ref10$location===void 0?Config.location:_ref10$location,_ref10$threshold=_ref10.threshold,threshold=_ref10$threshold===void 0?Config.threshold:_ref10$threshold,_ref10$distance=_ref10.distance,distance=_ref10$distance===void 0?Config.distance:_ref10$distance,_ref10$includeMatches=_ref10.includeMatches,includeMatches=_ref10$includeMatches===void 0?Config.includeMatches:_ref10$includeMatches,_ref10$findAllMatches=_ref10.findAllMatches,findAllMatches=_ref10$findAllMatches===void 0?Config.findAllMatches:_ref10$findAllMatches,_ref10$minMatchCharLe=_ref10.minMatchCharLength,minMatchCharLength=_ref10$minMatchCharLe===void 0?Config.minMatchCharLength:_ref10$minMatchCharLe,_ref10$isCaseSensitiv=_ref10.isCaseSensitive,isCaseSensitive=_ref10$isCaseSensitiv===void 0?Config.isCaseSensitive:_ref10$isCaseSensitiv,_ref10$ignoreLocation=_ref10.ignoreLocation,ignoreLocation=_ref10$ignoreLocation===void 0?Config.ignoreLocation:_ref10$ignoreLocation;_classCallCheck(this,BitapSearch);this.options={location:location2,threshold:threshold,distance:distance,includeMatches:includeMatches,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,isCaseSensitive:isCaseSensitive,ignoreLocation:ignoreLocation};this.pattern=isCaseSensitive?pattern:pattern.toLowerCase();this.chunks=[];if(!this.pattern.length){return;}var addChunk=function addChunk(pattern2,startIndex){_this8.chunks.push({pattern:pattern2,alphabet:createPatternAlphabet(pattern2),startIndex:startIndex});};var len=this.pattern.length;if(len>MAX_BITS){var i=0;var remainder=len%MAX_BITS;var end=len-remainder;while(i<end){addChunk(this.pattern.substr(i,MAX_BITS),i);i+=MAX_BITS;}if(remainder){var startIndex=len-MAX_BITS;addChunk(this.pattern.substr(startIndex),startIndex);}}else{addChunk(this.pattern,0);}}_createClass(BitapSearch,[{key:"searchIn",value:function searchIn(text3){var _this$options=this.options,isCaseSensitive=_this$options.isCaseSensitive,includeMatches=_this$options.includeMatches;if(!isCaseSensitive){text3=text3.toLowerCase();}if(this.pattern===text3){var result2={isMatch:true,score:0};if(includeMatches){result2.indices=[[0,text3.length-1]];}return result2;}var _this$options2=this.options,location2=_this$options2.location,distance=_this$options2.distance,threshold=_this$options2.threshold,findAllMatches=_this$options2.findAllMatches,minMatchCharLength=_this$options2.minMatchCharLength,ignoreLocation=_this$options2.ignoreLocation;var allIndices=[];var totalScore=0;var hasMatches=false;this.chunks.forEach(function(_ref11){var pattern=_ref11.pattern,alphabet=_ref11.alphabet,startIndex=_ref11.startIndex;var _search=search(text3,pattern,alphabet,{location:location2+startIndex,distance:distance,threshold:threshold,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,includeMatches:includeMatches,ignoreLocation:ignoreLocation}),isMatch=_search.isMatch,score=_search.score,indices=_search.indices;if(isMatch){hasMatches=true;}totalScore+=score;if(isMatch&&indices){allIndices=[].concat(_toConsumableArray2(allIndices),_toConsumableArray2(indices));}});var result={isMatch:hasMatches,score:hasMatches?totalScore/this.chunks.length:1};if(hasMatches&&includeMatches){result.indices=allIndices;}return result;}}]);return BitapSearch;}();var BaseMatch=/*#__PURE__*/function(){function BaseMatch(pattern){_classCallCheck(this,BaseMatch);this.pattern=pattern;}_createClass(BaseMatch,[{key:"search",value:function search(){}}],[{key:"isMultiMatch",value:function isMultiMatch(pattern){return getMatch(pattern,this.multiRegex);}},{key:"isSingleMatch",value:function isSingleMatch(pattern){return getMatch(pattern,this.singleRegex);}}]);return BaseMatch;}();function getMatch(pattern,exp){var matches2=pattern.match(exp);return matches2?matches2[1]:null;}var ExactMatch=/*#__PURE__*/function(_BaseMatch){_inherits(ExactMatch,_BaseMatch);var _super2=_createSuper(ExactMatch);function ExactMatch(pattern){_classCallCheck(this,ExactMatch);return _super2.call(this,pattern);}_createClass(ExactMatch,[{key:"search",value:function search(text3){var isMatch=text3===this.pattern;return{isMatch:isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]};}}],[{key:"type",get:function get(){return"exact";}},{key:"multiRegex",get:function get(){return /^="(.*)"$/;}},{key:"singleRegex",get:function get(){return /^=(.*)$/;}}]);return ExactMatch;}(BaseMatch);var InverseExactMatch=/*#__PURE__*/function(_BaseMatch2){_inherits(InverseExactMatch,_BaseMatch2);var _super3=_createSuper(InverseExactMatch);function InverseExactMatch(pattern){_classCallCheck(this,InverseExactMatch);return _super3.call(this,pattern);}_createClass(InverseExactMatch,[{key:"search",value:function search(text3){var index2=text3.indexOf(this.pattern);var isMatch=index2===-1;return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text3.length-1]};}}],[{key:"type",get:function get(){return"inverse-exact";}},{key:"multiRegex",get:function get(){return /^!"(.*)"$/;}},{key:"singleRegex",get:function get(){return /^!(.*)$/;}}]);return InverseExactMatch;}(BaseMatch);var PrefixExactMatch=/*#__PURE__*/function(_BaseMatch3){_inherits(PrefixExactMatch,_BaseMatch3);var _super4=_createSuper(PrefixExactMatch);function PrefixExactMatch(pattern){_classCallCheck(this,PrefixExactMatch);return _super4.call(this,pattern);}_createClass(PrefixExactMatch,[{key:"search",value:function search(text3){var isMatch=text3.startsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]};}}],[{key:"type",get:function get(){return"prefix-exact";}},{key:"multiRegex",get:function get(){return /^\^"(.*)"$/;}},{key:"singleRegex",get:function get(){return /^\^(.*)$/;}}]);return PrefixExactMatch;}(BaseMatch);var InversePrefixExactMatch=/*#__PURE__*/function(_BaseMatch4){_inherits(InversePrefixExactMatch,_BaseMatch4);var _super5=_createSuper(InversePrefixExactMatch);function InversePrefixExactMatch(pattern){_classCallCheck(this,InversePrefixExactMatch);return _super5.call(this,pattern);}_createClass(InversePrefixExactMatch,[{key:"search",value:function search(text3){var isMatch=!text3.startsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text3.length-1]};}}],[{key:"type",get:function get(){return"inverse-prefix-exact";}},{key:"multiRegex",get:function get(){return /^!\^"(.*)"$/;}},{key:"singleRegex",get:function get(){return /^!\^(.*)$/;}}]);return InversePrefixExactMatch;}(BaseMatch);var SuffixExactMatch=/*#__PURE__*/function(_BaseMatch5){_inherits(SuffixExactMatch,_BaseMatch5);var _super6=_createSuper(SuffixExactMatch);function SuffixExactMatch(pattern){_classCallCheck(this,SuffixExactMatch);return _super6.call(this,pattern);}_createClass(SuffixExactMatch,[{key:"search",value:function search(text3){var isMatch=text3.endsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[text3.length-this.pattern.length,text3.length-1]};}}],[{key:"type",get:function get(){return"suffix-exact";}},{key:"multiRegex",get:function get(){return /^"(.*)"\$$/;}},{key:"singleRegex",get:function get(){return /^(.*)\$$/;}}]);return SuffixExactMatch;}(BaseMatch);var InverseSuffixExactMatch=/*#__PURE__*/function(_BaseMatch6){_inherits(InverseSuffixExactMatch,_BaseMatch6);var _super7=_createSuper(InverseSuffixExactMatch);function InverseSuffixExactMatch(pattern){_classCallCheck(this,InverseSuffixExactMatch);return _super7.call(this,pattern);}_createClass(InverseSuffixExactMatch,[{key:"search",value:function search(text3){var isMatch=!text3.endsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text3.length-1]};}}],[{key:"type",get:function get(){return"inverse-suffix-exact";}},{key:"multiRegex",get:function get(){return /^!"(.*)"\$$/;}},{key:"singleRegex",get:function get(){return /^!(.*)\$$/;}}]);return InverseSuffixExactMatch;}(BaseMatch);var FuzzyMatch=/*#__PURE__*/function(_BaseMatch7){_inherits(FuzzyMatch,_BaseMatch7);var _super8=_createSuper(FuzzyMatch);function FuzzyMatch(pattern){var _this9;var _ref12=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref12$location=_ref12.location,location2=_ref12$location===void 0?Config.location:_ref12$location,_ref12$threshold=_ref12.threshold,threshold=_ref12$threshold===void 0?Config.threshold:_ref12$threshold,_ref12$distance=_ref12.distance,distance=_ref12$distance===void 0?Config.distance:_ref12$distance,_ref12$includeMatches=_ref12.includeMatches,includeMatches=_ref12$includeMatches===void 0?Config.includeMatches:_ref12$includeMatches,_ref12$findAllMatches=_ref12.findAllMatches,findAllMatches=_ref12$findAllMatches===void 0?Config.findAllMatches:_ref12$findAllMatches,_ref12$minMatchCharLe=_ref12.minMatchCharLength,minMatchCharLength=_ref12$minMatchCharLe===void 0?Config.minMatchCharLength:_ref12$minMatchCharLe,_ref12$isCaseSensitiv=_ref12.isCaseSensitive,isCaseSensitive=_ref12$isCaseSensitiv===void 0?Config.isCaseSensitive:_ref12$isCaseSensitiv,_ref12$ignoreLocation=_ref12.ignoreLocation,ignoreLocation=_ref12$ignoreLocation===void 0?Config.ignoreLocation:_ref12$ignoreLocation;_classCallCheck(this,FuzzyMatch);_this9=_super8.call(this,pattern);_this9._bitapSearch=new BitapSearch(pattern,{location:location2,threshold:threshold,distance:distance,includeMatches:includeMatches,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,isCaseSensitive:isCaseSensitive,ignoreLocation:ignoreLocation});return _this9;}_createClass(FuzzyMatch,[{key:"search",value:function search(text3){return this._bitapSearch.searchIn(text3);}}],[{key:"type",get:function get(){return"fuzzy";}},{key:"multiRegex",get:function get(){return /^"(.*)"$/;}},{key:"singleRegex",get:function get(){return /^(.*)$/;}}]);return FuzzyMatch;}(BaseMatch);var IncludeMatch=/*#__PURE__*/function(_BaseMatch8){_inherits(IncludeMatch,_BaseMatch8);var _super9=_createSuper(IncludeMatch);function IncludeMatch(pattern){_classCallCheck(this,IncludeMatch);return _super9.call(this,pattern);}_createClass(IncludeMatch,[{key:"search",value:function search(text3){var location2=0;var index2;var indices=[];var patternLen=this.pattern.length;while((index2=text3.indexOf(this.pattern,location2))>-1){location2=index2+patternLen;indices.push([index2,location2-1]);}var isMatch=!!indices.length;return{isMatch:isMatch,score:isMatch?0:1,indices:indices};}}],[{key:"type",get:function get(){return"include";}},{key:"multiRegex",get:function get(){return /^'"(.*)"$/;}},{key:"singleRegex",get:function get(){return /^'(.*)$/;}}]);return IncludeMatch;}(BaseMatch);var searchers=[ExactMatch,IncludeMatch,PrefixExactMatch,InversePrefixExactMatch,InverseSuffixExactMatch,SuffixExactMatch,InverseExactMatch,FuzzyMatch];var searchersLen=searchers.length;var SPACE_RE=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;var OR_TOKEN="|";function parseQuery(pattern){var options2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return pattern.split(OR_TOKEN).map(function(item2){var query=item2.trim().split(SPACE_RE).filter(function(item3){return item3&&!!item3.trim();});var results=[];for(var i=0,len=query.length;i<len;i+=1){var queryItem=query[i];var found=false;var idx=-1;while(!found&&++idx<searchersLen){var searcher=searchers[idx];var token=searcher.isMultiMatch(queryItem);if(token){results.push(new searcher(token,options2));found=true;}}if(found){continue;}idx=-1;while(++idx<searchersLen){var _searcher=searchers[idx];var _token=_searcher.isSingleMatch(queryItem);if(_token){results.push(new _searcher(_token,options2));break;}}}return results;});}var MultiMatchSet=new Set([FuzzyMatch.type,IncludeMatch.type]);var ExtendedSearch=/*#__PURE__*/function(){function ExtendedSearch(pattern){var _ref13=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref13$isCaseSensitiv=_ref13.isCaseSensitive,isCaseSensitive=_ref13$isCaseSensitiv===void 0?Config.isCaseSensitive:_ref13$isCaseSensitiv,_ref13$includeMatches=_ref13.includeMatches,includeMatches=_ref13$includeMatches===void 0?Config.includeMatches:_ref13$includeMatches,_ref13$minMatchCharLe=_ref13.minMatchCharLength,minMatchCharLength=_ref13$minMatchCharLe===void 0?Config.minMatchCharLength:_ref13$minMatchCharLe,_ref13$ignoreLocation=_ref13.ignoreLocation,ignoreLocation=_ref13$ignoreLocation===void 0?Config.ignoreLocation:_ref13$ignoreLocation,_ref13$findAllMatches=_ref13.findAllMatches,findAllMatches=_ref13$findAllMatches===void 0?Config.findAllMatches:_ref13$findAllMatches,_ref13$location=_ref13.location,location2=_ref13$location===void 0?Config.location:_ref13$location,_ref13$threshold=_ref13.threshold,threshold=_ref13$threshold===void 0?Config.threshold:_ref13$threshold,_ref13$distance=_ref13.distance,distance=_ref13$distance===void 0?Config.distance:_ref13$distance;_classCallCheck(this,ExtendedSearch);this.query=null;this.options={isCaseSensitive:isCaseSensitive,includeMatches:includeMatches,minMatchCharLength:minMatchCharLength,findAllMatches:findAllMatches,ignoreLocation:ignoreLocation,location:location2,threshold:threshold,distance:distance};this.pattern=isCaseSensitive?pattern:pattern.toLowerCase();this.query=parseQuery(this.pattern,this.options);}_createClass(ExtendedSearch,[{key:"searchIn",value:function searchIn(text3){var query=this.query;if(!query){return{isMatch:false,score:1};}var _this$options3=this.options,includeMatches=_this$options3.includeMatches,isCaseSensitive=_this$options3.isCaseSensitive;text3=isCaseSensitive?text3:text3.toLowerCase();var numMatches=0;var allIndices=[];var totalScore=0;for(var i=0,qLen=query.length;i<qLen;i+=1){var searchers2=query[i];allIndices.length=0;numMatches=0;for(var j=0,pLen=searchers2.length;j<pLen;j+=1){var searcher=searchers2[j];var _searcher$search=searcher.search(text3),isMatch=_searcher$search.isMatch,indices=_searcher$search.indices,score=_searcher$search.score;if(isMatch){numMatches+=1;totalScore+=score;if(includeMatches){var type=searcher.constructor.type;if(MultiMatchSet.has(type)){allIndices=[].concat(_toConsumableArray2(allIndices),_toConsumableArray2(indices));}else{allIndices.push(indices);}}}else{totalScore=0;numMatches=0;allIndices.length=0;break;}}if(numMatches){var result={isMatch:true,score:totalScore/numMatches};if(includeMatches){result.indices=allIndices;}return result;}}return{isMatch:false,score:1};}}],[{key:"condition",value:function condition(_,options2){return options2.useExtendedSearch;}}]);return ExtendedSearch;}();var registeredSearchers=[];function register(){registeredSearchers.push.apply(registeredSearchers,arguments);}function createSearcher(pattern,options2){for(var i=0,len=registeredSearchers.length;i<len;i+=1){var searcherClass=registeredSearchers[i];if(searcherClass.condition(pattern,options2)){return new searcherClass(pattern,options2);}}return new BitapSearch(pattern,options2);}var LogicalOperator={AND:"$and",OR:"$or"};var KeyType={PATH:"$path",PATTERN:"$val"};var isExpression=function isExpression(query){return!!(query[LogicalOperator.AND]||query[LogicalOperator.OR]);};var isPath=function isPath(query){return!!query[KeyType.PATH];};var isLeaf=function isLeaf(query){return!isArray2(query)&&isObject2(query)&&!isExpression(query);};var convertToExplicit=function convertToExplicit(query){return _defineProperty3({},LogicalOperator.AND,Object.keys(query).map(function(key){return _defineProperty3({},key,query[key]);}));};function parse2(query,options2){var _ref16=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref16$auto=_ref16.auto,auto=_ref16$auto===void 0?true:_ref16$auto;var next=function next(query2){var keys=Object.keys(query2);var isQueryPath=isPath(query2);if(!isQueryPath&&keys.length>1&&!isExpression(query2)){return next(convertToExplicit(query2));}if(isLeaf(query2)){var key=isQueryPath?query2[KeyType.PATH]:keys[0];var pattern=isQueryPath?query2[KeyType.PATTERN]:query2[key];if(!isString3(pattern)){throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key));}var obj={keyId:createKeyId(key),pattern:pattern};if(auto){obj.searcher=createSearcher(pattern,options2);}return obj;}var node={children:[],operator:keys[0]};keys.forEach(function(key){var value=query2[key];if(isArray2(value)){value.forEach(function(item2){node.children.push(next(item2));});}});return node;};if(!isExpression(query)){query=convertToExplicit(query);}return next(query);}function computeScore(results,_ref17){var _ref17$ignoreFieldNor=_ref17.ignoreFieldNorm,ignoreFieldNorm=_ref17$ignoreFieldNor===void 0?Config.ignoreFieldNorm:_ref17$ignoreFieldNor;results.forEach(function(result){var totalScore=1;result.matches.forEach(function(_ref18){var key=_ref18.key,norm2=_ref18.norm,score=_ref18.score;var weight=key?key.weight:null;totalScore*=Math.pow(score===0&&weight?Number.EPSILON:score,(weight||1)*(ignoreFieldNorm?1:norm2));});result.score=totalScore;});}function transformMatches(result,data3){var matches2=result.matches;data3.matches=[];if(!isDefined4(matches2)){return;}matches2.forEach(function(match){if(!isDefined4(match.indices)||!match.indices.length){return;}var indices=match.indices,value=match.value;var obj={indices:indices,value:value};if(match.key){obj.key=match.key.src;}if(match.idx>-1){obj.refIndex=match.idx;}data3.matches.push(obj);});}function transformScore(result,data3){data3.score=result.score;}function format2(results,docs){var _ref19=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref19$includeMatches=_ref19.includeMatches,includeMatches=_ref19$includeMatches===void 0?Config.includeMatches:_ref19$includeMatches,_ref19$includeScore=_ref19.includeScore,includeScore=_ref19$includeScore===void 0?Config.includeScore:_ref19$includeScore;var transformers=[];if(includeMatches)transformers.push(transformMatches);if(includeScore)transformers.push(transformScore);return results.map(function(result){var idx=result.idx;var data3={item:docs[idx],refIndex:idx};if(transformers.length){transformers.forEach(function(transformer){transformer(result,data3);});}return data3;});}var Fuse=/*#__PURE__*/function(){function Fuse(docs){var options2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var index2=arguments.length>2?arguments[2]:undefined;_classCallCheck(this,Fuse);this.options=_objectSpread(_objectSpread({},Config),options2);if(this.options.useExtendedSearch&&false){}this._keyStore=new KeyStore(this.options.keys);this.setCollection(docs,index2);}_createClass(Fuse,[{key:"setCollection",value:function setCollection(docs,index2){this._docs=docs;if(index2&&!(index2 instanceof FuseIndex)){throw new Error(INCORRECT_INDEX_TYPE);}this._myIndex=index2||createIndex(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight});}},{key:"add",value:function add(doc){if(!isDefined4(doc)){return;}this._docs.push(doc);this._myIndex.add(doc);}},{key:"remove",value:function remove(){var predicate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){return false;};var results=[];for(var i=0,len=this._docs.length;i<len;i+=1){var doc=this._docs[i];if(predicate(doc,i)){this.removeAt(i);i-=1;len-=1;results.push(doc);}}return results;}},{key:"removeAt",value:function removeAt(idx){this._docs.splice(idx,1);this._myIndex.removeAt(idx);}},{key:"getIndex",value:function getIndex(){return this._myIndex;}},{key:"search",value:function search(query){var _ref20=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref20$limit=_ref20.limit,limit2=_ref20$limit===void 0?-1:_ref20$limit;var _this$options4=this.options,includeMatches=_this$options4.includeMatches,includeScore=_this$options4.includeScore,shouldSort=_this$options4.shouldSort,sortFn=_this$options4.sortFn,ignoreFieldNorm=_this$options4.ignoreFieldNorm;var results=isString3(query)?isString3(this._docs[0])?this._searchStringList(query):this._searchObjectList(query):this._searchLogical(query);computeScore(results,{ignoreFieldNorm:ignoreFieldNorm});if(shouldSort){results.sort(sortFn);}if(isNumber2(limit2)&&limit2>-1){results=results.slice(0,limit2);}return format2(results,this._docs,{includeMatches:includeMatches,includeScore:includeScore});}},{key:"_searchStringList",value:function _searchStringList(query){var searcher=createSearcher(query,this.options);var records=this._myIndex.records;var results=[];records.forEach(function(_ref21){var text3=_ref21.v,idx=_ref21.i,norm2=_ref21.n;if(!isDefined4(text3)){return;}var _searcher$searchIn=searcher.searchIn(text3),isMatch=_searcher$searchIn.isMatch,score=_searcher$searchIn.score,indices=_searcher$searchIn.indices;if(isMatch){results.push({item:text3,idx:idx,matches:[{score:score,value:text3,norm:norm2,indices:indices}]});}});return results;}},{key:"_searchLogical",value:function _searchLogical(query){var _this10=this;var expression=parse2(query,this.options);var evaluate=function evaluate(node,item2,idx){if(!node.children){var keyId=node.keyId,searcher=node.searcher;var matches2=_this10._findMatches({key:_this10._keyStore.get(keyId),value:_this10._myIndex.getValueForItemAtKeyId(item2,keyId),searcher:searcher});if(matches2&&matches2.length){return[{idx:idx,item:item2,matches:matches2}];}return[];}var res2=[];for(var i=0,len=node.children.length;i<len;i+=1){var child=node.children[i];var result=evaluate(child,item2,idx);if(result.length){res2.push.apply(res2,_toConsumableArray2(result));}else if(node.operator===LogicalOperator.AND){return[];}}return res2;};var records=this._myIndex.records;var resultMap={};var results=[];records.forEach(function(_ref22){var item2=_ref22.$,idx=_ref22.i;if(isDefined4(item2)){var expResults=evaluate(expression,item2,idx);if(expResults.length){if(!resultMap[idx]){resultMap[idx]={idx:idx,item:item2,matches:[]};results.push(resultMap[idx]);}expResults.forEach(function(_ref23){var _resultMap$idx$matche;var matches2=_ref23.matches;(_resultMap$idx$matche=resultMap[idx].matches).push.apply(_resultMap$idx$matche,_toConsumableArray2(matches2));});}}});return results;}},{key:"_searchObjectList",value:function _searchObjectList(query){var _this11=this;var searcher=createSearcher(query,this.options);var _this$_myIndex=this._myIndex,keys=_this$_myIndex.keys,records=_this$_myIndex.records;var results=[];records.forEach(function(_ref24){var item2=_ref24.$,idx=_ref24.i;if(!isDefined4(item2)){return;}var matches2=[];keys.forEach(function(key,keyIndex){matches2.push.apply(matches2,_toConsumableArray2(_this11._findMatches({key:key,value:item2[keyIndex],searcher:searcher})));});if(matches2.length){results.push({idx:idx,item:item2,matches:matches2});}});return results;}},{key:"_findMatches",value:function _findMatches(_ref25){var key=_ref25.key,value=_ref25.value,searcher=_ref25.searcher;if(!isDefined4(value)){return[];}var matches2=[];if(isArray2(value)){value.forEach(function(_ref26){var text3=_ref26.v,idx=_ref26.i,norm2=_ref26.n;if(!isDefined4(text3)){return;}var _searcher$searchIn2=searcher.searchIn(text3),isMatch=_searcher$searchIn2.isMatch,score=_searcher$searchIn2.score,indices=_searcher$searchIn2.indices;if(isMatch){matches2.push({score:score,key:key,value:text3,idx:idx,norm:norm2,indices:indices});}});}else{var text3=value.v,norm2=value.n;var _searcher$searchIn3=searcher.searchIn(text3),isMatch=_searcher$searchIn3.isMatch,score=_searcher$searchIn3.score,indices=_searcher$searchIn3.indices;if(isMatch){matches2.push({score:score,key:key,value:text3,norm:norm2,indices:indices});}}return matches2;}}]);return Fuse;}();Fuse.version="6.6.2";Fuse.createIndex=createIndex;Fuse.parseIndex=parseIndex;Fuse.config=Config;{Fuse.parseQuery=parse2;}{register(ExtendedSearch);}},791:function _(__unused_webpack_module,__webpack_exports__2,__webpack_require__2){__webpack_require__2.r(__webpack_exports__2);__webpack_require__2.d(__webpack_exports__2,{__DO_NOT_USE__ActionTypes:function __DO_NOT_USE__ActionTypes(){return ActionTypes;},applyMiddleware:function applyMiddleware(){return _applyMiddleware;},bindActionCreators:function bindActionCreators(){return _bindActionCreators;},combineReducers:function combineReducers(){return _combineReducers;},compose:function compose(){return _compose;},createStore:function createStore(){return createStore2;},legacy_createStore:function legacy_createStore(){return _legacy_createStore;}});;function _typeof3(obj){"@babel/helpers - typeof";return _typeof3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(obj2){return typeof obj2;}:function(obj2){return obj2&&typeof Symbol=="function"&&obj2.constructor===Symbol&&obj2!==Symbol.prototype?"symbol":typeof obj2;},_typeof3(obj);};function _toPrimitive(input,hint){if(_typeof3(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==void 0){var res2=prim.call(input,hint||"default");if(_typeof3(res2)!=="object")return res2;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);};function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof3(key)==="symbol"?key:String(key);};function _defineProperty2(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;};function ownKeys2(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread22(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};i%2?ownKeys2(Object(source),true).forEach(function(key){_defineProperty2(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys2(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;};function formatProdErrorMessage(code){return"Minified Redux error #"+code+"; visit https://redux.js.org/Errors?code="+code+" for the full message or use the non-minified dev environment for full errors. ";}var $$observable=function(){return typeof Symbol==="function"&&Symbol.observable||"@@observable";}();var randomString2=function randomString3(){return Math.random().toString(36).substring(7).split("").join(".");};var ActionTypes={INIT:"@@redux/INIT"+randomString2(),REPLACE:"@@redux/REPLACE"+randomString2(),PROBE_UNKNOWN_ACTION:function PROBE_UNKNOWN_ACTION(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString2();}};function isPlainObject(obj){if(_typeof4(obj)!=="object"||obj===null)return false;var proto2=obj;while(Object.getPrototypeOf(proto2)!==null){proto2=Object.getPrototypeOf(proto2);}return Object.getPrototypeOf(obj)===proto2;}function miniKindOf(val){if(val===void 0)return"undefined";if(val===null)return"null";var type=_typeof4(val);switch(type){case"boolean":case"string":case"number":case"symbol":case"function":{return type;}}if(Array.isArray(val))return"array";if(isDate(val))return"date";if(isError(val))return"error";var constructorName=ctorName(val);switch(constructorName){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return constructorName;}return type.slice(8,-1).toLowerCase().replace(/\s/g,"");}function ctorName(val){return typeof val.constructor==="function"?val.constructor.name:null;}function isError(val){return val instanceof Error||typeof val.message==="string"&&val.constructor&&typeof val.constructor.stackTraceLimit==="number";}function isDate(val){if(val instanceof Date)return true;return typeof val.toDateString==="function"&&typeof val.getDate==="function"&&typeof val.setDate==="function";}function kindOf(val){var typeOfVal=_typeof4(val);if(false){}return typeOfVal;}function createStore2(reducer,preloadedState,enhancer){var _ref2;if(typeof preloadedState==="function"&&typeof enhancer==="function"||typeof enhancer==="function"&&typeof arguments[3]==="function"){throw new Error( true?formatProdErrorMessage(0):0);}if(typeof preloadedState==="function"&&typeof enhancer==="undefined"){enhancer=preloadedState;preloadedState=void 0;}if(typeof enhancer!=="undefined"){if(typeof enhancer!=="function"){throw new Error( true?formatProdErrorMessage(1):0);}return enhancer(createStore2)(reducer,preloadedState);}if(typeof reducer!=="function"){throw new Error( true?formatProdErrorMessage(2):0);}var currentReducer=reducer;var currentState=preloadedState;var currentListeners=[];var nextListeners=currentListeners;var isDispatching=false;function ensureCanMutateNextListeners(){if(nextListeners===currentListeners){nextListeners=currentListeners.slice();}}function getState(){if(isDispatching){throw new Error( true?formatProdErrorMessage(3):0);}return currentState;}function subscribe(listener){if(typeof listener!=="function"){throw new Error( true?formatProdErrorMessage(4):0);}if(isDispatching){throw new Error( true?formatProdErrorMessage(5):0);}var isSubscribed=true;ensureCanMutateNextListeners();nextListeners.push(listener);return function unsubscribe(){if(!isSubscribed){return;}if(isDispatching){throw new Error( true?formatProdErrorMessage(6):0);}isSubscribed=false;ensureCanMutateNextListeners();var index2=nextListeners.indexOf(listener);nextListeners.splice(index2,1);currentListeners=null;};}function dispatch(action){if(!isPlainObject(action)){throw new Error( true?formatProdErrorMessage(7):0);}if(typeof action.type==="undefined"){throw new Error( true?formatProdErrorMessage(8):0);}if(isDispatching){throw new Error( true?formatProdErrorMessage(9):0);}try{isDispatching=true;currentState=currentReducer(currentState,action);}finally{isDispatching=false;}var listeners2=currentListeners=nextListeners;for(var i=0;i<listeners2.length;i++){var listener=listeners2[i];listener();}return action;}function replaceReducer(nextReducer){if(typeof nextReducer!=="function"){throw new Error( true?formatProdErrorMessage(10):0);}currentReducer=nextReducer;dispatch({type:ActionTypes.REPLACE});}function observable(){var _ref3;var outerSubscribe=subscribe;return _ref3={subscribe:function subscribe2(observer2){if(_typeof4(observer2)!=="object"||observer2===null){throw new Error( true?formatProdErrorMessage(11):0);}function observeState(){if(observer2.next){observer2.next(getState());}}observeState();var unsubscribe=outerSubscribe(observeState);return{unsubscribe:unsubscribe};}},_ref3[$$observable]=function(){return this;},_ref3;}dispatch({type:ActionTypes.INIT});return _ref2={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:replaceReducer},_ref2[$$observable]=observable,_ref2;}var _legacy_createStore=createStore2;function warning(message){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(message);}try{throw new Error(message);}catch(e2){}}function getUnexpectedStateShapeWarningMessage(inputState,reducers,action,unexpectedKeyCache){var reducerKeys=Object.keys(reducers);var argumentName=action&&action.type===ActionTypes.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(reducerKeys.length===0){return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";}if(!isPlainObject(inputState)){return"The "+argumentName+' has unexpected type of "'+kindOf(inputState)+'". Expected argument to be an object with the following '+('keys: "'+reducerKeys.join('", "')+'"');}var unexpectedKeys=Object.keys(inputState).filter(function(key){return!reducers.hasOwnProperty(key)&&!unexpectedKeyCache[key];});unexpectedKeys.forEach(function(key){unexpectedKeyCache[key]=true;});if(action&&action.type===ActionTypes.REPLACE)return;if(unexpectedKeys.length>0){return"Unexpected "+(unexpectedKeys.length>1?"keys":"key")+" "+('"'+unexpectedKeys.join('", "')+'" found in '+argumentName+". ")+"Expected to find one of the known reducer keys instead: "+('"'+reducerKeys.join('", "')+'". Unexpected keys will be ignored.');}}function assertReducerShape(reducers){Object.keys(reducers).forEach(function(key){var reducer=reducers[key];var initialState=reducer(void 0,{type:ActionTypes.INIT});if(typeof initialState==="undefined"){throw new Error( true?formatProdErrorMessage(12):0);}if(typeof reducer(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()})==="undefined"){throw new Error( true?formatProdErrorMessage(13):0);}});}function _combineReducers(reducers){var reducerKeys=Object.keys(reducers);var finalReducers={};for(var i=0;i<reducerKeys.length;i++){var key=reducerKeys[i];if(false){}if(typeof reducers[key]==="function"){finalReducers[key]=reducers[key];}}var finalReducerKeys=Object.keys(finalReducers);var unexpectedKeyCache;if(false){}var shapeAssertionError;try{assertReducerShape(finalReducers);}catch(e2){shapeAssertionError=e2;}return function combination(state2,action){if(state2===void 0){state2={};}if(shapeAssertionError){throw shapeAssertionError;}if(false){ var warningMessage; }var hasChanged=false;var nextState={};for(var _i=0;_i<finalReducerKeys.length;_i++){var _key=finalReducerKeys[_i];var reducer=finalReducers[_key];var previousStateForKey=state2[_key];var nextStateForKey=reducer(previousStateForKey,action);if(typeof nextStateForKey==="undefined"){var actionType=action&&action.type;throw new Error( true?formatProdErrorMessage(14):0);}nextState[_key]=nextStateForKey;hasChanged=hasChanged||nextStateForKey!==previousStateForKey;}hasChanged=hasChanged||finalReducerKeys.length!==Object.keys(state2).length;return hasChanged?nextState:state2;};}function bindActionCreator(actionCreator,dispatch){return function(){return dispatch(actionCreator.apply(this,arguments));};}function _bindActionCreators(actionCreators,dispatch){if(typeof actionCreators==="function"){return bindActionCreator(actionCreators,dispatch);}if(_typeof4(actionCreators)!=="object"||actionCreators===null){throw new Error( true?formatProdErrorMessage(16):0);}var boundActionCreators={};for(var key in actionCreators){var actionCreator=actionCreators[key];if(typeof actionCreator==="function"){boundActionCreators[key]=bindActionCreator(actionCreator,dispatch);}}return boundActionCreators;}function _compose(){for(var _len=arguments.length,funcs=new Array(_len),_key=0;_key<_len;_key++){funcs[_key]=arguments[_key];}if(funcs.length===0){return function(arg){return arg;};}if(funcs.length===1){return funcs[0];}return funcs.reduce(function(a2,b){return function(){return a2(b.apply(void 0,arguments));};});}function _applyMiddleware(){for(var _len=arguments.length,middlewares=new Array(_len),_key=0;_key<_len;_key++){middlewares[_key]=arguments[_key];}return function(createStore3){return function(){var store=createStore3.apply(void 0,arguments);var _dispatch=function dispatch(){throw new Error( true?formatProdErrorMessage(15):0);};var middlewareAPI={getState:store.getState,dispatch:function dispatch(){return _dispatch.apply(void 0,arguments);}};var chain2=middlewares.map(function(middleware){return middleware(middlewareAPI);});_dispatch=_compose.apply(void 0,chain2)(store.dispatch);return _objectSpread22(_objectSpread22({},store),{},{dispatch:_dispatch});};};}function isCrushed(){}if(false){}}};var __webpack_module_cache__={};function __nested_webpack_require_494594__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==void 0){return cachedModule.exports;}var module2=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId].call(module2.exports,module2,module2.exports,__nested_webpack_require_494594__);return module2.exports;}!function(){__nested_webpack_require_494594__.n=function(module2){var getter=module2&&module2.__esModule?function(){return module2["default"];}:function(){return module2;};__nested_webpack_require_494594__.d(getter,{a:getter});return getter;};}();!function(){__nested_webpack_require_494594__.d=function(exports2,definition){for(var key in definition){if(__nested_webpack_require_494594__.o(definition,key)&&!__nested_webpack_require_494594__.o(exports2,key)){Object.defineProperty(exports2,key,{enumerable:true,get:definition[key]});}}};}();!function(){__nested_webpack_require_494594__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);};}();!function(){__nested_webpack_require_494594__.r=function(exports2){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports2,Symbol.toStringTag,{value:"Module"});}Object.defineProperty(exports2,"__esModule",{value:true});};}();var __webpack_exports__={};!function(){var _scripts_choices__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_494594__(373);var _scripts_choices__WEBPACK_IMPORTED_MODULE_0___default=/* @__PURE__ */__nested_webpack_require_494594__.n(_scripts_choices__WEBPACK_IMPORTED_MODULE_0__);var _scripts_interfaces__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_494594__(187);var _scripts_interfaces__WEBPACK_IMPORTED_MODULE_1___default=/* @__PURE__ */__nested_webpack_require_494594__.n(_scripts_interfaces__WEBPACK_IMPORTED_MODULE_1__);var _scripts_constants__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_494594__(883);var _scripts_defaults__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_494594__(789);var _scripts_templates__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_494594__(686);__webpack_exports__["default"]=_scripts_choices__WEBPACK_IMPORTED_MODULE_0___default();}();__webpack_exports__=__webpack_exports__["default"];return __webpack_exports__;}();});});// node_modules/vanilla-colorful/lib/utils/math.js
var clamp=function clamp(number){var min3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var max3=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return number>max3?max3:number<min3?min3:number;};var round=function round(number){var digits=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var base=arguments.length>2&&arguments[2]!==undefined?arguments[2]:Math.pow(10,digits);return Math.round(base*number)/base;};// node_modules/vanilla-colorful/lib/utils/convert.js
var angleUnits={grad:360/400,turn:360,rad:360/(Math.PI*2)};var hexToHsva=function hexToHsva(hex){return rgbaToHsva(hexToRgba(hex));};var hexToRgba=function hexToRgba(hex){if(hex[0]==="#")hex=hex.substr(1);if(hex.length<6){return{r:parseInt(hex[0]+hex[0],16),g:parseInt(hex[1]+hex[1],16),b:parseInt(hex[2]+hex[2],16),a:1};}return{r:parseInt(hex.substr(0,2),16),g:parseInt(hex.substr(2,2),16),b:parseInt(hex.substr(4,2),16),a:1};};var parseHue=function parseHue(value){var unit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"deg";return Number(value)*(angleUnits[unit]||1);};var hslaStringToHsva=function hslaStringToHsva(hslString){var matcher=/hsla?\(?\s*(-?\d*\.?\d+)(deg|rad|grad|turn)?[,\s]+(-?\d*\.?\d+)%?[,\s]+(-?\d*\.?\d+)%?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;var match=matcher.exec(hslString);if(!match)return{h:0,s:0,v:0,a:1};return hslaToHsva({h:parseHue(match[1],match[2]),s:Number(match[3]),l:Number(match[4]),a:match[5]===void 0?1:Number(match[5])/(match[6]?100:1)});};var hslStringToHsva=hslaStringToHsva;var hslaToHsva=function hslaToHsva(_ref27){var h=_ref27.h,s2=_ref27.s,l=_ref27.l,a2=_ref27.a;s2*=(l<50?l:100-l)/100;return{h:h,s:s2>0?2*s2/(l+s2)*100:0,v:l+s2,a:a2};};var hsvaToHex=function hsvaToHex(hsva){return rgbaToHex(hsvaToRgba(hsva));};var hsvaToHsla=function hsvaToHsla(_ref28){var h=_ref28.h,s2=_ref28.s,v=_ref28.v,a2=_ref28.a;var hh=(200-s2)*v/100;return{h:round(h),s:round(hh>0&&hh<200?s2*v/100/(hh<=100?hh:200-hh)*100:0),l:round(hh/2),a:round(a2,2)};};var hsvaToHslString=function hsvaToHslString(hsva){var _hsvaToHsla=hsvaToHsla(hsva),h=_hsvaToHsla.h,s2=_hsvaToHsla.s,l=_hsvaToHsla.l;return"hsl(".concat(h,", ").concat(s2,"%, ").concat(l,"%)");};var hsvaToHslaString=function hsvaToHslaString(hsva){var _hsvaToHsla2=hsvaToHsla(hsva),h=_hsvaToHsla2.h,s2=_hsvaToHsla2.s,l=_hsvaToHsla2.l,a2=_hsvaToHsla2.a;return"hsla(".concat(h,", ").concat(s2,"%, ").concat(l,"%, ").concat(a2,")");};var hsvaToRgba=function hsvaToRgba(_ref29){var h=_ref29.h,s2=_ref29.s,v=_ref29.v,a2=_ref29.a;h=h/360*6;s2=s2/100;v=v/100;var hh=Math.floor(h),b=v*(1-s2),c2=v*(1-(h-hh)*s2),d=v*(1-(1-h+hh)*s2),module=hh%6;return{r:round([v,c2,b,b,d,v][module]*255),g:round([d,v,v,c2,b,b][module]*255),b:round([b,b,d,v,v,c2][module]*255),a:round(a2,2)};};var hsvaToRgbString=function hsvaToRgbString(hsva){var _hsvaToRgba=hsvaToRgba(hsva),r2=_hsvaToRgba.r,g=_hsvaToRgba.g,b=_hsvaToRgba.b;return"rgb(".concat(r2,", ").concat(g,", ").concat(b,")");};var hsvaToRgbaString=function hsvaToRgbaString(hsva){var _hsvaToRgba2=hsvaToRgba(hsva),r2=_hsvaToRgba2.r,g=_hsvaToRgba2.g,b=_hsvaToRgba2.b,a2=_hsvaToRgba2.a;return"rgba(".concat(r2,", ").concat(g,", ").concat(b,", ").concat(a2,")");};var rgbaStringToHsva=function rgbaStringToHsva(rgbaString){var matcher=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;var match=matcher.exec(rgbaString);if(!match)return{h:0,s:0,v:0,a:1};return rgbaToHsva({r:Number(match[1])/(match[2]?100/255:1),g:Number(match[3])/(match[4]?100/255:1),b:Number(match[5])/(match[6]?100/255:1),a:match[7]===void 0?1:Number(match[7])/(match[8]?100:1)});};var rgbStringToHsva=rgbaStringToHsva;var format=function format(number){var hex=number.toString(16);return hex.length<2?"0"+hex:hex;};var rgbaToHex=function rgbaToHex(_ref30){var r2=_ref30.r,g=_ref30.g,b=_ref30.b;return"#"+format(r2)+format(g)+format(b);};var rgbaToHsva=function rgbaToHsva(_ref31){var r2=_ref31.r,g=_ref31.g,b=_ref31.b,a2=_ref31.a;var max3=Math.max(r2,g,b);var delta=max3-Math.min(r2,g,b);var hh=delta?max3===r2?(g-b)/delta:max3===g?2+(b-r2)/delta:4+(r2-g)/delta:0;return{h:round(60*(hh<0?hh+6:hh)),s:round(max3?delta/max3*100:0),v:round(max3/255*100),a:a2};};// node_modules/vanilla-colorful/lib/utils/compare.js
var equalColorObjects=function equalColorObjects(first,second){if(first===second)return true;for(var prop in first){if(first[prop]!==second[prop])return false;}return true;};var equalColorString=function equalColorString(first,second){return first.replace(/\s/g,"")===second.replace(/\s/g,"");};var equalHex=function equalHex(first,second){if(first.toLowerCase()===second.toLowerCase())return true;return equalColorObjects(hexToRgba(first),hexToRgba(second));};// node_modules/vanilla-colorful/lib/utils/dom.js
var cache={};var tpl=function tpl(html2){var template=cache[html2];if(!template){template=document.createElement("template");template.innerHTML=html2;cache[html2]=template;}return template;};var fire=function fire(target,type,detail){target.dispatchEvent(new CustomEvent(type,{bubbles:true,detail:detail}));};// node_modules/vanilla-colorful/lib/components/slider.js
var hasTouched=false;var isTouch=function isTouch(e2){return"touches"in e2;};var isValid=function isValid(event){if(hasTouched&&!isTouch(event))return false;if(!hasTouched)hasTouched=isTouch(event);return true;};var pointerMove=function pointerMove(target,event){var pointer=isTouch(event)?event.touches[0]:event;var rect=target.el.getBoundingClientRect();fire(target.el,"move",target.getMove({x:clamp((pointer.pageX-(rect.left+window.pageXOffset))/rect.width),y:clamp((pointer.pageY-(rect.top+window.pageYOffset))/rect.height)}));};var keyMove=function keyMove(target,event){var keyCode=event.keyCode;if(keyCode>40||target.xy&&keyCode<37||keyCode<33)return;event.preventDefault();fire(target.el,"move",target.getMove({x:keyCode===39?0.01:keyCode===37?-0.01:keyCode===34?0.05:keyCode===33?-0.05:keyCode===35?1:keyCode===36?-1:0,y:keyCode===40?0.01:keyCode===38?-0.01:0},true));};var Slider=/*#__PURE__*/function(){function Slider(root2,part,aria,xy){_classCallCheck(this,Slider);var template=tpl("<div role=\"slider\" tabindex=\"0\" part=\"".concat(part,"\" ").concat(aria,"><div part=\"").concat(part,"-pointer\"></div></div>"));root2.appendChild(template.content.cloneNode(true));var el=root2.querySelector("[part=".concat(part,"]"));el.addEventListener("mousedown",this);el.addEventListener("touchstart",this);el.addEventListener("keydown",this);this.el=el;this.xy=xy;this.nodes=[el.firstChild,el];}_createClass(Slider,[{key:"dragging",set:function set(state2){var toggleEvent=state2?document.addEventListener:document.removeEventListener;toggleEvent(hasTouched?"touchmove":"mousemove",this);toggleEvent(hasTouched?"touchend":"mouseup",this);}},{key:"handleEvent",value:function handleEvent(event){switch(event.type){case"mousedown":case"touchstart":event.preventDefault();if(!isValid(event)||!hasTouched&&event.button!=0)return;this.el.focus();pointerMove(this,event);this.dragging=true;break;case"mousemove":case"touchmove":event.preventDefault();pointerMove(this,event);break;case"mouseup":case"touchend":this.dragging=false;break;case"keydown":keyMove(this,event);break;}}},{key:"style",value:function style(styles3){var _this12=this;styles3.forEach(function(style,i){for(var p2 in style){_this12.nodes[i].style.setProperty(p2,style[p2]);}});}}]);return Slider;}();// node_modules/vanilla-colorful/lib/components/hue.js
var Hue=/*#__PURE__*/function(_Slider){_inherits(Hue,_Slider);var _super10=_createSuper(Hue);function Hue(root2){_classCallCheck(this,Hue);return _super10.call(this,root2,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',false);}_createClass(Hue,[{key:"update",value:function update(_ref32){var h=_ref32.h;this.h=h;this.style([{left:"".concat(h/360*100,"%"),color:hsvaToHslString({h:h,s:100,v:100,a:1})}]);this.el.setAttribute("aria-valuenow","".concat(round(h)));}},{key:"getMove",value:function getMove(offset2,key){return{h:key?clamp(this.h+offset2.x*360,0,360):360*offset2.x};}}]);return Hue;}(Slider);// node_modules/vanilla-colorful/lib/components/saturation.js
var Saturation=/*#__PURE__*/function(_Slider2){_inherits(Saturation,_Slider2);var _super11=_createSuper(Saturation);function Saturation(root2){_classCallCheck(this,Saturation);return _super11.call(this,root2,"saturation",'aria-label="Color"',true);}_createClass(Saturation,[{key:"update",value:function update(hsva){this.hsva=hsva;this.style([{top:"".concat(100-hsva.v,"%"),left:"".concat(hsva.s,"%"),color:hsvaToHslString(hsva)},{"background-color":hsvaToHslString({h:hsva.h,s:100,v:100,a:1})}]);this.el.setAttribute("aria-valuetext","Saturation ".concat(round(hsva.s),"%, Brightness ").concat(round(hsva.v),"%"));}},{key:"getMove",value:function getMove(offset2,key){return{s:key?clamp(this.hsva.s+offset2.x*100,0,100):offset2.x*100,v:key?clamp(this.hsva.v-offset2.y*100,0,100):Math.round(100-offset2.y*100)};}}]);return Saturation;}(Slider);// node_modules/vanilla-colorful/lib/styles/color-picker.js
var color_picker_default=":host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{display:block;content:'';position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}";// node_modules/vanilla-colorful/lib/styles/hue.js
var hue_default="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}";// node_modules/vanilla-colorful/lib/styles/saturation.js
var saturation_default="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}";// node_modules/vanilla-colorful/lib/components/color-picker.js
var $isSame=Symbol("same");var $color=Symbol("color");var $hsva=Symbol("hsva");var $change=Symbol("change");var $update=Symbol("update");var $parts=Symbol("parts");var $css=Symbol("css");var $sliders=Symbol("sliders");var ColorPicker=/*#__PURE__*/function(_HTMLElement){_inherits(ColorPicker,_HTMLElement);var _super12=_createSuper(ColorPicker);function ColorPicker(){var _this13;_classCallCheck(this,ColorPicker);_this13=_super12.call(this);var template=tpl("<style>".concat(_this13[$css].join(""),"</style>"));var root2=_this13.attachShadow({mode:"open"});root2.appendChild(template.content.cloneNode(true));root2.addEventListener("move",_assertThisInitialized(_this13));_this13[$parts]=_this13[$sliders].map(function(slider){return new slider(root2);});return _this13;}_createClass(ColorPicker,[{key:$css,get:function get(){return[color_picker_default,hue_default,saturation_default];}},{key:$sliders,get:function get(){return[Saturation,Hue];}},{key:"color",get:function get(){return this[$color];}},{key:"color",set:function set(newColor){if(!this[$isSame](newColor)){var newHsva=this.colorModel.toHsva(newColor);this[$update](newHsva);this[$change](newColor);}}},{key:"connectedCallback",value:function connectedCallback(){if(this.hasOwnProperty("color")){var value=this.color;delete this["color"];this.color=value;}else if(!this.color){this.color=this.colorModel.defaultColor;}}},{key:"attributeChangedCallback",value:function attributeChangedCallback(_attr,_oldVal,newVal){var color=this.colorModel.fromAttr(newVal);if(!this[$isSame](color)){this.color=color;}}},{key:"handleEvent",value:function handleEvent(event){var oldHsva=this[$hsva];var newHsva=_objectSpread(_objectSpread({},oldHsva),event.detail);this[$update](newHsva);var newColor;if(!equalColorObjects(newHsva,oldHsva)&&!this[$isSame](newColor=this.colorModel.fromHsva(newHsva))){this[$change](newColor);}}},{key:$isSame,value:function value(color){return this.color&&this.colorModel.equal(color,this.color);}},{key:$update,value:function value(hsva){this[$hsva]=hsva;this[$parts].forEach(function(part){return part.update(hsva);});}},{key:$change,value:function value(_value){this[$color]=_value;fire(this,"color-changed",{value:_value});}}],[{key:"observedAttributes",get:function get(){return["color"];}}]);return ColorPicker;}(/*#__PURE__*/_wrapNativeSuper(HTMLElement));// node_modules/vanilla-colorful/lib/entrypoints/hex.js
var colorModel={defaultColor:"#000",toHsva:hexToHsva,fromHsva:hsvaToHex,equal:equalHex,fromAttr:function fromAttr(color){return color;}};var HexBase=/*#__PURE__*/function(_ColorPicker){_inherits(HexBase,_ColorPicker);var _super13=_createSuper(HexBase);function HexBase(){_classCallCheck(this,HexBase);return _super13.apply(this,arguments);}_createClass(HexBase,[{key:"colorModel",get:function get(){return colorModel;}}]);return HexBase;}(ColorPicker);// node_modules/vanilla-colorful/hex-color-picker.js
var HexColorPicker=/*#__PURE__*/function(_HexBase){_inherits(HexColorPicker,_HexBase);var _super14=_createSuper(HexColorPicker);function HexColorPicker(){_classCallCheck(this,HexColorPicker);return _super14.apply(this,arguments);}return HexColorPicker;}(HexBase);customElements.define("hex-color-picker",HexColorPicker);// node_modules/vanilla-colorful/lib/entrypoints/hsl-string.js
var colorModel2={defaultColor:"hsl(0, 0%, 0%)",toHsva:hslStringToHsva,fromHsva:hsvaToHslString,equal:equalColorString,fromAttr:function fromAttr(color){return color;}};var HslStringBase=/*#__PURE__*/function(_ColorPicker2){_inherits(HslStringBase,_ColorPicker2);var _super15=_createSuper(HslStringBase);function HslStringBase(){_classCallCheck(this,HslStringBase);return _super15.apply(this,arguments);}_createClass(HslStringBase,[{key:"colorModel",get:function get(){return colorModel2;}}]);return HslStringBase;}(ColorPicker);// node_modules/vanilla-colorful/hsl-string-color-picker.js
var HslStringColorPicker=/*#__PURE__*/function(_HslStringBase){_inherits(HslStringColorPicker,_HslStringBase);var _super16=_createSuper(HslStringColorPicker);function HslStringColorPicker(){_classCallCheck(this,HslStringColorPicker);return _super16.apply(this,arguments);}return HslStringColorPicker;}(HslStringBase);customElements.define("hsl-string-color-picker",HslStringColorPicker);// node_modules/vanilla-colorful/lib/entrypoints/rgb-string.js
var colorModel3={defaultColor:"rgb(0, 0, 0)",toHsva:rgbStringToHsva,fromHsva:hsvaToRgbString,equal:equalColorString,fromAttr:function fromAttr(color){return color;}};var RgbStringBase=/*#__PURE__*/function(_ColorPicker3){_inherits(RgbStringBase,_ColorPicker3);var _super17=_createSuper(RgbStringBase);function RgbStringBase(){_classCallCheck(this,RgbStringBase);return _super17.apply(this,arguments);}_createClass(RgbStringBase,[{key:"colorModel",get:function get(){return colorModel3;}}]);return RgbStringBase;}(ColorPicker);// node_modules/vanilla-colorful/rgb-string-color-picker.js
var RgbStringColorPicker=/*#__PURE__*/function(_RgbStringBase){_inherits(RgbStringColorPicker,_RgbStringBase);var _super18=_createSuper(RgbStringColorPicker);function RgbStringColorPicker(){_classCallCheck(this,RgbStringColorPicker);return _super18.apply(this,arguments);}return RgbStringColorPicker;}(RgbStringBase);customElements.define("rgb-string-color-picker",RgbStringColorPicker);// node_modules/vanilla-colorful/lib/components/alpha.js
var Alpha=/*#__PURE__*/function(_Slider3){_inherits(Alpha,_Slider3);var _super19=_createSuper(Alpha);function Alpha(root2){_classCallCheck(this,Alpha);return _super19.call(this,root2,"alpha",'aria-label="Alpha" aria-valuemin="0" aria-valuemax="1"',false);}_createClass(Alpha,[{key:"update",value:function update(hsva){this.hsva=hsva;var colorFrom=hsvaToHslaString(_objectSpread(_objectSpread({},hsva),{},{a:0}));var colorTo=hsvaToHslaString(_objectSpread(_objectSpread({},hsva),{},{a:1}));var value=hsva.a*100;this.style([{left:"".concat(value,"%"),color:hsvaToHslaString(hsva)},{"--gradient":"linear-gradient(90deg, ".concat(colorFrom,", ").concat(colorTo)}]);var v=round(value);this.el.setAttribute("aria-valuenow","".concat(v));this.el.setAttribute("aria-valuetext","".concat(v,"%"));}},{key:"getMove",value:function getMove(offset2,key){return{a:key?clamp(this.hsva.a+offset2.x):offset2.x};}}]);return Alpha;}(Slider);// node_modules/vanilla-colorful/lib/styles/alpha.js
var alpha_default="[part=alpha]{flex:0 0 24px}[part=alpha]::after{display:block;content:'';position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;background-image:var(--gradient);box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part^=alpha]{background-color:#fff;background-image:url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill-opacity=\".05\"><rect x=\"8\" width=\"8\" height=\"8\"/><rect y=\"8\" width=\"8\" height=\"8\"/></svg>')}[part=alpha-pointer]{top:50%}";// node_modules/vanilla-colorful/lib/components/alpha-color-picker.js
var AlphaColorPicker=/*#__PURE__*/function(_ColorPicker4){_inherits(AlphaColorPicker,_ColorPicker4);var _super20=_createSuper(AlphaColorPicker);function AlphaColorPicker(){_classCallCheck(this,AlphaColorPicker);return _super20.apply(this,arguments);}_createClass(AlphaColorPicker,[{key:$css,get:function get(){return[].concat(_toConsumableArray2(_get(_getPrototypeOf(AlphaColorPicker.prototype),$css,this)),[alpha_default]);}},{key:$sliders,get:function get(){return[].concat(_toConsumableArray2(_get(_getPrototypeOf(AlphaColorPicker.prototype),$sliders,this)),[Alpha]);}}]);return AlphaColorPicker;}(ColorPicker);// node_modules/vanilla-colorful/lib/entrypoints/rgba-string.js
var colorModel4={defaultColor:"rgba(0, 0, 0, 1)",toHsva:rgbaStringToHsva,fromHsva:hsvaToRgbaString,equal:equalColorString,fromAttr:function fromAttr(color){return color;}};var RgbaStringBase=/*#__PURE__*/function(_AlphaColorPicker){_inherits(RgbaStringBase,_AlphaColorPicker);var _super21=_createSuper(RgbaStringBase);function RgbaStringBase(){_classCallCheck(this,RgbaStringBase);return _super21.apply(this,arguments);}_createClass(RgbaStringBase,[{key:"colorModel",get:function get(){return colorModel4;}}]);return RgbaStringBase;}(AlphaColorPicker);// node_modules/vanilla-colorful/rgba-string-color-picker.js
var RgbaStringColorPicker=/*#__PURE__*/function(_RgbaStringBase){_inherits(RgbaStringColorPicker,_RgbaStringBase);var _super22=_createSuper(RgbaStringColorPicker);function RgbaStringColorPicker(){_classCallCheck(this,RgbaStringColorPicker);return _super22.apply(this,arguments);}return RgbaStringColorPicker;}(RgbaStringBase);customElements.define("rgba-string-color-picker",RgbaStringColorPicker);// packages/forms/resources/js/components/color-picker.js
var color_picker_default2=function color_picker_default2(Alpine){Alpine.data("colorPickerFormComponent",function(_ref33){var isAutofocused=_ref33.isAutofocused,isDisabled=_ref33.isDisabled,state2=_ref33.state;return{state:state2,init:function init(){var _this14=this;if(!(this.state===null||this.state==="")){this.setState(this.state);}if(isAutofocused){this.togglePanelVisibility(this.$refs.input);}this.$refs.input.addEventListener("change",function(event){_this14.setState(event.target.value);});this.$refs.panel.addEventListener("color-changed",function(event){_this14.setState(event.detail.value);});},togglePanelVisibility:function togglePanelVisibility(){if(isDisabled){return;}this.$refs.panel.toggle(this.$refs.input);},setState:function setState(value){this.state=value;this.$refs.input.value=value;this.$refs.panel.color=value;},isOpen:function isOpen(){return this.$refs.panel.style.display==="block";}};});};// node_modules/dayjs/esm/constant.js
var SECONDS_A_MINUTE=60;var SECONDS_A_HOUR=SECONDS_A_MINUTE*60;var SECONDS_A_DAY=SECONDS_A_HOUR*24;var SECONDS_A_WEEK=SECONDS_A_DAY*7;var MILLISECONDS_A_SECOND=1e3;var MILLISECONDS_A_MINUTE=SECONDS_A_MINUTE*MILLISECONDS_A_SECOND;var MILLISECONDS_A_HOUR=SECONDS_A_HOUR*MILLISECONDS_A_SECOND;var MILLISECONDS_A_DAY=SECONDS_A_DAY*MILLISECONDS_A_SECOND;var MILLISECONDS_A_WEEK=SECONDS_A_WEEK*MILLISECONDS_A_SECOND;var MS="millisecond";var S="second";var MIN="minute";var H="hour";var D="day";var W="week";var M="month";var Q="quarter";var Y="year";var DATE="date";var FORMAT_DEFAULT="YYYY-MM-DDTHH:mm:ssZ";var INVALID_DATE_STRING="Invalid Date";var REGEX_PARSE=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/;var REGEX_FORMAT=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;// node_modules/dayjs/esm/locale/en.js
var en_default={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function ordinal(n2){var s2=["th","st","nd","rd"];var v=n2%100;return"["+n2+(s2[(v-20)%10]||s2[v]||s2[0])+"]";}};// node_modules/dayjs/esm/utils.js
var padStart=function padStart2(string,length,pad){var s2=String(string);if(!s2||s2.length>=length)return string;return""+Array(length+1-s2.length).join(pad)+string;};var padZoneStr=function padZoneStr2(instance){var negMinutes=-instance.utcOffset();var minutes=Math.abs(negMinutes);var hourOffset=Math.floor(minutes/60);var minuteOffset=minutes%60;return""+(negMinutes<=0?"+":"-")+padStart(hourOffset,2,"0")+":"+padStart(minuteOffset,2,"0");};var monthDiff=function monthDiff2(a2,b){if(a2.date()<b.date())return-monthDiff2(b,a2);var wholeMonthDiff=(b.year()-a2.year())*12+(b.month()-a2.month());var anchor=a2.clone().add(wholeMonthDiff,M);var c2=b-anchor<0;var anchor2=a2.clone().add(wholeMonthDiff+(c2?-1:1),M);return+(-(wholeMonthDiff+(b-anchor)/(c2?anchor-anchor2:anchor2-anchor))||0);};var absFloor=function absFloor2(n2){return n2<0?Math.ceil(n2)||0:Math.floor(n2);};var prettyUnit=function prettyUnit2(u){var special={M:M,y:Y,w:W,d:D,D:DATE,h:H,m:MIN,s:S,ms:MS,Q:Q};return special[u]||String(u||"").toLowerCase().replace(/s$/,"");};var isUndefined=function isUndefined2(s2){return s2===void 0;};var utils_default={s:padStart,z:padZoneStr,m:monthDiff,a:absFloor,p:prettyUnit,u:isUndefined};// node_modules/dayjs/esm/index.js
var L="en";var Ls={};Ls[L]=en_default;var isDayjs=function isDayjs2(d){return d instanceof Dayjs;};var parseLocale=function parseLocale2(preset,object,isLocal){var l;if(!preset)return L;if(typeof preset==="string"){var presetLower=preset.toLowerCase();if(Ls[presetLower]){l=presetLower;}if(object){Ls[presetLower]=object;l=presetLower;}var presetSplit=preset.split("-");if(!l&&presetSplit.length>1){return parseLocale2(presetSplit[0]);}}else{var name2=preset.name;Ls[name2]=preset;l=name2;}if(!isLocal&&l)L=l;return l||!isLocal&&L;};var dayjs=function dayjs2(date,c2){if(isDayjs(date)){return date.clone();}var cfg=_typeof4(c2)==="object"?c2:{};cfg.date=date;cfg.args=arguments;return new Dayjs(cfg);};var wrapper=function wrapper2(date,instance){return dayjs(date,{locale:instance.$L,utc:instance.$u,x:instance.$x,$offset:instance.$offset});};var Utils=utils_default;Utils.l=parseLocale;Utils.i=isDayjs;Utils.w=wrapper;var parseDate=function parseDate2(cfg){var date=cfg.date,utc2=cfg.utc;if(date===null)return new Date(NaN);if(Utils.u(date))return new Date();if(date instanceof Date)return new Date(date);if(typeof date==="string"&&!/Z$/i.test(date)){var d=date.match(REGEX_PARSE);if(d){var m=d[2]-1||0;var ms=(d[7]||"0").substring(0,3);if(utc2){return new Date(Date.UTC(d[1],m,d[3]||1,d[4]||0,d[5]||0,d[6]||0,ms));}return new Date(d[1],m,d[3]||1,d[4]||0,d[5]||0,d[6]||0,ms);}}return new Date(date);};var Dayjs=/* @__PURE__ */function(){function Dayjs2(cfg){this.$L=parseLocale(cfg.locale,null,true);this.parse(cfg);}var _proto=Dayjs2.prototype;_proto.parse=function parse2(cfg){this.$d=parseDate(cfg);this.$x=cfg.x||{};this.init();};_proto.init=function init(){var $d=this.$d;this.$y=$d.getFullYear();this.$M=$d.getMonth();this.$D=$d.getDate();this.$W=$d.getDay();this.$H=$d.getHours();this.$m=$d.getMinutes();this.$s=$d.getSeconds();this.$ms=$d.getMilliseconds();};_proto.$utils=function $utils(){return Utils;};_proto.isValid=function isValid2(){return!(this.$d.toString()===INVALID_DATE_STRING);};_proto.isSame=function isSame(that,units){var other=dayjs(that);return this.startOf(units)<=other&&other<=this.endOf(units);};_proto.isAfter=function isAfter(that,units){return dayjs(that)<this.startOf(units);};_proto.isBefore=function isBefore(that,units){return this.endOf(units)<dayjs(that);};_proto.$g=function $g(input,get,set){if(Utils.u(input))return this[get];return this.set(set,input);};_proto.unix=function unix(){return Math.floor(this.valueOf()/1e3);};_proto.valueOf=function valueOf(){return this.$d.getTime();};_proto.startOf=function startOf(units,_startOf){var _this=this;var isStartOf=!Utils.u(_startOf)?_startOf:true;var unit=Utils.p(units);var instanceFactory=function instanceFactory2(d,m){var ins=Utils.w(_this.$u?Date.UTC(_this.$y,m,d):new Date(_this.$y,m,d),_this);return isStartOf?ins:ins.endOf(D);};var instanceFactorySet=function instanceFactorySet2(method,slice){var argumentStart=[0,0,0,0];var argumentEnd=[23,59,59,999];return Utils.w(_this.toDate()[method].apply(_this.toDate("s"),(isStartOf?argumentStart:argumentEnd).slice(slice)),_this);};var $W=this.$W,$M=this.$M,$D=this.$D;var utcPad="set"+(this.$u?"UTC":"");switch(unit){case Y:return isStartOf?instanceFactory(1,0):instanceFactory(31,11);case M:return isStartOf?instanceFactory(1,$M):instanceFactory(0,$M+1);case W:{var weekStart=this.$locale().weekStart||0;var gap=($W<weekStart?$W+7:$W)-weekStart;return instanceFactory(isStartOf?$D-gap:$D+(6-gap),$M);}case D:case DATE:return instanceFactorySet(utcPad+"Hours",0);case H:return instanceFactorySet(utcPad+"Minutes",1);case MIN:return instanceFactorySet(utcPad+"Seconds",2);case S:return instanceFactorySet(utcPad+"Milliseconds",3);default:return this.clone();}};_proto.endOf=function endOf(arg){return this.startOf(arg,false);};_proto.$set=function $set(units,_int){var _C$D$C$DATE$C$M$C$Y$C;var unit=Utils.p(units);var utcPad="set"+(this.$u?"UTC":"");var name2=(_C$D$C$DATE$C$M$C$Y$C={},_C$D$C$DATE$C$M$C$Y$C[D]=utcPad+"Date",_C$D$C$DATE$C$M$C$Y$C[DATE]=utcPad+"Date",_C$D$C$DATE$C$M$C$Y$C[M]=utcPad+"Month",_C$D$C$DATE$C$M$C$Y$C[Y]=utcPad+"FullYear",_C$D$C$DATE$C$M$C$Y$C[H]=utcPad+"Hours",_C$D$C$DATE$C$M$C$Y$C[MIN]=utcPad+"Minutes",_C$D$C$DATE$C$M$C$Y$C[S]=utcPad+"Seconds",_C$D$C$DATE$C$M$C$Y$C[MS]=utcPad+"Milliseconds",_C$D$C$DATE$C$M$C$Y$C)[unit];var arg=unit===D?this.$D+(_int-this.$W):_int;if(unit===M||unit===Y){var date=this.clone().set(DATE,1);date.$d[name2](arg);date.init();this.$d=date.set(DATE,Math.min(this.$D,date.daysInMonth())).$d;}else if(name2)this.$d[name2](arg);this.init();return this;};_proto.set=function set(string,_int2){return this.clone().$set(string,_int2);};_proto.get=function get(unit){return this[Utils.p(unit)]();};_proto.add=function add(number,units){var _this2=this,_C$MIN$C$H$C$S$unit;number=Number(number);var unit=Utils.p(units);var instanceFactorySet=function instanceFactorySet2(n2){var d=dayjs(_this2);return Utils.w(d.date(d.date()+Math.round(n2*number)),_this2);};if(unit===M){return this.set(M,this.$M+number);}if(unit===Y){return this.set(Y,this.$y+number);}if(unit===D){return instanceFactorySet(1);}if(unit===W){return instanceFactorySet(7);}var step=(_C$MIN$C$H$C$S$unit={},_C$MIN$C$H$C$S$unit[MIN]=MILLISECONDS_A_MINUTE,_C$MIN$C$H$C$S$unit[H]=MILLISECONDS_A_HOUR,_C$MIN$C$H$C$S$unit[S]=MILLISECONDS_A_SECOND,_C$MIN$C$H$C$S$unit)[unit]||1;var nextTimeStamp=this.$d.getTime()+number*step;return Utils.w(nextTimeStamp,this);};_proto.subtract=function subtract(number,string){return this.add(number*-1,string);};_proto.format=function format2(formatStr){var _this3=this;var locale=this.$locale();if(!this.isValid())return locale.invalidDate||INVALID_DATE_STRING;var str=formatStr||FORMAT_DEFAULT;var zoneStr=Utils.z(this);var $H=this.$H,$m=this.$m,$M=this.$M;var weekdays=locale.weekdays,months=locale.months,meridiem=locale.meridiem;var getShort=function getShort2(arr,index2,full,length){return arr&&(arr[index2]||arr(_this3,str))||full[index2].slice(0,length);};var get$H=function get$H2(num){return Utils.s($H%12||12,num,"0");};var meridiemFunc=meridiem||function(hour,minute,isLowercase){var m=hour<12?"AM":"PM";return isLowercase?m.toLowerCase():m;};var matches2={YY:String(this.$y).slice(-2),YYYY:this.$y,M:$M+1,MM:Utils.s($M+1,2,"0"),MMM:getShort(locale.monthsShort,$M,months,3),MMMM:getShort(months,$M),D:this.$D,DD:Utils.s(this.$D,2,"0"),d:String(this.$W),dd:getShort(locale.weekdaysMin,this.$W,weekdays,2),ddd:getShort(locale.weekdaysShort,this.$W,weekdays,3),dddd:weekdays[this.$W],H:String($H),HH:Utils.s($H,2,"0"),h:get$H(1),hh:get$H(2),a:meridiemFunc($H,$m,true),A:meridiemFunc($H,$m,false),m:String($m),mm:Utils.s($m,2,"0"),s:String(this.$s),ss:Utils.s(this.$s,2,"0"),SSS:Utils.s(this.$ms,3,"0"),Z:zoneStr};return str.replace(REGEX_FORMAT,function(match,$1){return $1||matches2[match]||zoneStr.replace(":","");});};_proto.utcOffset=function utcOffset(){return-Math.round(this.$d.getTimezoneOffset()/15)*15;};_proto.diff=function diff(input,units,_float){var _C$Y$C$M$C$Q$C$W$C$D$;var unit=Utils.p(units);var that=dayjs(input);var zoneDelta=(that.utcOffset()-this.utcOffset())*MILLISECONDS_A_MINUTE;var diff2=this-that;var result=Utils.m(this,that);result=(_C$Y$C$M$C$Q$C$W$C$D$={},_C$Y$C$M$C$Q$C$W$C$D$[Y]=result/12,_C$Y$C$M$C$Q$C$W$C$D$[M]=result,_C$Y$C$M$C$Q$C$W$C$D$[Q]=result/3,_C$Y$C$M$C$Q$C$W$C$D$[W]=(diff2-zoneDelta)/MILLISECONDS_A_WEEK,_C$Y$C$M$C$Q$C$W$C$D$[D]=(diff2-zoneDelta)/MILLISECONDS_A_DAY,_C$Y$C$M$C$Q$C$W$C$D$[H]=diff2/MILLISECONDS_A_HOUR,_C$Y$C$M$C$Q$C$W$C$D$[MIN]=diff2/MILLISECONDS_A_MINUTE,_C$Y$C$M$C$Q$C$W$C$D$[S]=diff2/MILLISECONDS_A_SECOND,_C$Y$C$M$C$Q$C$W$C$D$)[unit]||diff2;return _float?result:Utils.a(result);};_proto.daysInMonth=function daysInMonth(){return this.endOf(M).$D;};_proto.$locale=function $locale(){return Ls[this.$L];};_proto.locale=function locale(preset,object){if(!preset)return this.$L;var that=this.clone();var nextLocaleName=parseLocale(preset,object,true);if(nextLocaleName)that.$L=nextLocaleName;return that;};_proto.clone=function clone3(){return Utils.w(this.$d,this);};_proto.toDate=function toDate(){return new Date(this.valueOf());};_proto.toJSON=function toJSON(){return this.isValid()?this.toISOString():null;};_proto.toISOString=function toISOString(){return this.$d.toISOString();};_proto.toString=function toString2(){return this.$d.toUTCString();};return Dayjs2;}();var proto=Dayjs.prototype;dayjs.prototype=proto;[["$ms",MS],["$s",S],["$m",MIN],["$H",H],["$W",D],["$M",M],["$y",Y],["$D",DATE]].forEach(function(g){proto[g[1]]=function(input){return this.$g(input,g[0],g[1]);};});dayjs.extend=function(plugin9,option3){if(!plugin9.$i){plugin9(option3,Dayjs,dayjs);plugin9.$i=true;}return dayjs;};dayjs.locale=parseLocale;dayjs.isDayjs=isDayjs;dayjs.unix=function(timestamp){return dayjs(timestamp*1e3);};dayjs.en=Ls[L];dayjs.Ls=Ls;dayjs.p={};var esm_default=dayjs;// packages/forms/resources/js/components/date-time-picker.js
var import_customParseFormat=__toModule(require_customParseFormat());var import_localeData=__toModule(require_localeData());var import_timezone=__toModule(require_timezone());var import_utc=__toModule(require_utc());esm_default.extend(import_customParseFormat["default"]);esm_default.extend(import_localeData["default"]);esm_default.extend(import_timezone["default"]);esm_default.extend(import_utc["default"]);window.dayjs=esm_default;var date_time_picker_default=function date_time_picker_default(Alpine){Alpine.data("dateTimePickerFormComponent",function(_ref34){var displayFormat=_ref34.displayFormat,firstDayOfWeek=_ref34.firstDayOfWeek,isAutofocused=_ref34.isAutofocused,locale=_ref34.locale,shouldCloseOnDateSelection=_ref34.shouldCloseOnDateSelection,state2=_ref34.state;var timezone2=esm_default.tz.guess();return{daysInFocusedMonth:[],displayText:"",emptyDaysInFocusedMonth:[],focusedDate:null,focusedMonth:null,focusedYear:null,hour:null,isClearingState:false,minute:null,second:null,state:state2,dayLabels:[],months:[],init:function init(){var _locales$locale,_this$getSelectedDate,_date$hour,_date,_date$minute,_date2,_date$second,_date3,_this15=this;esm_default.locale((_locales$locale=locales[locale])!==null&&_locales$locale!==void 0?_locales$locale:locales["en"]);this.focusedDate=esm_default().tz(timezone2);var date=(_this$getSelectedDate=this.getSelectedDate())!==null&&_this$getSelectedDate!==void 0?_this$getSelectedDate:esm_default().tz(timezone2).hour(0).minute(0).second(0);if(this.getMaxDate()!==null&&date.isAfter(this.getMaxDate())){date=null;}else if(this.getMinDate()!==null&&date.isBefore(this.getMinDate())){date=null;}this.hour=(_date$hour=(_date=date)===null||_date===void 0?void 0:_date.hour())!==null&&_date$hour!==void 0?_date$hour:0;this.minute=(_date$minute=(_date2=date)===null||_date2===void 0?void 0:_date2.minute())!==null&&_date$minute!==void 0?_date$minute:0;this.second=(_date$second=(_date3=date)===null||_date3===void 0?void 0:_date3.second())!==null&&_date$second!==void 0?_date$second:0;this.setDisplayText();this.setMonths();this.setDayLabels();if(isAutofocused){this.$nextTick(function(){return _this15.togglePanelVisibility(_this15.$refs.button);});}this.$watch("focusedMonth",function(){_this15.focusedMonth=+_this15.focusedMonth;if(_this15.focusedDate.month()===_this15.focusedMonth){return;}_this15.focusedDate=_this15.focusedDate.month(_this15.focusedMonth);});this.$watch("focusedYear",function(){var _this15$focusedYear,_this15$focusedYear2;if(((_this15$focusedYear=_this15.focusedYear)===null||_this15$focusedYear===void 0?void 0:_this15$focusedYear.length)>4){_this15.focusedYear=_this15.focusedYear.substring(0,4);}if(!_this15.focusedYear||((_this15$focusedYear2=_this15.focusedYear)===null||_this15$focusedYear2===void 0?void 0:_this15$focusedYear2.length)!==4){return;}var year=+_this15.focusedYear;if(!Number.isInteger(year)){year=esm_default().tz(timezone2).year();_this15.focusedYear=year;}if(_this15.focusedDate.year()===year){return;}_this15.focusedDate=_this15.focusedDate.year(year);});this.$watch("focusedDate",function(){var month=_this15.focusedDate.month();var year=_this15.focusedDate.year();if(_this15.focusedMonth!==month){_this15.focusedMonth=month;}if(_this15.focusedYear!==year){_this15.focusedYear=year;}_this15.setupDaysGrid();});this.$watch("hour",function(){var _this15$getSelectedDa,_this15$hour;var hour=+_this15.hour;if(!Number.isInteger(hour)){_this15.hour=0;}else if(hour>23){_this15.hour=0;}else if(hour<0){_this15.hour=23;}else{_this15.hour=hour;}if(_this15.isClearingState){return;}var date2=(_this15$getSelectedDa=_this15.getSelectedDate())!==null&&_this15$getSelectedDa!==void 0?_this15$getSelectedDa:_this15.focusedDate;_this15.setState(date2.hour((_this15$hour=_this15.hour)!==null&&_this15$hour!==void 0?_this15$hour:0));});this.$watch("minute",function(){var _this15$getSelectedDa2,_this15$minute;var minute=+_this15.minute;if(!Number.isInteger(minute)){_this15.minute=0;}else if(minute>59){_this15.minute=0;}else if(minute<0){_this15.minute=59;}else{_this15.minute=minute;}if(_this15.isClearingState){return;}var date2=(_this15$getSelectedDa2=_this15.getSelectedDate())!==null&&_this15$getSelectedDa2!==void 0?_this15$getSelectedDa2:_this15.focusedDate;_this15.setState(date2.minute((_this15$minute=_this15.minute)!==null&&_this15$minute!==void 0?_this15$minute:0));});this.$watch("second",function(){var _this15$getSelectedDa3,_this15$second;var second=+_this15.second;if(!Number.isInteger(second)){_this15.second=0;}else if(second>59){_this15.second=0;}else if(second<0){_this15.second=59;}else{_this15.second=second;}if(_this15.isClearingState){return;}var date2=(_this15$getSelectedDa3=_this15.getSelectedDate())!==null&&_this15$getSelectedDa3!==void 0?_this15$getSelectedDa3:_this15.focusedDate;_this15.setState(date2.second((_this15$second=_this15.second)!==null&&_this15$second!==void 0?_this15$second:0));});this.$watch("state",function(){var _date4,_date5,_date2$hour,_date6,_date2$minute,_date7,_date2$second,_date8;if(_this15.state===void 0){return;}var date2=_this15.getSelectedDate();if(date2===null){_this15.clearState();return;}if(_this15.getMaxDate()!==null&&(_date4=date2)!==null&&_date4!==void 0&&_date4.isAfter(_this15.getMaxDate())){date2=null;}if(_this15.getMinDate()!==null&&(_date5=date2)!==null&&_date5!==void 0&&_date5.isBefore(_this15.getMinDate())){date2=null;}var newHour=(_date2$hour=(_date6=date2)===null||_date6===void 0?void 0:_date6.hour())!==null&&_date2$hour!==void 0?_date2$hour:0;if(_this15.hour!==newHour){_this15.hour=newHour;}var newMinute=(_date2$minute=(_date7=date2)===null||_date7===void 0?void 0:_date7.minute())!==null&&_date2$minute!==void 0?_date2$minute:0;if(_this15.minute!==newMinute){_this15.minute=newMinute;}var newSecond=(_date2$second=(_date8=date2)===null||_date8===void 0?void 0:_date8.second())!==null&&_date2$second!==void 0?_date2$second:0;if(_this15.second!==newSecond){_this15.second=newSecond;}_this15.setDisplayText();});},clearState:function clearState(){var _this16=this;this.isClearingState=true;this.setState(null);this.hour=0;this.minute=0;this.second=0;this.$nextTick(function(){return _this16.isClearingState=false;});},dateIsDisabled:function dateIsDisabled(date){var _this$$refs,_this$$refs$disabledD;if((_this$$refs=this.$refs)!==null&&_this$$refs!==void 0&&_this$$refs.disabledDates&&JSON.parse((_this$$refs$disabledD=this.$refs.disabledDates.value)!==null&&_this$$refs$disabledD!==void 0?_this$$refs$disabledD:[]).some(function(disabledDate){disabledDate=esm_default(disabledDate);if(!disabledDate.isValid()){return false;}return disabledDate.isSame(date,"day");})){return true;}if(this.getMaxDate()&&date.isAfter(this.getMaxDate(),"day")){return true;}if(this.getMinDate()&&date.isBefore(this.getMinDate(),"day")){return true;}return false;},dayIsDisabled:function dayIsDisabled(day){var _this$focusedDate;(_this$focusedDate=this.focusedDate)!==null&&_this$focusedDate!==void 0?_this$focusedDate:this.focusedDate=esm_default().tz(timezone2);return this.dateIsDisabled(this.focusedDate.date(day));},dayIsSelected:function dayIsSelected(day){var _this$focusedDate2;var selectedDate=this.getSelectedDate();if(selectedDate===null){return false;}(_this$focusedDate2=this.focusedDate)!==null&&_this$focusedDate2!==void 0?_this$focusedDate2:this.focusedDate=esm_default().tz(timezone2);return selectedDate.date()===day&&selectedDate.month()===this.focusedDate.month()&&selectedDate.year()===this.focusedDate.year();},dayIsToday:function dayIsToday(day){var _this$focusedDate3;var date=esm_default().tz(timezone2);(_this$focusedDate3=this.focusedDate)!==null&&_this$focusedDate3!==void 0?_this$focusedDate3:this.focusedDate=date;return date.date()===day&&date.month()===this.focusedDate.month()&&date.year()===this.focusedDate.year();},focusPreviousDay:function focusPreviousDay(){var _this$focusedDate4;(_this$focusedDate4=this.focusedDate)!==null&&_this$focusedDate4!==void 0?_this$focusedDate4:this.focusedDate=esm_default().tz(timezone2);this.focusedDate=this.focusedDate.subtract(1,"day");},focusPreviousWeek:function focusPreviousWeek(){var _this$focusedDate5;(_this$focusedDate5=this.focusedDate)!==null&&_this$focusedDate5!==void 0?_this$focusedDate5:this.focusedDate=esm_default().tz(timezone2);this.focusedDate=this.focusedDate.subtract(1,"week");},focusNextDay:function focusNextDay(){var _this$focusedDate6;(_this$focusedDate6=this.focusedDate)!==null&&_this$focusedDate6!==void 0?_this$focusedDate6:this.focusedDate=esm_default().tz(timezone2);this.focusedDate=this.focusedDate.add(1,"day");},focusNextWeek:function focusNextWeek(){var _this$focusedDate7;(_this$focusedDate7=this.focusedDate)!==null&&_this$focusedDate7!==void 0?_this$focusedDate7:this.focusedDate=esm_default().tz(timezone2);this.focusedDate=this.focusedDate.add(1,"week");},getDayLabels:function getDayLabels(){var labels=esm_default.weekdaysShort();if(firstDayOfWeek===0){return labels;}return[].concat(_toConsumableArray2(labels.slice(firstDayOfWeek)),_toConsumableArray2(labels.slice(0,firstDayOfWeek)));},getMaxDate:function getMaxDate(){var _this$$refs$maxDate;var date=esm_default((_this$$refs$maxDate=this.$refs.maxDate)===null||_this$$refs$maxDate===void 0?void 0:_this$$refs$maxDate.value);return date.isValid()?date:null;},getMinDate:function getMinDate(){var _this$$refs$minDate;var date=esm_default((_this$$refs$minDate=this.$refs.minDate)===null||_this$$refs$minDate===void 0?void 0:_this$$refs$minDate.value);return date.isValid()?date:null;},getSelectedDate:function getSelectedDate(){if(this.state===void 0){return null;}if(this.state===null){return null;}var date=esm_default(this.state);if(!date.isValid()){return null;}return date;},togglePanelVisibility:function togglePanelVisibility(){if(!this.isOpen()){var _ref35,_this$getSelectedDate2;this.focusedDate=(_ref35=(_this$getSelectedDate2=this.getSelectedDate())!==null&&_this$getSelectedDate2!==void 0?_this$getSelectedDate2:this.getMinDate())!==null&&_ref35!==void 0?_ref35:esm_default().tz(timezone2);this.setupDaysGrid();}this.$refs.panel.toggle(this.$refs.button);},selectDate:function selectDate(){var _this$focusedDate8;var day=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(day){this.setFocusedDay(day);}(_this$focusedDate8=this.focusedDate)!==null&&_this$focusedDate8!==void 0?_this$focusedDate8:this.focusedDate=esm_default().tz(timezone2);this.setState(this.focusedDate);if(shouldCloseOnDateSelection){this.togglePanelVisibility();}},setDisplayText:function setDisplayText(){this.displayText=this.getSelectedDate()?this.getSelectedDate().format(displayFormat):"";},setMonths:function setMonths(){this.months=esm_default.months();},setDayLabels:function setDayLabels(){this.dayLabels=this.getDayLabels();},setupDaysGrid:function setupDaysGrid(){var _this$focusedDate9;(_this$focusedDate9=this.focusedDate)!==null&&_this$focusedDate9!==void 0?_this$focusedDate9:this.focusedDate=esm_default().tz(timezone2);this.emptyDaysInFocusedMonth=Array.from({length:this.focusedDate.date(8-firstDayOfWeek).day()},function(_,i){return i+1;});this.daysInFocusedMonth=Array.from({length:this.focusedDate.daysInMonth()},function(_,i){return i+1;});},setFocusedDay:function setFocusedDay(day){var _this$focusedDate10;this.focusedDate=((_this$focusedDate10=this.focusedDate)!==null&&_this$focusedDate10!==void 0?_this$focusedDate10:esm_default().tz(timezone2)).date(day);},setState:function setState(date){var _this$hour,_this$minute,_this$second;if(date===null){this.state=null;this.setDisplayText();return;}if(this.dateIsDisabled(date)){return;}this.state=date.hour((_this$hour=this.hour)!==null&&_this$hour!==void 0?_this$hour:0).minute((_this$minute=this.minute)!==null&&_this$minute!==void 0?_this$minute:0).second((_this$second=this.second)!==null&&_this$second!==void 0?_this$second:0).format("YYYY-MM-DD HH:mm:ss");this.setDisplayText();},isOpen:function isOpen(){var _this$$refs$panel;return((_this$$refs$panel=this.$refs.panel)===null||_this$$refs$panel===void 0?void 0:_this$$refs$panel.style.display)==="block";}};});};var locales={ar:require_ar(),bs:require_bs(),ca:require_ca(),cs:require_cs(),da:require_da(),de:require_de(),en:require_en(),es:require_es(),fa:require_fa(),fi:require_fi(),fr:require_fr(),hi:require_hi(),hu:require_hu(),hy:require_hy_am(),id:require_id(),it:require_it(),ja:require_ja(),ka:require_ka(),km:require_km(),ku:require_ku(),ms:require_ms(),my:require_my(),nl:require_nl(),pl:require_pl(),pt_BR:require_pt_br(),pt_PT:require_pt(),ro:require_ro(),ru:require_ru(),sv:require_sv(),tr:require_tr(),uk:require_uk(),vi:require_vi(),zh_CN:require_zh_cn(),zh_TW:require_zh_tw()};// node_modules/filepond/dist/filepond.esm.js
var filepond_esm_exports={};__export(filepond_esm_exports,{FileOrigin:function FileOrigin(){return FileOrigin$1;},FileStatus:function FileStatus(){return _FileStatus;},OptionTypes:function OptionTypes(){return _OptionTypes;},Status:function Status(){return Status$1;},create:function create(){return create$f;},destroy:function destroy(){return _destroy2;},find:function find(){return _find;},getOptions:function getOptions(){return getOptions$1;},parse:function parse(){return _parse;},registerPlugin:function registerPlugin(){return _registerPlugin;},setOptions:function setOptions(){return setOptions$1;},supported:function supported(){return _supported;}});/*!
 * FilePond 4.30.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isNode=function isNode(value){return value instanceof HTMLElement;};var createStore=function createStore(initialState){var queries2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var actions2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var state2=_objectSpread({},initialState);var actionQueue=[];var dispatchQueue=[];var getState=function getState(){return _objectSpread({},state2);};var processActionQueue=function processActionQueue(){var queue=[].concat(actionQueue);actionQueue.length=0;return queue;};var processDispatchQueue=function processDispatchQueue(){var queue=[].concat(dispatchQueue);dispatchQueue.length=0;queue.forEach(function(_ref36){var type=_ref36.type,data3=_ref36.data;dispatch(type,data3);});};var dispatch=function dispatch(type,data3,isBlocking){if(isBlocking&&!document.hidden){dispatchQueue.push({type:type,data:data3});return;}if(actionHandlers[type]){actionHandlers[type](data3);}actionQueue.push({type:type,data:data3});};var query=function query(str){var _queryHandles;for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3];}return queryHandles[str]?(_queryHandles=queryHandles)[str].apply(_queryHandles,args):null;};var api={getState:getState,processActionQueue:processActionQueue,processDispatchQueue:processDispatchQueue,dispatch:dispatch,query:query};var queryHandles={};queries2.forEach(function(query2){queryHandles=_objectSpread(_objectSpread({},query2(state2)),queryHandles);});var actionHandlers={};actions2.forEach(function(action){actionHandlers=_objectSpread(_objectSpread({},action(dispatch,query,state2)),actionHandlers);});return api;};var defineProperty=function defineProperty(obj,property,definition){if(typeof definition==="function"){obj[property]=definition;return;}Object.defineProperty(obj,property,_objectSpread({},definition));};var forin=function forin(obj,cb){for(var key in obj){if(!obj.hasOwnProperty(key)){continue;}cb(key,obj[key]);}};var createObject=function createObject(definition){var obj={};forin(definition,function(property){defineProperty(obj,property,definition[property]);});return obj;};var attr=function attr(node,name2){var value=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(value===null){return node.getAttribute(name2)||node.hasAttribute(name2);}node.setAttribute(name2,value);};var ns="http://www.w3.org/2000/svg";var svgElements=["svg","path"];var isSVGElement=function isSVGElement(tag){return svgElements.includes(tag);};var createElement=function createElement(tag,className){var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(_typeof4(className)==="object"){attributes=className;className=null;}var element=isSVGElement(tag)?document.createElementNS(ns,tag):document.createElement(tag);if(className){if(isSVGElement(tag)){attr(element,"class",className);}else{element.className=className;}}forin(attributes,function(name2,value){attr(element,name2,value);});return element;};var appendChild=function appendChild(parent){return function(child,index2){if(typeof index2!=="undefined"&&parent.children[index2]){parent.insertBefore(child,parent.children[index2]);}else{parent.appendChild(child);}};};var appendChildView=function appendChildView(parent,childViews){return function(view,index2){if(typeof index2!=="undefined"){childViews.splice(index2,0,view);}else{childViews.push(view);}return view;};};var removeChildView=function removeChildView(parent,childViews){return function(view){childViews.splice(childViews.indexOf(view),1);if(view.element.parentNode){parent.removeChild(view.element);}return view;};};var IS_BROWSER=function(){return typeof window!=="undefined"&&typeof window.document!=="undefined";}();var isBrowser=function isBrowser(){return IS_BROWSER;};var testElement=isBrowser()?createElement("svg"):{};var getChildCount="children"in testElement?function(el){return el.children.length;}:function(el){return el.childNodes.length;};var getViewRect=function getViewRect(elementRect,childViews,offset2,scale){var left=offset2[0]||elementRect.left;var top=offset2[1]||elementRect.top;var right=left+elementRect.width;var bottom=top+elementRect.height*(scale[1]||1);var rect={element:_objectSpread({},elementRect),inner:{left:elementRect.left,top:elementRect.top,right:elementRect.right,bottom:elementRect.bottom},outer:{left:left,top:top,right:right,bottom:bottom}};childViews.filter(function(childView){return!childView.isRectIgnored();}).map(function(childView){return childView.rect;}).forEach(function(childViewRect){expandRect(rect.inner,_objectSpread({},childViewRect.inner));expandRect(rect.outer,_objectSpread({},childViewRect.outer));});calculateRectSize(rect.inner);rect.outer.bottom+=rect.element.marginBottom;rect.outer.right+=rect.element.marginRight;calculateRectSize(rect.outer);return rect;};var expandRect=function expandRect(parent,child){child.top+=parent.top;child.right+=parent.left;child.bottom+=parent.top;child.left+=parent.left;if(child.bottom>parent.bottom){parent.bottom=child.bottom;}if(child.right>parent.right){parent.right=child.right;}};var calculateRectSize=function calculateRectSize(rect){rect.width=rect.right-rect.left;rect.height=rect.bottom-rect.top;};var isNumber=function isNumber(value){return typeof value==="number";};var thereYet=function thereYet(position,destination,velocity){var errorMargin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1e-3;return Math.abs(position-destination)<errorMargin&&Math.abs(velocity)<errorMargin;};var spring=function spring(){var _ref37=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref37$stiffness=_ref37.stiffness,stiffness=_ref37$stiffness===void 0?0.5:_ref37$stiffness,_ref37$damping=_ref37.damping,damping=_ref37$damping===void 0?0.75:_ref37$damping,_ref37$mass=_ref37.mass,mass=_ref37$mass===void 0?10:_ref37$mass;var target=null;var position=null;var velocity=0;var resting=false;var interpolate=function interpolate(ts,skipToEndState){if(resting)return;if(!(isNumber(target)&&isNumber(position))){resting=true;velocity=0;return;}var f=-(position-target)*stiffness;velocity+=f/mass;position+=velocity;velocity*=damping;if(thereYet(position,target,velocity)||skipToEndState){position=target;velocity=0;resting=true;api.onupdate(position);api.oncomplete(position);}else{api.onupdate(position);}};var setTarget=function setTarget(value){if(isNumber(value)&&!isNumber(position)){position=value;}if(target===null){target=value;position=value;}target=value;if(position===target||typeof target==="undefined"){resting=true;velocity=0;api.onupdate(position);api.oncomplete(position);return;}resting=false;};var api=createObject({interpolate:interpolate,target:{set:setTarget,get:function get(){return target;}},resting:{get:function get(){return resting;}},onupdate:function onupdate(value){},oncomplete:function oncomplete(value){}});return api;};var easeInOutQuad=function easeInOutQuad(t2){return t2<0.5?2*t2*t2:-1+(4-2*t2)*t2;};var tween=function tween(){var _ref38=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref38$duration=_ref38.duration,duration=_ref38$duration===void 0?500:_ref38$duration,_ref38$easing=_ref38.easing,easing=_ref38$easing===void 0?easeInOutQuad:_ref38$easing,_ref38$delay=_ref38.delay,delay=_ref38$delay===void 0?0:_ref38$delay;var start=null;var t2;var p2;var resting=true;var reverse=false;var target=null;var interpolate=function interpolate(ts,skipToEndState){if(resting||target===null)return;if(start===null){start=ts;}if(ts-start<delay)return;t2=ts-start-delay;if(t2>=duration||skipToEndState){t2=1;p2=reverse?0:1;api.onupdate(p2*target);api.oncomplete(p2*target);resting=true;}else{p2=t2/duration;api.onupdate((t2>=0?easing(reverse?1-p2:p2):0)*target);}};var api=createObject({interpolate:interpolate,target:{get:function get(){return reverse?0:target;},set:function set(value){if(target===null){target=value;api.onupdate(value);api.oncomplete(value);return;}if(value<target){target=1;reverse=true;}else{reverse=false;target=value;}resting=false;start=null;}},resting:{get:function get(){return resting;}},onupdate:function onupdate(value){},oncomplete:function oncomplete(value){}});return api;};var animator={spring:spring,tween:tween};var createAnimator=function createAnimator(definition,category,property){var def=definition[category]&&_typeof4(definition[category][property])==="object"?definition[category][property]:definition[category]||definition;var type=typeof def==="string"?def:def.type;var props=_typeof4(def)==="object"?_objectSpread({},def):{};return animator[type]?animator[type](props):null;};var addGetSet=function addGetSet(keys,obj,props){var overwrite=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;obj=Array.isArray(obj)?obj:[obj];obj.forEach(function(o2){keys.forEach(function(key){var name2=key;var getter=function getter(){return props[key];};var setter=function setter(value){return props[key]=value;};if(_typeof4(key)==="object"){name2=key.key;getter=key.getter||getter;setter=key.setter||setter;}if(o2[name2]&&!overwrite){return;}o2[name2]={get:getter,set:setter};});});};var animations=function animations(_ref39){var mixinConfig=_ref39.mixinConfig,viewProps=_ref39.viewProps,viewInternalAPI=_ref39.viewInternalAPI,viewExternalAPI=_ref39.viewExternalAPI;var initialProps=_objectSpread({},viewProps);var animations2=[];forin(mixinConfig,function(property,animation){var animator2=createAnimator(animation);if(!animator2){return;}animator2.onupdate=function(value){viewProps[property]=value;};animator2.target=initialProps[property];var prop={key:property,setter:function setter(value){if(animator2.target===value){return;}animator2.target=value;},getter:function getter(){return viewProps[property];}};addGetSet([prop],[viewInternalAPI,viewExternalAPI],viewProps,true);animations2.push(animator2);});return{write:function write(ts){var skipToEndState=document.hidden;var resting=true;animations2.forEach(function(animation){if(!animation.resting)resting=false;animation.interpolate(ts,skipToEndState);});return resting;},destroy:function destroy(){}};};var addEvent=function addEvent(element){return function(type,fn2){element.addEventListener(type,fn2);};};var removeEvent=function removeEvent(element){return function(type,fn2){element.removeEventListener(type,fn2);};};var listeners=function listeners(_ref40){var mixinConfig=_ref40.mixinConfig,viewProps=_ref40.viewProps,viewInternalAPI=_ref40.viewInternalAPI,viewExternalAPI=_ref40.viewExternalAPI,viewState=_ref40.viewState,view=_ref40.view;var events=[];var add=addEvent(view.element);var remove=removeEvent(view.element);viewExternalAPI.on=function(type,fn2){events.push({type:type,fn:fn2});add(type,fn2);};viewExternalAPI.off=function(type,fn2){events.splice(events.findIndex(function(event){return event.type===type&&event.fn===fn2;}),1);remove(type,fn2);};return{write:function write(){return true;},destroy:function destroy(){events.forEach(function(event){remove(event.type,event.fn);});}};};var apis=function apis(_ref41){var mixinConfig=_ref41.mixinConfig,viewProps=_ref41.viewProps,viewExternalAPI=_ref41.viewExternalAPI;addGetSet(mixinConfig,viewExternalAPI,viewProps);};var isDefined=function isDefined(value){return value!=null;};var defaults={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0};var styles=function styles(_ref42){var mixinConfig=_ref42.mixinConfig,viewProps=_ref42.viewProps,viewInternalAPI=_ref42.viewInternalAPI,viewExternalAPI=_ref42.viewExternalAPI,view=_ref42.view;var initialProps=_objectSpread({},viewProps);var currentProps={};addGetSet(mixinConfig,[viewInternalAPI,viewExternalAPI],viewProps);var getOffset=function getOffset(){return[viewProps["translateX"]||0,viewProps["translateY"]||0];};var getScale=function getScale(){return[viewProps["scaleX"]||0,viewProps["scaleY"]||0];};var getRect2=function getRect2(){return view.rect?getViewRect(view.rect,view.childViews,getOffset(),getScale()):null;};viewInternalAPI.rect={get:getRect2};viewExternalAPI.rect={get:getRect2};mixinConfig.forEach(function(key){viewProps[key]=typeof initialProps[key]==="undefined"?defaults[key]:initialProps[key];});return{write:function write(){if(!propsHaveChanged(currentProps,viewProps)){return;}applyStyles(view.element,viewProps);Object.assign(currentProps,_objectSpread({},viewProps));return true;},destroy:function destroy(){}};};var propsHaveChanged=function propsHaveChanged(currentProps,newProps){if(Object.keys(currentProps).length!==Object.keys(newProps).length){return true;}for(var prop in newProps){if(newProps[prop]!==currentProps[prop]){return true;}}return false;};var applyStyles=function applyStyles(element,_ref43){var opacity=_ref43.opacity,perspective=_ref43.perspective,translateX=_ref43.translateX,translateY=_ref43.translateY,scaleX=_ref43.scaleX,scaleY=_ref43.scaleY,rotateX=_ref43.rotateX,rotateY=_ref43.rotateY,rotateZ=_ref43.rotateZ,originX=_ref43.originX,originY=_ref43.originY,width=_ref43.width,height=_ref43.height;var transforms2="";var styles3="";if(isDefined(originX)||isDefined(originY)){styles3+="transform-origin: ".concat(originX||0,"px ").concat(originY||0,"px;");}if(isDefined(perspective)){transforms2+="perspective(".concat(perspective,"px) ");}if(isDefined(translateX)||isDefined(translateY)){transforms2+="translate3d(".concat(translateX||0,"px, ").concat(translateY||0,"px, 0) ");}if(isDefined(scaleX)||isDefined(scaleY)){transforms2+="scale3d(".concat(isDefined(scaleX)?scaleX:1,", ").concat(isDefined(scaleY)?scaleY:1,", 1) ");}if(isDefined(rotateZ)){transforms2+="rotateZ(".concat(rotateZ,"rad) ");}if(isDefined(rotateX)){transforms2+="rotateX(".concat(rotateX,"rad) ");}if(isDefined(rotateY)){transforms2+="rotateY(".concat(rotateY,"rad) ");}if(transforms2.length){styles3+="transform:".concat(transforms2,";");}if(isDefined(opacity)){styles3+="opacity:".concat(opacity,";");if(opacity===0){styles3+="visibility:hidden;";}if(opacity<1){styles3+="pointer-events:none;";}}if(isDefined(height)){styles3+="height:".concat(height,"px;");}if(isDefined(width)){styles3+="width:".concat(width,"px;");}var elementCurrentStyle=element.elementCurrentStyle||"";if(styles3.length!==elementCurrentStyle.length||styles3!==elementCurrentStyle){element.style.cssText=styles3;element.elementCurrentStyle=styles3;}};var Mixins={styles:styles,listeners:listeners,animations:animations,apis:apis};var updateRect=function updateRect(){var rect=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var element=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var style=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!element.layoutCalculated){rect.paddingTop=parseInt(style.paddingTop,10)||0;rect.marginTop=parseInt(style.marginTop,10)||0;rect.marginRight=parseInt(style.marginRight,10)||0;rect.marginBottom=parseInt(style.marginBottom,10)||0;rect.marginLeft=parseInt(style.marginLeft,10)||0;element.layoutCalculated=true;}rect.left=element.offsetLeft||0;rect.top=element.offsetTop||0;rect.width=element.offsetWidth||0;rect.height=element.offsetHeight||0;rect.right=rect.left+rect.width;rect.bottom=rect.top+rect.height;rect.scrollTop=element.scrollTop;rect.hidden=element.offsetParent===null;return rect;};var createView=function createView(){var _ref44=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref44$tag=_ref44.tag,tag=_ref44$tag===void 0?"div":_ref44$tag,_ref44$name=_ref44.name,name2=_ref44$name===void 0?null:_ref44$name,_ref44$attributes=_ref44.attributes,attributes=_ref44$attributes===void 0?{}:_ref44$attributes,_ref44$read=_ref44.read,read=_ref44$read===void 0?function(){}:_ref44$read,_ref44$write=_ref44.write,write2=_ref44$write===void 0?function(){}:_ref44$write,_ref44$create=_ref44.create,create3=_ref44$create===void 0?function(){}:_ref44$create,_ref44$destroy=_ref44.destroy,destroy3=_ref44$destroy===void 0?function(){}:_ref44$destroy,_ref44$filterFrameAct=_ref44.filterFrameActionsForChild,filterFrameActionsForChild=_ref44$filterFrameAct===void 0?function(child,actions2){return actions2;}:_ref44$filterFrameAct,_ref44$didCreateView=_ref44.didCreateView,didCreateView=_ref44$didCreateView===void 0?function(){}:_ref44$didCreateView,_ref44$didWriteView=_ref44.didWriteView,didWriteView=_ref44$didWriteView===void 0?function(){}:_ref44$didWriteView,_ref44$ignoreRect=_ref44.ignoreRect,ignoreRect=_ref44$ignoreRect===void 0?false:_ref44$ignoreRect,_ref44$ignoreRectUpda=_ref44.ignoreRectUpdate,ignoreRectUpdate=_ref44$ignoreRectUpda===void 0?false:_ref44$ignoreRectUpda,_ref44$mixins=_ref44.mixins,mixins=_ref44$mixins===void 0?[]:_ref44$mixins;return function(store){var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var element=createElement(tag,"filepond--".concat(name2),attributes);var style=window.getComputedStyle(element,null);var rect=updateRect();var frameRect=null;var isResting=false;var childViews=[];var activeMixins=[];var ref={};var state2={};var writers=[write2];var readers=[read];var destroyers=[destroy3];var getElement=function getElement(){return element;};var getChildViews=function getChildViews(){return childViews.concat();};var getReference=function getReference(){return ref;};var createChildView=function createChildView(store2){return function(view,props2){return view(store2,props2);};};var getRect2=function getRect2(){if(frameRect){return frameRect;}frameRect=getViewRect(rect,childViews,[0,0],[1,1]);return frameRect;};var getStyle=function getStyle(){return style;};var _read=function _read(){frameRect=null;childViews.forEach(function(child){return child._read();});var shouldUpdate=!(ignoreRectUpdate&&rect.width&&rect.height);if(shouldUpdate){updateRect(rect,element,style);}var api={root:internalAPI,props:props,rect:rect};readers.forEach(function(reader){return reader(api);});};var _write=function _write(ts,frameActions,shouldOptimize){var resting=frameActions.length===0;writers.forEach(function(writer){var writerResting=writer({props:props,root:internalAPI,actions:frameActions,timestamp:ts,shouldOptimize:shouldOptimize});if(writerResting===false){resting=false;}});activeMixins.forEach(function(mixin){var mixinResting=mixin.write(ts);if(mixinResting===false){resting=false;}});childViews.filter(function(child){return!!child.element.parentNode;}).forEach(function(child){var childResting=child._write(ts,filterFrameActionsForChild(child,frameActions),shouldOptimize);if(!childResting){resting=false;}});childViews.forEach(function(child,index2){if(child.element.parentNode){return;}internalAPI.appendChild(child.element,index2);child._read();child._write(ts,filterFrameActionsForChild(child,frameActions),shouldOptimize);resting=false;});isResting=resting;didWriteView({props:props,root:internalAPI,actions:frameActions,timestamp:ts});return resting;};var _destroy=function _destroy(){activeMixins.forEach(function(mixin){return mixin.destroy();});destroyers.forEach(function(destroyer){destroyer({root:internalAPI,props:props});});childViews.forEach(function(child){return child._destroy();});};var sharedAPIDefinition={element:{get:getElement},style:{get:getStyle},childViews:{get:getChildViews}};var internalAPIDefinition=_objectSpread(_objectSpread({},sharedAPIDefinition),{},{rect:{get:getRect2},ref:{get:getReference},is:function is(needle){return name2===needle;},appendChild:appendChild(element),createChildView:createChildView(store),linkView:function linkView(view){childViews.push(view);return view;},unlinkView:function unlinkView(view){childViews.splice(childViews.indexOf(view),1);},appendChildView:appendChildView(element,childViews),removeChildView:removeChildView(element,childViews),registerWriter:function registerWriter(writer){return writers.push(writer);},registerReader:function registerReader(reader){return readers.push(reader);},registerDestroyer:function registerDestroyer(destroyer){return destroyers.push(destroyer);},invalidateLayout:function invalidateLayout(){return element.layoutCalculated=false;},dispatch:store.dispatch,query:store.query});var externalAPIDefinition={element:{get:getElement},childViews:{get:getChildViews},rect:{get:getRect2},resting:{get:function get(){return isResting;}},isRectIgnored:function isRectIgnored(){return ignoreRect;},_read:_read,_write:_write,_destroy:_destroy};var mixinAPIDefinition=_objectSpread(_objectSpread({},sharedAPIDefinition),{},{rect:{get:function get(){return rect;}}});Object.keys(mixins).sort(function(a2,b){if(a2==="styles"){return 1;}else if(b==="styles"){return-1;}return 0;}).forEach(function(key){var mixinAPI=Mixins[key]({mixinConfig:mixins[key],viewProps:props,viewState:state2,viewInternalAPI:internalAPIDefinition,viewExternalAPI:externalAPIDefinition,view:createObject(mixinAPIDefinition)});if(mixinAPI){activeMixins.push(mixinAPI);}});var internalAPI=createObject(internalAPIDefinition);create3({root:internalAPI,props:props});var childCount=getChildCount(element);childViews.forEach(function(child,index2){internalAPI.appendChild(child.element,childCount+index2);});didCreateView(internalAPI);return createObject(externalAPIDefinition);};};var createPainter=function createPainter(read,write2){var fps=arguments.length>2&&arguments[2]!==undefined?arguments[2]:60;var name2="__framePainter";if(window[name2]){window[name2].readers.push(read);window[name2].writers.push(write2);return;}window[name2]={readers:[read],writers:[write2]};var painter=window[name2];var interval=1e3/fps;var last=null;var id=null;var requestTick=null;var cancelTick=null;var setTimerType=function setTimerType(){if(document.hidden){requestTick=function requestTick(){return window.setTimeout(function(){return tick(performance.now());},interval);};cancelTick=function cancelTick(){return window.clearTimeout(id);};}else{requestTick=function requestTick(){return window.requestAnimationFrame(tick);};cancelTick=function cancelTick(){return window.cancelAnimationFrame(id);};}};document.addEventListener("visibilitychange",function(){if(cancelTick)cancelTick();setTimerType();tick(performance.now());});var tick=function tick(ts){id=requestTick(tick);if(!last){last=ts;}var delta=ts-last;if(delta<=interval){return;}last=ts-delta%interval;painter.readers.forEach(function(read2){return read2();});painter.writers.forEach(function(write3){return write3(ts);});};setTimerType();tick(performance.now());return{pause:function pause(){cancelTick(id);}};};var createRoute=function createRoute(routes,fn2){return function(_ref45){var root2=_ref45.root,props=_ref45.props,_ref45$actions=_ref45.actions,actions2=_ref45$actions===void 0?[]:_ref45$actions,timestamp=_ref45.timestamp,shouldOptimize=_ref45.shouldOptimize;actions2.filter(function(action){return routes[action.type];}).forEach(function(action){return routes[action.type]({root:root2,props:props,action:action.data,timestamp:timestamp,shouldOptimize:shouldOptimize});});if(fn2){fn2({root:root2,props:props,actions:actions2,timestamp:timestamp,shouldOptimize:shouldOptimize});}};};var _insertBefore=function insertBefore(newNode,referenceNode){return referenceNode.parentNode.insertBefore(newNode,referenceNode);};var _insertAfter=function insertAfter(newNode,referenceNode){return referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling);};var isArray=function isArray(value){return Array.isArray(value);};var isEmpty=function isEmpty(value){return value==null;};var trim=function trim(str){return str.trim();};var toString=function toString(value){return""+value;};var toArray=function toArray(value){var splitter=arguments.length>1&&arguments[1]!==undefined?arguments[1]:",";if(isEmpty(value)){return[];}if(isArray(value)){return value;}return toString(value).split(splitter).map(trim).filter(function(str){return str.length;});};var isBoolean=function isBoolean(value){return typeof value==="boolean";};var toBoolean=function toBoolean(value){return isBoolean(value)?value:value==="true";};var isString=function isString(value){return typeof value==="string";};var toNumber=function toNumber(value){return isNumber(value)?value:isString(value)?toString(value).replace(/[a-z]+/gi,""):0;};var toInt=function toInt(value){return parseInt(toNumber(value),10);};var toFloat=function toFloat(value){return parseFloat(toNumber(value));};var isInt=function isInt(value){return isNumber(value)&&isFinite(value)&&Math.floor(value)===value;};var toBytes=function toBytes(value){var base=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1e3;if(isInt(value)){return value;}var naturalFileSize=toString(value).trim();if(/MB$/i.test(naturalFileSize)){naturalFileSize=naturalFileSize.replace(/MB$i/,"").trim();return toInt(naturalFileSize)*base*base;}if(/KB/i.test(naturalFileSize)){naturalFileSize=naturalFileSize.replace(/KB$i/,"").trim();return toInt(naturalFileSize)*base;}return toInt(naturalFileSize);};var isFunction=function isFunction(value){return typeof value==="function";};var toFunctionReference=function toFunctionReference(string){var ref=self;var levels=string.split(".");var level=null;while(level=levels.shift()){ref=ref[level];if(!ref){return null;}}return ref;};var methods={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"};var createServerAPI=function createServerAPI(outline){var api={};api.url=isString(outline)?outline:outline.url||"";api.timeout=outline.timeout?parseInt(outline.timeout,10):0;api.headers=outline.headers?outline.headers:{};forin(methods,function(key){api[key]=createAction(key,outline[key],methods[key],api.timeout,api.headers);});api.process=outline.process||isString(outline)||outline.url?api.process:null;api.remove=outline.remove||null;delete api.headers;return api;};var createAction=function createAction(name2,outline,method,timeout,headers){if(outline===null){return null;}if(typeof outline==="function"){return outline;}var action={url:method==="GET"||method==="PATCH"?"?".concat(name2,"="):"",method:method,headers:headers,withCredentials:false,timeout:timeout,onload:null,ondata:null,onerror:null};if(isString(outline)){action.url=outline;return action;}Object.assign(action,outline);if(isString(action.headers)){var parts=action.headers.split(/:(.+)/);action.headers={header:parts[0],value:parts[1]};}action.withCredentials=toBoolean(action.withCredentials);return action;};var toServerAPI=function toServerAPI(value){return createServerAPI(value);};var isNull=function isNull(value){return value===null;};var isObject=function isObject(value){return _typeof4(value)==="object"&&value!==null;};var isAPI=function isAPI(value){return isObject(value)&&isString(value.url)&&isObject(value.process)&&isObject(value.revert)&&isObject(value.restore)&&isObject(value.fetch);};var getType=function getType(value){if(isArray(value)){return"array";}if(isNull(value)){return"null";}if(isInt(value)){return"int";}if(/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)){return"bytes";}if(isAPI(value)){return"api";}return _typeof4(value);};var replaceSingleQuotes=function replaceSingleQuotes(str){return str.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",');};var conversionTable={array:toArray,"boolean":toBoolean,"int":function int(value){return getType(value)==="bytes"?toBytes(value):toInt(value);},number:toFloat,"float":toFloat,bytes:toBytes,string:function string(value){return isFunction(value)?value:toString(value);},"function":function _function(value){return toFunctionReference(value);},serverapi:toServerAPI,object:function object(value){try{return JSON.parse(replaceSingleQuotes(value));}catch(e2){return null;}}};var convertTo=function convertTo(value,type){return conversionTable[type](value);};var getValueByType=function getValueByType(newValue,defaultValue,valueType){if(newValue===defaultValue){return newValue;}var newValueType=getType(newValue);if(newValueType!==valueType){var convertedValue=convertTo(newValue,valueType);newValueType=getType(convertedValue);if(convertedValue===null){throw"Trying to assign value with incorrect type to \"".concat(option,"\", allowed type: \"").concat(valueType,"\"");}else{newValue=convertedValue;}}return newValue;};var createOption=function createOption(defaultValue,valueType){var currentValue=defaultValue;return{enumerable:true,get:function get(){return currentValue;},set:function set(newValue){currentValue=getValueByType(newValue,defaultValue,valueType);}};};var createOptions=function createOptions(options2){var obj={};forin(options2,function(prop){var optionDefinition=options2[prop];obj[prop]=createOption(optionDefinition[0],optionDefinition[1]);});return createObject(obj);};var createInitialState=function createInitialState(options2){return{items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:createOptions(options2)};};var fromCamels=function fromCamels(string){var separator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"-";return string.split(/(?=[A-Z])/).map(function(part){return part.toLowerCase();}).join(separator);};var createOptionAPI=function createOptionAPI(store,options2){var obj={};forin(options2,function(key){obj[key]={get:function get(){return store.getState().options[key];},set:function set(value){store.dispatch("SET_".concat(fromCamels(key,"_").toUpperCase()),{value:value});}};});return obj;};var createOptionActions=function createOptionActions(options2){return function(dispatch,query,state2){var obj={};forin(options2,function(key){var name2=fromCamels(key,"_").toUpperCase();obj["SET_".concat(name2)]=function(action){try{state2.options[key]=action.value;}catch(e2){}dispatch("DID_SET_".concat(name2),{value:state2.options[key]});};});return obj;};};var createOptionQueries=function createOptionQueries(options2){return function(state2){var obj={};forin(options2,function(key){obj["GET_".concat(fromCamels(key,"_").toUpperCase())]=function(action){return state2.options[key];};});return obj;};};var InteractionMethod={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5};var getUniqueId=function getUniqueId(){return Math.random().toString(36).substring(2,11);};var arrayRemove=function arrayRemove(arr,index2){return arr.splice(index2,1);};var run=function run(cb,sync){if(sync){cb();}else if(document.hidden){Promise.resolve(1).then(cb);}else{setTimeout(cb,0);}};var on=function on(){var listeners2=[];var off2=function off2(event,cb){arrayRemove(listeners2,listeners2.findIndex(function(listener){return listener.event===event&&(listener.cb===cb||!cb);}));};var fire2=function fire2(event,args,sync){listeners2.filter(function(listener){return listener.event===event;}).map(function(listener){return listener.cb;}).forEach(function(cb){return run(function(){return cb.apply(void 0,_toConsumableArray2(args));},sync);});};return{fireSync:function fireSync(event){for(var _len4=arguments.length,args=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){args[_key4-1]=arguments[_key4];}fire2(event,args,true);},fire:function fire(event){for(var _len5=arguments.length,args=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){args[_key5-1]=arguments[_key5];}fire2(event,args,false);},on:function on(event,cb){listeners2.push({event:event,cb:cb});},onOnce:function onOnce(event,_cb){listeners2.push({event:event,cb:function cb(){off2(event,_cb);_cb.apply(void 0,arguments);}});},off:off2};};var copyObjectPropertiesToObject=function copyObjectPropertiesToObject(src,target,excluded){Object.getOwnPropertyNames(src).filter(function(property){return!excluded.includes(property);}).forEach(function(key){return Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(src,key));});};var PRIVATE=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"];var createItemAPI=function createItemAPI(item2){var api={};copyObjectPropertiesToObject(item2,api,PRIVATE);return api;};var removeReleasedItems=function removeReleasedItems(items){items.forEach(function(item2,index2){if(item2.released){arrayRemove(items,index2);}});};var ItemStatus={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8};var FileOrigin={INPUT:1,LIMBO:2,LOCAL:3};var getNonNumeric=function getNonNumeric(str){return /[^0-9]+/.exec(str);};var getDecimalSeparator=function getDecimalSeparator(){return getNonNumeric(1.1.toLocaleString())[0];};var getThousandsSeparator=function getThousandsSeparator(){var decimalSeparator=getDecimalSeparator();var thousandsStringWithSeparator=1e3.toLocaleString();var thousandsStringWithoutSeparator=1e3.toString();if(thousandsStringWithSeparator!==thousandsStringWithoutSeparator){return getNonNumeric(thousandsStringWithSeparator)[0];}return decimalSeparator==="."?",":".";};var Type={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"};var filters=[];var applyFilterChain=function applyFilterChain(key,value,utils){return new Promise(function(resolve,reject){var matchingFilters=filters.filter(function(f){return f.key===key;}).map(function(f){return f.cb;});if(matchingFilters.length===0){resolve(value);return;}var initialFilter=matchingFilters.shift();matchingFilters.reduce(function(current,next){return current.then(function(value2){return next(value2,utils);});},initialFilter(value,utils)).then(function(value2){return resolve(value2);})["catch"](function(error2){return reject(error2);});});};var applyFilters=function applyFilters(key,value,utils){return filters.filter(function(f){return f.key===key;}).map(function(f){return f.cb(value,utils);});};var addFilter=function addFilter(key,cb){return filters.push({key:key,cb:cb});};var extendDefaultOptions=function extendDefaultOptions(additionalOptions){return Object.assign(defaultOptions,additionalOptions);};var getOptions=function getOptions(){return _objectSpread({},defaultOptions);};var setOptions=function setOptions(opts){forin(opts,function(key,value){if(!defaultOptions[key]){return;}defaultOptions[key][0]=getValueByType(value,defaultOptions[key][0],defaultOptions[key][1]);});};var defaultOptions={id:[null,Type.STRING],name:["filepond",Type.STRING],disabled:[false,Type.BOOLEAN],className:[null,Type.STRING],required:[false,Type.BOOLEAN],captureMethod:[null,Type.STRING],allowSyncAcceptAttribute:[true,Type.BOOLEAN],allowDrop:[true,Type.BOOLEAN],allowBrowse:[true,Type.BOOLEAN],allowPaste:[true,Type.BOOLEAN],allowMultiple:[false,Type.BOOLEAN],allowReplace:[true,Type.BOOLEAN],allowRevert:[true,Type.BOOLEAN],allowRemove:[true,Type.BOOLEAN],allowProcess:[true,Type.BOOLEAN],allowReorder:[false,Type.BOOLEAN],allowDirectoriesOnly:[false,Type.BOOLEAN],storeAsFile:[false,Type.BOOLEAN],forceRevert:[false,Type.BOOLEAN],maxFiles:[null,Type.INT],checkValidity:[false,Type.BOOLEAN],itemInsertLocationFreedom:[true,Type.BOOLEAN],itemInsertLocation:["before",Type.STRING],itemInsertInterval:[75,Type.INT],dropOnPage:[false,Type.BOOLEAN],dropOnElement:[true,Type.BOOLEAN],dropValidation:[false,Type.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],Type.ARRAY],instantUpload:[true,Type.BOOLEAN],maxParallelUploads:[2,Type.INT],allowMinimumUploadDuration:[true,Type.BOOLEAN],chunkUploads:[false,Type.BOOLEAN],chunkForce:[false,Type.BOOLEAN],chunkSize:[5e6,Type.INT],chunkRetryDelays:[[500,1e3,3e3],Type.ARRAY],server:[null,Type.SERVER_API],fileSizeBase:[1e3,Type.INT],labelFileSizeBytes:["bytes",Type.STRING],labelFileSizeKilobytes:["KB",Type.STRING],labelFileSizeMegabytes:["MB",Type.STRING],labelFileSizeGigabytes:["GB",Type.STRING],labelDecimalSeparator:[getDecimalSeparator(),Type.STRING],labelThousandsSeparator:[getThousandsSeparator(),Type.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',Type.STRING],labelInvalidField:["Field contains invalid files",Type.STRING],labelFileWaitingForSize:["Waiting for size",Type.STRING],labelFileSizeNotAvailable:["Size not available",Type.STRING],labelFileCountSingular:["file in list",Type.STRING],labelFileCountPlural:["files in list",Type.STRING],labelFileLoading:["Loading",Type.STRING],labelFileAdded:["Added",Type.STRING],labelFileLoadError:["Error during load",Type.STRING],labelFileRemoved:["Removed",Type.STRING],labelFileRemoveError:["Error during remove",Type.STRING],labelFileProcessing:["Uploading",Type.STRING],labelFileProcessingComplete:["Upload complete",Type.STRING],labelFileProcessingAborted:["Upload cancelled",Type.STRING],labelFileProcessingError:["Error during upload",Type.STRING],labelFileProcessingRevertError:["Error during revert",Type.STRING],labelTapToCancel:["tap to cancel",Type.STRING],labelTapToRetry:["tap to retry",Type.STRING],labelTapToUndo:["tap to undo",Type.STRING],labelButtonRemoveItem:["Remove",Type.STRING],labelButtonAbortItemLoad:["Abort",Type.STRING],labelButtonRetryItemLoad:["Retry",Type.STRING],labelButtonAbortItemProcessing:["Cancel",Type.STRING],labelButtonUndoItemProcessing:["Undo",Type.STRING],labelButtonRetryItemProcessing:["Retry",Type.STRING],labelButtonProcessItem:["Upload",Type.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',Type.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],oninit:[null,Type.FUNCTION],onwarning:[null,Type.FUNCTION],onerror:[null,Type.FUNCTION],onactivatefile:[null,Type.FUNCTION],oninitfile:[null,Type.FUNCTION],onaddfilestart:[null,Type.FUNCTION],onaddfileprogress:[null,Type.FUNCTION],onaddfile:[null,Type.FUNCTION],onprocessfilestart:[null,Type.FUNCTION],onprocessfileprogress:[null,Type.FUNCTION],onprocessfileabort:[null,Type.FUNCTION],onprocessfilerevert:[null,Type.FUNCTION],onprocessfile:[null,Type.FUNCTION],onprocessfiles:[null,Type.FUNCTION],onremovefile:[null,Type.FUNCTION],onpreparefile:[null,Type.FUNCTION],onupdatefiles:[null,Type.FUNCTION],onreorderfiles:[null,Type.FUNCTION],beforeDropFile:[null,Type.FUNCTION],beforeAddFile:[null,Type.FUNCTION],beforeRemoveFile:[null,Type.FUNCTION],beforePrepareFile:[null,Type.FUNCTION],stylePanelLayout:[null,Type.STRING],stylePanelAspectRatio:[null,Type.STRING],styleItemPanelAspectRatio:[null,Type.STRING],styleButtonRemoveItemPosition:["left",Type.STRING],styleButtonProcessItemPosition:["right",Type.STRING],styleLoadIndicatorPosition:["right",Type.STRING],styleProgressIndicatorPosition:["right",Type.STRING],styleButtonRemoveItemAlign:[false,Type.BOOLEAN],files:[[],Type.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],Type.ARRAY]};var getItemByQuery=function getItemByQuery(items,query){if(isEmpty(query)){return items[0]||null;}if(isInt(query)){return items[query]||null;}if(_typeof4(query)==="object"){query=query.id;}return items.find(function(item2){return item2.id===query;})||null;};var getNumericAspectRatioFromString=function getNumericAspectRatioFromString(aspectRatio){if(isEmpty(aspectRatio)){return aspectRatio;}if(/:/.test(aspectRatio)){var parts=aspectRatio.split(":");return parts[1]/parts[0];}return parseFloat(aspectRatio);};var getActiveItems=function getActiveItems(items){return items.filter(function(item2){return!item2.archived;});};var Status={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};var res=null;var canUpdateFileInput=function canUpdateFileInput(){if(res===null){try{var dataTransfer=new DataTransfer();dataTransfer.items.add(new File(["hello world"],"This_Works.txt"));var el=document.createElement("input");el.setAttribute("type","file");el.files=dataTransfer.files;res=el.files.length===1;}catch(err){res=false;}}return res;};var ITEM_ERROR=[ItemStatus.LOAD_ERROR,ItemStatus.PROCESSING_ERROR,ItemStatus.PROCESSING_REVERT_ERROR];var ITEM_BUSY=[ItemStatus.LOADING,ItemStatus.PROCESSING,ItemStatus.PROCESSING_QUEUED,ItemStatus.INIT];var ITEM_READY=[ItemStatus.PROCESSING_COMPLETE];var isItemInErrorState=function isItemInErrorState(item2){return ITEM_ERROR.includes(item2.status);};var isItemInBusyState=function isItemInBusyState(item2){return ITEM_BUSY.includes(item2.status);};var isItemInReadyState=function isItemInReadyState(item2){return ITEM_READY.includes(item2.status);};var isAsync=function isAsync(state2){return isObject(state2.options.server)&&(isObject(state2.options.server.process)||isFunction(state2.options.server.process));};var queries=function queries(state2){return{GET_STATUS:function GET_STATUS(){var items=getActiveItems(state2.items);var EMPTY=Status.EMPTY,ERROR=Status.ERROR,BUSY=Status.BUSY,IDLE=Status.IDLE,READY=Status.READY;if(items.length===0)return EMPTY;if(items.some(isItemInErrorState))return ERROR;if(items.some(isItemInBusyState))return BUSY;if(items.some(isItemInReadyState))return READY;return IDLE;},GET_ITEM:function GET_ITEM(query){return getItemByQuery(state2.items,query);},GET_ACTIVE_ITEM:function GET_ACTIVE_ITEM(query){return getItemByQuery(getActiveItems(state2.items),query);},GET_ACTIVE_ITEMS:function GET_ACTIVE_ITEMS(){return getActiveItems(state2.items);},GET_ITEMS:function GET_ITEMS(){return state2.items;},GET_ITEM_NAME:function GET_ITEM_NAME(query){var item2=getItemByQuery(state2.items,query);return item2?item2.filename:null;},GET_ITEM_SIZE:function GET_ITEM_SIZE(query){var item2=getItemByQuery(state2.items,query);return item2?item2.fileSize:null;},GET_STYLES:function GET_STYLES(){return Object.keys(state2.options).filter(function(key){return /^style/.test(key);}).map(function(option3){return{name:option3,value:state2.options[option3]};});},GET_PANEL_ASPECT_RATIO:function GET_PANEL_ASPECT_RATIO(){var isShapeCircle=/circle/.test(state2.options.stylePanelLayout);var aspectRatio=isShapeCircle?1:getNumericAspectRatioFromString(state2.options.stylePanelAspectRatio);return aspectRatio;},GET_ITEM_PANEL_ASPECT_RATIO:function GET_ITEM_PANEL_ASPECT_RATIO(){return state2.options.styleItemPanelAspectRatio;},GET_ITEMS_BY_STATUS:function GET_ITEMS_BY_STATUS(status){return getActiveItems(state2.items).filter(function(item2){return item2.status===status;});},GET_TOTAL_ITEMS:function GET_TOTAL_ITEMS(){return getActiveItems(state2.items).length;},SHOULD_UPDATE_FILE_INPUT:function SHOULD_UPDATE_FILE_INPUT(){return state2.options.storeAsFile&&canUpdateFileInput()&&!isAsync(state2);},IS_ASYNC:function IS_ASYNC(){return isAsync(state2);},GET_FILE_SIZE_LABELS:function GET_FILE_SIZE_LABELS(query){return{labelBytes:query("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:query("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:query("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:query("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0};}};};var hasRoomForItem=function hasRoomForItem(state2){var count=getActiveItems(state2.items).length;if(!state2.options.allowMultiple){return count===0;}var maxFileCount=state2.options.maxFiles;if(maxFileCount===null){return true;}if(count<maxFileCount){return true;}return false;};var limit=function limit(value,min3,max3){return Math.max(Math.min(max3,value),min3);};var arrayInsert=function arrayInsert(arr,index2,item2){return arr.splice(index2,0,item2);};var insertItem=function insertItem(items,item2,index2){if(isEmpty(item2)){return null;}if(typeof index2==="undefined"){items.push(item2);return item2;}index2=limit(index2,0,items.length);arrayInsert(items,index2,item2);return item2;};var isBase64DataURI=function isBase64DataURI(str){return /^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(str);};var getFilenameFromURL=function getFilenameFromURL(url){return url.split("/").pop().split("?").shift();};var getExtensionFromFilename=function getExtensionFromFilename(name2){return name2.split(".").pop();};var guesstimateExtension=function guesstimateExtension(type){if(typeof type!=="string"){return"";}var subtype=type.split("/").pop();if(/svg/.test(subtype)){return"svg";}if(/zip|compressed/.test(subtype)){return"zip";}if(/plain/.test(subtype)){return"txt";}if(/msword/.test(subtype)){return"doc";}if(/[a-z]+/.test(subtype)){if(subtype==="jpeg"){return"jpg";}return subtype;}return"";};var leftPad=function leftPad(value){var padding=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return(padding+value).slice(-padding.length);};var getDateString=function getDateString(){var date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new Date();return"".concat(date.getFullYear(),"-").concat(leftPad(date.getMonth()+1,"00"),"-").concat(leftPad(date.getDate(),"00"),"_").concat(leftPad(date.getHours(),"00"),"-").concat(leftPad(date.getMinutes(),"00"),"-").concat(leftPad(date.getSeconds(),"00"));};var getFileFromBlob=function getFileFromBlob(blob2,filename){var type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var extension=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var file2=typeof type==="string"?blob2.slice(0,blob2.size,type):blob2.slice(0,blob2.size,blob2.type);file2.lastModifiedDate=new Date();if(blob2._relativePath)file2._relativePath=blob2._relativePath;if(!isString(filename)){filename=getDateString();}if(filename&&extension===null&&getExtensionFromFilename(filename)){file2.name=filename;}else{extension=extension||guesstimateExtension(file2.type);file2.name=filename+(extension?"."+extension:"");}return file2;};var getBlobBuilder=function getBlobBuilder(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;};var createBlob=function createBlob(arrayBuffer,mimeType){var BB=getBlobBuilder();if(BB){var bb=new BB();bb.append(arrayBuffer);return bb.getBlob(mimeType);}return new Blob([arrayBuffer],{type:mimeType});};var getBlobFromByteStringWithMimeType=function getBlobFromByteStringWithMimeType(byteString,mimeType){var ab=new ArrayBuffer(byteString.length);var ia=new Uint8Array(ab);for(var i=0;i<byteString.length;i++){ia[i]=byteString.charCodeAt(i);}return createBlob(ab,mimeType);};var getMimeTypeFromBase64DataURI=function getMimeTypeFromBase64DataURI(dataURI){return(/^data:(.+);/.exec(dataURI)||[])[1]||null;};var getBase64DataFromBase64DataURI=function getBase64DataFromBase64DataURI(dataURI){var data3=dataURI.split(",")[1];return data3.replace(/\s/g,"");};var getByteStringFromBase64DataURI=function getByteStringFromBase64DataURI(dataURI){return atob(getBase64DataFromBase64DataURI(dataURI));};var getBlobFromBase64DataURI=function getBlobFromBase64DataURI(dataURI){var mimeType=getMimeTypeFromBase64DataURI(dataURI);var byteString=getByteStringFromBase64DataURI(dataURI);return getBlobFromByteStringWithMimeType(byteString,mimeType);};var getFileFromBase64DataURI=function getFileFromBase64DataURI(dataURI,filename,extension){return getFileFromBlob(getBlobFromBase64DataURI(dataURI),filename,null,extension);};var getFileNameFromHeader=function getFileNameFromHeader(header){if(!/^content-disposition:/i.test(header))return null;var matches2=header.split(/filename=|filename\*=.+''/).splice(1).map(function(name2){return name2.trim().replace(/^["']|[;"']{0,2}$/g,"");}).filter(function(name2){return name2.length;});return matches2.length?decodeURI(matches2[matches2.length-1]):null;};var getFileSizeFromHeader=function getFileSizeFromHeader(header){if(/content-length:/i.test(header)){var size2=header.match(/[0-9]+/)[0];return size2?parseInt(size2,10):null;}return null;};var getTranfserIdFromHeader=function getTranfserIdFromHeader(header){if(/x-content-transfer-id:/i.test(header)){var id=(header.split(":")[1]||"").trim();return id||null;}return null;};var getFileInfoFromHeaders=function getFileInfoFromHeaders(headers){var info={source:null,name:null,size:null};var rows=headers.split("\n");var _iterator2=_createForOfIteratorHelper(rows),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var header=_step2.value;var name2=getFileNameFromHeader(header);if(name2){info.name=name2;continue;}var size2=getFileSizeFromHeader(header);if(size2){info.size=size2;continue;}var source=getTranfserIdFromHeader(header);if(source){info.source=source;continue;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return info;};var createFileLoader=function createFileLoader(fetchFn){var state2={source:null,complete:false,progress:0,size:null,timestamp:null,duration:0,request:null};var getProgress=function getProgress(){return state2.progress;};var abort=function abort(){if(state2.request&&state2.request.abort){state2.request.abort();}};var load=function load(){var source=state2.source;api.fire("init",source);if(source instanceof File){api.fire("load",source);}else if(source instanceof Blob){api.fire("load",getFileFromBlob(source,source.name));}else if(isBase64DataURI(source)){api.fire("load",getFileFromBase64DataURI(source));}else{loadURL(source);}};var loadURL=function loadURL(url){if(!fetchFn){api.fire("error",{type:"error",body:"Can't load URL",code:400});return;}state2.timestamp=Date.now();state2.request=fetchFn(url,function(response){state2.duration=Date.now()-state2.timestamp;state2.complete=true;if(response instanceof Blob){response=getFileFromBlob(response,response.name||getFilenameFromURL(url));}api.fire("load",response instanceof Blob?response:response?response.body:null);},function(error2){api.fire("error",typeof error2==="string"?{type:"error",code:0,body:error2}:error2);},function(computable,current,total){if(total){state2.size=total;}state2.duration=Date.now()-state2.timestamp;if(!computable){state2.progress=null;return;}state2.progress=current/total;api.fire("progress",state2.progress);},function(){api.fire("abort");},function(response){var fileinfo=getFileInfoFromHeaders(typeof response==="string"?response:response.headers);api.fire("meta",{size:state2.size||fileinfo.size,filename:fileinfo.name,source:fileinfo.source});});};var api=_objectSpread(_objectSpread({},on()),{},{setSource:function setSource(source){return state2.source=source;},getProgress:getProgress,abort:abort,load:load});return api;};var isGet=function isGet(method){return /GET|HEAD/.test(method);};var sendRequest=function sendRequest(data3,url,options2){var api={onheaders:function onheaders(){},onprogress:function onprogress(){},onload:function onload(){},ontimeout:function ontimeout(){},onerror:function onerror(){},onabort:function onabort(){},abort:function abort(){aborted=true;xhr.abort();}};var aborted=false;var headersReceived=false;options2=_objectSpread({method:"POST",headers:{},withCredentials:false},options2);url=encodeURI(url);if(isGet(options2.method)&&data3){url="".concat(url).concat(encodeURIComponent(typeof data3==="string"?data3:JSON.stringify(data3)));}var xhr=new XMLHttpRequest();var process=isGet(options2.method)?xhr:xhr.upload;process.onprogress=function(e2){if(aborted){return;}api.onprogress(e2.lengthComputable,e2.loaded,e2.total);};xhr.onreadystatechange=function(){if(xhr.readyState<2){return;}if(xhr.readyState===4&&xhr.status===0){return;}if(headersReceived){return;}headersReceived=true;api.onheaders(xhr);};xhr.onload=function(){if(xhr.status>=200&&xhr.status<300){api.onload(xhr);}else{api.onerror(xhr);}};xhr.onerror=function(){return api.onerror(xhr);};xhr.onabort=function(){aborted=true;api.onabort();};xhr.ontimeout=function(){return api.ontimeout(xhr);};xhr.open(options2.method,url,true);if(isInt(options2.timeout)){xhr.timeout=options2.timeout;}Object.keys(options2.headers).forEach(function(key){var value=unescape(encodeURIComponent(options2.headers[key]));xhr.setRequestHeader(key,value);});if(options2.responseType){xhr.responseType=options2.responseType;}if(options2.withCredentials){xhr.withCredentials=true;}xhr.send(data3);return api;};var createResponse=function createResponse(type,code,body,headers){return{type:type,code:code,body:body,headers:headers};};var createTimeoutResponse=function createTimeoutResponse(cb){return function(xhr){cb(createResponse("error",0,"Timeout",xhr.getAllResponseHeaders()));};};var hasQS=function hasQS(str){return /\?/.test(str);};var buildURL=function buildURL(){var url="";for(var _len6=arguments.length,parts=new Array(_len6),_key6=0;_key6<_len6;_key6++){parts[_key6]=arguments[_key6];}parts.forEach(function(part){url+=hasQS(url)&&hasQS(part)?part.replace(/\?/,"&"):part;});return url;};var createFetchFunction=function createFetchFunction(){var apiUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var action=arguments.length>1?arguments[1]:undefined;if(typeof action==="function"){return action;}if(!action||!isString(action.url)){return null;}var onload=action.onload||function(res2){return res2;};var onerror=action.onerror||function(res2){return null;};return function(url,load,error2,progress,abort,headers){var request=sendRequest(url,buildURL(apiUrl,action.url),_objectSpread(_objectSpread({},action),{},{responseType:"blob"}));request.onload=function(xhr){var headers2=xhr.getAllResponseHeaders();var filename=getFileInfoFromHeaders(headers2).name||getFilenameFromURL(url);load(createResponse("load",xhr.status,action.method==="HEAD"?null:getFileFromBlob(onload(xhr.response),filename),headers2));};request.onerror=function(xhr){error2(createResponse("error",xhr.status,onerror(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));};request.onheaders=function(xhr){headers(createResponse("headers",xhr.status,null,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);request.onprogress=progress;request.onabort=abort;return request;};};var ChunkStatus={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4};var processFileChunked=function processFileChunked(apiUrl,action,name2,file2,metadata,load,error2,progress,abort,transfer,options2){var chunks=[];var chunkTransferId=options2.chunkTransferId,chunkServer=options2.chunkServer,chunkSize=options2.chunkSize,chunkRetryDelays=options2.chunkRetryDelays;var state2={serverId:chunkTransferId,aborted:false};var ondata=action.ondata||function(fd){return fd;};var onload=action.onload||function(xhr,method){return method==="HEAD"?xhr.getResponseHeader("Upload-Offset"):xhr.response;};var onerror=action.onerror||function(res2){return null;};var requestTransferId=function requestTransferId(cb){var formData=new FormData();if(isObject(metadata))formData.append(name2,JSON.stringify(metadata));var headers=typeof action.headers==="function"?action.headers(file2,metadata):_objectSpread(_objectSpread({},action.headers),{},{"Upload-Length":file2.size});var requestParams=_objectSpread(_objectSpread({},action),{},{headers:headers});var request=sendRequest(ondata(formData),buildURL(apiUrl,action.url),requestParams);request.onload=function(xhr){return cb(onload(xhr,requestParams.method));};request.onerror=function(xhr){return error2(createResponse("error",xhr.status,onerror(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);};var requestTransferOffset=function requestTransferOffset(cb){var requestUrl=buildURL(apiUrl,chunkServer.url,state2.serverId);var headers=typeof action.headers==="function"?action.headers(state2.serverId):_objectSpread({},action.headers);var requestParams={headers:headers,method:"HEAD"};var request=sendRequest(null,requestUrl,requestParams);request.onload=function(xhr){return cb(onload(xhr,requestParams.method));};request.onerror=function(xhr){return error2(createResponse("error",xhr.status,onerror(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);};var lastChunkIndex=Math.floor(file2.size/chunkSize);for(var i=0;i<=lastChunkIndex;i++){var offset2=i*chunkSize;var data3=file2.slice(offset2,offset2+chunkSize,"application/offset+octet-stream");chunks[i]={index:i,size:data3.size,offset:offset2,data:data3,file:file2,progress:0,retries:_toConsumableArray2(chunkRetryDelays),status:ChunkStatus.QUEUED,error:null,request:null,timeout:null};}var completeProcessingChunks=function completeProcessingChunks(){return load(state2.serverId);};var canProcessChunk=function canProcessChunk(chunk){return chunk.status===ChunkStatus.QUEUED||chunk.status===ChunkStatus.ERROR;};var processChunk=function processChunk(chunk){if(state2.aborted)return;chunk=chunk||chunks.find(canProcessChunk);if(!chunk){if(chunks.every(function(chunk2){return chunk2.status===ChunkStatus.COMPLETE;})){completeProcessingChunks();}return;}chunk.status=ChunkStatus.PROCESSING;chunk.progress=null;var ondata2=chunkServer.ondata||function(fd){return fd;};var onerror2=chunkServer.onerror||function(res2){return null;};var requestUrl=buildURL(apiUrl,chunkServer.url,state2.serverId);var headers=typeof chunkServer.headers==="function"?chunkServer.headers(chunk):_objectSpread(_objectSpread({},chunkServer.headers),{},{"Content-Type":"application/offset+octet-stream","Upload-Offset":chunk.offset,"Upload-Length":file2.size,"Upload-Name":file2.name});var request=chunk.request=sendRequest(ondata2(chunk.data),requestUrl,_objectSpread(_objectSpread({},chunkServer),{},{headers:headers}));request.onload=function(){chunk.status=ChunkStatus.COMPLETE;chunk.request=null;processChunks();};request.onprogress=function(lengthComputable,loaded,total){chunk.progress=lengthComputable?loaded:null;updateTotalProgress();};request.onerror=function(xhr){chunk.status=ChunkStatus.ERROR;chunk.request=null;chunk.error=onerror2(xhr.response)||xhr.statusText;if(!retryProcessChunk(chunk)){error2(createResponse("error",xhr.status,onerror2(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));}};request.ontimeout=function(xhr){chunk.status=ChunkStatus.ERROR;chunk.request=null;if(!retryProcessChunk(chunk)){createTimeoutResponse(error2)(xhr);}};request.onabort=function(){chunk.status=ChunkStatus.QUEUED;chunk.request=null;abort();};};var retryProcessChunk=function retryProcessChunk(chunk){if(chunk.retries.length===0)return false;chunk.status=ChunkStatus.WAITING;clearTimeout(chunk.timeout);chunk.timeout=setTimeout(function(){processChunk(chunk);},chunk.retries.shift());return true;};var updateTotalProgress=function updateTotalProgress(){var totalBytesTransfered=chunks.reduce(function(p2,chunk){if(p2===null||chunk.progress===null)return null;return p2+chunk.progress;},0);if(totalBytesTransfered===null)return progress(false,0,0);var totalSize=chunks.reduce(function(total,chunk){return total+chunk.size;},0);progress(true,totalBytesTransfered,totalSize);};var processChunks=function processChunks(){var totalProcessing=chunks.filter(function(chunk){return chunk.status===ChunkStatus.PROCESSING;}).length;if(totalProcessing>=1)return;processChunk();};var abortChunks=function abortChunks(){chunks.forEach(function(chunk){clearTimeout(chunk.timeout);if(chunk.request){chunk.request.abort();}});};if(!state2.serverId){requestTransferId(function(serverId){if(state2.aborted)return;transfer(serverId);state2.serverId=serverId;processChunks();});}else{requestTransferOffset(function(offset2){if(state2.aborted)return;chunks.filter(function(chunk){return chunk.offset<offset2;}).forEach(function(chunk){chunk.status=ChunkStatus.COMPLETE;chunk.progress=chunk.size;});processChunks();});}return{abort:function abort(){state2.aborted=true;abortChunks();}};};var createFileProcessorFunction=function createFileProcessorFunction(apiUrl,action,name2,options2){return function(file2,metadata,load,error2,progress,abort,transfer){if(!file2)return;var canChunkUpload=options2.chunkUploads;var shouldChunkUpload=canChunkUpload&&file2.size>options2.chunkSize;var willChunkUpload=canChunkUpload&&(shouldChunkUpload||options2.chunkForce);if(file2 instanceof Blob&&willChunkUpload)return processFileChunked(apiUrl,action,name2,file2,metadata,load,error2,progress,abort,transfer,options2);var ondata=action.ondata||function(fd){return fd;};var onload=action.onload||function(res2){return res2;};var onerror=action.onerror||function(res2){return null;};var headers=typeof action.headers==="function"?action.headers(file2,metadata)||{}:_objectSpread({},action.headers);var requestParams=_objectSpread(_objectSpread({},action),{},{headers:headers});var formData=new FormData();if(isObject(metadata)){formData.append(name2,JSON.stringify(metadata));}(file2 instanceof Blob?[{name:null,file:file2}]:file2).forEach(function(item2){formData.append(name2,item2.file,item2.name===null?item2.file.name:"".concat(item2.name).concat(item2.file.name));});var request=sendRequest(ondata(formData),buildURL(apiUrl,action.url),requestParams);request.onload=function(xhr){load(createResponse("load",xhr.status,onload(xhr.response),xhr.getAllResponseHeaders()));};request.onerror=function(xhr){error2(createResponse("error",xhr.status,onerror(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);request.onprogress=progress;request.onabort=abort;return request;};};var createProcessorFunction=function createProcessorFunction(){var apiUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var action=arguments.length>1?arguments[1]:undefined;var name2=arguments.length>2?arguments[2]:undefined;var options2=arguments.length>3?arguments[3]:undefined;if(typeof action==="function")return function(){for(var _len7=arguments.length,params=new Array(_len7),_key7=0;_key7<_len7;_key7++){params[_key7]=arguments[_key7];}return action.apply(void 0,[name2].concat(params,[options2]));};if(!action||!isString(action.url))return null;return createFileProcessorFunction(apiUrl,action,name2,options2);};var createRevertFunction=function createRevertFunction(){var apiUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var action=arguments.length>1?arguments[1]:undefined;if(typeof action==="function"){return action;}if(!action||!isString(action.url)){return function(uniqueFileId,load){return load();};}var onload=action.onload||function(res2){return res2;};var onerror=action.onerror||function(res2){return null;};return function(uniqueFileId,load,error2){var request=sendRequest(uniqueFileId,apiUrl+action.url,action);request.onload=function(xhr){load(createResponse("load",xhr.status,onload(xhr.response),xhr.getAllResponseHeaders()));};request.onerror=function(xhr){error2(createResponse("error",xhr.status,onerror(xhr.response)||xhr.statusText,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);return request;};};var getRandomNumber=function getRandomNumber(){var min3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var max3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return min3+Math.random()*(max3-min3);};var createPerceivedPerformanceUpdater=function createPerceivedPerformanceUpdater(cb){var duration=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1e3;var offset2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var tickMin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:25;var tickMax=arguments.length>4&&arguments[4]!==undefined?arguments[4]:250;var timeout=null;var start=Date.now();var tick=function tick(){var runtime=Date.now()-start;var delay=getRandomNumber(tickMin,tickMax);if(runtime+delay>duration){delay=runtime+delay-duration;}var progress=runtime/duration;if(progress>=1||document.hidden){cb(1);return;}cb(progress);timeout=setTimeout(tick,delay);};if(duration>0)tick();return{clear:function clear(){clearTimeout(timeout);}};};var createFileProcessor=function createFileProcessor(processFn,options2){var state2={complete:false,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null};var allowMinimumUploadDuration=options2.allowMinimumUploadDuration;var process=function process(file2,metadata){var progressFn=function progressFn(){if(state2.duration===0||state2.progress===null)return;api.fire("progress",api.getProgress());};var completeFn=function completeFn(){state2.complete=true;api.fire("load-perceived",state2.response.body);};api.fire("start");state2.timestamp=Date.now();state2.perceivedPerformanceUpdater=createPerceivedPerformanceUpdater(function(progress){state2.perceivedProgress=progress;state2.perceivedDuration=Date.now()-state2.timestamp;progressFn();if(state2.response&&state2.perceivedProgress===1&&!state2.complete){completeFn();}},allowMinimumUploadDuration?getRandomNumber(750,1500):0);state2.request=processFn(file2,metadata,function(response){state2.response=isObject(response)?response:{type:"load",code:200,body:"".concat(response),headers:{}};state2.duration=Date.now()-state2.timestamp;state2.progress=1;api.fire("load",state2.response.body);if(!allowMinimumUploadDuration||allowMinimumUploadDuration&&state2.perceivedProgress===1){completeFn();}},function(error2){state2.perceivedPerformanceUpdater.clear();api.fire("error",isObject(error2)?error2:{type:"error",code:0,body:"".concat(error2)});},function(computable,current,total){state2.duration=Date.now()-state2.timestamp;state2.progress=computable?current/total:null;progressFn();},function(){state2.perceivedPerformanceUpdater.clear();api.fire("abort",state2.response?state2.response.body:null);},function(transferId){api.fire("transfer",transferId);});};var abort=function abort(){if(!state2.request)return;state2.perceivedPerformanceUpdater.clear();if(state2.request.abort)state2.request.abort();state2.complete=true;};var reset=function reset(){abort();state2.complete=false;state2.perceivedProgress=0;state2.progress=0;state2.timestamp=null;state2.perceivedDuration=0;state2.duration=0;state2.request=null;state2.response=null;};var getProgress=allowMinimumUploadDuration?function(){return state2.progress?Math.min(state2.progress,state2.perceivedProgress):null;}:function(){return state2.progress||null;};var getDuration=allowMinimumUploadDuration?function(){return Math.min(state2.duration,state2.perceivedDuration);}:function(){return state2.duration;};var api=_objectSpread(_objectSpread({},on()),{},{process:process,abort:abort,getProgress:getProgress,getDuration:getDuration,reset:reset});return api;};var getFilenameWithoutExtension=function getFilenameWithoutExtension(name2){return name2.substring(0,name2.lastIndexOf("."))||name2;};var createFileStub=function createFileStub(source){var data3=[source.name,source.size,source.type];if(source instanceof Blob||isBase64DataURI(source)){data3[0]=source.name||getDateString();}else if(isBase64DataURI(source)){data3[1]=source.length;data3[2]=getMimeTypeFromBase64DataURI(source);}else if(isString(source)){data3[0]=getFilenameFromURL(source);data3[1]=0;data3[2]="application/octet-stream";}return{name:data3[0],size:data3[1],type:data3[2]};};var isFile=function isFile(value){return!!(value instanceof File||value instanceof Blob&&value.name);};var deepCloneObject=function deepCloneObject(src){if(!isObject(src))return src;var target=isArray(src)?[]:{};for(var key in src){if(!src.hasOwnProperty(key))continue;var v=src[key];target[key]=v&&isObject(v)?deepCloneObject(v):v;}return target;};var createItem=function createItem(){var origin=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var serverFileReference=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var file2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var id=getUniqueId();var state2={archived:false,frozen:false,released:false,source:null,file:file2,serverFileReference:serverFileReference,transferId:null,processingAborted:false,status:serverFileReference?ItemStatus.PROCESSING_COMPLETE:ItemStatus.INIT,activeLoader:null,activeProcessor:null};var abortProcessingRequestComplete=null;var metadata={};var setStatus=function setStatus(status){return state2.status=status;};var fire2=function fire2(event){if(state2.released||state2.frozen)return;for(var _len8=arguments.length,params=new Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++){params[_key8-1]=arguments[_key8];}api.fire.apply(api,[event].concat(params));};var getFileExtension=function getFileExtension(){return getExtensionFromFilename(state2.file.name);};var getFileType=function getFileType(){return state2.file.type;};var getFileSize=function getFileSize(){return state2.file.size;};var getFile2=function getFile2(){return state2.file;};var load=function load(source,loader,onload){state2.source=source;api.fireSync("init");if(state2.file){api.fireSync("load-skip");return;}state2.file=createFileStub(source);loader.on("init",function(){fire2("load-init");});loader.on("meta",function(meta){state2.file.size=meta.size;state2.file.filename=meta.filename;if(meta.source){origin=FileOrigin.LIMBO;state2.serverFileReference=meta.source;state2.status=ItemStatus.PROCESSING_COMPLETE;}fire2("load-meta");});loader.on("progress",function(progress){setStatus(ItemStatus.LOADING);fire2("load-progress",progress);});loader.on("error",function(error2){setStatus(ItemStatus.LOAD_ERROR);fire2("load-request-error",error2);});loader.on("abort",function(){setStatus(ItemStatus.INIT);fire2("load-abort");});loader.on("load",function(file3){state2.activeLoader=null;var success=function success(result){state2.file=isFile(result)?result:state2.file;if(origin===FileOrigin.LIMBO&&state2.serverFileReference){setStatus(ItemStatus.PROCESSING_COMPLETE);}else{setStatus(ItemStatus.IDLE);}fire2("load");};var error2=function error2(result){state2.file=file3;fire2("load-meta");setStatus(ItemStatus.LOAD_ERROR);fire2("load-file-error",result);};if(state2.serverFileReference){success(file3);return;}onload(file3,success,error2);});loader.setSource(source);state2.activeLoader=loader;loader.load();};var retryLoad=function retryLoad(){if(!state2.activeLoader){return;}state2.activeLoader.load();};var abortLoad=function abortLoad(){if(state2.activeLoader){state2.activeLoader.abort();return;}setStatus(ItemStatus.INIT);fire2("load-abort");};var process=function process(processor,onprocess){if(state2.processingAborted){state2.processingAborted=false;return;}setStatus(ItemStatus.PROCESSING);abortProcessingRequestComplete=null;if(!(state2.file instanceof Blob)){api.on("load",function(){process(processor,onprocess);});return;}processor.on("load",function(serverFileReference2){state2.transferId=null;state2.serverFileReference=serverFileReference2;});processor.on("transfer",function(transferId){state2.transferId=transferId;});processor.on("load-perceived",function(serverFileReference2){state2.activeProcessor=null;state2.transferId=null;state2.serverFileReference=serverFileReference2;setStatus(ItemStatus.PROCESSING_COMPLETE);fire2("process-complete",serverFileReference2);});processor.on("start",function(){fire2("process-start");});processor.on("error",function(error3){state2.activeProcessor=null;setStatus(ItemStatus.PROCESSING_ERROR);fire2("process-error",error3);});processor.on("abort",function(serverFileReference2){state2.activeProcessor=null;state2.serverFileReference=serverFileReference2;setStatus(ItemStatus.IDLE);fire2("process-abort");if(abortProcessingRequestComplete){abortProcessingRequestComplete();}});processor.on("progress",function(progress){fire2("process-progress",progress);});var success=function success(file3){if(state2.archived)return;processor.process(file3,_objectSpread({},metadata));};var error2=console.error;onprocess(state2.file,success,error2);state2.activeProcessor=processor;};var requestProcessing=function requestProcessing(){state2.processingAborted=false;setStatus(ItemStatus.PROCESSING_QUEUED);};var abortProcessing=function abortProcessing(){return new Promise(function(resolve){if(!state2.activeProcessor){state2.processingAborted=true;setStatus(ItemStatus.IDLE);fire2("process-abort");resolve();return;}abortProcessingRequestComplete=function abortProcessingRequestComplete(){resolve();};state2.activeProcessor.abort();});};var revert=function revert(revertFileUpload,forceRevert){return new Promise(function(resolve,reject){var serverTransferId=state2.serverFileReference!==null?state2.serverFileReference:state2.transferId;if(serverTransferId===null){resolve();return;}revertFileUpload(serverTransferId,function(){state2.serverFileReference=null;state2.transferId=null;resolve();},function(error2){if(!forceRevert){resolve();return;}setStatus(ItemStatus.PROCESSING_REVERT_ERROR);fire2("process-revert-error");reject(error2);});setStatus(ItemStatus.IDLE);fire2("process-revert");});};var _setMetadata=function setMetadata(key,value,silent){var keys=key.split(".");var root2=keys[0];var last=keys.pop();var data3=metadata;keys.forEach(function(key2){return data3=data3[key2];});if(JSON.stringify(data3[last])===JSON.stringify(value))return;data3[last]=value;fire2("metadata-update",{key:root2,value:metadata[root2],silent:silent});};var getMetadata=function getMetadata(key){return deepCloneObject(key?metadata[key]:metadata);};var api=_objectSpread(_objectSpread({id:{get:function get(){return id;}},origin:{get:function get(){return origin;},set:function set(value){return origin=value;}},serverId:{get:function get(){return state2.serverFileReference;}},transferId:{get:function get(){return state2.transferId;}},status:{get:function get(){return state2.status;}},filename:{get:function get(){return state2.file.name;}},filenameWithoutExtension:{get:function get(){return getFilenameWithoutExtension(state2.file.name);}},fileExtension:{get:getFileExtension},fileType:{get:getFileType},fileSize:{get:getFileSize},file:{get:getFile2},relativePath:{get:function get(){return state2.file._relativePath;}},source:{get:function get(){return state2.source;}},getMetadata:getMetadata,setMetadata:function setMetadata(key,value,silent){if(isObject(key)){var data3=key;Object.keys(data3).forEach(function(key2){_setMetadata(key2,data3[key2],value);});return key;}_setMetadata(key,value,silent);return value;},extend:function extend(name2,handler){return itemAPI[name2]=handler;},abortLoad:abortLoad,retryLoad:retryLoad,requestProcessing:requestProcessing,abortProcessing:abortProcessing,load:load,process:process,revert:revert},on()),{},{freeze:function freeze(){return state2.frozen=true;},release:function release(){return state2.released=true;},released:{get:function get(){return state2.released;}},archive:function archive(){return state2.archived=true;},archived:{get:function get(){return state2.archived;}}});var itemAPI=createObject(api);return itemAPI;};var getItemIndexByQuery=function getItemIndexByQuery(items,query){if(isEmpty(query)){return 0;}if(!isString(query)){return-1;}return items.findIndex(function(item2){return item2.id===query;});};var getItemById=function getItemById(items,itemId){var index2=getItemIndexByQuery(items,itemId);if(index2<0){return;}return items[index2]||null;};var fetchBlob=function fetchBlob(url,load,error2,progress,abort,headers){var request=sendRequest(null,url,{method:"GET",responseType:"blob"});request.onload=function(xhr){var headers2=xhr.getAllResponseHeaders();var filename=getFileInfoFromHeaders(headers2).name||getFilenameFromURL(url);load(createResponse("load",xhr.status,getFileFromBlob(xhr.response,filename),headers2));};request.onerror=function(xhr){error2(createResponse("error",xhr.status,xhr.statusText,xhr.getAllResponseHeaders()));};request.onheaders=function(xhr){headers(createResponse("headers",xhr.status,null,xhr.getAllResponseHeaders()));};request.ontimeout=createTimeoutResponse(error2);request.onprogress=progress;request.onabort=abort;return request;};var getDomainFromURL=function getDomainFromURL(url){if(url.indexOf("//")===0){url=location.protocol+url;}return url.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0];};var isExternalURL=function isExternalURL(url){return(url.indexOf(":")>-1||url.indexOf("//")>-1)&&getDomainFromURL(location.href)!==getDomainFromURL(url);};var dynamicLabel=function dynamicLabel(label){return function(){return isFunction(label)?label.apply(void 0,arguments):label;};};var isMockItem=function isMockItem(item2){return!isFile(item2.file);};var listUpdated=function listUpdated(dispatch,state2){clearTimeout(state2.listUpdateTimeout);state2.listUpdateTimeout=setTimeout(function(){dispatch("DID_UPDATE_ITEMS",{items:getActiveItems(state2.items)});},0);};var optionalPromise=function optionalPromise(fn2){for(var _len9=arguments.length,params=new Array(_len9>1?_len9-1:0),_key9=1;_key9<_len9;_key9++){params[_key9-1]=arguments[_key9];}return new Promise(function(resolve){if(!fn2){return resolve(true);}var result=fn2.apply(void 0,params);if(result==null){return resolve(true);}if(typeof result==="boolean"){return resolve(result);}if(typeof result.then==="function"){result.then(resolve);}});};var sortItems=function sortItems(state2,compare){state2.items.sort(function(a2,b){return compare(createItemAPI(a2),createItemAPI(b));});};var getItemByQueryFromState=function getItemByQueryFromState(state2,itemHandler){return function(){var _ref46=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var query=_ref46.query,_ref46$success=_ref46.success,success=_ref46$success===void 0?function(){}:_ref46$success,_ref46$failure=_ref46.failure,failure=_ref46$failure===void 0?function(){}:_ref46$failure,options2=_objectWithoutProperties2(_ref46,_excluded7);var item2=getItemByQuery(state2.items,query);if(!item2){failure({error:createResponse("error",0,"Item not found"),file:null});return;}itemHandler(item2,success,failure,options2||{});};};var actions=function actions(dispatch,query,state2){return{ABORT_ALL:function ABORT_ALL(){getActiveItems(state2.items).forEach(function(item2){item2.freeze();item2.abortLoad();item2.abortProcessing();});},DID_SET_FILES:function DID_SET_FILES(_ref47){var _ref47$value=_ref47.value,value=_ref47$value===void 0?[]:_ref47$value;var files=value.map(function(file2){return{source:file2.source?file2.source:file2,options:file2.options};});var activeItems=getActiveItems(state2.items);activeItems.forEach(function(item2){if(!files.find(function(file2){return file2.source===item2.source||file2.source===item2.file;})){dispatch("REMOVE_ITEM",{query:item2,remove:false});}});activeItems=getActiveItems(state2.items);files.forEach(function(file2,index2){if(activeItems.find(function(item2){return item2.source===file2.source||item2.file===file2.source;}))return;dispatch("ADD_ITEM",_objectSpread(_objectSpread({},file2),{},{interactionMethod:InteractionMethod.NONE,index:index2}));});},DID_UPDATE_ITEM_METADATA:function DID_UPDATE_ITEM_METADATA(_ref48){var id=_ref48.id,action=_ref48.action,change=_ref48.change;if(change.silent)return;clearTimeout(state2.itemUpdateTimeout);state2.itemUpdateTimeout=setTimeout(function(){var item2=getItemById(state2.items,id);if(!query("IS_ASYNC")){applyFilterChain("SHOULD_PREPARE_OUTPUT",false,{item:item2,query:query,action:action,change:change}).then(function(shouldPrepareOutput){var beforePrepareFile=query("GET_BEFORE_PREPARE_FILE");if(beforePrepareFile)shouldPrepareOutput=beforePrepareFile(item2,shouldPrepareOutput);if(!shouldPrepareOutput)return;dispatch("REQUEST_PREPARE_OUTPUT",{query:id,item:item2,success:function success(file2){dispatch("DID_PREPARE_OUTPUT",{id:id,file:file2});}},true);});return;}if(item2.origin===FileOrigin.LOCAL){dispatch("DID_LOAD_ITEM",{id:item2.id,error:null,serverFileReference:item2.source});}var upload=function upload(){setTimeout(function(){dispatch("REQUEST_ITEM_PROCESSING",{query:id});},32);};var revert=function revert(doUpload){item2.revert(createRevertFunction(state2.options.server.url,state2.options.server.revert),query("GET_FORCE_REVERT")).then(doUpload?upload:function(){})["catch"](function(){});};var abort=function abort(doUpload){item2.abortProcessing().then(doUpload?upload:function(){});};if(item2.status===ItemStatus.PROCESSING_COMPLETE){return revert(state2.options.instantUpload);}if(item2.status===ItemStatus.PROCESSING){return abort(state2.options.instantUpload);}if(state2.options.instantUpload){upload();}},0);},MOVE_ITEM:function MOVE_ITEM(_ref49){var query2=_ref49.query,index2=_ref49.index;var item2=getItemByQuery(state2.items,query2);if(!item2)return;var currentIndex=state2.items.indexOf(item2);index2=limit(index2,0,state2.items.length-1);if(currentIndex===index2)return;state2.items.splice(index2,0,state2.items.splice(currentIndex,1)[0]);},SORT:function SORT(_ref50){var compare=_ref50.compare;sortItems(state2,compare);dispatch("DID_SORT_ITEMS",{items:query("GET_ACTIVE_ITEMS")});},ADD_ITEMS:function ADD_ITEMS(_ref51){var items=_ref51.items,index2=_ref51.index,interactionMethod=_ref51.interactionMethod,_ref51$success=_ref51.success,success=_ref51$success===void 0?function(){}:_ref51$success,_ref51$failure=_ref51.failure,failure=_ref51$failure===void 0?function(){}:_ref51$failure;var currentIndex=index2;if(index2===-1||typeof index2==="undefined"){var insertLocation=query("GET_ITEM_INSERT_LOCATION");var totalItems=query("GET_TOTAL_ITEMS");currentIndex=insertLocation==="before"?0:totalItems;}var ignoredFiles=query("GET_IGNORED_FILES");var isValidFile=function isValidFile(source){return isFile(source)?!ignoredFiles.includes(source.name.toLowerCase()):!isEmpty(source);};var validItems=items.filter(isValidFile);var promises=validItems.map(function(source){return new Promise(function(resolve,reject){dispatch("ADD_ITEM",{interactionMethod:interactionMethod,source:source.source||source,success:resolve,failure:reject,index:currentIndex++,options:source.options||{}});});});Promise.all(promises).then(success)["catch"](failure);},ADD_ITEM:function ADD_ITEM(_ref52){var source=_ref52.source,_ref52$index=_ref52.index,index2=_ref52$index===void 0?-1:_ref52$index,interactionMethod=_ref52.interactionMethod,_ref52$success=_ref52.success,success=_ref52$success===void 0?function(){}:_ref52$success,_ref52$failure=_ref52.failure,failure=_ref52$failure===void 0?function(){}:_ref52$failure,_ref52$options=_ref52.options,options2=_ref52$options===void 0?{}:_ref52$options;if(isEmpty(source)){failure({error:createResponse("error",0,"No source"),file:null});return;}if(isFile(source)&&state2.options.ignoredFiles.includes(source.name.toLowerCase())){return;}if(!hasRoomForItem(state2)){if(state2.options.allowMultiple||!state2.options.allowMultiple&&!state2.options.allowReplace){var error2=createResponse("warning",0,"Max files");dispatch("DID_THROW_MAX_FILES",{source:source,error:error2});failure({error:error2,file:null});return;}var item3=getActiveItems(state2.items)[0];if(item3.status===ItemStatus.PROCESSING_COMPLETE||item3.status===ItemStatus.PROCESSING_REVERT_ERROR){var forceRevert=query("GET_FORCE_REVERT");item3.revert(createRevertFunction(state2.options.server.url,state2.options.server.revert),forceRevert).then(function(){if(!forceRevert)return;dispatch("ADD_ITEM",{source:source,index:index2,interactionMethod:interactionMethod,success:success,failure:failure,options:options2});})["catch"](function(){});if(forceRevert)return;}dispatch("REMOVE_ITEM",{query:item3.id});}var origin=options2.type==="local"?FileOrigin.LOCAL:options2.type==="limbo"?FileOrigin.LIMBO:FileOrigin.INPUT;var item2=createItem(origin,origin===FileOrigin.INPUT?null:source,options2.file);Object.keys(options2.metadata||{}).forEach(function(key){item2.setMetadata(key,options2.metadata[key]);});applyFilters("DID_CREATE_ITEM",item2,{query:query,dispatch:dispatch});var itemInsertLocation=query("GET_ITEM_INSERT_LOCATION");if(!state2.options.itemInsertLocationFreedom){index2=itemInsertLocation==="before"?-1:state2.items.length;}insertItem(state2.items,item2,index2);if(isFunction(itemInsertLocation)&&source){sortItems(state2,itemInsertLocation);}var id=item2.id;item2.on("init",function(){dispatch("DID_INIT_ITEM",{id:id});});item2.on("load-init",function(){dispatch("DID_START_ITEM_LOAD",{id:id});});item2.on("load-meta",function(){dispatch("DID_UPDATE_ITEM_META",{id:id});});item2.on("load-progress",function(progress){dispatch("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:id,progress:progress});});item2.on("load-request-error",function(error2){var mainStatus=dynamicLabel(state2.options.labelFileLoadError)(error2);if(error2.code>=400&&error2.code<500){dispatch("DID_THROW_ITEM_INVALID",{id:id,error:error2,status:{main:mainStatus,sub:"".concat(error2.code," (").concat(error2.body,")")}});failure({error:error2,file:createItemAPI(item2)});return;}dispatch("DID_THROW_ITEM_LOAD_ERROR",{id:id,error:error2,status:{main:mainStatus,sub:state2.options.labelTapToRetry}});});item2.on("load-file-error",function(error2){dispatch("DID_THROW_ITEM_INVALID",{id:id,error:error2.status,status:error2.status});failure({error:error2.status,file:createItemAPI(item2)});});item2.on("load-abort",function(){dispatch("REMOVE_ITEM",{query:id});});item2.on("load-skip",function(){dispatch("COMPLETE_LOAD_ITEM",{query:id,item:item2,data:{source:source,success:success}});});item2.on("load",function(){var handleAdd=function handleAdd(shouldAdd){if(!shouldAdd){dispatch("REMOVE_ITEM",{query:id});return;}item2.on("metadata-update",function(change){dispatch("DID_UPDATE_ITEM_METADATA",{id:id,change:change});});applyFilterChain("SHOULD_PREPARE_OUTPUT",false,{item:item2,query:query}).then(function(shouldPrepareOutput){var beforePrepareFile=query("GET_BEFORE_PREPARE_FILE");if(beforePrepareFile)shouldPrepareOutput=beforePrepareFile(item2,shouldPrepareOutput);var loadComplete=function loadComplete(){dispatch("COMPLETE_LOAD_ITEM",{query:id,item:item2,data:{source:source,success:success}});listUpdated(dispatch,state2);};if(shouldPrepareOutput){dispatch("REQUEST_PREPARE_OUTPUT",{query:id,item:item2,success:function success(file2){dispatch("DID_PREPARE_OUTPUT",{id:id,file:file2});loadComplete();}},true);return;}loadComplete();});};applyFilterChain("DID_LOAD_ITEM",item2,{query:query,dispatch:dispatch}).then(function(){optionalPromise(query("GET_BEFORE_ADD_FILE"),createItemAPI(item2)).then(handleAdd);})["catch"](function(e2){if(!e2||!e2.error||!e2.status)return handleAdd(false);dispatch("DID_THROW_ITEM_INVALID",{id:id,error:e2.error,status:e2.status});});});item2.on("process-start",function(){dispatch("DID_START_ITEM_PROCESSING",{id:id});});item2.on("process-progress",function(progress){dispatch("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:id,progress:progress});});item2.on("process-error",function(error2){dispatch("DID_THROW_ITEM_PROCESSING_ERROR",{id:id,error:error2,status:{main:dynamicLabel(state2.options.labelFileProcessingError)(error2),sub:state2.options.labelTapToRetry}});});item2.on("process-revert-error",function(error2){dispatch("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:id,error:error2,status:{main:dynamicLabel(state2.options.labelFileProcessingRevertError)(error2),sub:state2.options.labelTapToRetry}});});item2.on("process-complete",function(serverFileReference){dispatch("DID_COMPLETE_ITEM_PROCESSING",{id:id,error:null,serverFileReference:serverFileReference});dispatch("DID_DEFINE_VALUE",{id:id,value:serverFileReference});});item2.on("process-abort",function(){dispatch("DID_ABORT_ITEM_PROCESSING",{id:id});});item2.on("process-revert",function(){dispatch("DID_REVERT_ITEM_PROCESSING",{id:id});dispatch("DID_DEFINE_VALUE",{id:id,value:null});});dispatch("DID_ADD_ITEM",{id:id,index:index2,interactionMethod:interactionMethod});listUpdated(dispatch,state2);var _ref53=state2.options.server||{},url=_ref53.url,load=_ref53.load,restore=_ref53.restore,fetch2=_ref53.fetch;item2.load(source,createFileLoader(origin===FileOrigin.INPUT?isString(source)&&isExternalURL(source)?fetch2?createFetchFunction(url,fetch2):fetchBlob:fetchBlob:origin===FileOrigin.LIMBO?createFetchFunction(url,restore):createFetchFunction(url,load)),function(file2,success2,error2){applyFilterChain("LOAD_FILE",file2,{query:query}).then(success2)["catch"](error2);});},REQUEST_PREPARE_OUTPUT:function REQUEST_PREPARE_OUTPUT(_ref54){var item2=_ref54.item,success=_ref54.success,_ref54$failure=_ref54.failure,failure=_ref54$failure===void 0?function(){}:_ref54$failure;var err={error:createResponse("error",0,"Item not found"),file:null};if(item2.archived)return failure(err);applyFilterChain("PREPARE_OUTPUT",item2.file,{query:query,item:item2}).then(function(result){applyFilterChain("COMPLETE_PREPARE_OUTPUT",result,{query:query,item:item2}).then(function(result2){if(item2.archived)return failure(err);success(result2);});});},COMPLETE_LOAD_ITEM:function COMPLETE_LOAD_ITEM(_ref55){var item2=_ref55.item,data3=_ref55.data;var success=data3.success,source=data3.source;var itemInsertLocation=query("GET_ITEM_INSERT_LOCATION");if(isFunction(itemInsertLocation)&&source){sortItems(state2,itemInsertLocation);}dispatch("DID_LOAD_ITEM",{id:item2.id,error:null,serverFileReference:item2.origin===FileOrigin.INPUT?null:source});success(createItemAPI(item2));if(item2.origin===FileOrigin.LOCAL){dispatch("DID_LOAD_LOCAL_ITEM",{id:item2.id});return;}if(item2.origin===FileOrigin.LIMBO){dispatch("DID_COMPLETE_ITEM_PROCESSING",{id:item2.id,error:null,serverFileReference:source});dispatch("DID_DEFINE_VALUE",{id:item2.id,value:item2.serverId||source});return;}if(query("IS_ASYNC")&&state2.options.instantUpload){dispatch("REQUEST_ITEM_PROCESSING",{query:item2.id});}},RETRY_ITEM_LOAD:getItemByQueryFromState(state2,function(item2){item2.retryLoad();}),REQUEST_ITEM_PREPARE:getItemByQueryFromState(state2,function(item2,_success,failure){dispatch("REQUEST_PREPARE_OUTPUT",{query:item2.id,item:item2,success:function success(file2){dispatch("DID_PREPARE_OUTPUT",{id:item2.id,file:file2});_success({file:item2,output:file2});},failure:failure},true);}),REQUEST_ITEM_PROCESSING:getItemByQueryFromState(state2,function(item2,success,failure){var itemCanBeQueuedForProcessing=item2.status===ItemStatus.IDLE||item2.status===ItemStatus.PROCESSING_ERROR;if(!itemCanBeQueuedForProcessing){var processNow=function processNow(){return dispatch("REQUEST_ITEM_PROCESSING",{query:item2,success:success,failure:failure});};var process=function process(){return document.hidden?processNow():setTimeout(processNow,32);};if(item2.status===ItemStatus.PROCESSING_COMPLETE||item2.status===ItemStatus.PROCESSING_REVERT_ERROR){item2.revert(createRevertFunction(state2.options.server.url,state2.options.server.revert),query("GET_FORCE_REVERT")).then(process)["catch"](function(){});}else if(item2.status===ItemStatus.PROCESSING){item2.abortProcessing().then(process);}return;}if(item2.status===ItemStatus.PROCESSING_QUEUED)return;item2.requestProcessing();dispatch("DID_REQUEST_ITEM_PROCESSING",{id:item2.id});dispatch("PROCESS_ITEM",{query:item2,success:success,failure:failure},true);}),PROCESS_ITEM:getItemByQueryFromState(state2,function(item2,success,failure){var maxParallelUploads=query("GET_MAX_PARALLEL_UPLOADS");var totalCurrentUploads=query("GET_ITEMS_BY_STATUS",ItemStatus.PROCESSING).length;if(totalCurrentUploads===maxParallelUploads){state2.processingQueue.push({id:item2.id,success:success,failure:failure});return;}if(item2.status===ItemStatus.PROCESSING)return;var processNext=function processNext(){var queueEntry=state2.processingQueue.shift();if(!queueEntry)return;var id=queueEntry.id,success2=queueEntry.success,failure2=queueEntry.failure;var itemReference=getItemByQuery(state2.items,id);if(!itemReference||itemReference.archived){processNext();return;}dispatch("PROCESS_ITEM",{query:id,success:success2,failure:failure2},true);};item2.onOnce("process-complete",function(){success(createItemAPI(item2));processNext();var server=state2.options.server;var instantUpload=state2.options.instantUpload;if(instantUpload&&item2.origin===FileOrigin.LOCAL&&isFunction(server.remove)){var noop=function noop(){};item2.origin=FileOrigin.LIMBO;state2.options.server.remove(item2.source,noop,noop);}var allItemsProcessed=query("GET_ITEMS_BY_STATUS",ItemStatus.PROCESSING_COMPLETE).length===state2.items.length;if(allItemsProcessed){dispatch("DID_COMPLETE_ITEM_PROCESSING_ALL");}});item2.onOnce("process-error",function(error2){failure({error:error2,file:createItemAPI(item2)});processNext();});var options2=state2.options;item2.process(createFileProcessor(createProcessorFunction(options2.server.url,options2.server.process,options2.name,{chunkTransferId:item2.transferId,chunkServer:options2.server.patch,chunkUploads:options2.chunkUploads,chunkForce:options2.chunkForce,chunkSize:options2.chunkSize,chunkRetryDelays:options2.chunkRetryDelays}),{allowMinimumUploadDuration:query("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),function(file2,success2,error2){applyFilterChain("PREPARE_OUTPUT",file2,{query:query,item:item2}).then(function(file3){dispatch("DID_PREPARE_OUTPUT",{id:item2.id,file:file3});success2(file3);})["catch"](error2);});}),RETRY_ITEM_PROCESSING:getItemByQueryFromState(state2,function(item2){dispatch("REQUEST_ITEM_PROCESSING",{query:item2});}),REQUEST_REMOVE_ITEM:getItemByQueryFromState(state2,function(item2){optionalPromise(query("GET_BEFORE_REMOVE_FILE"),createItemAPI(item2)).then(function(shouldRemove){if(!shouldRemove){return;}dispatch("REMOVE_ITEM",{query:item2});});}),RELEASE_ITEM:getItemByQueryFromState(state2,function(item2){item2.release();}),REMOVE_ITEM:getItemByQueryFromState(state2,function(item2,success,failure,options2){var removeFromView=function removeFromView(){var id=item2.id;getItemById(state2.items,id).archive();dispatch("DID_REMOVE_ITEM",{error:null,id:id,item:item2});listUpdated(dispatch,state2);success(createItemAPI(item2));};var server=state2.options.server;if(item2.origin===FileOrigin.LOCAL&&server&&isFunction(server.remove)&&options2.remove!==false){dispatch("DID_START_ITEM_REMOVE",{id:item2.id});server.remove(item2.source,function(){return removeFromView();},function(status){dispatch("DID_THROW_ITEM_REMOVE_ERROR",{id:item2.id,error:createResponse("error",0,status,null),status:{main:dynamicLabel(state2.options.labelFileRemoveError)(status),sub:state2.options.labelTapToRetry}});});}else{if(options2.revert&&item2.origin!==FileOrigin.LOCAL&&item2.serverId!==null||state2.options.chunkUploads&&item2.file.size>state2.options.chunkSize||state2.options.chunkUploads&&state2.options.chunkForce){item2.revert(createRevertFunction(state2.options.server.url,state2.options.server.revert),query("GET_FORCE_REVERT"));}removeFromView();}}),ABORT_ITEM_LOAD:getItemByQueryFromState(state2,function(item2){item2.abortLoad();}),ABORT_ITEM_PROCESSING:getItemByQueryFromState(state2,function(item2){if(item2.serverId){dispatch("REVERT_ITEM_PROCESSING",{id:item2.id});return;}item2.abortProcessing().then(function(){var shouldRemove=state2.options.instantUpload;if(shouldRemove){dispatch("REMOVE_ITEM",{query:item2.id});}});}),REQUEST_REVERT_ITEM_PROCESSING:getItemByQueryFromState(state2,function(item2){if(!state2.options.instantUpload){dispatch("REVERT_ITEM_PROCESSING",{query:item2});return;}var handleRevert2=function handleRevert2(shouldRevert){if(!shouldRevert)return;dispatch("REVERT_ITEM_PROCESSING",{query:item2});};var fn2=query("GET_BEFORE_REMOVE_FILE");if(!fn2){return handleRevert2(true);}var requestRemoveResult=fn2(createItemAPI(item2));if(requestRemoveResult==null){return handleRevert2(true);}if(typeof requestRemoveResult==="boolean"){return handleRevert2(requestRemoveResult);}if(typeof requestRemoveResult.then==="function"){requestRemoveResult.then(handleRevert2);}}),REVERT_ITEM_PROCESSING:getItemByQueryFromState(state2,function(item2){item2.revert(createRevertFunction(state2.options.server.url,state2.options.server.revert),query("GET_FORCE_REVERT")).then(function(){var shouldRemove=state2.options.instantUpload||isMockItem(item2);if(shouldRemove){dispatch("REMOVE_ITEM",{query:item2.id});}})["catch"](function(){});}),SET_OPTIONS:function SET_OPTIONS(_ref56){var options2=_ref56.options;var optionKeys=Object.keys(options2);var prioritizedOptionKeys=PrioritizedOptions.filter(function(key){return optionKeys.includes(key);});var orderedOptionKeys=[].concat(_toConsumableArray2(prioritizedOptionKeys),_toConsumableArray2(Object.keys(options2).filter(function(key){return!prioritizedOptionKeys.includes(key);})));orderedOptionKeys.forEach(function(key){dispatch("SET_".concat(fromCamels(key,"_").toUpperCase()),{value:options2[key]});});}};};var PrioritizedOptions=["server"];var formatFilename=function formatFilename(name2){return name2;};var createElement$1=function createElement$1(tagName){return document.createElement(tagName);};var text=function text(node,value){var textNode=node.childNodes[0];if(!textNode){textNode=document.createTextNode(value);node.appendChild(textNode);}else if(value!==textNode.nodeValue){textNode.nodeValue=value;}};var polarToCartesian=function polarToCartesian(centerX,centerY,radius,angleInDegrees){var angleInRadians=(angleInDegrees%360-90)*Math.PI/180;return{x:centerX+radius*Math.cos(angleInRadians),y:centerY+radius*Math.sin(angleInRadians)};};var describeArc=function describeArc(x,y,radius,startAngle,endAngle,arcSweep){var start=polarToCartesian(x,y,radius,endAngle);var end=polarToCartesian(x,y,radius,startAngle);return["M",start.x,start.y,"A",radius,radius,0,arcSweep,0,end.x,end.y].join(" ");};var percentageArc=function percentageArc(x,y,radius,from,to){var arcSweep=1;if(to>from&&to-from<=0.5){arcSweep=0;}if(from>to&&from-to>=0.5){arcSweep=0;}return describeArc(x,y,radius,Math.min(0.9999,from)*360,Math.min(0.9999,to)*360,arcSweep);};var create=function create(_ref57){var root2=_ref57.root,props=_ref57.props;props.spin=false;props.progress=0;props.opacity=0;var svg4=createElement("svg");root2.ref.path=createElement("path",{"stroke-width":2,"stroke-linecap":"round"});svg4.appendChild(root2.ref.path);root2.ref.svg=svg4;root2.appendChild(svg4);};var write=function write(_ref58){var root2=_ref58.root,props=_ref58.props;if(props.opacity===0){return;}if(props.align){root2.element.dataset.align=props.align;}var ringStrokeWidth=parseInt(attr(root2.ref.path,"stroke-width"),10);var size2=root2.rect.element.width*0.5;var ringFrom=0;var ringTo=0;if(props.spin){ringFrom=0;ringTo=0.5;}else{ringFrom=0;ringTo=props.progress;}var coordinates=percentageArc(size2,size2,size2-ringStrokeWidth,ringFrom,ringTo);attr(root2.ref.path,"d",coordinates);attr(root2.ref.path,"stroke-opacity",props.spin||props.progress>0?1:0);};var progressIndicator=createView({tag:"div",name:"progress-indicator",ignoreRectUpdate:true,ignoreRect:true,create:create,write:write,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:0.95,damping:0.65,mass:10}}}});var create$1=function create$1(_ref59){var root2=_ref59.root,props=_ref59.props;root2.element.innerHTML=(props.icon||"")+"<span>".concat(props.label,"</span>");props.isDisabled=false;};var write$1=function write$1(_ref60){var root2=_ref60.root,props=_ref60.props;var isDisabled=props.isDisabled;var shouldDisable=root2.query("GET_DISABLED")||props.opacity===0;if(shouldDisable&&!isDisabled){props.isDisabled=true;attr(root2.element,"disabled","disabled");}else if(!shouldDisable&&isDisabled){props.isDisabled=false;root2.element.removeAttribute("disabled");}};var fileActionButton=createView({tag:"button",attributes:{type:"button"},ignoreRect:true,ignoreRectUpdate:true,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:true},create:create$1,write:write$1});var toNaturalFileSize=function toNaturalFileSize(bytes){var decimalSeparator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:".";var base=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1e3;var options2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var _options2$labelBytes=options2.labelBytes,labelBytes=_options2$labelBytes===void 0?"bytes":_options2$labelBytes,_options2$labelKiloby=options2.labelKilobytes,labelKilobytes=_options2$labelKiloby===void 0?"KB":_options2$labelKiloby,_options2$labelMegaby=options2.labelMegabytes,labelMegabytes=_options2$labelMegaby===void 0?"MB":_options2$labelMegaby,_options2$labelGigaby=options2.labelGigabytes,labelGigabytes=_options2$labelGigaby===void 0?"GB":_options2$labelGigaby;bytes=Math.round(Math.abs(bytes));var KB=base;var MB=base*base;var GB=base*base*base;if(bytes<KB){return"".concat(bytes," ").concat(labelBytes);}if(bytes<MB){return"".concat(Math.floor(bytes/KB)," ").concat(labelKilobytes);}if(bytes<GB){return"".concat(removeDecimalsWhenZero(bytes/MB,1,decimalSeparator)," ").concat(labelMegabytes);}return"".concat(removeDecimalsWhenZero(bytes/GB,2,decimalSeparator)," ").concat(labelGigabytes);};var removeDecimalsWhenZero=function removeDecimalsWhenZero(value,decimalCount,separator){return value.toFixed(decimalCount).split(".").filter(function(part){return part!=="0";}).join(separator);};var create$2=function create$2(_ref61){var root2=_ref61.root,props=_ref61.props;var fileName=createElement$1("span");fileName.className="filepond--file-info-main";attr(fileName,"aria-hidden","true");root2.appendChild(fileName);root2.ref.fileName=fileName;var fileSize=createElement$1("span");fileSize.className="filepond--file-info-sub";root2.appendChild(fileSize);root2.ref.fileSize=fileSize;text(fileSize,root2.query("GET_LABEL_FILE_WAITING_FOR_SIZE"));text(fileName,formatFilename(root2.query("GET_ITEM_NAME",props.id)));};var updateFile=function updateFile(_ref62){var root2=_ref62.root,props=_ref62.props;text(root2.ref.fileSize,toNaturalFileSize(root2.query("GET_ITEM_SIZE",props.id),".",root2.query("GET_FILE_SIZE_BASE"),root2.query("GET_FILE_SIZE_LABELS",root2.query)));text(root2.ref.fileName,formatFilename(root2.query("GET_ITEM_NAME",props.id)));};var updateFileSizeOnError=function updateFileSizeOnError(_ref63){var root2=_ref63.root,props=_ref63.props;if(isInt(root2.query("GET_ITEM_SIZE",props.id))){updateFile({root:root2,props:props});return;}text(root2.ref.fileSize,root2.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"));};var fileInfo=createView({name:"file-info",ignoreRect:true,ignoreRectUpdate:true,write:createRoute({DID_LOAD_ITEM:updateFile,DID_UPDATE_ITEM_META:updateFile,DID_THROW_ITEM_LOAD_ERROR:updateFileSizeOnError,DID_THROW_ITEM_INVALID:updateFileSizeOnError}),didCreateView:function didCreateView(root2){applyFilters("CREATE_VIEW",_objectSpread(_objectSpread({},root2),{},{view:root2}));},create:create$2,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}});var toPercentage=function toPercentage(value){return Math.round(value*100);};var create$3=function create$3(_ref64){var root2=_ref64.root;var main=createElement$1("span");main.className="filepond--file-status-main";root2.appendChild(main);root2.ref.main=main;var sub=createElement$1("span");sub.className="filepond--file-status-sub";root2.appendChild(sub);root2.ref.sub=sub;didSetItemLoadProgress({root:root2,action:{progress:null}});};var didSetItemLoadProgress=function didSetItemLoadProgress(_ref65){var root2=_ref65.root,action=_ref65.action;var title=action.progress===null?root2.query("GET_LABEL_FILE_LOADING"):"".concat(root2.query("GET_LABEL_FILE_LOADING")," ").concat(toPercentage(action.progress),"%");text(root2.ref.main,title);text(root2.ref.sub,root2.query("GET_LABEL_TAP_TO_CANCEL"));};var didSetItemProcessProgress=function didSetItemProcessProgress(_ref66){var root2=_ref66.root,action=_ref66.action;var title=action.progress===null?root2.query("GET_LABEL_FILE_PROCESSING"):"".concat(root2.query("GET_LABEL_FILE_PROCESSING")," ").concat(toPercentage(action.progress),"%");text(root2.ref.main,title);text(root2.ref.sub,root2.query("GET_LABEL_TAP_TO_CANCEL"));};var didRequestItemProcessing=function didRequestItemProcessing(_ref67){var root2=_ref67.root;text(root2.ref.main,root2.query("GET_LABEL_FILE_PROCESSING"));text(root2.ref.sub,root2.query("GET_LABEL_TAP_TO_CANCEL"));};var didAbortItemProcessing=function didAbortItemProcessing(_ref68){var root2=_ref68.root;text(root2.ref.main,root2.query("GET_LABEL_FILE_PROCESSING_ABORTED"));text(root2.ref.sub,root2.query("GET_LABEL_TAP_TO_RETRY"));};var didCompleteItemProcessing=function didCompleteItemProcessing(_ref69){var root2=_ref69.root;text(root2.ref.main,root2.query("GET_LABEL_FILE_PROCESSING_COMPLETE"));text(root2.ref.sub,root2.query("GET_LABEL_TAP_TO_UNDO"));};var clear=function clear(_ref70){var root2=_ref70.root;text(root2.ref.main,"");text(root2.ref.sub,"");};var error=function error(_ref71){var root2=_ref71.root,action=_ref71.action;text(root2.ref.main,action.status.main);text(root2.ref.sub,action.status.sub);};var fileStatus=createView({name:"file-status",ignoreRect:true,ignoreRectUpdate:true,write:createRoute({DID_LOAD_ITEM:clear,DID_REVERT_ITEM_PROCESSING:clear,DID_REQUEST_ITEM_PROCESSING:didRequestItemProcessing,DID_ABORT_ITEM_PROCESSING:didAbortItemProcessing,DID_COMPLETE_ITEM_PROCESSING:didCompleteItemProcessing,DID_UPDATE_ITEM_PROCESS_PROGRESS:didSetItemProcessProgress,DID_UPDATE_ITEM_LOAD_PROGRESS:didSetItemLoadProgress,DID_THROW_ITEM_LOAD_ERROR:error,DID_THROW_ITEM_INVALID:error,DID_THROW_ITEM_PROCESSING_ERROR:error,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:error,DID_THROW_ITEM_REMOVE_ERROR:error}),didCreateView:function didCreateView(root2){applyFilters("CREATE_VIEW",_objectSpread(_objectSpread({},root2),{},{view:root2}));},create:create$3,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}});var Buttons={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}};var ButtonKeys=[];forin(Buttons,function(key){ButtonKeys.push(key);});var calculateFileInfoOffset=function calculateFileInfoOffset(root2){if(getRemoveIndicatorAligment(root2)==="right")return 0;var buttonRect=root2.ref.buttonRemoveItem.rect.element;return buttonRect.hidden?null:buttonRect.width+buttonRect.left;};var calculateButtonWidth=function calculateButtonWidth(root2){var buttonRect=root2.ref.buttonAbortItemLoad.rect.element;return buttonRect.width;};var calculateFileVerticalCenterOffset=function calculateFileVerticalCenterOffset(root2){return Math.floor(root2.ref.buttonRemoveItem.rect.element.height/4);};var calculateFileHorizontalCenterOffset=function calculateFileHorizontalCenterOffset(root2){return Math.floor(root2.ref.buttonRemoveItem.rect.element.left/2);};var getLoadIndicatorAlignment=function getLoadIndicatorAlignment(root2){return root2.query("GET_STYLE_LOAD_INDICATOR_POSITION");};var getProcessIndicatorAlignment=function getProcessIndicatorAlignment(root2){return root2.query("GET_STYLE_PROGRESS_INDICATOR_POSITION");};var getRemoveIndicatorAligment=function getRemoveIndicatorAligment(root2){return root2.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION");};var DefaultStyle={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:getLoadIndicatorAlignment},processProgressIndicator:{opacity:0,align:getProcessIndicatorAlignment},processingCompleteIndicator:{opacity:0,scaleX:0.75,scaleY:0.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}};var IdleStyle={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}};var ProcessingStyle={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}};var StyleMap={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:getRemoveIndicatorAligment},info:{translateX:calculateFileInfoOffset},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:getRemoveIndicatorAligment},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1,translateX:calculateFileInfoOffset}},DID_LOAD_ITEM:IdleStyle,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}},DID_START_ITEM_PROCESSING:ProcessingStyle,DID_REQUEST_ITEM_PROCESSING:ProcessingStyle,DID_UPDATE_ITEM_PROCESS_PROGRESS:ProcessingStyle,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:calculateFileInfoOffset}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:IdleStyle};var processingCompleteIndicatorView=createView({create:function create(_ref72){var root2=_ref72.root;root2.element.innerHTML=root2.query("GET_ICON_DONE");},name:"processing-complete-indicator",ignoreRect:true,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}});var create$4=function create$4(_ref73){var root2=_ref73.root,props=_ref73.props;var LocalButtons=Object.keys(Buttons).reduce(function(prev,curr){prev[curr]=_objectSpread({},Buttons[curr]);return prev;},{});var id=props.id;var allowRevert=root2.query("GET_ALLOW_REVERT");var allowRemove=root2.query("GET_ALLOW_REMOVE");var allowProcess=root2.query("GET_ALLOW_PROCESS");var instantUpload=root2.query("GET_INSTANT_UPLOAD");var isAsync2=root2.query("IS_ASYNC");var alignRemoveItemButton=root2.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");var buttonFilter;if(isAsync2){if(allowProcess&&!allowRevert){buttonFilter=function buttonFilter(key){return!/RevertItemProcessing/.test(key);};}else if(!allowProcess&&allowRevert){buttonFilter=function buttonFilter(key){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);};}else if(!allowProcess&&!allowRevert){buttonFilter=function buttonFilter(key){return!/Process/.test(key);};}}else{buttonFilter=function buttonFilter(key){return!/Process/.test(key);};}var enabledButtons=buttonFilter?ButtonKeys.filter(buttonFilter):ButtonKeys.concat();if(instantUpload&&allowRevert){LocalButtons["RevertItemProcessing"].label="GET_LABEL_BUTTON_REMOVE_ITEM";LocalButtons["RevertItemProcessing"].icon="GET_ICON_REMOVE";}if(isAsync2&&!allowRevert){var map2=StyleMap["DID_COMPLETE_ITEM_PROCESSING"];map2.info.translateX=calculateFileHorizontalCenterOffset;map2.info.translateY=calculateFileVerticalCenterOffset;map2.status.translateY=calculateFileVerticalCenterOffset;map2.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1};}if(isAsync2&&!allowProcess){["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(function(key){StyleMap[key].status.translateY=calculateFileVerticalCenterOffset;});StyleMap["DID_THROW_ITEM_PROCESSING_ERROR"].status.translateX=calculateButtonWidth;}if(alignRemoveItemButton&&allowRevert){LocalButtons["RevertItemProcessing"].align="BUTTON_REMOVE_ITEM_POSITION";var _map=StyleMap["DID_COMPLETE_ITEM_PROCESSING"];_map.info.translateX=calculateFileInfoOffset;_map.status.translateY=calculateFileVerticalCenterOffset;_map.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1};}if(!allowRemove){LocalButtons["RemoveItem"].disabled=true;}forin(LocalButtons,function(key,definition){var buttonView=root2.createChildView(fileActionButton,{label:root2.query(definition.label),icon:root2.query(definition.icon),opacity:0});if(enabledButtons.includes(key)){root2.appendChildView(buttonView);}if(definition.disabled){buttonView.element.setAttribute("disabled","disabled");buttonView.element.setAttribute("hidden","hidden");}buttonView.element.dataset.align=root2.query("GET_STYLE_".concat(definition.align));buttonView.element.classList.add(definition.className);buttonView.on("click",function(e2){e2.stopPropagation();if(definition.disabled)return;root2.dispatch(definition.action,{query:id});});root2.ref["button".concat(key)]=buttonView;});root2.ref.processingCompleteIndicator=root2.appendChildView(root2.createChildView(processingCompleteIndicatorView));root2.ref.processingCompleteIndicator.element.dataset.align=root2.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION");root2.ref.info=root2.appendChildView(root2.createChildView(fileInfo,{id:id}));root2.ref.status=root2.appendChildView(root2.createChildView(fileStatus,{id:id}));var loadIndicatorView=root2.appendChildView(root2.createChildView(progressIndicator,{opacity:0,align:root2.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));loadIndicatorView.element.classList.add("filepond--load-indicator");root2.ref.loadProgressIndicator=loadIndicatorView;var progressIndicatorView=root2.appendChildView(root2.createChildView(progressIndicator,{opacity:0,align:root2.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));progressIndicatorView.element.classList.add("filepond--process-indicator");root2.ref.processProgressIndicator=progressIndicatorView;root2.ref.activeStyles=[];};var write$2=function write$2(_ref74){var root2=_ref74.root,actions2=_ref74.actions,props=_ref74.props;route({root:root2,actions:actions2,props:props});var action=actions2.concat().filter(function(action2){return /^DID_/.test(action2.type);}).reverse().find(function(action2){return StyleMap[action2.type];});if(action){root2.ref.activeStyles=[];var stylesToApply=StyleMap[action.type];forin(DefaultStyle,function(name2,defaultStyles){var control=root2.ref[name2];forin(defaultStyles,function(key,defaultValue){var value=stylesToApply[name2]&&typeof stylesToApply[name2][key]!=="undefined"?stylesToApply[name2][key]:defaultValue;root2.ref.activeStyles.push({control:control,key:key,value:value});});});}root2.ref.activeStyles.forEach(function(_ref75){var control=_ref75.control,key=_ref75.key,value=_ref75.value;control[key]=typeof value==="function"?value(root2):value;});};var route=createRoute({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref76){var root2=_ref76.root,action=_ref76.action;root2.ref.buttonAbortItemProcessing.label=action.value;},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref77){var root2=_ref77.root,action=_ref77.action;root2.ref.buttonAbortItemLoad.label=action.value;},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref78){var root2=_ref78.root,action=_ref78.action;root2.ref.buttonAbortItemRemoval.label=action.value;},DID_REQUEST_ITEM_PROCESSING:function DID_REQUEST_ITEM_PROCESSING(_ref79){var root2=_ref79.root;root2.ref.processProgressIndicator.spin=true;root2.ref.processProgressIndicator.progress=0;},DID_START_ITEM_LOAD:function DID_START_ITEM_LOAD(_ref80){var root2=_ref80.root;root2.ref.loadProgressIndicator.spin=true;root2.ref.loadProgressIndicator.progress=0;},DID_START_ITEM_REMOVE:function DID_START_ITEM_REMOVE(_ref81){var root2=_ref81.root;root2.ref.processProgressIndicator.spin=true;root2.ref.processProgressIndicator.progress=0;},DID_UPDATE_ITEM_LOAD_PROGRESS:function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref82){var root2=_ref82.root,action=_ref82.action;root2.ref.loadProgressIndicator.spin=false;root2.ref.loadProgressIndicator.progress=action.progress;},DID_UPDATE_ITEM_PROCESS_PROGRESS:function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref83){var root2=_ref83.root,action=_ref83.action;root2.ref.processProgressIndicator.spin=false;root2.ref.processProgressIndicator.progress=action.progress;}});var file=createView({create:create$4,write:write$2,didCreateView:function didCreateView(root2){applyFilters("CREATE_VIEW",_objectSpread(_objectSpread({},root2),{},{view:root2}));},name:"file"});var create$5=function create$5(_ref84){var root2=_ref84.root,props=_ref84.props;root2.ref.fileName=createElement$1("legend");root2.appendChild(root2.ref.fileName);root2.ref.file=root2.appendChildView(root2.createChildView(file,{id:props.id}));root2.ref.data=false;};var didLoadItem=function didLoadItem(_ref85){var root2=_ref85.root,props=_ref85.props;text(root2.ref.fileName,formatFilename(root2.query("GET_ITEM_NAME",props.id)));};var fileWrapper=createView({create:create$5,ignoreRect:true,write:createRoute({DID_LOAD_ITEM:didLoadItem}),didCreateView:function didCreateView(root2){applyFilters("CREATE_VIEW",_objectSpread(_objectSpread({},root2),{},{view:root2}));},tag:"fieldset",name:"file-wrapper"});var PANEL_SPRING_PROPS={type:"spring",damping:0.6,mass:7};var create$6=function create$6(_ref86){var root2=_ref86.root,props=_ref86.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:PANEL_SPRING_PROPS},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:PANEL_SPRING_PROPS},styles:["translateY"]}}].forEach(function(section){createSection(root2,section,props.name);});root2.element.classList.add("filepond--".concat(props.name));root2.ref.scalable=null;};var createSection=function createSection(root2,section,className){var viewConstructor=createView({name:"panel-".concat(section.name," filepond--").concat(className),mixins:section.mixins,ignoreRectUpdate:true});var view=root2.createChildView(viewConstructor,section.props);root2.ref[section.name]=root2.appendChildView(view);};var write$3=function write$3(_ref87){var root2=_ref87.root,props=_ref87.props;if(root2.ref.scalable===null||props.scalable!==root2.ref.scalable){root2.ref.scalable=isBoolean(props.scalable)?props.scalable:true;root2.element.dataset.scalable=root2.ref.scalable;}if(!props.height)return;var topRect=root2.ref.top.rect.element;var bottomRect=root2.ref.bottom.rect.element;var height=Math.max(topRect.height+bottomRect.height,props.height);root2.ref.center.translateY=topRect.height;root2.ref.center.scaleY=(height-topRect.height-bottomRect.height)/100;root2.ref.bottom.translateY=height-bottomRect.height;};var panel=createView({name:"panel",read:function read(_ref88){var root2=_ref88.root,props=_ref88.props;return props.heightCurrent=root2.ref.bottom.translateY;},write:write$3,create:create$6,ignoreRect:true,mixins:{apis:["height","heightCurrent","scalable"]}});var createDragHelper=function createDragHelper(items){var itemIds=items.map(function(item2){return item2.id;});var prevIndex=void 0;return{setIndex:function setIndex(index2){prevIndex=index2;},getIndex:function getIndex(){return prevIndex;},getItemIndex:function getItemIndex(item2){return itemIds.indexOf(item2.id);}};};var ITEM_TRANSLATE_SPRING={type:"spring",stiffness:0.75,damping:0.45,mass:10};var ITEM_SCALE_SPRING="spring";var StateMap={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"};var create$7=function create$7(_ref89){var root2=_ref89.root,props=_ref89.props;root2.ref.handleClick=function(e2){return root2.dispatch("DID_ACTIVATE_ITEM",{id:props.id});};root2.element.id="filepond--item-".concat(props.id);root2.element.addEventListener("click",root2.ref.handleClick);root2.ref.container=root2.appendChildView(root2.createChildView(fileWrapper,{id:props.id}));root2.ref.panel=root2.appendChildView(root2.createChildView(panel,{name:"item-panel"}));root2.ref.panel.height=null;props.markedForRemoval=false;if(!root2.query("GET_ALLOW_REORDER"))return;root2.element.dataset.dragState="idle";var grab=function grab(e2){if(!e2.isPrimary)return;var removedActivateListener=false;var origin={x:e2.pageX,y:e2.pageY};props.dragOrigin={x:root2.translateX,y:root2.translateY};props.dragCenter={x:e2.offsetX,y:e2.offsetY};var dragState=createDragHelper(root2.query("GET_ACTIVE_ITEMS"));root2.dispatch("DID_GRAB_ITEM",{id:props.id,dragState:dragState});var drag=function drag(e3){if(!e3.isPrimary)return;e3.stopPropagation();e3.preventDefault();props.dragOffset={x:e3.pageX-origin.x,y:e3.pageY-origin.y};var dist=props.dragOffset.x*props.dragOffset.x+props.dragOffset.y*props.dragOffset.y;if(dist>16&&!removedActivateListener){removedActivateListener=true;root2.element.removeEventListener("click",root2.ref.handleClick);}root2.dispatch("DID_DRAG_ITEM",{id:props.id,dragState:dragState});};var drop4=function drop4(e3){if(!e3.isPrimary)return;document.removeEventListener("pointermove",drag);document.removeEventListener("pointerup",drop4);props.dragOffset={x:e3.pageX-origin.x,y:e3.pageY-origin.y};root2.dispatch("DID_DROP_ITEM",{id:props.id,dragState:dragState});if(removedActivateListener){setTimeout(function(){return root2.element.addEventListener("click",root2.ref.handleClick);},0);}};document.addEventListener("pointermove",drag);document.addEventListener("pointerup",drop4);};root2.element.addEventListener("pointerdown",grab);};var route$1=createRoute({DID_UPDATE_PANEL_HEIGHT:function DID_UPDATE_PANEL_HEIGHT(_ref90){var root2=_ref90.root,action=_ref90.action;root2.height=action.height;}});var write$4=createRoute({DID_GRAB_ITEM:function DID_GRAB_ITEM(_ref91){var root2=_ref91.root,props=_ref91.props;props.dragOrigin={x:root2.translateX,y:root2.translateY};},DID_DRAG_ITEM:function DID_DRAG_ITEM(_ref92){var root2=_ref92.root;root2.element.dataset.dragState="drag";},DID_DROP_ITEM:function DID_DROP_ITEM(_ref93){var root2=_ref93.root,props=_ref93.props;props.dragOffset=null;props.dragOrigin=null;root2.element.dataset.dragState="drop";}},function(_ref94){var root2=_ref94.root,actions2=_ref94.actions,props=_ref94.props,shouldOptimize=_ref94.shouldOptimize;if(root2.element.dataset.dragState==="drop"){if(root2.scaleX<=1){root2.element.dataset.dragState="idle";}}var action=actions2.concat().filter(function(action2){return /^DID_/.test(action2.type);}).reverse().find(function(action2){return StateMap[action2.type];});if(action&&action.type!==props.currentState){props.currentState=action.type;root2.element.dataset.filepondItemState=StateMap[props.currentState]||"";}var aspectRatio=root2.query("GET_ITEM_PANEL_ASPECT_RATIO")||root2.query("GET_PANEL_ASPECT_RATIO");if(!aspectRatio){route$1({root:root2,actions:actions2,props:props});if(!root2.height&&root2.ref.container.rect.element.height>0){root2.height=root2.ref.container.rect.element.height;}}else if(!shouldOptimize){root2.height=root2.rect.element.width*aspectRatio;}if(shouldOptimize){root2.ref.panel.height=null;}root2.ref.panel.height=root2.height;});var item=createView({create:create$7,write:write$4,destroy:function destroy(_ref95){var root2=_ref95.root,props=_ref95.props;root2.element.removeEventListener("click",root2.ref.handleClick);root2.dispatch("RELEASE_ITEM",{query:props.id});},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:ITEM_SCALE_SPRING,scaleY:ITEM_SCALE_SPRING,translateX:ITEM_TRANSLATE_SPRING,translateY:ITEM_TRANSLATE_SPRING,opacity:{type:"tween",duration:150}}}});var getItemsPerRow=function getItemsPerRow(horizontalSpace,itemWidth){return Math.max(1,Math.floor((horizontalSpace+1)/itemWidth));};var getItemIndexByPosition=function getItemIndexByPosition(view,children,positionInView){if(!positionInView)return;var horizontalSpace=view.rect.element.width;var l=children.length;var last=null;if(l===0||positionInView.top<children[0].rect.element.top)return-1;var item2=children[0];var itemRect=item2.rect.element;var itemHorizontalMargin=itemRect.marginLeft+itemRect.marginRight;var itemWidth=itemRect.width+itemHorizontalMargin;var itemsPerRow=getItemsPerRow(horizontalSpace,itemWidth);if(itemsPerRow===1){for(var index2=0;index2<l;index2++){var child=children[index2];var childMid=child.rect.outer.top+child.rect.element.height*0.5;if(positionInView.top<childMid){return index2;}}return l;}var itemVerticalMargin=itemRect.marginTop+itemRect.marginBottom;var itemHeight=itemRect.height+itemVerticalMargin;for(var _index=0;_index<l;_index++){var indexX=_index%itemsPerRow;var indexY=Math.floor(_index/itemsPerRow);var offsetX=indexX*itemWidth;var offsetY=indexY*itemHeight;var itemTop=offsetY-itemRect.marginTop;var itemRight=offsetX+itemWidth;var itemBottom=offsetY+itemHeight+itemRect.marginBottom;if(positionInView.top<itemBottom&&positionInView.top>itemTop){if(positionInView.left<itemRight){return _index;}else if(_index!==l-1){last=_index;}else{last=null;}}}if(last!==null){return last;}return l;};var dropAreaDimensions={height:0,width:0,get getHeight(){return this.height;},set setHeight(val){if(this.height===0||val===0)this.height=val;},get getWidth(){return this.width;},set setWidth(val){if(this.width===0||val===0)this.width=val;},setDimensions:function setDimensions(height,width){if(this.height===0||height===0)this.height=height;if(this.width===0||width===0)this.width=width;}};var create$8=function create$8(_ref96){var root2=_ref96.root;attr(root2.element,"role","list");root2.ref.lastItemSpanwDate=Date.now();};var addItemView=function addItemView(_ref97){var root2=_ref97.root,action=_ref97.action;var id=action.id,index2=action.index,interactionMethod=action.interactionMethod;root2.ref.addIndex=index2;var now=Date.now();var spawnDate=now;var opacity=1;if(interactionMethod!==InteractionMethod.NONE){opacity=0;var cooldown=root2.query("GET_ITEM_INSERT_INTERVAL");var dist=now-root2.ref.lastItemSpanwDate;spawnDate=dist<cooldown?now+(cooldown-dist):now;}root2.ref.lastItemSpanwDate=spawnDate;root2.appendChildView(root2.createChildView(item,{spawnDate:spawnDate,id:id,opacity:opacity,interactionMethod:interactionMethod}),index2);};var moveItem=function moveItem(item2,x,y){var vx=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var vy=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;if(item2.dragOffset){item2.translateX=null;item2.translateY=null;item2.translateX=item2.dragOrigin.x+item2.dragOffset.x;item2.translateY=item2.dragOrigin.y+item2.dragOffset.y;item2.scaleX=1.025;item2.scaleY=1.025;}else{item2.translateX=x;item2.translateY=y;if(Date.now()>item2.spawnDate){if(item2.opacity===0){introItemView(item2,x,y,vx,vy);}item2.scaleX=1;item2.scaleY=1;item2.opacity=1;}}};var introItemView=function introItemView(item2,x,y,vx,vy){if(item2.interactionMethod===InteractionMethod.NONE){item2.translateX=null;item2.translateX=x;item2.translateY=null;item2.translateY=y;}else if(item2.interactionMethod===InteractionMethod.DROP){item2.translateX=null;item2.translateX=x-vx*20;item2.translateY=null;item2.translateY=y-vy*10;item2.scaleX=0.8;item2.scaleY=0.8;}else if(item2.interactionMethod===InteractionMethod.BROWSE){item2.translateY=null;item2.translateY=y-30;}else if(item2.interactionMethod===InteractionMethod.API){item2.translateX=null;item2.translateX=x-30;item2.translateY=null;}};var removeItemView=function removeItemView(_ref98){var root2=_ref98.root,action=_ref98.action;var id=action.id;var view=root2.childViews.find(function(child){return child.id===id;});if(!view){return;}view.scaleX=0.9;view.scaleY=0.9;view.opacity=0;view.markedForRemoval=true;};var getItemHeight=function getItemHeight(child){return child.rect.element.height+child.rect.element.marginBottom*0.5+child.rect.element.marginTop*0.5;};var getItemWidth=function getItemWidth(child){return child.rect.element.width+child.rect.element.marginLeft*0.5+child.rect.element.marginRight*0.5;};var dragItem=function dragItem(_ref99){var root2=_ref99.root,action=_ref99.action;var id=action.id,dragState=action.dragState;var item2=root2.query("GET_ITEM",{id:id});var view=root2.childViews.find(function(child){return child.id===id;});var numItems=root2.childViews.length;var oldIndex2=dragState.getItemIndex(item2);if(!view)return;var dragPosition={x:view.dragOrigin.x+view.dragOffset.x+view.dragCenter.x,y:view.dragOrigin.y+view.dragOffset.y+view.dragCenter.y};var dragHeight=getItemHeight(view);var dragWidth=getItemWidth(view);var cols=Math.floor(root2.rect.outer.width/dragWidth);if(cols>numItems)cols=numItems;var rows=Math.floor(numItems/cols+1);dropAreaDimensions.setHeight=dragHeight*rows;dropAreaDimensions.setWidth=dragWidth*cols;var location2={y:Math.floor(dragPosition.y/dragHeight),x:Math.floor(dragPosition.x/dragWidth),getGridIndex:function getGridIndex(){if(dragPosition.y>dropAreaDimensions.getHeight||dragPosition.y<0||dragPosition.x>dropAreaDimensions.getWidth||dragPosition.x<0)return oldIndex2;return this.y*cols+this.x;},getColIndex:function getColIndex(){var items=root2.query("GET_ACTIVE_ITEMS");var visibleChildren=root2.childViews.filter(function(child){return child.rect.element.height;});var children=items.map(function(item3){return visibleChildren.find(function(childView){return childView.id===item3.id;});});var currentIndex2=children.findIndex(function(child){return child===view;});var dragHeight2=getItemHeight(view);var l=children.length;var idx=l;var childHeight=0;var childBottom=0;var childTop=0;for(var i=0;i<l;i++){childHeight=getItemHeight(children[i]);childTop=childBottom;childBottom=childTop+childHeight;if(dragPosition.y<childBottom){if(currentIndex2>i){if(dragPosition.y<childTop+dragHeight2){idx=i;break;}continue;}idx=i;break;}}return idx;}};var index2=cols>1?location2.getGridIndex():location2.getColIndex();root2.dispatch("MOVE_ITEM",{query:view,index:index2});var currentIndex=dragState.getIndex();if(currentIndex===void 0||currentIndex!==index2){dragState.setIndex(index2);if(currentIndex===void 0)return;root2.dispatch("DID_REORDER_ITEMS",{items:root2.query("GET_ACTIVE_ITEMS"),origin:oldIndex2,target:index2});}};var route$2=createRoute({DID_ADD_ITEM:addItemView,DID_REMOVE_ITEM:removeItemView,DID_DRAG_ITEM:dragItem});var write$5=function write$5(_ref100){var root2=_ref100.root,props=_ref100.props,actions2=_ref100.actions,shouldOptimize=_ref100.shouldOptimize;route$2({root:root2,props:props,actions:actions2});var dragCoordinates=props.dragCoordinates;var horizontalSpace=root2.rect.element.width;var visibleChildren=root2.childViews.filter(function(child){return child.rect.element.height;});var children=root2.query("GET_ACTIVE_ITEMS").map(function(item2){return visibleChildren.find(function(child){return child.id===item2.id;});}).filter(function(item2){return item2;});var dragIndex=dragCoordinates?getItemIndexByPosition(root2,children,dragCoordinates):null;var addIndex=root2.ref.addIndex||null;root2.ref.addIndex=null;var dragIndexOffset=0;var removeIndexOffset=0;var addIndexOffset=0;if(children.length===0)return;var childRect=children[0].rect.element;var itemVerticalMargin=childRect.marginTop+childRect.marginBottom;var itemHorizontalMargin=childRect.marginLeft+childRect.marginRight;var itemWidth=childRect.width+itemHorizontalMargin;var itemHeight=childRect.height+itemVerticalMargin;var itemsPerRow=getItemsPerRow(horizontalSpace,itemWidth);if(itemsPerRow===1){var offsetY=0;var dragOffset=0;children.forEach(function(child,index2){if(dragIndex){var dist=index2-dragIndex;if(dist===-2){dragOffset=-itemVerticalMargin*0.25;}else if(dist===-1){dragOffset=-itemVerticalMargin*0.75;}else if(dist===0){dragOffset=itemVerticalMargin*0.75;}else if(dist===1){dragOffset=itemVerticalMargin*0.25;}else{dragOffset=0;}}if(shouldOptimize){child.translateX=null;child.translateY=null;}if(!child.markedForRemoval){moveItem(child,0,offsetY+dragOffset);}var itemHeight2=child.rect.element.height+itemVerticalMargin;var visualHeight=itemHeight2*(child.markedForRemoval?child.opacity:1);offsetY+=visualHeight;});}else{var prevX=0;var prevY=0;children.forEach(function(child,index2){if(index2===dragIndex){dragIndexOffset=1;}if(index2===addIndex){addIndexOffset+=1;}if(child.markedForRemoval&&child.opacity<0.5){removeIndexOffset-=1;}var visualIndex=index2+addIndexOffset+dragIndexOffset+removeIndexOffset;var indexX=visualIndex%itemsPerRow;var indexY=Math.floor(visualIndex/itemsPerRow);var offsetX=indexX*itemWidth;var offsetY=indexY*itemHeight;var vectorX=Math.sign(offsetX-prevX);var vectorY=Math.sign(offsetY-prevY);prevX=offsetX;prevY=offsetY;if(child.markedForRemoval)return;if(shouldOptimize){child.translateX=null;child.translateY=null;}moveItem(child,offsetX,offsetY,vectorX,vectorY);});}};var filterSetItemActions=function filterSetItemActions(child,actions2){return actions2.filter(function(action){if(action.data&&action.data.id){return child.id===action.data.id;}return true;});};var list=createView({create:create$8,write:write$5,tag:"ul",name:"list",didWriteView:function didWriteView(_ref101){var root2=_ref101.root;root2.childViews.filter(function(view){return view.markedForRemoval&&view.opacity===0&&view.resting;}).forEach(function(view){view._destroy();root2.removeChildView(view);});},filterFrameActionsForChild:filterSetItemActions,mixins:{apis:["dragCoordinates"]}});var create$9=function create$9(_ref102){var root2=_ref102.root,props=_ref102.props;root2.ref.list=root2.appendChildView(root2.createChildView(list));props.dragCoordinates=null;props.overflowing=false;};var storeDragCoordinates=function storeDragCoordinates(_ref103){var root2=_ref103.root,props=_ref103.props,action=_ref103.action;if(!root2.query("GET_ITEM_INSERT_LOCATION_FREEDOM"))return;props.dragCoordinates={left:action.position.scopeLeft-root2.ref.list.rect.element.left,top:action.position.scopeTop-(root2.rect.outer.top+root2.rect.element.marginTop+root2.rect.element.scrollTop)};};var clearDragCoordinates=function clearDragCoordinates(_ref104){var props=_ref104.props;props.dragCoordinates=null;};var route$3=createRoute({DID_DRAG:storeDragCoordinates,DID_END_DRAG:clearDragCoordinates});var write$6=function write$6(_ref105){var root2=_ref105.root,props=_ref105.props,actions2=_ref105.actions;route$3({root:root2,props:props,actions:actions2});root2.ref.list.dragCoordinates=props.dragCoordinates;if(props.overflowing&&!props.overflow){props.overflowing=false;root2.element.dataset.state="";root2.height=null;}if(props.overflow){var newHeight=Math.round(props.overflow);if(newHeight!==root2.height){props.overflowing=true;root2.element.dataset.state="overflow";root2.height=newHeight;}}};var listScroller=createView({create:create$9,write:write$6,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}});var attrToggle=function attrToggle(element,name2,state2){var enabledValue=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";if(state2){attr(element,name2,enabledValue);}else{element.removeAttribute(name2);}};var resetFileInput=function resetFileInput(input){if(!input||input.value===""){return;}try{input.value="";}catch(err){}if(input.value){var form=createElement$1("form");var parentNode=input.parentNode;var ref=input.nextSibling;form.appendChild(input);form.reset();if(ref){parentNode.insertBefore(input,ref);}else{parentNode.appendChild(input);}}};var create$a=function create$a(_ref106){var root2=_ref106.root,props=_ref106.props;root2.element.id="filepond--browser-".concat(props.id);attr(root2.element,"name",root2.query("GET_NAME"));attr(root2.element,"aria-controls","filepond--assistant-".concat(props.id));attr(root2.element,"aria-labelledby","filepond--drop-label-".concat(props.id));setAcceptedFileTypes({root:root2,action:{value:root2.query("GET_ACCEPTED_FILE_TYPES")}});toggleAllowMultiple({root:root2,action:{value:root2.query("GET_ALLOW_MULTIPLE")}});toggleDirectoryFilter({root:root2,action:{value:root2.query("GET_ALLOW_DIRECTORIES_ONLY")}});toggleDisabled({root:root2});toggleRequired({root:root2,action:{value:root2.query("GET_REQUIRED")}});setCaptureMethod({root:root2,action:{value:root2.query("GET_CAPTURE_METHOD")}});root2.ref.handleChange=function(e2){if(!root2.element.value){return;}var files=Array.from(root2.element.files).map(function(file2){file2._relativePath=file2.webkitRelativePath;return file2;});setTimeout(function(){props.onload(files);resetFileInput(root2.element);},250);};root2.element.addEventListener("change",root2.ref.handleChange);};var setAcceptedFileTypes=function setAcceptedFileTypes(_ref107){var root2=_ref107.root,action=_ref107.action;if(!root2.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE"))return;attrToggle(root2.element,"accept",!!action.value,action.value?action.value.join(","):"");};var toggleAllowMultiple=function toggleAllowMultiple(_ref108){var root2=_ref108.root,action=_ref108.action;attrToggle(root2.element,"multiple",action.value);};var toggleDirectoryFilter=function toggleDirectoryFilter(_ref109){var root2=_ref109.root,action=_ref109.action;attrToggle(root2.element,"webkitdirectory",action.value);};var toggleDisabled=function toggleDisabled(_ref110){var root2=_ref110.root;var isDisabled=root2.query("GET_DISABLED");var doesAllowBrowse=root2.query("GET_ALLOW_BROWSE");var disableField=isDisabled||!doesAllowBrowse;attrToggle(root2.element,"disabled",disableField);};var toggleRequired=function toggleRequired(_ref111){var root2=_ref111.root,action=_ref111.action;if(!action.value){attrToggle(root2.element,"required",false);}else if(root2.query("GET_TOTAL_ITEMS")===0){attrToggle(root2.element,"required",true);}};var setCaptureMethod=function setCaptureMethod(_ref112){var root2=_ref112.root,action=_ref112.action;attrToggle(root2.element,"capture",!!action.value,action.value===true?"":action.value);};var updateRequiredStatus=function updateRequiredStatus(_ref113){var root2=_ref113.root;var element=root2.element;if(root2.query("GET_TOTAL_ITEMS")>0){attrToggle(element,"required",false);attrToggle(element,"name",false);}else{attrToggle(element,"name",true,root2.query("GET_NAME"));var shouldCheckValidity=root2.query("GET_CHECK_VALIDITY");if(shouldCheckValidity){element.setCustomValidity("");}if(root2.query("GET_REQUIRED")){attrToggle(element,"required",true);}}};var updateFieldValidityStatus=function updateFieldValidityStatus(_ref114){var root2=_ref114.root;var shouldCheckValidity=root2.query("GET_CHECK_VALIDITY");if(!shouldCheckValidity)return;root2.element.setCustomValidity(root2.query("GET_LABEL_INVALID_FIELD"));};var browser=createView({tag:"input",name:"browser",ignoreRect:true,ignoreRectUpdate:true,attributes:{type:"file"},create:create$a,destroy:function destroy(_ref115){var root2=_ref115.root;root2.element.removeEventListener("change",root2.ref.handleChange);},write:createRoute({DID_LOAD_ITEM:updateRequiredStatus,DID_REMOVE_ITEM:updateRequiredStatus,DID_THROW_ITEM_INVALID:updateFieldValidityStatus,DID_SET_DISABLED:toggleDisabled,DID_SET_ALLOW_BROWSE:toggleDisabled,DID_SET_ALLOW_DIRECTORIES_ONLY:toggleDirectoryFilter,DID_SET_ALLOW_MULTIPLE:toggleAllowMultiple,DID_SET_ACCEPTED_FILE_TYPES:setAcceptedFileTypes,DID_SET_CAPTURE_METHOD:setCaptureMethod,DID_SET_REQUIRED:toggleRequired})});var Key={ENTER:13,SPACE:32};var create$b=function create$b(_ref116){var root2=_ref116.root,props=_ref116.props;var label=createElement$1("label");attr(label,"for","filepond--browser-".concat(props.id));attr(label,"id","filepond--drop-label-".concat(props.id));attr(label,"aria-hidden","true");root2.ref.handleKeyDown=function(e2){var isActivationKey=e2.keyCode===Key.ENTER||e2.keyCode===Key.SPACE;if(!isActivationKey)return;e2.preventDefault();root2.ref.label.click();};root2.ref.handleClick=function(e2){var isLabelClick=e2.target===label||label.contains(e2.target);if(isLabelClick)return;root2.ref.label.click();};label.addEventListener("keydown",root2.ref.handleKeyDown);root2.element.addEventListener("click",root2.ref.handleClick);updateLabelValue(label,props.caption);root2.appendChild(label);root2.ref.label=label;};var updateLabelValue=function updateLabelValue(label,value){label.innerHTML=value;var clickable=label.querySelector(".filepond--label-action");if(clickable){attr(clickable,"tabindex","0");}return value;};var dropLabel=createView({name:"drop-label",ignoreRect:true,create:create$b,destroy:function destroy(_ref117){var root2=_ref117.root;root2.ref.label.addEventListener("keydown",root2.ref.handleKeyDown);root2.element.removeEventListener("click",root2.ref.handleClick);},write:createRoute({DID_SET_LABEL_IDLE:function DID_SET_LABEL_IDLE(_ref118){var root2=_ref118.root,action=_ref118.action;updateLabelValue(root2.ref.label,action.value);}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}});var blob=createView({name:"drip-blob",ignoreRect:true,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}});var addBlob=function addBlob(_ref119){var root2=_ref119.root;var centerX=root2.rect.element.width*0.5;var centerY=root2.rect.element.height*0.5;root2.ref.blob=root2.appendChildView(root2.createChildView(blob,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:centerX,translateY:centerY}));};var moveBlob=function moveBlob(_ref120){var root2=_ref120.root,action=_ref120.action;if(!root2.ref.blob){addBlob({root:root2});return;}root2.ref.blob.translateX=action.position.scopeLeft;root2.ref.blob.translateY=action.position.scopeTop;root2.ref.blob.scaleX=1;root2.ref.blob.scaleY=1;root2.ref.blob.opacity=1;};var hideBlob=function hideBlob(_ref121){var root2=_ref121.root;if(!root2.ref.blob){return;}root2.ref.blob.opacity=0;};var explodeBlob=function explodeBlob(_ref122){var root2=_ref122.root;if(!root2.ref.blob){return;}root2.ref.blob.scaleX=2.5;root2.ref.blob.scaleY=2.5;root2.ref.blob.opacity=0;};var write$7=function write$7(_ref123){var root2=_ref123.root,props=_ref123.props,actions2=_ref123.actions;route$4({root:root2,props:props,actions:actions2});var blob2=root2.ref.blob;if(actions2.length===0&&blob2&&blob2.opacity===0){root2.removeChildView(blob2);root2.ref.blob=null;}};var route$4=createRoute({DID_DRAG:moveBlob,DID_DROP:explodeBlob,DID_END_DRAG:hideBlob});var drip=createView({ignoreRect:true,ignoreRectUpdate:true,name:"drip",write:write$7});var setInputFiles=function setInputFiles(element,files){try{var dataTransfer=new DataTransfer();files.forEach(function(file2){if(file2 instanceof File){dataTransfer.items.add(file2);}else{dataTransfer.items.add(new File([file2],file2.name,{type:file2.type}));}});element.files=dataTransfer.files;}catch(err){return false;}return true;};var create$c=function create$c(_ref124){var root2=_ref124.root;return root2.ref.fields={};};var getField=function getField(root2,id){return root2.ref.fields[id];};var syncFieldPositionsWithItems=function syncFieldPositionsWithItems(root2){root2.query("GET_ACTIVE_ITEMS").forEach(function(item2){if(!root2.ref.fields[item2.id])return;root2.element.appendChild(root2.ref.fields[item2.id]);});};var didReorderItems=function didReorderItems(_ref125){var root2=_ref125.root;return syncFieldPositionsWithItems(root2);};var didAddItem=function didAddItem(_ref126){var root2=_ref126.root,action=_ref126.action;var fileItem=root2.query("GET_ITEM",action.id);var isLocalFile=fileItem.origin===FileOrigin.LOCAL;var shouldUseFileInput=!isLocalFile&&root2.query("SHOULD_UPDATE_FILE_INPUT");var dataContainer=createElement$1("input");dataContainer.type=shouldUseFileInput?"file":"hidden";dataContainer.name=root2.query("GET_NAME");dataContainer.disabled=root2.query("GET_DISABLED");root2.ref.fields[action.id]=dataContainer;syncFieldPositionsWithItems(root2);};var didLoadItem$1=function didLoadItem$1(_ref127){var root2=_ref127.root,action=_ref127.action;var field=getField(root2,action.id);if(!field)return;if(action.serverFileReference!==null)field.value=action.serverFileReference;if(!root2.query("SHOULD_UPDATE_FILE_INPUT"))return;var fileItem=root2.query("GET_ITEM",action.id);setInputFiles(field,[fileItem.file]);};var didPrepareOutput=function didPrepareOutput(_ref128){var root2=_ref128.root,action=_ref128.action;if(!root2.query("SHOULD_UPDATE_FILE_INPUT"))return;setTimeout(function(){var field=getField(root2,action.id);if(!field)return;setInputFiles(field,[action.file]);},0);};var didSetDisabled=function didSetDisabled(_ref129){var root2=_ref129.root;root2.element.disabled=root2.query("GET_DISABLED");};var didRemoveItem=function didRemoveItem(_ref130){var root2=_ref130.root,action=_ref130.action;var field=getField(root2,action.id);if(!field)return;if(field.parentNode)field.parentNode.removeChild(field);delete root2.ref.fields[action.id];};var didDefineValue=function didDefineValue(_ref131){var root2=_ref131.root,action=_ref131.action;var field=getField(root2,action.id);if(!field)return;if(action.value===null){field.removeAttribute("value");}else{field.value=action.value;}syncFieldPositionsWithItems(root2);};var write$8=createRoute({DID_SET_DISABLED:didSetDisabled,DID_ADD_ITEM:didAddItem,DID_LOAD_ITEM:didLoadItem$1,DID_REMOVE_ITEM:didRemoveItem,DID_DEFINE_VALUE:didDefineValue,DID_PREPARE_OUTPUT:didPrepareOutput,DID_REORDER_ITEMS:didReorderItems,DID_SORT_ITEMS:didReorderItems});var data2=createView({tag:"fieldset",name:"data",create:create$c,write:write$8,ignoreRect:true});var getRootNode=function getRootNode(element){return"getRootNode"in element?element.getRootNode():document;};var images=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"];var text$1=["css","csv","html","txt"];var map={zip:"zip|compressed",epub:"application/epub+zip"};var guesstimateMimeType=function guesstimateMimeType(){var extension=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";extension=extension.toLowerCase();if(images.includes(extension)){return"image/"+(extension==="jpg"?"jpeg":extension==="svg"?"svg+xml":extension);}if(text$1.includes(extension)){return"text/"+extension;}return map[extension]||"";};var requestDataTransferItems=function requestDataTransferItems(dataTransfer){return new Promise(function(resolve,reject){var links=getLinks(dataTransfer);if(links.length&&!hasFiles(dataTransfer)){return resolve(links);}getFiles(dataTransfer).then(resolve);});};var hasFiles=function hasFiles(dataTransfer){if(dataTransfer.files)return dataTransfer.files.length>0;return false;};var getFiles=function getFiles(dataTransfer){return new Promise(function(resolve,reject){var promisedFiles=(dataTransfer.items?Array.from(dataTransfer.items):[]).filter(function(item2){return isFileSystemItem(item2);}).map(function(item2){return getFilesFromItem(item2);});if(!promisedFiles.length){resolve(dataTransfer.files?Array.from(dataTransfer.files):[]);return;}Promise.all(promisedFiles).then(function(returnedFileGroups){var files=[];returnedFileGroups.forEach(function(group){files.push.apply(files,group);});resolve(files.filter(function(file2){return file2;}).map(function(file2){if(!file2._relativePath)file2._relativePath=file2.webkitRelativePath;return file2;}));})["catch"](console.error);});};var isFileSystemItem=function isFileSystemItem(item2){if(isEntry(item2)){var entry=getAsEntry(item2);if(entry){return entry.isFile||entry.isDirectory;}}return item2.kind==="file";};var getFilesFromItem=function getFilesFromItem(item2){return new Promise(function(resolve,reject){if(isDirectoryEntry(item2)){getFilesInDirectory(getAsEntry(item2)).then(resolve)["catch"](reject);return;}resolve([item2.getAsFile()]);});};var getFilesInDirectory=function getFilesInDirectory(entry){return new Promise(function(resolve,reject){var files=[];var dirCounter=0;var fileCounter=0;var resolveIfDone=function resolveIfDone(){if(fileCounter===0&&dirCounter===0){resolve(files);}};var readEntries=function readEntries(dirEntry){dirCounter++;var directoryReader=dirEntry.createReader();var readBatch=function readBatch(){directoryReader.readEntries(function(entries){if(entries.length===0){dirCounter--;resolveIfDone();return;}entries.forEach(function(entry2){if(entry2.isDirectory){readEntries(entry2);}else{fileCounter++;entry2.file(function(file2){var correctedFile=correctMissingFileType(file2);if(entry2.fullPath)correctedFile._relativePath=entry2.fullPath;files.push(correctedFile);fileCounter--;resolveIfDone();});}});readBatch();},reject);};readBatch();};readEntries(entry);});};var correctMissingFileType=function correctMissingFileType(file2){if(file2.type.length)return file2;var date=file2.lastModifiedDate;var name2=file2.name;var type=guesstimateMimeType(getExtensionFromFilename(file2.name));if(!type.length)return file2;file2=file2.slice(0,file2.size,type);file2.name=name2;file2.lastModifiedDate=date;return file2;};var isDirectoryEntry=function isDirectoryEntry(item2){return isEntry(item2)&&(getAsEntry(item2)||{}).isDirectory;};var isEntry=function isEntry(item2){return"webkitGetAsEntry"in item2;};var getAsEntry=function getAsEntry(item2){return item2.webkitGetAsEntry();};var getLinks=function getLinks(dataTransfer){var links=[];try{links=getLinksFromTransferMetaData(dataTransfer);if(links.length){return links;}links=getLinksFromTransferURLData(dataTransfer);}catch(e2){}return links;};var getLinksFromTransferURLData=function getLinksFromTransferURLData(dataTransfer){var data3=dataTransfer.getData("url");if(typeof data3==="string"&&data3.length){return[data3];}return[];};var getLinksFromTransferMetaData=function getLinksFromTransferMetaData(dataTransfer){var data3=dataTransfer.getData("text/html");if(typeof data3==="string"&&data3.length){var matches2=data3.match(/src\s*=\s*"(.+?)"/);if(matches2){return[matches2[1]];}}return[];};var dragNDropObservers=[];var eventPosition=function eventPosition(e2){return{pageLeft:e2.pageX,pageTop:e2.pageY,scopeLeft:e2.offsetX||e2.layerX,scopeTop:e2.offsetY||e2.layerY};};var createDragNDropClient=function createDragNDropClient(element,scopeToObserve,filterElement){var observer2=getDragNDropObserver(scopeToObserve);var client={element:element,filterElement:filterElement,state:null,ondrop:function ondrop(){},onenter:function onenter(){},ondrag:function ondrag(){},onexit:function onexit(){},onload:function onload(){},allowdrop:function allowdrop(){}};client.destroy=observer2.addListener(client);return client;};var getDragNDropObserver=function getDragNDropObserver(element){var observer2=dragNDropObservers.find(function(item2){return item2.element===element;});if(observer2){return observer2;}var newObserver=createDragNDropObserver(element);dragNDropObservers.push(newObserver);return newObserver;};var createDragNDropObserver=function createDragNDropObserver(element){var clients=[];var routes={dragenter:dragenter,dragover:dragover,dragleave:dragleave,drop:drop};var handlers={};forin(routes,function(event,createHandler){handlers[event]=createHandler(element,clients);element.addEventListener(event,handlers[event],false);});var observer2={element:element,addListener:function addListener(client){clients.push(client);return function(){clients.splice(clients.indexOf(client),1);if(clients.length===0){dragNDropObservers.splice(dragNDropObservers.indexOf(observer2),1);forin(routes,function(event){element.removeEventListener(event,handlers[event],false);});}};}};return observer2;};var elementFromPoint=function elementFromPoint(root2,point){if(!("elementFromPoint"in root2)){root2=document;}return root2.elementFromPoint(point.x,point.y);};var isEventTarget=function isEventTarget(e2,target){var root2=getRootNode(target);var elementAtPosition=elementFromPoint(root2,{x:e2.pageX-window.pageXOffset,y:e2.pageY-window.pageYOffset});return elementAtPosition===target||target.contains(elementAtPosition);};var initialTarget=null;var setDropEffect=function setDropEffect(dataTransfer,effect){try{dataTransfer.dropEffect=effect;}catch(e2){}};var dragenter=function dragenter(root2,clients){return function(e2){e2.preventDefault();initialTarget=e2.target;clients.forEach(function(client){var element=client.element,onenter=client.onenter;if(isEventTarget(e2,element)){client.state="enter";onenter(eventPosition(e2));}});};};var dragover=function dragover(root2,clients){return function(e2){e2.preventDefault();var dataTransfer=e2.dataTransfer;requestDataTransferItems(dataTransfer).then(function(items){var overDropTarget=false;clients.some(function(client){var filterElement=client.filterElement,element=client.element,onenter=client.onenter,onexit=client.onexit,ondrag=client.ondrag,allowdrop=client.allowdrop;setDropEffect(dataTransfer,"copy");var allowsTransfer=allowdrop(items);if(!allowsTransfer){setDropEffect(dataTransfer,"none");return;}if(isEventTarget(e2,element)){overDropTarget=true;if(client.state===null){client.state="enter";onenter(eventPosition(e2));return;}client.state="over";if(filterElement&&!allowsTransfer){setDropEffect(dataTransfer,"none");return;}ondrag(eventPosition(e2));}else{if(filterElement&&!overDropTarget){setDropEffect(dataTransfer,"none");}if(client.state){client.state=null;onexit(eventPosition(e2));}}});});};};var drop=function drop(root2,clients){return function(e2){e2.preventDefault();var dataTransfer=e2.dataTransfer;requestDataTransferItems(dataTransfer).then(function(items){clients.forEach(function(client){var filterElement=client.filterElement,element=client.element,ondrop=client.ondrop,onexit=client.onexit,allowdrop=client.allowdrop;client.state=null;if(filterElement&&!isEventTarget(e2,element))return;if(!allowdrop(items))return onexit(eventPosition(e2));ondrop(eventPosition(e2),items);});});};};var dragleave=function dragleave(root2,clients){return function(e2){if(initialTarget!==e2.target){return;}clients.forEach(function(client){var onexit=client.onexit;client.state=null;onexit(eventPosition(e2));});};};var createHopper=function createHopper(scope,validateItems,options2){scope.classList.add("filepond--hopper");var catchesDropsOnPage=options2.catchesDropsOnPage,requiresDropOnElement=options2.requiresDropOnElement,_options2$filterItems=options2.filterItems,filterItems=_options2$filterItems===void 0?function(items){return items;}:_options2$filterItems;var client=createDragNDropClient(scope,catchesDropsOnPage?document.documentElement:scope,requiresDropOnElement);var lastState="";var currentState="";client.allowdrop=function(items){return validateItems(filterItems(items));};client.ondrop=function(position,items){var filteredItems=filterItems(items);if(!validateItems(filteredItems)){api.ondragend(position);return;}currentState="drag-drop";api.onload(filteredItems,position);};client.ondrag=function(position){api.ondrag(position);};client.onenter=function(position){currentState="drag-over";api.ondragstart(position);};client.onexit=function(position){currentState="drag-exit";api.ondragend(position);};var api={updateHopperState:function updateHopperState(){if(lastState!==currentState){scope.dataset.hopperState=currentState;lastState=currentState;}},onload:function onload(){},ondragstart:function ondragstart(){},ondrag:function ondrag(){},ondragend:function ondragend(){},destroy:function destroy(){client.destroy();}};return api;};var listening=false;var listeners$1=[];var handlePaste=function handlePaste(e2){var activeEl=document.activeElement;if(activeEl&&/textarea|input/i.test(activeEl.nodeName)){var inScope=false;var element=activeEl;while(element!==document.body){if(element.classList.contains("filepond--root")){inScope=true;break;}element=element.parentNode;}if(!inScope)return;}requestDataTransferItems(e2.clipboardData).then(function(files){if(!files.length){return;}listeners$1.forEach(function(listener){return listener(files);});});};var listen=function listen(cb){if(listeners$1.includes(cb)){return;}listeners$1.push(cb);if(listening){return;}listening=true;document.addEventListener("paste",handlePaste);};var unlisten=function unlisten(listener){arrayRemove(listeners$1,listeners$1.indexOf(listener));if(listeners$1.length===0){document.removeEventListener("paste",handlePaste);listening=false;}};var createPaster=function createPaster(){var cb=function cb(files){api.onload(files);};var api={destroy:function destroy(){unlisten(cb);},onload:function onload(){}};listen(cb);return api;};var create$d=function create$d(_ref132){var root2=_ref132.root,props=_ref132.props;root2.element.id="filepond--assistant-".concat(props.id);attr(root2.element,"role","status");attr(root2.element,"aria-live","polite");attr(root2.element,"aria-relevant","additions");};var addFilesNotificationTimeout=null;var notificationClearTimeout=null;var filenames=[];var assist=function assist(root2,message){root2.element.textContent=message;};var clear$1=function clear$1(root2){root2.element.textContent="";};var listModified=function listModified(root2,filename,label){var total=root2.query("GET_TOTAL_ITEMS");assist(root2,"".concat(label," ").concat(filename,", ").concat(total," ").concat(total===1?root2.query("GET_LABEL_FILE_COUNT_SINGULAR"):root2.query("GET_LABEL_FILE_COUNT_PLURAL")));clearTimeout(notificationClearTimeout);notificationClearTimeout=setTimeout(function(){clear$1(root2);},1500);};var isUsingFilePond=function isUsingFilePond(root2){return root2.element.parentNode.contains(document.activeElement);};var itemAdded=function itemAdded(_ref133){var root2=_ref133.root,action=_ref133.action;if(!isUsingFilePond(root2)){return;}root2.element.textContent="";var item2=root2.query("GET_ITEM",action.id);filenames.push(item2.filename);clearTimeout(addFilesNotificationTimeout);addFilesNotificationTimeout=setTimeout(function(){listModified(root2,filenames.join(", "),root2.query("GET_LABEL_FILE_ADDED"));filenames.length=0;},750);};var itemRemoved=function itemRemoved(_ref134){var root2=_ref134.root,action=_ref134.action;if(!isUsingFilePond(root2)){return;}var item2=action.item;listModified(root2,item2.filename,root2.query("GET_LABEL_FILE_REMOVED"));};var itemProcessed=function itemProcessed(_ref135){var root2=_ref135.root,action=_ref135.action;var item2=root2.query("GET_ITEM",action.id);var filename=item2.filename;var label=root2.query("GET_LABEL_FILE_PROCESSING_COMPLETE");assist(root2,"".concat(filename," ").concat(label));};var itemProcessedUndo=function itemProcessedUndo(_ref136){var root2=_ref136.root,action=_ref136.action;var item2=root2.query("GET_ITEM",action.id);var filename=item2.filename;var label=root2.query("GET_LABEL_FILE_PROCESSING_ABORTED");assist(root2,"".concat(filename," ").concat(label));};var itemError=function itemError(_ref137){var root2=_ref137.root,action=_ref137.action;var item2=root2.query("GET_ITEM",action.id);var filename=item2.filename;assist(root2,"".concat(action.status.main," ").concat(filename," ").concat(action.status.sub));};var assistant=createView({create:create$d,ignoreRect:true,ignoreRectUpdate:true,write:createRoute({DID_LOAD_ITEM:itemAdded,DID_REMOVE_ITEM:itemRemoved,DID_COMPLETE_ITEM_PROCESSING:itemProcessed,DID_ABORT_ITEM_PROCESSING:itemProcessedUndo,DID_REVERT_ITEM_PROCESSING:itemProcessedUndo,DID_THROW_ITEM_REMOVE_ERROR:itemError,DID_THROW_ITEM_LOAD_ERROR:itemError,DID_THROW_ITEM_INVALID:itemError,DID_THROW_ITEM_PROCESSING_ERROR:itemError}),tag:"span",name:"assistant"});var toCamels=function toCamels(string){var separator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"-";return string.replace(new RegExp("".concat(separator,"."),"g"),function(sub){return sub.charAt(1).toUpperCase();});};var debounce=function debounce(func){var interval=arguments.length>1&&arguments[1]!==undefined?arguments[1]:16;var immidiateOnly=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var last=Date.now();var timeout=null;return function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++){args[_key10]=arguments[_key10];}clearTimeout(timeout);var dist=Date.now()-last;var fn2=function fn2(){last=Date.now();func.apply(void 0,args);};if(dist<interval){if(!immidiateOnly){timeout=setTimeout(fn2,interval-dist);}}else{fn2();}};};var MAX_FILES_LIMIT=1e6;var prevent=function prevent(e2){return e2.preventDefault();};var create$e=function create$e(_ref138){var root2=_ref138.root,props=_ref138.props;var id=root2.query("GET_ID");if(id){root2.element.id=id;}var className=root2.query("GET_CLASS_NAME");if(className){className.split(" ").filter(function(name2){return name2.length;}).forEach(function(name2){root2.element.classList.add(name2);});}root2.ref.label=root2.appendChildView(root2.createChildView(dropLabel,_objectSpread(_objectSpread({},props),{},{translateY:null,caption:root2.query("GET_LABEL_IDLE")})));root2.ref.list=root2.appendChildView(root2.createChildView(listScroller,{translateY:null}));root2.ref.panel=root2.appendChildView(root2.createChildView(panel,{name:"panel-root"}));root2.ref.assistant=root2.appendChildView(root2.createChildView(assistant,_objectSpread({},props)));root2.ref.data=root2.appendChildView(root2.createChildView(data2,_objectSpread({},props)));root2.ref.measure=createElement$1("div");root2.ref.measure.style.height="100%";root2.element.appendChild(root2.ref.measure);root2.ref.bounds=null;root2.query("GET_STYLES").filter(function(style){return!isEmpty(style.value);}).map(function(_ref139){var name2=_ref139.name,value=_ref139.value;root2.element.dataset[name2]=value;});root2.ref.widthPrevious=null;root2.ref.widthUpdated=debounce(function(){root2.ref.updateHistory=[];root2.dispatch("DID_RESIZE_ROOT");},250);root2.ref.previousAspectRatio=null;root2.ref.updateHistory=[];var canHover=window.matchMedia("(pointer: fine) and (hover: hover)").matches;var hasPointerEvents=("PointerEvent"in window);if(root2.query("GET_ALLOW_REORDER")&&hasPointerEvents&&!canHover){root2.element.addEventListener("touchmove",prevent,{passive:false});root2.element.addEventListener("gesturestart",prevent);}var credits=root2.query("GET_CREDITS");var hasCredits=credits.length===2;if(hasCredits){var frag=document.createElement("a");frag.className="filepond--credits";frag.setAttribute("aria-hidden","true");frag.href=credits[0];frag.tabindex=-1;frag.target="_blank";frag.rel="noopener noreferrer";frag.textContent=credits[1];root2.element.appendChild(frag);root2.ref.credits=frag;}};var write$9=function write$9(_ref140){var root2=_ref140.root,props=_ref140.props,actions2=_ref140.actions;route$5({root:root2,props:props,actions:actions2});actions2.filter(function(action){return /^DID_SET_STYLE_/.test(action.type);}).filter(function(action){return!isEmpty(action.data.value);}).map(function(_ref141){var type=_ref141.type,data3=_ref141.data;var name2=toCamels(type.substring(8).toLowerCase(),"_");root2.element.dataset[name2]=data3.value;root2.invalidateLayout();});if(root2.rect.element.hidden)return;if(root2.rect.element.width!==root2.ref.widthPrevious){root2.ref.widthPrevious=root2.rect.element.width;root2.ref.widthUpdated();}var bounds=root2.ref.bounds;if(!bounds){bounds=root2.ref.bounds=calculateRootBoundingBoxHeight(root2);root2.element.removeChild(root2.ref.measure);root2.ref.measure=null;}var _root2$ref=root2.ref,hopper=_root2$ref.hopper,label=_root2$ref.label,list2=_root2$ref.list,panel2=_root2$ref.panel;if(hopper){hopper.updateHopperState();}var aspectRatio=root2.query("GET_PANEL_ASPECT_RATIO");var isMultiItem=root2.query("GET_ALLOW_MULTIPLE");var totalItems=root2.query("GET_TOTAL_ITEMS");var maxItems=isMultiItem?root2.query("GET_MAX_FILES")||MAX_FILES_LIMIT:1;var atMaxCapacity=totalItems===maxItems;var addAction=actions2.find(function(action){return action.type==="DID_ADD_ITEM";});if(atMaxCapacity&&addAction){var interactionMethod=addAction.data.interactionMethod;label.opacity=0;if(isMultiItem){label.translateY=-40;}else{if(interactionMethod===InteractionMethod.API){label.translateX=40;}else if(interactionMethod===InteractionMethod.BROWSE){label.translateY=40;}else{label.translateY=30;}}}else if(!atMaxCapacity){label.opacity=1;label.translateX=0;label.translateY=0;}var listItemMargin=calculateListItemMargin(root2);var listHeight=calculateListHeight(root2);var labelHeight=label.rect.element.height;var currentLabelHeight=!isMultiItem||atMaxCapacity?0:labelHeight;var listMarginTop=atMaxCapacity?list2.rect.element.marginTop:0;var listMarginBottom=totalItems===0?0:list2.rect.element.marginBottom;var visualHeight=currentLabelHeight+listMarginTop+listHeight.visual+listMarginBottom;var boundsHeight=currentLabelHeight+listMarginTop+listHeight.bounds+listMarginBottom;list2.translateY=Math.max(0,currentLabelHeight-list2.rect.element.marginTop)-listItemMargin.top;if(aspectRatio){var width=root2.rect.element.width;var height=width*aspectRatio;if(aspectRatio!==root2.ref.previousAspectRatio){root2.ref.previousAspectRatio=aspectRatio;root2.ref.updateHistory=[];}var history=root2.ref.updateHistory;history.push(width);var MAX_BOUNCES=2;if(history.length>MAX_BOUNCES*2){var l=history.length;var bottom=l-10;var bounces=0;for(var i=l;i>=bottom;i--){if(history[i]===history[i-2]){bounces++;}if(bounces>=MAX_BOUNCES){return;}}}panel2.scalable=false;panel2.height=height;var listAvailableHeight=height-currentLabelHeight-(listMarginBottom-listItemMargin.bottom)-(atMaxCapacity?listMarginTop:0);if(listHeight.visual>listAvailableHeight){list2.overflow=listAvailableHeight;}else{list2.overflow=null;}root2.height=height;}else if(bounds.fixedHeight){panel2.scalable=false;var _listAvailableHeight=bounds.fixedHeight-currentLabelHeight-(listMarginBottom-listItemMargin.bottom)-(atMaxCapacity?listMarginTop:0);if(listHeight.visual>_listAvailableHeight){list2.overflow=_listAvailableHeight;}else{list2.overflow=null;}}else if(bounds.cappedHeight){var isCappedHeight=visualHeight>=bounds.cappedHeight;var panelHeight=Math.min(bounds.cappedHeight,visualHeight);panel2.scalable=true;panel2.height=isCappedHeight?panelHeight:panelHeight-listItemMargin.top-listItemMargin.bottom;var _listAvailableHeight2=panelHeight-currentLabelHeight-(listMarginBottom-listItemMargin.bottom)-(atMaxCapacity?listMarginTop:0);if(visualHeight>bounds.cappedHeight&&listHeight.visual>_listAvailableHeight2){list2.overflow=_listAvailableHeight2;}else{list2.overflow=null;}root2.height=Math.min(bounds.cappedHeight,boundsHeight-listItemMargin.top-listItemMargin.bottom);}else{var itemMargin=totalItems>0?listItemMargin.top+listItemMargin.bottom:0;panel2.scalable=true;panel2.height=Math.max(labelHeight,visualHeight-itemMargin);root2.height=Math.max(labelHeight,boundsHeight-itemMargin);}if(root2.ref.credits&&panel2.heightCurrent)root2.ref.credits.style.transform="translateY(".concat(panel2.heightCurrent,"px)");};var calculateListItemMargin=function calculateListItemMargin(root2){var item2=root2.ref.list.childViews[0].childViews[0];return item2?{top:item2.rect.element.marginTop,bottom:item2.rect.element.marginBottom}:{top:0,bottom:0};};var calculateListHeight=function calculateListHeight(root2){var visual=0;var bounds=0;var scrollList=root2.ref.list;var itemList=scrollList.childViews[0];var visibleChildren=itemList.childViews.filter(function(child){return child.rect.element.height;});var children=root2.query("GET_ACTIVE_ITEMS").map(function(item2){return visibleChildren.find(function(child){return child.id===item2.id;});}).filter(function(item2){return item2;});if(children.length===0)return{visual:visual,bounds:bounds};var horizontalSpace=itemList.rect.element.width;var dragIndex=getItemIndexByPosition(itemList,children,scrollList.dragCoordinates);var childRect=children[0].rect.element;var itemVerticalMargin=childRect.marginTop+childRect.marginBottom;var itemHorizontalMargin=childRect.marginLeft+childRect.marginRight;var itemWidth=childRect.width+itemHorizontalMargin;var itemHeight=childRect.height+itemVerticalMargin;var newItem=typeof dragIndex!=="undefined"&&dragIndex>=0?1:0;var removedItem=children.find(function(child){return child.markedForRemoval&&child.opacity<0.45;})?-1:0;var verticalItemCount=children.length+newItem+removedItem;var itemsPerRow=getItemsPerRow(horizontalSpace,itemWidth);if(itemsPerRow===1){children.forEach(function(item2){var height=item2.rect.element.height+itemVerticalMargin;bounds+=height;visual+=height*item2.opacity;});}else{bounds=Math.ceil(verticalItemCount/itemsPerRow)*itemHeight;visual=bounds;}return{visual:visual,bounds:bounds};};var calculateRootBoundingBoxHeight=function calculateRootBoundingBoxHeight(root2){var height=root2.ref.measureHeight||null;var cappedHeight=parseInt(root2.style.maxHeight,10)||null;var fixedHeight=height===0?null:height;return{cappedHeight:cappedHeight,fixedHeight:fixedHeight};};var exceedsMaxFiles=function exceedsMaxFiles(root2,items){var allowReplace=root2.query("GET_ALLOW_REPLACE");var allowMultiple=root2.query("GET_ALLOW_MULTIPLE");var totalItems=root2.query("GET_TOTAL_ITEMS");var maxItems=root2.query("GET_MAX_FILES");var totalBrowseItems=items.length;if(!allowMultiple&&totalBrowseItems>1){root2.dispatch("DID_THROW_MAX_FILES",{source:items,error:createResponse("warning",0,"Max files")});return true;}maxItems=allowMultiple?maxItems:1;if(!allowMultiple&&allowReplace){return false;}var hasMaxItems=isInt(maxItems);if(hasMaxItems&&totalItems+totalBrowseItems>maxItems){root2.dispatch("DID_THROW_MAX_FILES",{source:items,error:createResponse("warning",0,"Max files")});return true;}return false;};var getDragIndex=function getDragIndex(list2,children,position){var itemList=list2.childViews[0];return getItemIndexByPosition(itemList,children,{left:position.scopeLeft-itemList.rect.element.left,top:position.scopeTop-(list2.rect.outer.top+list2.rect.element.marginTop+list2.rect.element.scrollTop)});};var toggleDrop=function toggleDrop(root2){var isAllowed=root2.query("GET_ALLOW_DROP");var isDisabled=root2.query("GET_DISABLED");var enabled=isAllowed&&!isDisabled;if(enabled&&!root2.ref.hopper){var hopper=createHopper(root2.element,function(items){var beforeDropFile=root2.query("GET_BEFORE_DROP_FILE")||function(){return true;};var dropValidation=root2.query("GET_DROP_VALIDATION");return dropValidation?items.every(function(item2){return applyFilters("ALLOW_HOPPER_ITEM",item2,{query:root2.query}).every(function(result){return result===true;})&&beforeDropFile(item2);}):true;},{filterItems:function filterItems(items){var ignoredFiles=root2.query("GET_IGNORED_FILES");return items.filter(function(item2){if(isFile(item2)){return!ignoredFiles.includes(item2.name.toLowerCase());}return true;});},catchesDropsOnPage:root2.query("GET_DROP_ON_PAGE"),requiresDropOnElement:root2.query("GET_DROP_ON_ELEMENT")});hopper.onload=function(items,position){var list2=root2.ref.list.childViews[0];var visibleChildren=list2.childViews.filter(function(child){return child.rect.element.height;});var children=root2.query("GET_ACTIVE_ITEMS").map(function(item2){return visibleChildren.find(function(child){return child.id===item2.id;});}).filter(function(item2){return item2;});applyFilterChain("ADD_ITEMS",items,{dispatch:root2.dispatch}).then(function(queue){if(exceedsMaxFiles(root2,queue))return false;root2.dispatch("ADD_ITEMS",{items:queue,index:getDragIndex(root2.ref.list,children,position),interactionMethod:InteractionMethod.DROP});});root2.dispatch("DID_DROP",{position:position});root2.dispatch("DID_END_DRAG",{position:position});};hopper.ondragstart=function(position){root2.dispatch("DID_START_DRAG",{position:position});};hopper.ondrag=debounce(function(position){root2.dispatch("DID_DRAG",{position:position});});hopper.ondragend=function(position){root2.dispatch("DID_END_DRAG",{position:position});};root2.ref.hopper=hopper;root2.ref.drip=root2.appendChildView(root2.createChildView(drip));}else if(!enabled&&root2.ref.hopper){root2.ref.hopper.destroy();root2.ref.hopper=null;root2.removeChildView(root2.ref.drip);}};var toggleBrowse=function toggleBrowse(root2,props){var isAllowed=root2.query("GET_ALLOW_BROWSE");var isDisabled=root2.query("GET_DISABLED");var enabled=isAllowed&&!isDisabled;if(enabled&&!root2.ref.browser){root2.ref.browser=root2.appendChildView(root2.createChildView(browser,_objectSpread(_objectSpread({},props),{},{onload:function onload(items){applyFilterChain("ADD_ITEMS",items,{dispatch:root2.dispatch}).then(function(queue){if(exceedsMaxFiles(root2,queue))return false;root2.dispatch("ADD_ITEMS",{items:queue,index:-1,interactionMethod:InteractionMethod.BROWSE});});}})),0);}else if(!enabled&&root2.ref.browser){root2.removeChildView(root2.ref.browser);root2.ref.browser=null;}};var togglePaste=function togglePaste(root2){var isAllowed=root2.query("GET_ALLOW_PASTE");var isDisabled=root2.query("GET_DISABLED");var enabled=isAllowed&&!isDisabled;if(enabled&&!root2.ref.paster){root2.ref.paster=createPaster();root2.ref.paster.onload=function(items){applyFilterChain("ADD_ITEMS",items,{dispatch:root2.dispatch}).then(function(queue){if(exceedsMaxFiles(root2,queue))return false;root2.dispatch("ADD_ITEMS",{items:queue,index:-1,interactionMethod:InteractionMethod.PASTE});});};}else if(!enabled&&root2.ref.paster){root2.ref.paster.destroy();root2.ref.paster=null;}};var route$5=createRoute({DID_SET_ALLOW_BROWSE:function DID_SET_ALLOW_BROWSE(_ref142){var root2=_ref142.root,props=_ref142.props;toggleBrowse(root2,props);},DID_SET_ALLOW_DROP:function DID_SET_ALLOW_DROP(_ref143){var root2=_ref143.root;toggleDrop(root2);},DID_SET_ALLOW_PASTE:function DID_SET_ALLOW_PASTE(_ref144){var root2=_ref144.root;togglePaste(root2);},DID_SET_DISABLED:function DID_SET_DISABLED(_ref145){var root2=_ref145.root,props=_ref145.props;toggleDrop(root2);togglePaste(root2);toggleBrowse(root2,props);var isDisabled=root2.query("GET_DISABLED");if(isDisabled){root2.element.dataset.disabled="disabled";}else{root2.element.removeAttribute("data-disabled");}}});var root=createView({name:"root",read:function read(_ref146){var root2=_ref146.root;if(root2.ref.measure){root2.ref.measureHeight=root2.ref.measure.offsetHeight;}},create:create$e,write:write$9,destroy:function destroy(_ref147){var root2=_ref147.root;if(root2.ref.paster){root2.ref.paster.destroy();}if(root2.ref.hopper){root2.ref.hopper.destroy();}root2.element.removeEventListener("touchmove",prevent);root2.element.removeEventListener("gesturestart",prevent);},mixins:{styles:["height"]}});var createApp=function createApp(){var initialOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var originalElement=null;var defaultOptions2=getOptions();var store=createStore(createInitialState(defaultOptions2),[queries,createOptionQueries(defaultOptions2)],[actions,createOptionActions(defaultOptions2)]);store.dispatch("SET_OPTIONS",{options:initialOptions});var visibilityHandler=function visibilityHandler(){if(document.hidden)return;store.dispatch("KICK");};document.addEventListener("visibilitychange",visibilityHandler);var resizeDoneTimer=null;var isResizing=false;var isResizingHorizontally=false;var initialWindowWidth=null;var currentWindowWidth=null;var resizeHandler=function resizeHandler(){if(!isResizing){isResizing=true;}clearTimeout(resizeDoneTimer);resizeDoneTimer=setTimeout(function(){isResizing=false;initialWindowWidth=null;currentWindowWidth=null;if(isResizingHorizontally){isResizingHorizontally=false;store.dispatch("DID_STOP_RESIZE");}},500);};window.addEventListener("resize",resizeHandler);var view=root(store,{id:getUniqueId()});var isResting=false;var isHidden=false;var readWriteApi={_read:function _read(){if(isResizing){currentWindowWidth=window.innerWidth;if(!initialWindowWidth){initialWindowWidth=currentWindowWidth;}if(!isResizingHorizontally&&currentWindowWidth!==initialWindowWidth){store.dispatch("DID_START_RESIZE");isResizingHorizontally=true;}}if(isHidden&&isResting){isResting=view.element.offsetParent===null;}if(isResting)return;view._read();isHidden=view.rect.element.hidden;},_write:function _write(ts){var actions2=store.processActionQueue().filter(function(action){return!/^SET_/.test(action.type);});if(isResting&&!actions2.length)return;routeActionsToEvents(actions2);isResting=view._write(ts,actions2,isResizingHorizontally);removeReleasedItems(store.query("GET_ITEMS"));if(isResting){store.processDispatchQueue();}}};var createEvent=function createEvent(name2){return function(data3){var event={type:name2};if(!data3){return event;}if(data3.hasOwnProperty("error")){event.error=data3.error?_objectSpread({},data3.error):null;}if(data3.status){event.status=_objectSpread({},data3.status);}if(data3.file){event.output=data3.file;}if(data3.source){event.file=data3.source;}else if(data3.item||data3.id){var item2=data3.item?data3.item:store.query("GET_ITEM",data3.id);event.file=item2?createItemAPI(item2):null;}if(data3.items){event.items=data3.items.map(createItemAPI);}if(/progress/.test(name2)){event.progress=data3.progress;}if(data3.hasOwnProperty("origin")&&data3.hasOwnProperty("target")){event.origin=data3.origin;event.target=data3.target;}return event;};};var eventRoutes={DID_DESTROY:createEvent("destroy"),DID_INIT:createEvent("init"),DID_THROW_MAX_FILES:createEvent("warning"),DID_INIT_ITEM:createEvent("initfile"),DID_START_ITEM_LOAD:createEvent("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:createEvent("addfileprogress"),DID_LOAD_ITEM:createEvent("addfile"),DID_THROW_ITEM_INVALID:[createEvent("error"),createEvent("addfile")],DID_THROW_ITEM_LOAD_ERROR:[createEvent("error"),createEvent("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[createEvent("error"),createEvent("removefile")],DID_PREPARE_OUTPUT:createEvent("preparefile"),DID_START_ITEM_PROCESSING:createEvent("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:createEvent("processfileprogress"),DID_ABORT_ITEM_PROCESSING:createEvent("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:createEvent("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:createEvent("processfiles"),DID_REVERT_ITEM_PROCESSING:createEvent("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[createEvent("error"),createEvent("processfile")],DID_REMOVE_ITEM:createEvent("removefile"),DID_UPDATE_ITEMS:createEvent("updatefiles"),DID_ACTIVATE_ITEM:createEvent("activatefile"),DID_REORDER_ITEMS:createEvent("reorderfiles")};var exposeEvent=function exposeEvent(event){var detail=_objectSpread({pond:exports},event);delete detail.type;view.element.dispatchEvent(new CustomEvent("FilePond:".concat(event.type),{detail:detail,bubbles:true,cancelable:true,composed:true}));var params=[];if(event.hasOwnProperty("error")){params.push(event.error);}if(event.hasOwnProperty("file")){params.push(event.file);}var filtered=["type","error","file"];Object.keys(event).filter(function(key){return!filtered.includes(key);}).forEach(function(key){return params.push(event[key]);});exports.fire.apply(exports,[event.type].concat(params));var handler=store.query("GET_ON".concat(event.type.toUpperCase()));if(handler){handler.apply(void 0,params);}};var routeActionsToEvents=function routeActionsToEvents(actions2){if(!actions2.length)return;actions2.filter(function(action){return eventRoutes[action.type];}).forEach(function(action){var routes=eventRoutes[action.type];(Array.isArray(routes)?routes:[routes]).forEach(function(route2){if(action.type==="DID_INIT_ITEM"){exposeEvent(route2(action.data));}else{setTimeout(function(){exposeEvent(route2(action.data));},0);}});});};var setOptions3=function setOptions3(options2){return store.dispatch("SET_OPTIONS",{options:options2});};var getFile2=function getFile2(query){return store.query("GET_ACTIVE_ITEM",query);};var prepareFile=function prepareFile(query){return new Promise(function(resolve,reject){store.dispatch("REQUEST_ITEM_PREPARE",{query:query,success:function success(item2){resolve(item2);},failure:function failure(error2){reject(error2);}});});};var addFile=function addFile(source){var options2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(resolve,reject){addFiles([{source:source,options:options2}],{index:options2.index}).then(function(items){return resolve(items&&items[0]);})["catch"](reject);});};var isFilePondFile=function isFilePondFile(obj){return obj.file&&obj.id;};var removeFile=function removeFile(query,options2){if(_typeof4(query)==="object"&&!isFilePondFile(query)&&!options2){options2=query;query=void 0;}store.dispatch("REMOVE_ITEM",_objectSpread(_objectSpread({},options2),{},{query:query}));return store.query("GET_ACTIVE_ITEM",query)===null;};var addFiles=function addFiles(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++){args[_key11]=arguments[_key11];}return new Promise(function(resolve,reject){var sources=[];var options2={};if(isArray(args[0])){sources.push.apply(sources,args[0]);Object.assign(options2,args[1]||{});}else{var lastArgument=args[args.length-1];if(_typeof4(lastArgument)==="object"&&!(lastArgument instanceof Blob)){Object.assign(options2,args.pop());}sources.push.apply(sources,args);}store.dispatch("ADD_ITEMS",{items:sources,index:options2.index,interactionMethod:InteractionMethod.API,success:resolve,failure:reject});});};var getFiles2=function getFiles2(){return store.query("GET_ACTIVE_ITEMS");};var processFile=function processFile(query){return new Promise(function(resolve,reject){store.dispatch("REQUEST_ITEM_PROCESSING",{query:query,success:function success(item2){resolve(item2);},failure:function failure(error2){reject(error2);}});});};var prepareFiles=function prepareFiles(){for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++){args[_key12]=arguments[_key12];}var queries2=Array.isArray(args[0])?args[0]:args;var items=queries2.length?queries2:getFiles2();return Promise.all(items.map(prepareFile));};var processFiles=function processFiles(){for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++){args[_key13]=arguments[_key13];}var queries2=Array.isArray(args[0])?args[0]:args;if(!queries2.length){var files=getFiles2().filter(function(item2){return!(item2.status===ItemStatus.IDLE&&item2.origin===FileOrigin.LOCAL)&&item2.status!==ItemStatus.PROCESSING&&item2.status!==ItemStatus.PROCESSING_COMPLETE&&item2.status!==ItemStatus.PROCESSING_REVERT_ERROR;});return Promise.all(files.map(processFile));}return Promise.all(queries2.map(processFile));};var removeFiles=function removeFiles(){for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++){args[_key14]=arguments[_key14];}var queries2=Array.isArray(args[0])?args[0]:args;var options2;if(_typeof4(queries2[queries2.length-1])==="object"){options2=queries2.pop();}else if(Array.isArray(args[0])){options2=args[1];}var files=getFiles2();if(!queries2.length)return Promise.all(files.map(function(file2){return removeFile(file2,options2);}));var mappedQueries=queries2.map(function(query){return isNumber(query)?files[query]?files[query].id:null:query;}).filter(function(query){return query;});return mappedQueries.map(function(q){return removeFile(q,options2);});};var exports=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},on()),readWriteApi),createOptionAPI(store,defaultOptions2)),{},{setOptions:setOptions3,addFile:addFile,addFiles:addFiles,getFile:getFile2,processFile:processFile,prepareFile:prepareFile,removeFile:removeFile,moveFile:function moveFile(query,index2){return store.dispatch("MOVE_ITEM",{query:query,index:index2});},getFiles:getFiles2,processFiles:processFiles,removeFiles:removeFiles,prepareFiles:prepareFiles,sort:function sort(compare){return store.dispatch("SORT",{compare:compare});},browse:function browse(){var input=view.element.querySelector("input[type=file]");if(input){input.click();}},destroy:function destroy(){exports.fire("destroy",view.element);store.dispatch("ABORT_ALL");view._destroy();window.removeEventListener("resize",resizeHandler);document.removeEventListener("visibilitychange",visibilityHandler);store.dispatch("DID_DESTROY");},insertBefore:function insertBefore(element){return _insertBefore(view.element,element);},insertAfter:function insertAfter(element){return _insertAfter(view.element,element);},appendTo:function appendTo(element){return element.appendChild(view.element);},replaceElement:function replaceElement(element){_insertBefore(view.element,element);element.parentNode.removeChild(element);originalElement=element;},restoreElement:function restoreElement(){if(!originalElement){return;}_insertAfter(originalElement,view.element);view.element.parentNode.removeChild(view.element);originalElement=null;},isAttachedTo:function isAttachedTo(element){return view.element===element||originalElement===element;},element:{get:function get(){return view.element;}},status:{get:function get(){return store.query("GET_STATUS");}}});store.dispatch("DID_INIT");return createObject(exports);};var createAppObject=function createAppObject(){var customOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var defaultOptions2={};forin(getOptions(),function(key,value){defaultOptions2[key]=value[0];});var app=createApp(_objectSpread(_objectSpread({},defaultOptions2),customOptions));return app;};var lowerCaseFirstLetter=function lowerCaseFirstLetter(string){return string.charAt(0).toLowerCase()+string.slice(1);};var attributeNameToPropertyName=function attributeNameToPropertyName(attributeName){return toCamels(attributeName.replace(/^data-/,""));};var mapObject=function mapObject(object,propertyMap){forin(propertyMap,function(selector,mapping){forin(object,function(property,value){var selectorRegExp=new RegExp(selector);var matches2=selectorRegExp.test(property);if(!matches2){return;}delete object[property];if(mapping===false){return;}if(isString(mapping)){object[mapping]=value;return;}var group=mapping.group;if(isObject(mapping)&&!object[group]){object[group]={};}object[group][lowerCaseFirstLetter(property.replace(selectorRegExp,""))]=value;});if(mapping.mapping){mapObject(object[mapping.group],mapping.mapping);}});};var getAttributesAsObject=function getAttributesAsObject(node){var attributeMapping=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributes=[];forin(node.attributes,function(index2){attributes.push(node.attributes[index2]);});var output=attributes.filter(function(attribute){return attribute.name;}).reduce(function(obj,attribute){var value=attr(node,attribute.name);obj[attributeNameToPropertyName(attribute.name)]=value===attribute.name?true:value;return obj;},{});mapObject(output,attributeMapping);return output;};var createAppAtElement=function createAppAtElement(element){var options2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributeMapping={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":false,"^files$":false};applyFilters("SET_ATTRIBUTE_TO_OPTION_MAP",attributeMapping);var mergedOptions=_objectSpread({},options2);var attributeOptions=getAttributesAsObject(element.nodeName==="FIELDSET"?element.querySelector("input[type=file]"):element,attributeMapping);Object.keys(attributeOptions).forEach(function(key){if(isObject(attributeOptions[key])){if(!isObject(mergedOptions[key])){mergedOptions[key]={};}Object.assign(mergedOptions[key],attributeOptions[key]);}else{mergedOptions[key]=attributeOptions[key];}});mergedOptions.files=(options2.files||[]).concat(Array.from(element.querySelectorAll("input:not([type=file])")).map(function(input){return{source:input.value,options:{type:input.dataset.type}};}));var app=createAppObject(mergedOptions);if(element.files){Array.from(element.files).forEach(function(file2){app.addFile(file2);});}app.replaceElement(element);return app;};var createApp$1=function createApp$1(){return isNode(arguments.length<=0?undefined:arguments[0])?createAppAtElement.apply(void 0,arguments):createAppObject.apply(void 0,arguments);};var PRIVATE_METHODS=["fire","_read","_write"];var createAppAPI=function createAppAPI(app){var api={};copyObjectPropertiesToObject(app,api,PRIVATE_METHODS);return api;};var replaceInString=function replaceInString(string,replacements){return string.replace(/(?:{([a-zA-Z]+)})/g,function(match,group){return replacements[group];});};var createWorker=function createWorker(fn2){var workerBlob=new Blob(["(",fn2.toString(),")()"],{type:"application/javascript"});var workerURL=URL.createObjectURL(workerBlob);var worker=new Worker(workerURL);return{transfer:function transfer(message,cb){},post:function post(message,cb,transferList){var id=getUniqueId();worker.onmessage=function(e2){if(e2.data.id===id){cb(e2.data.message);}};worker.postMessage({id:id,message:message},transferList);},terminate:function terminate(){worker.terminate();URL.revokeObjectURL(workerURL);}};};var loadImage=function loadImage(url){return new Promise(function(resolve,reject){var img=new Image();img.onload=function(){resolve(img);};img.onerror=function(e2){reject(e2);};img.src=url;});};var renameFile=function renameFile(file2,name2){var renamedFile=file2.slice(0,file2.size,file2.type);renamedFile.lastModifiedDate=file2.lastModifiedDate;renamedFile.name=name2;return renamedFile;};var copyFile=function copyFile(file2){return renameFile(file2,file2.name);};var registeredPlugins=[];var createAppPlugin=function createAppPlugin(plugin9){if(registeredPlugins.includes(plugin9)){return;}registeredPlugins.push(plugin9);var pluginOutline=plugin9({addFilter:addFilter,utils:{Type:Type,forin:forin,isString:isString,isFile:isFile,toNaturalFileSize:toNaturalFileSize,replaceInString:replaceInString,getExtensionFromFilename:getExtensionFromFilename,getFilenameWithoutExtension:getFilenameWithoutExtension,guesstimateMimeType:guesstimateMimeType,getFileFromBlob:getFileFromBlob,getFilenameFromURL:getFilenameFromURL,createRoute:createRoute,createWorker:createWorker,createView:createView,createItemAPI:createItemAPI,loadImage:loadImage,copyFile:copyFile,renameFile:renameFile,createBlob:createBlob,applyFilterChain:applyFilterChain,text:text,getNumericAspectRatioFromString:getNumericAspectRatioFromString},views:{fileActionButton:fileActionButton}});extendDefaultOptions(pluginOutline.options);};var isOperaMini=function isOperaMini(){return Object.prototype.toString.call(window.operamini)==="[object OperaMini]";};var hasPromises=function hasPromises(){return"Promise"in window;};var hasBlobSlice=function hasBlobSlice(){return"slice"in Blob.prototype;};var hasCreateObjectURL=function hasCreateObjectURL(){return"URL"in window&&"createObjectURL"in window.URL;};var hasVisibility=function hasVisibility(){return"visibilityState"in document;};var hasTiming=function hasTiming(){return"performance"in window;};var hasCSSSupports=function hasCSSSupports(){return"supports"in(window.CSS||{});};var isIE11=function isIE11(){return /MSIE|Trident/.test(window.navigator.userAgent);};var _supported=function(){var isSupported=isBrowser()&&!isOperaMini()&&hasVisibility()&&hasPromises()&&hasBlobSlice()&&hasCreateObjectURL()&&hasTiming()&&(hasCSSSupports()||isIE11());return function(){return isSupported;};}();var state={apps:[]};var name="filepond";var fn=function fn(){};var Status$1={};var _FileStatus={};var FileOrigin$1={};var _OptionTypes={};var create$f=fn;var _destroy2=fn;var _parse=fn;var _find=fn;var _registerPlugin=fn;var getOptions$1=fn;var setOptions$1=fn;if(_supported()){createPainter(function(){state.apps.forEach(function(app){return app._read();});},function(ts){state.apps.forEach(function(app){return app._write(ts);});});var dispatch=function dispatch(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:_supported,create:create$f,destroy:_destroy2,parse:_parse,find:_find,registerPlugin:_registerPlugin,setOptions:setOptions$1}}));document.removeEventListener("DOMContentLoaded",dispatch);};if(document.readyState!=="loading"){setTimeout(function(){return dispatch();},0);}else{document.addEventListener("DOMContentLoaded",dispatch);}var updateOptionTypes=function updateOptionTypes(){return forin(getOptions(),function(key,value){_OptionTypes[key]=value[1];});};Status$1=_objectSpread({},Status);FileOrigin$1=_objectSpread({},FileOrigin);_FileStatus=_objectSpread({},ItemStatus);_OptionTypes={};updateOptionTypes();create$f=function create$f(){var app=createApp$1.apply(void 0,arguments);app.on("destroy",_destroy2);state.apps.push(app);return createAppAPI(app);};_destroy2=function _destroy2(hook){var indexToRemove=state.apps.findIndex(function(app){return app.isAttachedTo(hook);});if(indexToRemove>=0){var app=state.apps.splice(indexToRemove,1)[0];app.restoreElement();return true;}return false;};_parse=function _parse(context){var matchedHooks=Array.from(context.querySelectorAll(".".concat(name)));var newHooks=matchedHooks.filter(function(newHook){return!state.apps.find(function(app){return app.isAttachedTo(newHook);});});return newHooks.map(function(hook){return create$f(hook);});};_find=function _find(hook){var app=state.apps.find(function(app2){return app2.isAttachedTo(hook);});if(!app){return null;}return createAppAPI(app);};_registerPlugin=function _registerPlugin(){for(var _len15=arguments.length,plugins2=new Array(_len15),_key15=0;_key15<_len15;_key15++){plugins2[_key15]=arguments[_key15];}plugins2.forEach(createAppPlugin);updateOptionTypes();};getOptions$1=function getOptions$1(){var opts={};forin(getOptions(),function(key,value){opts[key]=value[0];});return opts;};setOptions$1=function setOptions$1(opts){if(isObject(opts)){state.apps.forEach(function(app){app.setOptions(opts);});setOptions(opts);}return getOptions$1();};}// node_modules/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.esm.js
/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var plugin=function plugin(_ref148){var addFilter2=_ref148.addFilter,utils=_ref148.utils;var Type2=utils.Type,replaceInString2=utils.replaceInString,toNaturalFileSize2=utils.toNaturalFileSize;addFilter2("ALLOW_HOPPER_ITEM",function(file2,_ref149){var query=_ref149.query;if(!query("GET_ALLOW_FILE_SIZE_VALIDATION")){return true;}var sizeMax=query("GET_MAX_FILE_SIZE");if(sizeMax!==null&&file2.size>sizeMax){return false;}var sizeMin=query("GET_MIN_FILE_SIZE");if(sizeMin!==null&&file2.size<sizeMin){return false;}return true;});addFilter2("LOAD_FILE",function(file2,_ref150){var query=_ref150.query;return new Promise(function(resolve,reject){if(!query("GET_ALLOW_FILE_SIZE_VALIDATION")){return resolve(file2);}var fileFilter=query("GET_FILE_VALIDATE_SIZE_FILTER");if(fileFilter&&!fileFilter(file2)){return resolve(file2);}var sizeMax=query("GET_MAX_FILE_SIZE");if(sizeMax!==null&&file2.size>sizeMax){reject({status:{main:query("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:replaceInString2(query("GET_LABEL_MAX_FILE_SIZE"),{filesize:toNaturalFileSize2(sizeMax,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return;}var sizeMin=query("GET_MIN_FILE_SIZE");if(sizeMin!==null&&file2.size<sizeMin){reject({status:{main:query("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:replaceInString2(query("GET_LABEL_MIN_FILE_SIZE"),{filesize:toNaturalFileSize2(sizeMin,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return;}var totalSizeMax=query("GET_MAX_TOTAL_FILE_SIZE");if(totalSizeMax!==null){var currentTotalSize=query("GET_ACTIVE_ITEMS").reduce(function(total,item2){return total+item2.fileSize;},0);if(currentTotalSize>totalSizeMax){reject({status:{main:query("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:replaceInString2(query("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:toNaturalFileSize2(totalSizeMax,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return;}}resolve(file2);});});return{options:{allowFileSizeValidation:[true,Type2.BOOLEAN],maxFileSize:[null,Type2.INT],minFileSize:[null,Type2.INT],maxTotalFileSize:[null,Type2.INT],fileValidateSizeFilter:[null,Type2.FUNCTION],labelMinFileSizeExceeded:["File is too small",Type2.STRING],labelMinFileSize:["Minimum file size is {filesize}",Type2.STRING],labelMaxFileSizeExceeded:["File is too large",Type2.STRING],labelMaxFileSize:["Maximum file size is {filesize}",Type2.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",Type2.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",Type2.STRING]}};};var isBrowser2=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser2){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin}));}var filepond_plugin_file_validate_size_esm_default=plugin;// node_modules/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.esm.js
/*!
 * FilePondPluginFileValidateType 1.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var plugin2=function plugin2(_ref151){var addFilter2=_ref151.addFilter,utils=_ref151.utils;var Type2=utils.Type,isString3=utils.isString,replaceInString2=utils.replaceInString,guesstimateMimeType2=utils.guesstimateMimeType,getExtensionFromFilename2=utils.getExtensionFromFilename,getFilenameFromURL2=utils.getFilenameFromURL;var mimeTypeMatchesWildCard=function mimeTypeMatchesWildCard(mimeType,wildcard){var mimeTypeGroup=(/^[^/]+/.exec(mimeType)||[]).pop();var wildcardGroup=wildcard.slice(0,-2);return mimeTypeGroup===wildcardGroup;};var isValidMimeType=function isValidMimeType(acceptedTypes,userInputType){return acceptedTypes.some(function(acceptedType){if(/\*$/.test(acceptedType)){return mimeTypeMatchesWildCard(userInputType,acceptedType);}return acceptedType===userInputType;});};var getItemType=function getItemType(item2){var type="";if(isString3(item2)){var filename=getFilenameFromURL2(item2);var extension=getExtensionFromFilename2(filename);if(extension){type=guesstimateMimeType2(extension);}}else{type=item2.type;}return type;};var validateFile=function validateFile(item2,acceptedFileTypes,typeDetector){if(acceptedFileTypes.length===0){return true;}var type=getItemType(item2);if(!typeDetector){return isValidMimeType(acceptedFileTypes,type);}return new Promise(function(resolve,reject){typeDetector(item2,type).then(function(detectedType){if(isValidMimeType(acceptedFileTypes,detectedType)){resolve();}else{reject();}})["catch"](reject);});};var applyMimeTypeMap=function applyMimeTypeMap(map2){return function(acceptedFileType){return map2[acceptedFileType]===null?false:map2[acceptedFileType]||acceptedFileType;};};addFilter2("SET_ATTRIBUTE_TO_OPTION_MAP",function(map2){return Object.assign(map2,{accept:"acceptedFileTypes"});});addFilter2("ALLOW_HOPPER_ITEM",function(file2,_ref152){var query=_ref152.query;if(!query("GET_ALLOW_FILE_TYPE_VALIDATION")){return true;}return validateFile(file2,query("GET_ACCEPTED_FILE_TYPES"));});addFilter2("LOAD_FILE",function(file2,_ref153){var query=_ref153.query;return new Promise(function(resolve,reject){if(!query("GET_ALLOW_FILE_TYPE_VALIDATION")){resolve(file2);return;}var acceptedFileTypes=query("GET_ACCEPTED_FILE_TYPES");var typeDetector=query("GET_FILE_VALIDATE_TYPE_DETECT_TYPE");var validationResult=validateFile(file2,acceptedFileTypes,typeDetector);var handleRejection=function handleRejection(){var acceptedFileTypesMapped=acceptedFileTypes.map(applyMimeTypeMap(query("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(function(label){return label!==false;});var acceptedFileTypesMapped_unique=acceptedFileTypesMapped.filter(function(item2,index2){return acceptedFileTypesMapped.indexOf(item2)===index2;});reject({status:{main:query("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:replaceInString2(query("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:acceptedFileTypesMapped_unique.join(", "),allButLastType:acceptedFileTypesMapped_unique.slice(0,-1).join(", "),lastType:acceptedFileTypesMapped_unique[acceptedFileTypesMapped.length-1]})}});};if(typeof validationResult==="boolean"){if(!validationResult){return handleRejection();}return resolve(file2);}validationResult.then(function(){resolve(file2);})["catch"](handleRejection);});});return{options:{allowFileTypeValidation:[true,Type2.BOOLEAN],acceptedFileTypes:[[],Type2.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",Type2.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",Type2.STRING],fileValidateTypeLabelExpectedTypesMap:[{},Type2.OBJECT],fileValidateTypeDetectType:[null,Type2.FUNCTION]}};};var isBrowser3=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser3){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin2}));}var filepond_plugin_file_validate_type_esm_default=plugin2;// node_modules/filepond-plugin-image-crop/dist/filepond-plugin-image-crop.esm.js
/*!
 * FilePondPluginImageCrop 2.0.6
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isImage=function isImage(file2){return /^image/.test(file2.type);};var plugin3=function plugin3(_ref154){var addFilter2=_ref154.addFilter,utils=_ref154.utils;var Type2=utils.Type,isFile2=utils.isFile,getNumericAspectRatioFromString2=utils.getNumericAspectRatioFromString;var allowCrop=function allowCrop(item2,query){return!(!isImage(item2.file)||!query("GET_ALLOW_IMAGE_CROP"));};var isObject2=function isObject2(value){return _typeof4(value)==="object";};var isNumber2=function isNumber2(value){return typeof value==="number";};var updateCrop=function updateCrop(item2,obj){return item2.setMetadata("crop",Object.assign({},item2.getMetadata("crop"),obj));};addFilter2("DID_CREATE_ITEM",function(item2,_ref155){var query=_ref155.query;item2.extend("setImageCrop",function(crop){if(!allowCrop(item2,query)||!isObject2(center))return;item2.setMetadata("crop",crop);return crop;});item2.extend("setImageCropCenter",function(center2){if(!allowCrop(item2,query)||!isObject2(center2))return;return updateCrop(item2,{center:center2});});item2.extend("setImageCropZoom",function(zoom){if(!allowCrop(item2,query)||!isNumber2(zoom))return;return updateCrop(item2,{zoom:Math.max(1,zoom)});});item2.extend("setImageCropRotation",function(rotation){if(!allowCrop(item2,query)||!isNumber2(rotation))return;return updateCrop(item2,{rotation:rotation});});item2.extend("setImageCropFlip",function(flip2){if(!allowCrop(item2,query)||!isObject2(flip2))return;return updateCrop(item2,{flip:flip2});});item2.extend("setImageCropAspectRatio",function(newAspectRatio){if(!allowCrop(item2,query)||typeof newAspectRatio==="undefined")return;var currentCrop=item2.getMetadata("crop");var aspectRatio=getNumericAspectRatioFromString2(newAspectRatio);var newCrop={center:{x:0.5,y:0.5},flip:currentCrop?Object.assign({},currentCrop.flip):{horizontal:false,vertical:false},rotation:0,zoom:1,aspectRatio:aspectRatio};item2.setMetadata("crop",newCrop);return newCrop;});});addFilter2("DID_LOAD_ITEM",function(item2,_ref156){var query=_ref156.query;return new Promise(function(resolve,reject){var file2=item2.file;if(!isFile2(file2)||!isImage(file2)||!query("GET_ALLOW_IMAGE_CROP")){return resolve(item2);}var crop=item2.getMetadata("crop");if(crop){return resolve(item2);}var humanAspectRatio=query("GET_IMAGE_CROP_ASPECT_RATIO");item2.setMetadata("crop",{center:{x:0.5,y:0.5},flip:{horizontal:false,vertical:false},rotation:0,zoom:1,aspectRatio:humanAspectRatio?getNumericAspectRatioFromString2(humanAspectRatio):null});resolve(item2);});});return{options:{allowImageCrop:[true,Type2.BOOLEAN],imageCropAspectRatio:[null,Type2.STRING]}};};var isBrowser4=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser4){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin3}));}var filepond_plugin_image_crop_esm_default=plugin3;// node_modules/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.esm.js
/*!
 * FilePondPluginImageExifOrientation 1.0.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isJPEG=function isJPEG(file2){return /^image\/jpeg/.test(file2.type);};var Marker={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280};var getUint16=function getUint16(view,offset2){var little=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return view.getUint16(offset2,little);};var getUint32=function getUint32(view,offset2){var little=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return view.getUint32(offset2,little);};var getImageOrientation=function getImageOrientation(file2){return new Promise(function(resolve,reject){var reader=new FileReader();reader.onload=function(e2){var view=new DataView(e2.target.result);if(getUint16(view,0)!==Marker.JPEG){resolve(-1);return;}var length=view.byteLength;var offset2=2;while(offset2<length){var marker=getUint16(view,offset2);offset2+=2;if(marker===Marker.APP1){if(getUint32(view,offset2+=2)!==Marker.EXIF){break;}var little=getUint16(view,offset2+=6)===Marker.TIFF;offset2+=getUint32(view,offset2+4,little);var tags=getUint16(view,offset2,little);offset2+=2;for(var i=0;i<tags;i++){if(getUint16(view,offset2+i*12,little)===Marker.Orientation){resolve(getUint16(view,offset2+i*12+8,little));return;}}}else if((marker&Marker.Unknown)!==Marker.Unknown){break;}else{offset2+=getUint16(view,offset2);}}resolve(-1);};reader.readAsArrayBuffer(file2.slice(0,64*1024));});};var IS_BROWSER2=function(){return typeof window!=="undefined"&&typeof window.document!=="undefined";}();var isBrowser5=function isBrowser5(){return IS_BROWSER2;};var testSrc="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";var shouldCorrect=void 0;var testImage=isBrowser5()?new Image():{};testImage.onload=function(){return shouldCorrect=testImage.naturalWidth>testImage.naturalHeight;};testImage.src=testSrc;var shouldCorrectImageExifOrientation=function shouldCorrectImageExifOrientation(){return shouldCorrect;};var plugin4=function plugin4(_ref157){var addFilter2=_ref157.addFilter,utils=_ref157.utils;var Type2=utils.Type,isFile2=utils.isFile;addFilter2("DID_LOAD_ITEM",function(item2,_ref158){var query=_ref158.query;return new Promise(function(resolve,reject){var file2=item2.file;if(!isFile2(file2)||!isJPEG(file2)||!query("GET_ALLOW_IMAGE_EXIF_ORIENTATION")||!shouldCorrectImageExifOrientation()){return resolve(item2);}getImageOrientation(file2).then(function(orientation){item2.setMetadata("exif",{orientation:orientation});resolve(item2);});});});return{options:{allowImageExifOrientation:[true,Type2.BOOLEAN]}};};var isBrowser$1=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser$1){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin4}));}var filepond_plugin_image_exif_orientation_esm_default=plugin4;// node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.esm.js
/*!
 * FilePondPluginImagePreview 4.6.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isPreviewableImage=function isPreviewableImage(file2){return /^image/.test(file2.type);};var vectorMultiply=function vectorMultiply(v,amount){return createVector(v.x*amount,v.y*amount);};var vectorAdd=function vectorAdd(a2,b){return createVector(a2.x+b.x,a2.y+b.y);};var vectorNormalize=function vectorNormalize(v){var l=Math.sqrt(v.x*v.x+v.y*v.y);if(l===0){return{x:0,y:0};}return createVector(v.x/l,v.y/l);};var vectorRotate=function vectorRotate(v,radians,origin){var cos=Math.cos(radians);var sin=Math.sin(radians);var t2=createVector(v.x-origin.x,v.y-origin.y);return createVector(origin.x+cos*t2.x-sin*t2.y,origin.y+sin*t2.x+cos*t2.y);};var createVector=function createVector(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return{x:x,y:y};};var getMarkupValue=function getMarkupValue(value,size2){var scalar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var axis=arguments.length>3?arguments[3]:undefined;if(typeof value==="string"){return parseFloat(value)*scalar;}if(typeof value==="number"){return value*(axis?size2[axis]:Math.min(size2.width,size2.height));}return;};var getMarkupStyles=function getMarkupStyles(markup,size2,scale){var lineStyle=markup.borderStyle||markup.lineStyle||"solid";var fill=markup.backgroundColor||markup.fontColor||"transparent";var stroke=markup.borderColor||markup.lineColor||"transparent";var strokeWidth=getMarkupValue(markup.borderWidth||markup.lineWidth,size2,scale);var lineCap=markup.lineCap||"round";var lineJoin=markup.lineJoin||"round";var dashes=typeof lineStyle==="string"?"":lineStyle.map(function(v){return getMarkupValue(v,size2,scale);}).join(",");var opacity=markup.opacity||1;return{"stroke-linecap":lineCap,"stroke-linejoin":lineJoin,"stroke-width":strokeWidth||0,"stroke-dasharray":dashes,stroke:stroke,fill:fill,opacity:opacity};};var isDefined2=function isDefined2(value){return value!=null;};var getMarkupRect=function getMarkupRect(rect,size2){var scalar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var left=getMarkupValue(rect.x,size2,scalar,"width")||getMarkupValue(rect.left,size2,scalar,"width");var top=getMarkupValue(rect.y,size2,scalar,"height")||getMarkupValue(rect.top,size2,scalar,"height");var width=getMarkupValue(rect.width,size2,scalar,"width");var height=getMarkupValue(rect.height,size2,scalar,"height");var right=getMarkupValue(rect.right,size2,scalar,"width");var bottom=getMarkupValue(rect.bottom,size2,scalar,"height");if(!isDefined2(top)){if(isDefined2(height)&&isDefined2(bottom)){top=size2.height-height-bottom;}else{top=bottom;}}if(!isDefined2(left)){if(isDefined2(width)&&isDefined2(right)){left=size2.width-width-right;}else{left=right;}}if(!isDefined2(width)){if(isDefined2(left)&&isDefined2(right)){width=size2.width-left-right;}else{width=0;}}if(!isDefined2(height)){if(isDefined2(top)&&isDefined2(bottom)){height=size2.height-top-bottom;}else{height=0;}}return{x:left||0,y:top||0,width:width||0,height:height||0};};var pointsToPathShape=function pointsToPathShape(points){return points.map(function(point,index2){return"".concat(index2===0?"M":"L"," ").concat(point.x," ").concat(point.y);}).join(" ");};var setAttributes=function setAttributes(element,attr2){return Object.keys(attr2).forEach(function(key){return element.setAttribute(key,attr2[key]);});};var ns2="http://www.w3.org/2000/svg";var svg=function svg(tag,attr2){var element=document.createElementNS(ns2,tag);if(attr2){setAttributes(element,attr2);}return element;};var updateRect2=function updateRect2(element){return setAttributes(element,_objectSpread(_objectSpread({},element.rect),element.styles));};var updateEllipse=function updateEllipse(element){var cx=element.rect.x+element.rect.width*0.5;var cy=element.rect.y+element.rect.height*0.5;var rx=element.rect.width*0.5;var ry=element.rect.height*0.5;return setAttributes(element,_objectSpread({cx:cx,cy:cy,rx:rx,ry:ry},element.styles));};var IMAGE_FIT_STYLE={contain:"xMidYMid meet",cover:"xMidYMid slice"};var updateImage=function updateImage(element,markup){setAttributes(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{preserveAspectRatio:IMAGE_FIT_STYLE[markup.fit]||"none"}));};var TEXT_ANCHOR={left:"start",center:"middle",right:"end"};var updateText=function updateText(element,markup,size2,scale){var fontSize=getMarkupValue(markup.fontSize,size2,scale);var fontFamily=markup.fontFamily||"sans-serif";var fontWeight=markup.fontWeight||"normal";var textAlign=TEXT_ANCHOR[markup.textAlign]||"start";setAttributes(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{"stroke-width":0,"font-weight":fontWeight,"font-size":fontSize,"font-family":fontFamily,"text-anchor":textAlign}));if(element.text!==markup.text){element.text=markup.text;element.textContent=markup.text.length?markup.text:" ";}};var updateLine=function updateLine(element,markup,size2,scale){setAttributes(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{fill:"none"}));var line=element.childNodes[0];var begin=element.childNodes[1];var end=element.childNodes[2];var origin=element.rect;var target={x:element.rect.x+element.rect.width,y:element.rect.y+element.rect.height};setAttributes(line,{x1:origin.x,y1:origin.y,x2:target.x,y2:target.y});if(!markup.lineDecoration)return;begin.style.display="none";end.style.display="none";var v=vectorNormalize({x:target.x-origin.x,y:target.y-origin.y});var l=getMarkupValue(0.05,size2,scale);if(markup.lineDecoration.indexOf("arrow-begin")!==-1){var arrowBeginRotationPoint=vectorMultiply(v,l);var arrowBeginCenter=vectorAdd(origin,arrowBeginRotationPoint);var arrowBeginA=vectorRotate(origin,2,arrowBeginCenter);var arrowBeginB=vectorRotate(origin,-2,arrowBeginCenter);setAttributes(begin,{style:"display:block;",d:"M".concat(arrowBeginA.x,",").concat(arrowBeginA.y," L").concat(origin.x,",").concat(origin.y," L").concat(arrowBeginB.x,",").concat(arrowBeginB.y)});}if(markup.lineDecoration.indexOf("arrow-end")!==-1){var arrowEndRotationPoint=vectorMultiply(v,-l);var arrowEndCenter=vectorAdd(target,arrowEndRotationPoint);var arrowEndA=vectorRotate(target,2,arrowEndCenter);var arrowEndB=vectorRotate(target,-2,arrowEndCenter);setAttributes(end,{style:"display:block;",d:"M".concat(arrowEndA.x,",").concat(arrowEndA.y," L").concat(target.x,",").concat(target.y," L").concat(arrowEndB.x,",").concat(arrowEndB.y)});}};var updatePath=function updatePath(element,markup,size2,scale){setAttributes(element,_objectSpread(_objectSpread({},element.styles),{},{fill:"none",d:pointsToPathShape(markup.points.map(function(point){return{x:getMarkupValue(point.x,size2,scale,"width"),y:getMarkupValue(point.y,size2,scale,"height")};}))}));};var createShape=function createShape(node){return function(markup){return svg(node,{id:markup.id});};};var createImage=function createImage(markup){var shape=svg("image",{id:markup.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});shape.onload=function(){shape.setAttribute("opacity",markup.opacity||1);};shape.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",markup.src);return shape;};var createLine=function createLine(markup){var shape=svg("g",{id:markup.id,"stroke-linecap":"round","stroke-linejoin":"round"});var line=svg("line");shape.appendChild(line);var begin=svg("path");shape.appendChild(begin);var end=svg("path");shape.appendChild(end);return shape;};var CREATE_TYPE_ROUTES={image:createImage,rect:createShape("rect"),ellipse:createShape("ellipse"),text:createShape("text"),path:createShape("path"),line:createLine};var UPDATE_TYPE_ROUTES={rect:updateRect2,ellipse:updateEllipse,image:updateImage,text:updateText,path:updatePath,line:updateLine};var createMarkupByType=function createMarkupByType(type,markup){return CREATE_TYPE_ROUTES[type](markup);};var updateMarkupByType=function updateMarkupByType(element,type,markup,size2,scale){if(type!=="path"){element.rect=getMarkupRect(markup,size2,scale);}element.styles=getMarkupStyles(markup,size2,scale);UPDATE_TYPE_ROUTES[type](element,markup,size2,scale);};var MARKUP_RECT=["x","y","left","top","right","bottom","width","height"];var toOptionalFraction=function toOptionalFraction(value){return typeof value==="string"&&/%/.test(value)?parseFloat(value)/100:value;};var prepareMarkup=function prepareMarkup(markup){var _markup=_slicedToArray(markup,2),type=_markup[0],props=_markup[1];var rect=props.points?{}:MARKUP_RECT.reduce(function(prev,curr){prev[curr]=toOptionalFraction(props[curr]);return prev;},{});return[type,_objectSpread(_objectSpread({zIndex:0},props),rect)];};var sortMarkupByZIndex=function sortMarkupByZIndex(a2,b){if(a2[1].zIndex>b[1].zIndex){return 1;}if(a2[1].zIndex<b[1].zIndex){return-1;}return 0;};var createMarkupView=function createMarkupView(_){return _.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:true,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:function write(_ref159){var root2=_ref159.root,props=_ref159.props;if(!props.dirty)return;var crop=props.crop,resize=props.resize,markup=props.markup;var viewWidth=props.width;var viewHeight=props.height;var cropWidth=crop.width;var cropHeight=crop.height;if(resize){var size3=resize.size;var outputWidth=size3&&size3.width;var outputHeight=size3&&size3.height;var outputFit=resize.mode;var outputUpscale=resize.upscale;if(outputWidth&&!outputHeight)outputHeight=outputWidth;if(outputHeight&&!outputWidth)outputWidth=outputHeight;var shouldUpscale=cropWidth<outputWidth&&cropHeight<outputHeight;if(!shouldUpscale||shouldUpscale&&outputUpscale){var scalarWidth=outputWidth/cropWidth;var scalarHeight=outputHeight/cropHeight;if(outputFit==="force"){cropWidth=outputWidth;cropHeight=outputHeight;}else{var scalar;if(outputFit==="cover"){scalar=Math.max(scalarWidth,scalarHeight);}else if(outputFit==="contain"){scalar=Math.min(scalarWidth,scalarHeight);}cropWidth=cropWidth*scalar;cropHeight=cropHeight*scalar;}}}var size2={width:viewWidth,height:viewHeight};root2.element.setAttribute("width",size2.width);root2.element.setAttribute("height",size2.height);var scale=Math.min(viewWidth/cropWidth,viewHeight/cropHeight);root2.element.innerHTML="";var markupFilter=root2.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");markup.filter(markupFilter).map(prepareMarkup).sort(sortMarkupByZIndex).forEach(function(markup2){var _markup2=_slicedToArray(markup2,2),type=_markup2[0],settings=_markup2[1];var element=createMarkupByType(type,settings);updateMarkupByType(element,type,settings,size2,scale);root2.element.appendChild(element);});}});};var createVector$1=function createVector$1(x,y){return{x:x,y:y};};var vectorDot=function vectorDot(a2,b){return a2.x*b.x+a2.y*b.y;};var vectorSubtract=function vectorSubtract(a2,b){return createVector$1(a2.x-b.x,a2.y-b.y);};var vectorDistanceSquared=function vectorDistanceSquared(a2,b){return vectorDot(vectorSubtract(a2,b),vectorSubtract(a2,b));};var vectorDistance=function vectorDistance(a2,b){return Math.sqrt(vectorDistanceSquared(a2,b));};var getOffsetPointOnEdge=function getOffsetPointOnEdge(length,rotation){var a2=length;var A=1.5707963267948966;var B=rotation;var C3=1.5707963267948966-rotation;var sinA=Math.sin(A);var sinB=Math.sin(B);var sinC=Math.sin(C3);var cosC=Math.cos(C3);var ratio=a2/sinA;var b=ratio*sinB;var c2=ratio*sinC;return createVector$1(cosC*b,cosC*c2);};var getRotatedRectSize=function getRotatedRectSize(rect,rotation){var w=rect.width;var h=rect.height;var hor=getOffsetPointOnEdge(w,rotation);var ver=getOffsetPointOnEdge(h,rotation);var tl=createVector$1(rect.x+Math.abs(hor.x),rect.y-Math.abs(hor.y));var tr=createVector$1(rect.x+rect.width+Math.abs(ver.y),rect.y+Math.abs(ver.x));var bl=createVector$1(rect.x-Math.abs(ver.y),rect.y+rect.height-Math.abs(ver.x));return{width:vectorDistance(tl,tr),height:vectorDistance(tl,bl)};};var calculateCanvasSize=function calculateCanvasSize(image,canvasAspectRatio){var zoom=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var imageAspectRatio=image.height/image.width;var canvasWidth=1;var canvasHeight=canvasAspectRatio;var imgWidth=1;var imgHeight=imageAspectRatio;if(imgHeight>canvasHeight){imgHeight=canvasHeight;imgWidth=imgHeight/imageAspectRatio;}var scalar=Math.max(canvasWidth/imgWidth,canvasHeight/imgHeight);var width=image.width/(zoom*scalar*imgWidth);var height=width*canvasAspectRatio;return{width:width,height:height};};var getImageRectZoomFactor=function getImageRectZoomFactor(imageRect,cropRect,rotation,center2){var cx=center2.x>0.5?1-center2.x:center2.x;var cy=center2.y>0.5?1-center2.y:center2.y;var imageWidth=cx*2*imageRect.width;var imageHeight=cy*2*imageRect.height;var rotatedCropSize=getRotatedRectSize(cropRect,rotation);return Math.max(rotatedCropSize.width/imageWidth,rotatedCropSize.height/imageHeight);};var getCenteredCropRect=function getCenteredCropRect(container,aspectRatio){var width=container.width;var height=width*aspectRatio;if(height>container.height){height=container.height;width=height/aspectRatio;}var x=(container.width-width)*0.5;var y=(container.height-height)*0.5;return{x:x,y:y,width:width,height:height};};var getCurrentCropSize=function getCurrentCropSize(imageSize){var crop=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var zoom=crop.zoom,rotation=crop.rotation,center2=crop.center,aspectRatio=crop.aspectRatio;if(!aspectRatio)aspectRatio=imageSize.height/imageSize.width;var canvasSize=calculateCanvasSize(imageSize,aspectRatio,zoom);var canvasCenter={x:canvasSize.width*0.5,y:canvasSize.height*0.5};var stage={x:0,y:0,width:canvasSize.width,height:canvasSize.height,center:canvasCenter};var shouldLimit=typeof crop.scaleToFit==="undefined"||crop.scaleToFit;var stageZoomFactor=getImageRectZoomFactor(imageSize,getCenteredCropRect(stage,aspectRatio),rotation,shouldLimit?center2:{x:0.5,y:0.5});var scale=zoom*stageZoomFactor;return{widthFloat:canvasSize.width/scale,heightFloat:canvasSize.height/scale,width:Math.round(canvasSize.width/scale),height:Math.round(canvasSize.height/scale)};};var IMAGE_SCALE_SPRING_PROPS={type:"spring",stiffness:0.5,damping:0.45,mass:10};var createBitmapView=function createBitmapView(_){return _.utils.createView({name:"image-bitmap",ignoreRect:true,mixins:{styles:["scaleX","scaleY"]},create:function create(_ref160){var root2=_ref160.root,props=_ref160.props;root2.appendChild(props.image);}});};var createImageCanvasWrapper=function createImageCanvasWrapper(_){return _.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:true,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:IMAGE_SCALE_SPRING_PROPS,originY:IMAGE_SCALE_SPRING_PROPS,scaleX:IMAGE_SCALE_SPRING_PROPS,scaleY:IMAGE_SCALE_SPRING_PROPS,translateX:IMAGE_SCALE_SPRING_PROPS,translateY:IMAGE_SCALE_SPRING_PROPS,rotateZ:IMAGE_SCALE_SPRING_PROPS}},create:function create(_ref161){var root2=_ref161.root,props=_ref161.props;props.width=props.image.width;props.height=props.image.height;root2.ref.bitmap=root2.appendChildView(root2.createChildView(createBitmapView(_),{image:props.image}));},write:function write(_ref162){var root2=_ref162.root,props=_ref162.props;var flip2=props.crop.flip;var bitmap=root2.ref.bitmap;bitmap.scaleX=flip2.horizontal?-1:1;bitmap.scaleY=flip2.vertical?-1:1;}});};var createClipView=function createClipView(_){return _.utils.createView({name:"image-clip",tag:"div",ignoreRect:true,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function didWriteView(_ref163){var root2=_ref163.root,props=_ref163.props;if(!props.background)return;root2.element.style.backgroundColor=props.background;},create:function create(_ref164){var root2=_ref164.root,props=_ref164.props;root2.ref.image=root2.appendChildView(root2.createChildView(createImageCanvasWrapper(_),Object.assign({},props)));root2.ref.createMarkup=function(){if(root2.ref.markup)return;root2.ref.markup=root2.appendChildView(root2.createChildView(createMarkupView(_),Object.assign({},props)));};root2.ref.destroyMarkup=function(){if(!root2.ref.markup)return;root2.removeChildView(root2.ref.markup);root2.ref.markup=null;};var transparencyIndicator=root2.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");if(transparencyIndicator===null)return;if(transparencyIndicator==="grid"){root2.element.dataset.transparencyIndicator=transparencyIndicator;}else{root2.element.dataset.transparencyIndicator="color";}},write:function write(_ref165){var root2=_ref165.root,props=_ref165.props,shouldOptimize=_ref165.shouldOptimize;var crop=props.crop,markup=props.markup,resize=props.resize,dirty=props.dirty,width=props.width,height=props.height;root2.ref.image.crop=crop;var stage={x:0,y:0,width:width,height:height,center:{x:width*0.5,y:height*0.5}};var image={width:root2.ref.image.width,height:root2.ref.image.height};var origin={x:crop.center.x*image.width,y:crop.center.y*image.height};var translation={x:stage.center.x-image.width*crop.center.x,y:stage.center.y-image.height*crop.center.y};var rotation=Math.PI*2+crop.rotation%(Math.PI*2);var cropAspectRatio=crop.aspectRatio||image.height/image.width;var shouldLimit=typeof crop.scaleToFit==="undefined"||crop.scaleToFit;var stageZoomFactor=getImageRectZoomFactor(image,getCenteredCropRect(stage,cropAspectRatio),rotation,shouldLimit?crop.center:{x:0.5,y:0.5});var scale=crop.zoom*stageZoomFactor;if(markup&&markup.length){root2.ref.createMarkup();root2.ref.markup.width=width;root2.ref.markup.height=height;root2.ref.markup.resize=resize;root2.ref.markup.dirty=dirty;root2.ref.markup.markup=markup;root2.ref.markup.crop=getCurrentCropSize(image,crop);}else if(root2.ref.markup){root2.ref.destroyMarkup();}var imageView=root2.ref.image;if(shouldOptimize){imageView.originX=null;imageView.originY=null;imageView.translateX=null;imageView.translateY=null;imageView.rotateZ=null;imageView.scaleX=null;imageView.scaleY=null;return;}imageView.originX=origin.x;imageView.originY=origin.y;imageView.translateX=translation.x;imageView.translateY=translation.y;imageView.rotateZ=rotation;imageView.scaleX=scale;imageView.scaleY=scale;}});};var createImageView=function createImageView(_){return _.utils.createView({name:"image-preview",tag:"div",ignoreRect:true,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:IMAGE_SCALE_SPRING_PROPS,scaleY:IMAGE_SCALE_SPRING_PROPS,translateY:IMAGE_SCALE_SPRING_PROPS,opacity:{type:"tween",duration:400}}},create:function create(_ref166){var root2=_ref166.root,props=_ref166.props;root2.ref.clip=root2.appendChildView(root2.createChildView(createClipView(_),{id:props.id,image:props.image,crop:props.crop,markup:props.markup,resize:props.resize,dirty:props.dirty,background:props.background}));},write:function write(_ref167){var root2=_ref167.root,props=_ref167.props,shouldOptimize=_ref167.shouldOptimize;var clip=root2.ref.clip;var image=props.image,crop=props.crop,markup=props.markup,resize=props.resize,dirty=props.dirty;clip.crop=crop;clip.markup=markup;clip.resize=resize;clip.dirty=dirty;clip.opacity=shouldOptimize?0:1;if(shouldOptimize||root2.rect.element.hidden)return;var imageAspectRatio=image.height/image.width;var aspectRatio=crop.aspectRatio||imageAspectRatio;var containerWidth=root2.rect.inner.width;var containerHeight=root2.rect.inner.height;var fixedPreviewHeight=root2.query("GET_IMAGE_PREVIEW_HEIGHT");var minPreviewHeight=root2.query("GET_IMAGE_PREVIEW_MIN_HEIGHT");var maxPreviewHeight=root2.query("GET_IMAGE_PREVIEW_MAX_HEIGHT");var panelAspectRatio=root2.query("GET_PANEL_ASPECT_RATIO");var allowMultiple=root2.query("GET_ALLOW_MULTIPLE");if(panelAspectRatio&&!allowMultiple){fixedPreviewHeight=containerWidth*panelAspectRatio;aspectRatio=panelAspectRatio;}var clipHeight=fixedPreviewHeight!==null?fixedPreviewHeight:Math.max(minPreviewHeight,Math.min(containerWidth*aspectRatio,maxPreviewHeight));var clipWidth=clipHeight/aspectRatio;if(clipWidth>containerWidth){clipWidth=containerWidth;clipHeight=clipWidth*aspectRatio;}if(clipHeight>containerHeight){clipHeight=containerHeight;clipWidth=containerHeight/aspectRatio;}clip.width=clipWidth;clip.height=clipHeight;}});};var SVG_MASK="<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\n    <defs>\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\n            <stop offset='50%' stop-color='#000000'/>\n            <stop offset='56%' stop-color='#0a0a0a'/>\n            <stop offset='63%' stop-color='#262626'/>\n            <stop offset='69%' stop-color='#4f4f4f'/>\n            <stop offset='75%' stop-color='#808080'/>\n            <stop offset='81%' stop-color='#b1b1b1'/>\n            <stop offset='88%' stop-color='#dadada'/>\n            <stop offset='94%' stop-color='#f6f6f6'/>\n            <stop offset='100%' stop-color='#ffffff'/>\n        </radialGradient>\n        <mask id=\"mask-__UID__\">\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\n        </mask>\n    </defs>\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\n</svg>";var SVGMaskUniqueId=0;var createImageOverlayView=function createImageOverlayView(fpAPI){return fpAPI.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:true,create:function create(_ref168){var root2=_ref168.root,props=_ref168.props;var mask=SVG_MASK;if(document.querySelector("base")){var url=new URL(window.location.href.replace(window.location.hash,"")).href;mask=mask.replace(/url\(\#/g,"url("+url+"#");}SVGMaskUniqueId++;root2.element.classList.add("filepond--image-preview-overlay-".concat(props.status));root2.element.innerHTML=mask.replace(/__UID__/g,SVGMaskUniqueId);},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}});};var BitmapWorker=function BitmapWorker(){self.onmessage=function(e2){createImageBitmap(e2.data.message.file).then(function(bitmap){self.postMessage({id:e2.data.id,message:bitmap},[bitmap]);});};};var ColorMatrixWorker=function ColorMatrixWorker(){self.onmessage=function(e2){var imageData=e2.data.message.imageData;var matrix2=e2.data.message.colorMatrix;var data3=imageData.data;var l=data3.length;var m11=matrix2[0];var m12=matrix2[1];var m13=matrix2[2];var m14=matrix2[3];var m15=matrix2[4];var m21=matrix2[5];var m22=matrix2[6];var m23=matrix2[7];var m24=matrix2[8];var m25=matrix2[9];var m31=matrix2[10];var m32=matrix2[11];var m33=matrix2[12];var m34=matrix2[13];var m35=matrix2[14];var m41=matrix2[15];var m42=matrix2[16];var m43=matrix2[17];var m44=matrix2[18];var m45=matrix2[19];var index2=0,r2=0,g=0,b=0,a2=0;for(;index2<l;index2+=4){r2=data3[index2]/255;g=data3[index2+1]/255;b=data3[index2+2]/255;a2=data3[index2+3]/255;data3[index2]=Math.max(0,Math.min((r2*m11+g*m12+b*m13+a2*m14+m15)*255,255));data3[index2+1]=Math.max(0,Math.min((r2*m21+g*m22+b*m23+a2*m24+m25)*255,255));data3[index2+2]=Math.max(0,Math.min((r2*m31+g*m32+b*m33+a2*m34+m35)*255,255));data3[index2+3]=Math.max(0,Math.min((r2*m41+g*m42+b*m43+a2*m44+m45)*255,255));}self.postMessage({id:e2.data.id,message:imageData},[imageData.data.buffer]);};};var getImageSize=function getImageSize(url,cb){var image=new Image();image.onload=function(){var width=image.naturalWidth;var height=image.naturalHeight;image=null;cb(width,height);};image.src=url;};var transforms={1:function _(){return[1,0,0,1,0,0];},2:function _(width){return[-1,0,0,1,width,0];},3:function _(width,height){return[-1,0,0,-1,width,height];},4:function _(width,height){return[1,0,0,-1,0,height];},5:function _(){return[0,1,1,0,0,0];},6:function _(width,height){return[0,1,-1,0,height,0];},7:function _(width,height){return[0,-1,-1,0,height,width];},8:function _(width){return[0,-1,1,0,0,width];}};var fixImageOrientation=function fixImageOrientation(ctx,width,height,orientation){if(orientation===-1){return;}ctx.transform.apply(ctx,transforms[orientation](width,height));};var createPreviewImage=function createPreviewImage(data3,width,height,orientation){width=Math.round(width);height=Math.round(height);var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;var ctx=canvas.getContext("2d");if(orientation>=5&&orientation<=8){var _ref169=[height,width];width=_ref169[0];height=_ref169[1];}fixImageOrientation(ctx,width,height,orientation);ctx.drawImage(data3,0,0,width,height);return canvas;};var isBitmap=function isBitmap(file2){return /^image/.test(file2.type)&&!/svg/.test(file2.type);};var MAX_WIDTH=10;var MAX_HEIGHT=10;var calculateAverageColor=function calculateAverageColor(image){var scalar=Math.min(MAX_WIDTH/image.width,MAX_HEIGHT/image.height);var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");var width=canvas.width=Math.ceil(image.width*scalar);var height=canvas.height=Math.ceil(image.height*scalar);ctx.drawImage(image,0,0,width,height);var data3=null;try{data3=ctx.getImageData(0,0,width,height).data;}catch(e2){return null;}var l=data3.length;var r2=0;var g=0;var b=0;var i=0;for(;i<l;i+=4){r2+=data3[i]*data3[i];g+=data3[i+1]*data3[i+1];b+=data3[i+2]*data3[i+2];}r2=averageColor(r2,l);g=averageColor(g,l);b=averageColor(b,l);return{r:r2,g:g,b:b};};var averageColor=function averageColor(c2,l){return Math.floor(Math.sqrt(c2/(l/4)));};var cloneCanvas=function cloneCanvas(origin,target){target=target||document.createElement("canvas");target.width=origin.width;target.height=origin.height;var ctx=target.getContext("2d");ctx.drawImage(origin,0,0);return target;};var cloneImageData=function cloneImageData(imageData){var id;try{id=new ImageData(imageData.width,imageData.height);}catch(e2){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");id=ctx.createImageData(imageData.width,imageData.height);}id.data.set(new Uint8ClampedArray(imageData.data));return id;};var loadImage2=function loadImage2(url){return new Promise(function(resolve,reject){var img=new Image();img.crossOrigin="Anonymous";img.onload=function(){resolve(img);};img.onerror=function(e2){reject(e2);};img.src=url;});};var createImageWrapperView=function createImageWrapperView(_){var OverlayView=createImageOverlayView(_);var ImageView=createImageView(_);var createWorker3=_.utils.createWorker;var applyFilter=function applyFilter(root2,filter,target){return new Promise(function(resolve){if(!root2.ref.imageData){root2.ref.imageData=target.getContext("2d").getImageData(0,0,target.width,target.height);}var imageData=cloneImageData(root2.ref.imageData);if(!filter||filter.length!==20){target.getContext("2d").putImageData(imageData,0,0);return resolve();}var worker=createWorker3(ColorMatrixWorker);worker.post({imageData:imageData,colorMatrix:filter},function(response){target.getContext("2d").putImageData(response,0,0);worker.terminate();resolve();},[imageData.data.buffer]);});};var removeImageView=function removeImageView(root2,imageView){root2.removeChildView(imageView);imageView.image.width=1;imageView.image.height=1;imageView._destroy();};var shiftImage=function shiftImage(_ref170){var root2=_ref170.root;var imageView=root2.ref.images.shift();imageView.opacity=0;imageView.translateY=-15;root2.ref.imageViewBin.push(imageView);return imageView;};var pushImage=function pushImage(_ref171){var root2=_ref171.root,props=_ref171.props,image=_ref171.image;var id=props.id;var item2=root2.query("GET_ITEM",{id:id});if(!item2)return;var crop=item2.getMetadata("crop")||{center:{x:0.5,y:0.5},flip:{horizontal:false,vertical:false},zoom:1,rotation:0,aspectRatio:null};var background=root2.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");var markup;var resize;var dirty=false;if(root2.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")){markup=item2.getMetadata("markup")||[];resize=item2.getMetadata("resize");dirty=true;}var imageView=root2.appendChildView(root2.createChildView(ImageView,{id:id,image:image,crop:crop,resize:resize,markup:markup,dirty:dirty,background:background,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),root2.childViews.length);root2.ref.images.push(imageView);imageView.opacity=1;imageView.scaleX=1;imageView.scaleY=1;imageView.translateY=0;setTimeout(function(){root2.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:id});},250);};var updateImage3=function updateImage3(_ref172){var root2=_ref172.root,props=_ref172.props;var item2=root2.query("GET_ITEM",{id:props.id});if(!item2)return;var imageView=root2.ref.images[root2.ref.images.length-1];imageView.crop=item2.getMetadata("crop");imageView.background=root2.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");if(root2.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")){imageView.dirty=true;imageView.resize=item2.getMetadata("resize");imageView.markup=item2.getMetadata("markup");}};var didUpdateItemMetadata=function didUpdateItemMetadata(_ref173){var root2=_ref173.root,props=_ref173.props,action=_ref173.action;if(!/crop|filter|markup|resize/.test(action.change.key))return;if(!root2.ref.images.length)return;var item2=root2.query("GET_ITEM",{id:props.id});if(!item2)return;if(/filter/.test(action.change.key)){var imageView=root2.ref.images[root2.ref.images.length-1];applyFilter(root2,action.change.value,imageView.image);return;}if(/crop|markup|resize/.test(action.change.key)){var crop=item2.getMetadata("crop");var image=root2.ref.images[root2.ref.images.length-1];if(crop&&crop.aspectRatio&&image.crop&&image.crop.aspectRatio&&Math.abs(crop.aspectRatio-image.crop.aspectRatio)>1e-5){var _imageView=shiftImage({root:root2});pushImage({root:root2,props:props,image:cloneCanvas(_imageView.image)});}else{updateImage3({root:root2,props:props});}}};var canCreateImageBitmap=function canCreateImageBitmap(file2){var userAgent2=window.navigator.userAgent;var isFirefox=userAgent2.match(/Firefox\/([0-9]+)\./);var firefoxVersion=isFirefox?parseInt(isFirefox[1]):null;if(firefoxVersion<=58)return false;return"createImageBitmap"in window&&isBitmap(file2);};var didCreatePreviewContainer=function didCreatePreviewContainer(_ref174){var root2=_ref174.root,props=_ref174.props;var id=props.id;var item2=root2.query("GET_ITEM",id);if(!item2)return;var fileURL=URL.createObjectURL(item2.file);getImageSize(fileURL,function(width,height){root2.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:id,width:width,height:height});});};var drawPreview=function drawPreview(_ref175){var root2=_ref175.root,props=_ref175.props;var id=props.id;var item2=root2.query("GET_ITEM",id);if(!item2)return;var fileURL=URL.createObjectURL(item2.file);var loadPreviewFallback=function loadPreviewFallback(){loadImage2(fileURL).then(previewImageLoaded);};var previewImageLoaded=function previewImageLoaded(imageData){URL.revokeObjectURL(fileURL);var exif=item2.getMetadata("exif")||{};var orientation=exif.orientation||-1;var width=imageData.width,height=imageData.height;if(!width||!height)return;if(orientation>=5&&orientation<=8){var _ref176=[height,width];width=_ref176[0];height=_ref176[1];}var pixelDensityFactor=Math.max(1,window.devicePixelRatio*0.75);var zoomFactor=root2.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR");var scaleFactor=zoomFactor*pixelDensityFactor;var previewImageRatio=height/width;var previewContainerWidth=root2.rect.element.width;var previewContainerHeight=root2.rect.element.height;var imageWidth=previewContainerWidth;var imageHeight=imageWidth*previewImageRatio;if(previewImageRatio>1){imageWidth=Math.min(width,previewContainerWidth*scaleFactor);imageHeight=imageWidth*previewImageRatio;}else{imageHeight=Math.min(height,previewContainerHeight*scaleFactor);imageWidth=imageHeight/previewImageRatio;}var previewImage=createPreviewImage(imageData,imageWidth,imageHeight,orientation);var done=function done(){var averageColor2=root2.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?calculateAverageColor(data):null;item2.setMetadata("color",averageColor2,true);if("close"in imageData){imageData.close();}root2.ref.overlayShadow.opacity=1;pushImage({root:root2,props:props,image:previewImage});};var filter=item2.getMetadata("filter");if(filter){applyFilter(root2,filter,previewImage).then(done);}else{done();}};if(canCreateImageBitmap(item2.file)){var worker=createWorker3(BitmapWorker);worker.post({file:item2.file},function(imageBitmap){worker.terminate();if(!imageBitmap){loadPreviewFallback();return;}previewImageLoaded(imageBitmap);});}else{loadPreviewFallback();}};var didDrawPreview=function didDrawPreview(_ref177){var root2=_ref177.root;var image=root2.ref.images[root2.ref.images.length-1];image.translateY=0;image.scaleX=1;image.scaleY=1;image.opacity=1;};var restoreOverlay=function restoreOverlay(_ref178){var root2=_ref178.root;root2.ref.overlayShadow.opacity=1;root2.ref.overlayError.opacity=0;root2.ref.overlaySuccess.opacity=0;};var didThrowError=function didThrowError(_ref179){var root2=_ref179.root;root2.ref.overlayShadow.opacity=0.25;root2.ref.overlayError.opacity=1;};var didCompleteProcessing=function didCompleteProcessing(_ref180){var root2=_ref180.root;root2.ref.overlayShadow.opacity=0.25;root2.ref.overlaySuccess.opacity=1;};var create3=function create3(_ref181){var root2=_ref181.root;root2.ref.images=[];root2.ref.imageData=null;root2.ref.imageViewBin=[];root2.ref.overlayShadow=root2.appendChildView(root2.createChildView(OverlayView,{opacity:0,status:"idle"}));root2.ref.overlaySuccess=root2.appendChildView(root2.createChildView(OverlayView,{opacity:0,status:"success"}));root2.ref.overlayError=root2.appendChildView(root2.createChildView(OverlayView,{opacity:0,status:"failure"}));};return _.utils.createView({name:"image-preview-wrapper",create:create3,styles:["height"],apis:["height"],destroy:function destroy(_ref182){var root2=_ref182.root;root2.ref.images.forEach(function(imageView){imageView.image.width=1;imageView.image.height=1;});},didWriteView:function didWriteView(_ref183){var root2=_ref183.root;root2.ref.images.forEach(function(imageView){imageView.dirty=false;});},write:_.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:didDrawPreview,DID_IMAGE_PREVIEW_CONTAINER_CREATE:didCreatePreviewContainer,DID_FINISH_CALCULATE_PREVIEWSIZE:drawPreview,DID_UPDATE_ITEM_METADATA:didUpdateItemMetadata,DID_THROW_ITEM_LOAD_ERROR:didThrowError,DID_THROW_ITEM_PROCESSING_ERROR:didThrowError,DID_THROW_ITEM_INVALID:didThrowError,DID_COMPLETE_ITEM_PROCESSING:didCompleteProcessing,DID_START_ITEM_PROCESSING:restoreOverlay,DID_REVERT_ITEM_PROCESSING:restoreOverlay},function(_ref184){var root2=_ref184.root;var viewsToRemove=root2.ref.imageViewBin.filter(function(imageView){return imageView.opacity===0;});root2.ref.imageViewBin=root2.ref.imageViewBin.filter(function(imageView){return imageView.opacity>0;});viewsToRemove.forEach(function(imageView){return removeImageView(root2,imageView);});viewsToRemove.length=0;})});};var plugin5=function plugin5(fpAPI){var addFilter2=fpAPI.addFilter,utils=fpAPI.utils;var Type2=utils.Type,createRoute2=utils.createRoute,isFile2=utils.isFile;var imagePreviewView=createImageWrapperView(fpAPI);addFilter2("CREATE_VIEW",function(viewAPI){var is2=viewAPI.is,view=viewAPI.view,query=viewAPI.query;if(!is2("file")||!query("GET_ALLOW_IMAGE_PREVIEW"))return;var didLoadItem2=function didLoadItem2(_ref185){var root2=_ref185.root,props=_ref185.props;var id=props.id;var item2=query("GET_ITEM",id);if(!item2||!isFile2(item2.file)||item2.archived)return;var file2=item2.file;if(!isPreviewableImage(file2))return;if(!query("GET_IMAGE_PREVIEW_FILTER_ITEM")(item2))return;var supportsCreateImageBitmap=("createImageBitmap"in(window||{}));var maxPreviewFileSize=query("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!supportsCreateImageBitmap&&maxPreviewFileSize&&file2.size>maxPreviewFileSize)return;root2.ref.imagePreview=view.appendChildView(view.createChildView(imagePreviewView,{id:id}));var fixedPreviewHeight=root2.query("GET_IMAGE_PREVIEW_HEIGHT");if(fixedPreviewHeight){root2.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:item2.id,height:fixedPreviewHeight});}var queue=!supportsCreateImageBitmap&&file2.size>query("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");root2.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:id},queue);};var rescaleItem=function rescaleItem(root2,props){if(!root2.ref.imagePreview)return;var id=props.id;var item2=root2.query("GET_ITEM",{id:id});if(!item2)return;var panelAspectRatio=root2.query("GET_PANEL_ASPECT_RATIO");var itemPanelAspectRatio=root2.query("GET_ITEM_PANEL_ASPECT_RATIO");var fixedHeight=root2.query("GET_IMAGE_PREVIEW_HEIGHT");if(panelAspectRatio||itemPanelAspectRatio||fixedHeight)return;var _root2$ref2=root2.ref,imageWidth=_root2$ref2.imageWidth,imageHeight=_root2$ref2.imageHeight;if(!imageWidth||!imageHeight)return;var minPreviewHeight=root2.query("GET_IMAGE_PREVIEW_MIN_HEIGHT");var maxPreviewHeight=root2.query("GET_IMAGE_PREVIEW_MAX_HEIGHT");var exif=item2.getMetadata("exif")||{};var orientation=exif.orientation||-1;if(orientation>=5&&orientation<=8){var _ref186=[imageHeight,imageWidth];imageWidth=_ref186[0];imageHeight=_ref186[1];}if(!isBitmap(item2.file)||root2.query("GET_IMAGE_PREVIEW_UPSCALE")){var scalar=2048/imageWidth;imageWidth*=scalar;imageHeight*=scalar;}var imageAspectRatio=imageHeight/imageWidth;var previewAspectRatio=(item2.getMetadata("crop")||{}).aspectRatio||imageAspectRatio;var previewHeightMax=Math.max(minPreviewHeight,Math.min(imageHeight,maxPreviewHeight));var itemWidth=root2.rect.element.width;var previewHeight=Math.min(itemWidth*previewAspectRatio,previewHeightMax);root2.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:item2.id,height:previewHeight});};var didResizeView=function didResizeView(_ref187){var root2=_ref187.root;root2.ref.shouldRescale=true;};var didUpdateItemMetadata=function didUpdateItemMetadata(_ref188){var root2=_ref188.root,action=_ref188.action;if(action.change.key!=="crop")return;root2.ref.shouldRescale=true;};var didCalculatePreviewSize=function didCalculatePreviewSize(_ref189){var root2=_ref189.root,action=_ref189.action;root2.ref.imageWidth=action.width;root2.ref.imageHeight=action.height;root2.ref.shouldRescale=true;root2.ref.shouldDrawPreview=true;root2.dispatch("KICK");};view.registerWriter(createRoute2({DID_RESIZE_ROOT:didResizeView,DID_STOP_RESIZE:didResizeView,DID_LOAD_ITEM:didLoadItem2,DID_IMAGE_PREVIEW_CALCULATE_SIZE:didCalculatePreviewSize,DID_UPDATE_ITEM_METADATA:didUpdateItemMetadata},function(_ref190){var root2=_ref190.root,props=_ref190.props;if(!root2.ref.imagePreview)return;if(root2.rect.element.hidden)return;if(root2.ref.shouldRescale){rescaleItem(root2,props);root2.ref.shouldRescale=false;}if(root2.ref.shouldDrawPreview){requestAnimationFrame(function(){requestAnimationFrame(function(){root2.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:props.id});});});root2.ref.shouldDrawPreview=false;}}));});return{options:{allowImagePreview:[true,Type2.BOOLEAN],imagePreviewFilterItem:[function(){return true;},Type2.FUNCTION],imagePreviewHeight:[null,Type2.INT],imagePreviewMinHeight:[44,Type2.INT],imagePreviewMaxHeight:[256,Type2.INT],imagePreviewMaxFileSize:[null,Type2.INT],imagePreviewZoomFactor:[2,Type2.INT],imagePreviewUpscale:[false,Type2.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,Type2.INT],imagePreviewTransparencyIndicator:[null,Type2.STRING],imagePreviewCalculateAverageImageColor:[false,Type2.BOOLEAN],imagePreviewMarkupShow:[true,Type2.BOOLEAN],imagePreviewMarkupFilter:[function(){return true;},Type2.FUNCTION]}};};var isBrowser6=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser6){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin5}));}var filepond_plugin_image_preview_esm_default=plugin5;// node_modules/filepond-plugin-image-resize/dist/filepond-plugin-image-resize.esm.js
/*!
 * FilePondPluginImageResize 2.0.10
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isImage2=function isImage2(file2){return /^image/.test(file2.type);};var getImageSize2=function getImageSize2(url,cb){var image=new Image();image.onload=function(){var width=image.naturalWidth;var height=image.naturalHeight;image=null;cb({width:width,height:height});};image.onerror=function(){return cb(null);};image.src=url;};var plugin6=function plugin6(_ref191){var addFilter2=_ref191.addFilter,utils=_ref191.utils;var Type2=utils.Type;addFilter2("DID_LOAD_ITEM",function(item2,_ref192){var query=_ref192.query;return new Promise(function(resolve,reject){var file2=item2.file;if(!isImage2(file2)||!query("GET_ALLOW_IMAGE_RESIZE")){return resolve(item2);}var mode=query("GET_IMAGE_RESIZE_MODE");var width=query("GET_IMAGE_RESIZE_TARGET_WIDTH");var height=query("GET_IMAGE_RESIZE_TARGET_HEIGHT");var upscale=query("GET_IMAGE_RESIZE_UPSCALE");if(width===null&&height===null)return resolve(item2);var targetWidth=width===null?height:width;var targetHeight=height===null?targetWidth:height;var fileURL=URL.createObjectURL(file2);getImageSize2(fileURL,function(size2){URL.revokeObjectURL(fileURL);if(!size2)return resolve(item2);var imageWidth=size2.width,imageHeight=size2.height;var orientation=(item2.getMetadata("exif")||{}).orientation||-1;if(orientation>=5&&orientation<=8){var _ref193=[imageHeight,imageWidth];imageWidth=_ref193[0];imageHeight=_ref193[1];}if(imageWidth===targetWidth&&imageHeight===targetHeight)return resolve(item2);if(!upscale){if(mode==="cover"){if(imageWidth<=targetWidth||imageHeight<=targetHeight)return resolve(item2);}else if(imageWidth<=targetWidth&&imageHeight<=targetWidth){return resolve(item2);}}item2.setMetadata("resize",{mode:mode,upscale:upscale,size:{width:targetWidth,height:targetHeight}});resolve(item2);});});});return{options:{allowImageResize:[true,Type2.BOOLEAN],imageResizeMode:["cover",Type2.STRING],imageResizeUpscale:[true,Type2.BOOLEAN],imageResizeTargetWidth:[null,Type2.INT],imageResizeTargetHeight:[null,Type2.INT]}};};var isBrowser7=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser7){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin6}));}var filepond_plugin_image_resize_esm_default=plugin6;// node_modules/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.esm.js
/*!
 * FilePondPluginImageTransform 3.8.7
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */var isImage3=function isImage3(file2){return /^image/.test(file2.type);};var getFilenameWithoutExtension2=function getFilenameWithoutExtension2(name2){return name2.substr(0,name2.lastIndexOf("."))||name2;};var ExtensionMap={jpeg:"jpg","svg+xml":"svg"};var renameFileToMatchMimeType=function renameFileToMatchMimeType(filename,mimeType){var name2=getFilenameWithoutExtension2(filename);var type=mimeType.split("/")[1];var extension=ExtensionMap[type]||type;return"".concat(name2,".").concat(extension);};var getValidOutputMimeType=function getValidOutputMimeType(type){return /jpeg|png|svg\+xml/.test(type)?type:"image/jpeg";};var isImage$1=function isImage$1(file2){return /^image/.test(file2.type);};var MATRICES={1:function _(){return[1,0,0,1,0,0];},2:function _(width){return[-1,0,0,1,width,0];},3:function _(width,height){return[-1,0,0,-1,width,height];},4:function _(width,height){return[1,0,0,-1,0,height];},5:function _(){return[0,1,1,0,0,0];},6:function _(width,height){return[0,1,-1,0,height,0];},7:function _(width,height){return[0,-1,-1,0,height,width];},8:function _(width){return[0,-1,1,0,0,width];}};var getImageOrientationMatrix=function getImageOrientationMatrix(width,height,orientation){if(orientation===-1){orientation=1;}return MATRICES[orientation](width,height);};var createVector2=function createVector2(x,y){return{x:x,y:y};};var vectorDot2=function vectorDot2(a2,b){return a2.x*b.x+a2.y*b.y;};var vectorSubtract2=function vectorSubtract2(a2,b){return createVector2(a2.x-b.x,a2.y-b.y);};var vectorDistanceSquared2=function vectorDistanceSquared2(a2,b){return vectorDot2(vectorSubtract2(a2,b),vectorSubtract2(a2,b));};var vectorDistance2=function vectorDistance2(a2,b){return Math.sqrt(vectorDistanceSquared2(a2,b));};var getOffsetPointOnEdge2=function getOffsetPointOnEdge2(length,rotation){var a2=length;var A=1.5707963267948966;var B=rotation;var C3=1.5707963267948966-rotation;var sinA=Math.sin(A);var sinB=Math.sin(B);var sinC=Math.sin(C3);var cosC=Math.cos(C3);var ratio=a2/sinA;var b=ratio*sinB;var c2=ratio*sinC;return createVector2(cosC*b,cosC*c2);};var getRotatedRectSize2=function getRotatedRectSize2(rect,rotation){var w=rect.width;var h=rect.height;var hor=getOffsetPointOnEdge2(w,rotation);var ver=getOffsetPointOnEdge2(h,rotation);var tl=createVector2(rect.x+Math.abs(hor.x),rect.y-Math.abs(hor.y));var tr=createVector2(rect.x+rect.width+Math.abs(ver.y),rect.y+Math.abs(ver.x));var bl=createVector2(rect.x-Math.abs(ver.y),rect.y+rect.height-Math.abs(ver.x));return{width:vectorDistance2(tl,tr),height:vectorDistance2(tl,bl)};};var getImageRectZoomFactor2=function getImageRectZoomFactor2(imageRect,cropRect){var rotation=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var center2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{x:0.5,y:0.5};var cx=center2.x>0.5?1-center2.x:center2.x;var cy=center2.y>0.5?1-center2.y:center2.y;var imageWidth=cx*2*imageRect.width;var imageHeight=cy*2*imageRect.height;var rotatedCropSize=getRotatedRectSize2(cropRect,rotation);return Math.max(rotatedCropSize.width/imageWidth,rotatedCropSize.height/imageHeight);};var getCenteredCropRect2=function getCenteredCropRect2(container,aspectRatio){var width=container.width;var height=width*aspectRatio;if(height>container.height){height=container.height;width=height/aspectRatio;}var x=(container.width-width)*0.5;var y=(container.height-height)*0.5;return{x:x,y:y,width:width,height:height};};var calculateCanvasSize2=function calculateCanvasSize2(image,canvasAspectRatio){var zoom=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var imageAspectRatio=image.height/image.width;var canvasWidth=1;var canvasHeight=canvasAspectRatio;var imgWidth=1;var imgHeight=imageAspectRatio;if(imgHeight>canvasHeight){imgHeight=canvasHeight;imgWidth=imgHeight/imageAspectRatio;}var scalar=Math.max(canvasWidth/imgWidth,canvasHeight/imgHeight);var width=image.width/(zoom*scalar*imgWidth);var height=width*canvasAspectRatio;return{width:width,height:height};};var canvasRelease=function canvasRelease(canvas){canvas.width=1;canvas.height=1;var ctx=canvas.getContext("2d");ctx.clearRect(0,0,1,1);};var isFlipped=function isFlipped(flip2){return flip2&&(flip2.horizontal||flip2.vertical);};var getBitmap=function getBitmap(image,orientation,flip2){if(orientation<=1&&!isFlipped(flip2)){image.width=image.naturalWidth;image.height=image.naturalHeight;return image;}var canvas=document.createElement("canvas");var width=image.naturalWidth;var height=image.naturalHeight;var swapped=orientation>=5&&orientation<=8;if(swapped){canvas.width=height;canvas.height=width;}else{canvas.width=width;canvas.height=height;}var ctx=canvas.getContext("2d");if(orientation){ctx.transform.apply(ctx,getImageOrientationMatrix(width,height,orientation));}if(isFlipped(flip2)){var matrix2=[1,0,0,1,0,0];if(!swapped&&flip2.horizontal||swapped&flip2.vertical){matrix2[0]=-1;matrix2[4]=width;}if(!swapped&&flip2.vertical||swapped&&flip2.horizontal){matrix2[3]=-1;matrix2[5]=height;}ctx.transform.apply(ctx,matrix2);}ctx.drawImage(image,0,0,width,height);return canvas;};var imageToImageData=function imageToImageData(imageElement,orientation){var crop=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var options2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var canvasMemoryLimit=options2.canvasMemoryLimit,_options2$background=options2.background,background=_options2$background===void 0?null:_options2$background;var zoom=crop.zoom||1;var bitmap=getBitmap(imageElement,orientation,crop.flip);var imageSize={width:bitmap.width,height:bitmap.height};var aspectRatio=crop.aspectRatio||imageSize.height/imageSize.width;var canvasSize=calculateCanvasSize2(imageSize,aspectRatio,zoom);if(canvasMemoryLimit){var requiredMemory=canvasSize.width*canvasSize.height;if(requiredMemory>canvasMemoryLimit){var scalar=Math.sqrt(canvasMemoryLimit)/Math.sqrt(requiredMemory);imageSize.width=Math.floor(imageSize.width*scalar);imageSize.height=Math.floor(imageSize.height*scalar);canvasSize=calculateCanvasSize2(imageSize,aspectRatio,zoom);}}var canvas=document.createElement("canvas");var canvasCenter={x:canvasSize.width*0.5,y:canvasSize.height*0.5};var stage={x:0,y:0,width:canvasSize.width,height:canvasSize.height,center:canvasCenter};var shouldLimit=typeof crop.scaleToFit==="undefined"||crop.scaleToFit;var scale=zoom*getImageRectZoomFactor2(imageSize,getCenteredCropRect2(stage,aspectRatio),crop.rotation,shouldLimit?crop.center:{x:0.5,y:0.5});canvas.width=Math.round(canvasSize.width/scale);canvas.height=Math.round(canvasSize.height/scale);canvasCenter.x/=scale;canvasCenter.y/=scale;var imageOffset={x:canvasCenter.x-imageSize.width*(crop.center?crop.center.x:0.5),y:canvasCenter.y-imageSize.height*(crop.center?crop.center.y:0.5)};var ctx=canvas.getContext("2d");if(background){ctx.fillStyle=background;ctx.fillRect(0,0,canvas.width,canvas.height);}ctx.translate(canvasCenter.x,canvasCenter.y);ctx.rotate(crop.rotation||0);ctx.drawImage(bitmap,imageOffset.x-canvasCenter.x,imageOffset.y-canvasCenter.y,imageSize.width,imageSize.height);var imageData=ctx.getImageData(0,0,canvas.width,canvas.height);canvasRelease(canvas);return imageData;};var IS_BROWSER3=function(){return typeof window!=="undefined"&&typeof window.document!=="undefined";}();if(IS_BROWSER3){if(!HTMLCanvasElement.prototype.toBlob){Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function value(callback,type,quality){var dataURL=this.toDataURL(type,quality).split(",")[1];setTimeout(function(){var binStr=atob(dataURL);var len=binStr.length;var arr=new Uint8Array(len);for(var i=0;i<len;i++){arr[i]=binStr.charCodeAt(i);}callback(new Blob([arr],{type:type||"image/png"}));});}});}}var canvasToBlob=function canvasToBlob(canvas,options2){var beforeCreateBlob=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return new Promise(function(resolve){var promisedImage=beforeCreateBlob?beforeCreateBlob(canvas):canvas;Promise.resolve(promisedImage).then(function(canvas2){canvas2.toBlob(resolve,options2.type,options2.quality);});});};var vectorMultiply2=function vectorMultiply2(v,amount){return createVector$12(v.x*amount,v.y*amount);};var vectorAdd2=function vectorAdd2(a2,b){return createVector$12(a2.x+b.x,a2.y+b.y);};var vectorNormalize2=function vectorNormalize2(v){var l=Math.sqrt(v.x*v.x+v.y*v.y);if(l===0){return{x:0,y:0};}return createVector$12(v.x/l,v.y/l);};var vectorRotate2=function vectorRotate2(v,radians,origin){var cos=Math.cos(radians);var sin=Math.sin(radians);var t2=createVector$12(v.x-origin.x,v.y-origin.y);return createVector$12(origin.x+cos*t2.x-sin*t2.y,origin.y+sin*t2.x+cos*t2.y);};var createVector$12=function createVector$12(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return{x:x,y:y};};var getMarkupValue2=function getMarkupValue2(value,size2){var scalar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var axis=arguments.length>3?arguments[3]:undefined;if(typeof value==="string"){return parseFloat(value)*scalar;}if(typeof value==="number"){return value*(axis?size2[axis]:Math.min(size2.width,size2.height));}return;};var getMarkupStyles2=function getMarkupStyles2(markup,size2,scale){var lineStyle=markup.borderStyle||markup.lineStyle||"solid";var fill=markup.backgroundColor||markup.fontColor||"transparent";var stroke=markup.borderColor||markup.lineColor||"transparent";var strokeWidth=getMarkupValue2(markup.borderWidth||markup.lineWidth,size2,scale);var lineCap=markup.lineCap||"round";var lineJoin=markup.lineJoin||"round";var dashes=typeof lineStyle==="string"?"":lineStyle.map(function(v){return getMarkupValue2(v,size2,scale);}).join(",");var opacity=markup.opacity||1;return{"stroke-linecap":lineCap,"stroke-linejoin":lineJoin,"stroke-width":strokeWidth||0,"stroke-dasharray":dashes,stroke:stroke,fill:fill,opacity:opacity};};var isDefined3=function isDefined3(value){return value!=null;};var getMarkupRect2=function getMarkupRect2(rect,size2){var scalar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var left=getMarkupValue2(rect.x,size2,scalar,"width")||getMarkupValue2(rect.left,size2,scalar,"width");var top=getMarkupValue2(rect.y,size2,scalar,"height")||getMarkupValue2(rect.top,size2,scalar,"height");var width=getMarkupValue2(rect.width,size2,scalar,"width");var height=getMarkupValue2(rect.height,size2,scalar,"height");var right=getMarkupValue2(rect.right,size2,scalar,"width");var bottom=getMarkupValue2(rect.bottom,size2,scalar,"height");if(!isDefined3(top)){if(isDefined3(height)&&isDefined3(bottom)){top=size2.height-height-bottom;}else{top=bottom;}}if(!isDefined3(left)){if(isDefined3(width)&&isDefined3(right)){left=size2.width-width-right;}else{left=right;}}if(!isDefined3(width)){if(isDefined3(left)&&isDefined3(right)){width=size2.width-left-right;}else{width=0;}}if(!isDefined3(height)){if(isDefined3(top)&&isDefined3(bottom)){height=size2.height-top-bottom;}else{height=0;}}return{x:left||0,y:top||0,width:width||0,height:height||0};};var pointsToPathShape2=function pointsToPathShape2(points){return points.map(function(point,index2){return"".concat(index2===0?"M":"L"," ").concat(point.x," ").concat(point.y);}).join(" ");};var setAttributes2=function setAttributes2(element,attr2){return Object.keys(attr2).forEach(function(key){return element.setAttribute(key,attr2[key]);});};var ns3="http://www.w3.org/2000/svg";var svg2=function svg2(tag,attr2){var element=document.createElementNS(ns3,tag);if(attr2){setAttributes2(element,attr2);}return element;};var updateRect3=function updateRect3(element){return setAttributes2(element,_objectSpread(_objectSpread({},element.rect),element.styles));};var updateEllipse2=function updateEllipse2(element){var cx=element.rect.x+element.rect.width*0.5;var cy=element.rect.y+element.rect.height*0.5;var rx=element.rect.width*0.5;var ry=element.rect.height*0.5;return setAttributes2(element,_objectSpread({cx:cx,cy:cy,rx:rx,ry:ry},element.styles));};var IMAGE_FIT_STYLE2={contain:"xMidYMid meet",cover:"xMidYMid slice"};var updateImage2=function updateImage2(element,markup){setAttributes2(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{preserveAspectRatio:IMAGE_FIT_STYLE2[markup.fit]||"none"}));};var TEXT_ANCHOR2={left:"start",center:"middle",right:"end"};var updateText2=function updateText2(element,markup,size2,scale){var fontSize=getMarkupValue2(markup.fontSize,size2,scale);var fontFamily=markup.fontFamily||"sans-serif";var fontWeight=markup.fontWeight||"normal";var textAlign=TEXT_ANCHOR2[markup.textAlign]||"start";setAttributes2(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{"stroke-width":0,"font-weight":fontWeight,"font-size":fontSize,"font-family":fontFamily,"text-anchor":textAlign}));if(element.text!==markup.text){element.text=markup.text;element.textContent=markup.text.length?markup.text:" ";}};var updateLine2=function updateLine2(element,markup,size2,scale){setAttributes2(element,_objectSpread(_objectSpread(_objectSpread({},element.rect),element.styles),{},{fill:"none"}));var line=element.childNodes[0];var begin=element.childNodes[1];var end=element.childNodes[2];var origin=element.rect;var target={x:element.rect.x+element.rect.width,y:element.rect.y+element.rect.height};setAttributes2(line,{x1:origin.x,y1:origin.y,x2:target.x,y2:target.y});if(!markup.lineDecoration)return;begin.style.display="none";end.style.display="none";var v=vectorNormalize2({x:target.x-origin.x,y:target.y-origin.y});var l=getMarkupValue2(0.05,size2,scale);if(markup.lineDecoration.indexOf("arrow-begin")!==-1){var arrowBeginRotationPoint=vectorMultiply2(v,l);var arrowBeginCenter=vectorAdd2(origin,arrowBeginRotationPoint);var arrowBeginA=vectorRotate2(origin,2,arrowBeginCenter);var arrowBeginB=vectorRotate2(origin,-2,arrowBeginCenter);setAttributes2(begin,{style:"display:block;",d:"M".concat(arrowBeginA.x,",").concat(arrowBeginA.y," L").concat(origin.x,",").concat(origin.y," L").concat(arrowBeginB.x,",").concat(arrowBeginB.y)});}if(markup.lineDecoration.indexOf("arrow-end")!==-1){var arrowEndRotationPoint=vectorMultiply2(v,-l);var arrowEndCenter=vectorAdd2(target,arrowEndRotationPoint);var arrowEndA=vectorRotate2(target,2,arrowEndCenter);var arrowEndB=vectorRotate2(target,-2,arrowEndCenter);setAttributes2(end,{style:"display:block;",d:"M".concat(arrowEndA.x,",").concat(arrowEndA.y," L").concat(target.x,",").concat(target.y," L").concat(arrowEndB.x,",").concat(arrowEndB.y)});}};var updatePath2=function updatePath2(element,markup,size2,scale){setAttributes2(element,_objectSpread(_objectSpread({},element.styles),{},{fill:"none",d:pointsToPathShape2(markup.points.map(function(point){return{x:getMarkupValue2(point.x,size2,scale,"width"),y:getMarkupValue2(point.y,size2,scale,"height")};}))}));};var createShape2=function createShape2(node){return function(markup){return svg2(node,{id:markup.id});};};var createImage2=function createImage2(markup){var shape=svg2("image",{id:markup.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});shape.onload=function(){shape.setAttribute("opacity",markup.opacity||1);};shape.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",markup.src);return shape;};var createLine2=function createLine2(markup){var shape=svg2("g",{id:markup.id,"stroke-linecap":"round","stroke-linejoin":"round"});var line=svg2("line");shape.appendChild(line);var begin=svg2("path");shape.appendChild(begin);var end=svg2("path");shape.appendChild(end);return shape;};var CREATE_TYPE_ROUTES2={image:createImage2,rect:createShape2("rect"),ellipse:createShape2("ellipse"),text:createShape2("text"),path:createShape2("path"),line:createLine2};var UPDATE_TYPE_ROUTES2={rect:updateRect3,ellipse:updateEllipse2,image:updateImage2,text:updateText2,path:updatePath2,line:updateLine2};var createMarkupByType2=function createMarkupByType2(type,markup){return CREATE_TYPE_ROUTES2[type](markup);};var updateMarkupByType2=function updateMarkupByType2(element,type,markup,size2,scale){if(type!=="path"){element.rect=getMarkupRect2(markup,size2,scale);}element.styles=getMarkupStyles2(markup,size2,scale);UPDATE_TYPE_ROUTES2[type](element,markup,size2,scale);};var sortMarkupByZIndex2=function sortMarkupByZIndex2(a2,b){if(a2[1].zIndex>b[1].zIndex){return 1;}if(a2[1].zIndex<b[1].zIndex){return-1;}return 0;};var cropSVG=function cropSVG(blob2){var crop=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var markup=arguments.length>2?arguments[2]:undefined;var options2=arguments.length>3?arguments[3]:undefined;return new Promise(function(resolve){var _options2$background2=options2.background,background=_options2$background2===void 0?null:_options2$background2;var fr=new FileReader();fr.onloadend=function(){var text3=fr.result;var original=document.createElement("div");original.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;";original.innerHTML=text3;var originalNode=original.querySelector("svg");document.body.appendChild(original);var bBox=originalNode.getBBox();original.parentNode.removeChild(original);var titleNode=original.querySelector("title");var viewBoxAttribute=originalNode.getAttribute("viewBox")||"";var widthAttribute=originalNode.getAttribute("width")||"";var heightAttribute=originalNode.getAttribute("height")||"";var width=parseFloat(widthAttribute)||null;var height=parseFloat(heightAttribute)||null;var widthUnits=(widthAttribute.match(/[a-z]+/)||[])[0]||"";var heightUnits=(heightAttribute.match(/[a-z]+/)||[])[0]||"";var viewBoxList=viewBoxAttribute.split(" ").map(parseFloat);var viewBox=viewBoxList.length?{x:viewBoxList[0],y:viewBoxList[1],width:viewBoxList[2],height:viewBoxList[3]}:bBox;var imageWidth=width!=null?width:viewBox.width;var imageHeight=height!=null?height:viewBox.height;originalNode.style.overflow="visible";originalNode.setAttribute("width",imageWidth);originalNode.setAttribute("height",imageHeight);var markupSVG="";if(markup&&markup.length){var size2={width:imageWidth,height:imageHeight};markupSVG=markup.sort(sortMarkupByZIndex2).reduce(function(prev,shape){var el=createMarkupByType2(shape[0],shape[1]);updateMarkupByType2(el,shape[0],shape[1],size2);el.removeAttribute("id");if(el.getAttribute("opacity")===1){el.removeAttribute("opacity");}return prev+"\n"+el.outerHTML+"\n";},"");markupSVG="\n\n<g>".concat(markupSVG.replace(/&nbsp;/g," "),"</g>\n\n");}var aspectRatio=crop.aspectRatio||imageHeight/imageWidth;var canvasWidth=imageWidth;var canvasHeight=canvasWidth*aspectRatio;var shouldLimit=typeof crop.scaleToFit==="undefined"||crop.scaleToFit;var cropCenterX=crop.center?crop.center.x:0.5;var cropCenterY=crop.center?crop.center.y:0.5;var canvasZoomFactor=getImageRectZoomFactor2({width:imageWidth,height:imageHeight},getCenteredCropRect2({width:canvasWidth,height:canvasHeight},aspectRatio),crop.rotation,shouldLimit?{x:cropCenterX,y:cropCenterY}:{x:0.5,y:0.5});var scale=crop.zoom*canvasZoomFactor;var rotation=crop.rotation*(180/Math.PI);var canvasCenter={x:canvasWidth*0.5,y:canvasHeight*0.5};var imageOffset={x:canvasCenter.x-imageWidth*cropCenterX,y:canvasCenter.y-imageHeight*cropCenterY};var cropTransforms=["rotate(".concat(rotation," ").concat(canvasCenter.x," ").concat(canvasCenter.y,")"),"translate(".concat(canvasCenter.x," ").concat(canvasCenter.y,")"),"scale(".concat(scale,")"),"translate(".concat(-canvasCenter.x," ").concat(-canvasCenter.y,")"),"translate(".concat(imageOffset.x," ").concat(imageOffset.y,")")];var cropFlipHorizontal=crop.flip&&crop.flip.horizontal;var cropFlipVertical=crop.flip&&crop.flip.vertical;var flipTransforms=["scale(".concat(cropFlipHorizontal?-1:1," ").concat(cropFlipVertical?-1:1,")"),"translate(".concat(cropFlipHorizontal?-imageWidth:0," ").concat(cropFlipVertical?-imageHeight:0,")")];var transformed="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg width=\"".concat(canvasWidth).concat(widthUnits,"\" height=\"").concat(canvasHeight).concat(heightUnits,"\" \nviewBox=\"0 0 ").concat(canvasWidth," ").concat(canvasHeight,"\" ").concat(background?'style="background:'+background+'" ':"","\npreserveAspectRatio=\"xMinYMin\"\nxmlns:xlink=\"http://www.w3.org/1999/xlink\"\nxmlns=\"http://www.w3.org/2000/svg\">\n<!-- Generated by PQINA - https://pqina.nl/ -->\n<title>").concat(titleNode?titleNode.textContent:"","</title>\n<g transform=\"").concat(cropTransforms.join(" "),"\">\n<g transform=\"").concat(flipTransforms.join(" "),"\">\n").concat(originalNode.outerHTML).concat(markupSVG,"\n</g>\n</g>\n</svg>");resolve(transformed);};fr.readAsText(blob2);});};var objectToImageData=function objectToImageData(obj){var imageData;try{imageData=new ImageData(obj.width,obj.height);}catch(e2){var canvas=document.createElement("canvas");imageData=canvas.getContext("2d").createImageData(obj.width,obj.height);}imageData.data.set(obj.data);return imageData;};var TransformWorker=function TransformWorker(){var TRANSFORMS={resize:resize,filter:filter};var applyTransforms=function applyTransforms(transforms2,imageData){transforms2.forEach(function(transform2){imageData=TRANSFORMS[transform2.type](imageData,transform2.data);});return imageData;};var transform=function transform(data3,cb){var transforms2=data3.transforms;var filterTransform=null;transforms2.forEach(function(transform2){if(transform2.type==="filter"){filterTransform=transform2;}});if(filterTransform){var resizeTransform=null;transforms2.forEach(function(transform2){if(transform2.type==="resize"){resizeTransform=transform2;}});if(resizeTransform){resizeTransform.data.matrix=filterTransform.data;transforms2=transforms2.filter(function(transform2){return transform2.type!=="filter";});}}cb(applyTransforms(transforms2,data3.imageData));};self.onmessage=function(e2){transform(e2.data.message,function(response){self.postMessage({id:e2.data.id,message:response},[response.data.buffer]);});};var br=1;var bg=1;var bb=1;function applyFilterMatrix(index2,data3,m){var ir=data3[index2]/255;var ig=data3[index2+1]/255;var ib=data3[index2+2]/255;var ia=data3[index2+3]/255;var mr=ir*m[0]+ig*m[1]+ib*m[2]+ia*m[3]+m[4];var mg=ir*m[5]+ig*m[6]+ib*m[7]+ia*m[8]+m[9];var mb=ir*m[10]+ig*m[11]+ib*m[12]+ia*m[13]+m[14];var ma=ir*m[15]+ig*m[16]+ib*m[17]+ia*m[18]+m[19];var or=Math.max(0,mr*ma)+br*(1-ma);var og=Math.max(0,mg*ma)+bg*(1-ma);var ob=Math.max(0,mb*ma)+bb*(1-ma);data3[index2]=Math.max(0,Math.min(1,or))*255;data3[index2+1]=Math.max(0,Math.min(1,og))*255;data3[index2+2]=Math.max(0,Math.min(1,ob))*255;}var identityMatrix=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function isIdentityMatrix(filter2){return self.JSON.stringify(filter2||[])===identityMatrix;}function filter(imageData,matrix2){if(!matrix2||isIdentityMatrix(matrix2))return imageData;var data3=imageData.data;var l=data3.length;var m11=matrix2[0];var m12=matrix2[1];var m13=matrix2[2];var m14=matrix2[3];var m15=matrix2[4];var m21=matrix2[5];var m22=matrix2[6];var m23=matrix2[7];var m24=matrix2[8];var m25=matrix2[9];var m31=matrix2[10];var m32=matrix2[11];var m33=matrix2[12];var m34=matrix2[13];var m35=matrix2[14];var m41=matrix2[15];var m42=matrix2[16];var m43=matrix2[17];var m44=matrix2[18];var m45=matrix2[19];var index2=0,r2=0,g=0,b=0,a2=0,mr=0,mg=0,mb=0,ma=0,or=0,og=0,ob=0;for(;index2<l;index2+=4){r2=data3[index2]/255;g=data3[index2+1]/255;b=data3[index2+2]/255;a2=data3[index2+3]/255;mr=r2*m11+g*m12+b*m13+a2*m14+m15;mg=r2*m21+g*m22+b*m23+a2*m24+m25;mb=r2*m31+g*m32+b*m33+a2*m34+m35;ma=r2*m41+g*m42+b*m43+a2*m44+m45;or=Math.max(0,mr*ma)+br*(1-ma);og=Math.max(0,mg*ma)+bg*(1-ma);ob=Math.max(0,mb*ma)+bb*(1-ma);data3[index2]=Math.max(0,Math.min(1,or))*255;data3[index2+1]=Math.max(0,Math.min(1,og))*255;data3[index2+2]=Math.max(0,Math.min(1,ob))*255;}return imageData;}function resize(imageData,data3){var _data3$mode=data3.mode,mode=_data3$mode===void 0?"contain":_data3$mode,_data3$upscale=data3.upscale,upscale=_data3$upscale===void 0?false:_data3$upscale,width=data3.width,height=data3.height,matrix2=data3.matrix;matrix2=!matrix2||isIdentityMatrix(matrix2)?null:matrix2;if(!width&&!height){return filter(imageData,matrix2);}if(width===null){width=height;}else if(height===null){height=width;}if(mode!=="force"){var scalarWidth=width/imageData.width;var scalarHeight=height/imageData.height;var scalar=1;if(mode==="cover"){scalar=Math.max(scalarWidth,scalarHeight);}else if(mode==="contain"){scalar=Math.min(scalarWidth,scalarHeight);}if(scalar>1&&upscale===false){return filter(imageData,matrix2);}width=imageData.width*scalar;height=imageData.height*scalar;}var originWidth=imageData.width;var originHeight=imageData.height;var targetWidth=Math.round(width);var targetHeight=Math.round(height);var inputData=imageData.data;var outputData=new Uint8ClampedArray(targetWidth*targetHeight*4);var ratioWidth=originWidth/targetWidth;var ratioHeight=originHeight/targetHeight;var ratioWidthHalf=Math.ceil(ratioWidth*0.5);var ratioHeightHalf=Math.ceil(ratioHeight*0.5);for(var j=0;j<targetHeight;j++){for(var i=0;i<targetWidth;i++){var x2=(i+j*targetWidth)*4;var weight=0;var weights=0;var weightsAlpha=0;var r2=0;var g=0;var b=0;var a2=0;var centerY=(j+0.5)*ratioHeight;for(var yy=Math.floor(j*ratioHeight);yy<(j+1)*ratioHeight;yy++){var dy=Math.abs(centerY-(yy+0.5))/ratioHeightHalf;var centerX=(i+0.5)*ratioWidth;var w0=dy*dy;for(var xx=Math.floor(i*ratioWidth);xx<(i+1)*ratioWidth;xx++){var dx=Math.abs(centerX-(xx+0.5))/ratioWidthHalf;var w=Math.sqrt(w0+dx*dx);if(w>=-1&&w<=1){weight=2*w*w*w-3*w*w+1;if(weight>0){dx=4*(xx+yy*originWidth);var ref=inputData[dx+3];a2+=weight*ref;weightsAlpha+=weight;if(ref<255){weight=weight*ref/250;}r2+=weight*inputData[dx];g+=weight*inputData[dx+1];b+=weight*inputData[dx+2];weights+=weight;}}}}outputData[x2]=r2/weights;outputData[x2+1]=g/weights;outputData[x2+2]=b/weights;outputData[x2+3]=a2/weightsAlpha;matrix2&&applyFilterMatrix(x2,outputData,matrix2);}}return{data:outputData,width:targetWidth,height:targetHeight};}};var correctOrientation=function correctOrientation(view,offset2){if(view.getUint32(offset2+4,false)!==1165519206)return;offset2+=4;var intelByteAligned=view.getUint16(offset2+=6,false)===18761;offset2+=view.getUint32(offset2+4,intelByteAligned);var tags=view.getUint16(offset2,intelByteAligned);offset2+=2;for(var i=0;i<tags;i++){if(view.getUint16(offset2+i*12,intelByteAligned)===274){view.setUint16(offset2+i*12+8,1,intelByteAligned);return true;}}return false;};var readData=function readData(data3){var view=new DataView(data3);if(view.getUint16(0)!==65496)return null;var offset2=2;var marker;var markerLength;var orientationCorrected=false;while(offset2<view.byteLength){marker=view.getUint16(offset2,false);markerLength=view.getUint16(offset2+2,false)+2;var isData=marker>=65504&&marker<=65519||marker===65534;if(!isData){break;}if(!orientationCorrected){orientationCorrected=correctOrientation(view,offset2,markerLength);}if(offset2+markerLength>view.byteLength){break;}offset2+=markerLength;}return data3.slice(0,offset2);};var getImageHead=function getImageHead(file2){return new Promise(function(resolve){var reader=new FileReader();reader.onload=function(){return resolve(readData(reader.result)||null);};reader.readAsArrayBuffer(file2.slice(0,256*1024));});};var getBlobBuilder2=function getBlobBuilder2(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;};var createBlob2=function createBlob2(arrayBuffer,mimeType){var BB=getBlobBuilder2();if(BB){var bb=new BB();bb.append(arrayBuffer);return bb.getBlob(mimeType);}return new Blob([arrayBuffer],{type:mimeType});};var getUniqueId2=function getUniqueId2(){return Math.random().toString(36).substr(2,9);};var createWorker2=function createWorker2(fn2){var workerBlob=new Blob(["(",fn2.toString(),")()"],{type:"application/javascript"});var workerURL=URL.createObjectURL(workerBlob);var worker=new Worker(workerURL);var trips=[];return{transfer:function transfer(){},post:function post(message,cb,transferList){var id=getUniqueId2();trips[id]=cb;worker.onmessage=function(e2){var cb2=trips[e2.data.id];if(!cb2)return;cb2(e2.data.message);delete trips[e2.data.id];};worker.postMessage({id:id,message:message},transferList);},terminate:function terminate(){worker.terminate();URL.revokeObjectURL(workerURL);}};};var loadImage3=function loadImage3(url){return new Promise(function(resolve,reject){var img=new Image();img.onload=function(){resolve(img);};img.onerror=function(e2){reject(e2);};img.src=url;});};var chain=function chain(funcs){return funcs.reduce(function(promise,func){return promise.then(function(result){return func().then(Array.prototype.concat.bind(result));});},Promise.resolve([]));};var canvasApplyMarkup=function canvasApplyMarkup(canvas,markup){return new Promise(function(resolve){var size2={width:canvas.width,height:canvas.height};var ctx=canvas.getContext("2d");var drawers=markup.sort(sortMarkupByZIndex2).map(function(item2){return function(){return new Promise(function(resolve2){var result=TYPE_DRAW_ROUTES[item2[0]](ctx,size2,item2[1],resolve2);if(result)resolve2();});};});chain(drawers).then(function(){return resolve(canvas);});});};var applyMarkupStyles=function applyMarkupStyles(ctx,styles3){ctx.beginPath();ctx.lineCap=styles3["stroke-linecap"];ctx.lineJoin=styles3["stroke-linejoin"];ctx.lineWidth=styles3["stroke-width"];if(styles3["stroke-dasharray"].length){ctx.setLineDash(styles3["stroke-dasharray"].split(","));}ctx.fillStyle=styles3["fill"];ctx.strokeStyle=styles3["stroke"];ctx.globalAlpha=styles3.opacity||1;};var drawMarkupStyles=function drawMarkupStyles(ctx){ctx.fill();ctx.stroke();ctx.globalAlpha=1;};var drawRect=function drawRect(ctx,size2,markup){var rect=getMarkupRect2(markup,size2);var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);ctx.rect(rect.x,rect.y,rect.width,rect.height);drawMarkupStyles(ctx,styles3);return true;};var drawEllipse=function drawEllipse(ctx,size2,markup){var rect=getMarkupRect2(markup,size2);var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);var x=rect.x,y=rect.y,w=rect.width,h=rect.height,kappa=0.5522848,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;ctx.moveTo(x,ym);ctx.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);ctx.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);ctx.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);ctx.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);drawMarkupStyles(ctx,styles3);return true;};var drawImage=function drawImage(ctx,size2,markup,done){var rect=getMarkupRect2(markup,size2);var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);var image=new Image();var isCrossOriginImage=new URL(markup.src,window.location.href).origin!==window.location.origin;if(isCrossOriginImage)image.crossOrigin="";image.onload=function(){if(markup.fit==="cover"){var ar=rect.width/rect.height;var width=ar>1?image.width:image.height*ar;var height=ar>1?image.width/ar:image.height;var x=image.width*0.5-width*0.5;var y=image.height*0.5-height*0.5;ctx.drawImage(image,x,y,width,height,rect.x,rect.y,rect.width,rect.height);}else if(markup.fit==="contain"){var scalar=Math.min(rect.width/image.width,rect.height/image.height);var _width=scalar*image.width;var _height=scalar*image.height;var _x=rect.x+rect.width*0.5-_width*0.5;var _y=rect.y+rect.height*0.5-_height*0.5;ctx.drawImage(image,0,0,image.width,image.height,_x,_y,_width,_height);}else{ctx.drawImage(image,0,0,image.width,image.height,rect.x,rect.y,rect.width,rect.height);}drawMarkupStyles(ctx,styles3);done();};image.src=markup.src;};var drawText=function drawText(ctx,size2,markup){var rect=getMarkupRect2(markup,size2);var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);var fontSize=getMarkupValue2(markup.fontSize,size2);var fontFamily=markup.fontFamily||"sans-serif";var fontWeight=markup.fontWeight||"normal";var textAlign=markup.textAlign||"left";ctx.font="".concat(fontWeight," ").concat(fontSize,"px ").concat(fontFamily);ctx.textAlign=textAlign;ctx.fillText(markup.text,rect.x,rect.y);drawMarkupStyles(ctx,styles3);return true;};var drawPath=function drawPath(ctx,size2,markup){var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);ctx.beginPath();var points=markup.points.map(function(point){return{x:getMarkupValue2(point.x,size2,1,"width"),y:getMarkupValue2(point.y,size2,1,"height")};});ctx.moveTo(points[0].x,points[0].y);var l=points.length;for(var i=1;i<l;i++){ctx.lineTo(points[i].x,points[i].y);}drawMarkupStyles(ctx,styles3);return true;};var drawLine=function drawLine(ctx,size2,markup){var rect=getMarkupRect2(markup,size2);var styles3=getMarkupStyles2(markup,size2);applyMarkupStyles(ctx,styles3);ctx.beginPath();var origin={x:rect.x,y:rect.y};var target={x:rect.x+rect.width,y:rect.y+rect.height};ctx.moveTo(origin.x,origin.y);ctx.lineTo(target.x,target.y);var v=vectorNormalize2({x:target.x-origin.x,y:target.y-origin.y});var l=0.04*Math.min(size2.width,size2.height);if(markup.lineDecoration.indexOf("arrow-begin")!==-1){var arrowBeginRotationPoint=vectorMultiply2(v,l);var arrowBeginCenter=vectorAdd2(origin,arrowBeginRotationPoint);var arrowBeginA=vectorRotate2(origin,2,arrowBeginCenter);var arrowBeginB=vectorRotate2(origin,-2,arrowBeginCenter);ctx.moveTo(arrowBeginA.x,arrowBeginA.y);ctx.lineTo(origin.x,origin.y);ctx.lineTo(arrowBeginB.x,arrowBeginB.y);}if(markup.lineDecoration.indexOf("arrow-end")!==-1){var arrowEndRotationPoint=vectorMultiply2(v,-l);var arrowEndCenter=vectorAdd2(target,arrowEndRotationPoint);var arrowEndA=vectorRotate2(target,2,arrowEndCenter);var arrowEndB=vectorRotate2(target,-2,arrowEndCenter);ctx.moveTo(arrowEndA.x,arrowEndA.y);ctx.lineTo(target.x,target.y);ctx.lineTo(arrowEndB.x,arrowEndB.y);}drawMarkupStyles(ctx,styles3);return true;};var TYPE_DRAW_ROUTES={rect:drawRect,ellipse:drawEllipse,image:drawImage,text:drawText,line:drawLine,path:drawPath};var imageDataToCanvas=function imageDataToCanvas(imageData){var image=document.createElement("canvas");image.width=imageData.width;image.height=imageData.height;var ctx=image.getContext("2d");ctx.putImageData(imageData,0,0);return image;};var transformImage=function transformImage(file2,instructions){var options2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Promise(function(resolve,reject){if(!file2||!isImage$1(file2))return reject({status:"not an image file",file:file2});var stripImageHead=options2.stripImageHead,beforeCreateBlob=options2.beforeCreateBlob,afterCreateBlob=options2.afterCreateBlob,canvasMemoryLimit=options2.canvasMemoryLimit;var crop=instructions.crop,size2=instructions.size,filter=instructions.filter,markup=instructions.markup,output=instructions.output;var orientation=instructions.image&&instructions.image.orientation?Math.max(1,Math.min(8,instructions.image.orientation)):null;var qualityAsPercentage=output&&output.quality;var quality=qualityAsPercentage===null?null:qualityAsPercentage/100;var type=output&&output.type||null;var background=output&&output.background||null;var transforms2=[];if(size2&&(typeof size2.width==="number"||typeof size2.height==="number")){transforms2.push({type:"resize",data:size2});}if(filter&&filter.length===20){transforms2.push({type:"filter",data:filter});}var resolveWithBlob=function resolveWithBlob(blob2){var promisedBlob=afterCreateBlob?afterCreateBlob(blob2):blob2;Promise.resolve(promisedBlob).then(resolve);};var toBlob=function toBlob(imageData,options3){var canvas=imageDataToCanvas(imageData);var promisedCanvas=markup.length?canvasApplyMarkup(canvas,markup):canvas;Promise.resolve(promisedCanvas).then(function(canvas2){canvasToBlob(canvas2,options3,beforeCreateBlob).then(function(blob2){canvasRelease(canvas2);if(stripImageHead)return resolveWithBlob(blob2);getImageHead(file2).then(function(imageHead){if(imageHead!==null){blob2=new Blob([imageHead,blob2.slice(20)],{type:blob2.type});}resolveWithBlob(blob2);});})["catch"](reject);});};if(/svg/.test(file2.type)&&type===null){return cropSVG(file2,crop,markup,{background:background}).then(function(text3){resolve(createBlob2(text3,"image/svg+xml"));});}var url=URL.createObjectURL(file2);loadImage3(url).then(function(image){URL.revokeObjectURL(url);var imageData=imageToImageData(image,orientation,crop,{canvasMemoryLimit:canvasMemoryLimit,background:background});var outputFormat={quality:quality,type:type||file2.type};if(!transforms2.length){return toBlob(imageData,outputFormat);}var worker=createWorker2(TransformWorker);worker.post({transforms:transforms2,imageData:imageData},function(response){toBlob(objectToImageData(response),outputFormat);worker.terminate();},[imageData.data.buffer]);})["catch"](reject);});};var MARKUP_RECT2=["x","y","left","top","right","bottom","width","height"];var toOptionalFraction2=function toOptionalFraction2(value){return typeof value==="string"&&/%/.test(value)?parseFloat(value)/100:value;};var prepareMarkup2=function prepareMarkup2(markup){var _markup3=_slicedToArray(markup,2),type=_markup3[0],props=_markup3[1];var rect=props.points?{}:MARKUP_RECT2.reduce(function(prev,curr){prev[curr]=toOptionalFraction2(props[curr]);return prev;},{});return[type,_objectSpread(_objectSpread({zIndex:0},props),rect)];};var getImageSize3=function getImageSize3(file2){return new Promise(function(resolve,reject){var imageElement=new Image();imageElement.src=URL.createObjectURL(file2);var measure=function measure(){var width=imageElement.naturalWidth;var height=imageElement.naturalHeight;var hasSize=width&&height;if(!hasSize)return;URL.revokeObjectURL(imageElement.src);clearInterval(intervalId);resolve({width:width,height:height});};imageElement.onerror=function(err){URL.revokeObjectURL(imageElement.src);clearInterval(intervalId);reject(err);};var intervalId=setInterval(measure,1);measure();});};if(typeof window!=="undefined"&&typeof window.document!=="undefined"){if(!HTMLCanvasElement.prototype.toBlob){Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function value(cb,type,quality){var canvas=this;setTimeout(function(){var dataURL=canvas.toDataURL(type,quality).split(",")[1];var binStr=atob(dataURL);var index2=binStr.length;var data3=new Uint8Array(index2);while(index2--){data3[index2]=binStr.charCodeAt(index2);}cb(new Blob([data3],{type:type||"image/png"}));});}});}}var isBrowser8=typeof window!=="undefined"&&typeof window.document!=="undefined";var isIOS=isBrowser8&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;var plugin7=function plugin7(_ref194){var addFilter2=_ref194.addFilter,utils=_ref194.utils;var Type2=utils.Type,forin2=utils.forin,getFileFromBlob2=utils.getFileFromBlob,isFile2=utils.isFile;var TRANSFORM_LIST=["crop","resize","filter","markup","output"];var createVariantCreator=function createVariantCreator(updateMetadata){return function(transform,file2,metadata){return transform(file2,updateMetadata?updateMetadata(metadata):metadata);};};var isDefaultCrop=function isDefaultCrop(crop){return crop.aspectRatio===null&&crop.rotation===0&&crop.zoom===1&&crop.center&&crop.center.x===0.5&&crop.center.y===0.5&&crop.flip&&crop.flip.horizontal===false&&crop.flip.vertical===false;};addFilter2("SHOULD_PREPARE_OUTPUT",function(shouldPrepareOutput,_ref195){var query=_ref195.query;return new Promise(function(resolve){resolve(!query("IS_ASYNC"));});});var shouldTransformFile=function shouldTransformFile(query,file2,item2){return new Promise(function(resolve){if(!query("GET_ALLOW_IMAGE_TRANSFORM")||item2.archived||!isFile2(file2)||!isImage3(file2)){return resolve(false);}getImageSize3(file2).then(function(){var fn2=query("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(fn2){var filterResult=fn2(file2);if(filterResult==null){return handleRevert(true);}if(typeof filterResult==="boolean"){return resolve(filterResult);}if(typeof filterResult.then==="function"){return filterResult.then(resolve);}}resolve(true);})["catch"](function(err){resolve(false);});});};addFilter2("DID_CREATE_ITEM",function(item2,_ref196){var query=_ref196.query,dispatch=_ref196.dispatch;if(!query("GET_ALLOW_IMAGE_TRANSFORM"))return;item2.extend("requestPrepare",function(){return new Promise(function(resolve,reject){dispatch("REQUEST_PREPARE_OUTPUT",{query:item2.id,item:item2,success:resolve,failure:reject},true);});});});addFilter2("PREPARE_OUTPUT",function(file2,_ref197){var query=_ref197.query,item2=_ref197.item;return new Promise(function(resolve){shouldTransformFile(query,file2,item2).then(function(shouldTransform){if(!shouldTransform)return resolve(file2);var variants=[];if(query("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")){variants.push(function(){return new Promise(function(resolve2){resolve2({name:query("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:file2});});});}if(query("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")){variants.push(function(transform2,file3,metadata){return new Promise(function(resolve2){transform2(file3,metadata).then(function(file4){return resolve2({name:query("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:file4});});});});}var variantsDefinition=query("GET_IMAGE_TRANSFORM_VARIANTS")||{};forin2(variantsDefinition,function(key,fn2){var createVariant=createVariantCreator(fn2);variants.push(function(transform2,file3,metadata){return new Promise(function(resolve2){createVariant(transform2,file3,metadata).then(function(file4){return resolve2({name:key,file:file4});});});});});var qualityAsPercentage=query("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY");var qualityMode=query("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE");var quality=qualityAsPercentage===null?null:qualityAsPercentage/100;var type=query("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE");var clientTransforms=query("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||TRANSFORM_LIST;item2.setMetadata("output",{type:type,quality:quality,client:clientTransforms},true);var transform=function transform(file3,metadata){return new Promise(function(resolve2,reject){var filteredMetadata=_objectSpread({},metadata);Object.keys(filteredMetadata).filter(function(instruction){return instruction!=="exif";}).forEach(function(instruction){if(clientTransforms.indexOf(instruction)===-1){delete filteredMetadata[instruction];}});var resize=filteredMetadata.resize,exif=filteredMetadata.exif,output=filteredMetadata.output,crop=filteredMetadata.crop,filter=filteredMetadata.filter,markup=filteredMetadata.markup;var instructions={image:{orientation:exif?exif.orientation:null},output:output&&(output.type||typeof output.quality==="number"||output.background)?{type:output.type,quality:typeof output.quality==="number"?output.quality*100:null,background:output.background||query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||null}:void 0,size:resize&&(resize.size.width||resize.size.height)?_objectSpread({mode:resize.mode,upscale:resize.upscale},resize.size):void 0,crop:crop&&!isDefaultCrop(crop)?_objectSpread({},crop):void 0,markup:markup&&markup.length?markup.map(prepareMarkup2):[],filter:filter};if(instructions.output){var willChangeType=output.type?output.type!==file3.type:false;var canChangeQuality=/\/jpe?g$/.test(file3.type);var willChangeQuality=output.quality!==null?canChangeQuality&&qualityMode==="always":false;var willModifyImageData=!!(instructions.size||instructions.crop||instructions.filter||willChangeType||willChangeQuality);if(!willModifyImageData)return resolve2(file3);}var options2={beforeCreateBlob:query("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),afterCreateBlob:query("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),canvasMemoryLimit:query("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),stripImageHead:query("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")};transformImage(file3,instructions,options2).then(function(blob2){var out=getFileFromBlob2(blob2,renameFileToMatchMimeType(file3.name,getValidOutputMimeType(blob2.type)));resolve2(out);})["catch"](reject);});};var variantPromises=variants.map(function(create3){return create3(transform,file2,item2.getMetadata());});Promise.all(variantPromises).then(function(files){resolve(files.length===1&&files[0].name===null?files[0].file:files);});});});});return{options:{allowImageTransform:[true,Type2.BOOLEAN],imageTransformImageFilter:[null,Type2.FUNCTION],imageTransformOutputMimeType:[null,Type2.STRING],imageTransformOutputQuality:[null,Type2.INT],imageTransformOutputStripImageHead:[true,Type2.BOOLEAN],imageTransformClientTransforms:[null,Type2.ARRAY],imageTransformOutputQualityMode:["always",Type2.STRING],imageTransformVariants:[null,Type2.OBJECT],imageTransformVariantsIncludeDefault:[true,Type2.BOOLEAN],imageTransformVariantsDefaultName:[null,Type2.STRING],imageTransformVariantsIncludeOriginal:[false,Type2.BOOLEAN],imageTransformVariantsOriginalName:["original_",Type2.STRING],imageTransformBeforeCreateBlob:[null,Type2.FUNCTION],imageTransformAfterCreateBlob:[null,Type2.FUNCTION],imageTransformCanvasMemoryLimit:[isBrowser8&&isIOS?4096*4096:null,Type2.INT],imageTransformCanvasBackgroundColor:[null,Type2.STRING]}};};if(isBrowser8){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin7}));}var filepond_plugin_image_transform_esm_default=plugin7;// node_modules/filepond-plugin-media-preview/dist/filepond-plugin-media-preview.esm.js
/*!
 * FilePondPluginMediaPreview 1.0.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit undefined for details.
 */var isPreviewableVideo=function isPreviewableVideo(file2){return /^video/.test(file2.type);};var isPreviewableAudio=function isPreviewableAudio(file2){return /^audio/.test(file2.type);};var AudioPlayer=/*#__PURE__*/function(){function AudioPlayer(mediaEl,audioElems){_classCallCheck(this,AudioPlayer);this.mediaEl=mediaEl;this.audioElems=audioElems;this.onplayhead=false;this.duration=0;this.timelineWidth=this.audioElems.timeline.offsetWidth-this.audioElems.playhead.offsetWidth;this.moveplayheadFn=this.moveplayhead.bind(this);this.registerListeners();}_createClass(AudioPlayer,[{key:"registerListeners",value:function registerListeners(){var _this17=this;this.mediaEl.addEventListener("timeupdate",this.timeUpdate.bind(this),false);this.mediaEl.addEventListener("canplaythrough",function(){return _this17.duration=_this17.mediaEl.duration;},false);this.audioElems.timeline.addEventListener("click",this.timelineClicked.bind(this),false);this.audioElems.button.addEventListener("click",this.play.bind(this));this.audioElems.playhead.addEventListener("mousedown",this.mouseDown.bind(this),false);window.addEventListener("mouseup",this.mouseUp.bind(this),false);}},{key:"play",value:function play(){if(this.mediaEl.paused){this.mediaEl.play();}else{this.mediaEl.pause();}this.audioElems.button.classList.toggle("play");this.audioElems.button.classList.toggle("pause");}},{key:"timeUpdate",value:function timeUpdate(){var playPercent=this.mediaEl.currentTime/this.duration*100;this.audioElems.playhead.style.marginLeft=playPercent+"%";if(this.mediaEl.currentTime===this.duration){this.audioElems.button.classList.toggle("play");this.audioElems.button.classList.toggle("pause");}}},{key:"moveplayhead",value:function moveplayhead(event){var newMargLeft=event.clientX-this.getPosition(this.audioElems.timeline);if(newMargLeft>=0&&newMargLeft<=this.timelineWidth){this.audioElems.playhead.style.marginLeft=newMargLeft+"px";}if(newMargLeft<0){this.audioElems.playhead.style.marginLeft="0px";}if(newMargLeft>this.timelineWidth){this.audioElems.playhead.style.marginLeft=this.timelineWidth-4+"px";}}},{key:"timelineClicked",value:function timelineClicked(event){this.moveplayhead(event);this.mediaEl.currentTime=this.duration*this.clickPercent(event);}},{key:"mouseDown",value:function mouseDown(){this.onplayhead=true;window.addEventListener("mousemove",this.moveplayheadFn,true);this.mediaEl.removeEventListener("timeupdate",this.timeUpdate.bind(this),false);}},{key:"mouseUp",value:function mouseUp(event){window.removeEventListener("mousemove",this.moveplayheadFn,true);if(this.onplayhead==true){this.moveplayhead(event);this.mediaEl.currentTime=this.duration*this.clickPercent(event);this.mediaEl.addEventListener("timeupdate",this.timeUpdate.bind(this),false);}this.onplayhead=false;}},{key:"clickPercent",value:function clickPercent(event){return(event.clientX-this.getPosition(this.audioElems.timeline))/this.timelineWidth;}},{key:"getPosition",value:function getPosition(el){return el.getBoundingClientRect().left;}}]);return AudioPlayer;}();var createMediaView=function createMediaView(_){return _.utils.createView({name:"media-preview",tag:"div",ignoreRect:true,create:function create(_ref198){var root2=_ref198.root,props=_ref198.props;var id=props.id;var item2=root2.query("GET_ITEM",{id:props.id});var tagName=isPreviewableAudio(item2.file)?"audio":"video";root2.ref.media=document.createElement(tagName);root2.ref.media.setAttribute("controls",true);root2.element.appendChild(root2.ref.media);if(isPreviewableAudio(item2.file)){var docfrag=document.createDocumentFragment();root2.ref.audio=[];root2.ref.audio.container=document.createElement("div"),root2.ref.audio.button=document.createElement("span"),root2.ref.audio.timeline=document.createElement("div"),root2.ref.audio.playhead=document.createElement("div");root2.ref.audio.container.className="audioplayer";root2.ref.audio.button.className="playpausebtn play";root2.ref.audio.timeline.className="timeline";root2.ref.audio.playhead.className="playhead";root2.ref.audio.timeline.appendChild(root2.ref.audio.playhead);root2.ref.audio.container.appendChild(root2.ref.audio.button);root2.ref.audio.container.appendChild(root2.ref.audio.timeline);docfrag.appendChild(root2.ref.audio.container);root2.element.appendChild(docfrag);}},write:_.utils.createRoute({DID_MEDIA_PREVIEW_LOAD:function DID_MEDIA_PREVIEW_LOAD(_ref199){var root2=_ref199.root,props=_ref199.props;var id=props.id;var item2=root2.query("GET_ITEM",{id:props.id});if(!item2)return;var URL2=window.URL||window.webkitURL;var blob2=new Blob([item2.file],{type:item2.file.type});root2.ref.media.type=item2.file.type;root2.ref.media.src=item2.file.mock&&item2.file.url||URL2.createObjectURL(blob2);if(isPreviewableAudio(item2.file)){new AudioPlayer(root2.ref.media,root2.ref.audio);}root2.ref.media.addEventListener("loadeddata",function(){var height=75;if(isPreviewableVideo(item2.file)){var containerWidth=root2.ref.media.offsetWidth;var factor=root2.ref.media.videoWidth/containerWidth;height=root2.ref.media.videoHeight/factor;}root2.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:props.id,height:height});},false);}})});};var createMediaWrapperView=function createMediaWrapperView(_){var didCreatePreviewContainer=function didCreatePreviewContainer(_ref200){var root2=_ref200.root,props=_ref200.props;var id=props.id;var item2=root2.query("GET_ITEM",id);if(!item2)return;root2.dispatch("DID_MEDIA_PREVIEW_LOAD",{id:id});};var create3=function create3(_ref201){var root2=_ref201.root,props=_ref201.props;var media=createMediaView(_);root2.ref.media=root2.appendChildView(root2.createChildView(media,{id:props.id}));};return _.utils.createView({name:"media-preview-wrapper",create:create3,write:_.utils.createRoute({DID_MEDIA_PREVIEW_CONTAINER_CREATE:didCreatePreviewContainer})});};var plugin8=function plugin8(fpAPI){var addFilter2=fpAPI.addFilter,utils=fpAPI.utils;var Type2=utils.Type,createRoute2=utils.createRoute;var mediaWrapperView=createMediaWrapperView(fpAPI);addFilter2("CREATE_VIEW",function(viewAPI){var is2=viewAPI.is,view=viewAPI.view,query=viewAPI.query;if(!is2("file")){return;}var didLoadItem2=function didLoadItem2(_ref202){var root2=_ref202.root,props=_ref202.props;var id=props.id;var item2=query("GET_ITEM",id);var allowVideoPreview=query("GET_ALLOW_VIDEO_PREVIEW");var allowAudioPreview=query("GET_ALLOW_AUDIO_PREVIEW");if(!item2||item2.archived||(!isPreviewableVideo(item2.file)||!allowVideoPreview)&&(!isPreviewableAudio(item2.file)||!allowAudioPreview)){return;}root2.ref.mediaPreview=view.appendChildView(view.createChildView(mediaWrapperView,{id:id}));root2.dispatch("DID_MEDIA_PREVIEW_CONTAINER_CREATE",{id:id});};view.registerWriter(createRoute2({DID_LOAD_ITEM:didLoadItem2},function(_ref203){var root2=_ref203.root,props=_ref203.props;var id=props.id;var item2=query("GET_ITEM",id);var allowVideoPreview=root2.query("GET_ALLOW_VIDEO_PREVIEW");var allowAudioPreview=root2.query("GET_ALLOW_AUDIO_PREVIEW");if(!item2||(!isPreviewableVideo(item2.file)||!allowVideoPreview)&&(!isPreviewableAudio(item2.file)||!allowAudioPreview)||root2.rect.element.hidden)return;}));});return{options:{allowVideoPreview:[true,Type2.BOOLEAN],allowAudioPreview:[true,Type2.BOOLEAN]}};};var isBrowser9=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser9){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin8}));}// node_modules/filepond/locale/ar-ar.js
var ar_ar_default={labelIdle:"\u0627\u0633\u062D\u0628 \u0648 \u0627\u062F\u0631\u062C \u0645\u0644\u0641\u0627\u062A\u0643 \u0623\u0648 <span class=\"filepond--label-action\"> \u062A\u0635\u0641\u062D </span>",labelInvalidField:"\u0627\u0644\u062D\u0642\u0644 \u064A\u062D\u062A\u0648\u064A \u0639\u0644\u0649 \u0645\u0644\u0641\u0627\u062A \u063A\u064A\u0631 \u0635\u0627\u0644\u062D\u0629",labelFileWaitingForSize:"\u0628\u0627\u0646\u062A\u0638\u0627\u0631 \u0627\u0644\u062D\u062C\u0645",labelFileSizeNotAvailable:"\u0627\u0644\u062D\u062C\u0645 \u063A\u064A\u0631 \u0645\u062A\u0627\u062D",labelFileLoading:"\u0628\u0627\u0644\u0625\u0646\u062A\u0638\u0627\u0631",labelFileLoadError:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u062D\u0645\u064A\u0644",labelFileProcessing:"\u064A\u062A\u0645 \u0627\u0644\u0631\u0641\u0639",labelFileProcessingComplete:"\u062A\u0645 \u0627\u0644\u0631\u0641\u0639",labelFileProcessingAborted:"\u062A\u0645 \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u0631\u0641\u0639",labelFileProcessingError:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0631\u0641\u0639",labelFileProcessingRevertError:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u0631\u0627\u062C\u0639",labelFileRemoveError:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0630\u0641",labelTapToCancel:"\u0627\u0646\u0642\u0631 \u0644\u0644\u0625\u0644\u063A\u0627\u0621",labelTapToRetry:"\u0627\u0646\u0642\u0631 \u0644\u0625\u0639\u0627\u062F\u0629 \u0627\u0644\u0645\u062D\u0627\u0648\u0644\u0629",labelTapToUndo:"\u0627\u0646\u0642\u0631 \u0644\u0644\u062A\u0631\u0627\u062C\u0639",labelButtonRemoveItem:"\u0645\u0633\u062D",labelButtonAbortItemLoad:"\u0625\u0644\u063A\u0627\u0621",labelButtonRetryItemLoad:"\u0625\u0639\u0627\u062F\u0629",labelButtonAbortItemProcessing:"\u0625\u0644\u063A\u0627\u0621",labelButtonUndoItemProcessing:"\u062A\u0631\u0627\u062C\u0639",labelButtonRetryItemProcessing:"\u0625\u0639\u0627\u062F\u0629",labelButtonProcessItem:"\u0631\u0641\u0639",labelMaxFileSizeExceeded:"\u0627\u0644\u0645\u0644\u0641 \u0643\u0628\u064A\u0631 \u062C\u062F\u0627",labelMaxFileSize:"\u062D\u062C\u0645 \u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0623\u0642\u0635\u0649: {filesize}",labelMaxTotalFileSizeExceeded:"\u062A\u0645 \u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 \u0644\u0644\u062D\u062C\u0645 \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A",labelMaxTotalFileSize:"\u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 \u0644\u062D\u062C\u0645 \u0627\u0644\u0645\u0644\u0641: {filesize}",labelFileTypeNotAllowed:"\u0645\u0644\u0641 \u0645\u0646 \u0646\u0648\u0639 \u063A\u064A\u0631 \u0635\u0627\u0644\u062D",fileValidateTypeLabelExpectedTypes:"\u062A\u062A\u0648\u0642\u0639 {allButLastType} \u0645\u0646 {lastType}",imageValidateSizeLabelFormatError:"\u0646\u0648\u0639 \u0627\u0644\u0635\u0648\u0631\u0629 \u063A\u064A\u0631 \u0645\u062F\u0639\u0648\u0645",imageValidateSizeLabelImageSizeTooSmall:"\u0627\u0644\u0635\u0648\u0631\u0629 \u0635\u063A\u064A\u0631 \u062C\u062F\u0627",imageValidateSizeLabelImageSizeTooBig:"\u0627\u0644\u0635\u0648\u0631\u0629 \u0643\u0628\u064A\u0631\u0629 \u062C\u062F\u0627",imageValidateSizeLabelExpectedMinSize:"\u0627\u0644\u062D\u062F \u0627\u0644\u0623\u062F\u0646\u0649 \u0644\u0644\u0623\u0628\u0639\u0627\u062F \u0647\u0648: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"\u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 \u0644\u0644\u0623\u0628\u0639\u0627\u062F \u0647\u0648: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u0627\u0644\u062F\u0642\u0629 \u0636\u0639\u064A\u0641\u0629 \u062C\u062F\u0627",imageValidateSizeLabelImageResolutionTooHigh:"\u0627\u0644\u062F\u0642\u0629 \u0645\u0631\u062A\u0641\u0639\u0629 \u062C\u062F\u0627",imageValidateSizeLabelExpectedMinResolution:"\u0623\u0642\u0644 \u062F\u0642\u0629: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u0623\u0642\u0635\u0649 \u062F\u0642\u0629: {maxResolution}"};// node_modules/filepond/locale/cs-cz.js
var cs_cz_default={labelIdle:"P\u0159et\xE1hn\u011Bte soubor sem (drag&drop) nebo <span class=\"filepond--label-action\"> Vyhledat </span>",labelInvalidField:"Pole obsahuje chybn\xE9 soubory",labelFileWaitingForSize:"Zji\u0161\u0165uje se velikost",labelFileSizeNotAvailable:"Velikost nen\xED zn\xE1m\xE1",labelFileLoading:"P\u0159en\xE1\u0161\xED se",labelFileLoadError:"Chyba p\u0159i p\u0159enosu",labelFileProcessing:"Prob\xEDh\xE1 upload",labelFileProcessingComplete:"Upload dokon\u010Den",labelFileProcessingAborted:"Upload stornov\xE1n",labelFileProcessingError:"Chyba p\u0159i uploadu",labelFileProcessingRevertError:"Chyba p\u0159i obnov\u011B",labelFileRemoveError:"Chyba p\u0159i odstran\u011Bn\xED",labelTapToCancel:"klepn\u011Bte pro storno",labelTapToRetry:"klepn\u011Bte pro opakov\xE1n\xED",labelTapToUndo:"klepn\u011Bte pro vr\xE1cen\xED",labelButtonRemoveItem:"Odstranit",labelButtonAbortItemLoad:"Storno",labelButtonRetryItemLoad:"Opakovat",labelButtonAbortItemProcessing:"Zp\u011Bt",labelButtonUndoItemProcessing:"Vr\xE1tit",labelButtonRetryItemProcessing:"Opakovat",labelButtonProcessItem:"Upload",labelMaxFileSizeExceeded:"Soubor je p\u0159\xEDli\u0161 velk\xFD",labelMaxFileSize:"Nejv\u011Bt\u0161\xED velikost souboru je {filesize}",labelMaxTotalFileSizeExceeded:"P\u0159ekro\u010Dena maxim\xE1ln\xED celkov\xE1 velikost souboru",labelMaxTotalFileSize:"Maxim\xE1ln\xED celkov\xE1 velikost souboru je {filesize}",labelFileTypeNotAllowed:"Soubor je nespr\xE1vn\xE9ho typu",fileValidateTypeLabelExpectedTypes:"O\u010Dek\xE1v\xE1 se {allButLastType} nebo {lastType}",imageValidateSizeLabelFormatError:"Obr\xE1zek tohoto typu nen\xED podporov\xE1n",imageValidateSizeLabelImageSizeTooSmall:"Obr\xE1zek je p\u0159\xEDli\u0161 mal\xFD",imageValidateSizeLabelImageSizeTooBig:"Obr\xE1zek je p\u0159\xEDli\u0161 velk\xFD",imageValidateSizeLabelExpectedMinSize:"Minim\xE1ln\xED rozm\u011Br je {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maxim\xE1ln\xED rozm\u011Br je {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Rozli\u0161en\xED je p\u0159\xEDli\u0161 mal\xE9",imageValidateSizeLabelImageResolutionTooHigh:"Rozli\u0161en\xED je p\u0159\xEDli\u0161 velk\xE9",imageValidateSizeLabelExpectedMinResolution:"Minim\xE1ln\xED rozli\u0161en\xED je {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maxim\xE1ln\xED rozli\u0161en\xED je {maxResolution}"};// node_modules/filepond/locale/da-dk.js
var da_dk_default={labelIdle:'Tr\xE6k & slip filer eller <span class = "filepond - label-action"> Gennemse </span>',labelInvalidField:"Felt indeholder ugyldige filer",labelFileWaitingForSize:"Venter p\xE5 st\xF8rrelse",labelFileSizeNotAvailable:"St\xF8rrelse ikke tilg\xE6ngelig",labelFileLoading:"Loader",labelFileLoadError:"Load fejlede",labelFileProcessing:"Uploader",labelFileProcessingComplete:"Upload f\xE6rdig",labelFileProcessingAborted:"Upload annulleret",labelFileProcessingError:"Upload fejlede",labelFileProcessingRevertError:"Fortryd fejlede",labelFileRemoveError:"Fjern fejlede",labelTapToCancel:"tryk for at annullere",labelTapToRetry:"tryk for at pr\xF8ve igen",labelTapToUndo:"tryk for at fortryde",labelButtonRemoveItem:"Fjern",labelButtonAbortItemLoad:"Annuller",labelButtonRetryItemLoad:"Fors\xF8g igen",labelButtonAbortItemProcessing:"Annuller",labelButtonUndoItemProcessing:"Fortryd",labelButtonRetryItemProcessing:"Pr\xF8v igen",labelButtonProcessItem:"Upload",labelMaxFileSizeExceeded:"Filen er for stor",labelMaxFileSize:"Maksimal filst\xF8rrelse er {filesize}",labelMaxTotalFileSizeExceeded:"Maksimal totalst\xF8rrelse overskredet",labelMaxTotalFileSize:"Maksimal total filst\xF8rrelse er {filesize}",labelFileTypeNotAllowed:"Ugyldig filtype",fileValidateTypeLabelExpectedTypes:"Forventer {allButLastType} eller {lastType}",imageValidateSizeLabelFormatError:"Ugyldigt format",imageValidateSizeLabelImageSizeTooSmall:"Billedet er for lille",imageValidateSizeLabelImageSizeTooBig:"Billedet er for stort",imageValidateSizeLabelExpectedMinSize:"Minimum st\xF8rrelse er {minBredde} \xD7 {minH\xF8jde}",imageValidateSizeLabelExpectedMaxSize:"Maksimal st\xF8rrelse er {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"For lav opl\xF8sning",imageValidateSizeLabelImageResolutionTooHigh:"For h\xF8j opl\xF8sning",imageValidateSizeLabelExpectedMinResolution:"Minimum opl\xF8sning er {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maksimal opl\xF8sning er {maxResolution}"};// node_modules/filepond/locale/de-de.js
var de_de_default={labelIdle:'Dateien ablegen oder <span class="filepond--label-action"> ausw\xE4hlen </span>',labelInvalidField:"Feld beinhaltet ung\xFCltige Dateien",labelFileWaitingForSize:"Dateigr\xF6\xDFe berechnen",labelFileSizeNotAvailable:"Dateigr\xF6\xDFe nicht verf\xFCgbar",labelFileLoading:"Laden",labelFileLoadError:"Fehler beim Laden",labelFileProcessing:"Upload l\xE4uft",labelFileProcessingComplete:"Upload abgeschlossen",labelFileProcessingAborted:"Upload abgebrochen",labelFileProcessingError:"Fehler beim Upload",labelFileProcessingRevertError:"Fehler beim Wiederherstellen",labelFileRemoveError:"Fehler beim L\xF6schen",labelTapToCancel:"abbrechen",labelTapToRetry:"erneut versuchen",labelTapToUndo:"r\xFCckg\xE4ngig",labelButtonRemoveItem:"Entfernen",labelButtonAbortItemLoad:"Verwerfen",labelButtonRetryItemLoad:"Erneut versuchen",labelButtonAbortItemProcessing:"Abbrechen",labelButtonUndoItemProcessing:"R\xFCckg\xE4ngig",labelButtonRetryItemProcessing:"Erneut versuchen",labelButtonProcessItem:"Upload",labelMaxFileSizeExceeded:"Datei ist zu gro\xDF",labelMaxFileSize:"Maximale Dateigr\xF6\xDFe: {filesize}",labelMaxTotalFileSizeExceeded:"Maximale gesamte Dateigr\xF6\xDFe \xFCberschritten",labelMaxTotalFileSize:"Maximale gesamte Dateigr\xF6\xDFe: {filesize}",labelFileTypeNotAllowed:"Dateityp ung\xFCltig",fileValidateTypeLabelExpectedTypes:"Erwartet {allButLastType} oder {lastType}",imageValidateSizeLabelFormatError:"Bildtyp nicht unterst\xFCtzt",imageValidateSizeLabelImageSizeTooSmall:"Bild ist zu klein",imageValidateSizeLabelImageSizeTooBig:"Bild ist zu gro\xDF",imageValidateSizeLabelExpectedMinSize:"Mindestgr\xF6\xDFe: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximale Gr\xF6\xDFe: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Aufl\xF6sung ist zu niedrig",imageValidateSizeLabelImageResolutionTooHigh:"Aufl\xF6sung ist zu hoch",imageValidateSizeLabelExpectedMinResolution:"Mindestaufl\xF6sung: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maximale Aufl\xF6sung: {maxResolution}"};// node_modules/filepond/locale/en-en.js
var en_en_default={labelIdle:'Drag & Drop your files or <span class="filepond--label-action"> Browse </span>',labelInvalidField:"Field contains invalid files",labelFileWaitingForSize:"Waiting for size",labelFileSizeNotAvailable:"Size not available",labelFileLoading:"Loading",labelFileLoadError:"Error during load",labelFileProcessing:"Uploading",labelFileProcessingComplete:"Upload complete",labelFileProcessingAborted:"Upload cancelled",labelFileProcessingError:"Error during upload",labelFileProcessingRevertError:"Error during revert",labelFileRemoveError:"Error during remove",labelTapToCancel:"tap to cancel",labelTapToRetry:"tap to retry",labelTapToUndo:"tap to undo",labelButtonRemoveItem:"Remove",labelButtonAbortItemLoad:"Abort",labelButtonRetryItemLoad:"Retry",labelButtonAbortItemProcessing:"Cancel",labelButtonUndoItemProcessing:"Undo",labelButtonRetryItemProcessing:"Retry",labelButtonProcessItem:"Upload",labelMaxFileSizeExceeded:"File is too large",labelMaxFileSize:"Maximum file size is {filesize}",labelMaxTotalFileSizeExceeded:"Maximum total size exceeded",labelMaxTotalFileSize:"Maximum total file size is {filesize}",labelFileTypeNotAllowed:"File of invalid type",fileValidateTypeLabelExpectedTypes:"Expects {allButLastType} or {lastType}",imageValidateSizeLabelFormatError:"Image type not supported",imageValidateSizeLabelImageSizeTooSmall:"Image is too small",imageValidateSizeLabelImageSizeTooBig:"Image is too big",imageValidateSizeLabelExpectedMinSize:"Minimum size is {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximum size is {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Resolution is too low",imageValidateSizeLabelImageResolutionTooHigh:"Resolution is too high",imageValidateSizeLabelExpectedMinResolution:"Minimum resolution is {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maximum resolution is {maxResolution}"};// node_modules/filepond/locale/es-es.js
var es_es_default={labelIdle:'Arrastra y suelta tus archivos o <span class = "filepond--label-action"> Examinar <span>',labelInvalidField:"El campo contiene archivos inv\xE1lidos",labelFileWaitingForSize:"Esperando tama\xF1o",labelFileSizeNotAvailable:"Tama\xF1o no disponible",labelFileLoading:"Cargando",labelFileLoadError:"Error durante la carga",labelFileProcessing:"Cargando",labelFileProcessingComplete:"Carga completa",labelFileProcessingAborted:"Carga cancelada",labelFileProcessingError:"Error durante la carga",labelFileProcessingRevertError:"Error durante la reversi\xF3n",labelFileRemoveError:"Error durante la eliminaci\xF3n",labelTapToCancel:"toca para cancelar",labelTapToRetry:"tocar para volver a intentar",labelTapToUndo:"tocar para deshacer",labelButtonRemoveItem:"Eliminar",labelButtonAbortItemLoad:"Abortar",labelButtonRetryItemLoad:"Reintentar",labelButtonAbortItemProcessing:"Cancelar",labelButtonUndoItemProcessing:"Deshacer",labelButtonRetryItemProcessing:"Reintentar",labelButtonProcessItem:"Cargar",labelMaxFileSizeExceeded:"El archivo es demasiado grande",labelMaxFileSize:"El tama\xF1o m\xE1ximo del archivo es {filesize}",labelMaxTotalFileSizeExceeded:"Tama\xF1o total m\xE1ximo excedido",labelMaxTotalFileSize:"El tama\xF1o total m\xE1ximo del archivo es {filesize}",labelFileTypeNotAllowed:"Archivo de tipo no v\xE1lido",fileValidateTypeLabelExpectedTypes:"Espera {allButLastType} o {lastType}",imageValidateSizeLabelFormatError:"Tipo de imagen no compatible",imageValidateSizeLabelImageSizeTooSmall:"La imagen es demasiado peque\xF1a",imageValidateSizeLabelImageSizeTooBig:"La imagen es demasiado grande",imageValidateSizeLabelExpectedMinSize:"El tama\xF1o m\xEDnimo es {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"El tama\xF1o m\xE1ximo es {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"La resoluci\xF3n es demasiado baja",imageValidateSizeLabelImageResolutionTooHigh:"La resoluci\xF3n es demasiado alta",imageValidateSizeLabelExpectedMinResolution:"La resoluci\xF3n m\xEDnima es {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"La resoluci\xF3n m\xE1xima es {maxResolution}"};// node_modules/filepond/locale/fa_ir.js
var fa_ir_default={labelIdle:"\u0641\u0627\u06CC\u0644 \u0631\u0627 \u0627\u06CC\u0646\u062C\u0627 \u0628\u06A9\u0634\u06CC\u062F \u0648 \u0631\u0647\u0627 \u06A9\u0646\u06CC\u062F\u060C \u06CC\u0627 <span class=\"filepond--label-action\"> \u062C\u0633\u062A\u062C\u0648 \u06A9\u0646\u06CC\u062F </span>",labelInvalidField:"\u0641\u06CC\u0644\u062F \u062F\u0627\u0631\u0627\u06CC \u0641\u0627\u06CC\u0644 \u0647\u0627\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631 \u0627\u0633\u062A",labelFileWaitingForSize:"Waiting for size",labelFileSizeNotAvailable:"\u062D\u062C\u0645 \u0641\u0627\u06CC\u0644 \u0645\u062C\u0627\u0632 \u0646\u06CC\u0633\u062A",labelFileLoading:"\u062F\u0631\u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC",labelFileLoadError:"\u062E\u0637\u0627 \u062F\u0631 \u0632\u0645\u0627\u0646 \u0627\u062C\u0631\u0627",labelFileProcessing:"\u062F\u0631\u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC",labelFileProcessingComplete:"\u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u06A9\u0627\u0645\u0644 \u0634\u062F",labelFileProcessingAborted:"\u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0644\u063A\u0648 \u0634\u062F",labelFileProcessingError:"\u062E\u0637\u0627 \u062F\u0631 \u0632\u0645\u0627\u0646 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC",labelFileProcessingRevertError:"\u062E\u0637\u0627 \u062F\u0631 \u0632\u0645\u0627\u0646 \u062D\u0630\u0641",labelFileRemoveError:"\u062E\u0637\u0627 \u062F\u0631 \u0632\u0645\u0627\u0646 \u062D\u0630\u0641",labelTapToCancel:"\u0628\u0631\u0627\u06CC \u0644\u063A\u0648 \u0636\u0631\u0628\u0647 \u0628\u0632\u0646\u06CC\u062F",labelTapToRetry:"\u0628\u0631\u0627\u06CC \u062A\u06A9\u0631\u0627\u0631 \u06A9\u0644\u06CC\u06A9 \u06A9\u0646\u06CC\u062F",labelTapToUndo:"\u0628\u0631\u0627\u06CC \u0628\u0631\u06AF\u0634\u062A \u06A9\u0644\u06CC\u06A9 \u06A9\u0646\u06CC\u062F",labelButtonRemoveItem:"\u062D\u0630\u0641",labelButtonAbortItemLoad:"\u0644\u063A\u0648",labelButtonRetryItemLoad:"\u062A\u06A9\u0631\u0627\u0631",labelButtonAbortItemProcessing:"\u0644\u063A\u0648",labelButtonUndoItemProcessing:"\u0628\u0631\u06AF\u0634\u062A",labelButtonRetryItemProcessing:"\u062A\u06A9\u0631\u0627\u0631",labelButtonProcessItem:"\u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC",labelMaxFileSizeExceeded:"\u0641\u0627\u06CC\u0644 \u0628\u0633\u06CC\u0627\u0631 \u062D\u062C\u06CC\u0645 \u0627\u0633\u062A",labelMaxFileSize:"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0645\u062C\u0627\u0632 \u0641\u0627\u06CC\u0644 {filesize} \u0627\u0633\u062A",labelMaxTotalFileSizeExceeded:"\u0627\u0632 \u062D\u062F\u0627\u06A9\u062B\u0631 \u062D\u062C\u0645 \u0641\u0627\u06CC\u0644 \u0628\u06CC\u0634\u062A\u0631 \u0634\u062F",labelMaxTotalFileSize:"\u062D\u062F\u0627\u06A9\u062B\u0631 \u062D\u062C\u0645 \u0641\u0627\u06CC\u0644 {filesize} \u0627\u0633\u062A",labelFileTypeNotAllowed:"\u0646\u0648\u0639 \u0641\u0627\u06CC\u0644 \u0646\u0627\u0645\u0639\u062A\u0628\u0631 \u0627\u0633\u062A",fileValidateTypeLabelExpectedTypes:"\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631 {allButLastType} \u06CC\u0627 {lastType}",imageValidateSizeLabelFormatError:"\u0641\u0631\u0645\u062A \u062A\u0635\u0648\u06CC\u0631 \u067E\u0634\u062A\u06CC\u0628\u0627\u0646\u06CC \u0646\u0645\u06CC \u0634\u0648\u062F",imageValidateSizeLabelImageSizeTooSmall:"\u062A\u0635\u0648\u06CC\u0631 \u0628\u0633\u06CC\u0627\u0631 \u06A9\u0648\u0686\u06A9 \u0627\u0633\u062A",imageValidateSizeLabelImageSizeTooBig:"\u062A\u0635\u0648\u06CC\u0631 \u0628\u0633\u06CC\u0627\u0631 \u0628\u0632\u0631\u06AF \u0627\u0633\u062A",imageValidateSizeLabelExpectedMinSize:"\u062D\u062F\u0627\u0642\u0644 \u0627\u0646\u062F\u0627\u0632\u0647 {minWidth} \xD7 {minHeight} \u0627\u0633\u062A",imageValidateSizeLabelExpectedMaxSize:"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0627\u0646\u062F\u0627\u0632\u0647 {maxWidth} \xD7 {maxHeight} \u0627\u0633\u062A",imageValidateSizeLabelImageResolutionTooLow:"\u0648\u0636\u0648\u062D \u062A\u0635\u0648\u06CC\u0631 \u0628\u0633\u06CC\u0627\u0631 \u06A9\u0645 \u0627\u0633\u062A",imageValidateSizeLabelImageResolutionTooHigh:"\u0648\u0636\u0648\u0639 \u062A\u0635\u0648\u06CC\u0631 \u0628\u0633\u06CC\u0627\u0631 \u0632\u06CC\u0627\u062F \u0627\u0633\u062A",imageValidateSizeLabelExpectedMinResolution:"\u062D\u062F\u0627\u0642\u0644 \u0648\u0636\u0648\u062D \u062A\u0635\u0648\u06CC\u0631 {minResolution} \u0627\u0633\u062A",imageValidateSizeLabelExpectedMaxResolution:"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0648\u0636\u0648\u062D \u062A\u0635\u0648\u06CC\u0631 {maxResolution} \u0627\u0633\u062A"};// node_modules/filepond/locale/fi-fi.js
var fi_fi_default={labelIdle:'Ved\xE4 ja pudota tiedostoja tai <span class="filepond--label-action"> Selaa </span>',labelInvalidField:"Kent\xE4ss\xE4 on virheellisi\xE4 tiedostoja",labelFileWaitingForSize:"Odotetaan kokoa",labelFileSizeNotAvailable:"Kokoa ei saatavilla",labelFileLoading:"Ladataan",labelFileLoadError:"Virhe latauksessa",labelFileProcessing:"L\xE4hetet\xE4\xE4n",labelFileProcessingComplete:"L\xE4hetys valmis",labelFileProcessingAborted:"L\xE4hetys peruttu",labelFileProcessingError:"Virhe l\xE4hetyksess\xE4",labelFileProcessingRevertError:"Virhe palautuksessa",labelFileRemoveError:"Virhe poistamisessa",labelTapToCancel:"peruuta napauttamalla",labelTapToRetry:"yrit\xE4 uudelleen napauttamalla",labelTapToUndo:"kumoa napauttamalla",labelButtonRemoveItem:"Poista",labelButtonAbortItemLoad:"Keskeyt\xE4",labelButtonRetryItemLoad:"Yrit\xE4 uudelleen",labelButtonAbortItemProcessing:"Peruuta",labelButtonUndoItemProcessing:"Kumoa",labelButtonRetryItemProcessing:"Yrit\xE4 uudelleen",labelButtonProcessItem:"L\xE4het\xE4",labelMaxFileSizeExceeded:"Tiedoston koko on liian suuri",labelMaxFileSize:"Tiedoston maksimikoko on {filesize}",labelMaxTotalFileSizeExceeded:"Tiedostojen yhdistetty maksimikoko ylitetty",labelMaxTotalFileSize:"Tiedostojen yhdistetty maksimikoko on {filesize}",labelFileTypeNotAllowed:"Tiedostotyyppi\xE4 ei sallita",fileValidateTypeLabelExpectedTypes:"Sallitaan {allButLastType} tai {lastType}",imageValidateSizeLabelFormatError:"Kuvatyyppi\xE4 ei tueta",imageValidateSizeLabelImageSizeTooSmall:"Kuva on liian pieni",imageValidateSizeLabelImageSizeTooBig:"Kuva on liian suuri",imageValidateSizeLabelExpectedMinSize:"Minimikoko on {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maksimikoko on {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Resoluutio on liian pieni",imageValidateSizeLabelImageResolutionTooHigh:"Resoluutio on liian suuri",imageValidateSizeLabelExpectedMinResolution:"Minimiresoluutio on {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maksimiresoluutio on {maxResolution}"};// node_modules/filepond/locale/fr-fr.js
var fr_fr_default={labelIdle:'Faites glisser vos fichiers ou <span class = "filepond--label-action"> Parcourir <span>',labelInvalidField:"Le champ contient des fichiers invalides",labelFileWaitingForSize:"En attente de taille",labelFileSizeNotAvailable:"Taille non disponible",labelFileLoading:"Chargement",labelFileLoadError:"Erreur durant le chargement",labelFileProcessing:"Traitement",labelFileProcessingComplete:"Traitement effectu\xE9",labelFileProcessingAborted:"Traitement interrompu",labelFileProcessingError:"Erreur durant le traitement",labelFileProcessingRevertError:"Erreur durant la restauration",labelFileRemoveError:"Erreur durant la suppression",labelTapToCancel:"appuyer pour annuler",labelTapToRetry:"appuyer pour r\xE9essayer",labelTapToUndo:"appuyer pour revenir en arri\xE8re",labelButtonRemoveItem:"Retirer",labelButtonAbortItemLoad:"Annuler",labelButtonRetryItemLoad:"Recommencer",labelButtonAbortItemProcessing:"Annuler",labelButtonUndoItemProcessing:"Revenir en arri\xE8re",labelButtonRetryItemProcessing:"Recommencer",labelButtonProcessItem:"Transf\xE9rer",labelMaxFileSizeExceeded:"Le fichier est trop volumineux",labelMaxFileSize:"La taille maximale de fichier est {filesize}",labelMaxTotalFileSizeExceeded:"Taille totale maximale d\xE9pass\xE9e",labelMaxTotalFileSize:"La taille totale maximale des fichiers est {filesize}",labelFileTypeNotAllowed:"Fichier non valide",fileValidateTypeLabelExpectedTypes:"Attendu {allButLastType} ou {lastType}",imageValidateSizeLabelFormatError:"Type d'image non pris en charge",imageValidateSizeLabelImageSizeTooSmall:"L'image est trop petite",imageValidateSizeLabelImageSizeTooBig:"L'image est trop grande",imageValidateSizeLabelExpectedMinSize:"La taille minimale est {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"La taille maximale est {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"La r\xE9solution est trop faible",imageValidateSizeLabelImageResolutionTooHigh:"La r\xE9solution est trop \xE9lev\xE9e",imageValidateSizeLabelExpectedMinResolution:"La r\xE9solution minimale est {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"La r\xE9solution maximale est {maxResolution}"};// node_modules/filepond/locale/hu-hu.js
var hu_hu_default={labelIdle:'Mozgasd ide a f\xE1jlt a felt\xF6lt\xE9shez, vagy <span class="filepond--label-action"> tall\xF3z\xE1s </span>',labelInvalidField:"A mez\u0151 \xE9rv\xE9nytelen f\xE1jlokat tartalmaz",labelFileWaitingForSize:"F\xE1ljm\xE9ret kisz\xE1mol\xE1sa",labelFileSizeNotAvailable:"A f\xE1jlm\xE9ret nem el\xE9rhet\u0151",labelFileLoading:"T\xF6lt\xE9s",labelFileLoadError:"Hiba a bet\xF6lt\xE9s sor\xE1n",labelFileProcessing:"Felt\xF6lt\xE9s",labelFileProcessingComplete:"Sikeres felt\xF6lt\xE9s",labelFileProcessingAborted:"A felt\xF6lt\xE9s megszak\xEDtva",labelFileProcessingError:"Hiba t\xF6rt\xE9nt a felt\xF6lt\xE9s sor\xE1n",labelFileProcessingRevertError:"Hiba a vissza\xE1ll\xEDt\xE1s sor\xE1n",labelFileRemoveError:"Hiba t\xF6rt\xE9nt az elt\xE1vol\xEDt\xE1s sor\xE1n",labelTapToCancel:"koppints a t\xF6rl\xE9shez",labelTapToRetry:"koppints az \xFAjrakezd\xE9shez",labelTapToUndo:"koppints a visszavon\xE1shoz",labelButtonRemoveItem:"Elt\xE1vol\xEDt\xE1s",labelButtonAbortItemLoad:"Megszak\xEDt\xE1s",labelButtonRetryItemLoad:"\xDAjrapr\xF3b\xE1lkoz\xE1s",labelButtonAbortItemProcessing:"Megszak\xEDt\xE1s",labelButtonUndoItemProcessing:"Visszavon\xE1s",labelButtonRetryItemProcessing:"\xDAjrapr\xF3b\xE1lkoz\xE1s",labelButtonProcessItem:"Felt\xF6lt\xE9s",labelMaxFileSizeExceeded:"A f\xE1jl t\xFAll\xE9pte a maxim\xE1lis m\xE9retet",labelMaxFileSize:"Maxim\xE1lis f\xE1jlm\xE9ret: {filesize}",labelMaxTotalFileSizeExceeded:"T\xFAll\xE9pte a maxim\xE1lis teljes m\xE9retet",labelMaxTotalFileSize:"A maxim\xE1is teljes f\xE1jlm\xE9ret: {filesize}",labelFileTypeNotAllowed:"\xC9rv\xE9nytelen t\xEDpus\xFA f\xE1jl",fileValidateTypeLabelExpectedTypes:"Enged\xE9lyezett t\xEDpusok {allButLastType} vagy {lastType}",imageValidateSizeLabelFormatError:"A k\xE9pt\xEDpus nem t\xE1mogatott",imageValidateSizeLabelImageSizeTooSmall:"A k\xE9p t\xFAl kicsi",imageValidateSizeLabelImageSizeTooBig:"A k\xE9p t\xFAl nagy",imageValidateSizeLabelExpectedMinSize:"Minimum m\xE9ret: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximum m\xE9ret: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"A felbont\xE1s t\xFAl alacsony",imageValidateSizeLabelImageResolutionTooHigh:"A felbont\xE1s t\xFAl magas",imageValidateSizeLabelExpectedMinResolution:"Minim\xE1is felbont\xE1s: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maxim\xE1lis felbont\xE1s: {maxResolution}"};// node_modules/filepond/locale/id-id.js
var id_id_default={labelIdle:'Seret dan Jatuhkan file Anda atau <span class="filepond--label-action">Jelajahi</span>',labelInvalidField:"Field berisi file tidak valid",labelFileWaitingForSize:"Menunggu ukuran",labelFileSizeNotAvailable:"Ukuran tidak tersedia",labelFileLoading:"Memuat",labelFileLoadError:"Kesalahan saat memuat",labelFileProcessing:"Mengunggah",labelFileProcessingComplete:"Unggahan selesai",labelFileProcessingAborted:"Unggahan dibatalkan",labelFileProcessingError:"Kesalahan saat mengunggah",labelFileProcessingRevertError:"Kesalahan saat pengembalian",labelFileRemoveError:"Kesalahan saat menghapus",labelTapToCancel:"ketuk untuk membatalkan",labelTapToRetry:"ketuk untuk mencoba lagi",labelTapToUndo:"ketuk untuk mengurungkan",labelButtonRemoveItem:"Hapus",labelButtonAbortItemLoad:"Batal",labelButtonRetryItemLoad:"Coba Kembali",labelButtonAbortItemProcessing:"Batal",labelButtonUndoItemProcessing:"Batal",labelButtonRetryItemProcessing:"Coba Kembali",labelButtonProcessItem:"Unggah",labelMaxFileSizeExceeded:"File terlalu besar",labelMaxFileSize:"Ukuran file maksimum adalah {filesize}",labelMaxTotalFileSizeExceeded:"Jumlah file maksimum terlampaui",labelMaxTotalFileSize:"Jumlah file maksimum adalah {filesize}",labelFileTypeNotAllowed:"Jenis file tidak valid",fileValidateTypeLabelExpectedTypes:"Mengharapkan {allButLastType} atau {lastType}",imageValidateSizeLabelFormatError:"Jenis gambar tidak didukung",imageValidateSizeLabelImageSizeTooSmall:"Gambar terlalu kecil",imageValidateSizeLabelImageSizeTooBig:"Gambar terlalu besar",imageValidateSizeLabelExpectedMinSize:"Ukuran minimum adalah {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Ukuran maksimum adalah {minWidth} \xD7 {minHeight}",imageValidateSizeLabelImageResolutionTooLow:"Resolusi terlalu rendah",imageValidateSizeLabelImageResolutionTooHigh:"Resolusi terlalu tinggi",imageValidateSizeLabelExpectedMinResolution:"Resolusi minimum adalah {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Resolusi maksimum adalah {maxResolution}"};// node_modules/filepond/locale/it-it.js
var it_it_default={labelIdle:'Trascina e rilascia i tuoi file oppure <span class = "filepond--label-action"> Carica <span>',labelInvalidField:"Il campo contiene dei file non validi",labelFileWaitingForSize:"Aspettando le dimensioni",labelFileSizeNotAvailable:"Dimensioni non disponibili",labelFileLoading:"Caricamento",labelFileLoadError:"Errore durante il caricamento",labelFileProcessing:"Caricamento",labelFileProcessingComplete:"Caricamento completato",labelFileProcessingAborted:"Caricamento cancellato",labelFileProcessingError:"Errore durante il caricamento",labelFileProcessingRevertError:"Errore durante il ripristino",labelFileRemoveError:"Errore durante l'eliminazione",labelTapToCancel:"tocca per cancellare",labelTapToRetry:"tocca per riprovare",labelTapToUndo:"tocca per ripristinare",labelButtonRemoveItem:"Elimina",labelButtonAbortItemLoad:"Cancella",labelButtonRetryItemLoad:"Ritenta",labelButtonAbortItemProcessing:"Camcella",labelButtonUndoItemProcessing:"Indietro",labelButtonRetryItemProcessing:"Ritenta",labelButtonProcessItem:"Carica",labelMaxFileSizeExceeded:"Il peso del file \xE8 eccessivo",labelMaxFileSize:"Il peso massimo del file \xE8 {filesize}",labelMaxTotalFileSizeExceeded:"Dimensione totale massima superata",labelMaxTotalFileSize:"La dimensione massima totale del file \xE8 {filesize}",labelFileTypeNotAllowed:"File non supportato",fileValidateTypeLabelExpectedTypes:"Aspetta {allButLastType} o {lastType}",imageValidateSizeLabelFormatError:"Tipo di immagine non compatibile",imageValidateSizeLabelImageSizeTooSmall:"L'immagine \xE8 troppo piccola",imageValidateSizeLabelImageSizeTooBig:"L'immagine \xE8 troppo grande",imageValidateSizeLabelExpectedMinSize:"La dimensione minima \xE8 {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"La dimensione massima \xE8 {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"La risoluzione \xE8 troppo bassa",imageValidateSizeLabelImageResolutionTooHigh:"La risoluzione \xE8 troppo alta",imageValidateSizeLabelExpectedMinResolution:"La risoluzione minima \xE8 {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"La risoluzione massima \xE8 {maxResolution}"};// node_modules/filepond/locale/nl-nl.js
var nl_nl_default={labelIdle:'Drag & Drop je bestanden of <span class="filepond--label-action"> Bladeren </span>',labelInvalidField:"Veld bevat ongeldige bestanden",labelFileWaitingForSize:"Wachten op grootte",labelFileSizeNotAvailable:"Grootte niet beschikbaar",labelFileLoading:"Laden",labelFileLoadError:"Fout tijdens laden",labelFileProcessing:"Uploaden",labelFileProcessingComplete:"Upload afgerond",labelFileProcessingAborted:"Upload geannuleerd",labelFileProcessingError:"Fout tijdens upload",labelFileProcessingRevertError:"Fout bij herstellen",labelFileRemoveError:"Fout bij verwijderen",labelTapToCancel:"tik om te annuleren",labelTapToRetry:"tik om opnieuw te proberen",labelTapToUndo:"tik om ongedaan te maken",labelButtonRemoveItem:"Verwijderen",labelButtonAbortItemLoad:"Afbreken",labelButtonRetryItemLoad:"Opnieuw proberen",labelButtonAbortItemProcessing:"Annuleren",labelButtonUndoItemProcessing:"Ongedaan maken",labelButtonRetryItemProcessing:"Opnieuw proberen",labelButtonProcessItem:"Upload",labelMaxFileSizeExceeded:"Bestand is te groot",labelMaxFileSize:"Maximale bestandsgrootte is {filesize}",labelMaxTotalFileSizeExceeded:"Maximale totale grootte overschreden",labelMaxTotalFileSize:"Maximale totale bestandsgrootte is {filesize}",labelFileTypeNotAllowed:"Ongeldig bestandstype",fileValidateTypeLabelExpectedTypes:"Verwacht {allButLastType} of {lastType}",imageValidateSizeLabelFormatError:"Afbeeldingstype niet ondersteund",imageValidateSizeLabelImageSizeTooSmall:"Afbeelding is te klein",imageValidateSizeLabelImageSizeTooBig:"Afbeelding is te groot",imageValidateSizeLabelExpectedMinSize:"Minimale afmeting is {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximale afmeting is {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Resolutie is te laag",imageValidateSizeLabelImageResolutionTooHigh:"Resolution is too high",imageValidateSizeLabelExpectedMinResolution:"Minimale resolutie is {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maximale resolutie is {maxResolution}"};// node_modules/filepond/locale/pl-pl.js
var pl_pl_default={labelIdle:"Przeci\u0105gnij i upu\u015B\u0107 lub <span class=\"filepond--label-action\">wybierz</span> pliki",labelInvalidField:"Nieprawid\u0142owe pliki",labelFileWaitingForSize:"Pobieranie rozmiaru",labelFileSizeNotAvailable:"Nieznany rozmiar",labelFileLoading:"Wczytywanie",labelFileLoadError:"B\u0142\u0105d wczytywania",labelFileProcessing:"Przesy\u0142anie",labelFileProcessingComplete:"Przes\u0142ano",labelFileProcessingAborted:"Przerwano",labelFileProcessingError:"Przesy\u0142anie nie powiod\u0142o si\u0119",labelFileProcessingRevertError:"Co\u015B posz\u0142o nie tak",labelFileRemoveError:"Nieudane usuni\u0119cie",labelTapToCancel:"Anuluj",labelTapToRetry:"Pon\xF3w",labelTapToUndo:"Cofnij",labelButtonRemoveItem:"Usu\u0144",labelButtonAbortItemLoad:"Przerwij",labelButtonRetryItemLoad:"Pon\xF3w",labelButtonAbortItemProcessing:"Anuluj",labelButtonUndoItemProcessing:"Cofnij",labelButtonRetryItemProcessing:"Pon\xF3w",labelButtonProcessItem:"Prze\u015Blij",labelMaxFileSizeExceeded:"Plik jest zbyt du\u017Cy",labelMaxFileSize:"Dopuszczalna wielko\u015B\u0107 pliku to {filesize}",labelMaxTotalFileSizeExceeded:"Przekroczono \u0142\u0105czny rozmiar plik\xF3w",labelMaxTotalFileSize:"\u0141\u0105czny rozmiar plik\xF3w nie mo\u017Ce przekroczy\u0107 {filesize}",labelFileTypeNotAllowed:"Niedozwolony rodzaj pliku",fileValidateTypeLabelExpectedTypes:"Oczekiwano {allButLastType} lub {lastType}",imageValidateSizeLabelFormatError:"Nieobs\u0142ugiwany format obrazu",imageValidateSizeLabelImageSizeTooSmall:"Obraz jest zbyt ma\u0142y",imageValidateSizeLabelImageSizeTooBig:"Obraz jest zbyt du\u017Cy",imageValidateSizeLabelExpectedMinSize:"Minimalne wymiary obrazu to {minWidth}\xD7{minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maksymalna wymiary obrazu to {maxWidth}\xD7{maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Rozdzielczo\u015B\u0107 jest zbyt niska",imageValidateSizeLabelImageResolutionTooHigh:"Rozdzielczo\u015B\u0107 jest zbyt wysoka",imageValidateSizeLabelExpectedMinResolution:"Minimalna rozdzielczo\u015B\u0107 to {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maksymalna rozdzielczo\u015B\u0107 to {maxResolution}"};// node_modules/filepond/locale/pt-br.js
var pt_br_default={labelIdle:'Arraste e solte os arquivos ou <span class="filepond--label-action"> Clique aqui </span>',labelInvalidField:"Arquivos inv\xE1lidos",labelFileWaitingForSize:"Calculando o tamanho do arquivo",labelFileSizeNotAvailable:"Tamanho do arquivo indispon\xEDvel",labelFileLoading:"Carregando",labelFileLoadError:"Erro durante o carregamento",labelFileProcessing:"Enviando",labelFileProcessingComplete:"Envio finalizado",labelFileProcessingAborted:"Envio cancelado",labelFileProcessingError:"Erro durante o envio",labelFileProcessingRevertError:"Erro ao reverter o envio",labelFileRemoveError:"Erro ao remover o arquivo",labelTapToCancel:"clique para cancelar",labelTapToRetry:"clique para reenviar",labelTapToUndo:"clique para desfazer",labelButtonRemoveItem:"Remover",labelButtonAbortItemLoad:"Abortar",labelButtonRetryItemLoad:"Reenviar",labelButtonAbortItemProcessing:"Cancelar",labelButtonUndoItemProcessing:"Desfazer",labelButtonRetryItemProcessing:"Reenviar",labelButtonProcessItem:"Enviar",labelMaxFileSizeExceeded:"Arquivo \xE9 muito grande",labelMaxFileSize:"O tamanho m\xE1ximo permitido: {filesize}",labelMaxTotalFileSizeExceeded:"Tamanho total dos arquivos excedido",labelMaxTotalFileSize:"Tamanho total permitido: {filesize}",labelFileTypeNotAllowed:"Tipo de arquivo inv\xE1lido",fileValidateTypeLabelExpectedTypes:"Tipos de arquivo suportados s\xE3o {allButLastType} ou {lastType}",imageValidateSizeLabelFormatError:"Tipo de imagem inv\xE1lida",imageValidateSizeLabelImageSizeTooSmall:"Imagem muito pequena",imageValidateSizeLabelImageSizeTooBig:"Imagem muito grande",imageValidateSizeLabelExpectedMinSize:"Tamanho m\xEDnimo permitida: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Tamanho m\xE1ximo permitido: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Resolu\xE7\xE3o muito baixa",imageValidateSizeLabelImageResolutionTooHigh:"Resolu\xE7\xE3o muito alta",imageValidateSizeLabelExpectedMinResolution:"Resolu\xE7\xE3o m\xEDnima permitida: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Resolu\xE7\xE3o m\xE1xima permitida: {maxResolution}"};// node_modules/filepond/locale/ro-ro.js
var ro_ro_default={labelIdle:"Trage \u0219i plaseaz\u0103 fi\u0219iere sau <span class=\"filepond--label-action\"> Caut\u0103-le </span>",labelInvalidField:"C\xE2mpul con\u021Bine fi\u0219iere care nu sunt valide",labelFileWaitingForSize:"\xCEn a\u0219teptarea dimensiunii",labelFileSizeNotAvailable:"Dimensiunea nu este diponibil\u0103",labelFileLoading:"Se \xEEncarc\u0103",labelFileLoadError:"Eroare la \xEEnc\u0103rcare",labelFileProcessing:"Se \xEEncarc\u0103",labelFileProcessingComplete:"\xCEnc\u0103rcare finalizat\u0103",labelFileProcessingAborted:"\xCEnc\u0103rcare anulat\u0103",labelFileProcessingError:"Eroare la \xEEnc\u0103rcare",labelFileProcessingRevertError:"Eroare la anulare",labelFileRemoveError:"Eroare la \u015Ftergere",labelTapToCancel:"apas\u0103 pentru a anula",labelTapToRetry:"apas\u0103 pentru a re\xEEncerca",labelTapToUndo:"apas\u0103 pentru a anula",labelButtonRemoveItem:"\u015Eterge",labelButtonAbortItemLoad:"Anuleaz\u0103",labelButtonRetryItemLoad:"Re\xEEncearc\u0103",labelButtonAbortItemProcessing:"Anuleaz\u0103",labelButtonUndoItemProcessing:"Anuleaz\u0103",labelButtonRetryItemProcessing:"Re\xEEncearc\u0103",labelButtonProcessItem:"\xCEncarc\u0103",labelMaxFileSizeExceeded:"Fi\u0219ierul este prea mare",labelMaxFileSize:"Dimensiunea maxim\u0103 a unui fi\u0219ier este de {filesize}",labelMaxTotalFileSizeExceeded:"Dimensiunea total\u0103 maxim\u0103 a fost dep\u0103\u0219it\u0103",labelMaxTotalFileSize:"Dimensiunea total\u0103 maxim\u0103 a fi\u0219ierelor este de {filesize}",labelFileTypeNotAllowed:"Tipul fi\u0219ierului nu este valid",fileValidateTypeLabelExpectedTypes:"Se a\u0219teapt\u0103 {allButLastType} sau {lastType}",imageValidateSizeLabelFormatError:"Formatul imaginii nu este acceptat",imageValidateSizeLabelImageSizeTooSmall:"Imaginea este prea mic\u0103",imageValidateSizeLabelImageSizeTooBig:"Imaginea este prea mare",imageValidateSizeLabelExpectedMinSize:"M\u0103rimea minim\u0103 este de {maxWidth} x {maxHeight}",imageValidateSizeLabelExpectedMaxSize:"M\u0103rimea maxim\u0103 este de {maxWidth} x {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Rezolu\u021Bia este prea mic\u0103",imageValidateSizeLabelImageResolutionTooHigh:"Rezolu\u021Bia este prea mare",imageValidateSizeLabelExpectedMinResolution:"Rezolu\u021Bia minim\u0103 este de {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Rezolu\u021Bia maxim\u0103 este de {maxResolution}"};// node_modules/filepond/locale/ru-ru.js
var ru_ru_default={labelIdle:"\u041F\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043B\u044B \u0438\u043B\u0438 <span class=\"filepond--label-action\"> \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 </span>",labelInvalidField:"\u041F\u043E\u043B\u0435 \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u0442 \u043D\u0435\u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u044B\u0435 \u0444\u0430\u0439\u043B\u044B",labelFileWaitingForSize:"\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0440\u0430\u0437\u043C\u0435\u0440",labelFileSizeNotAvailable:"\u0420\u0430\u0437\u043C\u0435\u0440 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044F",labelFileLoading:"\u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435",labelFileLoadError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0436\u0438\u0434\u0430\u043D\u0438\u0438",labelFileProcessing:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430",labelFileProcessingComplete:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430",labelFileProcessingAborted:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430",labelFileProcessingError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435",labelFileProcessingRevertError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u043E\u0437\u0432\u0440\u0430\u0442\u0435",labelFileRemoveError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438",labelTapToCancel:"\u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u0434\u043B\u044F \u043E\u0442\u043C\u0435\u043D\u044B",labelTapToRetry:"\u043D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C \u043F\u043E\u043F\u044B\u0442\u043A\u0443",labelTapToUndo:"\u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u0434\u043B\u044F \u043E\u0442\u043C\u0435\u043D\u044B \u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0435\u0433\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F",labelButtonRemoveItem:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",labelButtonAbortItemLoad:"\u041F\u0440\u0435\u043A\u0440\u0430\u0449\u0435\u043D\u043E",labelButtonRetryItemLoad:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0435 \u043F\u043E\u043F\u044B\u0442\u043A\u0443",labelButtonAbortItemProcessing:"\u041E\u0442\u043C\u0435\u043D\u0430",labelButtonUndoItemProcessing:"\u041E\u0442\u043C\u0435\u043D\u0430 \u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0435\u0433\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F",labelButtonRetryItemProcessing:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0435 \u043F\u043E\u043F\u044B\u0442\u043A\u0443",labelButtonProcessItem:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430",labelMaxFileSizeExceeded:"\u0424\u0430\u0439\u043B \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0439",labelMaxFileSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430: {filesize}",labelMaxTotalFileSizeExceeded:"\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D \u043C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440",labelMaxTotalFileSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430: {filesize}",labelFileTypeNotAllowed:"\u0424\u0430\u0439\u043B \u043D\u0435\u0432\u0435\u0440\u043D\u043E\u0433\u043E \u0442\u0438\u043F\u0430",fileValidateTypeLabelExpectedTypes:"\u041E\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044F {allButLastType} \u0438\u043B\u0438 {lastType}",imageValidateSizeLabelFormatError:"\u0422\u0438\u043F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044F",imageValidateSizeLabelImageSizeTooSmall:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u043C\u0430\u043B\u0435\u043D\u044C\u043A\u043E\u0435",imageValidateSizeLabelImageSizeTooBig:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0435",imageValidateSizeLabelExpectedMinSize:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u0438\u0435 \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u043D\u0438\u0437\u043A\u043E\u0435",imageValidateSizeLabelImageResolutionTooHigh:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u0438\u0435 \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u0432\u044B\u0441\u043E\u043A\u043E\u0435",imageValidateSizeLabelExpectedMinResolution:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u0438\u0435: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u0438\u0435: {maxResolution}"};// node_modules/filepond/locale/sv_se.js
var sv_se_default={labelIdle:'Drag och sl\xE4pp dina filer eller <span class="filepond--label-action"> Bl\xE4ddra </span>',labelInvalidField:"F\xE4ltet inneh\xE5ller felaktiga filer",labelFileWaitingForSize:"V\xE4ntar p\xE5 storlek",labelFileSizeNotAvailable:"Storleken finns inte tillg\xE4nglig",labelFileLoading:"Laddar",labelFileLoadError:"Fel under laddning",labelFileProcessing:"Laddar upp",labelFileProcessingComplete:"Uppladdning klar",labelFileProcessingAborted:"Uppladdning avbruten",labelFileProcessingError:"Fel under uppladdning",labelFileProcessingRevertError:"Fel under \xE5terst\xE4llning",labelFileRemoveError:"Fel under borttagning",labelTapToCancel:"tryck f\xF6r att avbryta",labelTapToRetry:"tryck f\xF6r att f\xF6rs\xF6ka igen",labelTapToUndo:"tryck f\xF6r att \xE5ngra",labelButtonRemoveItem:"Tabort",labelButtonAbortItemLoad:"Avbryt",labelButtonRetryItemLoad:"F\xF6rs\xF6k igen",labelButtonAbortItemProcessing:"Avbryt",labelButtonUndoItemProcessing:"\xC5ngra",labelButtonRetryItemProcessing:"F\xF6rs\xF6k igen",labelButtonProcessItem:"Ladda upp",labelMaxFileSizeExceeded:"Filen \xE4r f\xF6r stor",labelMaxFileSize:"St\xF6rsta till\xE5tna filstorlek \xE4r {filesize}",labelMaxTotalFileSizeExceeded:"Maximal uppladdningsstorlek uppn\xE5d",labelMaxTotalFileSize:"Maximal uppladdningsstorlek \xE4r {filesize}",labelFileTypeNotAllowed:"Felaktig filtyp",fileValidateTypeLabelExpectedTypes:"Godk\xE4nda filtyper {allButLastType} eller {lastType}",imageValidateSizeLabelFormatError:"Bildtypen saknar st\xF6d",imageValidateSizeLabelImageSizeTooSmall:"Bilden \xE4r f\xF6r liten",imageValidateSizeLabelImageSizeTooBig:"Bilden \xE4r f\xF6r stor",imageValidateSizeLabelExpectedMinSize:"Minimal storlek \xE4r {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximal storlek \xE4r {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"Uppl\xF6sningen \xE4r f\xF6r l\xE5g",imageValidateSizeLabelImageResolutionTooHigh:"Uppl\xF6sningen \xE4r f\xF6r h\xF6g",imageValidateSizeLabelExpectedMinResolution:"Minsta till\xE5tna uppl\xF6sning \xE4r {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"H\xF6gsta till\xE5tna uppl\xF6sning \xE4r {maxResolution}"};// node_modules/filepond/locale/tr-tr.js
var tr_tr_default={labelIdle:"Dosyan\u0131z\u0131 S\xFCr\xFCkleyin & B\u0131rak\u0131n ya da <span class=\"filepond--label-action\"> Se\xE7in </span>",labelInvalidField:"Alan ge\xE7ersiz dosyalar i\xE7eriyor",labelFileWaitingForSize:"Boyut hesaplan\u0131yor",labelFileSizeNotAvailable:"Boyut mevcut de\u011Fil",labelFileLoading:"Y\xFCkleniyor",labelFileLoadError:"Y\xFCkleme s\u0131ras\u0131nda hata olu\u015Ftu",labelFileProcessing:"Y\xFCkleniyor",labelFileProcessingComplete:"Y\xFCkleme tamamland\u0131",labelFileProcessingAborted:"Y\xFCkleme iptal edildi",labelFileProcessingError:"Y\xFCklerken hata olu\u015Ftu",labelFileProcessingRevertError:"Geri \xE7ekerken hata olu\u015Ftu",labelFileRemoveError:"Kald\u0131r\u0131rken hata olu\u015Ftu",labelTapToCancel:"\u0130ptal etmek i\xE7in t\u0131klay\u0131n",labelTapToRetry:"Tekrar denemek i\xE7in t\u0131klay\u0131n",labelTapToUndo:"Geri almak i\xE7in t\u0131klay\u0131n",labelButtonRemoveItem:"Kald\u0131r",labelButtonAbortItemLoad:"\u0130ptal Et",labelButtonRetryItemLoad:"Tekrar dene",labelButtonAbortItemProcessing:"\u0130ptal et",labelButtonUndoItemProcessing:"Geri Al",labelButtonRetryItemProcessing:"Tekrar dene",labelButtonProcessItem:"Y\xFCkle",labelMaxFileSizeExceeded:"Dosya \xE7ok b\xFCy\xFCk",labelMaxFileSize:"En fazla dosya boyutu: {filesize}",labelMaxTotalFileSizeExceeded:"Maximum boyut a\u015F\u0131ld\u0131",labelMaxTotalFileSize:"Maximum dosya boyutu :{filesize}",labelFileTypeNotAllowed:"Ge\xE7ersiz dosya tipi",fileValidateTypeLabelExpectedTypes:"\u015Eu {allButLastType} ya da \u015Fu dosya olmas\u0131 gerekir: {lastType}",imageValidateSizeLabelFormatError:"Resim tipi desteklenmiyor",imageValidateSizeLabelImageSizeTooSmall:"Resim \xE7ok k\xFC\xE7\xFCk",imageValidateSizeLabelImageSizeTooBig:"Resim \xE7ok b\xFCy\xFCk",imageValidateSizeLabelExpectedMinSize:"Minimum boyut {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"Maximum boyut {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\xC7\xF6z\xFCn\xFCrl\xFCk \xE7ok d\xFC\u015F\xFCk",imageValidateSizeLabelImageResolutionTooHigh:"\xC7\xF6z\xFCn\xFCrl\xFCk \xE7ok y\xFCksek",imageValidateSizeLabelExpectedMinResolution:"Minimum \xE7\xF6z\xFCn\xFCrl\xFCk {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"Maximum \xE7\xF6z\xFCn\xFCrl\xFCk {maxResolution}"};// node_modules/filepond/locale/uk-ua.js
var uk_ua_default={labelIdle:"\u041F\u0435\u0440\u0435\u0442\u044F\u0433\u043D\u0456\u0442\u044C \u0444\u0430\u0439\u043B\u0438 \u0430\u0431\u043E <span class=\"filepond--label-action\"> \u0432\u0438\u0431\u0435\u0440\u0456\u0442\u044C </span>",labelInvalidField:"\u041F\u043E\u043B\u0435 \u043C\u0456\u0441\u0442\u0438\u0442\u044C \u043D\u0435\u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0456 \u0444\u0430\u0439\u043B\u0438",labelFileWaitingForSize:"\u0412\u043A\u0430\u0436\u0456\u0442\u044C \u0440\u043E\u0437\u043C\u0456\u0440",labelFileSizeNotAvailable:"\u0420\u043E\u0437\u043C\u0456\u0440 \u043D\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0438\u0439",labelFileLoading:"\u041E\u0447\u0456\u043A\u0443\u0432\u0430\u043D\u043D\u044F",labelFileLoadError:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u043E\u0447\u0456\u043A\u0443\u0432\u0430\u043D\u043D\u0456",labelFileProcessing:"\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F",labelFileProcessingComplete:"\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E",labelFileProcessingAborted:"\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F \u0441\u043A\u0430\u0441\u043E\u0432\u0430\u043D\u043E",labelFileProcessingError:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u0456",labelFileProcessingRevertError:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u0432\u0456\u0434\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u0456",labelFileRemoveError:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0440\u0438 \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043D\u0456",labelTapToCancel:"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438",labelTapToRetry:"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0438 \u0441\u043F\u0440\u043E\u0431\u0443",labelTapToUndo:"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0432\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438 \u043E\u0441\u0442\u0430\u043D\u043D\u044E \u0434\u0456\u044E",labelButtonRemoveItem:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438",labelButtonAbortItemLoad:"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438",labelButtonRetryItemLoad:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0438 \u0441\u043F\u0440\u043E\u0431\u0443",labelButtonAbortItemProcessing:"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438",labelButtonUndoItemProcessing:"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438 \u043E\u0441\u0442\u0430\u043D\u043D\u044E \u0434\u0456\u044E",labelButtonRetryItemProcessing:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0438 \u0441\u043F\u0440\u043E\u0431\u0443",labelButtonProcessItem:"\u0417\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F",labelMaxFileSizeExceeded:"\u0424\u0430\u0439\u043B \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0438\u0439",labelMaxFileSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043C\u0456\u0440 \u0444\u0430\u0439\u043B\u0443: {filesize}",labelMaxTotalFileSizeExceeded:"\u041F\u0435\u0440\u0435\u0432\u0438\u0449\u0435\u043D\u043E \u043C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0438\u0439 \u0437\u0430\u0433\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043C\u0456\u0440",labelMaxTotalFileSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0438\u0439 \u0437\u0430\u0433\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043C\u0456\u0440: {filesize}",labelFileTypeNotAllowed:"\u0424\u043E\u0440\u043C\u0430\u0442 \u0444\u0430\u0439\u043B\u0443 \u043D\u0435 \u043F\u0456\u0434\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F",fileValidateTypeLabelExpectedTypes:"\u041E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F {allButLastType} \u0430\u0431\u043E {lastType}",imageValidateSizeLabelFormatError:"\u0424\u043E\u0440\u043C\u0430\u0442 \u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F \u043D\u0435 \u043F\u0456\u0434\u0442\u0440\u0438\u043C\u0443\u0454\u0442\u044C\u0441\u044F",imageValidateSizeLabelImageSizeTooSmall:"\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u043C\u0430\u043B\u0435\u043D\u044C\u043A\u0435",imageValidateSizeLabelImageSizeTooBig:"\u0417\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0435",imageValidateSizeLabelExpectedMinSize:"\u041C\u0456\u043D\u0456\u043C\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043C\u0456\u0440: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0438\u0439 \u0440\u043E\u0437\u043C\u0456\u0440: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u043C\u0430\u043B\u0435\u043D\u044C\u043A\u0456",imageValidateSizeLabelImageResolutionTooHigh:"\u0420\u043E\u0437\u043C\u0456\u0440\u0438 \u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0456",imageValidateSizeLabelExpectedMinResolution:"\u041C\u0456\u043D\u0456\u043C\u0430\u043B\u044C\u043D\u0456 \u0440\u043E\u0437\u043C\u0456\u0440\u0438: {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0456 \u0440\u043E\u0437\u043C\u0456\u0440\u0438: {maxResolution}"};// node_modules/filepond/locale/vi-vi.js
var vi_vi_default={labelIdle:"K\xE9o th\u1EA3 t\u1EC7p c\u1EE7a b\u1EA1n ho\u1EB7c <span class=\"filepond--label-action\"> T\xECm ki\u1EBFm </span>",labelInvalidField:"Tr\u01B0\u1EDDng ch\u1EE9a c\xE1c t\u1EC7p kh\xF4ng h\u1EE3p l\u1EC7",labelFileWaitingForSize:"\u0110ang ch\u1EDD k\xEDch th\u01B0\u1EDBc",labelFileSizeNotAvailable:"K\xEDch th\u01B0\u1EDBc kh\xF4ng c\xF3 s\u1EB5n",labelFileLoading:"\u0110ang t\u1EA3i",labelFileLoadError:"L\u1ED7i khi t\u1EA3i",labelFileProcessing:"\u0110ang t\u1EA3i l\xEAn",labelFileProcessingComplete:"T\u1EA3i l\xEAn th\xE0nh c\xF4ng",labelFileProcessingAborted:"\u0110\xE3 hu\u1EF7 t\u1EA3i l\xEAn",labelFileProcessingError:"L\u1ED7i khi t\u1EA3i l\xEAn",labelFileProcessingRevertError:"L\u1ED7i khi ho\xE0n nguy\xEAn",labelFileRemoveError:"L\u1ED7i khi x\xF3a",labelTapToCancel:"nh\u1EA5n \u0111\u1EC3 h\u1EE7y",labelTapToRetry:"nh\u1EA5n \u0111\u1EC3 th\u1EED l\u1EA1i",labelTapToUndo:"nh\u1EA5n \u0111\u1EC3 ho\xE0n t\xE1c",labelButtonRemoveItem:"Xo\xE1",labelButtonAbortItemLoad:"Hu\u1EF7 b\u1ECF",labelButtonRetryItemLoad:"Th\u1EED l\u1EA1i",labelButtonAbortItemProcessing:"H\u1EE7y b\u1ECF",labelButtonUndoItemProcessing:"Ho\xE0n t\xE1c",labelButtonRetryItemProcessing:"Th\u1EED l\u1EA1i",labelButtonProcessItem:"T\u1EA3i l\xEAn",labelMaxFileSizeExceeded:"T\u1EADp tin qu\xE1 l\u1EDBn",labelMaxFileSize:"K\xEDch th\u01B0\u1EDBc t\u1EC7p t\u1ED1i \u0111a l\xE0 {filesize}",labelMaxTotalFileSizeExceeded:"\u0110\xE3 v\u01B0\u1EE3t qu\xE1 t\u1ED5ng k\xEDch th\u01B0\u1EDBc t\u1ED1i \u0111a",labelMaxTotalFileSize:"T\u1ED5ng k\xEDch th\u01B0\u1EDBc t\u1EC7p t\u1ED1i \u0111a l\xE0 {filesize}",labelFileTypeNotAllowed:"T\u1EC7p thu\u1ED9c lo\u1EA1i kh\xF4ng h\u1EE3p l\u1EC7",fileValidateTypeLabelExpectedTypes:"Ki\u1EC3u t\u1EC7p h\u1EE3p l\u1EC7 l\xE0 {allButLastType} ho\u1EB7c {lastType}",imageValidateSizeLabelFormatError:"Lo\u1EA1i h\xECnh \u1EA3nh kh\xF4ng \u0111\u01B0\u1EE3c h\u1ED7 tr\u1EE3",imageValidateSizeLabelImageSizeTooSmall:"H\xECnh \u1EA3nh qu\xE1 nh\u1ECF",imageValidateSizeLabelImageSizeTooBig:"H\xECnh \u1EA3nh qu\xE1 l\u1EDBn",imageValidateSizeLabelExpectedMinSize:"K\xEDch th\u01B0\u1EDBc t\u1ED1i thi\u1EC3u l\xE0 {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"K\xEDch th\u01B0\u1EDBc t\u1ED1i \u0111a l\xE0 {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u0110\u1ED9 ph\xE2n gi\u1EA3i qu\xE1 th\u1EA5p",imageValidateSizeLabelImageResolutionTooHigh:"\u0110\u1ED9 ph\xE2n gi\u1EA3i qu\xE1 cao",imageValidateSizeLabelExpectedMinResolution:"\u0110\u1ED9 ph\xE2n gi\u1EA3i t\u1ED1i thi\u1EC3u l\xE0 {minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u0110\u1ED9 ph\xE2n gi\u1EA3i t\u1ED1i \u0111a l\xE0 {maxResolution}"};// node_modules/filepond/locale/zh-cn.js
var zh_cn_default={labelIdle:"\u62D6\u653E\u6587\u4EF6\uFF0C\u6216\u8005 <span class=\"filepond--label-action\"> \u6D4F\u89C8 </span>",labelInvalidField:"\u5B57\u6BB5\u5305\u542B\u65E0\u6548\u6587\u4EF6",labelFileWaitingForSize:"\u8BA1\u7B97\u6587\u4EF6\u5927\u5C0F",labelFileSizeNotAvailable:"\u6587\u4EF6\u5927\u5C0F\u4E0D\u53EF\u7528",labelFileLoading:"\u52A0\u8F7D",labelFileLoadError:"\u52A0\u8F7D\u9519\u8BEF",labelFileProcessing:"\u4E0A\u4F20",labelFileProcessingComplete:"\u5DF2\u4E0A\u4F20",labelFileProcessingAborted:"\u4E0A\u4F20\u5DF2\u53D6\u6D88",labelFileProcessingError:"\u4E0A\u4F20\u51FA\u9519",labelFileProcessingRevertError:"\u8FD8\u539F\u51FA\u9519",labelFileRemoveError:"\u5220\u9664\u51FA\u9519",labelTapToCancel:"\u70B9\u51FB\u53D6\u6D88",labelTapToRetry:"\u70B9\u51FB\u91CD\u8BD5",labelTapToUndo:"\u70B9\u51FB\u64A4\u6D88",labelButtonRemoveItem:"\u5220\u9664",labelButtonAbortItemLoad:"\u4E2D\u6B62",labelButtonRetryItemLoad:"\u91CD\u8BD5",labelButtonAbortItemProcessing:"\u53D6\u6D88",labelButtonUndoItemProcessing:"\u64A4\u6D88",labelButtonRetryItemProcessing:"\u91CD\u8BD5",labelButtonProcessItem:"\u4E0A\u4F20",labelMaxFileSizeExceeded:"\u6587\u4EF6\u592A\u5927",labelMaxFileSize:"\u6700\u5927\u503C: {filesize}",labelMaxTotalFileSizeExceeded:"\u8D85\u8FC7\u6700\u5927\u6587\u4EF6\u5927\u5C0F",labelMaxTotalFileSize:"\u6700\u5927\u6587\u4EF6\u5927\u5C0F\uFF1A{filesize}",labelFileTypeNotAllowed:"\u6587\u4EF6\u7C7B\u578B\u65E0\u6548",fileValidateTypeLabelExpectedTypes:"\u5E94\u4E3A {allButLastType} \u6216 {lastType}",imageValidateSizeLabelFormatError:"\u4E0D\u652F\u6301\u56FE\u50CF\u7C7B\u578B",imageValidateSizeLabelImageSizeTooSmall:"\u56FE\u50CF\u592A\u5C0F",imageValidateSizeLabelImageSizeTooBig:"\u56FE\u50CF\u592A\u5927",imageValidateSizeLabelExpectedMinSize:"\u6700\u5C0F\u503C: {minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"\u6700\u5927\u503C: {maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u5206\u8FA8\u7387\u592A\u4F4E",imageValidateSizeLabelImageResolutionTooHigh:"\u5206\u8FA8\u7387\u592A\u9AD8",imageValidateSizeLabelExpectedMinResolution:"\u6700\u5C0F\u5206\u8FA8\u7387\uFF1A{minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u6700\u5927\u5206\u8FA8\u7387\uFF1A{maxResolution}"};// node_modules/filepond/locale/zh-tw.js
var zh_tw_default={labelIdle:"\u62D6\u653E\u6A94\u6848\uFF0C\u6216\u8005 <span class=\"filepond--label-action\"> \u700F\u89BD </span>",labelInvalidField:"\u4E0D\u652F\u63F4\u6B64\u6A94\u6848",labelFileWaitingForSize:"\u6B63\u5728\u8A08\u7B97\u6A94\u6848\u5927\u5C0F",labelFileSizeNotAvailable:"\u6A94\u6848\u5927\u5C0F\u4E0D\u7B26",labelFileLoading:"\u8B80\u53D6\u4E2D",labelFileLoadError:"\u8B80\u53D6\u932F\u8AA4",labelFileProcessing:"\u4E0A\u50B3",labelFileProcessingComplete:"\u5DF2\u4E0A\u50B3",labelFileProcessingAborted:"\u4E0A\u50B3\u5DF2\u53D6\u6D88",labelFileProcessingError:"\u4E0A\u50B3\u767C\u751F\u932F\u8AA4",labelFileProcessingRevertError:"\u9084\u539F\u932F\u8AA4",labelFileRemoveError:"\u522A\u9664\u932F\u8AA4",labelTapToCancel:"\u9EDE\u64CA\u53D6\u6D88",labelTapToRetry:"\u9EDE\u64CA\u91CD\u8A66",labelTapToUndo:"\u9EDE\u64CA\u9084\u539F",labelButtonRemoveItem:"\u522A\u9664",labelButtonAbortItemLoad:"\u505C\u6B62",labelButtonRetryItemLoad:"\u91CD\u8A66",labelButtonAbortItemProcessing:"\u53D6\u6D88",labelButtonUndoItemProcessing:"\u53D6\u6D88",labelButtonRetryItemProcessing:"\u91CD\u8A66",labelButtonProcessItem:"\u4E0A\u50B3",labelMaxFileSizeExceeded:"\u6A94\u6848\u904E\u5927",labelMaxFileSize:"\u6700\u5927\u503C\uFF1A{filesize}",labelMaxTotalFileSizeExceeded:"\u8D85\u904E\u6700\u5927\u53EF\u4E0A\u50B3\u5927\u5C0F",labelMaxTotalFileSize:"\u6700\u5927\u53EF\u4E0A\u50B3\u5927\u5C0F\uFF1A{filesize}",labelFileTypeNotAllowed:"\u4E0D\u652F\u63F4\u6B64\u985E\u578B\u6A94\u6848",fileValidateTypeLabelExpectedTypes:"\u61C9\u70BA {allButLastType} \u6216 {lastType}",imageValidateSizeLabelFormatError:"\u4E0D\u652F\u6301\u6B64\u985E\u5716\u7247\u985E\u578B",imageValidateSizeLabelImageSizeTooSmall:"\u5716\u7247\u904E\u5C0F",imageValidateSizeLabelImageSizeTooBig:"\u5716\u7247\u904E\u5927",imageValidateSizeLabelExpectedMinSize:"\u6700\u5C0F\u5C3A\u5BF8\uFF1A{minWidth} \xD7 {minHeight}",imageValidateSizeLabelExpectedMaxSize:"\u6700\u5927\u5C3A\u5BF8\uFF1A{maxWidth} \xD7 {maxHeight}",imageValidateSizeLabelImageResolutionTooLow:"\u89E3\u6790\u5EA6\u904E\u4F4E",imageValidateSizeLabelImageResolutionTooHigh:"\u89E3\u6790\u5EA6\u904E\u9AD8",imageValidateSizeLabelExpectedMinResolution:"\u6700\u4F4E\u89E3\u6790\u5EA6\uFF1A{minResolution}",imageValidateSizeLabelExpectedMaxResolution:"\u6700\u9AD8\u89E3\u6790\u5EA6\uFF1A{maxResolution}"};// packages/forms/resources/js/components/file-upload.js
_registerPlugin(filepond_plugin_file_validate_size_esm_default);_registerPlugin(filepond_plugin_file_validate_type_esm_default);_registerPlugin(filepond_plugin_image_crop_esm_default);_registerPlugin(filepond_plugin_image_exif_orientation_esm_default);_registerPlugin(filepond_plugin_image_preview_esm_default);_registerPlugin(filepond_plugin_image_resize_esm_default);_registerPlugin(filepond_plugin_image_transform_esm_default);_registerPlugin(plugin8);window.FilePond=filepond_esm_exports;var file_upload_default=function file_upload_default(Alpine){Alpine.data("fileUploadFormComponent",function(_ref204){var acceptedFileTypes=_ref204.acceptedFileTypes,canDownload=_ref204.canDownload,canOpen=_ref204.canOpen,canPreview=_ref204.canPreview,canReorder=_ref204.canReorder,deleteUploadedFileUsing=_ref204.deleteUploadedFileUsing,getUploadedFileUrlsUsing=_ref204.getUploadedFileUrlsUsing,imageCropAspectRatio=_ref204.imageCropAspectRatio,imagePreviewHeight=_ref204.imagePreviewHeight,imageResizeMode=_ref204.imageResizeMode,imageResizeTargetHeight=_ref204.imageResizeTargetHeight,imageResizeTargetWidth=_ref204.imageResizeTargetWidth,imageResizeUpscale=_ref204.imageResizeUpscale,isAvatar=_ref204.isAvatar,loadingIndicatorPosition=_ref204.loadingIndicatorPosition,locale=_ref204.locale,panelAspectRatio=_ref204.panelAspectRatio,panelLayout=_ref204.panelLayout,placeholder=_ref204.placeholder,maxSize=_ref204.maxSize,minSize=_ref204.minSize,removeUploadedFileButtonPosition=_ref204.removeUploadedFileButtonPosition,removeUploadedFileUsing=_ref204.removeUploadedFileUsing,reorderUploadedFilesUsing=_ref204.reorderUploadedFilesUsing,shouldAppendFiles=_ref204.shouldAppendFiles,shouldOrientImageFromExif=_ref204.shouldOrientImageFromExif,shouldTransformImage=_ref204.shouldTransformImage,state2=_ref204.state,uploadButtonPosition=_ref204.uploadButtonPosition,uploadProgressIndicatorPosition=_ref204.uploadProgressIndicatorPosition,uploadUsing=_ref204.uploadUsing;return{fileKeyIndex:{},pond:null,shouldUpdateState:true,state:state2,lastState:null,uploadedFileUrlIndex:{},init:function(){var _init=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee10(){var _locales2$locale,_this18=this;var handleFileProcessing;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:setOptions$1((_locales2$locale=locales2[locale])!==null&&_locales2$locale!==void 0?_locales2$locale:locales2["en"]);_context10.t0=create$f;_context10.t1=this.$refs.input;_context10.t2=_objectSpread;_context10.t3=_objectSpread;_context10.t4=acceptedFileTypes;_context10.t5=canReorder;_context10.t6=shouldOrientImageFromExif;_context10.t7=canPreview;_context10.t8=canPreview;_context10.t9=canPreview;_context10.t10=shouldTransformImage;_context10.next=14;return this.getFiles();case 14:_context10.t11=_context10.sent;_context10.t12=imageCropAspectRatio;_context10.t13=imagePreviewHeight;_context10.t14=imageResizeTargetHeight;_context10.t15=imageResizeTargetWidth;_context10.t16=imageResizeMode;_context10.t17=imageResizeUpscale;_context10.t18=shouldAppendFiles?"after":"before";_context10.t19={acceptedFileTypes:_context10.t4,allowPaste:false,allowReorder:_context10.t5,allowImageExifOrientation:_context10.t6,allowImagePreview:_context10.t7,allowVideoPreview:_context10.t8,allowAudioPreview:_context10.t9,allowImageTransform:_context10.t10,credits:false,files:_context10.t11,imageCropAspectRatio:_context10.t12,imagePreviewHeight:_context10.t13,imageResizeTargetHeight:_context10.t14,imageResizeTargetWidth:_context10.t15,imageResizeMode:_context10.t16,imageResizeUpscale:_context10.t17,itemInsertLocation:_context10.t18};_context10.t20=placeholder&&{labelIdle:placeholder};_context10.t21=(0,_context10.t3)(_context10.t19,_context10.t20);_context10.t22={};_context10.t23={maxFileSize:maxSize,minFileSize:minSize,styleButtonProcessItemPosition:uploadButtonPosition,styleButtonRemoveItemPosition:removeUploadedFileButtonPosition,styleLoadIndicatorPosition:loadingIndicatorPosition,stylePanelAspectRatio:panelAspectRatio,stylePanelLayout:panelLayout,styleProgressIndicatorPosition:uploadProgressIndicatorPosition,server:{load:function(){var _load2=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(source,_load){var response,blob2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(source,{cache:"no-store"});case 2:response=_context.sent;_context.next=5;return response.blob();case 5:blob2=_context.sent;_load(blob2);case 7:case"end":return _context.stop();}}},_callee);}));function load(_x2,_x3){return _load2.apply(this,arguments);}return load;}(),process:function process(fieldName,file2,metadata,load,error2,progress){_this18.shouldUpdateState=false;var fileKey=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(c2){return(c2^crypto.getRandomValues(new Uint8Array(1))[0]&15>>c2/4).toString(16);});uploadUsing(fileKey,file2,function(fileKey2){_this18.shouldUpdateState=true;load(fileKey2);},error2,progress);},remove:function(){var _remove=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(source,load){var _this18$uploadedFileU;var fileKey;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fileKey=(_this18$uploadedFileU=_this18.uploadedFileUrlIndex[source])!==null&&_this18$uploadedFileU!==void 0?_this18$uploadedFileU:null;if(fileKey){_context2.next=3;break;}return _context2.abrupt("return");case 3:_context2.next=5;return deleteUploadedFileUsing(fileKey);case 5:load();case 6:case"end":return _context2.stop();}}},_callee2);}));function remove(_x4,_x5){return _remove.apply(this,arguments);}return remove;}(),revert:function(){var _revert=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(uniqueFileId,load){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return removeUploadedFileUsing(uniqueFileId);case 2:load();case 3:case"end":return _context3.stop();}}},_callee3);}));function revert(_x6,_x7){return _revert.apply(this,arguments);}return revert;}()}};_context10.t24=(0,_context10.t2)(_context10.t21,_context10.t22,_context10.t23);this.pond=(0,_context10.t0)(_context10.t1,_context10.t24);this.$watch("state",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(_this18.shouldUpdateState){_context4.next=2;break;}return _context4.abrupt("return");case 2:if(!(_this18.state!==null&&Object.values(_this18.state).filter(function(file2){return file2.startsWith("livewire-file:");}).length)){_context4.next=5;break;}_this18.lastState=null;return _context4.abrupt("return");case 5:if(!(JSON.stringify(_this18.state)===_this18.lastState)){_context4.next=7;break;}return _context4.abrupt("return");case 7:_this18.lastState=JSON.stringify(_this18.state);_context4.next=10;return _this18.getFiles();case 10:_this18.pond.files=_context4.sent;case 11:case"end":return _context4.stop();}}},_callee4);})));this.pond.on("reorderfiles",/*#__PURE__*/function(){var _ref206=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(files){var orderedFileKeys;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:orderedFileKeys=files.map(function(file2){var _this18$uploadedFileU2;return file2.source instanceof File?file2.serverId:(_this18$uploadedFileU2=_this18.uploadedFileUrlIndex[file2.source])!==null&&_this18$uploadedFileU2!==void 0?_this18$uploadedFileU2:null;}).filter(function(fileKey){return fileKey;});_context5.next=3;return reorderUploadedFilesUsing(shouldAppendFiles?orderedFileKeys:orderedFileKeys.reverse());case 3:case"end":return _context5.stop();}}},_callee5);}));return function(_x8){return _ref206.apply(this,arguments);};}());this.pond.on("initfile",/*#__PURE__*/function(){var _ref207=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(fileItem){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(canDownload){_context6.next=2;break;}return _context6.abrupt("return");case 2:if(!isAvatar){_context6.next=4;break;}return _context6.abrupt("return");case 4:_this18.insertDownloadLink(fileItem);case 5:case"end":return _context6.stop();}}},_callee6);}));return function(_x9){return _ref207.apply(this,arguments);};}());this.pond.on("initfile",/*#__PURE__*/function(){var _ref208=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(fileItem){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(canOpen){_context7.next=2;break;}return _context7.abrupt("return");case 2:if(!isAvatar){_context7.next=4;break;}return _context7.abrupt("return");case 4:_this18.insertOpenLink(fileItem);case 5:case"end":return _context7.stop();}}},_callee7);}));return function(_x10){return _ref208.apply(this,arguments);};}());this.pond.on("addfilestart",/*#__PURE__*/function(){var _ref209=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(file2){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!(file2.status!==_FileStatus.PROCESSING_QUEUED)){_context8.next=2;break;}return _context8.abrupt("return");case 2:_this18.dispatchFormEvent("file-upload-started");case 3:case"end":return _context8.stop();}}},_callee8);}));return function(_x11){return _ref209.apply(this,arguments);};}());handleFileProcessing=/*#__PURE__*/function(){var _ref210=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!_this18.pond.getFiles().filter(function(file2){return file2.status===_FileStatus.PROCESSING||file2.status===_FileStatus.PROCESSING_QUEUED;}).length){_context9.next=2;break;}return _context9.abrupt("return");case 2:_this18.dispatchFormEvent("file-upload-finished");case 3:case"end":return _context9.stop();}}},_callee9);}));return function handleFileProcessing(){return _ref210.apply(this,arguments);};}();this.pond.on("processfile",handleFileProcessing);this.pond.on("processfileabort",handleFileProcessing);this.pond.on("processfilerevert",handleFileProcessing);case 38:case"end":return _context10.stop();}}},_callee10,this);}));function init(){return _init.apply(this,arguments);}return init;}(),dispatchFormEvent:function dispatchFormEvent(name2){var _this$$el$closest;(_this$$el$closest=this.$el.closest("form"))===null||_this$$el$closest===void 0?void 0:_this$$el$closest.dispatchEvent(new CustomEvent(name2,{composed:true,cancelable:true}));},getUploadedFileUrls:function(){var _getUploadedFileUrls=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee11(){var uploadedFileUrls;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return getUploadedFileUrlsUsing();case 2:uploadedFileUrls=_context11.sent;this.fileKeyIndex=uploadedFileUrls!==null&&uploadedFileUrls!==void 0?uploadedFileUrls:{};this.uploadedFileUrlIndex=Object.entries(this.fileKeyIndex).filter(function(value){return value;}).reduce(function(obj,_ref211){var _ref212=_slicedToArray(_ref211,2),key=_ref212[0],value=_ref212[1];obj[value]=key;return obj;},{});case 5:case"end":return _context11.stop();}}},_callee11,this);}));function getUploadedFileUrls(){return _getUploadedFileUrls.apply(this,arguments);}return getUploadedFileUrls;}(),getFiles:function(){var _getFiles=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee12(){var files,_i3,_Object$values,uploadedFileUrl;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return this.getUploadedFileUrls();case 2:files=[];_i3=0,_Object$values=Object.values(this.fileKeyIndex);case 4:if(!(_i3<_Object$values.length)){_context12.next=12;break;}uploadedFileUrl=_Object$values[_i3];if(uploadedFileUrl){_context12.next=8;break;}return _context12.abrupt("continue",9);case 8:files.push({source:uploadedFileUrl,options:{type:"local"}});case 9:_i3++;_context12.next=4;break;case 12:return _context12.abrupt("return",shouldAppendFiles?files:files.reverse());case 13:case"end":return _context12.stop();}}},_callee12,this);}));function getFiles(){return _getFiles.apply(this,arguments);}return getFiles;}(),insertDownloadLink:function insertDownloadLink(file2){if(file2.origin!==FileOrigin$1.LOCAL){return;}var anchor=this.getDownloadLink(file2);if(!anchor){return;}document.getElementById("filepond--item-".concat(file2.id)).querySelector(".filepond--file-info-main").prepend(anchor);},insertOpenLink:function insertOpenLink(file2){if(file2.origin!==FileOrigin$1.LOCAL){return;}var anchor=this.getOpenLink(file2);if(!anchor){return;}document.getElementById("filepond--item-".concat(file2.id)).querySelector(".filepond--file-info-main").prepend(anchor);},getDownloadLink:function getDownloadLink(file2){var fileSource=file2.source;if(!fileSource){return;}var anchor=document.createElement("a");anchor.className="filepond--download-icon";anchor.href=fileSource;anchor.download=file2.file.name;return anchor;},getOpenLink:function getOpenLink(file2){var fileSource=file2.source;if(!fileSource){return;}var anchor=document.createElement("a");anchor.className="filepond--open-icon";anchor.href=fileSource;anchor.target="_blank";return anchor;}};});};var locales2={ar:ar_ar_default,cs:cs_cz_default,da:da_dk_default,de:de_de_default,en:en_en_default,es:es_es_default,fa:fa_ir_default,fi:fi_fi_default,fr:fr_fr_default,hu:hu_hu_default,id:id_id_default,it:it_it_default,nl:nl_nl_default,pl:pl_pl_default,pt_BR:pt_br_default,pt_PT:pt_br_default,ro:ro_ro_default,ru:ru_ru_default,sv:sv_se_default,tr:tr_tr_default,uk:uk_ua_default,vi:vi_vi_default,zh_CN:zh_cn_default,zh_TW:zh_tw_default};// packages/forms/resources/js/components/key-value.js
var key_value_default=function key_value_default(Alpine){Alpine.data("keyValueFormComponent",function(_ref213){var state2=_ref213.state;return{state:state2,rows:[],shouldUpdateRows:true,init:function init(){var _this19=this;this.updateRows();if(this.rows.length<=0){this.addRow();}this.shouldUpdateRows=true;this.$watch("state",function(){if(!_this19.shouldUpdateRows){_this19.shouldUpdateRows=true;return;}_this19.updateRows();});},addRow:function addRow(){this.rows.push({key:"",value:""});this.updateState();},deleteRow:function deleteRow(index2){this.rows.splice(index2,1);if(this.rows.length<=0){this.addRow();}this.updateState();this.shouldUpdateRows=true;},reorderRows:function reorderRows(event){var rows=Alpine.raw(this.rows);var reorderedRow=rows.splice(event.oldIndex,1)[0];rows.splice(event.newIndex,0,reorderedRow);this.rows=rows;this.updateState();},updateRows:function updateRows(){var rows=[];for(var _i4=0,_Object$entries=Object.entries((_this$state=this.state)!==null&&_this$state!==void 0?_this$state:{});_i4<_Object$entries.length;_i4++){var _this$state;var _Object$entries$_i=_slicedToArray(_Object$entries[_i4],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];rows.push({key:key,value:value});}this.rows=rows;},updateState:function updateState(){var state3={};this.rows.forEach(function(row){if(row.key===""||row.key===null){return;}state3[row.key]=row.value;});this.shouldUpdateRows=false;this.state=state3;}};});};// node_modules/@github/file-attachment-element/dist/index.js
var Attachment=/*#__PURE__*/function(){function Attachment(file2,directory){_classCallCheck(this,Attachment);this.file=file2;this.directory=directory;this.state="pending";this.id=null;this.href=null;this.name=null;this.percent=0;}_createClass(Attachment,[{key:"fullPath",get:function get(){return this.directory?"".concat(this.directory,"/").concat(this.file.name):this.file.name;}},{key:"isImage",value:function isImage(){return["image/gif","image/png","image/jpg","image/jpeg"].indexOf(this.file.type)>-1;}},{key:"saving",value:function saving(percent){if(this.state!=="pending"&&this.state!=="saving"){throw new Error("Unexpected transition from ".concat(this.state," to saving"));}this.state="saving";this.percent=percent;}},{key:"saved",value:function saved(attributes){var _a,_b,_c;if(this.state!=="pending"&&this.state!=="saving"){throw new Error("Unexpected transition from ".concat(this.state," to saved"));}this.state="saved";this.id=(_a=attributes===null||attributes===void 0?void 0:attributes.id)!==null&&_a!==void 0?_a:null;this.href=(_b=attributes===null||attributes===void 0?void 0:attributes.href)!==null&&_b!==void 0?_b:null;this.name=(_c=attributes===null||attributes===void 0?void 0:attributes.name)!==null&&_c!==void 0?_c:null;}},{key:"isPending",value:function isPending(){return this.state==="pending";}},{key:"isSaving",value:function isSaving(){return this.state==="saving";}},{key:"isSaved",value:function isSaved(){return this.state==="saved";}}],[{key:"traverse",value:function traverse(transfer,directory){return transferredFiles(transfer,directory);}},{key:"from",value:function from(files){var result=[];var _iterator3=_createForOfIteratorHelper(files),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var file2=_step3.value;if(file2 instanceof File){result.push(new Attachment(file2));}else if(file2 instanceof Attachment){result.push(file2);}else{throw new Error("Unexpected type");}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return result;}}]);return Attachment;}();function transferredFiles(transfer,directory){if(directory&&isDirectory(transfer)){return traverse("",roots(transfer));}return Promise.resolve(visible(Array.from(transfer.files||[])).map(function(f){return new Attachment(f);}));}function hidden(file2){return file2.name.startsWith(".");}function visible(files){return Array.from(files).filter(function(file2){return!hidden(file2);});}function getFile(entry){return new Promise(function(resolve,reject){entry.file(resolve,reject);});}function getEntries(entry){return new Promise(function(resolve,reject){var result=[];var reader=entry.createReader();var read=function read(){reader.readEntries(function(entries){if(entries.length>0){result.push.apply(result,_toConsumableArray2(entries));read();}else{resolve(result);}},reject);};read();});}function traverse(_x12,_x13){return _traverse.apply(this,arguments);}function _traverse(){_traverse=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee34(path,entries){var results,_iterator13,_step13,entry,file2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:results=[];_iterator13=_createForOfIteratorHelper(visible(entries));_context34.prev=2;_iterator13.s();case 4:if((_step13=_iterator13.n()).done){_context34.next=28;break;}entry=_step13.value;if(!entry.isDirectory){_context34.next=22;break;}_context34.t0=results.push;_context34.t1=results;_context34.t2=_toConsumableArray2;_context34.t3=traverse;_context34.t4=entry.fullPath;_context34.next=14;return getEntries(entry);case 14:_context34.t5=_context34.sent;_context34.next=17;return(0,_context34.t3)(_context34.t4,_context34.t5);case 17:_context34.t6=_context34.sent;_context34.t7=(0,_context34.t2)(_context34.t6);_context34.t0.apply.call(_context34.t0,_context34.t1,_context34.t7);_context34.next=26;break;case 22:_context34.next=24;return getFile(entry);case 24:file2=_context34.sent;results.push(new Attachment(file2,path));case 26:_context34.next=4;break;case 28:_context34.next=33;break;case 30:_context34.prev=30;_context34.t8=_context34["catch"](2);_iterator13.e(_context34.t8);case 33:_context34.prev=33;_iterator13.f();return _context34.finish(33);case 36:return _context34.abrupt("return",results);case 37:case"end":return _context34.stop();}}},_callee34,null,[[2,30,33,36]]);}));return _traverse.apply(this,arguments);}function isDirectory(transfer){return transfer.items&&Array.from(transfer.items).some(function(item2){var entry=item2.webkitGetAsEntry&&item2.webkitGetAsEntry();return entry&&entry.isDirectory;});}function roots(transfer){return Array.from(transfer.items).map(function(item2){return item2.webkitGetAsEntry();}).filter(function(entry){return entry!=null;});}var FileAttachmentElement=/*#__PURE__*/function(_HTMLElement2){_inherits(FileAttachmentElement,_HTMLElement2);var _super23=_createSuper(FileAttachmentElement);function FileAttachmentElement(){_classCallCheck(this,FileAttachmentElement);return _super23.apply(this,arguments);}_createClass(FileAttachmentElement,[{key:"connectedCallback",value:function connectedCallback(){this.addEventListener("dragenter",onDragenter);this.addEventListener("dragover",onDragenter);this.addEventListener("dragleave",onDragleave);this.addEventListener("drop",onDrop);this.addEventListener("paste",onPaste);this.addEventListener("change",onChange);}},{key:"disconnectedCallback",value:function disconnectedCallback(){this.removeEventListener("dragenter",onDragenter);this.removeEventListener("dragover",onDragenter);this.removeEventListener("dragleave",onDragleave);this.removeEventListener("drop",onDrop);this.removeEventListener("paste",onPaste);this.removeEventListener("change",onChange);}},{key:"directory",get:function get(){return this.hasAttribute("directory");},set:function set(value){if(value){this.setAttribute("directory","");}else{this.removeAttribute("directory");}}},{key:"attach",value:function(){var _attach=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee13(transferred){var attachments,accepted;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(!(transferred instanceof DataTransfer)){_context13.next=6;break;}_context13.next=3;return Attachment.traverse(transferred,this.directory);case 3:_context13.t0=_context13.sent;_context13.next=7;break;case 6:_context13.t0=Attachment.from(transferred);case 7:attachments=_context13.t0;accepted=this.dispatchEvent(new CustomEvent("file-attachment-accept",{bubbles:true,cancelable:true,detail:{attachments:attachments}}));if(accepted&&attachments.length){this.dispatchEvent(new CustomEvent("file-attachment-accepted",{bubbles:true,detail:{attachments:attachments}}));}case 10:case"end":return _context13.stop();}}},_callee13,this);}));function attach(_x14){return _attach.apply(this,arguments);}return attach;}()}]);return FileAttachmentElement;}(/*#__PURE__*/_wrapNativeSuper(HTMLElement));function hasFile(transfer){return Array.from(transfer.types).indexOf("Files")>=0;}var dragging=null;function onDragenter(event){var target=event.currentTarget;if(dragging){clearTimeout(dragging);}dragging=window.setTimeout(function(){return target.removeAttribute("hover");},200);var transfer=event.dataTransfer;if(!transfer||!hasFile(transfer))return;transfer.dropEffect="copy";target.setAttribute("hover","");event.stopPropagation();event.preventDefault();}function onDragleave(event){if(event.dataTransfer){event.dataTransfer.dropEffect="none";}var target=event.currentTarget;target.removeAttribute("hover");event.stopPropagation();event.preventDefault();}function onDrop(event){var container=event.currentTarget;if(!(container instanceof FileAttachmentElement))return;container.removeAttribute("hover");var transfer=event.dataTransfer;if(!transfer||!hasFile(transfer))return;container.attach(transfer);event.stopPropagation();event.preventDefault();}var images2=/^image\/(gif|png|jpeg)$/;function pastedFile(items){var _iterator4=_createForOfIteratorHelper(items),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var item2=_step4.value;if(images2.test(item2.type)){return item2.getAsFile();}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}return null;}function onPaste(event){if(!event.clipboardData)return;if(!event.clipboardData.items)return;var container=event.currentTarget;if(!(container instanceof FileAttachmentElement))return;var file2=pastedFile(event.clipboardData.items);if(!file2)return;var files=[file2];container.attach(files);event.preventDefault();}function onChange(event){var container=event.currentTarget;if(!(container instanceof FileAttachmentElement))return;var input=event.target;if(!(input instanceof HTMLInputElement))return;var id=container.getAttribute("input");if(id&&input.id!==id)return;var files=input.files;if(!files||files.length===0)return;container.attach(files);input.value="";}if(!window.customElements.get("file-attachment")){window.FileAttachmentElement=FileAttachmentElement;window.customElements.define("file-attachment",FileAttachmentElement);}// node_modules/@github/markdown-toolbar-element/dist/index.js
var buttonSelectors=["[data-md-button]","md-header","md-bold","md-italic","md-quote","md-code","md-link","md-image","md-unordered-list","md-ordered-list","md-task-list","md-mention","md-ref","md-strikethrough"];function getButtons(toolbar){var els=[];var _iterator5=_createForOfIteratorHelper(toolbar.querySelectorAll(buttonSelectors.join(", "))),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var button=_step5.value;if(button.hidden||button.offsetWidth<=0&&button.offsetHeight<=0)continue;if(button.closest("markdown-toolbar")===toolbar)els.push(button);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}return els;}function keydown(fn2){return function(event){if(event.key===" "||event.key==="Enter"){event.preventDefault();fn2(event);}};}var styles2=new WeakMap();var MarkdownButtonElement=/*#__PURE__*/function(_HTMLElement3){_inherits(MarkdownButtonElement,_HTMLElement3);var _super24=_createSuper(MarkdownButtonElement);function MarkdownButtonElement(){var _this20;_classCallCheck(this,MarkdownButtonElement);_this20=_super24.call(this);var apply2=function apply2(){var style=styles2.get(_assertThisInitialized(_this20));if(!style)return;applyStyle(_assertThisInitialized(_this20),style);};_this20.addEventListener("keydown",keydown(apply2));_this20.addEventListener("click",apply2);return _this20;}_createClass(MarkdownButtonElement,[{key:"connectedCallback",value:function connectedCallback(){if(!this.hasAttribute("role")){this.setAttribute("role","button");}}},{key:"click",value:function click(){var style=styles2.get(this);if(!style)return;applyStyle(this,style);}}]);return MarkdownButtonElement;}(/*#__PURE__*/_wrapNativeSuper(HTMLElement));var MarkdownHeaderButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen){_inherits(MarkdownHeaderButtonElement,_MarkdownButtonElemen);var _super25=_createSuper(MarkdownHeaderButtonElement);function MarkdownHeaderButtonElement(){var _this21;_classCallCheck(this,MarkdownHeaderButtonElement);_this21=_super25.call(this);var level=parseInt(_this21.getAttribute("level")||"3",10);if(level<1||level>6){return _possibleConstructorReturn(_this21);}var prefix="".concat("#".repeat(level)," ");styles2.set(_assertThisInitialized(_this21),{prefix:prefix});return _this21;}return MarkdownHeaderButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-header")){window.MarkdownHeaderButtonElement=MarkdownHeaderButtonElement;window.customElements.define("md-header",MarkdownHeaderButtonElement);}var MarkdownBoldButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen2){_inherits(MarkdownBoldButtonElement,_MarkdownButtonElemen2);var _super26=_createSuper(MarkdownBoldButtonElement);function MarkdownBoldButtonElement(){var _this22;_classCallCheck(this,MarkdownBoldButtonElement);_this22=_super26.call(this);styles2.set(_assertThisInitialized(_this22),{prefix:"**",suffix:"**",trimFirst:true});return _this22;}_createClass(MarkdownBoldButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownBoldButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","b");}}]);return MarkdownBoldButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-bold")){window.MarkdownBoldButtonElement=MarkdownBoldButtonElement;window.customElements.define("md-bold",MarkdownBoldButtonElement);}var MarkdownItalicButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen3){_inherits(MarkdownItalicButtonElement,_MarkdownButtonElemen3);var _super27=_createSuper(MarkdownItalicButtonElement);function MarkdownItalicButtonElement(){var _this23;_classCallCheck(this,MarkdownItalicButtonElement);_this23=_super27.call(this);styles2.set(_assertThisInitialized(_this23),{prefix:"_",suffix:"_",trimFirst:true});return _this23;}_createClass(MarkdownItalicButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownItalicButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","i");}}]);return MarkdownItalicButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-italic")){window.MarkdownItalicButtonElement=MarkdownItalicButtonElement;window.customElements.define("md-italic",MarkdownItalicButtonElement);}var MarkdownQuoteButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen4){_inherits(MarkdownQuoteButtonElement,_MarkdownButtonElemen4);var _super28=_createSuper(MarkdownQuoteButtonElement);function MarkdownQuoteButtonElement(){var _this24;_classCallCheck(this,MarkdownQuoteButtonElement);_this24=_super28.call(this);styles2.set(_assertThisInitialized(_this24),{prefix:"> ",multiline:true,surroundWithNewlines:true});return _this24;}_createClass(MarkdownQuoteButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownQuoteButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey",".");this.setAttribute("hotkey-requires-shift","true");}}]);return MarkdownQuoteButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-quote")){window.MarkdownQuoteButtonElement=MarkdownQuoteButtonElement;window.customElements.define("md-quote",MarkdownQuoteButtonElement);}var MarkdownCodeButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen5){_inherits(MarkdownCodeButtonElement,_MarkdownButtonElemen5);var _super29=_createSuper(MarkdownCodeButtonElement);function MarkdownCodeButtonElement(){var _this25;_classCallCheck(this,MarkdownCodeButtonElement);_this25=_super29.call(this);styles2.set(_assertThisInitialized(_this25),{prefix:"`",suffix:"`",blockPrefix:"```",blockSuffix:"```"});return _this25;}_createClass(MarkdownCodeButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownCodeButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","e");}}]);return MarkdownCodeButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-code")){window.MarkdownCodeButtonElement=MarkdownCodeButtonElement;window.customElements.define("md-code",MarkdownCodeButtonElement);}var MarkdownLinkButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen6){_inherits(MarkdownLinkButtonElement,_MarkdownButtonElemen6);var _super30=_createSuper(MarkdownLinkButtonElement);function MarkdownLinkButtonElement(){var _this26;_classCallCheck(this,MarkdownLinkButtonElement);_this26=_super30.call(this);styles2.set(_assertThisInitialized(_this26),{prefix:"[",suffix:"](url)",replaceNext:"url",scanFor:"https?://"});return _this26;}_createClass(MarkdownLinkButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownLinkButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","k");}}]);return MarkdownLinkButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-link")){window.MarkdownLinkButtonElement=MarkdownLinkButtonElement;window.customElements.define("md-link",MarkdownLinkButtonElement);}var MarkdownImageButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen7){_inherits(MarkdownImageButtonElement,_MarkdownButtonElemen7);var _super31=_createSuper(MarkdownImageButtonElement);function MarkdownImageButtonElement(){var _this27;_classCallCheck(this,MarkdownImageButtonElement);_this27=_super31.call(this);styles2.set(_assertThisInitialized(_this27),{prefix:"![",suffix:"](url)",replaceNext:"url",scanFor:"https?://"});return _this27;}return MarkdownImageButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-image")){window.MarkdownImageButtonElement=MarkdownImageButtonElement;window.customElements.define("md-image",MarkdownImageButtonElement);}var MarkdownUnorderedListButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen8){_inherits(MarkdownUnorderedListButtonElement,_MarkdownButtonElemen8);var _super32=_createSuper(MarkdownUnorderedListButtonElement);function MarkdownUnorderedListButtonElement(){var _this28;_classCallCheck(this,MarkdownUnorderedListButtonElement);_this28=_super32.call(this);styles2.set(_assertThisInitialized(_this28),{prefix:"- ",multiline:true,surroundWithNewlines:true});return _this28;}_createClass(MarkdownUnorderedListButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownUnorderedListButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","8");this.setAttribute("hotkey-requires-shift","true");}}]);return MarkdownUnorderedListButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-unordered-list")){window.MarkdownUnorderedListButtonElement=MarkdownUnorderedListButtonElement;window.customElements.define("md-unordered-list",MarkdownUnorderedListButtonElement);}var MarkdownOrderedListButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen9){_inherits(MarkdownOrderedListButtonElement,_MarkdownButtonElemen9);var _super33=_createSuper(MarkdownOrderedListButtonElement);function MarkdownOrderedListButtonElement(){var _this29;_classCallCheck(this,MarkdownOrderedListButtonElement);_this29=_super33.call(this);styles2.set(_assertThisInitialized(_this29),{prefix:"1. ",multiline:true,orderedList:true});return _this29;}_createClass(MarkdownOrderedListButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownOrderedListButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","7");this.setAttribute("hotkey-requires-shift","true");}}]);return MarkdownOrderedListButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-ordered-list")){window.MarkdownOrderedListButtonElement=MarkdownOrderedListButtonElement;window.customElements.define("md-ordered-list",MarkdownOrderedListButtonElement);}var MarkdownTaskListButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen10){_inherits(MarkdownTaskListButtonElement,_MarkdownButtonElemen10);var _super34=_createSuper(MarkdownTaskListButtonElement);function MarkdownTaskListButtonElement(){var _this30;_classCallCheck(this,MarkdownTaskListButtonElement);_this30=_super34.call(this);styles2.set(_assertThisInitialized(_this30),{prefix:"- [ ] ",multiline:true,surroundWithNewlines:true});return _this30;}_createClass(MarkdownTaskListButtonElement,[{key:"connectedCallback",value:function connectedCallback(){_get(_getPrototypeOf(MarkdownTaskListButtonElement.prototype),"connectedCallback",this).call(this);this.setAttribute("hotkey","L");}}]);return MarkdownTaskListButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-task-list")){window.MarkdownTaskListButtonElement=MarkdownTaskListButtonElement;window.customElements.define("md-task-list",MarkdownTaskListButtonElement);}var MarkdownMentionButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen11){_inherits(MarkdownMentionButtonElement,_MarkdownButtonElemen11);var _super35=_createSuper(MarkdownMentionButtonElement);function MarkdownMentionButtonElement(){var _this31;_classCallCheck(this,MarkdownMentionButtonElement);_this31=_super35.call(this);styles2.set(_assertThisInitialized(_this31),{prefix:"@",prefixSpace:true});return _this31;}return MarkdownMentionButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-mention")){window.MarkdownMentionButtonElement=MarkdownMentionButtonElement;window.customElements.define("md-mention",MarkdownMentionButtonElement);}var MarkdownRefButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen12){_inherits(MarkdownRefButtonElement,_MarkdownButtonElemen12);var _super36=_createSuper(MarkdownRefButtonElement);function MarkdownRefButtonElement(){var _this32;_classCallCheck(this,MarkdownRefButtonElement);_this32=_super36.call(this);styles2.set(_assertThisInitialized(_this32),{prefix:"#",prefixSpace:true});return _this32;}return MarkdownRefButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-ref")){window.MarkdownRefButtonElement=MarkdownRefButtonElement;window.customElements.define("md-ref",MarkdownRefButtonElement);}var MarkdownStrikethroughButtonElement=/*#__PURE__*/function(_MarkdownButtonElemen13){_inherits(MarkdownStrikethroughButtonElement,_MarkdownButtonElemen13);var _super37=_createSuper(MarkdownStrikethroughButtonElement);function MarkdownStrikethroughButtonElement(){var _this33;_classCallCheck(this,MarkdownStrikethroughButtonElement);_this33=_super37.call(this);styles2.set(_assertThisInitialized(_this33),{prefix:"~~",suffix:"~~",trimFirst:true});return _this33;}return MarkdownStrikethroughButtonElement;}(MarkdownButtonElement);if(!window.customElements.get("md-strikethrough")){window.MarkdownStrikethroughButtonElement=MarkdownStrikethroughButtonElement;window.customElements.define("md-strikethrough",MarkdownStrikethroughButtonElement);}var modifierKey=navigator.userAgent.match(/Macintosh/)?"Meta":"Control";var MarkdownToolbarElement=/*#__PURE__*/function(_HTMLElement4){_inherits(MarkdownToolbarElement,_HTMLElement4);var _super38=_createSuper(MarkdownToolbarElement);function MarkdownToolbarElement(){_classCallCheck(this,MarkdownToolbarElement);return _super38.call(this);}_createClass(MarkdownToolbarElement,[{key:"connectedCallback",value:function connectedCallback(){if(!this.hasAttribute("role")){this.setAttribute("role","toolbar");}this.addEventListener("keydown",focusKeydown);var fn2=shortcut.bind(null,this);if(this.field){this.field.addEventListener("keydown",fn2);shortcutListeners.set(this,fn2);}this.setAttribute("tabindex","0");this.addEventListener("focus",onToolbarFocus,{once:true});}},{key:"disconnectedCallback",value:function disconnectedCallback(){var fn2=shortcutListeners.get(this);if(fn2&&this.field){this.field.removeEventListener("keydown",fn2);shortcutListeners["delete"](this);}this.removeEventListener("keydown",focusKeydown);}},{key:"field",get:function get(){var id=this.getAttribute("for");if(!id)return null;var root2="getRootNode"in this?this.getRootNode():document;var field;if(root2 instanceof Document||root2 instanceof ShadowRoot){field=root2.getElementById(id);}return field instanceof HTMLTextAreaElement?field:null;}}]);return MarkdownToolbarElement;}(/*#__PURE__*/_wrapNativeSuper(HTMLElement));function onToolbarFocus(_ref214){var target=_ref214.target;if(!(target instanceof Element))return;target.removeAttribute("tabindex");var tabindex="0";var _iterator6=_createForOfIteratorHelper(getButtons(target)),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var button=_step6.value;button.setAttribute("tabindex",tabindex);if(tabindex==="0"){button.focus();tabindex="-1";}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}function focusKeydown(event){var key=event.key;if(key!=="ArrowRight"&&key!=="ArrowLeft"&&key!=="Home"&&key!=="End")return;var toolbar=event.currentTarget;if(!(toolbar instanceof HTMLElement))return;var buttons=getButtons(toolbar);var index2=buttons.indexOf(event.target);var length=buttons.length;if(index2===-1)return;var n2=0;if(key==="ArrowLeft")n2=index2-1;if(key==="ArrowRight")n2=index2+1;if(key==="End")n2=length-1;if(n2<0)n2=length-1;if(n2>length-1)n2=0;for(var i=0;i<length;i+=1){buttons[i].setAttribute("tabindex",i===n2?"0":"-1");}event.preventDefault();buttons[n2].focus();}var shortcutListeners=new WeakMap();function elementHotkeyRequiresShift(element){return element.hasAttribute("hotkey-requires-shift")&&element.getAttribute("hotkey-requires-shift")!=="false";}function findHotkey(toolbar,key,shiftPressed){var _iterator7=_createForOfIteratorHelper(toolbar.querySelectorAll("[hotkey]")),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var el=_step7.value;if(el.getAttribute("hotkey")===key&&(!elementHotkeyRequiresShift(el)||shiftPressed)){return el;}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}return null;}function shortcut(toolbar,event){if(event.metaKey&&modifierKey==="Meta"||event.ctrlKey&&modifierKey==="Control"){var key=event.shiftKey?event.key.toUpperCase():event.key;var button=findHotkey(toolbar,key,event.shiftKey);if(button){button.click();event.preventDefault();}}}if(!window.customElements.get("markdown-toolbar")){window.MarkdownToolbarElement=MarkdownToolbarElement;window.customElements.define("markdown-toolbar",MarkdownToolbarElement);}function isMultipleLines(string){return string.trim().split("\n").length>1;}function repeat(string,n2){return Array(n2+1).join(string);}function wordSelectionStart(text3,i){var index2=i;while(text3[index2]&&text3[index2-1]!=null&&!text3[index2-1].match(/\s/)){index2--;}return index2;}function wordSelectionEnd(text3,i,multiline){var index2=i;var breakpoint=multiline?/\n/:/\s/;while(text3[index2]&&!text3[index2].match(breakpoint)){index2++;}return index2;}var canInsertText=null;function insertText(textarea,_ref215){var text3=_ref215.text,selectionStart=_ref215.selectionStart,selectionEnd=_ref215.selectionEnd;var originalSelectionStart=textarea.selectionStart;var before=textarea.value.slice(0,originalSelectionStart);var after=textarea.value.slice(textarea.selectionEnd);if(canInsertText===null||canInsertText===true){textarea.contentEditable="true";try{canInsertText=document.execCommand("insertText",false,text3);}catch(error2){canInsertText=false;}textarea.contentEditable="false";}if(canInsertText&&!textarea.value.slice(0,textarea.selectionStart).endsWith(text3)){canInsertText=false;}if(!canInsertText){try{document.execCommand("ms-beginUndoUnit");}catch(e2){}textarea.value=before+text3+after;try{document.execCommand("ms-endUndoUnit");}catch(e2){}textarea.dispatchEvent(new CustomEvent("input",{bubbles:true,cancelable:true}));}if(selectionStart!=null&&selectionEnd!=null){textarea.setSelectionRange(selectionStart,selectionEnd);}else{textarea.setSelectionRange(originalSelectionStart,textarea.selectionEnd);}}function styleSelectedText(textarea,styleArgs){var text3=textarea.value.slice(textarea.selectionStart,textarea.selectionEnd);var result;if(styleArgs.orderedList){result=orderedList(textarea);}else if(styleArgs.multiline&&isMultipleLines(text3)){result=multilineStyle(textarea,styleArgs);}else{result=blockStyle(textarea,styleArgs);}insertText(textarea,result);}function expandSelectedText(textarea,prefixToUse,suffixToUse){var multiline=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(textarea.selectionStart===textarea.selectionEnd){textarea.selectionStart=wordSelectionStart(textarea.value,textarea.selectionStart);textarea.selectionEnd=wordSelectionEnd(textarea.value,textarea.selectionEnd,multiline);}else{var expandedSelectionStart=textarea.selectionStart-prefixToUse.length;var expandedSelectionEnd=textarea.selectionEnd+suffixToUse.length;var beginsWithPrefix=textarea.value.slice(expandedSelectionStart,textarea.selectionStart)===prefixToUse;var endsWithSuffix=textarea.value.slice(textarea.selectionEnd,expandedSelectionEnd)===suffixToUse;if(beginsWithPrefix&&endsWithSuffix){textarea.selectionStart=expandedSelectionStart;textarea.selectionEnd=expandedSelectionEnd;}}return textarea.value.slice(textarea.selectionStart,textarea.selectionEnd);}function newlinesToSurroundSelectedText(textarea){var beforeSelection=textarea.value.slice(0,textarea.selectionStart);var afterSelection=textarea.value.slice(textarea.selectionEnd);var breaksBefore=beforeSelection.match(/\n*$/);var breaksAfter=afterSelection.match(/^\n*/);var newlinesBeforeSelection=breaksBefore?breaksBefore[0].length:0;var newlinesAfterSelection=breaksAfter?breaksAfter[0].length:0;var newlinesToAppend;var newlinesToPrepend;if(beforeSelection.match(/\S/)&&newlinesBeforeSelection<2){newlinesToAppend=repeat("\n",2-newlinesBeforeSelection);}if(afterSelection.match(/\S/)&&newlinesAfterSelection<2){newlinesToPrepend=repeat("\n",2-newlinesAfterSelection);}if(newlinesToAppend==null){newlinesToAppend="";}if(newlinesToPrepend==null){newlinesToPrepend="";}return{newlinesToAppend:newlinesToAppend,newlinesToPrepend:newlinesToPrepend};}function blockStyle(textarea,arg){var newlinesToAppend;var newlinesToPrepend;var prefix=arg.prefix,suffix=arg.suffix,blockPrefix=arg.blockPrefix,blockSuffix=arg.blockSuffix,replaceNext=arg.replaceNext,prefixSpace=arg.prefixSpace,scanFor=arg.scanFor,surroundWithNewlines=arg.surroundWithNewlines;var originalSelectionStart=textarea.selectionStart;var originalSelectionEnd=textarea.selectionEnd;var selectedText=textarea.value.slice(textarea.selectionStart,textarea.selectionEnd);var prefixToUse=isMultipleLines(selectedText)&&blockPrefix.length>0?"".concat(blockPrefix,"\n"):prefix;var suffixToUse=isMultipleLines(selectedText)&&blockSuffix.length>0?"\n".concat(blockSuffix):suffix;if(prefixSpace){var beforeSelection=textarea.value[textarea.selectionStart-1];if(textarea.selectionStart!==0&&beforeSelection!=null&&!beforeSelection.match(/\s/)){prefixToUse=" ".concat(prefixToUse);}}selectedText=expandSelectedText(textarea,prefixToUse,suffixToUse,arg.multiline);var selectionStart=textarea.selectionStart;var selectionEnd=textarea.selectionEnd;var hasReplaceNext=replaceNext.length>0&&suffixToUse.indexOf(replaceNext)>-1&&selectedText.length>0;if(surroundWithNewlines){var ref=newlinesToSurroundSelectedText(textarea);newlinesToAppend=ref.newlinesToAppend;newlinesToPrepend=ref.newlinesToPrepend;prefixToUse=newlinesToAppend+prefix;suffixToUse+=newlinesToPrepend;}if(selectedText.startsWith(prefixToUse)&&selectedText.endsWith(suffixToUse)){var replacementText=selectedText.slice(prefixToUse.length,selectedText.length-suffixToUse.length);if(originalSelectionStart===originalSelectionEnd){var position=originalSelectionStart-prefixToUse.length;position=Math.max(position,selectionStart);position=Math.min(position,selectionStart+replacementText.length);selectionStart=selectionEnd=position;}else{selectionEnd=selectionStart+replacementText.length;}return{text:replacementText,selectionStart:selectionStart,selectionEnd:selectionEnd};}else if(!hasReplaceNext){var _replacementText=prefixToUse+selectedText+suffixToUse;selectionStart=originalSelectionStart+prefixToUse.length;selectionEnd=originalSelectionEnd+prefixToUse.length;var whitespaceEdges=selectedText.match(/^\s*|\s*$/g);if(arg.trimFirst&&whitespaceEdges){var leadingWhitespace=whitespaceEdges[0]||"";var trailingWhitespace=whitespaceEdges[1]||"";_replacementText=leadingWhitespace+prefixToUse+selectedText.trim()+suffixToUse+trailingWhitespace;selectionStart+=leadingWhitespace.length;selectionEnd-=trailingWhitespace.length;}return{text:_replacementText,selectionStart:selectionStart,selectionEnd:selectionEnd};}else if(scanFor.length>0&&selectedText.match(scanFor)){suffixToUse=suffixToUse.replace(replaceNext,selectedText);var _replacementText2=prefixToUse+suffixToUse;selectionStart=selectionEnd=selectionStart+prefixToUse.length;return{text:_replacementText2,selectionStart:selectionStart,selectionEnd:selectionEnd};}else{var _replacementText3=prefixToUse+selectedText+suffixToUse;selectionStart=selectionStart+prefixToUse.length+selectedText.length+suffixToUse.indexOf(replaceNext);selectionEnd=selectionStart+replaceNext.length;return{text:_replacementText3,selectionStart:selectionStart,selectionEnd:selectionEnd};}}function multilineStyle(textarea,arg){var prefix=arg.prefix,suffix=arg.suffix,surroundWithNewlines=arg.surroundWithNewlines;var text3=textarea.value.slice(textarea.selectionStart,textarea.selectionEnd);var selectionStart=textarea.selectionStart;var selectionEnd=textarea.selectionEnd;var lines=text3.split("\n");var undoStyle=lines.every(function(line){return line.startsWith(prefix)&&line.endsWith(suffix);});if(undoStyle){text3=lines.map(function(line){return line.slice(prefix.length,line.length-suffix.length);}).join("\n");selectionEnd=selectionStart+text3.length;}else{text3=lines.map(function(line){return prefix+line+suffix;}).join("\n");if(surroundWithNewlines){var _newlinesToSurroundSe=newlinesToSurroundSelectedText(textarea),newlinesToAppend=_newlinesToSurroundSe.newlinesToAppend,newlinesToPrepend=_newlinesToSurroundSe.newlinesToPrepend;selectionStart+=newlinesToAppend.length;selectionEnd=selectionStart+text3.length;text3=newlinesToAppend+text3+newlinesToPrepend;}}return{text:text3,selectionStart:selectionStart,selectionEnd:selectionEnd};}function orderedList(textarea){var orderedListRegex=/^\d+\.\s+/;var noInitialSelection=textarea.selectionStart===textarea.selectionEnd;var selectionEnd;var selectionStart;var text3=textarea.value.slice(textarea.selectionStart,textarea.selectionEnd);var textToUnstyle=text3;var lines=text3.split("\n");var startOfLine,endOfLine;if(noInitialSelection){var linesBefore=textarea.value.slice(0,textarea.selectionStart).split(/\n/);startOfLine=textarea.selectionStart-linesBefore[linesBefore.length-1].length;endOfLine=wordSelectionEnd(textarea.value,textarea.selectionStart,true);textToUnstyle=textarea.value.slice(startOfLine,endOfLine);}var linesToUnstyle=textToUnstyle.split("\n");var undoStyling=linesToUnstyle.every(function(line){return orderedListRegex.test(line);});if(undoStyling){lines=linesToUnstyle.map(function(line){return line.replace(orderedListRegex,"");});text3=lines.join("\n");if(noInitialSelection&&startOfLine&&endOfLine){var lengthDiff=linesToUnstyle[0].length-lines[0].length;selectionStart=selectionEnd=textarea.selectionStart-lengthDiff;textarea.selectionStart=startOfLine;textarea.selectionEnd=endOfLine;}}else{lines=numberedLines(lines);text3=lines.join("\n");var _newlinesToSurroundSe2=newlinesToSurroundSelectedText(textarea),newlinesToAppend=_newlinesToSurroundSe2.newlinesToAppend,newlinesToPrepend=_newlinesToSurroundSe2.newlinesToPrepend;selectionStart=textarea.selectionStart+newlinesToAppend.length;selectionEnd=selectionStart+text3.length;if(noInitialSelection)selectionStart=selectionEnd;text3=newlinesToAppend+text3+newlinesToPrepend;}return{text:text3,selectionStart:selectionStart,selectionEnd:selectionEnd};}function numberedLines(lines){var i;var len;var index2;var results=[];for(index2=i=0,len=lines.length;i<len;index2=++i){var line=lines[index2];results.push("".concat(index2+1,". ").concat(line));}return results;}function applyStyle(button,stylesToApply){var toolbar=button.closest("markdown-toolbar");if(!(toolbar instanceof MarkdownToolbarElement))return;var defaults4={prefix:"",suffix:"",blockPrefix:"",blockSuffix:"",multiline:false,replaceNext:"",prefixSpace:false,scanFor:"",surroundWithNewlines:false,orderedList:false,trimFirst:false};var style=Object.assign(Object.assign({},defaults4),stylesToApply);var field=toolbar.field;if(field){field.focus();styleSelectedText(field,style);}}// node_modules/dompurify/dist/purify.es.js
/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function _typeof(obj){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(obj2){return typeof obj2;}:function(obj2){return obj2&&typeof Symbol=="function"&&obj2.constructor===Symbol&&obj2!==Symbol.prototype?"symbol":typeof obj2;},_typeof(obj);}function _setPrototypeOf(o2,p2){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf2(o3,p3){o3.__proto__=p3;return o3;};return _setPrototypeOf(o2,p2);}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e2){return false;}}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct;}else{_construct=function _construct2(Parent2,args2,Class2){var a2=[null];a2.push.apply(a2,args2);var Constructor=Function.bind.apply(Parent2,a2);var instance=new Constructor();if(Class2)_setPrototypeOf(instance,Class2.prototype);return instance;};}return _construct.apply(null,arguments);}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _unsupportedIterableToArray(o2,minLen){if(!o2)return;if(typeof o2==="string")return _arrayLikeToArray(o2,minLen);var n2=Object.prototype.toString.call(o2).slice(8,-1);if(n2==="Object"&&o2.constructor)n2=o2.constructor.name;if(n2==="Map"||n2==="Set")return Array.from(o2);if(n2==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n2))return _arrayLikeToArray(o2,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var hasOwnProperty=Object.hasOwnProperty;var setPrototypeOf=Object.setPrototypeOf;var isFrozen=Object.isFrozen;var getPrototypeOf=Object.getPrototypeOf;var getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;var freeze=Object.freeze;var seal=Object.seal;var create2=Object.create;var _ref=typeof Reflect!=="undefined"&&Reflect;var apply=_ref.apply;var construct=_ref.construct;if(!apply){apply=function apply2(fun,thisValue,args){return fun.apply(thisValue,args);};}if(!freeze){freeze=function freeze2(x){return x;};}if(!seal){seal=function seal2(x){return x;};}if(!construct){construct=function construct2(Func,args){return _construct(Func,_toConsumableArray(args));};}var arrayForEach=unapply(Array.prototype.forEach);var arrayPop=unapply(Array.prototype.pop);var arrayPush=unapply(Array.prototype.push);var stringToLowerCase=unapply(String.prototype.toLowerCase);var stringToString=unapply(String.prototype.toString);var stringMatch=unapply(String.prototype.match);var stringReplace=unapply(String.prototype.replace);var stringIndexOf=unapply(String.prototype.indexOf);var stringTrim=unapply(String.prototype.trim);var regExpTest=unapply(RegExp.prototype.test);var typeErrorCreate=unconstruct(TypeError);function unapply(func){return function(thisArg){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}return apply(func,thisArg,args);};}function unconstruct(func){return function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}return construct(func,args);};}function addToSet(set,array,transformCaseFunc){transformCaseFunc=transformCaseFunc?transformCaseFunc:stringToLowerCase;if(setPrototypeOf){setPrototypeOf(set,null);}var l=array.length;while(l--){var element=array[l];if(typeof element==="string"){var lcElement=transformCaseFunc(element);if(lcElement!==element){if(!isFrozen(array)){array[l]=lcElement;}element=lcElement;}}set[element]=true;}return set;}function clone(object){var newObject=create2(null);var property;for(property in object){if(apply(hasOwnProperty,object,[property])===true){newObject[property]=object[property];}}return newObject;}function lookupGetter(object,prop){while(object!==null){var desc=getOwnPropertyDescriptor(object,prop);if(desc){if(desc.get){return unapply(desc.get);}if(typeof desc.value==="function"){return unapply(desc.value);}}object=getPrototypeOf(object);}function fallbackValue(element){console.warn("fallback value for",element);return null;}return fallbackValue;}var html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]);var svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]);var svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]);var svgDisallowed=freeze(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]);var mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]);var mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]);var text2=freeze(["#text"]);var html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]);var svg3=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]);var mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]);var xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]);var MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm);var ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm);var TMPLIT_EXPR=seal(/\${[\w\W]*}/gm);var DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/);var ARIA_ATTR=seal(/^aria-[\-\w]+$/);var IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);var IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i);var ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g);var DOCTYPE_NAME=seal(/^html$/i);var getGlobal=function getGlobal2(){return typeof window==="undefined"?null:window;};var _createTrustedTypesPolicy=function _createTrustedTypesPolicy2(trustedTypes,document2){if(_typeof(trustedTypes)!=="object"||typeof trustedTypes.createPolicy!=="function"){return null;}var suffix=null;var ATTR_NAME="data-tt-policy-suffix";if(document2.currentScript&&document2.currentScript.hasAttribute(ATTR_NAME)){suffix=document2.currentScript.getAttribute(ATTR_NAME);}var policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:function createHTML(html2){return html2;},createScriptURL:function createScriptURL(scriptUrl){return scriptUrl;}});}catch(_){console.warn("TrustedTypes policy "+policyName+" could not be created.");return null;}};function createDOMPurify(){var window2=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();var DOMPurify=function DOMPurify2(root2){return createDOMPurify(root2);};DOMPurify.version="2.4.5";DOMPurify.removed=[];if(!window2||!window2.document||window2.document.nodeType!==9){DOMPurify.isSupported=false;return DOMPurify;}var originalDocument=window2.document;var document2=window2.document;var DocumentFragment=window2.DocumentFragment,HTMLTemplateElement2=window2.HTMLTemplateElement,Node2=window2.Node,Element2=window2.Element,NodeFilter2=window2.NodeFilter,_window$NamedNodeMap=window2.NamedNodeMap,NamedNodeMap=_window$NamedNodeMap===void 0?window2.NamedNodeMap||window2.MozNamedAttrMap:_window$NamedNodeMap,HTMLFormElement=window2.HTMLFormElement,DOMParser2=window2.DOMParser,trustedTypes=window2.trustedTypes;var ElementPrototype=Element2.prototype;var cloneNode=lookupGetter(ElementPrototype,"cloneNode");var getNextSibling=lookupGetter(ElementPrototype,"nextSibling");var getChildNodes=lookupGetter(ElementPrototype,"childNodes");var getParentNode2=lookupGetter(ElementPrototype,"parentNode");if(typeof HTMLTemplateElement2==="function"){var template=document2.createElement("template");if(template.content&&template.content.ownerDocument){document2=template.content.ownerDocument;}}var trustedTypesPolicy=_createTrustedTypesPolicy(trustedTypes,originalDocument);var emptyHTML=trustedTypesPolicy?trustedTypesPolicy.createHTML(""):"";var _document=document2,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,createDocumentFragment=_document.createDocumentFragment,getElementsByTagName=_document.getElementsByTagName;var importNode=originalDocument.importNode;var documentMode={};try{documentMode=clone(document2).documentMode?document2.documentMode:{};}catch(_){}var hooks={};DOMPurify.isSupported=typeof getParentNode2==="function"&&implementation&&typeof implementation.createHTMLDocument!=="undefined"&&documentMode!==9;var MUSTACHE_EXPR$1=MUSTACHE_EXPR,ERB_EXPR$1=ERB_EXPR,TMPLIT_EXPR$1=TMPLIT_EXPR,DATA_ATTR$1=DATA_ATTR,ARIA_ATTR$1=ARIA_ATTR,IS_SCRIPT_OR_DATA$1=IS_SCRIPT_OR_DATA,ATTR_WHITESPACE$1=ATTR_WHITESPACE;var IS_ALLOWED_URI$1=IS_ALLOWED_URI;var ALLOWED_TAGS=null;var DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(html$1),_toConsumableArray(svg$1),_toConsumableArray(svgFilters),_toConsumableArray(mathMl$1),_toConsumableArray(text2)));var ALLOWED_ATTR=null;var DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray(html),_toConsumableArray(svg3),_toConsumableArray(mathMl),_toConsumableArray(xml)));var CUSTOM_ELEMENT_HANDLING=Object.seal(Object.create(null,{tagNameCheck:{writable:true,configurable:false,enumerable:true,value:null},attributeNameCheck:{writable:true,configurable:false,enumerable:true,value:null},allowCustomizedBuiltInElements:{writable:true,configurable:false,enumerable:true,value:false}}));var FORBID_TAGS=null;var FORBID_ATTR=null;var ALLOW_ARIA_ATTR=true;var ALLOW_DATA_ATTR=true;var ALLOW_UNKNOWN_PROTOCOLS=false;var ALLOW_SELF_CLOSE_IN_ATTR=true;var SAFE_FOR_TEMPLATES=false;var WHOLE_DOCUMENT=false;var SET_CONFIG=false;var FORCE_BODY=false;var RETURN_DOM=false;var RETURN_DOM_FRAGMENT=false;var RETURN_TRUSTED_TYPE=false;var SANITIZE_DOM=true;var SANITIZE_NAMED_PROPS=false;var SANITIZE_NAMED_PROPS_PREFIX="user-content-";var KEEP_CONTENT=true;var IN_PLACE=false;var USE_PROFILES={};var FORBID_CONTENTS=null;var DEFAULT_FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);var DATA_URI_TAGS=null;var DEFAULT_DATA_URI_TAGS=addToSet({},["audio","video","img","source","image","track"]);var URI_SAFE_ATTRIBUTES=null;var DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]);var MATHML_NAMESPACE="http://www.w3.org/1998/Math/MathML";var SVG_NAMESPACE="http://www.w3.org/2000/svg";var HTML_NAMESPACE="http://www.w3.org/1999/xhtml";var NAMESPACE=HTML_NAMESPACE;var IS_EMPTY_INPUT=false;var ALLOWED_NAMESPACES=null;var DEFAULT_ALLOWED_NAMESPACES=addToSet({},[MATHML_NAMESPACE,SVG_NAMESPACE,HTML_NAMESPACE],stringToString);var PARSER_MEDIA_TYPE;var SUPPORTED_PARSER_MEDIA_TYPES=["application/xhtml+xml","text/html"];var DEFAULT_PARSER_MEDIA_TYPE="text/html";var transformCaseFunc;var CONFIG=null;var formElement=document2.createElement("form");var isRegexOrFunction=function isRegexOrFunction2(testValue){return testValue instanceof RegExp||testValue instanceof Function;};var _parseConfig=function _parseConfig2(cfg){if(CONFIG&&CONFIG===cfg){return;}if(!cfg||_typeof(cfg)!=="object"){cfg={};}cfg=clone(cfg);PARSER_MEDIA_TYPE=SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE)===-1?PARSER_MEDIA_TYPE=DEFAULT_PARSER_MEDIA_TYPE:PARSER_MEDIA_TYPE=cfg.PARSER_MEDIA_TYPE;transformCaseFunc=PARSER_MEDIA_TYPE==="application/xhtml+xml"?stringToString:stringToLowerCase;ALLOWED_TAGS="ALLOWED_TAGS"in cfg?addToSet({},cfg.ALLOWED_TAGS,transformCaseFunc):DEFAULT_ALLOWED_TAGS;ALLOWED_ATTR="ALLOWED_ATTR"in cfg?addToSet({},cfg.ALLOWED_ATTR,transformCaseFunc):DEFAULT_ALLOWED_ATTR;ALLOWED_NAMESPACES="ALLOWED_NAMESPACES"in cfg?addToSet({},cfg.ALLOWED_NAMESPACES,stringToString):DEFAULT_ALLOWED_NAMESPACES;URI_SAFE_ATTRIBUTES="ADD_URI_SAFE_ATTR"in cfg?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR,transformCaseFunc):DEFAULT_URI_SAFE_ATTRIBUTES;DATA_URI_TAGS="ADD_DATA_URI_TAGS"in cfg?addToSet(clone(DEFAULT_DATA_URI_TAGS),cfg.ADD_DATA_URI_TAGS,transformCaseFunc):DEFAULT_DATA_URI_TAGS;FORBID_CONTENTS="FORBID_CONTENTS"in cfg?addToSet({},cfg.FORBID_CONTENTS,transformCaseFunc):DEFAULT_FORBID_CONTENTS;FORBID_TAGS="FORBID_TAGS"in cfg?addToSet({},cfg.FORBID_TAGS,transformCaseFunc):{};FORBID_ATTR="FORBID_ATTR"in cfg?addToSet({},cfg.FORBID_ATTR,transformCaseFunc):{};USE_PROFILES="USE_PROFILES"in cfg?cfg.USE_PROFILES:false;ALLOW_ARIA_ATTR=cfg.ALLOW_ARIA_ATTR!==false;ALLOW_DATA_ATTR=cfg.ALLOW_DATA_ATTR!==false;ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||false;ALLOW_SELF_CLOSE_IN_ATTR=cfg.ALLOW_SELF_CLOSE_IN_ATTR!==false;SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||false;WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||false;RETURN_DOM=cfg.RETURN_DOM||false;RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||false;RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||false;FORCE_BODY=cfg.FORCE_BODY||false;SANITIZE_DOM=cfg.SANITIZE_DOM!==false;SANITIZE_NAMED_PROPS=cfg.SANITIZE_NAMED_PROPS||false;KEEP_CONTENT=cfg.KEEP_CONTENT!==false;IN_PLACE=cfg.IN_PLACE||false;IS_ALLOWED_URI$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI$1;NAMESPACE=cfg.NAMESPACE||HTML_NAMESPACE;CUSTOM_ELEMENT_HANDLING=cfg.CUSTOM_ELEMENT_HANDLING||{};if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)){CUSTOM_ELEMENT_HANDLING.tagNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;}if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)){CUSTOM_ELEMENT_HANDLING.attributeNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;}if(cfg.CUSTOM_ELEMENT_HANDLING&&typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean"){CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;}if(SAFE_FOR_TEMPLATES){ALLOW_DATA_ATTR=false;}if(RETURN_DOM_FRAGMENT){RETURN_DOM=true;}if(USE_PROFILES){ALLOWED_TAGS=addToSet({},_toConsumableArray(text2));ALLOWED_ATTR=[];if(USE_PROFILES.html===true){addToSet(ALLOWED_TAGS,html$1);addToSet(ALLOWED_ATTR,html);}if(USE_PROFILES.svg===true){addToSet(ALLOWED_TAGS,svg$1);addToSet(ALLOWED_ATTR,svg3);addToSet(ALLOWED_ATTR,xml);}if(USE_PROFILES.svgFilters===true){addToSet(ALLOWED_TAGS,svgFilters);addToSet(ALLOWED_ATTR,svg3);addToSet(ALLOWED_ATTR,xml);}if(USE_PROFILES.mathMl===true){addToSet(ALLOWED_TAGS,mathMl$1);addToSet(ALLOWED_ATTR,mathMl);addToSet(ALLOWED_ATTR,xml);}}if(cfg.ADD_TAGS){if(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS){ALLOWED_TAGS=clone(ALLOWED_TAGS);}addToSet(ALLOWED_TAGS,cfg.ADD_TAGS,transformCaseFunc);}if(cfg.ADD_ATTR){if(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR){ALLOWED_ATTR=clone(ALLOWED_ATTR);}addToSet(ALLOWED_ATTR,cfg.ADD_ATTR,transformCaseFunc);}if(cfg.ADD_URI_SAFE_ATTR){addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR,transformCaseFunc);}if(cfg.FORBID_CONTENTS){if(FORBID_CONTENTS===DEFAULT_FORBID_CONTENTS){FORBID_CONTENTS=clone(FORBID_CONTENTS);}addToSet(FORBID_CONTENTS,cfg.FORBID_CONTENTS,transformCaseFunc);}if(KEEP_CONTENT){ALLOWED_TAGS["#text"]=true;}if(WHOLE_DOCUMENT){addToSet(ALLOWED_TAGS,["html","head","body"]);}if(ALLOWED_TAGS.table){addToSet(ALLOWED_TAGS,["tbody"]);delete FORBID_TAGS.tbody;}if(freeze){freeze(cfg);}CONFIG=cfg;};var MATHML_TEXT_INTEGRATION_POINTS=addToSet({},["mi","mo","mn","ms","mtext"]);var HTML_INTEGRATION_POINTS=addToSet({},["foreignobject","desc","title","annotation-xml"]);var COMMON_SVG_AND_HTML_ELEMENTS=addToSet({},["title","style","font","a","script"]);var ALL_SVG_TAGS=addToSet({},svg$1);addToSet(ALL_SVG_TAGS,svgFilters);addToSet(ALL_SVG_TAGS,svgDisallowed);var ALL_MATHML_TAGS=addToSet({},mathMl$1);addToSet(ALL_MATHML_TAGS,mathMlDisallowed);var _checkValidNamespace=function _checkValidNamespace2(element){var parent=getParentNode2(element);if(!parent||!parent.tagName){parent={namespaceURI:NAMESPACE,tagName:"template"};}var tagName=stringToLowerCase(element.tagName);var parentTagName=stringToLowerCase(parent.tagName);if(!ALLOWED_NAMESPACES[element.namespaceURI]){return false;}if(element.namespaceURI===SVG_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="svg";}if(parent.namespaceURI===MATHML_NAMESPACE){return tagName==="svg"&&(parentTagName==="annotation-xml"||MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);}return Boolean(ALL_SVG_TAGS[tagName]);}if(element.namespaceURI===MATHML_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="math";}if(parent.namespaceURI===SVG_NAMESPACE){return tagName==="math"&&HTML_INTEGRATION_POINTS[parentTagName];}return Boolean(ALL_MATHML_TAGS[tagName]);}if(element.namespaceURI===HTML_NAMESPACE){if(parent.namespaceURI===SVG_NAMESPACE&&!HTML_INTEGRATION_POINTS[parentTagName]){return false;}if(parent.namespaceURI===MATHML_NAMESPACE&&!MATHML_TEXT_INTEGRATION_POINTS[parentTagName]){return false;}return!ALL_MATHML_TAGS[tagName]&&(COMMON_SVG_AND_HTML_ELEMENTS[tagName]||!ALL_SVG_TAGS[tagName]);}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&ALLOWED_NAMESPACES[element.namespaceURI]){return true;}return false;};var _forceRemove=function _forceRemove2(node){arrayPush(DOMPurify.removed,{element:node});try{node.parentNode.removeChild(node);}catch(_){try{node.outerHTML=emptyHTML;}catch(_2){node.remove();}}};var _removeAttribute=function _removeAttribute2(name2,node){try{arrayPush(DOMPurify.removed,{attribute:node.getAttributeNode(name2),from:node});}catch(_){arrayPush(DOMPurify.removed,{attribute:null,from:node});}node.removeAttribute(name2);if(name2==="is"&&!ALLOWED_ATTR[name2]){if(RETURN_DOM||RETURN_DOM_FRAGMENT){try{_forceRemove(node);}catch(_){}}else{try{node.setAttribute(name2,"");}catch(_){}}}};var _initDocument=function _initDocument2(dirty){var doc;var leadingWhitespace;if(FORCE_BODY){dirty="<remove></remove>"+dirty;}else{var matches2=stringMatch(dirty,/^[\r\n\t ]+/);leadingWhitespace=matches2&&matches2[0];}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&NAMESPACE===HTML_NAMESPACE){dirty='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+dirty+"</body></html>";}var dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(NAMESPACE===HTML_NAMESPACE){try{doc=new DOMParser2().parseFromString(dirtyPayload,PARSER_MEDIA_TYPE);}catch(_){}}if(!doc||!doc.documentElement){doc=implementation.createDocument(NAMESPACE,"template",null);try{doc.documentElement.innerHTML=IS_EMPTY_INPUT?emptyHTML:dirtyPayload;}catch(_){}}var body=doc.body||doc.documentElement;if(dirty&&leadingWhitespace){body.insertBefore(document2.createTextNode(leadingWhitespace),body.childNodes[0]||null);}if(NAMESPACE===HTML_NAMESPACE){return getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0];}return WHOLE_DOCUMENT?doc.documentElement:body;};var _createIterator=function _createIterator2(root2){return createNodeIterator.call(root2.ownerDocument||root2,root2,NodeFilter2.SHOW_ELEMENT|NodeFilter2.SHOW_COMMENT|NodeFilter2.SHOW_TEXT,null,false);};var _isClobbered=function _isClobbered2(elm){return elm instanceof HTMLFormElement&&(typeof elm.nodeName!=="string"||typeof elm.textContent!=="string"||typeof elm.removeChild!=="function"||!(elm.attributes instanceof NamedNodeMap)||typeof elm.removeAttribute!=="function"||typeof elm.setAttribute!=="function"||typeof elm.namespaceURI!=="string"||typeof elm.insertBefore!=="function"||typeof elm.hasChildNodes!=="function");};var _isNode=function _isNode2(object){return _typeof(Node2)==="object"?object instanceof Node2:object&&_typeof(object)==="object"&&typeof object.nodeType==="number"&&typeof object.nodeName==="string";};var _executeHook=function _executeHook2(entryPoint,currentNode,data3){if(!hooks[entryPoint]){return;}arrayForEach(hooks[entryPoint],function(hook){hook.call(DOMPurify,currentNode,data3,CONFIG);});};var _sanitizeElements=function _sanitizeElements2(currentNode){var content;_executeHook("beforeSanitizeElements",currentNode,null);if(_isClobbered(currentNode)){_forceRemove(currentNode);return true;}if(regExpTest(/[\u0080-\uFFFF]/,currentNode.nodeName)){_forceRemove(currentNode);return true;}var tagName=transformCaseFunc(currentNode.nodeName);_executeHook("uponSanitizeElement",currentNode,{tagName:tagName,allowedTags:ALLOWED_TAGS});if(currentNode.hasChildNodes()&&!_isNode(currentNode.firstElementChild)&&(!_isNode(currentNode.content)||!_isNode(currentNode.content.firstElementChild))&&regExpTest(/<[/\w]/g,currentNode.innerHTML)&&regExpTest(/<[/\w]/g,currentNode.textContent)){_forceRemove(currentNode);return true;}if(tagName==="select"&&regExpTest(/<template/i,currentNode.innerHTML)){_forceRemove(currentNode);return true;}if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(!FORBID_TAGS[tagName]&&_basicCustomElementTest(tagName)){if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,tagName))return false;if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName))return false;}if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]){var parentNode=getParentNode2(currentNode)||currentNode.parentNode;var childNodes=getChildNodes(currentNode)||currentNode.childNodes;if(childNodes&&parentNode){var childCount=childNodes.length;for(var i=childCount-1;i>=0;--i){parentNode.insertBefore(cloneNode(childNodes[i],true),getNextSibling(currentNode));}}}_forceRemove(currentNode);return true;}if(currentNode instanceof Element2&&!_checkValidNamespace(currentNode)){_forceRemove(currentNode);return true;}if((tagName==="noscript"||tagName==="noembed")&&regExpTest(/<\/no(script|embed)/i,currentNode.innerHTML)){_forceRemove(currentNode);return true;}if(SAFE_FOR_TEMPLATES&&currentNode.nodeType===3){content=currentNode.textContent;content=stringReplace(content,MUSTACHE_EXPR$1," ");content=stringReplace(content,ERB_EXPR$1," ");content=stringReplace(content,TMPLIT_EXPR$1," ");if(currentNode.textContent!==content){arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()});currentNode.textContent=content;}}_executeHook("afterSanitizeElements",currentNode,null);return false;};var _isValidAttribute=function _isValidAttribute2(lcTag,lcName,value){if(SANITIZE_DOM&&(lcName==="id"||lcName==="name")&&(value in document2||value in formElement)){return false;}if(ALLOW_DATA_ATTR&&!FORBID_ATTR[lcName]&&regExpTest(DATA_ATTR$1,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR$1,lcName));else if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName]){if(_basicCustomElementTest(lcTag)&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,lcTag)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))&&(CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck,lcName)||CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName))||lcName==="is"&&CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,value)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(value)));else{return false;}}else if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$1,stringReplace(value,ATTR_WHITESPACE$1,"")));else if((lcName==="src"||lcName==="xlink:href"||lcName==="href")&&lcTag!=="script"&&stringIndexOf(value,"data:")===0&&DATA_URI_TAGS[lcTag]);else if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA$1,stringReplace(value,ATTR_WHITESPACE$1,"")));else if(!value);else{return false;}return true;};var _basicCustomElementTest=function _basicCustomElementTest2(tagName){return tagName.indexOf("-")>0;};var _sanitizeAttributes=function _sanitizeAttributes2(currentNode){var attr2;var value;var lcName;var l;_executeHook("beforeSanitizeAttributes",currentNode,null);var attributes=currentNode.attributes;if(!attributes){return;}var hookEvent={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:ALLOWED_ATTR};l=attributes.length;while(l--){attr2=attributes[l];var _attr=attr2,name2=_attr.name,namespaceURI=_attr.namespaceURI;value=name2==="value"?attr2.value:stringTrim(attr2.value);lcName=transformCaseFunc(name2);hookEvent.attrName=lcName;hookEvent.attrValue=value;hookEvent.keepAttr=true;hookEvent.forceKeepAttr=void 0;_executeHook("uponSanitizeAttribute",currentNode,hookEvent);value=hookEvent.attrValue;if(hookEvent.forceKeepAttr){continue;}_removeAttribute(name2,currentNode);if(!hookEvent.keepAttr){continue;}if(!ALLOW_SELF_CLOSE_IN_ATTR&&regExpTest(/\/>/i,value)){_removeAttribute(name2,currentNode);continue;}if(SAFE_FOR_TEMPLATES){value=stringReplace(value,MUSTACHE_EXPR$1," ");value=stringReplace(value,ERB_EXPR$1," ");value=stringReplace(value,TMPLIT_EXPR$1," ");}var lcTag=transformCaseFunc(currentNode.nodeName);if(!_isValidAttribute(lcTag,lcName,value)){continue;}if(SANITIZE_NAMED_PROPS&&(lcName==="id"||lcName==="name")){_removeAttribute(name2,currentNode);value=SANITIZE_NAMED_PROPS_PREFIX+value;}if(trustedTypesPolicy&&_typeof(trustedTypes)==="object"&&typeof trustedTypes.getAttributeType==="function"){if(namespaceURI);else{switch(trustedTypes.getAttributeType(lcTag,lcName)){case"TrustedHTML":value=trustedTypesPolicy.createHTML(value);break;case"TrustedScriptURL":value=trustedTypesPolicy.createScriptURL(value);break;}}}try{if(namespaceURI){currentNode.setAttributeNS(namespaceURI,name2,value);}else{currentNode.setAttribute(name2,value);}arrayPop(DOMPurify.removed);}catch(_){}}_executeHook("afterSanitizeAttributes",currentNode,null);};var _sanitizeShadowDOM=function _sanitizeShadowDOM2(fragment){var shadowNode;var shadowIterator=_createIterator(fragment);_executeHook("beforeSanitizeShadowDOM",fragment,null);while(shadowNode=shadowIterator.nextNode()){_executeHook("uponSanitizeShadowNode",shadowNode,null);if(_sanitizeElements(shadowNode)){continue;}if(shadowNode.content instanceof DocumentFragment){_sanitizeShadowDOM2(shadowNode.content);}_sanitizeAttributes(shadowNode);}_executeHook("afterSanitizeShadowDOM",fragment,null);};DOMPurify.sanitize=function(dirty){var cfg=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var body;var importedNode;var currentNode;var oldNode;var returnNode;IS_EMPTY_INPUT=!dirty;if(IS_EMPTY_INPUT){dirty="<!-->";}if(typeof dirty!=="string"&&!_isNode(dirty)){if(typeof dirty.toString!=="function"){throw typeErrorCreate("toString is not a function");}else{dirty=dirty.toString();if(typeof dirty!=="string"){throw typeErrorCreate("dirty is not a string, aborting");}}}if(!DOMPurify.isSupported){if(_typeof(window2.toStaticHTML)==="object"||typeof window2.toStaticHTML==="function"){if(typeof dirty==="string"){return window2.toStaticHTML(dirty);}if(_isNode(dirty)){return window2.toStaticHTML(dirty.outerHTML);}}return dirty;}if(!SET_CONFIG){_parseConfig(cfg);}DOMPurify.removed=[];if(typeof dirty==="string"){IN_PLACE=false;}if(IN_PLACE){if(dirty.nodeName){var tagName=transformCaseFunc(dirty.nodeName);if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place");}}}else if(dirty instanceof Node2){body=_initDocument("<!---->");importedNode=body.ownerDocument.importNode(dirty,true);if(importedNode.nodeType===1&&importedNode.nodeName==="BODY"){body=importedNode;}else if(importedNode.nodeName==="HTML"){body=importedNode;}else{body.appendChild(importedNode);}}else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&dirty.indexOf("<")===-1){return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(dirty):dirty;}body=_initDocument(dirty);if(!body){return RETURN_DOM?null:RETURN_TRUSTED_TYPE?emptyHTML:"";}}if(body&&FORCE_BODY){_forceRemove(body.firstChild);}var nodeIterator=_createIterator(IN_PLACE?dirty:body);while(currentNode=nodeIterator.nextNode()){if(currentNode.nodeType===3&&currentNode===oldNode){continue;}if(_sanitizeElements(currentNode)){continue;}if(currentNode.content instanceof DocumentFragment){_sanitizeShadowDOM(currentNode.content);}_sanitizeAttributes(currentNode);oldNode=currentNode;}oldNode=null;if(IN_PLACE){return dirty;}if(RETURN_DOM){if(RETURN_DOM_FRAGMENT){returnNode=createDocumentFragment.call(body.ownerDocument);while(body.firstChild){returnNode.appendChild(body.firstChild);}}else{returnNode=body;}if(ALLOWED_ATTR.shadowroot||ALLOWED_ATTR.shadowrootmod){returnNode=importNode.call(originalDocument,returnNode,true);}return returnNode;}var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;if(WHOLE_DOCUMENT&&ALLOWED_TAGS["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,body.ownerDocument.doctype.name)){serializedHTML="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+serializedHTML;}if(SAFE_FOR_TEMPLATES){serializedHTML=stringReplace(serializedHTML,MUSTACHE_EXPR$1," ");serializedHTML=stringReplace(serializedHTML,ERB_EXPR$1," ");serializedHTML=stringReplace(serializedHTML,TMPLIT_EXPR$1," ");}return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML;};DOMPurify.setConfig=function(cfg){_parseConfig(cfg);SET_CONFIG=true;};DOMPurify.clearConfig=function(){CONFIG=null;SET_CONFIG=false;};DOMPurify.isValidAttribute=function(tag,attr2,value){if(!CONFIG){_parseConfig({});}var lcTag=transformCaseFunc(tag);var lcName=transformCaseFunc(attr2);return _isValidAttribute(lcTag,lcName,value);};DOMPurify.addHook=function(entryPoint,hookFunction){if(typeof hookFunction!=="function"){return;}hooks[entryPoint]=hooks[entryPoint]||[];arrayPush(hooks[entryPoint],hookFunction);};DOMPurify.removeHook=function(entryPoint){if(hooks[entryPoint]){return arrayPop(hooks[entryPoint]);}};DOMPurify.removeHooks=function(entryPoint){if(hooks[entryPoint]){hooks[entryPoint]=[];}};DOMPurify.removeAllHooks=function(){hooks={};};return DOMPurify;}var purify=createDOMPurify();// node_modules/marked/lib/marked.esm.js
function getDefaults(){return{async:false,baseUrl:null,breaks:false,extensions:null,gfm:true,headerIds:true,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:true,pedantic:false,renderer:null,sanitize:false,sanitizer:null,silent:false,smartypants:false,tokenizer:null,walkTokens:null,xhtml:false};}var defaults2=getDefaults();function changeDefaults(newDefaults){defaults2=newDefaults;}var escapeTest=/[&<>"']/;var escapeReplace=new RegExp(escapeTest.source,"g");var escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;var escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g");var escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var getEscapeReplacement=function getEscapeReplacement(ch){return escapeReplacements[ch];};function _escape(html2,encode){if(encode){if(escapeTest.test(html2)){return html2.replace(escapeReplace,getEscapeReplacement);}}else{if(escapeTestNoEncode.test(html2)){return html2.replace(escapeReplaceNoEncode,getEscapeReplacement);}}return html2;}var unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape2(html2){return html2.replace(unescapeTest,function(_,n2){n2=n2.toLowerCase();if(n2==="colon")return":";if(n2.charAt(0)==="#"){return n2.charAt(1)==="x"?String.fromCharCode(parseInt(n2.substring(2),16)):String.fromCharCode(+n2.substring(1));}return"";});}var caret=/(^|[^\[])\^/g;function edit(regex,opt){regex=typeof regex==="string"?regex:regex.source;opt=opt||"";var obj={replace:function replace(name2,val){val=val.source||val;val=val.replace(caret,"$1");regex=regex.replace(name2,val);return obj;},getRegex:function getRegex(){return new RegExp(regex,opt);}};return obj;}var nonWordAndColonTest=/[^\w:]/g;var originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(sanitize,base,href){if(sanitize){var prot;try{prot=decodeURIComponent(unescape2(href)).replace(nonWordAndColonTest,"").toLowerCase();}catch(e2){return null;}if(prot.indexOf("javascript:")===0||prot.indexOf("vbscript:")===0||prot.indexOf("data:")===0){return null;}}if(base&&!originIndependentUrl.test(href)){href=resolveUrl(base,href);}try{href=encodeURI(href).replace(/%25/g,"%");}catch(e2){return null;}return href;}var baseUrls={};var justDomain=/^[^:]+:\/*[^/]*$/;var protocol=/^([^:]+:)[\s\S]*$/;var domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(base,href){if(!baseUrls[" "+base]){if(justDomain.test(base)){baseUrls[" "+base]=base+"/";}else{baseUrls[" "+base]=rtrim(base,"/",true);}}base=baseUrls[" "+base];var relativeBase=base.indexOf(":")===-1;if(href.substring(0,2)==="//"){if(relativeBase){return href;}return base.replace(protocol,"$1")+href;}else if(href.charAt(0)==="/"){if(relativeBase){return href;}return base.replace(domain,"$1")+href;}else{return base+href;}}var noopTest={exec:function noopTest2(){}};function splitCells(tableRow,count){var row=tableRow.replace(/\|/g,function(match,offset2,str){var escaped=false,curr=offset2;while(--curr>=0&&str[curr]==="\\"){escaped=!escaped;}if(escaped){return"|";}else{return" |";}}),cells=row.split(/ \|/);var i=0;if(!cells[0].trim()){cells.shift();}if(cells.length>0&&!cells[cells.length-1].trim()){cells.pop();}if(cells.length>count){cells.splice(count);}else{while(cells.length<count){cells.push("");}}for(;i<cells.length;i++){cells[i]=cells[i].trim().replace(/\\\|/g,"|");}return cells;}function rtrim(str,c2,invert){var l=str.length;if(l===0){return"";}var suffLen=0;while(suffLen<l){var currChar=str.charAt(l-suffLen-1);if(currChar===c2&&!invert){suffLen++;}else if(currChar!==c2&&invert){suffLen++;}else{break;}}return str.slice(0,l-suffLen);}function findClosingBracket(str,b){if(str.indexOf(b[1])===-1){return-1;}var l=str.length;var level=0,i=0;for(;i<l;i++){if(str[i]==="\\"){i++;}else if(str[i]===b[0]){level++;}else if(str[i]===b[1]){level--;if(level<0){return i;}}}return-1;}function checkSanitizeDeprecation(opt){if(opt&&opt.sanitize&&!opt.silent){console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options");}}function repeatString(pattern,count){if(count<1){return"";}var result="";while(count>1){if(count&1){result+=pattern;}count>>=1;pattern+=pattern;}return result+pattern;}function outputLink(cap,link,raw,lexer2){var href=link.href;var title=link.title?_escape(link.title):null;var text3=cap[1].replace(/\\([\[\]])/g,"$1");if(cap[0].charAt(0)!=="!"){lexer2.state.inLink=true;var token={type:"link",raw:raw,href:href,title:title,text:text3,tokens:lexer2.inlineTokens(text3)};lexer2.state.inLink=false;return token;}return{type:"image",raw:raw,href:href,title:title,text:_escape(text3)};}function indentCodeCompensation(raw,text3){var matchIndentToCode=raw.match(/^(\s+)(?:```)/);if(matchIndentToCode===null){return text3;}var indentToCode=matchIndentToCode[1];return text3.split("\n").map(function(node){var matchIndentInNode=node.match(/^\s+/);if(matchIndentInNode===null){return node;}var _matchIndentInNode=_slicedToArray(matchIndentInNode,1),indentInNode=_matchIndentInNode[0];if(indentInNode.length>=indentToCode.length){return node.slice(indentToCode.length);}return node;}).join("\n");}var Tokenizer=/*#__PURE__*/function(){function Tokenizer(options2){_classCallCheck(this,Tokenizer);this.options=options2||defaults2;}_createClass(Tokenizer,[{key:"space",value:function space(src){var cap=this.rules.block.newline.exec(src);if(cap&&cap[0].length>0){return{type:"space",raw:cap[0]};}}},{key:"code",value:function code(src){var cap=this.rules.block.code.exec(src);if(cap){var text3=cap[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:cap[0],codeBlockStyle:"indented",text:!this.options.pedantic?rtrim(text3,"\n"):text3};}}},{key:"fences",value:function fences(src){var cap=this.rules.block.fences.exec(src);if(cap){var raw=cap[0];var text3=indentCodeCompensation(raw,cap[3]||"");return{type:"code",raw:raw,lang:cap[2]?cap[2].trim().replace(this.rules.inline._escapes,"$1"):cap[2],text:text3};}}},{key:"heading",value:function heading(src){var cap=this.rules.block.heading.exec(src);if(cap){var text3=cap[2].trim();if(/#$/.test(text3)){var trimmed=rtrim(text3,"#");if(this.options.pedantic){text3=trimmed.trim();}else if(!trimmed||/ $/.test(trimmed)){text3=trimmed.trim();}}return{type:"heading",raw:cap[0],depth:cap[1].length,text:text3,tokens:this.lexer.inline(text3)};}}},{key:"hr",value:function hr(src){var cap=this.rules.block.hr.exec(src);if(cap){return{type:"hr",raw:cap[0]};}}},{key:"blockquote",value:function blockquote(src){var cap=this.rules.block.blockquote.exec(src);if(cap){var text3=cap[0].replace(/^ *>[ \t]?/gm,"");var top=this.lexer.state.top;this.lexer.state.top=true;var tokens=this.lexer.blockTokens(text3);this.lexer.state.top=top;return{type:"blockquote",raw:cap[0],tokens:tokens,text:text3};}}},{key:"list",value:function list(src){var cap=this.rules.block.list.exec(src);if(cap){var raw,istask,ischecked,indent,i,blankLine,endsWithBlankLine,line,nextLine,rawLine,itemContents,endEarly;var bull=cap[1].trim();var isordered=bull.length>1;var list2={type:"list",raw:"",ordered:isordered,start:isordered?+bull.slice(0,-1):"",loose:false,items:[]};bull=isordered?"\\d{1,9}\\".concat(bull.slice(-1)):"\\".concat(bull);if(this.options.pedantic){bull=isordered?bull:"[*+-]";}var itemRegex=new RegExp("^( {0,3}".concat(bull,")((?:[\t ][^\\n]*)?(?:\\n|$))"));while(src){endEarly=false;if(!(cap=itemRegex.exec(src))){break;}if(this.rules.block.hr.test(src)){break;}raw=cap[0];src=src.substring(raw.length);line=cap[2].split("\n",1)[0].replace(/^\t+/,function(t2){return" ".repeat(3*t2.length);});nextLine=src.split("\n",1)[0];if(this.options.pedantic){indent=2;itemContents=line.trimLeft();}else{indent=cap[2].search(/[^ ]/);indent=indent>4?1:indent;itemContents=line.slice(indent);indent+=cap[1].length;}blankLine=false;if(!line&&/^ *$/.test(nextLine)){raw+=nextLine+"\n";src=src.substring(nextLine.length+1);endEarly=true;}if(!endEarly){var nextBulletRegex=new RegExp("^ {0,".concat(Math.min(3,indent-1),"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))"));var hrRegex=new RegExp("^ {0,".concat(Math.min(3,indent-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"));var fencesBeginRegex=new RegExp("^ {0,".concat(Math.min(3,indent-1),"}(?:```|~~~)"));var headingBeginRegex=new RegExp("^ {0,".concat(Math.min(3,indent-1),"}#"));while(src){rawLine=src.split("\n",1)[0];nextLine=rawLine;if(this.options.pedantic){nextLine=nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ");}if(fencesBeginRegex.test(nextLine)){break;}if(headingBeginRegex.test(nextLine)){break;}if(nextBulletRegex.test(nextLine)){break;}if(hrRegex.test(src)){break;}if(nextLine.search(/[^ ]/)>=indent||!nextLine.trim()){itemContents+="\n"+nextLine.slice(indent);}else{if(blankLine){break;}if(line.search(/[^ ]/)>=4){break;}if(fencesBeginRegex.test(line)){break;}if(headingBeginRegex.test(line)){break;}if(hrRegex.test(line)){break;}itemContents+="\n"+nextLine;}if(!blankLine&&!nextLine.trim()){blankLine=true;}raw+=rawLine+"\n";src=src.substring(rawLine.length+1);line=nextLine.slice(indent);}}if(!list2.loose){if(endsWithBlankLine){list2.loose=true;}else if(/\n *\n *$/.test(raw)){endsWithBlankLine=true;}}if(this.options.gfm){istask=/^\[[ xX]\] /.exec(itemContents);if(istask){ischecked=istask[0]!=="[ ] ";itemContents=itemContents.replace(/^\[[ xX]\] +/,"");}}list2.items.push({type:"list_item",raw:raw,task:!!istask,checked:ischecked,loose:false,text:itemContents});list2.raw+=raw;}list2.items[list2.items.length-1].raw=raw.trimRight();list2.items[list2.items.length-1].text=itemContents.trimRight();list2.raw=list2.raw.trimRight();var l=list2.items.length;for(i=0;i<l;i++){this.lexer.state.top=false;list2.items[i].tokens=this.lexer.blockTokens(list2.items[i].text,[]);if(!list2.loose){var spacers=list2.items[i].tokens.filter(function(t2){return t2.type==="space";});var hasMultipleLineBreaks=spacers.length>0&&spacers.some(function(t2){return /\n.*\n/.test(t2.raw);});list2.loose=hasMultipleLineBreaks;}}if(list2.loose){for(i=0;i<l;i++){list2.items[i].loose=true;}}return list2;}}},{key:"html",value:function html(src){var cap=this.rules.block.html.exec(src);if(cap){var token={type:"html",raw:cap[0],pre:!this.options.sanitizer&&(cap[1]==="pre"||cap[1]==="script"||cap[1]==="style"),text:cap[0]};if(this.options.sanitize){var text3=this.options.sanitizer?this.options.sanitizer(cap[0]):_escape(cap[0]);token.type="paragraph";token.text=text3;token.tokens=this.lexer.inline(text3);}return token;}}},{key:"def",value:function def(src){var cap=this.rules.block.def.exec(src);if(cap){var tag=cap[1].toLowerCase().replace(/\s+/g," ");var href=cap[2]?cap[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"";var title=cap[3]?cap[3].substring(1,cap[3].length-1).replace(this.rules.inline._escapes,"$1"):cap[3];return{type:"def",tag:tag,raw:cap[0],href:href,title:title};}}},{key:"table",value:function table(src){var cap=this.rules.block.table.exec(src);if(cap){var item2={type:"table",header:splitCells(cap[1]).map(function(c2){return{text:c2};}),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:cap[3]&&cap[3].trim()?cap[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(item2.header.length===item2.align.length){item2.raw=cap[0];var l=item2.align.length;var i,j,k,row;for(i=0;i<l;i++){if(/^ *-+: *$/.test(item2.align[i])){item2.align[i]="right";}else if(/^ *:-+: *$/.test(item2.align[i])){item2.align[i]="center";}else if(/^ *:-+ *$/.test(item2.align[i])){item2.align[i]="left";}else{item2.align[i]=null;}}l=item2.rows.length;for(i=0;i<l;i++){item2.rows[i]=splitCells(item2.rows[i],item2.header.length).map(function(c2){return{text:c2};});}l=item2.header.length;for(j=0;j<l;j++){item2.header[j].tokens=this.lexer.inline(item2.header[j].text);}l=item2.rows.length;for(j=0;j<l;j++){row=item2.rows[j];for(k=0;k<row.length;k++){row[k].tokens=this.lexer.inline(row[k].text);}}return item2;}}}},{key:"lheading",value:function lheading(src){var cap=this.rules.block.lheading.exec(src);if(cap){return{type:"heading",raw:cap[0],depth:cap[2].charAt(0)==="="?1:2,text:cap[1],tokens:this.lexer.inline(cap[1])};}}},{key:"paragraph",value:function paragraph(src){var cap=this.rules.block.paragraph.exec(src);if(cap){var text3=cap[1].charAt(cap[1].length-1)==="\n"?cap[1].slice(0,-1):cap[1];return{type:"paragraph",raw:cap[0],text:text3,tokens:this.lexer.inline(text3)};}}},{key:"text",value:function text(src){var cap=this.rules.block.text.exec(src);if(cap){return{type:"text",raw:cap[0],text:cap[0],tokens:this.lexer.inline(cap[0])};}}},{key:"escape",value:function escape(src){var cap=this.rules.inline.escape.exec(src);if(cap){return{type:"escape",raw:cap[0],text:_escape(cap[1])};}}},{key:"tag",value:function tag(src){var cap=this.rules.inline.tag.exec(src);if(cap){if(!this.lexer.state.inLink&&/^<a /i.test(cap[0])){this.lexer.state.inLink=true;}else if(this.lexer.state.inLink&&/^<\/a>/i.test(cap[0])){this.lexer.state.inLink=false;}if(!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])){this.lexer.state.inRawBlock=true;}else if(this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])){this.lexer.state.inRawBlock=false;}return{type:this.options.sanitize?"text":"html",raw:cap[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(cap[0]):_escape(cap[0]):cap[0]};}}},{key:"link",value:function link(src){var cap=this.rules.inline.link.exec(src);if(cap){var trimmedUrl=cap[2].trim();if(!this.options.pedantic&&/^</.test(trimmedUrl)){if(!/>$/.test(trimmedUrl)){return;}var rtrimSlash=rtrim(trimmedUrl.slice(0,-1),"\\");if((trimmedUrl.length-rtrimSlash.length)%2===0){return;}}else{var lastParenIndex=findClosingBracket(cap[2],"()");if(lastParenIndex>-1){var start=cap[0].indexOf("!")===0?5:4;var linkLen=start+cap[1].length+lastParenIndex;cap[2]=cap[2].substring(0,lastParenIndex);cap[0]=cap[0].substring(0,linkLen).trim();cap[3]="";}}var href=cap[2];var title="";if(this.options.pedantic){var link=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);if(link){href=link[1];title=link[3];}}else{title=cap[3]?cap[3].slice(1,-1):"";}href=href.trim();if(/^</.test(href)){if(this.options.pedantic&&!/>$/.test(trimmedUrl)){href=href.slice(1);}else{href=href.slice(1,-1);}}return outputLink(cap,{href:href?href.replace(this.rules.inline._escapes,"$1"):href,title:title?title.replace(this.rules.inline._escapes,"$1"):title},cap[0],this.lexer);}}},{key:"reflink",value:function reflink(src,links){var cap;if((cap=this.rules.inline.reflink.exec(src))||(cap=this.rules.inline.nolink.exec(src))){var link=(cap[2]||cap[1]).replace(/\s+/g," ");link=links[link.toLowerCase()];if(!link){var text3=cap[0].charAt(0);return{type:"text",raw:text3,text:text3};}return outputLink(cap,link,cap[0],this.lexer);}}},{key:"emStrong",value:function emStrong(src,maskedSrc){var prevChar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var match=this.rules.inline.emStrong.lDelim.exec(src);if(!match)return;if(match[3]&&prevChar.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))return;var nextChar=match[1]||match[2]||"";if(!nextChar||nextChar&&(prevChar===""||this.rules.inline.punctuation.exec(prevChar))){var lLength=match[0].length-1;var rDelim,rLength,delimTotal=lLength,midDelimTotal=0;var endReg=match[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;endReg.lastIndex=0;maskedSrc=maskedSrc.slice(-1*src.length+lLength);while((match=endReg.exec(maskedSrc))!=null){rDelim=match[1]||match[2]||match[3]||match[4]||match[5]||match[6];if(!rDelim)continue;rLength=rDelim.length;if(match[3]||match[4]){delimTotal+=rLength;continue;}else if(match[5]||match[6]){if(lLength%3&&!((lLength+rLength)%3)){midDelimTotal+=rLength;continue;}}delimTotal-=rLength;if(delimTotal>0)continue;rLength=Math.min(rLength,rLength+delimTotal+midDelimTotal);var raw=src.slice(0,lLength+match.index+(match[0].length-rDelim.length)+rLength);if(Math.min(lLength,rLength)%2){var text4=raw.slice(1,-1);return{type:"em",raw:raw,text:text4,tokens:this.lexer.inlineTokens(text4)};}var text3=raw.slice(2,-2);return{type:"strong",raw:raw,text:text3,tokens:this.lexer.inlineTokens(text3)};}}}},{key:"codespan",value:function codespan(src){var cap=this.rules.inline.code.exec(src);if(cap){var text3=cap[2].replace(/\n/g," ");var hasNonSpaceChars=/[^ ]/.test(text3);var hasSpaceCharsOnBothEnds=/^ /.test(text3)&&/ $/.test(text3);if(hasNonSpaceChars&&hasSpaceCharsOnBothEnds){text3=text3.substring(1,text3.length-1);}text3=_escape(text3,true);return{type:"codespan",raw:cap[0],text:text3};}}},{key:"br",value:function br(src){var cap=this.rules.inline.br.exec(src);if(cap){return{type:"br",raw:cap[0]};}}},{key:"del",value:function del(src){var cap=this.rules.inline.del.exec(src);if(cap){return{type:"del",raw:cap[0],text:cap[2],tokens:this.lexer.inlineTokens(cap[2])};}}},{key:"autolink",value:function autolink(src,mangle2){var cap=this.rules.inline.autolink.exec(src);if(cap){var text3,href;if(cap[2]==="@"){text3=_escape(this.options.mangle?mangle2(cap[1]):cap[1]);href="mailto:"+text3;}else{text3=_escape(cap[1]);href=text3;}return{type:"link",raw:cap[0],text:text3,href:href,tokens:[{type:"text",raw:text3,text:text3}]};}}},{key:"url",value:function url(src,mangle2){var cap;if(cap=this.rules.inline.url.exec(src)){var text3,href;if(cap[2]==="@"){text3=_escape(this.options.mangle?mangle2(cap[0]):cap[0]);href="mailto:"+text3;}else{var prevCapZero;do{prevCapZero=cap[0];cap[0]=this.rules.inline._backpedal.exec(cap[0])[0];}while(prevCapZero!==cap[0]);text3=_escape(cap[0]);if(cap[1]==="www."){href="http://"+cap[0];}else{href=cap[0];}}return{type:"link",raw:cap[0],text:text3,href:href,tokens:[{type:"text",raw:text3,text:text3}]};}}},{key:"inlineText",value:function inlineText(src,smartypants2){var cap=this.rules.inline.text.exec(src);if(cap){var text3;if(this.lexer.state.inRawBlock){text3=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(cap[0]):_escape(cap[0]):cap[0];}else{text3=_escape(this.options.smartypants?smartypants2(cap[0]):cap[0]);}return{type:"text",raw:cap[0],text:text3};}}}]);return Tokenizer;}();var block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal=_objectSpread({},block);block.gfm=_objectSpread(_objectSpread({},block.normal),{},{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic=_objectSpread(_objectSpread({},block.normal),{},{html:edit("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;inline.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal=_objectSpread({},inline);inline.pedantic=_objectSpread(_objectSpread({},inline.normal),{},{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()});inline.gfm=_objectSpread(_objectSpread({},inline.normal),{},{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks=_objectSpread(_objectSpread({},inline.gfm),{},{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(text3){return text3.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026");}function mangle(text3){var out="",i,ch;var l=text3.length;for(i=0;i<l;i++){ch=text3.charCodeAt(i);if(Math.random()>0.5){ch="x"+ch.toString(16);}out+="&#"+ch+";";}return out;}var Lexer=/*#__PURE__*/function(){function Lexer(options2){_classCallCheck(this,Lexer);this.tokens=[];this.tokens.links=Object.create(null);this.options=options2||defaults2;this.options.tokenizer=this.options.tokenizer||new Tokenizer();this.tokenizer=this.options.tokenizer;this.tokenizer.options=this.options;this.tokenizer.lexer=this;this.inlineQueue=[];this.state={inLink:false,inRawBlock:false,top:true};var rules={block:block.normal,inline:inline.normal};if(this.options.pedantic){rules.block=block.pedantic;rules.inline=inline.pedantic;}else if(this.options.gfm){rules.block=block.gfm;if(this.options.breaks){rules.inline=inline.breaks;}else{rules.inline=inline.gfm;}}this.tokenizer.rules=rules;}_createClass(Lexer,[{key:"lex",value:function lex(src){src=src.replace(/\r\n|\r/g,"\n");this.blockTokens(src,this.tokens);var next;while(next=this.inlineQueue.shift()){this.inlineTokens(next.src,next.tokens);}return this.tokens;}},{key:"blockTokens",value:function blockTokens(src){var _this34=this;var tokens=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(this.options.pedantic){src=src.replace(/\t/g,"    ").replace(/^ +$/gm,"");}else{src=src.replace(/^( *)(\t+)/gm,function(_,leading,tabs){return leading+"    ".repeat(tabs.length);});}var token,lastToken,cutSrc,lastParagraphClipped;while(src){if(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(extTokenizer){if(token=extTokenizer.call({lexer:_this34},src,tokens)){src=src.substring(token.raw.length);tokens.push(token);return true;}return false;})){continue;}if(token=this.tokenizer.space(src)){src=src.substring(token.raw.length);if(token.raw.length===1&&tokens.length>0){tokens[tokens.length-1].raw+="\n";}else{tokens.push(token);}continue;}if(token=this.tokenizer.code(src)){src=src.substring(token.raw.length);lastToken=tokens[tokens.length-1];if(lastToken&&(lastToken.type==="paragraph"||lastToken.type==="text")){lastToken.raw+="\n"+token.raw;lastToken.text+="\n"+token.text;this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text;}else{tokens.push(token);}continue;}if(token=this.tokenizer.fences(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.heading(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.hr(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.blockquote(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.list(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.html(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.def(src)){src=src.substring(token.raw.length);lastToken=tokens[tokens.length-1];if(lastToken&&(lastToken.type==="paragraph"||lastToken.type==="text")){lastToken.raw+="\n"+token.raw;lastToken.text+="\n"+token.raw;this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text;}else if(!this.tokens.links[token.tag]){this.tokens.links[token.tag]={href:token.href,title:token.title};}continue;}if(token=this.tokenizer.table(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.lheading(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}cutSrc=src;if(this.options.extensions&&this.options.extensions.startBlock){(function(){var startIndex=Infinity;var tempSrc=src.slice(1);var tempStart=void 0;_this34.options.extensions.startBlock.forEach(function(getStartIndex){tempStart=getStartIndex.call({lexer:this},tempSrc);if(typeof tempStart==="number"&&tempStart>=0){startIndex=Math.min(startIndex,tempStart);}});if(startIndex<Infinity&&startIndex>=0){cutSrc=src.substring(0,startIndex+1);}})();}if(this.state.top&&(token=this.tokenizer.paragraph(cutSrc))){lastToken=tokens[tokens.length-1];if(lastParagraphClipped&&lastToken.type==="paragraph"){lastToken.raw+="\n"+token.raw;lastToken.text+="\n"+token.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text;}else{tokens.push(token);}lastParagraphClipped=cutSrc.length!==src.length;src=src.substring(token.raw.length);continue;}if(token=this.tokenizer.text(src)){src=src.substring(token.raw.length);lastToken=tokens[tokens.length-1];if(lastToken&&lastToken.type==="text"){lastToken.raw+="\n"+token.raw;lastToken.text+="\n"+token.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text;}else{tokens.push(token);}continue;}if(src){var errMsg="Infinite loop on byte: "+src.charCodeAt(0);if(this.options.silent){console.error(errMsg);break;}else{throw new Error(errMsg);}}}this.state.top=true;return tokens;}},{key:"inline",value:function inline(src){var tokens=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];this.inlineQueue.push({src:src,tokens:tokens});return tokens;}},{key:"inlineTokens",value:function inlineTokens(src){var _this35=this;var tokens=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var token,lastToken,cutSrc;var maskedSrc=src;var match;var keepPrevChar,prevChar;if(this.tokens.links){var links=Object.keys(this.tokens.links);if(links.length>0){while((match=this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc))!=null){if(links.includes(match[0].slice(match[0].lastIndexOf("[")+1,-1))){maskedSrc=maskedSrc.slice(0,match.index)+"["+repeatString("a",match[0].length-2)+"]"+maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);}}}}while((match=this.tokenizer.rules.inline.blockSkip.exec(maskedSrc))!=null){maskedSrc=maskedSrc.slice(0,match.index)+"["+repeatString("a",match[0].length-2)+"]"+maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);}while((match=this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc))!=null){maskedSrc=maskedSrc.slice(0,match.index+match[0].length-2)+"++"+maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);this.tokenizer.rules.inline.escapedEmSt.lastIndex--;}while(src){if(!keepPrevChar){prevChar="";}keepPrevChar=false;if(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(extTokenizer){if(token=extTokenizer.call({lexer:_this35},src,tokens)){src=src.substring(token.raw.length);tokens.push(token);return true;}return false;})){continue;}if(token=this.tokenizer.escape(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.tag(src)){src=src.substring(token.raw.length);lastToken=tokens[tokens.length-1];if(lastToken&&token.type==="text"&&lastToken.type==="text"){lastToken.raw+=token.raw;lastToken.text+=token.text;}else{tokens.push(token);}continue;}if(token=this.tokenizer.link(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.reflink(src,this.tokens.links)){src=src.substring(token.raw.length);lastToken=tokens[tokens.length-1];if(lastToken&&token.type==="text"&&lastToken.type==="text"){lastToken.raw+=token.raw;lastToken.text+=token.text;}else{tokens.push(token);}continue;}if(token=this.tokenizer.emStrong(src,maskedSrc,prevChar)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.codespan(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.br(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.del(src)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(token=this.tokenizer.autolink(src,mangle)){src=src.substring(token.raw.length);tokens.push(token);continue;}if(!this.state.inLink&&(token=this.tokenizer.url(src,mangle))){src=src.substring(token.raw.length);tokens.push(token);continue;}cutSrc=src;if(this.options.extensions&&this.options.extensions.startInline){(function(){var startIndex=Infinity;var tempSrc=src.slice(1);var tempStart=void 0;_this35.options.extensions.startInline.forEach(function(getStartIndex){tempStart=getStartIndex.call({lexer:this},tempSrc);if(typeof tempStart==="number"&&tempStart>=0){startIndex=Math.min(startIndex,tempStart);}});if(startIndex<Infinity&&startIndex>=0){cutSrc=src.substring(0,startIndex+1);}})();}if(token=this.tokenizer.inlineText(cutSrc,smartypants)){src=src.substring(token.raw.length);if(token.raw.slice(-1)!=="_"){prevChar=token.raw.slice(-1);}keepPrevChar=true;lastToken=tokens[tokens.length-1];if(lastToken&&lastToken.type==="text"){lastToken.raw+=token.raw;lastToken.text+=token.text;}else{tokens.push(token);}continue;}if(src){var errMsg="Infinite loop on byte: "+src.charCodeAt(0);if(this.options.silent){console.error(errMsg);break;}else{throw new Error(errMsg);}}}return tokens;}}],[{key:"rules",get:function get(){return{block:block,inline:inline};}},{key:"lex",value:function lex(src,options2){var lexer2=new Lexer(options2);return lexer2.lex(src);}},{key:"lexInline",value:function lexInline(src,options2){var lexer2=new Lexer(options2);return lexer2.inlineTokens(src);}}]);return Lexer;}();var Renderer=/*#__PURE__*/function(){function Renderer(options2){_classCallCheck(this,Renderer);this.options=options2||defaults2;}_createClass(Renderer,[{key:"code",value:function code(_code,infostring,escaped){var lang=(infostring||"").match(/\S*/)[0];if(this.options.highlight){var out=this.options.highlight(_code,lang);if(out!=null&&out!==_code){escaped=true;_code=out;}}_code=_code.replace(/\n$/,"")+"\n";if(!lang){return"<pre><code>"+(escaped?_code:_escape(_code,true))+"</code></pre>\n";}return'<pre><code class="'+this.options.langPrefix+_escape(lang)+'">'+(escaped?_code:_escape(_code,true))+"</code></pre>\n";}},{key:"blockquote",value:function blockquote(quote){return"<blockquote>\n".concat(quote,"</blockquote>\n");}},{key:"html",value:function html(html2){return html2;}},{key:"heading",value:function heading(text3,level,raw,slugger){if(this.options.headerIds){var id=this.options.headerPrefix+slugger.slug(raw);return"<h".concat(level," id=\"").concat(id,"\">").concat(text3,"</h").concat(level,">\n");}return"<h".concat(level,">").concat(text3,"</h").concat(level,">\n");}},{key:"hr",value:function hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n";}},{key:"list",value:function list(body,ordered,start){var type=ordered?"ol":"ul",startatt=ordered&&start!==1?' start="'+start+'"':"";return"<"+type+startatt+">\n"+body+"</"+type+">\n";}},{key:"listitem",value:function listitem(text3){return"<li>".concat(text3,"</li>\n");}},{key:"checkbox",value:function checkbox(checked){return"<input "+(checked?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> ";}},{key:"paragraph",value:function paragraph(text3){return"<p>".concat(text3,"</p>\n");}},{key:"table",value:function table(header,body){if(body)body="<tbody>".concat(body,"</tbody>");return"<table>\n<thead>\n"+header+"</thead>\n"+body+"</table>\n";}},{key:"tablerow",value:function tablerow(content){return"<tr>\n".concat(content,"</tr>\n");}},{key:"tablecell",value:function tablecell(content,flags){var type=flags.header?"th":"td";var tag=flags.align?"<".concat(type," align=\"").concat(flags.align,"\">"):"<".concat(type,">");return tag+content+"</".concat(type,">\n");}},{key:"strong",value:function strong(text3){return"<strong>".concat(text3,"</strong>");}},{key:"em",value:function em(text3){return"<em>".concat(text3,"</em>");}},{key:"codespan",value:function codespan(text3){return"<code>".concat(text3,"</code>");}},{key:"br",value:function br(){return this.options.xhtml?"<br/>":"<br>";}},{key:"del",value:function del(text3){return"<del>".concat(text3,"</del>");}},{key:"link",value:function link(href,title,text3){href=cleanUrl(this.options.sanitize,this.options.baseUrl,href);if(href===null){return text3;}var out='<a href="'+href+'"';if(title){out+=' title="'+title+'"';}out+=">"+text3+"</a>";return out;}},{key:"image",value:function image(href,title,text3){href=cleanUrl(this.options.sanitize,this.options.baseUrl,href);if(href===null){return text3;}var out="<img src=\"".concat(href,"\" alt=\"").concat(text3,"\"");if(title){out+=" title=\"".concat(title,"\"");}out+=this.options.xhtml?"/>":">";return out;}},{key:"text",value:function text(text3){return text3;}}]);return Renderer;}();var TextRenderer=/*#__PURE__*/function(){function TextRenderer(){_classCallCheck(this,TextRenderer);}_createClass(TextRenderer,[{key:"strong",value:function strong(text3){return text3;}},{key:"em",value:function em(text3){return text3;}},{key:"codespan",value:function codespan(text3){return text3;}},{key:"del",value:function del(text3){return text3;}},{key:"html",value:function html(text3){return text3;}},{key:"text",value:function text(text3){return text3;}},{key:"link",value:function link(href,title,text3){return""+text3;}},{key:"image",value:function image(href,title,text3){return""+text3;}},{key:"br",value:function br(){return"";}}]);return TextRenderer;}();var Slugger=/*#__PURE__*/function(){function Slugger(){_classCallCheck(this,Slugger);this.seen={};}_createClass(Slugger,[{key:"serialize",value:function serialize(value){return value.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");}},{key:"getNextSafeSlug",value:function getNextSafeSlug(originalSlug,isDryRun){var slug=originalSlug;var occurenceAccumulator=0;if(this.seen.hasOwnProperty(slug)){occurenceAccumulator=this.seen[originalSlug];do{occurenceAccumulator++;slug=originalSlug+"-"+occurenceAccumulator;}while(this.seen.hasOwnProperty(slug));}if(!isDryRun){this.seen[originalSlug]=occurenceAccumulator;this.seen[slug]=0;}return slug;}},{key:"slug",value:function slug(value){var options2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var slug=this.serialize(value);return this.getNextSafeSlug(slug,options2.dryrun);}}]);return Slugger;}();var Parser=/*#__PURE__*/function(){function Parser(options2){_classCallCheck(this,Parser);this.options=options2||defaults2;this.options.renderer=this.options.renderer||new Renderer();this.renderer=this.options.renderer;this.renderer.options=this.options;this.textRenderer=new TextRenderer();this.slugger=new Slugger();}_createClass(Parser,[{key:"parse",value:function parse(tokens){var top=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var out="",i,j,k,l2,l3,row,cell,header,body,token,ordered,start,loose,itemBody,item2,checked,task,checkbox,ret;var l=tokens.length;for(i=0;i<l;i++){token=tokens[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[token.type]){ret=this.options.extensions.renderers[token.type].call({parser:this},token);if(ret!==false||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(token.type)){out+=ret||"";continue;}}switch(token.type){case"space":{continue;}case"hr":{out+=this.renderer.hr();continue;}case"heading":{out+=this.renderer.heading(this.parseInline(token.tokens),token.depth,unescape2(this.parseInline(token.tokens,this.textRenderer)),this.slugger);continue;}case"code":{out+=this.renderer.code(token.text,token.lang,token.escaped);continue;}case"table":{header="";cell="";l2=token.header.length;for(j=0;j<l2;j++){cell+=this.renderer.tablecell(this.parseInline(token.header[j].tokens),{header:true,align:token.align[j]});}header+=this.renderer.tablerow(cell);body="";l2=token.rows.length;for(j=0;j<l2;j++){row=token.rows[j];cell="";l3=row.length;for(k=0;k<l3;k++){cell+=this.renderer.tablecell(this.parseInline(row[k].tokens),{header:false,align:token.align[k]});}body+=this.renderer.tablerow(cell);}out+=this.renderer.table(header,body);continue;}case"blockquote":{body=this.parse(token.tokens);out+=this.renderer.blockquote(body);continue;}case"list":{ordered=token.ordered;start=token.start;loose=token.loose;l2=token.items.length;body="";for(j=0;j<l2;j++){item2=token.items[j];checked=item2.checked;task=item2.task;itemBody="";if(item2.task){checkbox=this.renderer.checkbox(checked);if(loose){if(item2.tokens.length>0&&item2.tokens[0].type==="paragraph"){item2.tokens[0].text=checkbox+" "+item2.tokens[0].text;if(item2.tokens[0].tokens&&item2.tokens[0].tokens.length>0&&item2.tokens[0].tokens[0].type==="text"){item2.tokens[0].tokens[0].text=checkbox+" "+item2.tokens[0].tokens[0].text;}}else{item2.tokens.unshift({type:"text",text:checkbox});}}else{itemBody+=checkbox;}}itemBody+=this.parse(item2.tokens,loose);body+=this.renderer.listitem(itemBody,task,checked);}out+=this.renderer.list(body,ordered,start);continue;}case"html":{out+=this.renderer.html(token.text);continue;}case"paragraph":{out+=this.renderer.paragraph(this.parseInline(token.tokens));continue;}case"text":{body=token.tokens?this.parseInline(token.tokens):token.text;while(i+1<l&&tokens[i+1].type==="text"){token=tokens[++i];body+="\n"+(token.tokens?this.parseInline(token.tokens):token.text);}out+=top?this.renderer.paragraph(body):body;continue;}default:{var errMsg='Token with "'+token.type+'" type was not found.';if(this.options.silent){console.error(errMsg);return;}else{throw new Error(errMsg);}}}}return out;}},{key:"parseInline",value:function parseInline(tokens,renderer){renderer=renderer||this.renderer;var out="",i,token,ret;var l=tokens.length;for(i=0;i<l;i++){token=tokens[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[token.type]){ret=this.options.extensions.renderers[token.type].call({parser:this},token);if(ret!==false||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(token.type)){out+=ret||"";continue;}}switch(token.type){case"escape":{out+=renderer.text(token.text);break;}case"html":{out+=renderer.html(token.text);break;}case"link":{out+=renderer.link(token.href,token.title,this.parseInline(token.tokens,renderer));break;}case"image":{out+=renderer.image(token.href,token.title,token.text);break;}case"strong":{out+=renderer.strong(this.parseInline(token.tokens,renderer));break;}case"em":{out+=renderer.em(this.parseInline(token.tokens,renderer));break;}case"codespan":{out+=renderer.codespan(token.text);break;}case"br":{out+=renderer.br();break;}case"del":{out+=renderer.del(this.parseInline(token.tokens,renderer));break;}case"text":{out+=renderer.text(token.text);break;}default:{var errMsg='Token with "'+token.type+'" type was not found.';if(this.options.silent){console.error(errMsg);return;}else{throw new Error(errMsg);}}}}return out;}}],[{key:"parse",value:function parse(tokens,options2){var parser2=new Parser(options2);return parser2.parse(tokens);}},{key:"parseInline",value:function parseInline(tokens,options2){var parser2=new Parser(options2);return parser2.parseInline(tokens);}}]);return Parser;}();var Hooks=(_temp2=_class=/*#__PURE__*/function(){function Hooks(options2){_classCallCheck(this,Hooks);this.options=options2||defaults2;}_createClass(Hooks,[{key:"preprocess",value:function preprocess(markdown){return markdown;}},{key:"postprocess",value:function postprocess(html2){return html2;}}]);return Hooks;}(),_defineProperty3(_class,"passThroughHooks",new Set(["preprocess","postprocess"])),_temp2);function onError(silent,async,callback){return function(e2){e2.message+="\nPlease report this to https://github.com/markedjs/marked.";if(silent){var msg="<p>An error occurred:</p><pre>"+_escape(e2.message+"",true)+"</pre>";if(async){return Promise.resolve(msg);}if(callback){callback(null,msg);return;}return msg;}if(async){return Promise.reject(e2);}if(callback){callback(e2);return;}throw e2;};}function parseMarkdown(lexer2,parser2){return function(src,opt,callback){if(typeof opt==="function"){callback=opt;opt=null;}var origOpt=_objectSpread({},opt);opt=_objectSpread(_objectSpread({},marked.defaults),origOpt);var throwError=onError(opt.silent,opt.async,callback);if(typeof src==="undefined"||src===null){return throwError(new Error("marked(): input parameter is undefined or null"));}if(typeof src!=="string"){return throwError(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(src)+", string expected"));}checkSanitizeDeprecation(opt);if(opt.hooks){opt.hooks.options=opt;}if(callback){var highlight=opt.highlight;var tokens;try{if(opt.hooks){src=opt.hooks.preprocess(src);}tokens=lexer2(src,opt);}catch(e2){return throwError(e2);}var done=function done(err){var out;if(!err){try{if(opt.walkTokens){marked.walkTokens(tokens,opt.walkTokens);}out=parser2(tokens,opt);if(opt.hooks){out=opt.hooks.postprocess(out);}}catch(e2){err=e2;}}opt.highlight=highlight;return err?throwError(err):callback(null,out);};if(!highlight||highlight.length<3){return done();}delete opt.highlight;if(!tokens.length)return done();var pending=0;marked.walkTokens(tokens,function(token){if(token.type==="code"){pending++;setTimeout(function(){highlight(token.text,token.lang,function(err,code){if(err){return done(err);}if(code!=null&&code!==token.text){token.text=code;token.escaped=true;}pending--;if(pending===0){done();}});},0);}});if(pending===0){done();}return;}if(opt.async){return Promise.resolve(opt.hooks?opt.hooks.preprocess(src):src).then(function(src2){return lexer2(src2,opt);}).then(function(tokens){return opt.walkTokens?Promise.all(marked.walkTokens(tokens,opt.walkTokens)).then(function(){return tokens;}):tokens;}).then(function(tokens){return parser2(tokens,opt);}).then(function(html2){return opt.hooks?opt.hooks.postprocess(html2):html2;})["catch"](throwError);}try{if(opt.hooks){src=opt.hooks.preprocess(src);}var _tokens=lexer2(src,opt);if(opt.walkTokens){marked.walkTokens(_tokens,opt.walkTokens);}var html2=parser2(_tokens,opt);if(opt.hooks){html2=opt.hooks.postprocess(html2);}return html2;}catch(e2){return throwError(e2);}};}function marked(src,opt,callback){return parseMarkdown(Lexer.lex,Parser.parse)(src,opt,callback);}marked.options=marked.setOptions=function(opt){marked.defaults=_objectSpread(_objectSpread({},marked.defaults),opt);changeDefaults(marked.defaults);return marked;};marked.getDefaults=getDefaults;marked.defaults=defaults2;marked.use=function(){var extensions=marked.defaults.extensions||{renderers:{},childTokens:{}};for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++){args[_key16]=arguments[_key16];}args.forEach(function(pack){var opts=_objectSpread({},pack);opts.async=marked.defaults.async||opts.async||false;if(pack.extensions){pack.extensions.forEach(function(ext){if(!ext.name){throw new Error("extension name required");}if(ext.renderer){var prevRenderer=extensions.renderers[ext.name];if(prevRenderer){extensions.renderers[ext.name]=function(){for(var _len17=arguments.length,args2=new Array(_len17),_key17=0;_key17<_len17;_key17++){args2[_key17]=arguments[_key17];}var ret=ext.renderer.apply(this,args2);if(ret===false){ret=prevRenderer.apply(this,args2);}return ret;};}else{extensions.renderers[ext.name]=ext.renderer;}}if(ext.tokenizer){if(!ext.level||ext.level!=="block"&&ext.level!=="inline"){throw new Error("extension level must be 'block' or 'inline'");}if(extensions[ext.level]){extensions[ext.level].unshift(ext.tokenizer);}else{extensions[ext.level]=[ext.tokenizer];}if(ext.start){if(ext.level==="block"){if(extensions.startBlock){extensions.startBlock.push(ext.start);}else{extensions.startBlock=[ext.start];}}else if(ext.level==="inline"){if(extensions.startInline){extensions.startInline.push(ext.start);}else{extensions.startInline=[ext.start];}}}}if(ext.childTokens){extensions.childTokens[ext.name]=ext.childTokens;}});opts.extensions=extensions;}if(pack.renderer){(function(){var renderer=marked.defaults.renderer||new Renderer();var _loop2=function _loop2(prop){var prevRenderer=renderer[prop];renderer[prop]=function(){for(var _len18=arguments.length,args2=new Array(_len18),_key18=0;_key18<_len18;_key18++){args2[_key18]=arguments[_key18];}var ret=pack.renderer[prop].apply(renderer,args2);if(ret===false){ret=prevRenderer.apply(renderer,args2);}return ret;};};for(var prop in pack.renderer){_loop2(prop);}opts.renderer=renderer;})();}if(pack.tokenizer){(function(){var tokenizer=marked.defaults.tokenizer||new Tokenizer();var _loop3=function _loop3(prop){var prevTokenizer=tokenizer[prop];tokenizer[prop]=function(){for(var _len19=arguments.length,args2=new Array(_len19),_key19=0;_key19<_len19;_key19++){args2[_key19]=arguments[_key19];}var ret=pack.tokenizer[prop].apply(tokenizer,args2);if(ret===false){ret=prevTokenizer.apply(tokenizer,args2);}return ret;};};for(var prop in pack.tokenizer){_loop3(prop);}opts.tokenizer=tokenizer;})();}if(pack.hooks){(function(){var hooks=marked.defaults.hooks||new Hooks();var _loop4=function _loop4(prop){var prevHook=hooks[prop];if(Hooks.passThroughHooks.has(prop)){hooks[prop]=function(arg){if(marked.defaults.async){return Promise.resolve(pack.hooks[prop].call(hooks,arg)).then(function(ret2){return prevHook.call(hooks,ret2);});}var ret=pack.hooks[prop].call(hooks,arg);return prevHook.call(hooks,ret);};}else{hooks[prop]=function(){for(var _len20=arguments.length,args2=new Array(_len20),_key20=0;_key20<_len20;_key20++){args2[_key20]=arguments[_key20];}var ret=pack.hooks[prop].apply(hooks,args2);if(ret===false){ret=prevHook.apply(hooks,args2);}return ret;};}};for(var prop in pack.hooks){_loop4(prop);}opts.hooks=hooks;})();}if(pack.walkTokens){var walkTokens2=marked.defaults.walkTokens;opts.walkTokens=function(token){var values=[];values.push(pack.walkTokens.call(this,token));if(walkTokens2){values=values.concat(walkTokens2.call(this,token));}return values;};}marked.setOptions(opts);});};marked.walkTokens=function(tokens,callback){var values=[];var _iterator8=_createForOfIteratorHelper(tokens),_step8;try{var _loop5=function _loop5(){var token=_step8.value;values=values.concat(callback.call(marked,token));switch(token.type){case"table":{var _iterator9=_createForOfIteratorHelper(token.header),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var cell=_step9.value;values=values.concat(marked.walkTokens(cell.tokens,callback));}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}var _iterator10=_createForOfIteratorHelper(token.rows),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var row=_step10.value;var _iterator11=_createForOfIteratorHelper(row),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _cell=_step11.value;values=values.concat(marked.walkTokens(_cell.tokens,callback));}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}break;}case"list":{values=values.concat(marked.walkTokens(token.items,callback));break;}default:{if(marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[token.type]){marked.defaults.extensions.childTokens[token.type].forEach(function(childTokens){values=values.concat(marked.walkTokens(token[childTokens],callback));});}else if(token.tokens){values=values.concat(marked.walkTokens(token.tokens,callback));}}}};for(_iterator8.s();!(_step8=_iterator8.n()).done;){_loop5();}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}return values;};marked.parseInline=parseMarkdown(Lexer.lexInline,Parser.parseInline);marked.Parser=Parser;marked.parser=Parser.parse;marked.Renderer=Renderer;marked.TextRenderer=TextRenderer;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.Tokenizer=Tokenizer;marked.Slugger=Slugger;marked.Hooks=Hooks;marked.parse=marked;var options=marked.options;var setOptions2=marked.setOptions;var use=marked.use;var walkTokens=marked.walkTokens;var parseInline=marked.parseInline;var parser=Parser.parse;var lexer=Lexer.lex;// node_modules/mdhl/dist/mdhl.esm.js
function e(e2){return e2.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");}var n={space:/^\n+/,blockCode:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)(\n)(|[\s\S]*?\n)( {0,3}\1[~`]* *(?:\n+|$)|$)/,heading:/^#{1,6} [^\n]+(\n|$)/,lheading:/^[^\n]+\n {0,3}(=+|-+) *(\n+|$)/,hr:/^(([-_*]) *){3,}(\n+|$)/,list:/^( {0})((?:[*+-]|\d{1,9}\.)) [\s\S]+?(?:\n+(?! )(?!\1(?:[*+-]|\d{1,9}\.) )\n*|\s*$)/,blockquote:/^( {0,3}> ?([^\n]*)(?:\n|$))+/,html:/^ {0,3}(?:<(script|pre|style)[\s>][\s\S]*?(?:<\/\1>[^\n]*\n+|$)|<!--(?!-?>)[\s\S]*?-->[^\n]*(\n+|$)|<\/?(\w+)(?: +|\n|\/?>)[\s\S]*?(?:\n{2,}|$))/,paragraph:/^[^\n]+/};var t={strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,inlineCode:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,link:/^!?\[([\s\S]+)\]\(\s*([\s\S]+)(?:\s+([\s\S]+))?\s*\)/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};var r=function r(e2,n2,t2){return"<".concat(e2," class=\"mdhl-").concat(t2,"\">").concat(n2,"</").concat(e2,">");};var s={codeInFences:function codeInFences(n2,t2){return r("span",e(n2),"codeInFences");},heading:function heading(e2,n2,t2){return r("b",t2(e2.text,n2),e2.type);},lheading:function lheading(e2,n2,t2){return r("b",t2(e2.text,n2),"heading");},paragraph:function paragraph(e2,n2,t2){return r("span",t2(e2.text,n2),e2.type);},list:function list(e2,n2,t2){var s2=e2.text.split("\n").map(function(e3){var s3=e3.substr(0,1),c2=e3.substr(1),o2=t2(c2,n2);return"".concat(r("span",s3,"bullet")).concat(o2);}).join("\n");return r("span",s2,"list");},fences:function fences(n2,t2){var _n2$cap=_slicedToArray(n2.cap,6),r2=_n2$cap[1],s2=_n2$cap[2],c2=_n2$cap[3],o2=_n2$cap[4],p2=_n2$cap[5],a2=t2.codeInFences(o2,s2);return"".concat(r2).concat(e(s2)).concat(c2).concat(a2).concat(p2);},space:function space(e2){return e2.text;},text:function text(e2){return e2.text;},em:function em(e2){return r("i",e2.text,e2.type);},strong:function strong(e2){return r("b",e2.text,e2.type);},defaultInlineRenderer:function defaultInlineRenderer(e2){return r("span",e2.text,e2.type);},defaultBlockRenderer:function defaultBlockRenderer(n2){return r("span",e(n2.text),n2.type);}};function c(n2,r2){var s2="";for(;n2;){if(!Object.keys(t).some(function(o2){var p2=t[o2].exec(n2);if(p2){var t2=p2[0];n2=n2.substring(t2.length);var a2=e(t2);return s2+=(r2[o2]||r2.defaultInlineRenderer)({type:o2,text:a2,cap:p2},r2,c),true;}return false;}))throw new Error("Infinite loop on byte: "+n2.charCodeAt(0));}return s2;}function o(e2){var t2=[];for(e2=e2.replace(/^ +$/gm,"");e2;){if(!Object.keys(n).some(function(r2){var s2=n[r2].exec(e2);if(s2){var n2=s2[0];return e2=e2.substring(n2.length),t2.push({text:n2,type:r2,cap:s2}),true;}return false;}))throw new Error("Infinite loop on byte: "+e2.charCodeAt(0));}return t2;}function p(e2,n2){return e2.map(function(e3){return(n2[e3.type]||n2.defaultBlockRenderer)(e3,n2,c);}).join("").replace(/\n/g,"<br/>");}function a(e2){var n2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:s;return p(o(e2),n2);}// packages/forms/resources/js/components/markdown-editor.js
var markdown_editor_default=function markdown_editor_default(Alpine){Alpine.data("markdownEditorFormComponent",function(_ref216){var state2=_ref216.state,tab=_ref216.tab;return{attachment:null,overlay:null,preview:"",state:state2,tab:tab,init:function init(){var _this36=this;if(this.state!==null){this.$nextTick(function(){_this36.render();});}this.$watch("state",function(value){if(value===null){_this36.state="";}_this36.render();});},render:function render(){var _this$$refs$textarea$,_this$$refs$textarea;if(((_this$$refs$textarea$=(_this$$refs$textarea=this.$refs.textarea)===null||_this$$refs$textarea===void 0?void 0:_this$$refs$textarea.scrollHeight)!==null&&_this$$refs$textarea$!==void 0?_this$$refs$textarea$:0)>0){this.$refs.overlay.style.height="150px";this.$refs.overlay.style.height=this.$refs.textarea.scrollHeight+"px";}this.state=this.state.replace("\r\n","\n");this.overlay=null;this.overlay=a(this.state);this.preview=null;this.preview=purify.sanitize(marked(this.state));},checkForAutoInsertion:function checkForAutoInsertion(){var _this37=this;var lines=this.$refs.textarea.value.split("\n");var linesBeforeSelection=this.$refs.textarea.value.substring(0,this.$refs.textarea.selectionStart);var currentLine=linesBeforeSelection.split("\n").length;var previousLine=lines[currentLine-2];if(!previousLine.match(/^(\*\s|-\s)|^(\d)+\./)){return;}if(previousLine.match(/^(\*\s)/)){if(previousLine.trim().length>1){lines[currentLine-1]="* ";this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length+2;});}else{delete lines[currentLine-2];this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length-2;});}}else if(previousLine.match(/^(-\s)/)){if(previousLine.trim().length>1){lines[currentLine-1]="- ";this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length+2;});}else{delete lines[currentLine-2];this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length-2;});}}else{var matches2=previousLine.match(/^(\d)+/);var number=matches2[0];if(previousLine.trim().length>number.length+2){lines[currentLine-1]="".concat(parseInt(number)+1,". ");this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length+number.length+2;});}else{delete lines[currentLine-2];this.$nextTick(function(){_this37.$refs.textarea.selectionStart=_this37.$refs.textarea.selectionEnd=linesBeforeSelection.length-number.length-2;});}}this.state=lines.join("\n");this.render();}};});};// packages/forms/resources/js/components/rich-editor.js
var import_trix=__toModule(require_trix());import_trix["default"].config.blockAttributes["default"].tagName="p";import_trix["default"].config.blockAttributes["default"].breakOnReturn=true;import_trix["default"].config.blockAttributes.heading={tagName:"h2",terminal:true,breakOnReturn:true,group:false};import_trix["default"].config.blockAttributes.subHeading={tagName:"h3",terminal:true,breakOnReturn:true,group:false};import_trix["default"].Block.prototype.breaksOnReturn=function(){var _blockConfig$breakOnR;var lastAttribute=this.getLastAttribute();var blockConfig=import_trix["default"].getBlockConfig(lastAttribute?lastAttribute:"default");return(_blockConfig$breakOnR=blockConfig===null||blockConfig===void 0?void 0:blockConfig.breakOnReturn)!==null&&_blockConfig$breakOnR!==void 0?_blockConfig$breakOnR:false;};import_trix["default"].LineBreakInsertion.prototype.shouldInsertBlockBreak=function(){if(this.block.hasAttributes()&&this.block.isListItem()&&!this.block.isEmpty()){return this.startLocation.offset>0;}else{return!this.shouldBreakFormattedBlock()?this.breaksOnReturn:false;}};var rich_editor_default=function rich_editor_default(Alpine){Alpine.data("richEditorFormComponent",function(_ref217){var state2=_ref217.state;return{state:state2,init:function init(){var _this$$refs$trix,_this$$refs$trix$edit,_this38=this;(_this$$refs$trix=this.$refs.trix)===null||_this$$refs$trix===void 0?void 0:(_this$$refs$trix$edit=_this$$refs$trix.editor)===null||_this$$refs$trix$edit===void 0?void 0:_this$$refs$trix$edit.loadHTML(this.state);this.$watch("state",function(){var _this38$$refs$trix,_this38$$refs$trix$ed;if(document.activeElement===_this38.$refs.trix){return;}(_this38$$refs$trix=_this38.$refs.trix)===null||_this38$$refs$trix===void 0?void 0:(_this38$$refs$trix$ed=_this38$$refs$trix.editor)===null||_this38$$refs$trix$ed===void 0?void 0:_this38$$refs$trix$ed.loadHTML(_this38.state);});}};});};// packages/forms/resources/js/components/select.js
var import_choices=__toModule(require_choices());var select_default=function select_default(Alpine){Alpine.data("selectFormComponent",function(_ref218){var isHtmlAllowed=_ref218.isHtmlAllowed,getOptionLabelUsing=_ref218.getOptionLabelUsing,getOptionLabelsUsing=_ref218.getOptionLabelsUsing,getOptionsUsing=_ref218.getOptionsUsing,getSearchResultsUsing=_ref218.getSearchResultsUsing,isAutofocused=_ref218.isAutofocused,isMultiple=_ref218.isMultiple,hasDynamicOptions=_ref218.hasDynamicOptions,hasDynamicSearchResults=_ref218.hasDynamicSearchResults,loadingMessage=_ref218.loadingMessage,maxItems=_ref218.maxItems,maxItemsMessage=_ref218.maxItemsMessage,noSearchResultsMessage=_ref218.noSearchResultsMessage,options2=_ref218.options,optionsLimit=_ref218.optionsLimit,placeholder=_ref218.placeholder,position=_ref218.position,searchDebounce=_ref218.searchDebounce,searchingMessage=_ref218.searchingMessage,searchPrompt=_ref218.searchPrompt,state2=_ref218.state;return{isSearching:false,select:null,selectedOptions:[],isStateBeingUpdated:false,state:state2,init:function(){var _init2=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee18(){var _this39=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:this.select=new import_choices["default"](this.$refs.input,{allowHTML:isHtmlAllowed,duplicateItemsAllowed:false,itemSelectText:"",loadingText:loadingMessage,maxItemCount:maxItems!==null&&maxItems!==void 0?maxItems:-1,maxItemText:function maxItemText(maxItemCount){return window.pluralize(maxItemsMessage,maxItemCount,{count:maxItemCount});},noChoicesText:searchPrompt,noResultsText:noSearchResultsMessage,placeholderValue:placeholder,position:position!==null&&position!==void 0?position:"auto",removeItemButton:true,renderChoiceLimit:optionsLimit,searchFields:["label"],searchPlaceholderValue:searchPrompt,searchResultLimit:optionsLimit,shouldSort:false});_context18.next=3;return this.refreshChoices({withInitialOptions:true});case 3:if(![null,void 0,""].includes(this.state)){this.select.setChoiceByValue(this.formatState(this.state));}this.refreshPlaceholder();if(isAutofocused){this.select.showDropdown();}this.$refs.input.addEventListener("change",function(){var _this39$select$getVal;_this39.refreshPlaceholder();if(_this39.isStateBeingUpdated){return;}_this39.isStateBeingUpdated=true;_this39.state=(_this39$select$getVal=_this39.select.getValue(true))!==null&&_this39$select$getVal!==void 0?_this39$select$getVal:null;_this39.$nextTick(function(){return _this39.isStateBeingUpdated=false;});});if(hasDynamicOptions){this.$refs.input.addEventListener("showDropdown",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee14(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_this39.select.clearChoices();_context14.next=3;return _this39.select.setChoices([{label:loadingMessage,value:"",disabled:true}]);case 3:_context14.next=5;return _this39.refreshChoices();case 5:case"end":return _context14.stop();}}},_callee14);})));}if(hasDynamicSearchResults){this.$refs.input.addEventListener("search",/*#__PURE__*/function(){var _ref220=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee15(event){var _event$detail$value;var search;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:search=(_event$detail$value=event.detail.value)===null||_event$detail$value===void 0?void 0:_event$detail$value.trim();if(![null,void 0,""].includes(search)){_context15.next=3;break;}return _context15.abrupt("return");case 3:_this39.isSearching=true;_this39.select.clearChoices();_context15.next=7;return _this39.select.setChoices([{label:searchingMessage,value:"",disabled:true}]);case 7:case"end":return _context15.stop();}}},_callee15);}));return function(_x15){return _ref220.apply(this,arguments);};}());this.$refs.input.addEventListener("search",Alpine.debounce(/*#__PURE__*/function(){var _ref221=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee16(event){var _event$detail$value2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:_context16.next=2;return _this39.refreshChoices({search:(_event$detail$value2=event.detail.value)===null||_event$detail$value2===void 0?void 0:_event$detail$value2.trim()});case 2:_this39.isSearching=false;case 3:case"end":return _context16.stop();}}},_callee16);}));return function(_x16){return _ref221.apply(this,arguments);};}(),searchDebounce));}this.$watch("state",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee17(){var choices;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:_this39.refreshPlaceholder();if(!_this39.isStateBeingUpdated){_context17.next=3;break;}return _context17.abrupt("return");case 3:_context17.next=5;return _this39.getChoices({withInitialOptions:!hasDynamicOptions});case 5:choices=_context17.sent;_this39.select.clearStore();_this39.setChoices(choices);if(![null,void 0,""].includes(_this39.state)){_this39.select.setChoiceByValue(_this39.formatState(_this39.state));}case 9:case"end":return _context17.stop();}}},_callee17);})));case 10:case"end":return _context18.stop();}}},_callee18,this);}));function init(){return _init2.apply(this,arguments);}return init;}(),refreshChoices:function(){var _refreshChoices=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee19(){var config,_args19=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:config=_args19.length>0&&_args19[0]!==undefined?_args19[0]:{};_context19.t0=this;_context19.next=4;return this.getChoices(config);case 4:_context19.t1=_context19.sent;_context19.t0.setChoices.call(_context19.t0,_context19.t1);case 6:case"end":return _context19.stop();}}},_callee19,this);}));function refreshChoices(){return _refreshChoices.apply(this,arguments);}return refreshChoices;}(),setChoices:function setChoices(choices){this.select.setChoices(choices,"value","label",true);},getChoices:function(){var _getChoices=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee20(){var config,existingOptions,_args20=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:config=_args20.length>0&&_args20[0]!==undefined?_args20[0]:{};_context20.next=3;return this.getOptions(config);case 3:existingOptions=_context20.sent;_context20.t0=existingOptions;_context20.next=7;return this.getMissingOptions(existingOptions);case 7:_context20.t1=_context20.sent;return _context20.abrupt("return",_context20.t0.concat.call(_context20.t0,_context20.t1));case 9:case"end":return _context20.stop();}}},_callee20,this);}));function getChoices(){return _getChoices.apply(this,arguments);}return getChoices;}(),getOptions:function(){var _getOptions=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee21(_ref223){var search,withInitialOptions;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:search=_ref223.search,withInitialOptions=_ref223.withInitialOptions;if(!withInitialOptions){_context21.next=3;break;}return _context21.abrupt("return",options2);case 3:if(!(search!==""&&search!==null&&search!==void 0)){_context21.next=7;break;}_context21.next=6;return getSearchResultsUsing(search);case 6:return _context21.abrupt("return",_context21.sent);case 7:_context21.next=9;return getOptionsUsing();case 9:return _context21.abrupt("return",_context21.sent);case 10:case"end":return _context21.stop();}}},_callee21);}));function getOptions(_x17){return _getOptions.apply(this,arguments);}return getOptions;}(),refreshPlaceholder:function refreshPlaceholder(){if(isMultiple){return;}this.select._renderItems();if(![null,void 0,""].includes(this.state)){return;}this.$el.querySelector(".choices__list--single").innerHTML="<div class=\"choices__placeholder choices__item\">".concat(placeholder,"</div>");},formatState:function formatState(state3){if(isMultiple){return(state3!==null&&state3!==void 0?state3:[]).map(function(item2){return item2===null||item2===void 0?void 0:item2.toString();});}return state3===null||state3===void 0?void 0:state3.toString();},getMissingOptions:function(){var _getMissingOptions=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee22(existingOptions){var state3,existingOptionValues;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:state3=this.formatState(this.state);if(![null,void 0,"",[],{}].includes(state3)){_context22.next=3;break;}return _context22.abrupt("return",{});case 3:existingOptionValues=new Set(existingOptions.length?existingOptions.map(function(option3){return option3.value;}):[]);if(!isMultiple){_context22.next=10;break;}if(!state3.every(function(value){return existingOptionValues.has(value);})){_context22.next=7;break;}return _context22.abrupt("return",{});case 7:_context22.next=9;return getOptionLabelsUsing();case 9:return _context22.abrupt("return",_context22.sent);case 10:if(!existingOptionValues.has(state3)){_context22.next=12;break;}return _context22.abrupt("return",existingOptionValues);case 12:_context22.next=14;return getOptionLabelUsing();case 14:_context22.t0=_context22.sent;_context22.t1=state3;_context22.t2={label:_context22.t0,value:_context22.t1};return _context22.abrupt("return",[_context22.t2]);case 18:case"end":return _context22.stop();}}},_callee22,this);}));function getMissingOptions(_x18){return _getMissingOptions.apply(this,arguments);}return getMissingOptions;}()};});};// packages/forms/resources/js/components/tags-input.js
var tags_input_default=function tags_input_default(Alpine){Alpine.data("tagsInputFormComponent",function(_ref224){var state2=_ref224.state;return{newTag:"",state:state2,createTag:function createTag(){this.newTag=this.newTag.trim();if(this.newTag===""){return;}if(this.state.includes(this.newTag)){this.newTag="";return;}this.state.push(this.newTag);this.newTag="";},deleteTag:function deleteTag(tagToDelete){this.state=this.state.filter(function(tag){return tag!==tagToDelete;});}};});};// node_modules/imask/esm/_rollupPluginBabelHelpers-6b3bd404.js
function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}// node_modules/imask/esm/core/change-details.js
var ChangeDetails=/*#__PURE__*/function(){function ChangeDetails(details){_classCallCheck(this,ChangeDetails);Object.assign(this,{inserted:"",rawInserted:"",skip:false,tailShift:0},details);}_createClass(ChangeDetails,[{key:"aggregate",value:function aggregate(details){this.rawInserted+=details.rawInserted;this.skip=this.skip||details.skip;this.inserted+=details.inserted;this.tailShift+=details.tailShift;return this;}},{key:"offset",get:function get(){return this.tailShift+this.inserted.length;}}]);return ChangeDetails;}();// node_modules/imask/esm/core/utils.js
function isString2(str){return typeof str==="string"||str instanceof String;}var DIRECTION={NONE:"NONE",LEFT:"LEFT",FORCE_LEFT:"FORCE_LEFT",RIGHT:"RIGHT",FORCE_RIGHT:"FORCE_RIGHT"};function forceDirection(direction){switch(direction){case DIRECTION.LEFT:return DIRECTION.FORCE_LEFT;case DIRECTION.RIGHT:return DIRECTION.FORCE_RIGHT;default:return direction;}}function escapeRegExp(str){return str.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1");}function normalizePrepare(prep){return Array.isArray(prep)?prep:[prep,new ChangeDetails()];}function objectIncludes(b,a2){if(a2===b)return true;var arrA=Array.isArray(a2),arrB=Array.isArray(b),i;if(arrA&&arrB){if(a2.length!=b.length)return false;for(i=0;i<a2.length;i++){if(!objectIncludes(a2[i],b[i]))return false;}return true;}if(arrA!=arrB)return false;if(a2&&b&&_typeof4(a2)==="object"&&_typeof4(b)==="object"){var dateA=a2 instanceof Date,dateB=b instanceof Date;if(dateA&&dateB)return a2.getTime()==b.getTime();if(dateA!=dateB)return false;var regexpA=a2 instanceof RegExp,regexpB=b instanceof RegExp;if(regexpA&&regexpB)return a2.toString()==b.toString();if(regexpA!=regexpB)return false;var keys=Object.keys(a2);for(i=0;i<keys.length;i++){if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return false;}for(i=0;i<keys.length;i++){if(!objectIncludes(b[keys[i]],a2[keys[i]]))return false;}return true;}else if(a2&&b&&typeof a2==="function"&&typeof b==="function"){return a2.toString()===b.toString();}return false;}// node_modules/imask/esm/core/action-details.js
var ActionDetails=/*#__PURE__*/function(){function ActionDetails(value,cursorPos,oldValue,oldSelection){_classCallCheck(this,ActionDetails);this.value=value;this.cursorPos=cursorPos;this.oldValue=oldValue;this.oldSelection=oldSelection;while(this.value.slice(0,this.startChangePos)!==this.oldValue.slice(0,this.startChangePos)){--this.oldSelection.start;}}_createClass(ActionDetails,[{key:"startChangePos",get:function get(){return Math.min(this.cursorPos,this.oldSelection.start);}},{key:"insertedCount",get:function get(){return this.cursorPos-this.startChangePos;}},{key:"inserted",get:function get(){return this.value.substr(this.startChangePos,this.insertedCount);}},{key:"removedCount",get:function get(){return Math.max(this.oldSelection.end-this.startChangePos||this.oldValue.length-this.value.length,0);}},{key:"removed",get:function get(){return this.oldValue.substr(this.startChangePos,this.removedCount);}},{key:"head",get:function get(){return this.value.substring(0,this.startChangePos);}},{key:"tail",get:function get(){return this.value.substring(this.startChangePos+this.insertedCount);}},{key:"removeDirection",get:function get(){if(!this.removedCount||this.insertedCount)return DIRECTION.NONE;return(this.oldSelection.end===this.cursorPos||this.oldSelection.start===this.cursorPos)&&this.oldSelection.end===this.oldSelection.start?DIRECTION.RIGHT:DIRECTION.LEFT;}}]);return ActionDetails;}();// node_modules/imask/esm/core/continuous-tail-details.js
var ContinuousTailDetails=/*#__PURE__*/function(){function ContinuousTailDetails(){_classCallCheck(this,ContinuousTailDetails);var value=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";var from=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var stop=arguments.length>2?arguments[2]:void 0;this.value=value;this.from=from;this.stop=stop;}_createClass(ContinuousTailDetails,[{key:"toString",value:function toString(){return this.value;}},{key:"extend",value:function extend(tail){this.value+=String(tail);}},{key:"appendTo",value:function appendTo(masked){return masked.append(this.toString(),{tail:true}).aggregate(masked._appendPlaceholder());}},{key:"state",get:function get(){return{value:this.value,from:this.from,stop:this.stop};},set:function set(state2){Object.assign(this,state2);}},{key:"unshift",value:function unshift(beforePos){if(!this.value.length||beforePos!=null&&this.from>=beforePos)return"";var shiftChar=this.value[0];this.value=this.value.slice(1);return shiftChar;}},{key:"shift",value:function shift(){if(!this.value.length)return"";var shiftChar=this.value[this.value.length-1];this.value=this.value.slice(0,-1);return shiftChar;}}]);return ContinuousTailDetails;}();// node_modules/imask/esm/core/holder.js
function IMask(el){var opts=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new IMask.InputMask(el,opts);}// node_modules/imask/esm/masked/base.js
var Masked=/*#__PURE__*/function(){function Masked(opts){_classCallCheck(this,Masked);this._value="";this._update(Object.assign({},Masked.DEFAULTS,opts));this.isInitialized=true;}_createClass(Masked,[{key:"updateOptions",value:function updateOptions(opts){if(!Object.keys(opts).length)return;this.withValueRefresh(this._update.bind(this,opts));}},{key:"_update",value:function _update(opts){Object.assign(this,opts);}},{key:"state",get:function get(){return{_value:this.value};},set:function set(state2){this._value=state2._value;}},{key:"reset",value:function reset(){this._value="";}},{key:"value",get:function get(){return this._value;},set:function set(value){this.resolve(value);}},{key:"resolve",value:function resolve(value){this.reset();this.append(value,{input:true},"");this.doCommit();return this.value;}},{key:"unmaskedValue",get:function get(){return this.value;},set:function set(value){this.reset();this.append(value,{},"");this.doCommit();}},{key:"typedValue",get:function get(){return this.doParse(this.value);},set:function set(value){this.value=this.doFormat(value);}},{key:"rawInputValue",get:function get(){return this.extractInput(0,this.value.length,{raw:true});},set:function set(value){this.reset();this.append(value,{raw:true},"");this.doCommit();}},{key:"isComplete",get:function get(){return true;}},{key:"isFilled",get:function get(){return this.isComplete;}},{key:"nearestInputPos",value:function nearestInputPos(cursorPos,direction){return cursorPos;}},{key:"extractInput",value:function extractInput(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;return this.value.slice(fromPos,toPos);}},{key:"extractTail",value:function extractTail(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;return new ContinuousTailDetails(this.extractInput(fromPos,toPos),fromPos);}},{key:"appendTail",value:function appendTail(tail){if(isString2(tail))tail=new ContinuousTailDetails(String(tail));return tail.appendTo(this);}},{key:"_appendCharRaw",value:function _appendCharRaw(ch){if(!ch)return new ChangeDetails();this._value+=ch;return new ChangeDetails({inserted:ch,rawInserted:ch});}},{key:"_appendChar",value:function _appendChar(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var checkTail=arguments.length>2?arguments[2]:void 0;var consistentState=this.state;var details;var _normalizePrepare=normalizePrepare(this.doPrepare(ch,flags));var _normalizePrepare2=_slicedToArray(_normalizePrepare,2);ch=_normalizePrepare2[0];details=_normalizePrepare2[1];details=details.aggregate(this._appendCharRaw(ch,flags));if(details.inserted){var consistentTail;var appended=this.doValidate(flags)!==false;if(appended&&checkTail!=null){var beforeTailState=this.state;if(this.overwrite===true){consistentTail=checkTail.state;checkTail.unshift(this.value.length-details.tailShift);}var tailDetails=this.appendTail(checkTail);appended=tailDetails.rawInserted===checkTail.toString();if(!(appended&&tailDetails.inserted)&&this.overwrite==="shift"){this.state=beforeTailState;consistentTail=checkTail.state;checkTail.shift();tailDetails=this.appendTail(checkTail);appended=tailDetails.rawInserted===checkTail.toString();}if(appended&&tailDetails.inserted)this.state=beforeTailState;}if(!appended){details=new ChangeDetails();this.state=consistentState;if(checkTail&&consistentTail)checkTail.state=consistentTail;}}return details;}},{key:"_appendPlaceholder",value:function _appendPlaceholder(){return new ChangeDetails();}},{key:"_appendEager",value:function _appendEager(){return new ChangeDetails();}},{key:"append",value:function append(str,flags,tail){if(!isString2(str))throw new Error("value should be string");var details=new ChangeDetails();var checkTail=isString2(tail)?new ContinuousTailDetails(String(tail)):tail;if(flags!==null&&flags!==void 0&&flags.tail)flags._beforeTailState=this.state;for(var ci=0;ci<str.length;++ci){var d=this._appendChar(str[ci],flags,checkTail);if(!d.rawInserted&&!this.doSkipInvalid(str[ci],flags,checkTail))break;details.aggregate(d);}if(checkTail!=null){details.tailShift+=this.appendTail(checkTail).tailShift;}if((this.eager===true||this.eager==="append")&&flags!==null&&flags!==void 0&&flags.input&&str){details.aggregate(this._appendEager());}return details;}},{key:"remove",value:function remove(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;this._value=this.value.slice(0,fromPos)+this.value.slice(toPos);return new ChangeDetails();}},{key:"withValueRefresh",value:function withValueRefresh(fn2){if(this._refreshing||!this.isInitialized)return fn2();this._refreshing=true;var rawInput=this.rawInputValue;var value=this.value;var ret=fn2();this.rawInputValue=rawInput;if(this.value&&this.value!==value&&value.indexOf(this.value)===0){this.append(value.slice(this.value.length),{},"");}delete this._refreshing;return ret;}},{key:"runIsolated",value:function runIsolated(fn2){if(this._isolated||!this.isInitialized)return fn2(this);this._isolated=true;var state2=this.state;var ret=fn2(this);this.state=state2;delete this._isolated;return ret;}},{key:"doSkipInvalid",value:function doSkipInvalid(ch){return this.skipInvalid;}},{key:"doPrepare",value:function doPrepare(str){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.prepare?this.prepare(str,this,flags):str;}},{key:"doValidate",value:function doValidate(flags){return(!this.validate||this.validate(this.value,this,flags))&&(!this.parent||this.parent.doValidate(flags));}},{key:"doCommit",value:function doCommit(){if(this.commit)this.commit(this.value,this);}},{key:"doFormat",value:function doFormat(value){return this.format?this.format(value,this):value;}},{key:"doParse",value:function doParse(str){return this.parse?this.parse(str,this):str;}},{key:"splice",value:function splice(start,deleteCount,inserted,removeDirection){var flags=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{input:true};var tailPos=start+deleteCount;var tail=this.extractTail(tailPos);var eagerRemove=this.eager===true||this.eager==="remove";var oldRawValue;if(eagerRemove){removeDirection=forceDirection(removeDirection);oldRawValue=this.extractInput(0,tailPos,{raw:true});}var startChangePos=start;var details=new ChangeDetails();if(removeDirection!==DIRECTION.NONE){startChangePos=this.nearestInputPos(start,deleteCount>1&&start!==0&&!eagerRemove?DIRECTION.NONE:removeDirection);details.tailShift=startChangePos-start;}details.aggregate(this.remove(startChangePos));if(eagerRemove&&removeDirection!==DIRECTION.NONE&&oldRawValue===this.rawInputValue){if(removeDirection===DIRECTION.FORCE_LEFT){var valLength;while(oldRawValue===this.rawInputValue&&(valLength=this.value.length)){details.aggregate(new ChangeDetails({tailShift:-1})).aggregate(this.remove(valLength-1));}}else if(removeDirection===DIRECTION.FORCE_RIGHT){tail.unshift();}}return details.aggregate(this.append(inserted,flags,tail));}},{key:"maskEquals",value:function maskEquals(mask){return this.mask===mask;}},{key:"typedValueEquals",value:function typedValueEquals(value){var tval=this.typedValue;return value===tval||Masked.EMPTY_VALUES.includes(value)&&Masked.EMPTY_VALUES.includes(tval)||this.doFormat(value)===this.doFormat(this.typedValue);}}]);return Masked;}();Masked.DEFAULTS={format:String,parse:function parse(v){return v;},skipInvalid:true};Masked.EMPTY_VALUES=[void 0,null,""];IMask.Masked=Masked;// node_modules/imask/esm/masked/factory.js
function maskedClass(mask){if(mask==null){throw new Error("mask property should be defined");}if(mask instanceof RegExp)return IMask.MaskedRegExp;if(isString2(mask))return IMask.MaskedPattern;if(mask instanceof Date||mask===Date)return IMask.MaskedDate;if(mask instanceof Number||typeof mask==="number"||mask===Number)return IMask.MaskedNumber;if(Array.isArray(mask)||mask===Array)return IMask.MaskedDynamic;if(IMask.Masked&&mask.prototype instanceof IMask.Masked)return mask;if(mask instanceof IMask.Masked)return mask.constructor;if(mask instanceof Function)return IMask.MaskedFunction;console.warn("Mask not found for mask",mask);return IMask.Masked;}function createMask(opts){if(IMask.Masked&&opts instanceof IMask.Masked)return opts;opts=Object.assign({},opts);var mask=opts.mask;if(IMask.Masked&&mask instanceof IMask.Masked)return mask;var MaskedClass=maskedClass(mask);if(!MaskedClass)throw new Error("Masked class is not found for provided mask, appropriate module needs to be import manually before creating mask.");return new MaskedClass(opts);}IMask.createMask=createMask;// node_modules/imask/esm/masked/pattern/input-definition.js
var _excluded=["mask"];var DEFAULT_INPUT_DEFINITIONS={"0":/\d/,a:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./};var PatternInputDefinition=/*#__PURE__*/function(){function PatternInputDefinition(opts){_classCallCheck(this,PatternInputDefinition);var mask=opts.mask,blockOpts=_objectWithoutPropertiesLoose(opts,_excluded);this.masked=createMask({mask:mask});Object.assign(this,blockOpts);}_createClass(PatternInputDefinition,[{key:"reset",value:function reset(){this.isFilled=false;this.masked.reset();}},{key:"remove",value:function remove(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;if(fromPos===0&&toPos>=1){this.isFilled=false;return this.masked.remove(fromPos,toPos);}return new ChangeDetails();}},{key:"value",get:function get(){return this.masked.value||(this.isFilled&&!this.isOptional?this.placeholderChar:"");}},{key:"unmaskedValue",get:function get(){return this.masked.unmaskedValue;}},{key:"isComplete",get:function get(){return Boolean(this.masked.value)||this.isOptional;}},{key:"_appendChar",value:function _appendChar(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isFilled)return new ChangeDetails();var state2=this.masked.state;var details=this.masked._appendChar(ch,flags);if(details.inserted&&this.doValidate(flags)===false){details.inserted=details.rawInserted="";this.masked.state=state2;}if(!details.inserted&&!this.isOptional&&!this.lazy&&!flags.input){details.inserted=this.placeholderChar;}details.skip=!details.inserted&&!this.isOptional;this.isFilled=Boolean(details.inserted);return details;}},{key:"append",value:function append(){var _this$masked2;return(_this$masked2=this.masked).append.apply(_this$masked2,arguments);}},{key:"_appendPlaceholder",value:function _appendPlaceholder(){var details=new ChangeDetails();if(this.isFilled||this.isOptional)return details;this.isFilled=true;details.inserted=this.placeholderChar;return details;}},{key:"_appendEager",value:function _appendEager(){return new ChangeDetails();}},{key:"extractTail",value:function extractTail(){var _this$masked3;return(_this$masked3=this.masked).extractTail.apply(_this$masked3,arguments);}},{key:"appendTail",value:function appendTail(){var _this$masked4;return(_this$masked4=this.masked).appendTail.apply(_this$masked4,arguments);}},{key:"extractInput",value:function extractInput(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var flags=arguments.length>2?arguments[2]:void 0;return this.masked.extractInput(fromPos,toPos,flags);}},{key:"nearestInputPos",value:function nearestInputPos(cursorPos){var direction=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DIRECTION.NONE;var minPos=0;var maxPos=this.value.length;var boundPos=Math.min(Math.max(cursorPos,minPos),maxPos);switch(direction){case DIRECTION.LEFT:case DIRECTION.FORCE_LEFT:return this.isComplete?boundPos:minPos;case DIRECTION.RIGHT:case DIRECTION.FORCE_RIGHT:return this.isComplete?boundPos:maxPos;case DIRECTION.NONE:default:return boundPos;}}},{key:"doValidate",value:function doValidate(){var _this$masked5,_this$parent;return(_this$masked5=this.masked).doValidate.apply(_this$masked5,arguments)&&(!this.parent||(_this$parent=this.parent).doValidate.apply(_this$parent,arguments));}},{key:"doCommit",value:function doCommit(){this.masked.doCommit();}},{key:"state",get:function get(){return{masked:this.masked.state,isFilled:this.isFilled};},set:function set(state2){this.masked.state=state2.masked;this.isFilled=state2.isFilled;}}]);return PatternInputDefinition;}();// node_modules/imask/esm/masked/pattern/fixed-definition.js
var PatternFixedDefinition=/*#__PURE__*/function(){function PatternFixedDefinition(opts){_classCallCheck(this,PatternFixedDefinition);Object.assign(this,opts);this._value="";this.isFixed=true;}_createClass(PatternFixedDefinition,[{key:"value",get:function get(){return this._value;}},{key:"unmaskedValue",get:function get(){return this.isUnmasking?this.value:"";}},{key:"reset",value:function reset(){this._isRawInput=false;this._value="";}},{key:"remove",value:function remove(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._value.length;this._value=this._value.slice(0,fromPos)+this._value.slice(toPos);if(!this._value)this._isRawInput=false;return new ChangeDetails();}},{key:"nearestInputPos",value:function nearestInputPos(cursorPos){var direction=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DIRECTION.NONE;var minPos=0;var maxPos=this._value.length;switch(direction){case DIRECTION.LEFT:case DIRECTION.FORCE_LEFT:return minPos;case DIRECTION.NONE:case DIRECTION.RIGHT:case DIRECTION.FORCE_RIGHT:default:return maxPos;}}},{key:"extractInput",value:function extractInput(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._value.length;var flags=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return flags.raw&&this._isRawInput&&this._value.slice(fromPos,toPos)||"";}},{key:"isComplete",get:function get(){return true;}},{key:"isFilled",get:function get(){return Boolean(this._value);}},{key:"_appendChar",value:function _appendChar(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var details=new ChangeDetails();if(this._value)return details;var appendEager=this.eager===true||this.eager==="append";var appended=this["char"]===ch;var isResolved=appended&&(this.isUnmasking||flags.input||flags.raw)&&(!flags.raw||!appendEager)&&!flags.tail;if(isResolved)details.rawInserted=this["char"];this._value=details.inserted=this["char"];this._isRawInput=isResolved&&(flags.raw||flags.input);return details;}},{key:"_appendEager",value:function _appendEager(){return this._appendChar(this["char"],{tail:true});}},{key:"_appendPlaceholder",value:function _appendPlaceholder(){var details=new ChangeDetails();if(this._value)return details;this._value=details.inserted=this["char"];return details;}},{key:"extractTail",value:function extractTail(){arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;return new ContinuousTailDetails("");}},{key:"appendTail",value:function appendTail(tail){if(isString2(tail))tail=new ContinuousTailDetails(String(tail));return tail.appendTo(this);}},{key:"append",value:function append(str,flags,tail){var details=this._appendChar(str[0],flags);if(tail!=null){details.tailShift+=this.appendTail(tail).tailShift;}return details;}},{key:"doCommit",value:function doCommit(){}},{key:"state",get:function get(){return{_value:this._value,_isRawInput:this._isRawInput};},set:function set(state2){Object.assign(this,state2);}}]);return PatternFixedDefinition;}();// node_modules/imask/esm/masked/pattern/chunk-tail-details.js
var _excluded2=["chunks"];var ChunksTailDetails=/*#__PURE__*/function(){function ChunksTailDetails(){_classCallCheck(this,ChunksTailDetails);var chunks=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var from=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.chunks=chunks;this.from=from;}_createClass(ChunksTailDetails,[{key:"toString",value:function toString(){return this.chunks.map(String).join("");}},{key:"extend",value:function extend(tailChunk){if(!String(tailChunk))return;if(isString2(tailChunk))tailChunk=new ContinuousTailDetails(String(tailChunk));var lastChunk=this.chunks[this.chunks.length-1];var extendLast=lastChunk&&(lastChunk.stop===tailChunk.stop||tailChunk.stop==null)&&tailChunk.from===lastChunk.from+lastChunk.toString().length;if(tailChunk instanceof ContinuousTailDetails){if(extendLast){lastChunk.extend(tailChunk.toString());}else{this.chunks.push(tailChunk);}}else if(tailChunk instanceof ChunksTailDetails){if(tailChunk.stop==null){var firstTailChunk;while(tailChunk.chunks.length&&tailChunk.chunks[0].stop==null){firstTailChunk=tailChunk.chunks.shift();firstTailChunk.from+=tailChunk.from;this.extend(firstTailChunk);}}if(tailChunk.toString()){tailChunk.stop=tailChunk.blockIndex;this.chunks.push(tailChunk);}}}},{key:"appendTo",value:function appendTo(masked){if(!(masked instanceof IMask.MaskedPattern)){var tail=new ContinuousTailDetails(this.toString());return tail.appendTo(masked);}var details=new ChangeDetails();for(var ci=0;ci<this.chunks.length&&!details.skip;++ci){var chunk=this.chunks[ci];var lastBlockIter=masked._mapPosToBlock(masked.value.length);var stop=chunk.stop;var chunkBlock=void 0;if(stop!=null&&(!lastBlockIter||lastBlockIter.index<=stop)){if(chunk instanceof ChunksTailDetails||masked._stops.indexOf(stop)>=0){details.aggregate(masked._appendPlaceholder(stop));}chunkBlock=chunk instanceof ChunksTailDetails&&masked._blocks[stop];}if(chunkBlock){var tailDetails=chunkBlock.appendTail(chunk);tailDetails.skip=false;details.aggregate(tailDetails);masked._value+=tailDetails.inserted;var remainChars=chunk.toString().slice(tailDetails.rawInserted.length);if(remainChars)details.aggregate(masked.append(remainChars,{tail:true}));}else{details.aggregate(masked.append(chunk.toString(),{tail:true}));}}return details;}},{key:"state",get:function get(){return{chunks:this.chunks.map(function(c2){return c2.state;}),from:this.from,stop:this.stop,blockIndex:this.blockIndex};},set:function set(state2){var chunks=state2.chunks,props=_objectWithoutPropertiesLoose(state2,_excluded2);Object.assign(this,props);this.chunks=chunks.map(function(cstate){var chunk="chunks"in cstate?new ChunksTailDetails():new ContinuousTailDetails();chunk.state=cstate;return chunk;});}},{key:"unshift",value:function unshift(beforePos){if(!this.chunks.length||beforePos!=null&&this.from>=beforePos)return"";var chunkShiftPos=beforePos!=null?beforePos-this.from:beforePos;var ci=0;while(ci<this.chunks.length){var chunk=this.chunks[ci];var shiftChar=chunk.unshift(chunkShiftPos);if(chunk.toString()){if(!shiftChar)break;++ci;}else{this.chunks.splice(ci,1);}if(shiftChar)return shiftChar;}return"";}},{key:"shift",value:function shift(){if(!this.chunks.length)return"";var ci=this.chunks.length-1;while(0<=ci){var chunk=this.chunks[ci];var shiftChar=chunk.shift();if(chunk.toString()){if(!shiftChar)break;--ci;}else{this.chunks.splice(ci,1);}if(shiftChar)return shiftChar;}return"";}}]);return ChunksTailDetails;}();// node_modules/imask/esm/masked/pattern/cursor.js
var PatternCursor=/*#__PURE__*/function(){function PatternCursor(masked,pos){_classCallCheck(this,PatternCursor);this.masked=masked;this._log=[];var _ref225=masked._mapPosToBlock(pos)||(pos<0?{index:0,offset:0}:{index:this.masked._blocks.length,offset:0}),offset2=_ref225.offset,index2=_ref225.index;this.offset=offset2;this.index=index2;this.ok=false;}_createClass(PatternCursor,[{key:"block",get:function get(){return this.masked._blocks[this.index];}},{key:"pos",get:function get(){return this.masked._blockStartPos(this.index)+this.offset;}},{key:"state",get:function get(){return{index:this.index,offset:this.offset,ok:this.ok};},set:function set(s2){Object.assign(this,s2);}},{key:"pushState",value:function pushState(){this._log.push(this.state);}},{key:"popState",value:function popState(){var s2=this._log.pop();this.state=s2;return s2;}},{key:"bindBlock",value:function bindBlock(){if(this.block)return;if(this.index<0){this.index=0;this.offset=0;}if(this.index>=this.masked._blocks.length){this.index=this.masked._blocks.length-1;this.offset=this.block.value.length;}}},{key:"_pushLeft",value:function _pushLeft(fn2){this.pushState();for(this.bindBlock();0<=this.index;--this.index,this.offset=((_this$block=this.block)===null||_this$block===void 0?void 0:_this$block.value.length)||0){var _this$block;if(fn2())return this.ok=true;}return this.ok=false;}},{key:"_pushRight",value:function _pushRight(fn2){this.pushState();for(this.bindBlock();this.index<this.masked._blocks.length;++this.index,this.offset=0){if(fn2())return this.ok=true;}return this.ok=false;}},{key:"pushLeftBeforeFilled",value:function pushLeftBeforeFilled(){var _this40=this;return this._pushLeft(function(){if(_this40.block.isFixed||!_this40.block.value)return;_this40.offset=_this40.block.nearestInputPos(_this40.offset,DIRECTION.FORCE_LEFT);if(_this40.offset!==0)return true;});}},{key:"pushLeftBeforeInput",value:function pushLeftBeforeInput(){var _this41=this;return this._pushLeft(function(){if(_this41.block.isFixed)return;_this41.offset=_this41.block.nearestInputPos(_this41.offset,DIRECTION.LEFT);return true;});}},{key:"pushLeftBeforeRequired",value:function pushLeftBeforeRequired(){var _this42=this;return this._pushLeft(function(){if(_this42.block.isFixed||_this42.block.isOptional&&!_this42.block.value)return;_this42.offset=_this42.block.nearestInputPos(_this42.offset,DIRECTION.LEFT);return true;});}},{key:"pushRightBeforeFilled",value:function pushRightBeforeFilled(){var _this43=this;return this._pushRight(function(){if(_this43.block.isFixed||!_this43.block.value)return;_this43.offset=_this43.block.nearestInputPos(_this43.offset,DIRECTION.FORCE_RIGHT);if(_this43.offset!==_this43.block.value.length)return true;});}},{key:"pushRightBeforeInput",value:function pushRightBeforeInput(){var _this44=this;return this._pushRight(function(){if(_this44.block.isFixed)return;_this44.offset=_this44.block.nearestInputPos(_this44.offset,DIRECTION.NONE);return true;});}},{key:"pushRightBeforeRequired",value:function pushRightBeforeRequired(){var _this45=this;return this._pushRight(function(){if(_this45.block.isFixed||_this45.block.isOptional&&!_this45.block.value)return;_this45.offset=_this45.block.nearestInputPos(_this45.offset,DIRECTION.NONE);return true;});}}]);return PatternCursor;}();// node_modules/imask/esm/masked/regexp.js
var MaskedRegExp=/*#__PURE__*/function(_Masked){_inherits(MaskedRegExp,_Masked);var _super39=_createSuper(MaskedRegExp);function MaskedRegExp(){_classCallCheck(this,MaskedRegExp);return _super39.apply(this,arguments);}_createClass(MaskedRegExp,[{key:"_update",value:function _update(opts){if(opts.mask)opts.validate=function(value){return value.search(opts.mask)>=0;};_get(_getPrototypeOf(MaskedRegExp.prototype),"_update",this).call(this,opts);}}]);return MaskedRegExp;}(Masked);IMask.MaskedRegExp=MaskedRegExp;// node_modules/imask/esm/masked/pattern.js
var _excluded3=["_blocks"];var MaskedPattern=/*#__PURE__*/function(_Masked2){_inherits(MaskedPattern,_Masked2);var _super40=_createSuper(MaskedPattern);function MaskedPattern(){_classCallCheck(this,MaskedPattern);var opts=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};opts.definitions=Object.assign({},DEFAULT_INPUT_DEFINITIONS,opts.definitions);return _super40.call(this,Object.assign({},MaskedPattern.DEFAULTS,opts));}_createClass(MaskedPattern,[{key:"_update",value:function _update(){var opts=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};opts.definitions=Object.assign({},this.definitions,opts.definitions);_get(_getPrototypeOf(MaskedPattern.prototype),"_update",this).call(this,opts);this._rebuildMask();}},{key:"_rebuildMask",value:function _rebuildMask(){var _this46=this;var defs=this.definitions;this._blocks=[];this._stops=[];this._maskedBlocks={};var pattern=this.mask;if(!pattern||!defs)return;var unmaskingBlock=false;var optionalBlock=false;for(var i=0;i<pattern.length;++i){if(this.blocks){var _ret=function(){var p2=pattern.slice(i);var bNames=Object.keys(_this46.blocks).filter(function(bName2){return p2.indexOf(bName2)===0;});bNames.sort(function(a2,b){return b.length-a2.length;});var bName=bNames[0];if(bName){var maskedBlock=createMask(Object.assign({parent:_this46,lazy:_this46.lazy,eager:_this46.eager,placeholderChar:_this46.placeholderChar,overwrite:_this46.overwrite},_this46.blocks[bName]));if(maskedBlock){_this46._blocks.push(maskedBlock);if(!_this46._maskedBlocks[bName])_this46._maskedBlocks[bName]=[];_this46._maskedBlocks[bName].push(_this46._blocks.length-1);}i+=bName.length-1;return"continue";}}();if(_ret==="continue")continue;}var _char2=pattern[i];var isInput=(_char2 in defs);if(_char2===MaskedPattern.STOP_CHAR){this._stops.push(this._blocks.length);continue;}if(_char2==="{"||_char2==="}"){unmaskingBlock=!unmaskingBlock;continue;}if(_char2==="["||_char2==="]"){optionalBlock=!optionalBlock;continue;}if(_char2===MaskedPattern.ESCAPE_CHAR){++i;_char2=pattern[i];if(!_char2)break;isInput=false;}var def=isInput?new PatternInputDefinition({parent:this,lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,mask:defs[_char2],isOptional:optionalBlock}):new PatternFixedDefinition({"char":_char2,eager:this.eager,isUnmasking:unmaskingBlock});this._blocks.push(def);}}},{key:"state",get:function get(){return Object.assign({},_get(_getPrototypeOf(MaskedPattern.prototype),"state",this),{_blocks:this._blocks.map(function(b){return b.state;})});},set:function set(state2){var _blocks=state2._blocks,maskedState=_objectWithoutPropertiesLoose(state2,_excluded3);this._blocks.forEach(function(b,bi){return b.state=_blocks[bi];});_set(_getPrototypeOf(MaskedPattern.prototype),"state",maskedState,this,true);}},{key:"reset",value:function reset(){_get(_getPrototypeOf(MaskedPattern.prototype),"reset",this).call(this);this._blocks.forEach(function(b){return b.reset();});}},{key:"isComplete",get:function get(){return this._blocks.every(function(b){return b.isComplete;});}},{key:"isFilled",get:function get(){return this._blocks.every(function(b){return b.isFilled;});}},{key:"isFixed",get:function get(){return this._blocks.every(function(b){return b.isFixed;});}},{key:"isOptional",get:function get(){return this._blocks.every(function(b){return b.isOptional;});}},{key:"doCommit",value:function doCommit(){this._blocks.forEach(function(b){return b.doCommit();});_get(_getPrototypeOf(MaskedPattern.prototype),"doCommit",this).call(this);}},{key:"unmaskedValue",get:function get(){return this._blocks.reduce(function(str,b){return str+=b.unmaskedValue;},"");},set:function set(unmaskedValue){_set(_getPrototypeOf(MaskedPattern.prototype),"unmaskedValue",unmaskedValue,this,true);}},{key:"value",get:function get(){return this._blocks.reduce(function(str,b){return str+=b.value;},"");},set:function set(value){_set(_getPrototypeOf(MaskedPattern.prototype),"value",value,this,true);}},{key:"appendTail",value:function appendTail(tail){return _get(_getPrototypeOf(MaskedPattern.prototype),"appendTail",this).call(this,tail).aggregate(this._appendPlaceholder());}},{key:"_appendEager",value:function _appendEager(){var _this$_mapPosToBlock;var details=new ChangeDetails();var startBlockIndex=(_this$_mapPosToBlock=this._mapPosToBlock(this.value.length))===null||_this$_mapPosToBlock===void 0?void 0:_this$_mapPosToBlock.index;if(startBlockIndex==null)return details;if(this._blocks[startBlockIndex].isFilled)++startBlockIndex;for(var bi=startBlockIndex;bi<this._blocks.length;++bi){var d=this._blocks[bi]._appendEager();if(!d.inserted)break;details.aggregate(d);}return details;}},{key:"_appendCharRaw",value:function _appendCharRaw(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var blockIter=this._mapPosToBlock(this.value.length);var details=new ChangeDetails();if(!blockIter)return details;for(var bi=blockIter.index;;++bi){var _flags$_beforeTailSta,_flags$_beforeTailSta2;var block2=this._blocks[bi];if(!block2)break;var blockDetails=block2._appendChar(ch,Object.assign({},flags,{_beforeTailState:(_flags$_beforeTailSta=flags._beforeTailState)===null||_flags$_beforeTailSta===void 0?void 0:(_flags$_beforeTailSta2=_flags$_beforeTailSta._blocks)===null||_flags$_beforeTailSta2===void 0?void 0:_flags$_beforeTailSta2[bi]}));var skip=blockDetails.skip;details.aggregate(blockDetails);if(skip||blockDetails.rawInserted)break;}return details;}},{key:"extractTail",value:function extractTail(){var _this47=this;var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var chunkTail=new ChunksTailDetails();if(fromPos===toPos)return chunkTail;this._forEachBlocksInRange(fromPos,toPos,function(b,bi,bFromPos,bToPos){var blockChunk=b.extractTail(bFromPos,bToPos);blockChunk.stop=_this47._findStopBefore(bi);blockChunk.from=_this47._blockStartPos(bi);if(blockChunk instanceof ChunksTailDetails)blockChunk.blockIndex=bi;chunkTail.extend(blockChunk);});return chunkTail;}},{key:"extractInput",value:function extractInput(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var flags=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(fromPos===toPos)return"";var input="";this._forEachBlocksInRange(fromPos,toPos,function(b,_,fromPos2,toPos2){input+=b.extractInput(fromPos2,toPos2,flags);});return input;}},{key:"_findStopBefore",value:function _findStopBefore(blockIndex){var stopBefore;for(var si=0;si<this._stops.length;++si){var stop=this._stops[si];if(stop<=blockIndex)stopBefore=stop;else break;}return stopBefore;}},{key:"_appendPlaceholder",value:function _appendPlaceholder(toBlockIndex){var _this48=this;var details=new ChangeDetails();if(this.lazy&&toBlockIndex==null)return details;var startBlockIter=this._mapPosToBlock(this.value.length);if(!startBlockIter)return details;var startBlockIndex=startBlockIter.index;var endBlockIndex=toBlockIndex!=null?toBlockIndex:this._blocks.length;this._blocks.slice(startBlockIndex,endBlockIndex).forEach(function(b){if(!b.lazy||toBlockIndex!=null){var args=b._blocks!=null?[b._blocks.length]:[];var bDetails=b._appendPlaceholder.apply(b,args);_this48._value+=bDetails.inserted;details.aggregate(bDetails);}});return details;}},{key:"_mapPosToBlock",value:function _mapPosToBlock(pos){var accVal="";for(var bi=0;bi<this._blocks.length;++bi){var block2=this._blocks[bi];var blockStartPos=accVal.length;accVal+=block2.value;if(pos<=accVal.length){return{index:bi,offset:pos-blockStartPos};}}}},{key:"_blockStartPos",value:function _blockStartPos(blockIndex){return this._blocks.slice(0,blockIndex).reduce(function(pos,b){return pos+=b.value.length;},0);}},{key:"_forEachBlocksInRange",value:function _forEachBlocksInRange(fromPos){var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var fn2=arguments.length>2?arguments[2]:void 0;var fromBlockIter=this._mapPosToBlock(fromPos);if(fromBlockIter){var toBlockIter=this._mapPosToBlock(toPos);var isSameBlock=toBlockIter&&fromBlockIter.index===toBlockIter.index;var fromBlockStartPos=fromBlockIter.offset;var fromBlockEndPos=toBlockIter&&isSameBlock?toBlockIter.offset:this._blocks[fromBlockIter.index].value.length;fn2(this._blocks[fromBlockIter.index],fromBlockIter.index,fromBlockStartPos,fromBlockEndPos);if(toBlockIter&&!isSameBlock){for(var bi=fromBlockIter.index+1;bi<toBlockIter.index;++bi){fn2(this._blocks[bi],bi,0,this._blocks[bi].value.length);}fn2(this._blocks[toBlockIter.index],toBlockIter.index,0,toBlockIter.offset);}}}},{key:"remove",value:function remove(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var removeDetails=_get(_getPrototypeOf(MaskedPattern.prototype),"remove",this).call(this,fromPos,toPos);this._forEachBlocksInRange(fromPos,toPos,function(b,_,bFromPos,bToPos){removeDetails.aggregate(b.remove(bFromPos,bToPos));});return removeDetails;}},{key:"nearestInputPos",value:function nearestInputPos(cursorPos){var direction=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DIRECTION.NONE;if(!this._blocks.length)return 0;var cursor=new PatternCursor(this,cursorPos);if(direction===DIRECTION.NONE){if(cursor.pushRightBeforeInput())return cursor.pos;cursor.popState();if(cursor.pushLeftBeforeInput())return cursor.pos;return this.value.length;}if(direction===DIRECTION.LEFT||direction===DIRECTION.FORCE_LEFT){if(direction===DIRECTION.LEFT){cursor.pushRightBeforeFilled();if(cursor.ok&&cursor.pos===cursorPos)return cursorPos;cursor.popState();}cursor.pushLeftBeforeInput();cursor.pushLeftBeforeRequired();cursor.pushLeftBeforeFilled();if(direction===DIRECTION.LEFT){cursor.pushRightBeforeInput();cursor.pushRightBeforeRequired();if(cursor.ok&&cursor.pos<=cursorPos)return cursor.pos;cursor.popState();if(cursor.ok&&cursor.pos<=cursorPos)return cursor.pos;cursor.popState();}if(cursor.ok)return cursor.pos;if(direction===DIRECTION.FORCE_LEFT)return 0;cursor.popState();if(cursor.ok)return cursor.pos;cursor.popState();if(cursor.ok)return cursor.pos;return 0;}if(direction===DIRECTION.RIGHT||direction===DIRECTION.FORCE_RIGHT){cursor.pushRightBeforeInput();cursor.pushRightBeforeRequired();if(cursor.pushRightBeforeFilled())return cursor.pos;if(direction===DIRECTION.FORCE_RIGHT)return this.value.length;cursor.popState();if(cursor.ok)return cursor.pos;cursor.popState();if(cursor.ok)return cursor.pos;return this.nearestInputPos(cursorPos,DIRECTION.LEFT);}return cursorPos;}},{key:"maskedBlock",value:function maskedBlock(name2){return this.maskedBlocks(name2)[0];}},{key:"maskedBlocks",value:function maskedBlocks(name2){var _this49=this;var indices=this._maskedBlocks[name2];if(!indices)return[];return indices.map(function(gi){return _this49._blocks[gi];});}}]);return MaskedPattern;}(Masked);MaskedPattern.DEFAULTS={lazy:true,placeholderChar:"_"};MaskedPattern.STOP_CHAR="`";MaskedPattern.ESCAPE_CHAR="\\";MaskedPattern.InputDefinition=PatternInputDefinition;MaskedPattern.FixedDefinition=PatternFixedDefinition;IMask.MaskedPattern=MaskedPattern;// node_modules/imask/esm/masked/range.js
var MaskedRange=/*#__PURE__*/function(_MaskedPattern){_inherits(MaskedRange,_MaskedPattern);var _super41=_createSuper(MaskedRange);function MaskedRange(){_classCallCheck(this,MaskedRange);return _super41.apply(this,arguments);}_createClass(MaskedRange,[{key:"_matchFrom",get:function get(){return this.maxLength-String(this.from).length;}},{key:"_update",value:function _update(opts){opts=Object.assign({to:this.to||0,from:this.from||0,maxLength:this.maxLength||0},opts);var maxLength=String(opts.to).length;if(opts.maxLength!=null)maxLength=Math.max(maxLength,opts.maxLength);opts.maxLength=maxLength;var fromStr=String(opts.from).padStart(maxLength,"0");var toStr=String(opts.to).padStart(maxLength,"0");var sameCharsCount=0;while(sameCharsCount<toStr.length&&toStr[sameCharsCount]===fromStr[sameCharsCount]){++sameCharsCount;}opts.mask=toStr.slice(0,sameCharsCount).replace(/0/g,"\\0")+"0".repeat(maxLength-sameCharsCount);_get(_getPrototypeOf(MaskedRange.prototype),"_update",this).call(this,opts);}},{key:"isComplete",get:function get(){return _get(_getPrototypeOf(MaskedRange.prototype),"isComplete",this)&&Boolean(this.value);}},{key:"boundaries",value:function boundaries(str){var minstr="";var maxstr="";var _ref226=str.match(/^(\D*)(\d*)(\D*)/)||[],_ref227=_slicedToArray(_ref226,3),placeholder=_ref227[1],num=_ref227[2];if(num){minstr="0".repeat(placeholder.length)+num;maxstr="9".repeat(placeholder.length)+num;}minstr=minstr.padEnd(this.maxLength,"0");maxstr=maxstr.padEnd(this.maxLength,"9");return[minstr,maxstr];}},{key:"doPrepare",value:function doPrepare(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var details;var _normalizePrepare3=normalizePrepare(_get(_getPrototypeOf(MaskedRange.prototype),"doPrepare",this).call(this,ch.replace(/\D/g,""),flags));var _normalizePrepare4=_slicedToArray(_normalizePrepare3,2);ch=_normalizePrepare4[0];details=_normalizePrepare4[1];if(!this.autofix||!ch)return ch;var fromStr=String(this.from).padStart(this.maxLength,"0");var toStr=String(this.to).padStart(this.maxLength,"0");var nextVal=this.value+ch;if(nextVal.length>this.maxLength)return"";var _this$boundaries=this.boundaries(nextVal),_this$boundaries2=_slicedToArray(_this$boundaries,2),minstr=_this$boundaries2[0],maxstr=_this$boundaries2[1];if(Number(maxstr)<this.from)return fromStr[nextVal.length-1];if(Number(minstr)>this.to){if(this.autofix==="pad"&&nextVal.length<this.maxLength){return["",details.aggregate(this.append(fromStr[nextVal.length-1]+ch,flags))];}return toStr[nextVal.length-1];}return ch;}},{key:"doValidate",value:function doValidate(){var str=this.value;var firstNonZero=str.search(/[^0]/);if(firstNonZero===-1&&str.length<=this._matchFrom)return true;var _this$boundaries3=this.boundaries(str),_this$boundaries4=_slicedToArray(_this$boundaries3,2),minstr=_this$boundaries4[0],maxstr=_this$boundaries4[1];return this.from<=Number(maxstr)&&Number(minstr)<=this.to&&_get(_getPrototypeOf(MaskedRange.prototype),"doValidate",this).apply(this,arguments);}}]);return MaskedRange;}(MaskedPattern);IMask.MaskedRange=MaskedRange;// node_modules/imask/esm/masked/date.js
var MaskedDate=/*#__PURE__*/function(_MaskedPattern2){_inherits(MaskedDate,_MaskedPattern2);var _super42=_createSuper(MaskedDate);function MaskedDate(opts){_classCallCheck(this,MaskedDate);return _super42.call(this,Object.assign({},MaskedDate.DEFAULTS,opts));}_createClass(MaskedDate,[{key:"_update",value:function _update(opts){if(opts.mask===Date)delete opts.mask;if(opts.pattern)opts.mask=opts.pattern;var blocks=opts.blocks;opts.blocks=Object.assign({},MaskedDate.GET_DEFAULT_BLOCKS());if(opts.min)opts.blocks.Y.from=opts.min.getFullYear();if(opts.max)opts.blocks.Y.to=opts.max.getFullYear();if(opts.min&&opts.max&&opts.blocks.Y.from===opts.blocks.Y.to){opts.blocks.m.from=opts.min.getMonth()+1;opts.blocks.m.to=opts.max.getMonth()+1;if(opts.blocks.m.from===opts.blocks.m.to){opts.blocks.d.from=opts.min.getDate();opts.blocks.d.to=opts.max.getDate();}}Object.assign(opts.blocks,this.blocks,blocks);Object.keys(opts.blocks).forEach(function(bk){var b=opts.blocks[bk];if(!("autofix"in b)&&"autofix"in opts)b.autofix=opts.autofix;});_get(_getPrototypeOf(MaskedDate.prototype),"_update",this).call(this,opts);}},{key:"doValidate",value:function doValidate(){var date=this.date;return _get(_getPrototypeOf(MaskedDate.prototype),"doValidate",this).apply(this,arguments)&&(!this.isComplete||this.isDateExist(this.value)&&date!=null&&(this.min==null||this.min<=date)&&(this.max==null||date<=this.max));}},{key:"isDateExist",value:function isDateExist(str){return this.format(this.parse(str,this),this).indexOf(str)>=0;}},{key:"date",get:function get(){return this.typedValue;},set:function set(date){this.typedValue=date;}},{key:"typedValue",get:function get(){return this.isComplete?_get(_getPrototypeOf(MaskedDate.prototype),"typedValue",this):null;},set:function set(value){_set(_getPrototypeOf(MaskedDate.prototype),"typedValue",value,this,true);}},{key:"maskEquals",value:function maskEquals(mask){return mask===Date||_get(_getPrototypeOf(MaskedDate.prototype),"maskEquals",this).call(this,mask);}}]);return MaskedDate;}(MaskedPattern);MaskedDate.DEFAULTS={pattern:"d{.}`m{.}`Y",format:function format(date){if(!date)return"";var day=String(date.getDate()).padStart(2,"0");var month=String(date.getMonth()+1).padStart(2,"0");var year=date.getFullYear();return[day,month,year].join(".");},parse:function parse(str){var _str$split=str.split("."),_str$split2=_slicedToArray(_str$split,3),day=_str$split2[0],month=_str$split2[1],year=_str$split2[2];return new Date(year,month-1,day);}};MaskedDate.GET_DEFAULT_BLOCKS=function(){return{d:{mask:MaskedRange,from:1,to:31,maxLength:2},m:{mask:MaskedRange,from:1,to:12,maxLength:2},Y:{mask:MaskedRange,from:1900,to:9999}};};IMask.MaskedDate=MaskedDate;// node_modules/imask/esm/controls/mask-element.js
var MaskElement=/*#__PURE__*/function(){function MaskElement(){_classCallCheck(this,MaskElement);}_createClass(MaskElement,[{key:"selectionStart",get:function get(){var start;try{start=this._unsafeSelectionStart;}catch(e2){}return start!=null?start:this.value.length;}},{key:"selectionEnd",get:function get(){var end;try{end=this._unsafeSelectionEnd;}catch(e2){}return end!=null?end:this.value.length;}},{key:"select",value:function select(start,end){if(start==null||end==null||start===this.selectionStart&&end===this.selectionEnd)return;try{this._unsafeSelect(start,end);}catch(e2){}}},{key:"_unsafeSelect",value:function _unsafeSelect(start,end){}},{key:"isActive",get:function get(){return false;}},{key:"bindEvents",value:function bindEvents(handlers){}},{key:"unbindEvents",value:function unbindEvents(){}}]);return MaskElement;}();IMask.MaskElement=MaskElement;// node_modules/imask/esm/controls/html-mask-element.js
var HTMLMaskElement=/*#__PURE__*/function(_MaskElement){_inherits(HTMLMaskElement,_MaskElement);var _super43=_createSuper(HTMLMaskElement);function HTMLMaskElement(input){var _this50;_classCallCheck(this,HTMLMaskElement);_this50=_super43.call(this);_this50.input=input;_this50._handlers={};return _this50;}_createClass(HTMLMaskElement,[{key:"rootElement",get:function get(){var _this$input$getRootNo,_this$input$getRootNo2,_this$input;return(_this$input$getRootNo=(_this$input$getRootNo2=(_this$input=this.input).getRootNode)===null||_this$input$getRootNo2===void 0?void 0:_this$input$getRootNo2.call(_this$input))!==null&&_this$input$getRootNo!==void 0?_this$input$getRootNo:document;}},{key:"isActive",get:function get(){return this.input===this.rootElement.activeElement;}},{key:"_unsafeSelectionStart",get:function get(){return this.input.selectionStart;}},{key:"_unsafeSelectionEnd",get:function get(){return this.input.selectionEnd;}},{key:"_unsafeSelect",value:function _unsafeSelect(start,end){this.input.setSelectionRange(start,end);}},{key:"value",get:function get(){return this.input.value;},set:function set(value){this.input.value=value;}},{key:"bindEvents",value:function bindEvents(handlers){var _this51=this;Object.keys(handlers).forEach(function(event){return _this51._toggleEventHandler(HTMLMaskElement.EVENTS_MAP[event],handlers[event]);});}},{key:"unbindEvents",value:function unbindEvents(){var _this52=this;Object.keys(this._handlers).forEach(function(event){return _this52._toggleEventHandler(event);});}},{key:"_toggleEventHandler",value:function _toggleEventHandler(event,handler){if(this._handlers[event]){this.input.removeEventListener(event,this._handlers[event]);delete this._handlers[event];}if(handler){this.input.addEventListener(event,handler);this._handlers[event]=handler;}}}]);return HTMLMaskElement;}(MaskElement);HTMLMaskElement.EVENTS_MAP={selectionChange:"keydown",input:"input",drop:"drop",click:"click",focus:"focus",commit:"blur"};IMask.HTMLMaskElement=HTMLMaskElement;// node_modules/imask/esm/controls/html-contenteditable-mask-element.js
var HTMLContenteditableMaskElement=/*#__PURE__*/function(_HTMLMaskElement){_inherits(HTMLContenteditableMaskElement,_HTMLMaskElement);var _super44=_createSuper(HTMLContenteditableMaskElement);function HTMLContenteditableMaskElement(){_classCallCheck(this,HTMLContenteditableMaskElement);return _super44.apply(this,arguments);}_createClass(HTMLContenteditableMaskElement,[{key:"_unsafeSelectionStart",get:function get(){var root2=this.rootElement;var selection=root2.getSelection&&root2.getSelection();var anchorOffset=selection&&selection.anchorOffset;var focusOffset=selection&&selection.focusOffset;if(focusOffset==null||anchorOffset==null||anchorOffset<focusOffset){return anchorOffset;}return focusOffset;}},{key:"_unsafeSelectionEnd",get:function get(){var root2=this.rootElement;var selection=root2.getSelection&&root2.getSelection();var anchorOffset=selection&&selection.anchorOffset;var focusOffset=selection&&selection.focusOffset;if(focusOffset==null||anchorOffset==null||anchorOffset>focusOffset){return anchorOffset;}return focusOffset;}},{key:"_unsafeSelect",value:function _unsafeSelect(start,end){if(!this.rootElement.createRange)return;var range=this.rootElement.createRange();range.setStart(this.input.firstChild||this.input,start);range.setEnd(this.input.lastChild||this.input,end);var root2=this.rootElement;var selection=root2.getSelection&&root2.getSelection();if(selection){selection.removeAllRanges();selection.addRange(range);}}},{key:"value",get:function get(){return this.input.textContent;},set:function set(value){this.input.textContent=value;}}]);return HTMLContenteditableMaskElement;}(HTMLMaskElement);IMask.HTMLContenteditableMaskElement=HTMLContenteditableMaskElement;// node_modules/imask/esm/controls/input.js
var _excluded4=["mask"];var InputMask=/*#__PURE__*/function(){function InputMask(el,opts){_classCallCheck(this,InputMask);this.el=el instanceof MaskElement?el:el.isContentEditable&&el.tagName!=="INPUT"&&el.tagName!=="TEXTAREA"?new HTMLContenteditableMaskElement(el):new HTMLMaskElement(el);this.masked=createMask(opts);this._listeners={};this._value="";this._unmaskedValue="";this._saveSelection=this._saveSelection.bind(this);this._onInput=this._onInput.bind(this);this._onChange=this._onChange.bind(this);this._onDrop=this._onDrop.bind(this);this._onFocus=this._onFocus.bind(this);this._onClick=this._onClick.bind(this);this.alignCursor=this.alignCursor.bind(this);this.alignCursorFriendly=this.alignCursorFriendly.bind(this);this._bindEvents();this.updateValue();this._onChange();}_createClass(InputMask,[{key:"mask",get:function get(){return this.masked.mask;},set:function set(mask){if(this.maskEquals(mask))return;if(!(mask instanceof IMask.Masked)&&this.masked.constructor===maskedClass(mask)){this.masked.updateOptions({mask:mask});return;}var masked=createMask({mask:mask});masked.unmaskedValue=this.masked.unmaskedValue;this.masked=masked;}},{key:"maskEquals",value:function maskEquals(mask){var _this$masked;return mask==null||((_this$masked=this.masked)===null||_this$masked===void 0?void 0:_this$masked.maskEquals(mask));}},{key:"value",get:function get(){return this._value;},set:function set(str){if(this.value===str)return;this.masked.value=str;this.updateControl();this.alignCursor();}},{key:"unmaskedValue",get:function get(){return this._unmaskedValue;},set:function set(str){if(this.unmaskedValue===str)return;this.masked.unmaskedValue=str;this.updateControl();this.alignCursor();}},{key:"typedValue",get:function get(){return this.masked.typedValue;},set:function set(val){if(this.masked.typedValueEquals(val))return;this.masked.typedValue=val;this.updateControl();this.alignCursor();}},{key:"_bindEvents",value:function _bindEvents(){this.el.bindEvents({selectionChange:this._saveSelection,input:this._onInput,drop:this._onDrop,click:this._onClick,focus:this._onFocus,commit:this._onChange});}},{key:"_unbindEvents",value:function _unbindEvents(){if(this.el)this.el.unbindEvents();}},{key:"_fireEvent",value:function _fireEvent(ev){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}var listeners2=this._listeners[ev];if(!listeners2)return;listeners2.forEach(function(l){return l.apply(void 0,args);});}},{key:"selectionStart",get:function get(){return this._cursorChanging?this._changingCursorPos:this.el.selectionStart;}},{key:"cursorPos",get:function get(){return this._cursorChanging?this._changingCursorPos:this.el.selectionEnd;},set:function set(pos){if(!this.el||!this.el.isActive)return;this.el.select(pos,pos);this._saveSelection();}},{key:"_saveSelection",value:function _saveSelection(){if(this.value!==this.el.value){console.warn("Element value was changed outside of mask. Syncronize mask using `mask.updateValue()` to work properly.");}this._selection={start:this.selectionStart,end:this.cursorPos};}},{key:"updateValue",value:function updateValue(){this.masked.value=this.el.value;this._value=this.masked.value;}},{key:"updateControl",value:function updateControl(){var newUnmaskedValue=this.masked.unmaskedValue;var newValue=this.masked.value;var isChanged=this.unmaskedValue!==newUnmaskedValue||this.value!==newValue;this._unmaskedValue=newUnmaskedValue;this._value=newValue;if(this.el.value!==newValue)this.el.value=newValue;if(isChanged)this._fireChangeEvents();}},{key:"updateOptions",value:function updateOptions(opts){var mask=opts.mask,restOpts=_objectWithoutPropertiesLoose(opts,_excluded4);var updateMask=!this.maskEquals(mask);var updateOpts=!objectIncludes(this.masked,restOpts);if(updateMask)this.mask=mask;if(updateOpts)this.masked.updateOptions(restOpts);if(updateMask||updateOpts)this.updateControl();}},{key:"updateCursor",value:function updateCursor(cursorPos){if(cursorPos==null)return;this.cursorPos=cursorPos;this._delayUpdateCursor(cursorPos);}},{key:"_delayUpdateCursor",value:function _delayUpdateCursor(cursorPos){var _this53=this;this._abortUpdateCursor();this._changingCursorPos=cursorPos;this._cursorChanging=setTimeout(function(){if(!_this53.el)return;_this53.cursorPos=_this53._changingCursorPos;_this53._abortUpdateCursor();},10);}},{key:"_fireChangeEvents",value:function _fireChangeEvents(){this._fireEvent("accept",this._inputEvent);if(this.masked.isComplete)this._fireEvent("complete",this._inputEvent);}},{key:"_abortUpdateCursor",value:function _abortUpdateCursor(){if(this._cursorChanging){clearTimeout(this._cursorChanging);delete this._cursorChanging;}}},{key:"alignCursor",value:function alignCursor(){this.cursorPos=this.masked.nearestInputPos(this.masked.nearestInputPos(this.cursorPos,DIRECTION.LEFT));}},{key:"alignCursorFriendly",value:function alignCursorFriendly(){if(this.selectionStart!==this.cursorPos)return;this.alignCursor();}},{key:"on",value:function on(ev,handler){if(!this._listeners[ev])this._listeners[ev]=[];this._listeners[ev].push(handler);return this;}},{key:"off",value:function off(ev,handler){if(!this._listeners[ev])return this;if(!handler){delete this._listeners[ev];return this;}var hIndex=this._listeners[ev].indexOf(handler);if(hIndex>=0)this._listeners[ev].splice(hIndex,1);return this;}},{key:"_onInput",value:function _onInput(e2){this._inputEvent=e2;this._abortUpdateCursor();if(!this._selection)return this.updateValue();var details=new ActionDetails(this.el.value,this.cursorPos,this.value,this._selection);var oldRawValue=this.masked.rawInputValue;var offset2=this.masked.splice(details.startChangePos,details.removed.length,details.inserted,details.removeDirection,{input:true,raw:true}).offset;var removeDirection=oldRawValue===this.masked.rawInputValue?details.removeDirection:DIRECTION.NONE;var cursorPos=this.masked.nearestInputPos(details.startChangePos+offset2,removeDirection);if(removeDirection!==DIRECTION.NONE)cursorPos=this.masked.nearestInputPos(cursorPos,DIRECTION.NONE);this.updateControl();this.updateCursor(cursorPos);delete this._inputEvent;}},{key:"_onChange",value:function _onChange(){if(this.value!==this.el.value){this.updateValue();}this.masked.doCommit();this.updateControl();this._saveSelection();}},{key:"_onDrop",value:function _onDrop(ev){ev.preventDefault();ev.stopPropagation();}},{key:"_onFocus",value:function _onFocus(ev){this.alignCursorFriendly();}},{key:"_onClick",value:function _onClick(ev){this.alignCursorFriendly();}},{key:"destroy",value:function destroy(){this._unbindEvents();this._listeners.length=0;delete this.el;}}]);return InputMask;}();IMask.InputMask=InputMask;// node_modules/imask/esm/masked/enum.js
var MaskedEnum=/*#__PURE__*/function(_MaskedPattern3){_inherits(MaskedEnum,_MaskedPattern3);var _super45=_createSuper(MaskedEnum);function MaskedEnum(){_classCallCheck(this,MaskedEnum);return _super45.apply(this,arguments);}_createClass(MaskedEnum,[{key:"_update",value:function _update(opts){if(opts["enum"])opts.mask="*".repeat(opts["enum"][0].length);_get(_getPrototypeOf(MaskedEnum.prototype),"_update",this).call(this,opts);}},{key:"doValidate",value:function doValidate(){var _this54=this;return this["enum"].some(function(e2){return e2.indexOf(_this54.unmaskedValue)>=0;})&&_get(_getPrototypeOf(MaskedEnum.prototype),"doValidate",this).apply(this,arguments);}}]);return MaskedEnum;}(MaskedPattern);IMask.MaskedEnum=MaskedEnum;// node_modules/imask/esm/masked/number.js
var MaskedNumber=/*#__PURE__*/function(_Masked3){_inherits(MaskedNumber,_Masked3);var _super46=_createSuper(MaskedNumber);function MaskedNumber(opts){_classCallCheck(this,MaskedNumber);return _super46.call(this,Object.assign({},MaskedNumber.DEFAULTS,opts));}_createClass(MaskedNumber,[{key:"_update",value:function _update(opts){_get(_getPrototypeOf(MaskedNumber.prototype),"_update",this).call(this,opts);this._updateRegExps();}},{key:"_updateRegExps",value:function _updateRegExps(){var start="^"+(this.allowNegative?"[+|\\-]?":"");var mid="\\d*";var end=(this.scale?"(".concat(escapeRegExp(this.radix),"\\d{0,").concat(this.scale,"})?"):"")+"$";this._numberRegExp=new RegExp(start+mid+end);this._mapToRadixRegExp=new RegExp("[".concat(this.mapToRadix.map(escapeRegExp).join(""),"]"),"g");this._thousandsSeparatorRegExp=new RegExp(escapeRegExp(this.thousandsSeparator),"g");}},{key:"_removeThousandsSeparators",value:function _removeThousandsSeparators(value){return value.replace(this._thousandsSeparatorRegExp,"");}},{key:"_insertThousandsSeparators",value:function _insertThousandsSeparators(value){var parts=value.split(this.radix);parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,this.thousandsSeparator);return parts.join(this.radix);}},{key:"doPrepare",value:function doPrepare(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ch=this._removeThousandsSeparators(this.scale&&this.mapToRadix.length&&(flags.input&&flags.raw||!flags.input&&!flags.raw)?ch.replace(this._mapToRadixRegExp,this.radix):ch);var _normalizePrepare5=normalizePrepare(_get(_getPrototypeOf(MaskedNumber.prototype),"doPrepare",this).call(this,ch,flags)),_normalizePrepare6=_slicedToArray(_normalizePrepare5,2),prepCh=_normalizePrepare6[0],details=_normalizePrepare6[1];if(ch&&!prepCh)details.skip=true;return[prepCh,details];}},{key:"_separatorsCount",value:function _separatorsCount(to){var extendOnSeparators=arguments.length>1&&arguments[1]!==void 0?arguments[1]:false;var count=0;for(var pos=0;pos<to;++pos){if(this._value.indexOf(this.thousandsSeparator,pos)===pos){++count;if(extendOnSeparators)to+=this.thousandsSeparator.length;}}return count;}},{key:"_separatorsCountFromSlice",value:function _separatorsCountFromSlice(){var slice=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._value;return this._separatorsCount(this._removeThousandsSeparators(slice).length,true);}},{key:"extractInput",value:function extractInput(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var flags=arguments.length>2?arguments[2]:void 0;var _this$_adjustRangeWit=this._adjustRangeWithSeparators(fromPos,toPos);var _this$_adjustRangeWit2=_slicedToArray(_this$_adjustRangeWit,2);fromPos=_this$_adjustRangeWit2[0];toPos=_this$_adjustRangeWit2[1];return this._removeThousandsSeparators(_get(_getPrototypeOf(MaskedNumber.prototype),"extractInput",this).call(this,fromPos,toPos,flags));}},{key:"_appendCharRaw",value:function _appendCharRaw(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.thousandsSeparator)return _get(_getPrototypeOf(MaskedNumber.prototype),"_appendCharRaw",this).call(this,ch,flags);var prevBeforeTailValue=flags.tail&&flags._beforeTailState?flags._beforeTailState._value:this._value;var prevBeforeTailSeparatorsCount=this._separatorsCountFromSlice(prevBeforeTailValue);this._value=this._removeThousandsSeparators(this.value);var appendDetails=_get(_getPrototypeOf(MaskedNumber.prototype),"_appendCharRaw",this).call(this,ch,flags);this._value=this._insertThousandsSeparators(this._value);var beforeTailValue=flags.tail&&flags._beforeTailState?flags._beforeTailState._value:this._value;var beforeTailSeparatorsCount=this._separatorsCountFromSlice(beforeTailValue);appendDetails.tailShift+=(beforeTailSeparatorsCount-prevBeforeTailSeparatorsCount)*this.thousandsSeparator.length;appendDetails.skip=!appendDetails.rawInserted&&ch===this.thousandsSeparator;return appendDetails;}},{key:"_findSeparatorAround",value:function _findSeparatorAround(pos){if(this.thousandsSeparator){var searchFrom=pos-this.thousandsSeparator.length+1;var separatorPos=this.value.indexOf(this.thousandsSeparator,searchFrom);if(separatorPos<=pos)return separatorPos;}return-1;}},{key:"_adjustRangeWithSeparators",value:function _adjustRangeWithSeparators(from,to){var separatorAroundFromPos=this._findSeparatorAround(from);if(separatorAroundFromPos>=0)from=separatorAroundFromPos;var separatorAroundToPos=this._findSeparatorAround(to);if(separatorAroundToPos>=0)to=separatorAroundToPos+this.thousandsSeparator.length;return[from,to];}},{key:"remove",value:function remove(){var fromPos=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var toPos=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.value.length;var _this$_adjustRangeWit3=this._adjustRangeWithSeparators(fromPos,toPos);var _this$_adjustRangeWit4=_slicedToArray(_this$_adjustRangeWit3,2);fromPos=_this$_adjustRangeWit4[0];toPos=_this$_adjustRangeWit4[1];var valueBeforePos=this.value.slice(0,fromPos);var valueAfterPos=this.value.slice(toPos);var prevBeforeTailSeparatorsCount=this._separatorsCount(valueBeforePos.length);this._value=this._insertThousandsSeparators(this._removeThousandsSeparators(valueBeforePos+valueAfterPos));var beforeTailSeparatorsCount=this._separatorsCountFromSlice(valueBeforePos);return new ChangeDetails({tailShift:(beforeTailSeparatorsCount-prevBeforeTailSeparatorsCount)*this.thousandsSeparator.length});}},{key:"nearestInputPos",value:function nearestInputPos(cursorPos,direction){if(!this.thousandsSeparator)return cursorPos;switch(direction){case DIRECTION.NONE:case DIRECTION.LEFT:case DIRECTION.FORCE_LEFT:{var separatorAtLeftPos=this._findSeparatorAround(cursorPos-1);if(separatorAtLeftPos>=0){var separatorAtLeftEndPos=separatorAtLeftPos+this.thousandsSeparator.length;if(cursorPos<separatorAtLeftEndPos||this.value.length<=separatorAtLeftEndPos||direction===DIRECTION.FORCE_LEFT){return separatorAtLeftPos;}}break;}case DIRECTION.RIGHT:case DIRECTION.FORCE_RIGHT:{var separatorAtRightPos=this._findSeparatorAround(cursorPos);if(separatorAtRightPos>=0){return separatorAtRightPos+this.thousandsSeparator.length;}}}return cursorPos;}},{key:"doValidate",value:function doValidate(flags){var valid=Boolean(this._removeThousandsSeparators(this.value).match(this._numberRegExp));if(valid){var number=this.number;valid=valid&&!isNaN(number)&&(this.min==null||this.min>=0||this.min<=this.number)&&(this.max==null||this.max<=0||this.number<=this.max);}return valid&&_get(_getPrototypeOf(MaskedNumber.prototype),"doValidate",this).call(this,flags);}},{key:"doCommit",value:function doCommit(){if(this.value){var number=this.number;var validnum=number;if(this.min!=null)validnum=Math.max(validnum,this.min);if(this.max!=null)validnum=Math.min(validnum,this.max);if(validnum!==number)this.unmaskedValue=this.doFormat(validnum);var formatted=this.value;if(this.normalizeZeros)formatted=this._normalizeZeros(formatted);if(this.padFractionalZeros&&this.scale>0)formatted=this._padFractionalZeros(formatted);this._value=formatted;}_get(_getPrototypeOf(MaskedNumber.prototype),"doCommit",this).call(this);}},{key:"_normalizeZeros",value:function _normalizeZeros(value){var parts=this._removeThousandsSeparators(value).split(this.radix);parts[0]=parts[0].replace(/^(\D*)(0*)(\d*)/,function(match,sign,zeros,num){return sign+num;});if(value.length&&!/\d$/.test(parts[0]))parts[0]=parts[0]+"0";if(parts.length>1){parts[1]=parts[1].replace(/0*$/,"");if(!parts[1].length)parts.length=1;}return this._insertThousandsSeparators(parts.join(this.radix));}},{key:"_padFractionalZeros",value:function _padFractionalZeros(value){if(!value)return value;var parts=value.split(this.radix);if(parts.length<2)parts.push("");parts[1]=parts[1].padEnd(this.scale,"0");return parts.join(this.radix);}},{key:"doSkipInvalid",value:function doSkipInvalid(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var checkTail=arguments.length>2?arguments[2]:void 0;var dropFractional=this.scale===0&&ch!==this.thousandsSeparator&&(ch===this.radix||ch===MaskedNumber.UNMASKED_RADIX||this.mapToRadix.includes(ch));return _get(_getPrototypeOf(MaskedNumber.prototype),"doSkipInvalid",this).call(this,ch,flags,checkTail)&&!dropFractional;}},{key:"unmaskedValue",get:function get(){return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix,MaskedNumber.UNMASKED_RADIX);},set:function set(unmaskedValue){_set(_getPrototypeOf(MaskedNumber.prototype),"unmaskedValue",unmaskedValue,this,true);}},{key:"typedValue",get:function get(){return this.doParse(this.unmaskedValue);},set:function set(n2){this.rawInputValue=this.doFormat(n2).replace(MaskedNumber.UNMASKED_RADIX,this.radix);}},{key:"number",get:function get(){return this.typedValue;},set:function set(number){this.typedValue=number;}},{key:"allowNegative",get:function get(){return this.signed||this.min!=null&&this.min<0||this.max!=null&&this.max<0;}},{key:"typedValueEquals",value:function typedValueEquals(value){return(_get(_getPrototypeOf(MaskedNumber.prototype),"typedValueEquals",this).call(this,value)||MaskedNumber.EMPTY_VALUES.includes(value)&&MaskedNumber.EMPTY_VALUES.includes(this.typedValue))&&!(value===0&&this.value==="");}}]);return MaskedNumber;}(Masked);MaskedNumber.UNMASKED_RADIX=".";MaskedNumber.DEFAULTS={radix:",",thousandsSeparator:"",mapToRadix:[MaskedNumber.UNMASKED_RADIX],scale:2,signed:false,normalizeZeros:true,padFractionalZeros:false,parse:Number,format:function format(n2){return n2.toLocaleString("en-US",{useGrouping:false,maximumFractionDigits:20});}};MaskedNumber.EMPTY_VALUES=[].concat(_toConsumableArray2(Masked.EMPTY_VALUES),[0]);IMask.MaskedNumber=MaskedNumber;// node_modules/imask/esm/masked/function.js
var MaskedFunction=/*#__PURE__*/function(_Masked4){_inherits(MaskedFunction,_Masked4);var _super47=_createSuper(MaskedFunction);function MaskedFunction(){_classCallCheck(this,MaskedFunction);return _super47.apply(this,arguments);}_createClass(MaskedFunction,[{key:"_update",value:function _update(opts){if(opts.mask)opts.validate=opts.mask;_get(_getPrototypeOf(MaskedFunction.prototype),"_update",this).call(this,opts);}}]);return MaskedFunction;}(Masked);IMask.MaskedFunction=MaskedFunction;// node_modules/imask/esm/masked/dynamic.js
var _excluded5=["compiledMasks","currentMaskRef","currentMask"];var _excluded22=["mask"];var MaskedDynamic=/*#__PURE__*/function(_Masked5){_inherits(MaskedDynamic,_Masked5);var _super48=_createSuper(MaskedDynamic);function MaskedDynamic(opts){var _this55;_classCallCheck(this,MaskedDynamic);_this55=_super48.call(this,Object.assign({},MaskedDynamic.DEFAULTS,opts));_this55.currentMask=null;return _this55;}_createClass(MaskedDynamic,[{key:"_update",value:function _update(opts){_get(_getPrototypeOf(MaskedDynamic.prototype),"_update",this).call(this,opts);if("mask"in opts){this.compiledMasks=Array.isArray(opts.mask)?opts.mask.map(function(m){return createMask(m);}):[];}}},{key:"_appendCharRaw",value:function _appendCharRaw(ch){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var details=this._applyDispatch(ch,flags);if(this.currentMask){details.aggregate(this.currentMask._appendChar(ch,this.currentMaskFlags(flags)));}return details;}},{key:"_applyDispatch",value:function _applyDispatch(){var appended=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var prevValueBeforeTail=flags.tail&&flags._beforeTailState!=null?flags._beforeTailState._value:this.value;var inputValue=this.rawInputValue;var insertValue=flags.tail&&flags._beforeTailState!=null?flags._beforeTailState._rawInputValue:inputValue;var tailValue=inputValue.slice(insertValue.length);var prevMask=this.currentMask;var details=new ChangeDetails();var prevMaskState=prevMask===null||prevMask===void 0?void 0:prevMask.state;this.currentMask=this.doDispatch(appended,Object.assign({},flags));if(this.currentMask){if(this.currentMask!==prevMask){this.currentMask.reset();if(insertValue){var d=this.currentMask.append(insertValue,{raw:true});details.tailShift=d.inserted.length-prevValueBeforeTail.length;}if(tailValue){details.tailShift+=this.currentMask.append(tailValue,{raw:true,tail:true}).tailShift;}}else{this.currentMask.state=prevMaskState;}}return details;}},{key:"_appendPlaceholder",value:function _appendPlaceholder(){var details=this._applyDispatch.apply(this,arguments);if(this.currentMask){details.aggregate(this.currentMask._appendPlaceholder());}return details;}},{key:"_appendEager",value:function _appendEager(){var details=this._applyDispatch.apply(this,arguments);if(this.currentMask){details.aggregate(this.currentMask._appendEager());}return details;}},{key:"currentMaskFlags",value:function currentMaskFlags(flags){var _flags$_beforeTailSta,_flags$_beforeTailSta2;return Object.assign({},flags,{_beforeTailState:((_flags$_beforeTailSta=flags._beforeTailState)===null||_flags$_beforeTailSta===void 0?void 0:_flags$_beforeTailSta.currentMaskRef)===this.currentMask&&((_flags$_beforeTailSta2=flags._beforeTailState)===null||_flags$_beforeTailSta2===void 0?void 0:_flags$_beforeTailSta2.currentMask)||flags._beforeTailState});}},{key:"doDispatch",value:function doDispatch(appended){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.dispatch(appended,this,flags);}},{key:"doValidate",value:function doValidate(flags){return _get(_getPrototypeOf(MaskedDynamic.prototype),"doValidate",this).call(this,flags)&&(!this.currentMask||this.currentMask.doValidate(this.currentMaskFlags(flags)));}},{key:"doPrepare",value:function doPrepare(str){var flags=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var _normalizePrepare7=normalizePrepare(_get(_getPrototypeOf(MaskedDynamic.prototype),"doPrepare",this).call(this,str,flags)),_normalizePrepare8=_slicedToArray(_normalizePrepare7,2),s2=_normalizePrepare8[0],details=_normalizePrepare8[1];if(this.currentMask){var currentDetails;var _normalizePrepare9=normalizePrepare(_get(_getPrototypeOf(MaskedDynamic.prototype),"doPrepare",this).call(this,s2,this.currentMaskFlags(flags)));var _normalizePrepare10=_slicedToArray(_normalizePrepare9,2);s2=_normalizePrepare10[0];currentDetails=_normalizePrepare10[1];details=details.aggregate(currentDetails);}return[s2,details];}},{key:"reset",value:function reset(){var _this$currentMask;(_this$currentMask=this.currentMask)===null||_this$currentMask===void 0?void 0:_this$currentMask.reset();this.compiledMasks.forEach(function(m){return m.reset();});}},{key:"value",get:function get(){return this.currentMask?this.currentMask.value:"";},set:function set(value){_set(_getPrototypeOf(MaskedDynamic.prototype),"value",value,this,true);}},{key:"unmaskedValue",get:function get(){return this.currentMask?this.currentMask.unmaskedValue:"";},set:function set(unmaskedValue){_set(_getPrototypeOf(MaskedDynamic.prototype),"unmaskedValue",unmaskedValue,this,true);}},{key:"typedValue",get:function get(){return this.currentMask?this.currentMask.typedValue:"";},set:function set(value){var unmaskedValue=String(value);if(this.currentMask){this.currentMask.typedValue=value;unmaskedValue=this.currentMask.unmaskedValue;}this.unmaskedValue=unmaskedValue;}},{key:"isComplete",get:function get(){var _this$currentMask2;return Boolean((_this$currentMask2=this.currentMask)===null||_this$currentMask2===void 0?void 0:_this$currentMask2.isComplete);}},{key:"isFilled",get:function get(){var _this$currentMask3;return Boolean((_this$currentMask3=this.currentMask)===null||_this$currentMask3===void 0?void 0:_this$currentMask3.isFilled);}},{key:"remove",value:function remove(){var details=new ChangeDetails();if(this.currentMask){var _this$currentMask6;details.aggregate((_this$currentMask6=this.currentMask).remove.apply(_this$currentMask6,arguments)).aggregate(this._applyDispatch());}return details;}},{key:"state",get:function get(){var _this$currentMask4;return Object.assign({},_get(_getPrototypeOf(MaskedDynamic.prototype),"state",this),{_rawInputValue:this.rawInputValue,compiledMasks:this.compiledMasks.map(function(m){return m.state;}),currentMaskRef:this.currentMask,currentMask:(_this$currentMask4=this.currentMask)===null||_this$currentMask4===void 0?void 0:_this$currentMask4.state});},set:function set(state2){var compiledMasks=state2.compiledMasks,currentMaskRef=state2.currentMaskRef,currentMask=state2.currentMask,maskedState=_objectWithoutPropertiesLoose(state2,_excluded5);this.compiledMasks.forEach(function(m,mi){return m.state=compiledMasks[mi];});if(currentMaskRef!=null){this.currentMask=currentMaskRef;this.currentMask.state=currentMask;}_set(_getPrototypeOf(MaskedDynamic.prototype),"state",maskedState,this,true);}},{key:"extractInput",value:function extractInput(){var _this$currentMask7;return this.currentMask?(_this$currentMask7=this.currentMask).extractInput.apply(_this$currentMask7,arguments):"";}},{key:"extractTail",value:function extractTail(){var _this$currentMask8;return this.currentMask?(_this$currentMask8=this.currentMask).extractTail.apply(_this$currentMask8,arguments):_get(_getPrototypeOf(MaskedDynamic.prototype),"extractTail",this).apply(this,arguments);}},{key:"doCommit",value:function doCommit(){if(this.currentMask)this.currentMask.doCommit();_get(_getPrototypeOf(MaskedDynamic.prototype),"doCommit",this).call(this);}},{key:"nearestInputPos",value:function nearestInputPos(){var _this$currentMask9;return this.currentMask?(_this$currentMask9=this.currentMask).nearestInputPos.apply(_this$currentMask9,arguments):_get(_getPrototypeOf(MaskedDynamic.prototype),"nearestInputPos",this).apply(this,arguments);}},{key:"overwrite",get:function get(){return this.currentMask?this.currentMask.overwrite:_get(_getPrototypeOf(MaskedDynamic.prototype),"overwrite",this);},set:function set(overwrite){console.warn('"overwrite" option is not available in dynamic mask, use this option in siblings');}},{key:"eager",get:function get(){return this.currentMask?this.currentMask.eager:_get(_getPrototypeOf(MaskedDynamic.prototype),"eager",this);},set:function set(eager){console.warn('"eager" option is not available in dynamic mask, use this option in siblings');}},{key:"skipInvalid",get:function get(){return this.currentMask?this.currentMask.skipInvalid:_get(_getPrototypeOf(MaskedDynamic.prototype),"skipInvalid",this);},set:function set(skipInvalid){console.warn('"skipInvalid" option is not available in dynamic mask, use this option in siblings');}},{key:"maskEquals",value:function maskEquals(mask){return Array.isArray(mask)&&this.compiledMasks.every(function(m,mi){if(!mask[mi])return;var _mask$mi=mask[mi],oldMask=_mask$mi.mask,restOpts=_objectWithoutPropertiesLoose(_mask$mi,_excluded22);return objectIncludes(m,restOpts)&&m.maskEquals(oldMask);});}},{key:"typedValueEquals",value:function typedValueEquals(value){var _this$currentMask5;return Boolean((_this$currentMask5=this.currentMask)===null||_this$currentMask5===void 0?void 0:_this$currentMask5.typedValueEquals(value));}}]);return MaskedDynamic;}(Masked);MaskedDynamic.DEFAULTS={dispatch:function dispatch(appended,masked,flags){if(!masked.compiledMasks.length)return;var inputValue=masked.rawInputValue;var inputs=masked.compiledMasks.map(function(m,index2){m.reset();m.append(inputValue,{raw:true});m.append(appended,masked.currentMaskFlags(flags));var weight=m.rawInputValue.length;return{weight:weight,index:index2};});inputs.sort(function(i1,i2){return i2.weight-i1.weight;});return masked.compiledMasks[inputs[0].index];}};IMask.MaskedDynamic=MaskedDynamic;// node_modules/imask/esm/masked/pipe.js
var PIPE_TYPE={MASKED:"value",UNMASKED:"unmaskedValue",TYPED:"typedValue"};function createPipe(mask){var from=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PIPE_TYPE.MASKED;var to=arguments.length>2&&arguments[2]!==void 0?arguments[2]:PIPE_TYPE.MASKED;var masked=createMask(mask);return function(value){return masked.runIsolated(function(m){m[from]=value;return m[to];});};}function pipe(value){for(var _len=arguments.length,pipeArgs=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){pipeArgs[_key-1]=arguments[_key];}return createPipe.apply(void 0,pipeArgs)(value);}IMask.PIPE_TYPE=PIPE_TYPE;IMask.createPipe=createPipe;IMask.pipe=pipe;// node_modules/imask/esm/index.js
try{globalThis.IMask=IMask;}catch(e2){}// packages/forms/resources/js/components/text-input.js
var text_input_default=function text_input_default(Alpine){Alpine.data("textInputFormComponent",function(_ref228){var getMaskOptionsUsing=_ref228.getMaskOptionsUsing,state2=_ref228.state;return{isStateBeingUpdated:false,mask:null,state:state2,init:function init(){var _this56=this;if(!getMaskOptionsUsing){return;}if(this.state){var _this$state2;this.$el.value=(_this$state2=this.state)===null||_this$state2===void 0?void 0:_this$state2.valueOf();}this.mask=IMask(this.$el,getMaskOptionsUsing(IMask)).on("accept",function(){_this56.isStateBeingUpdated=true;_this56.state=_this56.mask.unmaskedValue;_this56.$nextTick(function(){return _this56.isStateBeingUpdated=false;});});this.$watch("state",function(){var _this56$state$valueOf,_this56$state;if(_this56.isStateBeingUpdated){return;}_this56.mask.unmaskedValue=(_this56$state$valueOf=(_this56$state=_this56.state)===null||_this56$state===void 0?void 0:_this56$state.valueOf())!==null&&_this56$state$valueOf!==void 0?_this56$state$valueOf:"";});}};});};// packages/forms/resources/js/components/textarea.js
var textarea_default=function textarea_default(Alpine){Alpine.data("textareaFormComponent",function(){return{init:function init(){var _this57=this;this.$nextTick(function(){_this57.render();});},render:function render(){if(this.$el.scrollHeight>0){this.$el.style.height="150px";this.$el.style.height=this.$el.scrollHeight+2+"px";}}};});};// node_modules/sortablejs/modular/sortable.esm.js
/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _typeof2(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj2){return typeof obj2;};}else{_typeof2=function _typeof2(obj2){return obj2&&typeof Symbol==="function"&&obj2.constructor===Symbol&&obj2!==Symbol.prototype?"symbol":typeof obj2;};}return _typeof2(obj);}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}function _objectWithoutPropertiesLoose2(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose2(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}var version="1.15.0";function userAgent(pattern){if(typeof window!=="undefined"&&window.navigator){return!!/* @__PURE__ */navigator.userAgent.match(pattern);}}var IE11OrLess=userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i);var Edge=userAgent(/Edge/i);var FireFox=userAgent(/firefox/i);var Safari=userAgent(/safari/i)&&!userAgent(/chrome/i)&&!userAgent(/android/i);var IOS=userAgent(/iP(ad|od|hone)/i);var ChromeForAndroid=userAgent(/chrome/i)&&userAgent(/android/i);var captureMode={capture:false,passive:false};function on2(el,event,fn2){el.addEventListener(event,fn2,!IE11OrLess&&captureMode);}function off(el,event,fn2){el.removeEventListener(event,fn2,!IE11OrLess&&captureMode);}function matches(el,selector){if(!selector)return;selector[0]===">"&&(selector=selector.substring(1));if(el){try{if(el.matches){return el.matches(selector);}else if(el.msMatchesSelector){return el.msMatchesSelector(selector);}else if(el.webkitMatchesSelector){return el.webkitMatchesSelector(selector);}}catch(_){return false;}}return false;}function getParentOrHost(el){return el.host&&el!==document&&el.host.nodeType?el.host:el.parentNode;}function closest(el,selector,ctx,includeCTX){if(el){ctx=ctx||document;do{if(selector!=null&&(selector[0]===">"?el.parentNode===ctx&&matches(el,selector):matches(el,selector))||includeCTX&&el===ctx){return el;}if(el===ctx)break;}while(el=getParentOrHost(el));}return null;}var R_SPACE=/\s+/g;function toggleClass(el,name2,state2){if(el&&name2){if(el.classList){el.classList[state2?"add":"remove"](name2);}else{var className=(" "+el.className+" ").replace(R_SPACE," ").replace(" "+name2+" "," ");el.className=(className+(state2?" "+name2:"")).replace(R_SPACE," ");}}}function css(el,prop,val){var style=el&&el.style;if(style){if(val===void 0){if(document.defaultView&&document.defaultView.getComputedStyle){val=document.defaultView.getComputedStyle(el,"");}else if(el.currentStyle){val=el.currentStyle;}return prop===void 0?val:val[prop];}else{if(!(prop in style)&&prop.indexOf("webkit")===-1){prop="-webkit-"+prop;}style[prop]=val+(typeof val==="string"?"":"px");}}}function matrix(el,selfOnly){var appliedTransforms="";if(typeof el==="string"){appliedTransforms=el;}else{do{var transform=css(el,"transform");if(transform&&transform!=="none"){appliedTransforms=transform+" "+appliedTransforms;}}while(!selfOnly&&(el=el.parentNode));}var matrixFn=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return matrixFn&&new matrixFn(appliedTransforms);}function find2(ctx,tagName,iterator){if(ctx){var list2=ctx.getElementsByTagName(tagName),i=0,n2=list2.length;if(iterator){for(;i<n2;i++){iterator(list2[i],i);}}return list2;}return[];}function getWindowScrollingElement(){var scrollingElement=document.scrollingElement;if(scrollingElement){return scrollingElement;}else{return document.documentElement;}}function getRect(el,relativeToContainingBlock,relativeToNonStaticParent,undoScale,container){if(!el.getBoundingClientRect&&el!==window)return;var elRect,top,left,bottom,right,height,width;if(el!==window&&el.parentNode&&el!==getWindowScrollingElement()){elRect=el.getBoundingClientRect();top=elRect.top;left=elRect.left;bottom=elRect.bottom;right=elRect.right;height=elRect.height;width=elRect.width;}else{top=0;left=0;bottom=window.innerHeight;right=window.innerWidth;height=window.innerHeight;width=window.innerWidth;}if((relativeToContainingBlock||relativeToNonStaticParent)&&el!==window){container=container||el.parentNode;if(!IE11OrLess){do{if(container&&container.getBoundingClientRect&&(css(container,"transform")!=="none"||relativeToNonStaticParent&&css(container,"position")!=="static")){var containerRect=container.getBoundingClientRect();top-=containerRect.top+parseInt(css(container,"border-top-width"));left-=containerRect.left+parseInt(css(container,"border-left-width"));bottom=top+elRect.height;right=left+elRect.width;break;}}while(container=container.parentNode);}}if(undoScale&&el!==window){var elMatrix=matrix(container||el),scaleX=elMatrix&&elMatrix.a,scaleY=elMatrix&&elMatrix.d;if(elMatrix){top/=scaleY;left/=scaleX;width/=scaleX;height/=scaleY;bottom=top+height;right=left+width;}}return{top:top,left:left,bottom:bottom,right:right,width:width,height:height};}function isScrolledPast(el,elSide,parentSide){var parent=getParentAutoScrollElement(el,true),elSideVal=getRect(el)[elSide];while(parent){var parentSideVal=getRect(parent)[parentSide],visible2=void 0;if(parentSide==="top"||parentSide==="left"){visible2=elSideVal>=parentSideVal;}else{visible2=elSideVal<=parentSideVal;}if(!visible2)return parent;if(parent===getWindowScrollingElement())break;parent=getParentAutoScrollElement(parent,false);}return false;}function getChild(el,childNum,options2,includeDragEl){var currentChild=0,i=0,children=el.children;while(i<children.length){if(children[i].style.display!=="none"&&children[i]!==Sortable.ghost&&(includeDragEl||children[i]!==Sortable.dragged)&&closest(children[i],options2.draggable,el,false)){if(currentChild===childNum){return children[i];}currentChild++;}i++;}return null;}function lastChild(el,selector){var last=el.lastElementChild;while(last&&(last===Sortable.ghost||css(last,"display")==="none"||selector&&!matches(last,selector))){last=last.previousElementSibling;}return last||null;}function index(el,selector){var index2=0;if(!el||!el.parentNode){return-1;}while(el=el.previousElementSibling){if(el.nodeName.toUpperCase()!=="TEMPLATE"&&el!==Sortable.clone&&(!selector||matches(el,selector))){index2++;}}return index2;}function getRelativeScrollOffset(el){var offsetLeft=0,offsetTop=0,winScroller=getWindowScrollingElement();if(el){do{var elMatrix=matrix(el),scaleX=elMatrix.a,scaleY=elMatrix.d;offsetLeft+=el.scrollLeft*scaleX;offsetTop+=el.scrollTop*scaleY;}while(el!==winScroller&&(el=el.parentNode));}return[offsetLeft,offsetTop];}function indexOfObject(arr,obj){for(var i in arr){if(!arr.hasOwnProperty(i))continue;for(var key in obj){if(obj.hasOwnProperty(key)&&obj[key]===arr[i][key])return Number(i);}}return-1;}function getParentAutoScrollElement(el,includeSelf){if(!el||!el.getBoundingClientRect)return getWindowScrollingElement();var elem=el;var gotSelf=false;do{if(elem.clientWidth<elem.scrollWidth||elem.clientHeight<elem.scrollHeight){var elemCSS=css(elem);if(elem.clientWidth<elem.scrollWidth&&(elemCSS.overflowX=="auto"||elemCSS.overflowX=="scroll")||elem.clientHeight<elem.scrollHeight&&(elemCSS.overflowY=="auto"||elemCSS.overflowY=="scroll")){if(!elem.getBoundingClientRect||elem===document.body)return getWindowScrollingElement();if(gotSelf||includeSelf)return elem;gotSelf=true;}}}while(elem=elem.parentNode);return getWindowScrollingElement();}function extend(dst,src){if(dst&&src){for(var key in src){if(src.hasOwnProperty(key)){dst[key]=src[key];}}}return dst;}function isRectEqual(rect1,rect2){return Math.round(rect1.top)===Math.round(rect2.top)&&Math.round(rect1.left)===Math.round(rect2.left)&&Math.round(rect1.height)===Math.round(rect2.height)&&Math.round(rect1.width)===Math.round(rect2.width);}var _throttleTimeout;function throttle(callback,ms){return function(){if(!_throttleTimeout){var args=arguments,_this=this;if(args.length===1){callback.call(_this,args[0]);}else{callback.apply(_this,args);}_throttleTimeout=setTimeout(function(){_throttleTimeout=void 0;},ms);}};}function cancelThrottle(){clearTimeout(_throttleTimeout);_throttleTimeout=void 0;}function scrollBy(el,x,y){el.scrollLeft+=x;el.scrollTop+=y;}function clone2(el){var Polymer=window.Polymer;var $=window.jQuery||window.Zepto;if(Polymer&&Polymer.dom){return Polymer.dom(el).cloneNode(true);}else if($){return $(el).clone(true)[0];}else{return el.cloneNode(true);}}var expando="Sortable"+new Date().getTime();function AnimationStateManager(){var animationStates=[],animationCallbackId;return{captureAnimationState:function captureAnimationState(){animationStates=[];if(!this.options.animation)return;var children=[].slice.call(this.el.children);children.forEach(function(child){if(css(child,"display")==="none"||child===Sortable.ghost)return;animationStates.push({target:child,rect:getRect(child)});var fromRect=_objectSpread2({},animationStates[animationStates.length-1].rect);if(child.thisAnimationDuration){var childMatrix=matrix(child,true);if(childMatrix){fromRect.top-=childMatrix.f;fromRect.left-=childMatrix.e;}}child.fromRect=fromRect;});},addAnimationState:function addAnimationState(state2){animationStates.push(state2);},removeAnimationState:function removeAnimationState(target){animationStates.splice(indexOfObject(animationStates,{target:target}),1);},animateAll:function animateAll(callback){var _this=this;if(!this.options.animation){clearTimeout(animationCallbackId);if(typeof callback==="function")callback();return;}var animating=false,animationTime=0;animationStates.forEach(function(state2){var time=0,target=state2.target,fromRect=target.fromRect,toRect=getRect(target),prevFromRect=target.prevFromRect,prevToRect=target.prevToRect,animatingRect=state2.rect,targetMatrix=matrix(target,true);if(targetMatrix){toRect.top-=targetMatrix.f;toRect.left-=targetMatrix.e;}target.toRect=toRect;if(target.thisAnimationDuration){if(isRectEqual(prevFromRect,toRect)&&!isRectEqual(fromRect,toRect)&&(animatingRect.top-toRect.top)/(animatingRect.left-toRect.left)===(fromRect.top-toRect.top)/(fromRect.left-toRect.left)){time=calculateRealTime(animatingRect,prevFromRect,prevToRect,_this.options);}}if(!isRectEqual(toRect,fromRect)){target.prevFromRect=fromRect;target.prevToRect=toRect;if(!time){time=_this.options.animation;}_this.animate(target,animatingRect,toRect,time);}if(time){animating=true;animationTime=Math.max(animationTime,time);clearTimeout(target.animationResetTimer);target.animationResetTimer=setTimeout(function(){target.animationTime=0;target.prevFromRect=null;target.fromRect=null;target.prevToRect=null;target.thisAnimationDuration=null;},time);target.thisAnimationDuration=time;}});clearTimeout(animationCallbackId);if(!animating){if(typeof callback==="function")callback();}else{animationCallbackId=setTimeout(function(){if(typeof callback==="function")callback();},animationTime);}animationStates=[];},animate:function animate(target,currentRect,toRect,duration){if(duration){css(target,"transition","");css(target,"transform","");var elMatrix=matrix(this.el),scaleX=elMatrix&&elMatrix.a,scaleY=elMatrix&&elMatrix.d,translateX=(currentRect.left-toRect.left)/(scaleX||1),translateY=(currentRect.top-toRect.top)/(scaleY||1);target.animatingX=!!translateX;target.animatingY=!!translateY;css(target,"transform","translate3d("+translateX+"px,"+translateY+"px,0)");this.forRepaintDummy=repaint(target);css(target,"transition","transform "+duration+"ms"+(this.options.easing?" "+this.options.easing:""));css(target,"transform","translate3d(0,0,0)");typeof target.animated==="number"&&clearTimeout(target.animated);target.animated=setTimeout(function(){css(target,"transition","");css(target,"transform","");target.animated=false;target.animatingX=false;target.animatingY=false;},duration);}}};}function repaint(target){return target.offsetWidth;}function calculateRealTime(animatingRect,fromRect,toRect,options2){return Math.sqrt(Math.pow(fromRect.top-animatingRect.top,2)+Math.pow(fromRect.left-animatingRect.left,2))/Math.sqrt(Math.pow(fromRect.top-toRect.top,2)+Math.pow(fromRect.left-toRect.left,2))*options2.animation;}var plugins=[];var defaults3={initializeByDefault:true};var PluginManager={mount:function mount(plugin9){for(var option3 in defaults3){if(defaults3.hasOwnProperty(option3)&&!(option3 in plugin9)){plugin9[option3]=defaults3[option3];}}plugins.forEach(function(p2){if(p2.pluginName===plugin9.pluginName){throw"Sortable: Cannot mount plugin ".concat(plugin9.pluginName," more than once");}});plugins.push(plugin9);},pluginEvent:function pluginEvent(eventName,sortable,evt){var _this=this;this.eventCanceled=false;evt.cancel=function(){_this.eventCanceled=true;};var eventNameGlobal=eventName+"Global";plugins.forEach(function(plugin9){if(!sortable[plugin9.pluginName])return;if(sortable[plugin9.pluginName][eventNameGlobal]){sortable[plugin9.pluginName][eventNameGlobal](_objectSpread2({sortable:sortable},evt));}if(sortable.options[plugin9.pluginName]&&sortable[plugin9.pluginName][eventName]){sortable[plugin9.pluginName][eventName](_objectSpread2({sortable:sortable},evt));}});},initializePlugins:function initializePlugins(sortable,el,defaults4,options2){plugins.forEach(function(plugin9){var pluginName=plugin9.pluginName;if(!sortable.options[pluginName]&&!plugin9.initializeByDefault)return;var initialized=new plugin9(sortable,el,sortable.options);initialized.sortable=sortable;initialized.options=sortable.options;sortable[pluginName]=initialized;_extends(defaults4,initialized.defaults);});for(var option3 in sortable.options){if(!sortable.options.hasOwnProperty(option3))continue;var modified=this.modifyOption(sortable,option3,sortable.options[option3]);if(typeof modified!=="undefined"){sortable.options[option3]=modified;}}},getEventProperties:function getEventProperties(name2,sortable){var eventProperties={};plugins.forEach(function(plugin9){if(typeof plugin9.eventProperties!=="function")return;_extends(eventProperties,plugin9.eventProperties.call(sortable[plugin9.pluginName],name2));});return eventProperties;},modifyOption:function modifyOption(sortable,name2,value){var modifiedValue;plugins.forEach(function(plugin9){if(!sortable[plugin9.pluginName])return;if(plugin9.optionListeners&&typeof plugin9.optionListeners[name2]==="function"){modifiedValue=plugin9.optionListeners[name2].call(sortable[plugin9.pluginName],value);}});return modifiedValue;}};function dispatchEvent(_ref2){var sortable=_ref2.sortable,rootEl2=_ref2.rootEl,name2=_ref2.name,targetEl=_ref2.targetEl,cloneEl2=_ref2.cloneEl,toEl=_ref2.toEl,fromEl=_ref2.fromEl,oldIndex2=_ref2.oldIndex,newIndex2=_ref2.newIndex,oldDraggableIndex2=_ref2.oldDraggableIndex,newDraggableIndex2=_ref2.newDraggableIndex,originalEvent=_ref2.originalEvent,putSortable2=_ref2.putSortable,extraEventProperties=_ref2.extraEventProperties;sortable=sortable||rootEl2&&rootEl2[expando];if(!sortable)return;var evt,options2=sortable.options,onName="on"+name2.charAt(0).toUpperCase()+name2.substr(1);if(window.CustomEvent&&!IE11OrLess&&!Edge){evt=new CustomEvent(name2,{bubbles:true,cancelable:true});}else{evt=document.createEvent("Event");evt.initEvent(name2,true,true);}evt.to=toEl||rootEl2;evt.from=fromEl||rootEl2;evt.item=targetEl||rootEl2;evt.clone=cloneEl2;evt.oldIndex=oldIndex2;evt.newIndex=newIndex2;evt.oldDraggableIndex=oldDraggableIndex2;evt.newDraggableIndex=newDraggableIndex2;evt.originalEvent=originalEvent;evt.pullMode=putSortable2?putSortable2.lastPutMode:void 0;var allEventProperties=_objectSpread2(_objectSpread2({},extraEventProperties),PluginManager.getEventProperties(name2,sortable));for(var option3 in allEventProperties){evt[option3]=allEventProperties[option3];}if(rootEl2){rootEl2.dispatchEvent(evt);}if(options2[onName]){options2[onName].call(sortable,evt);}}var _excluded6=["evt"];var pluginEvent2=function pluginEvent3(eventName,sortable){var _ref2=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},originalEvent=_ref2.evt,data3=_objectWithoutProperties(_ref2,_excluded6);PluginManager.pluginEvent.bind(Sortable)(eventName,sortable,_objectSpread2({dragEl:dragEl,parentEl:parentEl,ghostEl:ghostEl,rootEl:rootEl,nextEl:nextEl,lastDownEl:lastDownEl,cloneEl:cloneEl,cloneHidden:cloneHidden,dragStarted:moved,putSortable:putSortable,activeSortable:Sortable.active,originalEvent:originalEvent,oldIndex:oldIndex,oldDraggableIndex:oldDraggableIndex,newIndex:newIndex,newDraggableIndex:newDraggableIndex,hideGhostForTarget:_hideGhostForTarget,unhideGhostForTarget:_unhideGhostForTarget,cloneNowHidden:function cloneNowHidden(){cloneHidden=true;},cloneNowShown:function cloneNowShown(){cloneHidden=false;},dispatchSortableEvent:function dispatchSortableEvent(name2){_dispatchEvent({sortable:sortable,name:name2,originalEvent:originalEvent});}},data3));};function _dispatchEvent(info){dispatchEvent(_objectSpread2({putSortable:putSortable,cloneEl:cloneEl,targetEl:dragEl,rootEl:rootEl,oldIndex:oldIndex,oldDraggableIndex:oldDraggableIndex,newIndex:newIndex,newDraggableIndex:newDraggableIndex},info));}var dragEl;var parentEl;var ghostEl;var rootEl;var nextEl;var lastDownEl;var cloneEl;var cloneHidden;var oldIndex;var newIndex;var oldDraggableIndex;var newDraggableIndex;var activeGroup;var putSortable;var awaitingDragStarted=false;var ignoreNextClick=false;var sortables=[];var tapEvt;var touchEvt;var lastDx;var lastDy;var tapDistanceLeft;var tapDistanceTop;var moved;var lastTarget;var lastDirection;var pastFirstInvertThresh=false;var isCircumstantialInvert=false;var targetMoveDistance;var ghostRelativeParent;var ghostRelativeParentInitialScroll=[];var _silent=false;var savedInputChecked=[];var documentExists=typeof document!=="undefined";var PositionGhostAbsolutely=IOS;var CSSFloatProperty=Edge||IE11OrLess?"cssFloat":"float";var supportDraggable=documentExists&&!ChromeForAndroid&&!IOS&&"draggable"in document.createElement("div");var supportCssPointerEvents=function(){if(!documentExists)return;if(IE11OrLess){return false;}var el=document.createElement("x");el.style.cssText="pointer-events:auto";return el.style.pointerEvents==="auto";}();var _detectDirection=function _detectDirection2(el,options2){var elCSS=css(el),elWidth=parseInt(elCSS.width)-parseInt(elCSS.paddingLeft)-parseInt(elCSS.paddingRight)-parseInt(elCSS.borderLeftWidth)-parseInt(elCSS.borderRightWidth),child1=getChild(el,0,options2),child2=getChild(el,1,options2),firstChildCSS=child1&&css(child1),secondChildCSS=child2&&css(child2),firstChildWidth=firstChildCSS&&parseInt(firstChildCSS.marginLeft)+parseInt(firstChildCSS.marginRight)+getRect(child1).width,secondChildWidth=secondChildCSS&&parseInt(secondChildCSS.marginLeft)+parseInt(secondChildCSS.marginRight)+getRect(child2).width;if(elCSS.display==="flex"){return elCSS.flexDirection==="column"||elCSS.flexDirection==="column-reverse"?"vertical":"horizontal";}if(elCSS.display==="grid"){return elCSS.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";}if(child1&&firstChildCSS["float"]&&firstChildCSS["float"]!=="none"){var touchingSideChild2=firstChildCSS["float"]==="left"?"left":"right";return child2&&(secondChildCSS.clear==="both"||secondChildCSS.clear===touchingSideChild2)?"vertical":"horizontal";}return child1&&(firstChildCSS.display==="block"||firstChildCSS.display==="flex"||firstChildCSS.display==="table"||firstChildCSS.display==="grid"||firstChildWidth>=elWidth&&elCSS[CSSFloatProperty]==="none"||child2&&elCSS[CSSFloatProperty]==="none"&&firstChildWidth+secondChildWidth>elWidth)?"vertical":"horizontal";};var _dragElInRowColumn=function _dragElInRowColumn2(dragRect,targetRect,vertical){var dragElS1Opp=vertical?dragRect.left:dragRect.top,dragElS2Opp=vertical?dragRect.right:dragRect.bottom,dragElOppLength=vertical?dragRect.width:dragRect.height,targetS1Opp=vertical?targetRect.left:targetRect.top,targetS2Opp=vertical?targetRect.right:targetRect.bottom,targetOppLength=vertical?targetRect.width:targetRect.height;return dragElS1Opp===targetS1Opp||dragElS2Opp===targetS2Opp||dragElS1Opp+dragElOppLength/2===targetS1Opp+targetOppLength/2;};var _detectNearestEmptySortable=function _detectNearestEmptySortable2(x,y){var ret;sortables.some(function(sortable){var threshold=sortable[expando].options.emptyInsertThreshold;if(!threshold||lastChild(sortable))return;var rect=getRect(sortable),insideHorizontally=x>=rect.left-threshold&&x<=rect.right+threshold,insideVertically=y>=rect.top-threshold&&y<=rect.bottom+threshold;if(insideHorizontally&&insideVertically){return ret=sortable;}});return ret;};var _prepareGroup=function _prepareGroup2(options2){function toFn(value,pull){return function(to,from,dragEl2,evt){var sameGroup=to.options.group.name&&from.options.group.name&&to.options.group.name===from.options.group.name;if(value==null&&(pull||sameGroup)){return true;}else if(value==null||value===false){return false;}else if(pull&&value==="clone"){return value;}else if(typeof value==="function"){return toFn(value(to,from,dragEl2,evt),pull)(to,from,dragEl2,evt);}else{var otherGroup=(pull?to:from).options.group.name;return value===true||typeof value==="string"&&value===otherGroup||value.join&&value.indexOf(otherGroup)>-1;}};}var group={};var originalGroup=options2.group;if(!originalGroup||_typeof2(originalGroup)!="object"){originalGroup={name:originalGroup};}group.name=originalGroup.name;group.checkPull=toFn(originalGroup.pull,true);group.checkPut=toFn(originalGroup.put);group.revertClone=originalGroup.revertClone;options2.group=group;};var _hideGhostForTarget=function _hideGhostForTarget2(){if(!supportCssPointerEvents&&ghostEl){css(ghostEl,"display","none");}};var _unhideGhostForTarget=function _unhideGhostForTarget2(){if(!supportCssPointerEvents&&ghostEl){css(ghostEl,"display","");}};if(documentExists&&!ChromeForAndroid){document.addEventListener("click",function(evt){if(ignoreNextClick){evt.preventDefault();evt.stopPropagation&&evt.stopPropagation();evt.stopImmediatePropagation&&evt.stopImmediatePropagation();ignoreNextClick=false;return false;}},true);}var nearestEmptyInsertDetectEvent=function nearestEmptyInsertDetectEvent2(evt){if(dragEl){evt=evt.touches?evt.touches[0]:evt;var nearest=_detectNearestEmptySortable(evt.clientX,evt.clientY);if(nearest){var event={};for(var i in evt){if(evt.hasOwnProperty(i)){event[i]=evt[i];}}event.target=event.rootEl=nearest;event.preventDefault=void 0;event.stopPropagation=void 0;nearest[expando]._onDragOver(event);}}};var _checkOutsideTargetEl=function _checkOutsideTargetEl2(evt){if(dragEl){dragEl.parentNode[expando]._isOutsideThisEl(evt.target);}};function Sortable(el,options2){if(!(el&&el.nodeType&&el.nodeType===1)){throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(el));}this.el=el;this.options=options2=_extends({},options2);el[expando]=this;var defaults4={group:null,sort:true,disabled:false,store:null,handle:null,draggable:/^[uo]l$/i.test(el.nodeName)?">li":">*",swapThreshold:1,invertSwap:false,invertedSwapThreshold:null,removeCloneOnHide:true,direction:function direction(){return _detectDirection(el,this.options);},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:true,animation:0,easing:null,setData:function setData(dataTransfer,dragEl2){dataTransfer.setData("Text",dragEl2.textContent);},dropBubble:false,dragoverBubble:false,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:false,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:false,fallbackClass:"sortable-fallback",fallbackOnBody:false,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Sortable.supportPointer!==false&&"PointerEvent"in window&&!Safari,emptyInsertThreshold:5};PluginManager.initializePlugins(this,el,defaults4);for(var name2 in defaults4){!(name2 in options2)&&(options2[name2]=defaults4[name2]);}_prepareGroup(options2);for(var fn2 in this){if(fn2.charAt(0)==="_"&&typeof this[fn2]==="function"){this[fn2]=this[fn2].bind(this);}}this.nativeDraggable=options2.forceFallback?false:supportDraggable;if(this.nativeDraggable){this.options.touchStartThreshold=1;}if(options2.supportPointer){on2(el,"pointerdown",this._onTapStart);}else{on2(el,"mousedown",this._onTapStart);on2(el,"touchstart",this._onTapStart);}if(this.nativeDraggable){on2(el,"dragover",this);on2(el,"dragenter",this);}sortables.push(this.el);options2.store&&options2.store.get&&this.sort(options2.store.get(this)||[]);_extends(this,AnimationStateManager());}Sortable.prototype={constructor:Sortable,_isOutsideThisEl:function _isOutsideThisEl(target){if(!this.el.contains(target)&&target!==this.el){lastTarget=null;}},_getDirection:function _getDirection(evt,target){return typeof this.options.direction==="function"?this.options.direction.call(this,evt,target,dragEl):this.options.direction;},_onTapStart:function _onTapStart(evt){if(!evt.cancelable)return;var _this=this,el=this.el,options2=this.options,preventOnFilter=options2.preventOnFilter,type=evt.type,touch=evt.touches&&evt.touches[0]||evt.pointerType&&evt.pointerType==="touch"&&evt,target=(touch||evt).target,originalTarget=evt.target.shadowRoot&&(evt.path&&evt.path[0]||evt.composedPath&&evt.composedPath()[0])||target,filter=options2.filter;_saveInputCheckedState(el);if(dragEl){return;}if(/mousedown|pointerdown/.test(type)&&evt.button!==0||options2.disabled){return;}if(originalTarget.isContentEditable){return;}if(!this.nativeDraggable&&Safari&&target&&target.tagName.toUpperCase()==="SELECT"){return;}target=closest(target,options2.draggable,el,false);if(target&&target.animated){return;}if(lastDownEl===target){return;}oldIndex=index(target);oldDraggableIndex=index(target,options2.draggable);if(typeof filter==="function"){if(filter.call(this,evt,target,this)){_dispatchEvent({sortable:_this,rootEl:originalTarget,name:"filter",targetEl:target,toEl:el,fromEl:el});pluginEvent2("filter",_this,{evt:evt});preventOnFilter&&evt.cancelable&&evt.preventDefault();return;}}else if(filter){filter=filter.split(",").some(function(criteria){criteria=closest(originalTarget,criteria.trim(),el,false);if(criteria){_dispatchEvent({sortable:_this,rootEl:criteria,name:"filter",targetEl:target,fromEl:el,toEl:el});pluginEvent2("filter",_this,{evt:evt});return true;}});if(filter){preventOnFilter&&evt.cancelable&&evt.preventDefault();return;}}if(options2.handle&&!closest(originalTarget,options2.handle,el,false)){return;}this._prepareDragStart(evt,touch,target);},_prepareDragStart:function _prepareDragStart(evt,touch,target){var _this=this,el=_this.el,options2=_this.options,ownerDocument=el.ownerDocument,dragStartFn;if(target&&!dragEl&&target.parentNode===el){var dragRect=getRect(target);rootEl=el;dragEl=target;parentEl=dragEl.parentNode;nextEl=dragEl.nextSibling;lastDownEl=target;activeGroup=options2.group;Sortable.dragged=dragEl;tapEvt={target:dragEl,clientX:(touch||evt).clientX,clientY:(touch||evt).clientY};tapDistanceLeft=tapEvt.clientX-dragRect.left;tapDistanceTop=tapEvt.clientY-dragRect.top;this._lastX=(touch||evt).clientX;this._lastY=(touch||evt).clientY;dragEl.style["will-change"]="all";dragStartFn=function dragStartFn2(){pluginEvent2("delayEnded",_this,{evt:evt});if(Sortable.eventCanceled){_this._onDrop();return;}_this._disableDelayedDragEvents();if(!FireFox&&_this.nativeDraggable){dragEl.draggable=true;}_this._triggerDragStart(evt,touch);_dispatchEvent({sortable:_this,name:"choose",originalEvent:evt});toggleClass(dragEl,options2.chosenClass,true);};options2.ignore.split(",").forEach(function(criteria){find2(dragEl,criteria.trim(),_disableDraggable);});on2(ownerDocument,"dragover",nearestEmptyInsertDetectEvent);on2(ownerDocument,"mousemove",nearestEmptyInsertDetectEvent);on2(ownerDocument,"touchmove",nearestEmptyInsertDetectEvent);on2(ownerDocument,"mouseup",_this._onDrop);on2(ownerDocument,"touchend",_this._onDrop);on2(ownerDocument,"touchcancel",_this._onDrop);if(FireFox&&this.nativeDraggable){this.options.touchStartThreshold=4;dragEl.draggable=true;}pluginEvent2("delayStart",this,{evt:evt});if(options2.delay&&(!options2.delayOnTouchOnly||touch)&&(!this.nativeDraggable||!(Edge||IE11OrLess))){if(Sortable.eventCanceled){this._onDrop();return;}on2(ownerDocument,"mouseup",_this._disableDelayedDrag);on2(ownerDocument,"touchend",_this._disableDelayedDrag);on2(ownerDocument,"touchcancel",_this._disableDelayedDrag);on2(ownerDocument,"mousemove",_this._delayedDragTouchMoveHandler);on2(ownerDocument,"touchmove",_this._delayedDragTouchMoveHandler);options2.supportPointer&&on2(ownerDocument,"pointermove",_this._delayedDragTouchMoveHandler);_this._dragStartTimer=setTimeout(dragStartFn,options2.delay);}else{dragStartFn();}}},_delayedDragTouchMoveHandler:function _delayedDragTouchMoveHandler(e2){var touch=e2.touches?e2.touches[0]:e2;if(Math.max(Math.abs(touch.clientX-this._lastX),Math.abs(touch.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))){this._disableDelayedDrag();}},_disableDelayedDrag:function _disableDelayedDrag(){dragEl&&_disableDraggable(dragEl);clearTimeout(this._dragStartTimer);this._disableDelayedDragEvents();},_disableDelayedDragEvents:function _disableDelayedDragEvents(){var ownerDocument=this.el.ownerDocument;off(ownerDocument,"mouseup",this._disableDelayedDrag);off(ownerDocument,"touchend",this._disableDelayedDrag);off(ownerDocument,"touchcancel",this._disableDelayedDrag);off(ownerDocument,"mousemove",this._delayedDragTouchMoveHandler);off(ownerDocument,"touchmove",this._delayedDragTouchMoveHandler);off(ownerDocument,"pointermove",this._delayedDragTouchMoveHandler);},_triggerDragStart:function _triggerDragStart(evt,touch){touch=touch||evt.pointerType=="touch"&&evt;if(!this.nativeDraggable||touch){if(this.options.supportPointer){on2(document,"pointermove",this._onTouchMove);}else if(touch){on2(document,"touchmove",this._onTouchMove);}else{on2(document,"mousemove",this._onTouchMove);}}else{on2(dragEl,"dragend",this);on2(rootEl,"dragstart",this._onDragStart);}try{if(document.selection){_nextTick(function(){document.selection.empty();});}else{window.getSelection().removeAllRanges();}}catch(err){}},_dragStarted:function _dragStarted(fallback,evt){awaitingDragStarted=false;if(rootEl&&dragEl){pluginEvent2("dragStarted",this,{evt:evt});if(this.nativeDraggable){on2(document,"dragover",_checkOutsideTargetEl);}var options2=this.options;!fallback&&toggleClass(dragEl,options2.dragClass,false);toggleClass(dragEl,options2.ghostClass,true);Sortable.active=this;fallback&&this._appendGhost();_dispatchEvent({sortable:this,name:"start",originalEvent:evt});}else{this._nulling();}},_emulateDragOver:function _emulateDragOver(){if(touchEvt){this._lastX=touchEvt.clientX;this._lastY=touchEvt.clientY;_hideGhostForTarget();var target=document.elementFromPoint(touchEvt.clientX,touchEvt.clientY);var parent=target;while(target&&target.shadowRoot){target=target.shadowRoot.elementFromPoint(touchEvt.clientX,touchEvt.clientY);if(target===parent)break;parent=target;}dragEl.parentNode[expando]._isOutsideThisEl(target);if(parent){do{if(parent[expando]){var inserted=void 0;inserted=parent[expando]._onDragOver({clientX:touchEvt.clientX,clientY:touchEvt.clientY,target:target,rootEl:parent});if(inserted&&!this.options.dragoverBubble){break;}}target=parent;}while(parent=parent.parentNode);}_unhideGhostForTarget();}},_onTouchMove:function _onTouchMove(evt){if(tapEvt){var options2=this.options,fallbackTolerance=options2.fallbackTolerance,fallbackOffset=options2.fallbackOffset,touch=evt.touches?evt.touches[0]:evt,ghostMatrix=ghostEl&&matrix(ghostEl,true),scaleX=ghostEl&&ghostMatrix&&ghostMatrix.a,scaleY=ghostEl&&ghostMatrix&&ghostMatrix.d,relativeScrollOffset=PositionGhostAbsolutely&&ghostRelativeParent&&getRelativeScrollOffset(ghostRelativeParent),dx=(touch.clientX-tapEvt.clientX+fallbackOffset.x)/(scaleX||1)+(relativeScrollOffset?relativeScrollOffset[0]-ghostRelativeParentInitialScroll[0]:0)/(scaleX||1),dy=(touch.clientY-tapEvt.clientY+fallbackOffset.y)/(scaleY||1)+(relativeScrollOffset?relativeScrollOffset[1]-ghostRelativeParentInitialScroll[1]:0)/(scaleY||1);if(!Sortable.active&&!awaitingDragStarted){if(fallbackTolerance&&Math.max(Math.abs(touch.clientX-this._lastX),Math.abs(touch.clientY-this._lastY))<fallbackTolerance){return;}this._onDragStart(evt,true);}if(ghostEl){if(ghostMatrix){ghostMatrix.e+=dx-(lastDx||0);ghostMatrix.f+=dy-(lastDy||0);}else{ghostMatrix={a:1,b:0,c:0,d:1,e:dx,f:dy};}var cssMatrix="matrix(".concat(ghostMatrix.a,",").concat(ghostMatrix.b,",").concat(ghostMatrix.c,",").concat(ghostMatrix.d,",").concat(ghostMatrix.e,",").concat(ghostMatrix.f,")");css(ghostEl,"webkitTransform",cssMatrix);css(ghostEl,"mozTransform",cssMatrix);css(ghostEl,"msTransform",cssMatrix);css(ghostEl,"transform",cssMatrix);lastDx=dx;lastDy=dy;touchEvt=touch;}evt.cancelable&&evt.preventDefault();}},_appendGhost:function _appendGhost(){if(!ghostEl){var container=this.options.fallbackOnBody?document.body:rootEl,rect=getRect(dragEl,true,PositionGhostAbsolutely,true,container),options2=this.options;if(PositionGhostAbsolutely){ghostRelativeParent=container;while(css(ghostRelativeParent,"position")==="static"&&css(ghostRelativeParent,"transform")==="none"&&ghostRelativeParent!==document){ghostRelativeParent=ghostRelativeParent.parentNode;}if(ghostRelativeParent!==document.body&&ghostRelativeParent!==document.documentElement){if(ghostRelativeParent===document)ghostRelativeParent=getWindowScrollingElement();rect.top+=ghostRelativeParent.scrollTop;rect.left+=ghostRelativeParent.scrollLeft;}else{ghostRelativeParent=getWindowScrollingElement();}ghostRelativeParentInitialScroll=getRelativeScrollOffset(ghostRelativeParent);}ghostEl=dragEl.cloneNode(true);toggleClass(ghostEl,options2.ghostClass,false);toggleClass(ghostEl,options2.fallbackClass,true);toggleClass(ghostEl,options2.dragClass,true);css(ghostEl,"transition","");css(ghostEl,"transform","");css(ghostEl,"box-sizing","border-box");css(ghostEl,"margin",0);css(ghostEl,"top",rect.top);css(ghostEl,"left",rect.left);css(ghostEl,"width",rect.width);css(ghostEl,"height",rect.height);css(ghostEl,"opacity","0.8");css(ghostEl,"position",PositionGhostAbsolutely?"absolute":"fixed");css(ghostEl,"zIndex","100000");css(ghostEl,"pointerEvents","none");Sortable.ghost=ghostEl;container.appendChild(ghostEl);css(ghostEl,"transform-origin",tapDistanceLeft/parseInt(ghostEl.style.width)*100+"% "+tapDistanceTop/parseInt(ghostEl.style.height)*100+"%");}},_onDragStart:function _onDragStart(evt,fallback){var _this=this;var dataTransfer=evt.dataTransfer;var options2=_this.options;pluginEvent2("dragStart",this,{evt:evt});if(Sortable.eventCanceled){this._onDrop();return;}pluginEvent2("setupClone",this);if(!Sortable.eventCanceled){cloneEl=clone2(dragEl);cloneEl.removeAttribute("id");cloneEl.draggable=false;cloneEl.style["will-change"]="";this._hideClone();toggleClass(cloneEl,this.options.chosenClass,false);Sortable.clone=cloneEl;}_this.cloneId=_nextTick(function(){pluginEvent2("clone",_this);if(Sortable.eventCanceled)return;if(!_this.options.removeCloneOnHide){rootEl.insertBefore(cloneEl,dragEl);}_this._hideClone();_dispatchEvent({sortable:_this,name:"clone"});});!fallback&&toggleClass(dragEl,options2.dragClass,true);if(fallback){ignoreNextClick=true;_this._loopId=setInterval(_this._emulateDragOver,50);}else{off(document,"mouseup",_this._onDrop);off(document,"touchend",_this._onDrop);off(document,"touchcancel",_this._onDrop);if(dataTransfer){dataTransfer.effectAllowed="move";options2.setData&&options2.setData.call(_this,dataTransfer,dragEl);}on2(document,"drop",_this);css(dragEl,"transform","translateZ(0)");}awaitingDragStarted=true;_this._dragStartId=_nextTick(_this._dragStarted.bind(_this,fallback,evt));on2(document,"selectstart",_this);moved=true;if(Safari){css(document.body,"user-select","none");}},_onDragOver:function _onDragOver(evt){var el=this.el,target=evt.target,dragRect,targetRect,revert,options2=this.options,group=options2.group,activeSortable=Sortable.active,isOwner=activeGroup===group,canSort=options2.sort,fromSortable=putSortable||activeSortable,vertical,_this=this,completedFired=false;if(_silent)return;function dragOverEvent(name2,extra){pluginEvent2(name2,_this,_objectSpread2({evt:evt,isOwner:isOwner,axis:vertical?"vertical":"horizontal",revert:revert,dragRect:dragRect,targetRect:targetRect,canSort:canSort,fromSortable:fromSortable,target:target,completed:completed,onMove:function onMove(target2,after2){return _onMove(rootEl,el,dragEl,dragRect,target2,getRect(target2),evt,after2);},changed:changed},extra));}function capture(){dragOverEvent("dragOverAnimationCapture");_this.captureAnimationState();if(_this!==fromSortable){fromSortable.captureAnimationState();}}function completed(insertion){dragOverEvent("dragOverCompleted",{insertion:insertion});if(insertion){if(isOwner){activeSortable._hideClone();}else{activeSortable._showClone(_this);}if(_this!==fromSortable){toggleClass(dragEl,putSortable?putSortable.options.ghostClass:activeSortable.options.ghostClass,false);toggleClass(dragEl,options2.ghostClass,true);}if(putSortable!==_this&&_this!==Sortable.active){putSortable=_this;}else if(_this===Sortable.active&&putSortable){putSortable=null;}if(fromSortable===_this){_this._ignoreWhileAnimating=target;}_this.animateAll(function(){dragOverEvent("dragOverAnimationComplete");_this._ignoreWhileAnimating=null;});if(_this!==fromSortable){fromSortable.animateAll();fromSortable._ignoreWhileAnimating=null;}}if(target===dragEl&&!dragEl.animated||target===el&&!target.animated){lastTarget=null;}if(!options2.dragoverBubble&&!evt.rootEl&&target!==document){dragEl.parentNode[expando]._isOutsideThisEl(evt.target);!insertion&&nearestEmptyInsertDetectEvent(evt);}!options2.dragoverBubble&&evt.stopPropagation&&evt.stopPropagation();return completedFired=true;}function changed(){newIndex=index(dragEl);newDraggableIndex=index(dragEl,options2.draggable);_dispatchEvent({sortable:_this,name:"change",toEl:el,newIndex:newIndex,newDraggableIndex:newDraggableIndex,originalEvent:evt});}if(evt.preventDefault!==void 0){evt.cancelable&&evt.preventDefault();}target=closest(target,options2.draggable,el,true);dragOverEvent("dragOver");if(Sortable.eventCanceled)return completedFired;if(dragEl.contains(evt.target)||target.animated&&target.animatingX&&target.animatingY||_this._ignoreWhileAnimating===target){return completed(false);}ignoreNextClick=false;if(activeSortable&&!options2.disabled&&(isOwner?canSort||(revert=parentEl!==rootEl):putSortable===this||(this.lastPutMode=activeGroup.checkPull(this,activeSortable,dragEl,evt))&&group.checkPut(this,activeSortable,dragEl,evt))){vertical=this._getDirection(evt,target)==="vertical";dragRect=getRect(dragEl);dragOverEvent("dragOverValid");if(Sortable.eventCanceled)return completedFired;if(revert){parentEl=rootEl;capture();this._hideClone();dragOverEvent("revert");if(!Sortable.eventCanceled){if(nextEl){rootEl.insertBefore(dragEl,nextEl);}else{rootEl.appendChild(dragEl);}}return completed(true);}var elLastChild=lastChild(el,options2.draggable);if(!elLastChild||_ghostIsLast(evt,vertical,this)&&!elLastChild.animated){if(elLastChild===dragEl){return completed(false);}if(elLastChild&&el===evt.target){target=elLastChild;}if(target){targetRect=getRect(target);}if(_onMove(rootEl,el,dragEl,dragRect,target,targetRect,evt,!!target)!==false){capture();if(elLastChild&&elLastChild.nextSibling){el.insertBefore(dragEl,elLastChild.nextSibling);}else{el.appendChild(dragEl);}parentEl=el;changed();return completed(true);}}else if(elLastChild&&_ghostIsFirst(evt,vertical,this)){var firstChild=getChild(el,0,options2,true);if(firstChild===dragEl){return completed(false);}target=firstChild;targetRect=getRect(target);if(_onMove(rootEl,el,dragEl,dragRect,target,targetRect,evt,false)!==false){capture();el.insertBefore(dragEl,firstChild);parentEl=el;changed();return completed(true);}}else if(target.parentNode===el){targetRect=getRect(target);var direction=0,targetBeforeFirstSwap,differentLevel=dragEl.parentNode!==el,differentRowCol=!_dragElInRowColumn(dragEl.animated&&dragEl.toRect||dragRect,target.animated&&target.toRect||targetRect,vertical),side1=vertical?"top":"left",scrolledPastTop=isScrolledPast(target,"top","top")||isScrolledPast(dragEl,"top","top"),scrollBefore=scrolledPastTop?scrolledPastTop.scrollTop:void 0;if(lastTarget!==target){targetBeforeFirstSwap=targetRect[side1];pastFirstInvertThresh=false;isCircumstantialInvert=!differentRowCol&&options2.invertSwap||differentLevel;}direction=_getSwapDirection(evt,target,targetRect,vertical,differentRowCol?1:options2.swapThreshold,options2.invertedSwapThreshold==null?options2.swapThreshold:options2.invertedSwapThreshold,isCircumstantialInvert,lastTarget===target);var sibling;if(direction!==0){var dragIndex=index(dragEl);do{dragIndex-=direction;sibling=parentEl.children[dragIndex];}while(sibling&&(css(sibling,"display")==="none"||sibling===ghostEl));}if(direction===0||sibling===target){return completed(false);}lastTarget=target;lastDirection=direction;var nextSibling=target.nextElementSibling,after=false;after=direction===1;var moveVector=_onMove(rootEl,el,dragEl,dragRect,target,targetRect,evt,after);if(moveVector!==false){if(moveVector===1||moveVector===-1){after=moveVector===1;}_silent=true;setTimeout(_unsilent,30);capture();if(after&&!nextSibling){el.appendChild(dragEl);}else{target.parentNode.insertBefore(dragEl,after?nextSibling:target);}if(scrolledPastTop){scrollBy(scrolledPastTop,0,scrollBefore-scrolledPastTop.scrollTop);}parentEl=dragEl.parentNode;if(targetBeforeFirstSwap!==void 0&&!isCircumstantialInvert){targetMoveDistance=Math.abs(targetBeforeFirstSwap-getRect(target)[side1]);}changed();return completed(true);}}if(el.contains(dragEl)){return completed(false);}}return false;},_ignoreWhileAnimating:null,_offMoveEvents:function _offMoveEvents(){off(document,"mousemove",this._onTouchMove);off(document,"touchmove",this._onTouchMove);off(document,"pointermove",this._onTouchMove);off(document,"dragover",nearestEmptyInsertDetectEvent);off(document,"mousemove",nearestEmptyInsertDetectEvent);off(document,"touchmove",nearestEmptyInsertDetectEvent);},_offUpEvents:function _offUpEvents(){var ownerDocument=this.el.ownerDocument;off(ownerDocument,"mouseup",this._onDrop);off(ownerDocument,"touchend",this._onDrop);off(ownerDocument,"pointerup",this._onDrop);off(ownerDocument,"touchcancel",this._onDrop);off(document,"selectstart",this);},_onDrop:function _onDrop(evt){var el=this.el,options2=this.options;newIndex=index(dragEl);newDraggableIndex=index(dragEl,options2.draggable);pluginEvent2("drop",this,{evt:evt});parentEl=dragEl&&dragEl.parentNode;newIndex=index(dragEl);newDraggableIndex=index(dragEl,options2.draggable);if(Sortable.eventCanceled){this._nulling();return;}awaitingDragStarted=false;isCircumstantialInvert=false;pastFirstInvertThresh=false;clearInterval(this._loopId);clearTimeout(this._dragStartTimer);_cancelNextTick(this.cloneId);_cancelNextTick(this._dragStartId);if(this.nativeDraggable){off(document,"drop",this);off(el,"dragstart",this._onDragStart);}this._offMoveEvents();this._offUpEvents();if(Safari){css(document.body,"user-select","");}css(dragEl,"transform","");if(evt){if(moved){evt.cancelable&&evt.preventDefault();!options2.dropBubble&&evt.stopPropagation();}ghostEl&&ghostEl.parentNode&&ghostEl.parentNode.removeChild(ghostEl);if(rootEl===parentEl||putSortable&&putSortable.lastPutMode!=="clone"){cloneEl&&cloneEl.parentNode&&cloneEl.parentNode.removeChild(cloneEl);}if(dragEl){if(this.nativeDraggable){off(dragEl,"dragend",this);}_disableDraggable(dragEl);dragEl.style["will-change"]="";if(moved&&!awaitingDragStarted){toggleClass(dragEl,putSortable?putSortable.options.ghostClass:this.options.ghostClass,false);}toggleClass(dragEl,this.options.chosenClass,false);_dispatchEvent({sortable:this,name:"unchoose",toEl:parentEl,newIndex:null,newDraggableIndex:null,originalEvent:evt});if(rootEl!==parentEl){if(newIndex>=0){_dispatchEvent({rootEl:parentEl,name:"add",toEl:parentEl,fromEl:rootEl,originalEvent:evt});_dispatchEvent({sortable:this,name:"remove",toEl:parentEl,originalEvent:evt});_dispatchEvent({rootEl:parentEl,name:"sort",toEl:parentEl,fromEl:rootEl,originalEvent:evt});_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:evt});}putSortable&&putSortable.save();}else{if(newIndex!==oldIndex){if(newIndex>=0){_dispatchEvent({sortable:this,name:"update",toEl:parentEl,originalEvent:evt});_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:evt});}}}if(Sortable.active){if(newIndex==null||newIndex===-1){newIndex=oldIndex;newDraggableIndex=oldDraggableIndex;}_dispatchEvent({sortable:this,name:"end",toEl:parentEl,originalEvent:evt});this.save();}}}this._nulling();},_nulling:function _nulling(){pluginEvent2("nulling",this);rootEl=dragEl=parentEl=ghostEl=nextEl=cloneEl=lastDownEl=cloneHidden=tapEvt=touchEvt=moved=newIndex=newDraggableIndex=oldIndex=oldDraggableIndex=lastTarget=lastDirection=putSortable=activeGroup=Sortable.dragged=Sortable.ghost=Sortable.clone=Sortable.active=null;savedInputChecked.forEach(function(el){el.checked=true;});savedInputChecked.length=lastDx=lastDy=0;},handleEvent:function handleEvent(evt){switch(evt.type){case"drop":case"dragend":this._onDrop(evt);break;case"dragenter":case"dragover":if(dragEl){this._onDragOver(evt);_globalDragOver(evt);}break;case"selectstart":evt.preventDefault();break;}},toArray:function toArray2(){var order=[],el,children=this.el.children,i=0,n2=children.length,options2=this.options;for(;i<n2;i++){el=children[i];if(closest(el,options2.draggable,this.el,false)){order.push(el.getAttribute(options2.dataIdAttr)||_generateId(el));}}return order;},sort:function sort(order,useAnimation){var items={},rootEl2=this.el;this.toArray().forEach(function(id,i){var el=rootEl2.children[i];if(closest(el,this.options.draggable,rootEl2,false)){items[id]=el;}},this);useAnimation&&this.captureAnimationState();order.forEach(function(id){if(items[id]){rootEl2.removeChild(items[id]);rootEl2.appendChild(items[id]);}});useAnimation&&this.animateAll();},save:function save(){var store=this.options.store;store&&store.set&&store.set(this);},closest:function closest$1(el,selector){return closest(el,selector||this.options.draggable,this.el,false);},option:function option2(name2,value){var options2=this.options;if(value===void 0){return options2[name2];}else{var modifiedValue=PluginManager.modifyOption(this,name2,value);if(typeof modifiedValue!=="undefined"){options2[name2]=modifiedValue;}else{options2[name2]=value;}if(name2==="group"){_prepareGroup(options2);}}},destroy:function destroy2(){pluginEvent2("destroy",this);var el=this.el;el[expando]=null;off(el,"mousedown",this._onTapStart);off(el,"touchstart",this._onTapStart);off(el,"pointerdown",this._onTapStart);if(this.nativeDraggable){off(el,"dragover",this);off(el,"dragenter",this);}Array.prototype.forEach.call(el.querySelectorAll("[draggable]"),function(el2){el2.removeAttribute("draggable");});this._onDrop();this._disableDelayedDragEvents();sortables.splice(sortables.indexOf(this.el),1);this.el=el=null;},_hideClone:function _hideClone(){if(!cloneHidden){pluginEvent2("hideClone",this);if(Sortable.eventCanceled)return;css(cloneEl,"display","none");if(this.options.removeCloneOnHide&&cloneEl.parentNode){cloneEl.parentNode.removeChild(cloneEl);}cloneHidden=true;}},_showClone:function _showClone(putSortable2){if(putSortable2.lastPutMode!=="clone"){this._hideClone();return;}if(cloneHidden){pluginEvent2("showClone",this);if(Sortable.eventCanceled)return;if(dragEl.parentNode==rootEl&&!this.options.group.revertClone){rootEl.insertBefore(cloneEl,dragEl);}else if(nextEl){rootEl.insertBefore(cloneEl,nextEl);}else{rootEl.appendChild(cloneEl);}if(this.options.group.revertClone){this.animate(dragEl,cloneEl);}css(cloneEl,"display","");cloneHidden=false;}}};function _globalDragOver(evt){if(evt.dataTransfer){evt.dataTransfer.dropEffect="move";}evt.cancelable&&evt.preventDefault();}function _onMove(fromEl,toEl,dragEl2,dragRect,targetEl,targetRect,originalEvent,willInsertAfter){var evt,sortable=fromEl[expando],onMoveFn=sortable.options.onMove,retVal;if(window.CustomEvent&&!IE11OrLess&&!Edge){evt=new CustomEvent("move",{bubbles:true,cancelable:true});}else{evt=document.createEvent("Event");evt.initEvent("move",true,true);}evt.to=toEl;evt.from=fromEl;evt.dragged=dragEl2;evt.draggedRect=dragRect;evt.related=targetEl||toEl;evt.relatedRect=targetRect||getRect(toEl);evt.willInsertAfter=willInsertAfter;evt.originalEvent=originalEvent;fromEl.dispatchEvent(evt);if(onMoveFn){retVal=onMoveFn.call(sortable,evt,originalEvent);}return retVal;}function _disableDraggable(el){el.draggable=false;}function _unsilent(){_silent=false;}function _ghostIsFirst(evt,vertical,sortable){var rect=getRect(getChild(sortable.el,0,sortable.options,true));var spacer=10;return vertical?evt.clientX<rect.left-spacer||evt.clientY<rect.top&&evt.clientX<rect.right:evt.clientY<rect.top-spacer||evt.clientY<rect.bottom&&evt.clientX<rect.left;}function _ghostIsLast(evt,vertical,sortable){var rect=getRect(lastChild(sortable.el,sortable.options.draggable));var spacer=10;return vertical?evt.clientX>rect.right+spacer||evt.clientX<=rect.right&&evt.clientY>rect.bottom&&evt.clientX>=rect.left:evt.clientX>rect.right&&evt.clientY>rect.top||evt.clientX<=rect.right&&evt.clientY>rect.bottom+spacer;}function _getSwapDirection(evt,target,targetRect,vertical,swapThreshold,invertedSwapThreshold,invertSwap,isLastTarget){var mouseOnAxis=vertical?evt.clientY:evt.clientX,targetLength=vertical?targetRect.height:targetRect.width,targetS1=vertical?targetRect.top:targetRect.left,targetS2=vertical?targetRect.bottom:targetRect.right,invert=false;if(!invertSwap){if(isLastTarget&&targetMoveDistance<targetLength*swapThreshold){if(!pastFirstInvertThresh&&(lastDirection===1?mouseOnAxis>targetS1+targetLength*invertedSwapThreshold/2:mouseOnAxis<targetS2-targetLength*invertedSwapThreshold/2)){pastFirstInvertThresh=true;}if(!pastFirstInvertThresh){if(lastDirection===1?mouseOnAxis<targetS1+targetMoveDistance:mouseOnAxis>targetS2-targetMoveDistance){return-lastDirection;}}else{invert=true;}}else{if(mouseOnAxis>targetS1+targetLength*(1-swapThreshold)/2&&mouseOnAxis<targetS2-targetLength*(1-swapThreshold)/2){return _getInsertDirection(target);}}}invert=invert||invertSwap;if(invert){if(mouseOnAxis<targetS1+targetLength*invertedSwapThreshold/2||mouseOnAxis>targetS2-targetLength*invertedSwapThreshold/2){return mouseOnAxis>targetS1+targetLength/2?1:-1;}}return 0;}function _getInsertDirection(target){if(index(dragEl)<index(target)){return 1;}else{return-1;}}function _generateId(el){var str=el.tagName+el.className+el.src+el.href+el.textContent,i=str.length,sum=0;while(i--){sum+=str.charCodeAt(i);}return sum.toString(36);}function _saveInputCheckedState(root2){savedInputChecked.length=0;var inputs=root2.getElementsByTagName("input");var idx=inputs.length;while(idx--){var el=inputs[idx];el.checked&&savedInputChecked.push(el);}}function _nextTick(fn2){return setTimeout(fn2,0);}function _cancelNextTick(id){return clearTimeout(id);}if(documentExists){on2(document,"touchmove",function(evt){if((Sortable.active||awaitingDragStarted)&&evt.cancelable){evt.preventDefault();}});}Sortable.utils={on:on2,off:off,css:css,find:find2,is:function is(el,selector){return!!closest(el,selector,el,false);},extend:extend,throttle:throttle,closest:closest,toggleClass:toggleClass,clone:clone2,index:index,nextTick:_nextTick,cancelNextTick:_cancelNextTick,detectDirection:_detectDirection,getChild:getChild};Sortable.get=function(element){return element[expando];};Sortable.mount=function(){for(var _len=arguments.length,plugins2=new Array(_len),_key=0;_key<_len;_key++){plugins2[_key]=arguments[_key];}if(plugins2[0].constructor===Array)plugins2=plugins2[0];plugins2.forEach(function(plugin9){if(!plugin9.prototype||!plugin9.prototype.constructor){throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(plugin9));}if(plugin9.utils)Sortable.utils=_objectSpread2(_objectSpread2({},Sortable.utils),plugin9.utils);PluginManager.mount(plugin9);});};Sortable.create=function(el,options2){return new Sortable(el,options2);};Sortable.version=version;var autoScrolls=[];var scrollEl;var scrollRootEl;var scrolling=false;var lastAutoScrollX;var lastAutoScrollY;var touchEvt$1;var pointerElemChangedInterval;function AutoScrollPlugin(){function AutoScroll(){this.defaults={scroll:true,forceAutoScrollFallback:false,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:true};for(var fn2 in this){if(fn2.charAt(0)==="_"&&typeof this[fn2]==="function"){this[fn2]=this[fn2].bind(this);}}}AutoScroll.prototype={dragStarted:function dragStarted(_ref2){var originalEvent=_ref2.originalEvent;if(this.sortable.nativeDraggable){on2(document,"dragover",this._handleAutoScroll);}else{if(this.options.supportPointer){on2(document,"pointermove",this._handleFallbackAutoScroll);}else if(originalEvent.touches){on2(document,"touchmove",this._handleFallbackAutoScroll);}else{on2(document,"mousemove",this._handleFallbackAutoScroll);}}},dragOverCompleted:function dragOverCompleted(_ref2){var originalEvent=_ref2.originalEvent;if(!this.options.dragOverBubble&&!originalEvent.rootEl){this._handleAutoScroll(originalEvent);}},drop:function drop4(){if(this.sortable.nativeDraggable){off(document,"dragover",this._handleAutoScroll);}else{off(document,"pointermove",this._handleFallbackAutoScroll);off(document,"touchmove",this._handleFallbackAutoScroll);off(document,"mousemove",this._handleFallbackAutoScroll);}clearPointerElemChangedInterval();clearAutoScrolls();cancelThrottle();},nulling:function nulling(){touchEvt$1=scrollRootEl=scrollEl=scrolling=pointerElemChangedInterval=lastAutoScrollX=lastAutoScrollY=null;autoScrolls.length=0;},_handleFallbackAutoScroll:function _handleFallbackAutoScroll(evt){this._handleAutoScroll(evt,true);},_handleAutoScroll:function _handleAutoScroll(evt,fallback){var _this=this;var x=(evt.touches?evt.touches[0]:evt).clientX,y=(evt.touches?evt.touches[0]:evt).clientY,elem=document.elementFromPoint(x,y);touchEvt$1=evt;if(fallback||this.options.forceAutoScrollFallback||Edge||IE11OrLess||Safari){autoScroll(evt,this.options,elem,fallback);var ogElemScroller=getParentAutoScrollElement(elem,true);if(scrolling&&(!pointerElemChangedInterval||x!==lastAutoScrollX||y!==lastAutoScrollY)){pointerElemChangedInterval&&clearPointerElemChangedInterval();pointerElemChangedInterval=setInterval(function(){var newElem=getParentAutoScrollElement(document.elementFromPoint(x,y),true);if(newElem!==ogElemScroller){ogElemScroller=newElem;clearAutoScrolls();}autoScroll(evt,_this.options,newElem,fallback);},10);lastAutoScrollX=x;lastAutoScrollY=y;}}else{if(!this.options.bubbleScroll||getParentAutoScrollElement(elem,true)===getWindowScrollingElement()){clearAutoScrolls();return;}autoScroll(evt,this.options,getParentAutoScrollElement(elem,false),false);}}};return _extends(AutoScroll,{pluginName:"scroll",initializeByDefault:true});}function clearAutoScrolls(){autoScrolls.forEach(function(autoScroll2){clearInterval(autoScroll2.pid);});autoScrolls=[];}function clearPointerElemChangedInterval(){clearInterval(pointerElemChangedInterval);}var autoScroll=throttle(function(evt,options2,rootEl2,isFallback){if(!options2.scroll)return;var x=(evt.touches?evt.touches[0]:evt).clientX,y=(evt.touches?evt.touches[0]:evt).clientY,sens=options2.scrollSensitivity,speed=options2.scrollSpeed,winScroller=getWindowScrollingElement();var scrollThisInstance=false,scrollCustomFn;if(scrollRootEl!==rootEl2){scrollRootEl=rootEl2;clearAutoScrolls();scrollEl=options2.scroll;scrollCustomFn=options2.scrollFn;if(scrollEl===true){scrollEl=getParentAutoScrollElement(rootEl2,true);}}var layersOut=0;var currentParent=scrollEl;do{var el=currentParent,rect=getRect(el),top=rect.top,bottom=rect.bottom,left=rect.left,right=rect.right,width=rect.width,height=rect.height,canScrollX=void 0,canScrollY=void 0,scrollWidth=el.scrollWidth,scrollHeight=el.scrollHeight,elCSS=css(el),scrollPosX=el.scrollLeft,scrollPosY=el.scrollTop;if(el===winScroller){canScrollX=width<scrollWidth&&(elCSS.overflowX==="auto"||elCSS.overflowX==="scroll"||elCSS.overflowX==="visible");canScrollY=height<scrollHeight&&(elCSS.overflowY==="auto"||elCSS.overflowY==="scroll"||elCSS.overflowY==="visible");}else{canScrollX=width<scrollWidth&&(elCSS.overflowX==="auto"||elCSS.overflowX==="scroll");canScrollY=height<scrollHeight&&(elCSS.overflowY==="auto"||elCSS.overflowY==="scroll");}var vx=canScrollX&&(Math.abs(right-x)<=sens&&scrollPosX+width<scrollWidth)-(Math.abs(left-x)<=sens&&!!scrollPosX);var vy=canScrollY&&(Math.abs(bottom-y)<=sens&&scrollPosY+height<scrollHeight)-(Math.abs(top-y)<=sens&&!!scrollPosY);if(!autoScrolls[layersOut]){for(var i=0;i<=layersOut;i++){if(!autoScrolls[i]){autoScrolls[i]={};}}}if(autoScrolls[layersOut].vx!=vx||autoScrolls[layersOut].vy!=vy||autoScrolls[layersOut].el!==el){autoScrolls[layersOut].el=el;autoScrolls[layersOut].vx=vx;autoScrolls[layersOut].vy=vy;clearInterval(autoScrolls[layersOut].pid);if(vx!=0||vy!=0){scrollThisInstance=true;autoScrolls[layersOut].pid=setInterval(function(){if(isFallback&&this.layer===0){Sortable.active._onTouchMove(touchEvt$1);}var scrollOffsetY=autoScrolls[this.layer].vy?autoScrolls[this.layer].vy*speed:0;var scrollOffsetX=autoScrolls[this.layer].vx?autoScrolls[this.layer].vx*speed:0;if(typeof scrollCustomFn==="function"){if(scrollCustomFn.call(Sortable.dragged.parentNode[expando],scrollOffsetX,scrollOffsetY,evt,touchEvt$1,autoScrolls[this.layer].el)!=="continue"){return;}}scrollBy(autoScrolls[this.layer].el,scrollOffsetX,scrollOffsetY);}.bind({layer:layersOut}),24);}}layersOut++;}while(options2.bubbleScroll&&currentParent!==winScroller&&(currentParent=getParentAutoScrollElement(currentParent,false)));scrolling=scrollThisInstance;},30);var drop2=function drop3(_ref2){var originalEvent=_ref2.originalEvent,putSortable2=_ref2.putSortable,dragEl2=_ref2.dragEl,activeSortable=_ref2.activeSortable,dispatchSortableEvent=_ref2.dispatchSortableEvent,hideGhostForTarget=_ref2.hideGhostForTarget,unhideGhostForTarget=_ref2.unhideGhostForTarget;if(!originalEvent)return;var toSortable=putSortable2||activeSortable;hideGhostForTarget();var touch=originalEvent.changedTouches&&originalEvent.changedTouches.length?originalEvent.changedTouches[0]:originalEvent;var target=document.elementFromPoint(touch.clientX,touch.clientY);unhideGhostForTarget();if(toSortable&&!toSortable.el.contains(target)){dispatchSortableEvent("spill");this.onSpill({dragEl:dragEl2,putSortable:putSortable2});}};function Revert(){}Revert.prototype={startIndex:null,dragStart:function dragStart(_ref2){var oldDraggableIndex2=_ref2.oldDraggableIndex;this.startIndex=oldDraggableIndex2;},onSpill:function onSpill(_ref3){var dragEl2=_ref3.dragEl,putSortable2=_ref3.putSortable;this.sortable.captureAnimationState();if(putSortable2){putSortable2.captureAnimationState();}var nextSibling=getChild(this.sortable.el,this.startIndex,this.options);if(nextSibling){this.sortable.el.insertBefore(dragEl2,nextSibling);}else{this.sortable.el.appendChild(dragEl2);}this.sortable.animateAll();if(putSortable2){putSortable2.animateAll();}},drop:drop2};_extends(Revert,{pluginName:"revertOnSpill"});function Remove(){}Remove.prototype={onSpill:function onSpill2(_ref4){var dragEl2=_ref4.dragEl,putSortable2=_ref4.putSortable;var parentSortable=putSortable2||this.sortable;parentSortable.captureAnimationState();dragEl2.parentNode&&dragEl2.parentNode.removeChild(dragEl2);parentSortable.animateAll();},drop:drop2};_extends(Remove,{pluginName:"removeOnSpill"});Sortable.mount(new AutoScrollPlugin());Sortable.mount(Remove,Revert);var sortable_esm_default=Sortable;// packages/forms/resources/js/sortable.js
window.Sortable=sortable_esm_default;window.Livewire.directive("sortable",function(el){el.sortable=sortable_esm_default.create(el,{draggable:"[wire\\:sortable\\.item]",handle:"[wire\\:sortable\\.handle]",dataIdAttr:"wire:sortable.item"});});var sortable_default=function sortable_default(Alpine){Alpine.directive("sortable",function(el){el.sortable=sortable_esm_default.create(el,{draggable:"[x-sortable-item]",handle:"[x-sortable-handle]",dataIdAttr:"x-sortable-item"});});};// node_modules/@awcodes/alpine-floating-ui/dist/module.esm.js
function getSide(placement){return placement.split("-")[0];}function getAlignment(placement){return placement.split("-")[1];}function getMainAxisFromPlacement(placement){return["top","bottom"].includes(getSide(placement))?"x":"y";}function getLengthFromAxis(axis){return axis==="y"?"height":"width";}function computeCoordsFromPlacement(_ref2,placement,rtl){var reference=_ref2.reference,floating=_ref2.floating;var commonX=reference.x+reference.width/2-floating.width/2;var commonY=reference.y+reference.height/2-floating.height/2;var mainAxis=getMainAxisFromPlacement(placement);var length=getLengthFromAxis(mainAxis);var commonAlign=reference[length]/2-floating[length]/2;var side=getSide(placement);var isVertical=mainAxis==="x";var coords;switch(side){case"top":coords={x:commonX,y:reference.y-floating.height};break;case"bottom":coords={x:commonX,y:reference.y+reference.height};break;case"right":coords={x:reference.x+reference.width,y:commonY};break;case"left":coords={x:reference.x-floating.width,y:commonY};break;default:coords={x:reference.x,y:reference.y};}switch(getAlignment(placement)){case"start":coords[mainAxis]-=commonAlign*(rtl&&isVertical?-1:1);break;case"end":coords[mainAxis]+=commonAlign*(rtl&&isVertical?-1:1);break;}return coords;}var computePosition=/*#__PURE__*/function(){var _ref229=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee23(reference,floating,config){var _config$placement,placement,_config$strategy,strategy,_config$middleware,middleware,platform2,rtl,rects,_computeCoordsFromPla,x,y,statefulPlacement,middlewareData,_debug_loop_count_,i,_middleware$i,name2,fn2,_yield$fn,nextX,nextY,data3,reset,_computeCoordsFromPla2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:_config$placement=config.placement,placement=_config$placement===void 0?"bottom":_config$placement,_config$strategy=config.strategy,strategy=_config$strategy===void 0?"absolute":_config$strategy,_config$middleware=config.middleware,middleware=_config$middleware===void 0?[]:_config$middleware,platform2=config.platform;_context23.next=3;return platform2.isRTL==null?void 0:platform2.isRTL(floating);case 3:rtl=_context23.sent;if(false){}if(platform2==null){console.error(["Floating UI: `platform` property was not passed to config. If you","want to use Floating UI on the web, install @floating-ui/dom","instead of the /core package. Otherwise, you can create your own","`platform`: https://floating-ui.com/docs/platform"].join(" "));}if(!(middleware.filter(function(_ref2){var name2=_ref2.name;return name2==="autoPlacement"||name2==="flip";}).length>1)){_context23.next=8;break;}throw new Error(["Floating UI: duplicate `flip` and/or `autoPlacement`","middleware detected. This will lead to an infinite loop. Ensure only","one of either has been passed to the `middleware` array."].join(" "));case 8:_context23.next=10;return platform2.getElementRects({reference:reference,floating:floating,strategy:strategy});case 10:rects=_context23.sent;_computeCoordsFromPla=computeCoordsFromPlacement(rects,placement,rtl),x=_computeCoordsFromPla.x,y=_computeCoordsFromPla.y;statefulPlacement=placement;middlewareData={};_debug_loop_count_=0;i=0;case 16:if(!(i<middleware.length)){_context23.next=52;break;}if(false){}_debug_loop_count_++;if(!(_debug_loop_count_>100)){_context23.next=21;break;}throw new Error(["Floating UI: The middleware lifecycle appears to be","running in an infinite loop. This is usually caused by a `reset`","continually being returned without a break condition."].join(" "));case 21:_middleware$i=middleware[i],name2=_middleware$i.name,fn2=_middleware$i.fn;_context23.next=24;return fn2({x:x,y:y,initialPlacement:placement,placement:statefulPlacement,strategy:strategy,middlewareData:middlewareData,rects:rects,platform:platform2,elements:{reference:reference,floating:floating}});case 24:_yield$fn=_context23.sent;nextX=_yield$fn.x;nextY=_yield$fn.y;data3=_yield$fn.data;reset=_yield$fn.reset;x=nextX!=null?nextX:x;y=nextY!=null?nextY:y;middlewareData=_objectSpread(_objectSpread({},middlewareData),{},_defineProperty3({},name2,_objectSpread(_objectSpread({},middlewareData[name2]),data3)));if(!reset){_context23.next=49;break;}if(!(_typeof4(reset)==="object")){_context23.next=47;break;}if(reset.placement){statefulPlacement=reset.placement;}if(!reset.rects){_context23.next=44;break;}if(!(reset.rects===true)){_context23.next=42;break;}_context23.next=39;return platform2.getElementRects({reference:reference,floating:floating,strategy:strategy});case 39:_context23.t0=_context23.sent;_context23.next=43;break;case 42:_context23.t0=reset.rects;case 43:rects=_context23.t0;case 44:_computeCoordsFromPla2=computeCoordsFromPlacement(rects,statefulPlacement,rtl);x=_computeCoordsFromPla2.x;y=_computeCoordsFromPla2.y;case 47:i=-1;return _context23.abrupt("continue",49);case 49:i++;_context23.next=16;break;case 52:return _context23.abrupt("return",{x:x,y:y,placement:statefulPlacement,strategy:strategy,middlewareData:middlewareData});case 53:case"end":return _context23.stop();}}},_callee23);}));return function computePosition(_x19,_x20,_x21){return _ref229.apply(this,arguments);};}();function expandPaddingObject(padding){return _objectSpread({top:0,right:0,bottom:0,left:0},padding);}function getSideObjectFromPadding(padding){return typeof padding!=="number"?expandPaddingObject(padding):{top:padding,right:padding,bottom:padding,left:padding};}function rectToClientRect(rect){return _objectSpread(_objectSpread({},rect),{},{top:rect.y,left:rect.x,right:rect.x+rect.width,bottom:rect.y+rect.height});}function detectOverflow(_x22,_x23){return _detectOverflow.apply(this,arguments);}function _detectOverflow(){_detectOverflow=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee35(middlewareArguments,options2){var _await$platform$isEle,x,y,platform2,rects,elements,strategy,_options7,_options7$boundary,boundary,_options7$rootBoundar,rootBoundary,_options7$elementCont,elementContext,_options7$altBoundary,altBoundary,_options7$padding,padding,paddingObject,altContext,element,clippingClientRect,elementClientRect;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:if(options2===void 0){options2={};}x=middlewareArguments.x,y=middlewareArguments.y,platform2=middlewareArguments.platform,rects=middlewareArguments.rects,elements=middlewareArguments.elements,strategy=middlewareArguments.strategy;_options7=options2,_options7$boundary=_options7.boundary,boundary=_options7$boundary===void 0?"clippingAncestors":_options7$boundary,_options7$rootBoundar=_options7.rootBoundary,rootBoundary=_options7$rootBoundar===void 0?"viewport":_options7$rootBoundar,_options7$elementCont=_options7.elementContext,elementContext=_options7$elementCont===void 0?"floating":_options7$elementCont,_options7$altBoundary=_options7.altBoundary,altBoundary=_options7$altBoundary===void 0?false:_options7$altBoundary,_options7$padding=_options7.padding,padding=_options7$padding===void 0?0:_options7$padding;paddingObject=getSideObjectFromPadding(padding);altContext=elementContext==="floating"?"reference":"floating";element=elements[altBoundary?altContext:elementContext];_context35.t0=rectToClientRect;_context35.t1=platform2;_context35.next=10;return platform2.isElement==null?void 0:platform2.isElement(element);case 10:_context35.t2=_await$platform$isEle=_context35.sent;if(!(_context35.t2!=null)){_context35.next=15;break;}_context35.t3=_await$platform$isEle;_context35.next=16;break;case 15:_context35.t3=true;case 16:if(!_context35.t3){_context35.next=20;break;}_context35.t4=element;_context35.next=26;break;case 20:_context35.t5=element.contextElement;if(_context35.t5){_context35.next=25;break;}_context35.next=24;return platform2.getDocumentElement==null?void 0:platform2.getDocumentElement(elements.floating);case 24:_context35.t5=_context35.sent;case 25:_context35.t4=_context35.t5;case 26:_context35.t6=_context35.t4;_context35.t7=boundary;_context35.t8=rootBoundary;_context35.t9=strategy;_context35.t10={element:_context35.t6,boundary:_context35.t7,rootBoundary:_context35.t8,strategy:_context35.t9};_context35.next=33;return _context35.t1.getClippingRect.call(_context35.t1,_context35.t10);case 33:_context35.t11=_context35.sent;clippingClientRect=(0,_context35.t0)(_context35.t11);_context35.t12=rectToClientRect;if(!platform2.convertOffsetParentRelativeRectToViewportRelativeRect){_context35.next=49;break;}_context35.t14=platform2;_context35.t15=elementContext==="floating"?_objectSpread(_objectSpread({},rects.floating),{},{x:x,y:y}):rects.reference;_context35.next=41;return platform2.getOffsetParent==null?void 0:platform2.getOffsetParent(elements.floating);case 41:_context35.t16=_context35.sent;_context35.t17=strategy;_context35.t18={rect:_context35.t15,offsetParent:_context35.t16,strategy:_context35.t17};_context35.next=46;return _context35.t14.convertOffsetParentRelativeRectToViewportRelativeRect.call(_context35.t14,_context35.t18);case 46:_context35.t13=_context35.sent;_context35.next=50;break;case 49:_context35.t13=rects[elementContext];case 50:_context35.t19=_context35.t13;elementClientRect=(0,_context35.t12)(_context35.t19);return _context35.abrupt("return",{top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right});case 53:case"end":return _context35.stop();}}},_callee35);}));return _detectOverflow.apply(this,arguments);}var min=Math.min;var max=Math.max;function within(min$1,value,max$1){return max(min$1,min(value,max$1));}var arrow=function arrow(options2){return{name:"arrow",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee24(){var _data;var _ref230,element,_ref230$padding,padding,x,y,placement,rects,platform2,paddingObject,coords,axis,length,arrowDimensions,minProp,maxProp,endDiff,startDiff,arrowOffsetParent,clientSize,centerToReference,min3,max3,center2,offset2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:_ref230=options2!=null?options2:{},element=_ref230.element,_ref230$padding=_ref230.padding,padding=_ref230$padding===void 0?0:_ref230$padding;x=middlewareArguments.x,y=middlewareArguments.y,placement=middlewareArguments.placement,rects=middlewareArguments.rects,platform2=middlewareArguments.platform;if(!(element==null)){_context24.next=5;break;}if(true){console.warn("Floating UI: No `element` was passed to the `arrow` middleware.");}return _context24.abrupt("return",{});case 5:paddingObject=getSideObjectFromPadding(padding);coords={x:x,y:y};axis=getMainAxisFromPlacement(placement);length=getLengthFromAxis(axis);_context24.next=11;return platform2.getDimensions(element);case 11:arrowDimensions=_context24.sent;minProp=axis==="y"?"top":"left";maxProp=axis==="y"?"bottom":"right";endDiff=rects.reference[length]+rects.reference[axis]-coords[axis]-rects.floating[length];startDiff=coords[axis]-rects.reference[axis];_context24.next=18;return platform2.getOffsetParent==null?void 0:platform2.getOffsetParent(element);case 18:arrowOffsetParent=_context24.sent;clientSize=arrowOffsetParent?axis==="y"?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0;centerToReference=endDiff/2-startDiff/2;min3=paddingObject[minProp];max3=clientSize-arrowDimensions[length]-paddingObject[maxProp];center2=clientSize/2-arrowDimensions[length]/2+centerToReference;offset2=within(min3,center2,max3);return _context24.abrupt("return",{data:(_data={},_defineProperty3(_data,axis,offset2),_defineProperty3(_data,"centerOffset",center2-offset2),_data)});case 26:case"end":return _context24.stop();}}},_callee24);}))();}};};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,function(matched){return hash$1[matched];});}function getAlignmentSides(placement,rects,rtl){if(rtl===void 0){rtl=false;}var alignment=getAlignment(placement);var mainAxis=getMainAxisFromPlacement(placement);var length=getLengthFromAxis(mainAxis);var mainAlignmentSide=mainAxis==="x"?alignment===(rtl?"end":"start")?"right":"left":alignment==="start"?"bottom":"top";if(rects.reference[length]>rects.floating[length]){mainAlignmentSide=getOppositePlacement(mainAlignmentSide);}return{main:mainAlignmentSide,cross:getOppositePlacement(mainAlignmentSide)};}var hash={start:"end",end:"start"};function getOppositeAlignmentPlacement(placement){return placement.replace(/start|end/g,function(matched){return hash[matched];});}var sides=["top","right","bottom","left"];var allPlacements=/* @__PURE__ */sides.reduce(function(acc,side){return acc.concat(side,side+"-start",side+"-end");},[]);function getPlacementList(alignment,autoAlignment,allowedPlacements){var allowedPlacementsSortedByAlignment=alignment?[].concat(_toConsumableArray2(allowedPlacements.filter(function(placement){return getAlignment(placement)===alignment;})),_toConsumableArray2(allowedPlacements.filter(function(placement){return getAlignment(placement)!==alignment;}))):allowedPlacements.filter(function(placement){return getSide(placement)===placement;});return allowedPlacementsSortedByAlignment.filter(function(placement){if(alignment){return getAlignment(placement)===alignment||(autoAlignment?getOppositeAlignmentPlacement(placement)!==placement:false);}return true;});}var autoPlacement=function autoPlacement(options2){if(options2===void 0){options2={};}return{name:"autoPlacement",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee25(){var _middlewareData$autoP,_middlewareData$autoP2,_middlewareData$autoP3,_middlewareData$autoP4,_placementsSortedByLe,x,y,rects,middlewareData,placement,platform2,elements,_options,_options$alignment,alignment,_options$allowedPlace,allowedPlacements,_options$autoAlignmen,autoAlignment,detectOverflowOptions,placements,overflow,currentIndex,currentPlacement,_getAlignmentSides,main,cross,currentOverflows,allOverflows,nextPlacement,placementsSortedByLeastOverflow,placementThatFitsOnAllSides,resetPlacement;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:x=middlewareArguments.x,y=middlewareArguments.y,rects=middlewareArguments.rects,middlewareData=middlewareArguments.middlewareData,placement=middlewareArguments.placement,platform2=middlewareArguments.platform,elements=middlewareArguments.elements;_options=options2,_options$alignment=_options.alignment,alignment=_options$alignment===void 0?null:_options$alignment,_options$allowedPlace=_options.allowedPlacements,allowedPlacements=_options$allowedPlace===void 0?allPlacements:_options$allowedPlace,_options$autoAlignmen=_options.autoAlignment,autoAlignment=_options$autoAlignmen===void 0?true:_options$autoAlignmen,detectOverflowOptions=_objectWithoutProperties2(_options,_excluded8);placements=getPlacementList(alignment,autoAlignment,allowedPlacements);_context25.next=5;return detectOverflow(middlewareArguments,detectOverflowOptions);case 5:overflow=_context25.sent;currentIndex=(_middlewareData$autoP=(_middlewareData$autoP2=middlewareData.autoPlacement)==null?void 0:_middlewareData$autoP2.index)!=null?_middlewareData$autoP:0;currentPlacement=placements[currentIndex];if(!(currentPlacement==null)){_context25.next=10;break;}return _context25.abrupt("return",{});case 10:_context25.t0=getAlignmentSides;_context25.t1=currentPlacement;_context25.t2=rects;_context25.next=15;return platform2.isRTL==null?void 0:platform2.isRTL(elements.floating);case 15:_context25.t3=_context25.sent;_getAlignmentSides=(0,_context25.t0)(_context25.t1,_context25.t2,_context25.t3);main=_getAlignmentSides.main;cross=_getAlignmentSides.cross;if(!(placement!==currentPlacement)){_context25.next=21;break;}return _context25.abrupt("return",{x:x,y:y,reset:{placement:placements[0]}});case 21:currentOverflows=[overflow[getSide(currentPlacement)],overflow[main],overflow[cross]];allOverflows=[].concat(_toConsumableArray2((_middlewareData$autoP3=(_middlewareData$autoP4=middlewareData.autoPlacement)==null?void 0:_middlewareData$autoP4.overflows)!=null?_middlewareData$autoP3:[]),[{placement:currentPlacement,overflows:currentOverflows}]);nextPlacement=placements[currentIndex+1];if(!nextPlacement){_context25.next=26;break;}return _context25.abrupt("return",{data:{index:currentIndex+1,overflows:allOverflows},reset:{placement:nextPlacement}});case 26:placementsSortedByLeastOverflow=allOverflows.slice().sort(function(a2,b){return a2.overflows[0]-b.overflows[0];});placementThatFitsOnAllSides=(_placementsSortedByLe=placementsSortedByLeastOverflow.find(function(_ref2){var overflows=_ref2.overflows;return overflows.every(function(overflow2){return overflow2<=0;});}))==null?void 0:_placementsSortedByLe.placement;resetPlacement=placementThatFitsOnAllSides!=null?placementThatFitsOnAllSides:placementsSortedByLeastOverflow[0].placement;if(!(resetPlacement!==placement)){_context25.next=31;break;}return _context25.abrupt("return",{data:{index:currentIndex+1,overflows:allOverflows},reset:{placement:resetPlacement}});case 31:return _context25.abrupt("return",{});case 32:case"end":return _context25.stop();}}},_callee25);}))();}};};function getExpandedPlacements(placement){var oppositePlacement=getOppositePlacement(placement);return[getOppositeAlignmentPlacement(placement),oppositePlacement,getOppositeAlignmentPlacement(oppositePlacement)];}var flip=function flip(options2){if(options2===void 0){options2={};}return{name:"flip",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee26(){var _middlewareData$flip,placement,middlewareData,rects,initialPlacement,platform2,elements,_options2,_options2$mainAxis,checkMainAxis,_options2$crossAxis,checkCrossAxis,specifiedFallbackPlacements,_options2$fallbackStr,fallbackStrategy,_options2$flipAlignme,flipAlignment,detectOverflowOptions,side,isBasePlacement,fallbackPlacements,placements,overflow,overflows,overflowsData,_getAlignmentSides2,main,cross,_middlewareData$flip$,_middlewareData$flip2,nextIndex,nextPlacement,resetPlacement,_overflowsData$map$so,placement2;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:placement=middlewareArguments.placement,middlewareData=middlewareArguments.middlewareData,rects=middlewareArguments.rects,initialPlacement=middlewareArguments.initialPlacement,platform2=middlewareArguments.platform,elements=middlewareArguments.elements;_options2=options2,_options2$mainAxis=_options2.mainAxis,checkMainAxis=_options2$mainAxis===void 0?true:_options2$mainAxis,_options2$crossAxis=_options2.crossAxis,checkCrossAxis=_options2$crossAxis===void 0?true:_options2$crossAxis,specifiedFallbackPlacements=_options2.fallbackPlacements,_options2$fallbackStr=_options2.fallbackStrategy,fallbackStrategy=_options2$fallbackStr===void 0?"bestFit":_options2$fallbackStr,_options2$flipAlignme=_options2.flipAlignment,flipAlignment=_options2$flipAlignme===void 0?true:_options2$flipAlignme,detectOverflowOptions=_objectWithoutProperties2(_options2,_excluded9);side=getSide(placement);isBasePlacement=side===initialPlacement;fallbackPlacements=specifiedFallbackPlacements||(isBasePlacement||!flipAlignment?[getOppositePlacement(initialPlacement)]:getExpandedPlacements(initialPlacement));placements=[initialPlacement].concat(_toConsumableArray2(fallbackPlacements));_context26.next=8;return detectOverflow(middlewareArguments,detectOverflowOptions);case 8:overflow=_context26.sent;overflows=[];overflowsData=((_middlewareData$flip=middlewareData.flip)==null?void 0:_middlewareData$flip.overflows)||[];if(checkMainAxis){overflows.push(overflow[side]);}if(!checkCrossAxis){_context26.next=23;break;}_context26.t0=getAlignmentSides;_context26.t1=placement;_context26.t2=rects;_context26.next=18;return platform2.isRTL==null?void 0:platform2.isRTL(elements.floating);case 18:_context26.t3=_context26.sent;_getAlignmentSides2=(0,_context26.t0)(_context26.t1,_context26.t2,_context26.t3);main=_getAlignmentSides2.main;cross=_getAlignmentSides2.cross;overflows.push(overflow[main],overflow[cross]);case 23:overflowsData=[].concat(_toConsumableArray2(overflowsData),[{placement:placement,overflows:overflows}]);if(overflows.every(function(side2){return side2<=0;})){_context26.next=40;break;}nextIndex=((_middlewareData$flip$=(_middlewareData$flip2=middlewareData.flip)==null?void 0:_middlewareData$flip2.index)!=null?_middlewareData$flip$:0)+1;nextPlacement=placements[nextIndex];if(!nextPlacement){_context26.next=29;break;}return _context26.abrupt("return",{data:{index:nextIndex,overflows:overflowsData},reset:{placement:nextPlacement}});case 29:resetPlacement="bottom";_context26.t4=fallbackStrategy;_context26.next=_context26.t4==="bestFit"?33:_context26.t4==="initialPlacement"?36:38;break;case 33:placement2=(_overflowsData$map$so=overflowsData.map(function(d){return[d,d.overflows.filter(function(overflow2){return overflow2>0;}).reduce(function(acc,overflow2){return acc+overflow2;},0)];}).sort(function(a2,b){return a2[1]-b[1];})[0])==null?void 0:_overflowsData$map$so[0].placement;if(placement2){resetPlacement=placement2;}return _context26.abrupt("break",38);case 36:resetPlacement=initialPlacement;return _context26.abrupt("break",38);case 38:if(!(placement!==resetPlacement)){_context26.next=40;break;}return _context26.abrupt("return",{reset:{placement:resetPlacement}});case 40:return _context26.abrupt("return",{});case 41:case"end":return _context26.stop();}}},_callee26);}))();}};};function getSideOffsets(overflow,rect){return{top:overflow.top-rect.height,right:overflow.right-rect.width,bottom:overflow.bottom-rect.height,left:overflow.left-rect.width};}function isAnySideFullyClipped(overflow){return sides.some(function(side){return overflow[side]>=0;});}var hide=function hide(_temp){var _ref231=_temp===void 0?{}:_temp,_ref231$strategy=_ref231.strategy,strategy=_ref231$strategy===void 0?"referenceHidden":_ref231$strategy,detectOverflowOptions=_objectWithoutProperties2(_ref231,_excluded10);return{name:"hide",fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee27(){var rects,overflow,offsets,_overflow,_offsets;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:rects=middlewareArguments.rects;_context27.t0=strategy;_context27.next=_context27.t0==="referenceHidden"?4:_context27.t0==="escaped"?9:14;break;case 4:_context27.next=6;return detectOverflow(middlewareArguments,_objectSpread(_objectSpread({},detectOverflowOptions),{},{elementContext:"reference"}));case 6:overflow=_context27.sent;offsets=getSideOffsets(overflow,rects.reference);return _context27.abrupt("return",{data:{referenceHiddenOffsets:offsets,referenceHidden:isAnySideFullyClipped(offsets)}});case 9:_context27.next=11;return detectOverflow(middlewareArguments,_objectSpread(_objectSpread({},detectOverflowOptions),{},{altBoundary:true}));case 11:_overflow=_context27.sent;_offsets=getSideOffsets(_overflow,rects.floating);return _context27.abrupt("return",{data:{escapedOffsets:_offsets,escaped:isAnySideFullyClipped(_offsets)}});case 14:return _context27.abrupt("return",{});case 15:case"end":return _context27.stop();}}},_callee27);}))();}};};function convertValueToCoords(placement,rects,value,rtl){if(rtl===void 0){rtl=false;}var side=getSide(placement);var alignment=getAlignment(placement);var isVertical=getMainAxisFromPlacement(placement)==="x";var mainAxisMulti=["left","top"].includes(side)?-1:1;var crossAxisMulti=rtl&&isVertical?-1:1;var rawValue=typeof value==="function"?value(_objectSpread(_objectSpread({},rects),{},{placement:placement})):value;var _ref232=typeof rawValue==="number"?{mainAxis:rawValue,crossAxis:0,alignmentAxis:null}:_objectSpread({mainAxis:0,crossAxis:0,alignmentAxis:null},rawValue),mainAxis=_ref232.mainAxis,crossAxis=_ref232.crossAxis,alignmentAxis=_ref232.alignmentAxis;if(alignment&&typeof alignmentAxis==="number"){crossAxis=alignment==="end"?alignmentAxis*-1:alignmentAxis;}return isVertical?{x:crossAxis*crossAxisMulti,y:mainAxis*mainAxisMulti}:{x:mainAxis*mainAxisMulti,y:crossAxis*crossAxisMulti};}var offset=function offset(value){if(value===void 0){value=0;}return{name:"offset",options:value,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee28(){var x,y,placement,rects,platform2,elements,diffCoords;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:x=middlewareArguments.x,y=middlewareArguments.y,placement=middlewareArguments.placement,rects=middlewareArguments.rects,platform2=middlewareArguments.platform,elements=middlewareArguments.elements;_context28.t0=convertValueToCoords;_context28.t1=placement;_context28.t2=rects;_context28.t3=value;_context28.next=7;return platform2.isRTL==null?void 0:platform2.isRTL(elements.floating);case 7:_context28.t4=_context28.sent;diffCoords=(0,_context28.t0)(_context28.t1,_context28.t2,_context28.t3,_context28.t4);return _context28.abrupt("return",{x:x+diffCoords.x,y:y+diffCoords.y,data:diffCoords});case 10:case"end":return _context28.stop();}}},_callee28);}))();}};};function getCrossAxis(axis){return axis==="x"?"y":"x";}var shift=function shift(options2){if(options2===void 0){options2={};}return{name:"shift",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee29(){var _objectSpread4;var x,y,placement,_options3,_options3$mainAxis,checkMainAxis,_options3$crossAxis,checkCrossAxis,_options3$limiter,limiter,detectOverflowOptions,coords,overflow,mainAxis,crossAxis,mainAxisCoord,crossAxisCoord,minSide,maxSide,min3,max3,_minSide,_maxSide,_min,_max,limitedCoords;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:x=middlewareArguments.x,y=middlewareArguments.y,placement=middlewareArguments.placement;_options3=options2,_options3$mainAxis=_options3.mainAxis,checkMainAxis=_options3$mainAxis===void 0?true:_options3$mainAxis,_options3$crossAxis=_options3.crossAxis,checkCrossAxis=_options3$crossAxis===void 0?false:_options3$crossAxis,_options3$limiter=_options3.limiter,limiter=_options3$limiter===void 0?{fn:function fn(_ref2){var x2=_ref2.x,y2=_ref2.y;return{x:x2,y:y2};}}:_options3$limiter,detectOverflowOptions=_objectWithoutProperties2(_options3,_excluded11);coords={x:x,y:y};_context29.next=5;return detectOverflow(middlewareArguments,detectOverflowOptions);case 5:overflow=_context29.sent;mainAxis=getMainAxisFromPlacement(getSide(placement));crossAxis=getCrossAxis(mainAxis);mainAxisCoord=coords[mainAxis];crossAxisCoord=coords[crossAxis];if(checkMainAxis){minSide=mainAxis==="y"?"top":"left";maxSide=mainAxis==="y"?"bottom":"right";min3=mainAxisCoord+overflow[minSide];max3=mainAxisCoord-overflow[maxSide];mainAxisCoord=within(min3,mainAxisCoord,max3);}if(checkCrossAxis){_minSide=crossAxis==="y"?"top":"left";_maxSide=crossAxis==="y"?"bottom":"right";_min=crossAxisCoord+overflow[_minSide];_max=crossAxisCoord-overflow[_maxSide];crossAxisCoord=within(_min,crossAxisCoord,_max);}limitedCoords=limiter.fn(_objectSpread(_objectSpread({},middlewareArguments),{},(_objectSpread4={},_defineProperty3(_objectSpread4,mainAxis,mainAxisCoord),_defineProperty3(_objectSpread4,crossAxis,crossAxisCoord),_objectSpread4)));return _context29.abrupt("return",_objectSpread(_objectSpread({},limitedCoords),{},{data:{x:limitedCoords.x-x,y:limitedCoords.y-y}}));case 14:case"end":return _context29.stop();}}},_callee29);}))();}};};var size=function size(options2){if(options2===void 0){options2={};}return{name:"size",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee30(){var placement,rects,platform2,elements,_options4,apply2,detectOverflowOptions,overflow,side,alignment,heightSide,widthSide,xMin,xMax,yMin,yMax,dimensions,prevDimensions,nextDimensions;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:placement=middlewareArguments.placement,rects=middlewareArguments.rects,platform2=middlewareArguments.platform,elements=middlewareArguments.elements;_options4=options2,apply2=_options4.apply,detectOverflowOptions=_objectWithoutProperties2(_options4,_excluded12);_context30.next=4;return detectOverflow(middlewareArguments,detectOverflowOptions);case 4:overflow=_context30.sent;side=getSide(placement);alignment=getAlignment(placement);if(!(side==="top"||side==="bottom")){_context30.next=26;break;}heightSide=side;_context30.t0=alignment;_context30.next=12;return platform2.isRTL==null?void 0:platform2.isRTL(elements.floating);case 12:if(!_context30.sent){_context30.next=16;break;}_context30.t1="start";_context30.next=17;break;case 16:_context30.t1="end";case 17:_context30.t2=_context30.t1;if(!(_context30.t0===_context30.t2)){_context30.next=22;break;}_context30.t3="left";_context30.next=23;break;case 22:_context30.t3="right";case 23:widthSide=_context30.t3;_context30.next=28;break;case 26:widthSide=side;heightSide=alignment==="end"?"top":"bottom";case 28:xMin=max(overflow.left,0);xMax=max(overflow.right,0);yMin=max(overflow.top,0);yMax=max(overflow.bottom,0);dimensions={height:rects.floating.height-(["left","right"].includes(placement)?2*(yMin!==0||yMax!==0?yMin+yMax:max(overflow.top,overflow.bottom)):overflow[heightSide]),width:rects.floating.width-(["top","bottom"].includes(placement)?2*(xMin!==0||xMax!==0?xMin+xMax:max(overflow.left,overflow.right)):overflow[widthSide])};_context30.next=35;return platform2.getDimensions(elements.floating);case 35:prevDimensions=_context30.sent;apply2==null?void 0:apply2(_objectSpread(_objectSpread({},dimensions),rects));_context30.next=39;return platform2.getDimensions(elements.floating);case 39:nextDimensions=_context30.sent;if(!(prevDimensions.width!==nextDimensions.width||prevDimensions.height!==nextDimensions.height)){_context30.next=42;break;}return _context30.abrupt("return",{reset:{rects:true}});case 42:return _context30.abrupt("return",{});case 43:case"end":return _context30.stop();}}},_callee30);}))();}};};var inline2=function inline2(options2){if(options2===void 0){options2={};}return{name:"inline",options:options2,fn:function fn(middlewareArguments){return _asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee31(){var _await$platform$getCl,placement,elements,rects,platform2,strategy,_options5,_options5$padding,padding,x,y,fallback,clientRects,paddingObject,getBoundingClientRect2,resetRects;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:getBoundingClientRect2=function _getBoundingClientRec(){if(clientRects.length===2&&clientRects[0].left>clientRects[1].right&&x!=null&&y!=null){var _clientRects$find;return(_clientRects$find=clientRects.find(function(rect){return x>rect.left-paddingObject.left&&x<rect.right+paddingObject.right&&y>rect.top-paddingObject.top&&y<rect.bottom+paddingObject.bottom;}))!=null?_clientRects$find:fallback;}if(clientRects.length>=2){if(getMainAxisFromPlacement(placement)==="x"){var firstRect=clientRects[0];var lastRect=clientRects[clientRects.length-1];var isTop=getSide(placement)==="top";var top2=firstRect.top;var bottom2=lastRect.bottom;var left2=isTop?firstRect.left:lastRect.left;var right2=isTop?firstRect.right:lastRect.right;var width2=right2-left2;var height2=bottom2-top2;return{top:top2,bottom:bottom2,left:left2,right:right2,width:width2,height:height2,x:left2,y:top2};}var isLeftSide=getSide(placement)==="left";var maxRight=max.apply(void 0,_toConsumableArray2(clientRects.map(function(rect){return rect.right;})));var minLeft=min.apply(void 0,_toConsumableArray2(clientRects.map(function(rect){return rect.left;})));var measureRects=clientRects.filter(function(rect){return isLeftSide?rect.left===minLeft:rect.right===maxRight;});var top=measureRects[0].top;var bottom=measureRects[measureRects.length-1].bottom;var left=minLeft;var right=maxRight;var width=right-left;var height=bottom-top;return{top:top,bottom:bottom,left:left,right:right,width:width,height:height,x:left,y:top};}return fallback;};placement=middlewareArguments.placement,elements=middlewareArguments.elements,rects=middlewareArguments.rects,platform2=middlewareArguments.platform,strategy=middlewareArguments.strategy;_options5=options2,_options5$padding=_options5.padding,padding=_options5$padding===void 0?2:_options5$padding,x=_options5.x,y=_options5.y;_context31.t0=rectToClientRect;if(!platform2.convertOffsetParentRelativeRectToViewportRelativeRect){_context31.next=17;break;}_context31.t2=platform2;_context31.t3=rects.reference;_context31.next=9;return platform2.getOffsetParent==null?void 0:platform2.getOffsetParent(elements.floating);case 9:_context31.t4=_context31.sent;_context31.t5=strategy;_context31.t6={rect:_context31.t3,offsetParent:_context31.t4,strategy:_context31.t5};_context31.next=14;return _context31.t2.convertOffsetParentRelativeRectToViewportRelativeRect.call(_context31.t2,_context31.t6);case 14:_context31.t1=_context31.sent;_context31.next=18;break;case 17:_context31.t1=rects.reference;case 18:_context31.t7=_context31.t1;fallback=(0,_context31.t0)(_context31.t7);_context31.next=22;return platform2.getClientRects==null?void 0:platform2.getClientRects(elements.reference);case 22:_context31.t8=_await$platform$getCl=_context31.sent;if(!(_context31.t8!=null)){_context31.next=27;break;}_context31.t9=_await$platform$getCl;_context31.next=28;break;case 27:_context31.t9=[];case 28:clientRects=_context31.t9;paddingObject=getSideObjectFromPadding(padding);_context31.next=32;return platform2.getElementRects({reference:{getBoundingClientRect:getBoundingClientRect2},floating:elements.floating,strategy:strategy});case 32:resetRects=_context31.sent;if(!(rects.reference.x!==resetRects.reference.x||rects.reference.y!==resetRects.reference.y||rects.reference.width!==resetRects.reference.width||rects.reference.height!==resetRects.reference.height)){_context31.next=35;break;}return _context31.abrupt("return",{reset:{rects:resetRects}});case 35:return _context31.abrupt("return",{});case 36:case"end":return _context31.stop();}}},_callee31);}))();}};};function isWindow(value){return value&&value.document&&value.location&&value.alert&&value.setInterval;}function getWindow(node){if(node==null){return window;}if(!isWindow(node)){var ownerDocument=node.ownerDocument;return ownerDocument?ownerDocument.defaultView||window:window;}return node;}function getComputedStyle$1(element){return getWindow(element).getComputedStyle(element);}function getNodeName(node){return isWindow(node)?"":node?(node.nodeName||"").toLowerCase():"";}function isHTMLElement(value){return value instanceof getWindow(value).HTMLElement;}function isElement(value){return value instanceof getWindow(value).Element;}function isNode2(value){return value instanceof getWindow(value).Node;}function isShadowRoot(node){if(typeof ShadowRoot==="undefined"){return false;}var OwnElement=getWindow(node).ShadowRoot;return node instanceof OwnElement||node instanceof ShadowRoot;}function isOverflowElement(element){var _getComputedStyle$=getComputedStyle$1(element),overflow=_getComputedStyle$.overflow,overflowX=_getComputedStyle$.overflowX,overflowY=_getComputedStyle$.overflowY;return /auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX);}function isTableElement(element){return["table","td","th"].includes(getNodeName(element));}function isContainingBlock(element){var isFirefox=navigator.userAgent.toLowerCase().includes("firefox");var css2=getComputedStyle$1(element);return css2.transform!=="none"||css2.perspective!=="none"||css2.contain==="paint"||["transform","perspective"].includes(css2.willChange)||isFirefox&&css2.willChange==="filter"||isFirefox&&(css2.filter?css2.filter!=="none":false);}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(navigator.userAgent);}var min2=Math.min;var max2=Math.max;var round2=Math.round;function getBoundingClientRect(element,includeScale,isFixedStrategy){var _win$visualViewport$o,_win$visualViewport,_win$visualViewport$o2,_win$visualViewport2;if(includeScale===void 0){includeScale=false;}if(isFixedStrategy===void 0){isFixedStrategy=false;}var clientRect=element.getBoundingClientRect();var scaleX=1;var scaleY=1;if(includeScale&&isHTMLElement(element)){scaleX=element.offsetWidth>0?round2(clientRect.width)/element.offsetWidth||1:1;scaleY=element.offsetHeight>0?round2(clientRect.height)/element.offsetHeight||1:1;}var win=isElement(element)?getWindow(element):window;var addVisualOffsets=!isLayoutViewport()&&isFixedStrategy;var x=(clientRect.left+(addVisualOffsets?(_win$visualViewport$o=(_win$visualViewport=win.visualViewport)==null?void 0:_win$visualViewport.offsetLeft)!=null?_win$visualViewport$o:0:0))/scaleX;var y=(clientRect.top+(addVisualOffsets?(_win$visualViewport$o2=(_win$visualViewport2=win.visualViewport)==null?void 0:_win$visualViewport2.offsetTop)!=null?_win$visualViewport$o2:0:0))/scaleY;var width=clientRect.width/scaleX;var height=clientRect.height/scaleY;return{width:width,height:height,top:y,right:x+width,bottom:y+height,left:x,x:x,y:y};}function getDocumentElement(node){return((isNode2(node)?node.ownerDocument:node.document)||window.document).documentElement;}function getNodeScroll(element){if(isElement(element)){return{scrollLeft:element.scrollLeft,scrollTop:element.scrollTop};}return{scrollLeft:element.pageXOffset,scrollTop:element.pageYOffset};}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getNodeScroll(element).scrollLeft;}function isScaled(element){var rect=getBoundingClientRect(element);return round2(rect.width)!==element.offsetWidth||round2(rect.height)!==element.offsetHeight;}function getRectRelativeToOffsetParent(element,offsetParent,strategy){var isOffsetParentAnElement=isHTMLElement(offsetParent);var documentElement=getDocumentElement(offsetParent);var rect=getBoundingClientRect(element,isOffsetParentAnElement&&isScaled(offsetParent),strategy==="fixed");var scroll={scrollLeft:0,scrollTop:0};var offsets={x:0,y:0};if(isOffsetParentAnElement||!isOffsetParentAnElement&&strategy!=="fixed"){if(getNodeName(offsetParent)!=="body"||isOverflowElement(documentElement)){scroll=getNodeScroll(offsetParent);}if(isHTMLElement(offsetParent)){var offsetRect=getBoundingClientRect(offsetParent,true);offsets.x=offsetRect.x+offsetParent.clientLeft;offsets.y=offsetRect.y+offsetParent.clientTop;}else if(documentElement){offsets.x=getWindowScrollBarX(documentElement);}}return{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height};}function getParentNode(node){if(getNodeName(node)==="html"){return node;}return node.assignedSlot||node.parentNode||(isShadowRoot(node)?node.host:null)||getDocumentElement(node);}function getTrueOffsetParent(element){if(!isHTMLElement(element)||getComputedStyle(element).position==="fixed"){return null;}return element.offsetParent;}function getContainingBlock(element){var currentNode=getParentNode(element);if(isShadowRoot(currentNode)){currentNode=currentNode.host;}while(isHTMLElement(currentNode)&&!["html","body"].includes(getNodeName(currentNode))){if(isContainingBlock(currentNode)){return currentNode;}else{currentNode=currentNode.parentNode;}}return null;}function getOffsetParent(element){var window2=getWindow(element);var offsetParent=getTrueOffsetParent(element);while(offsetParent&&isTableElement(offsetParent)&&getComputedStyle(offsetParent).position==="static"){offsetParent=getTrueOffsetParent(offsetParent);}if(offsetParent&&(getNodeName(offsetParent)==="html"||getNodeName(offsetParent)==="body"&&getComputedStyle(offsetParent).position==="static"&&!isContainingBlock(offsetParent))){return window2;}return offsetParent||getContainingBlock(element)||window2;}function getDimensions(element){if(isHTMLElement(element)){return{width:element.offsetWidth,height:element.offsetHeight};}var rect=getBoundingClientRect(element);return{width:rect.width,height:rect.height};}function convertOffsetParentRelativeRectToViewportRelativeRect(_ref2){var rect=_ref2.rect,offsetParent=_ref2.offsetParent,strategy=_ref2.strategy;var isOffsetParentAnElement=isHTMLElement(offsetParent);var documentElement=getDocumentElement(offsetParent);if(offsetParent===documentElement){return rect;}var scroll={scrollLeft:0,scrollTop:0};var offsets={x:0,y:0};if(isOffsetParentAnElement||!isOffsetParentAnElement&&strategy!=="fixed"){if(getNodeName(offsetParent)!=="body"||isOverflowElement(documentElement)){scroll=getNodeScroll(offsetParent);}if(isHTMLElement(offsetParent)){var offsetRect=getBoundingClientRect(offsetParent,true);offsets.x=offsetRect.x+offsetParent.clientLeft;offsets.y=offsetRect.y+offsetParent.clientTop;}}return _objectSpread(_objectSpread({},rect),{},{x:rect.x-scroll.scrollLeft+offsets.x,y:rect.y-scroll.scrollTop+offsets.y});}function getViewportRect(element,strategy){var win=getWindow(element);var html2=getDocumentElement(element);var visualViewport=win.visualViewport;var width=html2.clientWidth;var height=html2.clientHeight;var x=0;var y=0;if(visualViewport){width=visualViewport.width;height=visualViewport.height;var layoutViewport=isLayoutViewport();if(layoutViewport||!layoutViewport&&strategy==="fixed"){x=visualViewport.offsetLeft;y=visualViewport.offsetTop;}}return{width:width,height:height,x:x,y:y};}function getDocumentRect(element){var _element$ownerDocumen;var html2=getDocumentElement(element);var scroll=getNodeScroll(element);var body=(_element$ownerDocumen=element.ownerDocument)==null?void 0:_element$ownerDocumen.body;var width=max2(html2.scrollWidth,html2.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0);var height=max2(html2.scrollHeight,html2.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0);var x=-scroll.scrollLeft+getWindowScrollBarX(element);var y=-scroll.scrollTop;if(getComputedStyle$1(body||html2).direction==="rtl"){x+=max2(html2.clientWidth,body?body.clientWidth:0)-width;}return{width:width,height:height,x:x,y:y};}function getNearestOverflowAncestor(node){var parentNode=getParentNode(node);if(["html","body","#document"].includes(getNodeName(parentNode))){return node.ownerDocument.body;}if(isHTMLElement(parentNode)&&isOverflowElement(parentNode)){return parentNode;}return getNearestOverflowAncestor(parentNode);}function getOverflowAncestors(node,list2){var _node$ownerDocument;if(list2===void 0){list2=[];}var scrollableAncestor=getNearestOverflowAncestor(node);var isBody=scrollableAncestor===((_node$ownerDocument=node.ownerDocument)==null?void 0:_node$ownerDocument.body);var win=getWindow(scrollableAncestor);var target=isBody?[win].concat(win.visualViewport||[],isOverflowElement(scrollableAncestor)?scrollableAncestor:[]):scrollableAncestor;var updatedList=list2.concat(target);return isBody?updatedList:updatedList.concat(getOverflowAncestors(target));}function contains(parent,child){var rootNode=child==null?void 0:child.getRootNode==null?void 0:child.getRootNode();if(parent!=null&&parent.contains(child)){return true;}else if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent===next){return true;}next=next.parentNode||next.host;}while(next);}return false;}function getInnerBoundingClientRect(element,strategy){var clientRect=getBoundingClientRect(element,false,strategy==="fixed");var top=clientRect.top+element.clientTop;var left=clientRect.left+element.clientLeft;return{top:top,left:left,x:left,y:top,right:left+element.clientWidth,bottom:top+element.clientHeight,width:element.clientWidth,height:element.clientHeight};}function getClientRectFromClippingAncestor(element,clippingParent,strategy){if(clippingParent==="viewport"){return rectToClientRect(getViewportRect(element,strategy));}if(isElement(clippingParent)){return getInnerBoundingClientRect(clippingParent,strategy);}return rectToClientRect(getDocumentRect(getDocumentElement(element)));}function getClippingAncestors(element){var clippingAncestors=getOverflowAncestors(element);var canEscapeClipping=["absolute","fixed"].includes(getComputedStyle$1(element).position);var clipperElement=canEscapeClipping&&isHTMLElement(element)?getOffsetParent(element):element;if(!isElement(clipperElement)){return[];}return clippingAncestors.filter(function(clippingAncestors2){return isElement(clippingAncestors2)&&contains(clippingAncestors2,clipperElement)&&getNodeName(clippingAncestors2)!=="body";});}function getClippingRect(_ref2){var element=_ref2.element,boundary=_ref2.boundary,rootBoundary=_ref2.rootBoundary,strategy=_ref2.strategy;var mainClippingAncestors=boundary==="clippingAncestors"?getClippingAncestors(element):[].concat(boundary);var clippingAncestors=[].concat(_toConsumableArray2(mainClippingAncestors),[rootBoundary]);var firstClippingAncestor=clippingAncestors[0];var clippingRect=clippingAncestors.reduce(function(accRect,clippingAncestor){var rect=getClientRectFromClippingAncestor(element,clippingAncestor,strategy);accRect.top=max2(rect.top,accRect.top);accRect.right=min2(rect.right,accRect.right);accRect.bottom=min2(rect.bottom,accRect.bottom);accRect.left=max2(rect.left,accRect.left);return accRect;},getClientRectFromClippingAncestor(element,firstClippingAncestor,strategy));return{width:clippingRect.right-clippingRect.left,height:clippingRect.bottom-clippingRect.top,x:clippingRect.left,y:clippingRect.top};}var platform={getClippingRect:getClippingRect,convertOffsetParentRelativeRectToViewportRelativeRect:convertOffsetParentRelativeRectToViewportRelativeRect,isElement:isElement,getDimensions:getDimensions,getOffsetParent:getOffsetParent,getDocumentElement:getDocumentElement,getElementRects:function getElementRects(_ref2){var reference=_ref2.reference,floating=_ref2.floating,strategy=_ref2.strategy;return{reference:getRectRelativeToOffsetParent(reference,getOffsetParent(floating),strategy),floating:_objectSpread(_objectSpread({},getDimensions(floating)),{},{x:0,y:0})};},getClientRects:function getClientRects(element){return Array.from(element.getClientRects());},isRTL:function isRTL(element){return getComputedStyle$1(element).direction==="rtl";}};function autoUpdate(reference,floating,update,options2){if(options2===void 0){options2={};}var _options6=options2,_options6$ancestorScr=_options6.ancestorScroll,_ancestorScroll=_options6$ancestorScr===void 0?true:_options6$ancestorScr,_options6$ancestorRes=_options6.ancestorResize,_ancestorResize=_options6$ancestorRes===void 0?true:_options6$ancestorRes,_options6$elementResi=_options6.elementResize,_elementResize=_options6$elementResi===void 0?true:_options6$elementResi,_options6$animationFr=_options6.animationFrame,animationFrame=_options6$animationFr===void 0?false:_options6$animationFr;var cleanedUp=false;var ancestorScroll=_ancestorScroll&&!animationFrame;var ancestorResize=_ancestorResize&&!animationFrame;var elementResize=_elementResize&&!animationFrame;var ancestors=ancestorScroll||ancestorResize?[].concat(_toConsumableArray2(isElement(reference)?getOverflowAncestors(reference):[]),_toConsumableArray2(getOverflowAncestors(floating))):[];ancestors.forEach(function(ancestor){ancestorScroll&&ancestor.addEventListener("scroll",update,{passive:true});ancestorResize&&ancestor.addEventListener("resize",update);});var observer2=null;if(elementResize){observer2=new ResizeObserver(update);isElement(reference)&&observer2.observe(reference);observer2.observe(floating);}var frameId;var prevRefRect=animationFrame?getBoundingClientRect(reference):null;if(animationFrame){frameLoop();}function frameLoop(){if(cleanedUp){return;}var nextRefRect=getBoundingClientRect(reference);if(prevRefRect&&(nextRefRect.x!==prevRefRect.x||nextRefRect.y!==prevRefRect.y||nextRefRect.width!==prevRefRect.width||nextRefRect.height!==prevRefRect.height)){update();}prevRefRect=nextRefRect;frameId=requestAnimationFrame(frameLoop);}return function(){var _observer;cleanedUp=true;ancestors.forEach(function(ancestor){ancestorScroll&&ancestor.removeEventListener("scroll",update);ancestorResize&&ancestor.removeEventListener("resize",update);});(_observer=observer2)==null?void 0:_observer.disconnect();observer2=null;if(animationFrame){cancelAnimationFrame(frameId);}};}var computePosition2=function computePosition2(reference,floating,options2){return computePosition(reference,floating,_objectSpread({platform:platform},options2));};var buildConfigFromModifiers=function buildConfigFromModifiers(modifiers){var config={placement:"bottom",middleware:[]};var keys=Object.keys(modifiers);var getModifierArgument=function getModifierArgument(modifier){return modifiers[modifier];};if(keys.includes("offset")){config.middleware.push(offset(getModifierArgument("offset")));}if(keys.includes("placement")){config.placement=getModifierArgument("placement");}if(keys.includes("autoPlacement")&&!keys.includes("flip")){config.middleware.push(autoPlacement(getModifierArgument("autoPlacement")));}if(keys.includes("flip")){config.middleware.push(flip(getModifierArgument("flip")));}if(keys.includes("shift")){config.middleware.push(shift(getModifierArgument("shift")));}if(keys.includes("inline")){config.middleware.push(inline2(getModifierArgument("inline")));}if(keys.includes("arrow")){config.middleware.push(arrow(getModifierArgument("arrow")));}if(keys.includes("hide")){config.middleware.push(hide(getModifierArgument("hide")));}if(keys.includes("size")){config.middleware.push(size(getModifierArgument("size")));}return config;};var buildDirectiveConfigFromModifiers=function buildDirectiveConfigFromModifiers(modifiers,settings){var config={component:{trap:false},"float":{placement:"bottom",strategy:"absolute",middleware:[]}};var getModifierArgument=function getModifierArgument(modifier){return modifiers[modifiers.indexOf(modifier)+1];};if(modifiers.includes("trap")){config.component.trap=true;}if(modifiers.includes("teleport")){config["float"].strategy="fixed";}if(modifiers.includes("offset")){config["float"].middleware.push(offset(settings["offset"]||10));}if(modifiers.includes("placement")){config["float"].placement=getModifierArgument("placement");}if(modifiers.includes("autoPlacement")&&!modifiers.includes("flip")){config["float"].middleware.push(autoPlacement(settings["autoPlacement"]));}if(modifiers.includes("flip")){config["float"].middleware.push(flip(settings["flip"]));}if(modifiers.includes("shift")){config["float"].middleware.push(shift(settings["shift"]));}if(modifiers.includes("inline")){config["float"].middleware.push(inline2(settings["inline"]));}if(modifiers.includes("arrow")){config["float"].middleware.push(arrow(settings["arrow"]));}if(modifiers.includes("hide")){config["float"].middleware.push(hide(settings["hide"]));}if(modifiers.includes("size")){config["float"].middleware.push(size(settings["size"]));}return config;};var randomString=function randomString(length){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");var str="";if(!length){length=Math.floor(Math.random()*chars.length);}for(var i=0;i<length;i++){str+=chars[Math.floor(Math.random()*chars.length)];}return str;};var onAttributeAddeds=[];var onElRemoveds=[];var onElAddeds=[];function cleanupAttributes(el,names){if(!el._x_attributeCleanups)return;Object.entries(el._x_attributeCleanups).forEach(function(_ref233){var _ref234=_slicedToArray(_ref233,2),name2=_ref234[0],value=_ref234[1];if(names===void 0||names.includes(name2)){value.forEach(function(i){return i();});delete el._x_attributeCleanups[name2];}});}var observer=new MutationObserver(onMutate);var currentlyObserving=false;function startObservingMutations(){observer.observe(document,{subtree:true,childList:true,attributes:true,attributeOldValue:true});currentlyObserving=true;}function stopObservingMutations(){flushObserver();observer.disconnect();currentlyObserving=false;}var recordQueue=[];var willProcessRecordQueue=false;function flushObserver(){recordQueue=recordQueue.concat(observer.takeRecords());if(recordQueue.length&&!willProcessRecordQueue){willProcessRecordQueue=true;queueMicrotask(function(){processRecordQueue();willProcessRecordQueue=false;});}}function processRecordQueue(){onMutate(recordQueue);recordQueue.length=0;}function mutateDom(callback){if(!currentlyObserving)return callback();stopObservingMutations();var result=callback();startObservingMutations();return result;}var isCollecting=false;var deferredMutations=[];function onMutate(mutations){if(isCollecting){deferredMutations=deferredMutations.concat(mutations);return;}var addedNodes=[];var removedNodes=[];var addedAttributes=/* @__PURE__ */new Map();var removedAttributes=/* @__PURE__ */new Map();for(var i=0;i<mutations.length;i++){if(mutations[i].target._x_ignoreMutationObserver)continue;if(mutations[i].type==="childList"){mutations[i].addedNodes.forEach(function(node){return node.nodeType===1&&addedNodes.push(node);});mutations[i].removedNodes.forEach(function(node){return node.nodeType===1&&removedNodes.push(node);});}if(mutations[i].type==="attributes"){(function(){var el=mutations[i].target;var name2=mutations[i].attributeName;var oldValue=mutations[i].oldValue;var add=function add(){if(!addedAttributes.has(el))addedAttributes.set(el,[]);addedAttributes.get(el).push({name:name2,value:el.getAttribute(name2)});};var remove=function remove(){if(!removedAttributes.has(el))removedAttributes.set(el,[]);removedAttributes.get(el).push(name2);};if(el.hasAttribute(name2)&&oldValue===null){add();}else if(el.hasAttribute(name2)){remove();add();}else{remove();}})();}}removedAttributes.forEach(function(attrs,el){cleanupAttributes(el,attrs);});addedAttributes.forEach(function(attrs,el){onAttributeAddeds.forEach(function(i){return i(el,attrs);});});var _loop6=function _loop6(){var node=_removedNodes[_i5];if(addedNodes.includes(node))return"continue";onElRemoveds.forEach(function(i){return i(node);});if(node._x_cleanups){while(node._x_cleanups.length){node._x_cleanups.pop()();}}};for(var _i5=0,_removedNodes=removedNodes;_i5<_removedNodes.length;_i5++){var _ret2=_loop6();if(_ret2==="continue")continue;}addedNodes.forEach(function(node){node._x_ignoreSelf=true;node._x_ignore=true;});var _loop7=function _loop7(){var node=_addedNodes[_i6];if(removedNodes.includes(node))return"continue";if(!node.isConnected)return"continue";delete node._x_ignoreSelf;delete node._x_ignore;onElAddeds.forEach(function(i){return i(node);});node._x_ignore=true;node._x_ignoreSelf=true;};for(var _i6=0,_addedNodes=addedNodes;_i6<_addedNodes.length;_i6++){var _ret3=_loop7();if(_ret3==="continue")continue;}addedNodes.forEach(function(node){delete node._x_ignoreSelf;delete node._x_ignore;});addedNodes=null;removedNodes=null;addedAttributes=null;removedAttributes=null;}function once(callback){var fallback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var called=false;return function(){if(!called){called=true;callback.apply(this,arguments);}else{fallback.apply(this,arguments);}};}function src_default(Alpine){var defaultOptions2={dismissable:true,trap:false};function setupA11y(component,trigger){var panel2=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!trigger)return;if(!trigger.hasAttribute("aria-expanded")){trigger.setAttribute("aria-expanded",false);}if(!panel2.hasAttribute("id")){var panelId="panel-".concat(randomString(8));trigger.setAttribute("aria-controls",panelId);panel2.setAttribute("id",panelId);}else{trigger.setAttribute("aria-controls",panel2.getAttribute("id"));}panel2.setAttribute("aria-modal",true);panel2.setAttribute("role","dialog");}var atMagicTrigger=document.querySelectorAll('[\\@click^="$float"]');var xMagicTrigger=document.querySelectorAll('[x-on\\:click^="$float"]');[].concat(_toConsumableArray2(atMagicTrigger),_toConsumableArray2(xMagicTrigger)).forEach(function(trigger){var component=trigger.parentElement.closest("[x-data]");var panel2=component.querySelector('[x-ref="panel"]');setupA11y(component,trigger,panel2);});Alpine.magic("float",function(el){return function(){var modifiers=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var options2=_objectSpread(_objectSpread({},defaultOptions2),settings);var config=Object.keys(modifiers).length>0?buildConfigFromModifiers(modifiers):{middleware:[autoPlacement()]};var trigger=el;var component=el.parentElement.closest("[x-data]");var panel2=component.querySelector('[x-ref="panel"]');function isFloating(){return panel2.style.display=="block";}function closePanel(){panel2.style.display="";trigger.setAttribute("aria-expanded",false);if(options2.trap)panel2.setAttribute("x-trap",false);autoUpdate(el,panel2,update);}function openPanel(){panel2.style.display="block";trigger.setAttribute("aria-expanded",true);if(options2.trap)panel2.setAttribute("x-trap",true);update();}function togglePanel(){isFloating()?closePanel():openPanel();}function update(){return _update2.apply(this,arguments);}function _update2(){_update2=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee32(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:_context32.next=2;return computePosition2(el,panel2,config).then(function(_ref235){var middlewareData=_ref235.middlewareData,placement=_ref235.placement,x=_ref235.x,y=_ref235.y;if(middlewareData.arrow){var _middlewareData$arrow,_middlewareData$arrow2;var ax=(_middlewareData$arrow=middlewareData.arrow)===null||_middlewareData$arrow===void 0?void 0:_middlewareData$arrow.x;var ay=(_middlewareData$arrow2=middlewareData.arrow)===null||_middlewareData$arrow2===void 0?void 0:_middlewareData$arrow2.y;var aEl=config.middleware.filter(function(middleware){return middleware.name=="arrow";})[0].options.element;var staticSide={top:"bottom",right:"left",bottom:"top",left:"right"}[placement.split("-")[0]];Object.assign(aEl.style,_defineProperty3({left:ax!=null?"".concat(ax,"px"):"",top:ay!=null?"".concat(ay,"px"):"",right:"",bottom:""},staticSide,"-4px"));}if(middlewareData.hide){var referenceHidden=middlewareData.hide.referenceHidden;Object.assign(panel2.style,{visibility:referenceHidden?"hidden":"visible"});}Object.assign(panel2.style,{left:"".concat(x,"px"),top:"".concat(y,"px")});});case 2:return _context32.abrupt("return",_context32.sent);case 3:case"end":return _context32.stop();}}},_callee32);}));return _update2.apply(this,arguments);}if(options2.dismissable){window.addEventListener("click",function(event){if(!component.contains(event.target)&&isFloating()){togglePanel();}});window.addEventListener("keydown",function(event){if(event.key==="Escape"&&isFloating()){togglePanel();}},true);}togglePanel();};});Alpine.directive("float",function(panel2,_ref236,_ref237){var modifiers=_ref236.modifiers,expression=_ref236.expression;var evaluate=_ref237.evaluate,effect=_ref237.effect;var settings=expression?evaluate(expression):{};var config=modifiers.length>0?buildDirectiveConfigFromModifiers(modifiers,settings):{};var cleanup=null;if(config["float"].strategy=="fixed"){panel2.style.position="fixed";}var clickAway=function clickAway(event){return panel2.parentElement&&!panel2.parentElement.closest("[x-data]").contains(event.target)?panel2.close():null;};var keyEscape=function keyEscape(event){return event.key==="Escape"?panel2.close():null;};var refName=panel2.getAttribute("x-ref");var component=panel2.parentElement.closest("[x-data]");var atTrigger=component.querySelectorAll("[\\@click^=\"$refs.".concat(refName,"\"]"));var xTrigger=component.querySelectorAll("[x-on\\:click^=\"$refs.".concat(refName,"\"]"));panel2.style.setProperty("display","none");setupA11y(component,[].concat(_toConsumableArray2(atTrigger),_toConsumableArray2(xTrigger))[0],panel2);panel2._x_isShown=false;panel2.trigger=null;if(!panel2._x_doHide)panel2._x_doHide=function(){mutateDom(function(){panel2.style.setProperty("display","none",modifiers.includes("important")?"important":void 0);});};if(!panel2._x_doShow)panel2._x_doShow=function(){mutateDom(function(){panel2.style.setProperty("display","block",modifiers.includes("important")?"important":void 0);});};var hide2=function hide2(){panel2._x_doHide();panel2._x_isShown=false;};var show=function show(){panel2._x_doShow();panel2._x_isShown=true;};var clickAwayCompatibleShow=function clickAwayCompatibleShow(){return setTimeout(show);};var toggle=once(function(value){return value?show():hide2();},function(value){if(typeof panel2._x_toggleAndCascadeWithTransitions==="function"){panel2._x_toggleAndCascadeWithTransitions(panel2,value,show,hide2);}else{value?clickAwayCompatibleShow():hide2();}});var oldValue;var firstTime=true;effect(function(){return evaluate(function(value){if(!firstTime&&value===oldValue)return;if(modifiers.includes("immediate"))value?clickAwayCompatibleShow():hide2();toggle(value);oldValue=value;firstTime=false;});});panel2.open=/*#__PURE__*/function(){var _ref238=_asyncToGenerator(/*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee33(event){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:panel2.trigger=event.currentTarget?event.currentTarget:event;toggle(true);panel2.trigger.setAttribute("aria-expanded",true);if(config.component.trap)panel2.setAttribute("x-trap",true);cleanup=autoUpdate(panel2.trigger,panel2,function(){computePosition2(panel2.trigger,panel2,config["float"]).then(function(_ref239){var middlewareData=_ref239.middlewareData,placement=_ref239.placement,x=_ref239.x,y=_ref239.y;if(middlewareData.arrow){var _middlewareData$arrow3,_middlewareData$arrow4;var ax=(_middlewareData$arrow3=middlewareData.arrow)===null||_middlewareData$arrow3===void 0?void 0:_middlewareData$arrow3.x;var ay=(_middlewareData$arrow4=middlewareData.arrow)===null||_middlewareData$arrow4===void 0?void 0:_middlewareData$arrow4.y;var aEl=config["float"].middleware.filter(function(middleware){return middleware.name=="arrow";})[0].options.element;var staticSide={top:"bottom",right:"left",bottom:"top",left:"right"}[placement.split("-")[0]];Object.assign(aEl.style,_defineProperty3({left:ax!=null?"".concat(ax,"px"):"",top:ay!=null?"".concat(ay,"px"):"",right:"",bottom:""},staticSide,"-4px"));}if(middlewareData.hide){var referenceHidden=middlewareData.hide.referenceHidden;Object.assign(panel2.style,{visibility:referenceHidden?"hidden":"visible"});}Object.assign(panel2.style,{left:"".concat(x,"px"),top:"".concat(y,"px")});});});window.addEventListener("click",clickAway);window.addEventListener("keydown",keyEscape,true);case 7:case"end":return _context33.stop();}}},_callee33);}));return function(_x24){return _ref238.apply(this,arguments);};}();panel2.close=function(){toggle(false);panel2.trigger.setAttribute("aria-expanded",false);if(config.component.trap)panel2.setAttribute("x-trap",false);cleanup();window.removeEventListener("click",clickAway);window.removeEventListener("keydown",keyEscape,false);};panel2.toggle=function(event){panel2._x_isShown?panel2.close():panel2.open(event);};});}var module_default=src_default;// packages/forms/resources/js/index.js
window.pluralize=function(text3,number,variables){function extract(segments2,number2){var _iterator12=_createForOfIteratorHelper(segments2),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var part=_step12.value;var line=extractFromString(part,number2);if(line!==null){return line;}}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}}function extractFromString(part,number2){var matches2=part.match(/^[\[\{]((?:(?![\[\]\{\}])[\s\S])*)[\]\}]([\s\S]*)/);if(matches2===null||matches2.length!==3){return null;}var condition=matches2[1];var value2=matches2[2];if(condition.includes(",")){var _condition$split=condition.split(",",2),_condition$split2=_slicedToArray(_condition$split,2),from=_condition$split2[0],to=_condition$split2[1];if(to==="*"&&number2>=from){return value2;}else if(from==="*"&&number2<=to){return value2;}else if(number2>=from&&number2<=to){return value2;}}return condition==number2?value2:null;}function ucfirst(string){return string.toString().charAt(0).toUpperCase()+string.toString().slice(1);}function replace(line,replace2){if(replace2.length===0){return line;}var shouldReplace={};for(var _i7=0,_Object$entries2=Object.entries(replace2);_i7<_Object$entries2.length;_i7++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i7],2),key=_Object$entries2$_i[0],value2=_Object$entries2$_i[1];shouldReplace[":"+ucfirst(key!==null&&key!==void 0?key:"")]=ucfirst(value2!==null&&value2!==void 0?value2:"");shouldReplace[":"+key.toUpperCase()]=value2.toString().toUpperCase();shouldReplace[":"+key]=value2;}Object.entries(shouldReplace).forEach(function(_ref240){var _ref241=_slicedToArray(_ref240,2),key=_ref241[0],value2=_ref241[1];line=line.replaceAll(key,value2);});return line;}function stripConditions(segments2){return segments2.map(function(part){return part.replace(/^[\{\[]([^\[\]\{\}]*)[\}\]]/,"");});}var segments=text3.split("|");var value=extract(segments,number);if(value!==null&&value!==void 0){return replace(value.trim(),variables);}segments=stripConditions(segments);return replace(segments.length>1&&number>1?segments[1]:segments[0],variables);};var js_default=function js_default(Alpine){Alpine.plugin(color_picker_default2);Alpine.plugin(date_time_picker_default);Alpine.plugin(file_upload_default);Alpine.plugin(key_value_default);Alpine.plugin(markdown_editor_default);Alpine.plugin(rich_editor_default);Alpine.plugin(select_default);Alpine.plugin(tags_input_default);Alpine.plugin(text_input_default);Alpine.plugin(textarea_default);Alpine.plugin(sortable_default);Alpine.plugin(module_default);};

/***/ }),

/***/ "./vendor/filament/notifications/dist/module.esm.js":
/*!**********************************************************!*\
  !*** ./vendor/filament/notifications/dist/module.esm.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Notification": () => (/* binding */ Notification),
/* harmony export */   "NotificationAction": () => (/* binding */ Action),
/* harmony export */   "NotificationActionGroup": () => (/* binding */ ActionGroup),
/* harmony export */   "NotificationComponentAlpinePlugin": () => (/* binding */ notification_default),
/* harmony export */   "default": () => (/* binding */ js_default)
/* harmony export */ });
function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;

var __markAsModule = function __markAsModule(target) {
  return __defProp(target, "__esModule", {
    value: true
  });
};

var __commonJS = function __commonJS(callback, module) {
  return function () {
    if (!module) {
      module = {
        exports: {}
      };
      callback(module.exports, module);
    }

    return module.exports;
  };
};

var __exportStar = function __exportStar(target, module, desc) {
  if (module && _typeof(module) === "object" || typeof module === "function") {
    var _iterator = _createForOfIteratorHelper(__getOwnPropNames(module)),
        _step;

    try {
      var _loop = function _loop() {
        var key = _step.value;
        if (!__hasOwnProp.call(target, key) && key !== "default") __defProp(target, key, {
          get: function get() {
            return module[key];
          },
          enumerable: !(desc = __getOwnPropDesc(module, key)) || desc.enumerable
        });
      };

      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        _loop();
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }

  return target;
};

var __toModule = function __toModule(module) {
  return __exportStar(__markAsModule(__defProp(module != null ? __create(__getProtoOf(module)) : {}, "default", module && module.__esModule && "default" in module ? {
    get: function get() {
      return module["default"];
    },
    enumerable: true
  } : {
    value: module,
    enumerable: true
  })), module);
}; // node_modules/uuid-browser/lib/rng-browser.js


var require_rng_browser = __commonJS(function (exports, module) {
  var rng;
  var crypto = typeof __webpack_require__.g !== "undefined" && (__webpack_require__.g.crypto || __webpack_require__.g.msCrypto);

  if (crypto && crypto.getRandomValues) {
    rnds8 = new Uint8Array(16);

    rng = function whatwgRNG() {
      crypto.getRandomValues(rnds8);
      return rnds8;
    };
  }

  var rnds8;

  if (!rng) {
    rnds = new Array(16);

    rng = function rng() {
      for (var i = 0, r; i < 16; i++) {
        if ((i & 3) === 0) r = Math.random() * 4294967296;
        rnds[i] = r >>> ((i & 3) << 3) & 255;
      }

      return rnds;
    };
  }

  var rnds;
  module.exports = rng;
}); // node_modules/uuid-browser/lib/bytesToUuid.js


var require_bytesToUuid = __commonJS(function (exports, module) {
  var byteToHex = [];

  for (var i = 0; i < 256; ++i) {
    byteToHex[i] = (i + 256).toString(16).substr(1);
  }

  function bytesToUuid(buf, offset) {
    var i2 = offset || 0;
    var bth = byteToHex;
    return bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]] + "-" + bth[buf[i2++]] + bth[buf[i2++]] + "-" + bth[buf[i2++]] + bth[buf[i2++]] + "-" + bth[buf[i2++]] + bth[buf[i2++]] + "-" + bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]] + bth[buf[i2++]];
  }

  module.exports = bytesToUuid;
}); // node_modules/uuid-browser/v1.js


var require_v1 = __commonJS(function (exports, module) {
  var rng = require_rng_browser();
  var bytesToUuid = require_bytesToUuid();

  var _seedBytes = rng();

  var _nodeId = [_seedBytes[0] | 1, _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]];

  var _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 16383;

  var _lastMSecs = 0;
  var _lastNSecs = 0;

  function v1(options, buf, offset) {
    var i = buf && offset || 0;
    var b = buf || [];
    options = options || {};
    var clockseq = options.clockseq !== void 0 ? options.clockseq : _clockseq;
    var msecs = options.msecs !== void 0 ? options.msecs : new Date().getTime();
    var nsecs = options.nsecs !== void 0 ? options.nsecs : _lastNSecs + 1;
    var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 1e4;

    if (dt < 0 && options.clockseq === void 0) {
      clockseq = clockseq + 1 & 16383;
    }

    if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === void 0) {
      nsecs = 0;
    }

    if (nsecs >= 1e4) {
      throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
    }

    _lastMSecs = msecs;
    _lastNSecs = nsecs;
    _clockseq = clockseq;
    msecs += 122192928e5;
    var tl = ((msecs & 268435455) * 1e4 + nsecs) % 4294967296;
    b[i++] = tl >>> 24 & 255;
    b[i++] = tl >>> 16 & 255;
    b[i++] = tl >>> 8 & 255;
    b[i++] = tl & 255;
    var tmh = msecs / 4294967296 * 1e4 & 268435455;
    b[i++] = tmh >>> 8 & 255;
    b[i++] = tmh & 255;
    b[i++] = tmh >>> 24 & 15 | 16;
    b[i++] = tmh >>> 16 & 255;
    b[i++] = clockseq >>> 8 | 128;
    b[i++] = clockseq & 255;
    var node = options.node || _nodeId;

    for (var n = 0; n < 6; ++n) {
      b[i + n] = node[n];
    }

    return buf ? buf : bytesToUuid(b);
  }

  module.exports = v1;
}); // node_modules/uuid-browser/v4.js


var require_v4 = __commonJS(function (exports, module) {
  var rng = require_rng_browser();
  var bytesToUuid = require_bytesToUuid();

  function v4(options, buf, offset) {
    var i = buf && offset || 0;

    if (typeof options == "string") {
      buf = options == "binary" ? new Array(16) : null;
      options = null;
    }

    options = options || {};
    var rnds = options.random || (options.rng || rng)();
    rnds[6] = rnds[6] & 15 | 64;
    rnds[8] = rnds[8] & 63 | 128;

    if (buf) {
      for (var ii = 0; ii < 16; ++ii) {
        buf[i + ii] = rnds[ii];
      }
    }

    return buf || bytesToUuid(rnds);
  }

  module.exports = v4;
}); // node_modules/uuid-browser/index.js


var require_uuid_browser = __commonJS(function (exports, module) {
  var v1 = require_v1();
  var v4 = require_v4();
  var uuid2 = v4;
  uuid2.v1 = v1;
  uuid2.v4 = v4;
  module.exports = uuid2;
}); // node_modules/alpinejs/src/mutation.js


var onAttributeAddeds = [];
var onElRemoveds = [];
var onElAddeds = [];

function cleanupAttributes(el, names) {
  if (!el._x_attributeCleanups) return;
  Object.entries(el._x_attributeCleanups).forEach(function (_ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        name = _ref2[0],
        value = _ref2[1];

    if (names === void 0 || names.includes(name)) {
      value.forEach(function (i) {
        return i();
      });
      delete el._x_attributeCleanups[name];
    }
  });
}

var observer = new MutationObserver(onMutate);
var currentlyObserving = false;

function startObservingMutations() {
  observer.observe(document, {
    subtree: true,
    childList: true,
    attributes: true,
    attributeOldValue: true
  });
  currentlyObserving = true;
}

function stopObservingMutations() {
  flushObserver();
  observer.disconnect();
  currentlyObserving = false;
}

var recordQueue = [];
var willProcessRecordQueue = false;

function flushObserver() {
  recordQueue = recordQueue.concat(observer.takeRecords());

  if (recordQueue.length && !willProcessRecordQueue) {
    willProcessRecordQueue = true;
    queueMicrotask(function () {
      processRecordQueue();
      willProcessRecordQueue = false;
    });
  }
}

function processRecordQueue() {
  onMutate(recordQueue);
  recordQueue.length = 0;
}

function mutateDom(callback) {
  if (!currentlyObserving) return callback();
  stopObservingMutations();
  var result = callback();
  startObservingMutations();
  return result;
}

var isCollecting = false;
var deferredMutations = [];

function onMutate(mutations) {
  if (isCollecting) {
    deferredMutations = deferredMutations.concat(mutations);
    return;
  }

  var addedNodes = [];
  var removedNodes = [];
  var addedAttributes = new Map();
  var removedAttributes = new Map();

  for (var i = 0; i < mutations.length; i++) {
    if (mutations[i].target._x_ignoreMutationObserver) continue;

    if (mutations[i].type === "childList") {
      mutations[i].addedNodes.forEach(function (node) {
        return node.nodeType === 1 && addedNodes.push(node);
      });
      mutations[i].removedNodes.forEach(function (node) {
        return node.nodeType === 1 && removedNodes.push(node);
      });
    }

    if (mutations[i].type === "attributes") {
      (function () {
        var el = mutations[i].target;
        var name = mutations[i].attributeName;
        var oldValue = mutations[i].oldValue;

        var add = function add() {
          if (!addedAttributes.has(el)) addedAttributes.set(el, []);
          addedAttributes.get(el).push({
            name: name,
            value: el.getAttribute(name)
          });
        };

        var remove = function remove() {
          if (!removedAttributes.has(el)) removedAttributes.set(el, []);
          removedAttributes.get(el).push(name);
        };

        if (el.hasAttribute(name) && oldValue === null) {
          add();
        } else if (el.hasAttribute(name)) {
          remove();
          add();
        } else {
          remove();
        }
      })();
    }
  }

  removedAttributes.forEach(function (attrs, el) {
    cleanupAttributes(el, attrs);
  });
  addedAttributes.forEach(function (attrs, el) {
    onAttributeAddeds.forEach(function (i) {
      return i(el, attrs);
    });
  });

  var _loop2 = function _loop2() {
    var node = _removedNodes[_i2];
    if (addedNodes.includes(node)) return "continue";
    onElRemoveds.forEach(function (i) {
      return i(node);
    });

    if (node._x_cleanups) {
      while (node._x_cleanups.length) {
        node._x_cleanups.pop()();
      }
    }
  };

  for (var _i2 = 0, _removedNodes = removedNodes; _i2 < _removedNodes.length; _i2++) {
    var _ret = _loop2();

    if (_ret === "continue") continue;
  }

  addedNodes.forEach(function (node) {
    node._x_ignoreSelf = true;
    node._x_ignore = true;
  });

  var _loop3 = function _loop3() {
    var node = _addedNodes[_i3];
    if (removedNodes.includes(node)) return "continue";
    if (!node.isConnected) return "continue";
    delete node._x_ignoreSelf;
    delete node._x_ignore;
    onElAddeds.forEach(function (i) {
      return i(node);
    });
    node._x_ignore = true;
    node._x_ignoreSelf = true;
  };

  for (var _i3 = 0, _addedNodes = addedNodes; _i3 < _addedNodes.length; _i3++) {
    var _ret2 = _loop3();

    if (_ret2 === "continue") continue;
  }

  addedNodes.forEach(function (node) {
    delete node._x_ignoreSelf;
    delete node._x_ignore;
  });
  addedNodes = null;
  removedNodes = null;
  addedAttributes = null;
  removedAttributes = null;
} // node_modules/alpinejs/src/utils/once.js


function once(callback) {
  var fallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};
  var called = false;
  return function () {
    if (!called) {
      called = true;
      callback.apply(this, arguments);
    } else {
      fallback.apply(this, arguments);
    }
  };
} // packages/notifications/resources/js/components/notification.js


var notification_default = function notification_default(Alpine) {
  Alpine.data("notificationComponent", function (_ref3) {
    var notification = _ref3.notification;
    return {
      isShown: false,
      computedStyle: null,
      init: function init() {
        var _this = this;

        this.computedStyle = window.getComputedStyle(this.$el);
        this.configureTransitions();
        this.configureAnimations();

        if (notification.duration && notification.duration !== "persistent") {
          setTimeout(function () {
            return _this.close();
          }, notification.duration);
        }

        this.isShown = true;
      },
      configureTransitions: function configureTransitions() {
        var _this2 = this;

        var display = this.computedStyle.display;

        var show = function show() {
          mutateDom(function () {
            _this2.$el.style.setProperty("display", display);

            _this2.$el.style.setProperty("visibility", "visible");
          });
          _this2.$el._x_isShown = true;
        };

        var hide = function hide() {
          mutateDom(function () {
            _this2.$el._x_isShown ? _this2.$el.style.setProperty("visibility", "hidden") : _this2.$el.style.setProperty("display", "none");
          });
        };

        var toggle = once(function (value) {
          return value ? show() : hide();
        }, function (value) {
          _this2.$el._x_toggleAndCascadeWithTransitions(_this2.$el, value, show, hide);
        });
        Alpine.effect(function () {
          return toggle(_this2.isShown);
        });
      },
      configureAnimations: function configureAnimations() {
        var _this3 = this;

        var animation;
        Livewire.hook("message.received", function (_, component) {
          if (!component.serverMemo.data.isFilamentNotificationsComponent) {
            return;
          }

          var getTop = function getTop() {
            return _this3.$el.getBoundingClientRect().top;
          };

          var oldTop = getTop();

          animation = function animation() {
            _this3.$el.animate([{
              transform: "translateY(".concat(oldTop - getTop(), "px)")
            }, {
              transform: "translateY(0px)"
            }], {
              duration: _this3.getTransitionDuration(),
              easing: _this3.computedStyle.transitionTimingFunction
            });
          };

          _this3.$el.getAnimations().forEach(function (animation2) {
            return animation2.finish();
          });
        });
        Livewire.hook("message.processed", function (_, component) {
          if (!component.serverMemo.data.isFilamentNotificationsComponent) {
            return;
          }

          if (!_this3.isShown) {
            return;
          }

          animation();
        });
      },
      close: function close() {
        this.isShown = false;
        setTimeout(function () {
          return Livewire.emit("notificationClosed", notification.id);
        }, this.getTransitionDuration());
      },
      getTransitionDuration: function getTransitionDuration() {
        return parseFloat(this.computedStyle.transitionDuration) * 1e3;
      }
    };
  });
}; // packages/notifications/resources/js/Notification.js


var import_uuid_browser = __toModule(require_uuid_browser());

var Notification = /*#__PURE__*/function () {
  function Notification() {
    _classCallCheck(this, Notification);

    this.id((0, import_uuid_browser.v4)());
    return this;
  }

  _createClass(Notification, [{
    key: "id",
    value: function id(_id) {
      this.id = _id;
      return this;
    }
  }, {
    key: "title",
    value: function title(_title) {
      this.title = _title;
      return this;
    }
  }, {
    key: "body",
    value: function body(_body) {
      this.body = _body;
      return this;
    }
  }, {
    key: "actions",
    value: function actions(_actions) {
      this.actions = _actions;
      return this;
    }
  }, {
    key: "status",
    value: function status(_status) {
      switch (_status) {
        case "success":
          this.success();
          break;

        case "warning":
          this.warning();
          break;

        case "danger":
          this.danger();
          break;
      }

      return this;
    }
  }, {
    key: "icon",
    value: function icon(_icon) {
      this.icon = _icon;
      return this;
    }
  }, {
    key: "iconColor",
    value: function iconColor(color) {
      this.iconColor = color;
      return this;
    }
  }, {
    key: "duration",
    value: function duration(_duration) {
      this.duration = _duration;
      return this;
    }
  }, {
    key: "seconds",
    value: function seconds(_seconds) {
      this.duration(_seconds * 1e3);
      return this;
    }
  }, {
    key: "persistent",
    value: function persistent() {
      this.duration("persistent");
      return this;
    }
  }, {
    key: "success",
    value: function success() {
      this.icon("heroicon-o-check-circle");
      this.iconColor("success");
      return this;
    }
  }, {
    key: "warning",
    value: function warning() {
      this.icon("heroicon-o-exclamation-circle");
      this.iconColor("warning");
      return this;
    }
  }, {
    key: "danger",
    value: function danger() {
      this.icon("heroicon-o-x-circle");
      this.iconColor("danger");
      return this;
    }
  }, {
    key: "view",
    value: function view(_view) {
      this.view = _view;
      return this;
    }
  }, {
    key: "viewData",
    value: function viewData(_viewData) {
      this.viewData = _viewData;
      return this;
    }
  }, {
    key: "send",
    value: function send() {
      Livewire.emit("notificationSent", this);
      return this;
    }
  }]);

  return Notification;
}();

var Action = /*#__PURE__*/function () {
  function Action(name) {
    _classCallCheck(this, Action);

    this.name(name);
    return this;
  }

  _createClass(Action, [{
    key: "name",
    value: function name(_name) {
      this.name = _name;
      return this;
    }
  }, {
    key: "color",
    value: function color(_color) {
      this.color = _color;
      return this;
    }
  }, {
    key: "emit",
    value: function emit(event, data) {
      this.event(event);
      this.eventData(data);
      return this;
    }
  }, {
    key: "emitSelf",
    value: function emitSelf(event, data) {
      this.emit(event, data);
      this.emitDirection = "self";
      return this;
    }
  }, {
    key: "emitTo",
    value: function emitTo(component, event, data) {
      this.emit(event, data);
      this.emitDirection = "to";
      this.emitToComponent = component;
      return this;
    }
  }, {
    key: "emitUp",
    value: function emitUp(event, data) {
      this.emit(event, data);
      this.emitDirection = "up";
      return this;
    }
  }, {
    key: "emitDirection",
    value: function emitDirection(_emitDirection) {
      this.emitDirection = _emitDirection;
      return this;
    }
  }, {
    key: "emitToComponent",
    value: function emitToComponent(component) {
      this.emitToComponent = component;
      return this;
    }
  }, {
    key: "event",
    value: function event(_event) {
      this.event = _event;
      return this;
    }
  }, {
    key: "eventData",
    value: function eventData(data) {
      this.eventData = data;
      return this;
    }
  }, {
    key: "extraAttributes",
    value: function extraAttributes(attributes) {
      this.extraAttributes = attributes;
      return this;
    }
  }, {
    key: "icon",
    value: function icon(_icon2) {
      this.icon = _icon2;
      return this;
    }
  }, {
    key: "iconPosition",
    value: function iconPosition(position) {
      this.iconPosition = position;
      return this;
    }
  }, {
    key: "outlined",
    value: function outlined() {
      var condition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.isOutlined = condition;
      return this;
    }
  }, {
    key: "disabled",
    value: function disabled() {
      var condition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.isDisabled = condition;
      return this;
    }
  }, {
    key: "label",
    value: function label(_label) {
      this.label = _label;
      return this;
    }
  }, {
    key: "close",
    value: function close() {
      var condition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.shouldCloseNotification = condition;
      return this;
    }
  }, {
    key: "openUrlInNewTab",
    value: function openUrlInNewTab() {
      var condition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.shouldOpenUrlInNewTab = condition;
      return this;
    }
  }, {
    key: "size",
    value: function size(_size) {
      this.size = _size;
      return this;
    }
  }, {
    key: "url",
    value: function url(_url) {
      this.url = _url;
      return this;
    }
  }, {
    key: "view",
    value: function view(_view2) {
      this.view = _view2;
      return this;
    }
  }, {
    key: "button",
    value: function button() {
      this.view("notifications::actions.button-action");
      return this;
    }
  }, {
    key: "grouped",
    value: function grouped() {
      this.view("notifications::actions.grouped-action");
      return this;
    }
  }, {
    key: "link",
    value: function link() {
      this.view("notifications::actions.link-action");
      return this;
    }
  }]);

  return Action;
}();

var ActionGroup = /*#__PURE__*/function () {
  function ActionGroup(actions) {
    _classCallCheck(this, ActionGroup);

    this.actions(actions);
    return this;
  }

  _createClass(ActionGroup, [{
    key: "actions",
    value: function actions(_actions2) {
      this.actions = _actions2.map(function (action) {
        return action.grouped();
      });
      return this;
    }
  }, {
    key: "color",
    value: function color(_color2) {
      this.color = _color2;
      return this;
    }
  }, {
    key: "icon",
    value: function icon(_icon3) {
      this.icon = _icon3;
      return this;
    }
  }, {
    key: "iconPosition",
    value: function iconPosition(position) {
      this.iconPosition = position;
      return this;
    }
  }, {
    key: "label",
    value: function label(_label2) {
      this.label = _label2;
      return this;
    }
  }, {
    key: "tooltip",
    value: function tooltip(_tooltip) {
      this.tooltip = _tooltip;
      return this;
    }
  }]);

  return ActionGroup;
}(); // packages/notifications/resources/js/index.js


window.NotificationAction = Action;
window.NotificationActionGroup = ActionGroup;
window.Notification = Notification;

var js_default = function js_default(Alpine) {
  Alpine.plugin(notification_default);
};



/***/ }),

/***/ "./node_modules/choices.js/public/assets/scripts/choices.js":
/*!******************************************************************!*\
  !*** ./node_modules/choices.js/public/assets/scripts/choices.js ***!
  \******************************************************************/
/***/ ((module) => {

/*! choices.js v9.0.1 | © 2019 Josh Johnson | https://github.com/jshjohnson/Choices#readme */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else {}
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __nested_webpack_require_633__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __nested_webpack_require_633__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__nested_webpack_require_633__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__nested_webpack_require_633__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__nested_webpack_require_633__.d = function(exports, name, getter) {
/******/ 		if(!__nested_webpack_require_633__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__nested_webpack_require_633__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__nested_webpack_require_633__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __nested_webpack_require_633__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__nested_webpack_require_633__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __nested_webpack_require_633__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__nested_webpack_require_633__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__nested_webpack_require_633__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__nested_webpack_require_633__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__nested_webpack_require_633__.p = "/public/assets/scripts/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __nested_webpack_require_633__(__nested_webpack_require_633__.s = 4);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isMergeableObject = function isMergeableObject(value) {
	return isNonNullObject(value)
		&& !isSpecial(value)
};

function isNonNullObject(value) {
	return !!value && typeof value === 'object'
}

function isSpecial(value) {
	var stringValue = Object.prototype.toString.call(value);

	return stringValue === '[object RegExp]'
		|| stringValue === '[object Date]'
		|| isReactElement(value)
}

// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25
var canUseSymbol = typeof Symbol === 'function' && Symbol.for;
var REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;

function isReactElement(value) {
	return value.$$typeof === REACT_ELEMENT_TYPE
}

function emptyTarget(val) {
	return Array.isArray(val) ? [] : {}
}

function cloneUnlessOtherwiseSpecified(value, options) {
	return (options.clone !== false && options.isMergeableObject(value))
		? deepmerge(emptyTarget(value), value, options)
		: value
}

function defaultArrayMerge(target, source, options) {
	return target.concat(source).map(function(element) {
		return cloneUnlessOtherwiseSpecified(element, options)
	})
}

function getMergeFunction(key, options) {
	if (!options.customMerge) {
		return deepmerge
	}
	var customMerge = options.customMerge(key);
	return typeof customMerge === 'function' ? customMerge : deepmerge
}

function getEnumerableOwnPropertySymbols(target) {
	return Object.getOwnPropertySymbols
		? Object.getOwnPropertySymbols(target).filter(function(symbol) {
			return target.propertyIsEnumerable(symbol)
		})
		: []
}

function getKeys(target) {
	return Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))
}

// Protects from prototype poisoning and unexpected merging up the prototype chain.
function propertyIsUnsafe(target, key) {
	try {
		return (key in target) // Properties are safe to merge if they don't exist in the target yet,
			&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,
				&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.
	} catch (unused) {
		// Counterintuitively, it's safe to merge any property on a target that causes the `in` operator to throw.
		// This happens when trying to copy an object in the source over a plain string in the target.
		return false
	}
}

function mergeObject(target, source, options) {
	var destination = {};
	if (options.isMergeableObject(target)) {
		getKeys(target).forEach(function(key) {
			destination[key] = cloneUnlessOtherwiseSpecified(target[key], options);
		});
	}
	getKeys(source).forEach(function(key) {
		if (propertyIsUnsafe(target, key)) {
			return
		}

		if (!options.isMergeableObject(source[key]) || !target[key]) {
			destination[key] = cloneUnlessOtherwiseSpecified(source[key], options);
		} else {
			destination[key] = getMergeFunction(key, options)(target[key], source[key], options);
		}
	});
	return destination
}

function deepmerge(target, source, options) {
	options = options || {};
	options.arrayMerge = options.arrayMerge || defaultArrayMerge;
	options.isMergeableObject = options.isMergeableObject || isMergeableObject;
	// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()
	// implementations can use it. The caller may not replace it.
	options.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;

	var sourceIsArray = Array.isArray(source);
	var targetIsArray = Array.isArray(target);
	var sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;

	if (!sourceAndTargetTypesMatch) {
		return cloneUnlessOtherwiseSpecified(source, options)
	} else if (sourceIsArray) {
		return options.arrayMerge(target, source, options)
	} else {
		return mergeObject(target, source, options)
	}
}

deepmerge.all = function deepmergeAll(array, options) {
	if (!Array.isArray(array)) {
		throw new Error('first argument should be an array')
	}

	return array.reduce(function(prev, next) {
		return deepmerge(prev, next, options)
	}, {})
};

var deepmerge_1 = deepmerge;

module.exports = deepmerge_1;


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_8347__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global, module) {/* harmony import */ var _ponyfill_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_8347__(3);
/* global window */


var root;

if (typeof self !== 'undefined') {
  root = self;
} else if (typeof window !== 'undefined') {
  root = window;
} else if (typeof global !== 'undefined') {
  root = global;
} else if (true) {
  root = module;
} else {}

var result = Object(_ponyfill_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(root);
/* harmony default export */ __webpack_exports__["a"] = (result);

/* WEBPACK VAR INJECTION */}.call(this, __nested_webpack_require_8347__(5), __nested_webpack_require_8347__(6)(module)))

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.4.5 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
!function(e,t){  true?module.exports=t():0}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(2),a=n(8),s=n(0),c=function(){function e(t,n){var r=n.location,o=void 0===r?0:r,i=n.distance,s=void 0===i?100:i,c=n.threshold,h=void 0===c?.6:c,l=n.maxPatternLength,u=void 0===l?32:l,f=n.caseSensitive,d=void 0!==f&&f,v=n.tokenSeparator,p=void 0===v?/ +/g:v,g=n.findAllMatches,y=void 0!==g&&g,m=n.minMatchCharLength,k=void 0===m?1:m,S=n.id,x=void 0===S?null:S,b=n.keys,M=void 0===b?[]:b,_=n.shouldSort,L=void 0===_||_,w=n.getFn,A=void 0===w?a:w,C=n.sortFn,I=void 0===C?function(e,t){return e.score-t.score}:C,O=n.tokenize,j=void 0!==O&&O,P=n.matchAllTokens,F=void 0!==P&&P,T=n.includeMatches,z=void 0!==T&&T,E=n.includeScore,K=void 0!==E&&E,$=n.verbose,J=void 0!==$&&$;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:d,tokenSeparator:p,findAllMatches:y,minMatchCharLength:k,id:x,keys:M,includeMatches:z,includeScore:K,shouldSort:L,getFn:A,sortFn:I,verbose:J,tokenize:j,matchAllTokens:F},this.setCollection(t)}var t,n,c;return t=e,(n=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),r=n.tokenSearchers,o=n.fullSearcher,i=this._search(r,o),a=i.weights,s=i.results;return this._computeScore(a,s),this.options.shouldSort&&this._sort(s),t.limit&&"number"==typeof t.limit&&(s=s.slice(0,t.limit)),this._format(s)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),r=0,o=n.length;r<o;r+=1)t.push(new i(n[r],this.options));return{tokenSearchers:t,fullSearcher:new i(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,r={},o=[];if("string"==typeof n[0]){for(var i=0,a=n.length;i<a;i+=1)this._analyze({key:"",value:n[i],record:i,index:i},{resultMap:r,results:o,tokenSearchers:e,fullSearcher:t});return{weights:null,results:o}}for(var s={},c=0,h=n.length;c<h;c+=1)for(var l=n[c],u=0,f=this.options.keys.length;u<f;u+=1){var d=this.options.keys[u];if("string"!=typeof d){if(s[d.name]={weight:1-d.weight||1},d.weight<=0||d.weight>1)throw new Error("Key weight has to be > 0 and <= 1");d=d.name}else s[d]={weight:1};this._analyze({key:d,value:this.options.getFn(l,d),record:l,index:c},{resultMap:r,results:o,tokenSearchers:e,fullSearcher:t})}return{weights:s,results:o}}},{key:"_analyze",value:function(e,t){var n=e.key,r=e.arrayIndex,o=void 0===r?-1:r,i=e.value,a=e.record,c=e.index,h=t.tokenSearchers,l=void 0===h?[]:h,u=t.fullSearcher,f=void 0===u?[]:u,d=t.resultMap,v=void 0===d?{}:d,p=t.results,g=void 0===p?[]:p;if(null!=i){var y=!1,m=-1,k=0;if("string"==typeof i){this._log("\nKey: ".concat(""===n?"-":n));var S=f.search(i);if(this._log('Full text: "'.concat(i,'", score: ').concat(S.score)),this.options.tokenize){for(var x=i.split(this.options.tokenSeparator),b=[],M=0;M<l.length;M+=1){var _=l[M];this._log('\nPattern: "'.concat(_.pattern,'"'));for(var L=!1,w=0;w<x.length;w+=1){var A=x[w],C=_.search(A),I={};C.isMatch?(I[A]=C.score,y=!0,L=!0,b.push(C.score)):(I[A]=1,this.options.matchAllTokens||b.push(1)),this._log('Token: "'.concat(A,'", score: ').concat(I[A]))}L&&(k+=1)}m=b[0];for(var O=b.length,j=1;j<O;j+=1)m+=b[j];m/=O,this._log("Token score average:",m)}var P=S.score;m>-1&&(P=(P+m)/2),this._log("Score average:",P);var F=!this.options.tokenize||!this.options.matchAllTokens||k>=l.length;if(this._log("\nCheck Matches: ".concat(F)),(y||S.isMatch)&&F){var T=v[c];T?T.output.push({key:n,arrayIndex:o,value:i,score:P,matchedIndices:S.matchedIndices}):(v[c]={item:a,output:[{key:n,arrayIndex:o,value:i,score:P,matchedIndices:S.matchedIndices}]},g.push(v[c]))}}else if(s(i))for(var z=0,E=i.length;z<E;z+=1)this._analyze({key:n,arrayIndex:z,value:i[z],record:a,index:c},{resultMap:v,results:g,tokenSearchers:l,fullSearcher:f})}}},{key:"_computeScore",value:function(e,t){this._log("\n\nComputing score:\n");for(var n=0,r=t.length;n<r;n+=1){for(var o=t[n].output,i=o.length,a=1,s=1,c=0;c<i;c+=1){var h=e?e[o[c].key].weight:1,l=(1===h?o[c].score:o[c].score||.001)*h;1!==h?s=Math.min(s,l):(o[c].nScore=l,a*=l)}t[n].score=1===s?a:s,this._log(t[n])}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,function(e,t){if("object"===r(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t})),n=null}var o=[];this.options.includeMatches&&o.push(function(e,t){var n=e.output;t.matches=[];for(var r=0,o=n.length;r<o;r+=1){var i=n[r];if(0!==i.matchedIndices.length){var a={indices:i.matchedIndices,value:i.value};i.key&&(a.key=i.key),i.hasOwnProperty("arrayIndex")&&i.arrayIndex>-1&&(a.arrayIndex=i.arrayIndex),t.matches.push(a)}}}),this.options.includeScore&&o.push(function(e,t){t.score=e.score});for(var i=0,a=e.length;i<a;i+=1){var s=e[i];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),o.length){for(var c={item:s.item},h=0,l=o.length;h<l;h+=1)o[h](s,c);t.push(c)}else t.push(s.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(t.prototype,n),c&&o(t,c),e}();e.exports=c},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(3),i=n(4),a=n(7),s=function(){function e(t,n){var r=n.location,o=void 0===r?0:r,i=n.distance,s=void 0===i?100:i,c=n.threshold,h=void 0===c?.6:c,l=n.maxPatternLength,u=void 0===l?32:l,f=n.isCaseSensitive,d=void 0!==f&&f,v=n.tokenSeparator,p=void 0===v?/ +/g:v,g=n.findAllMatches,y=void 0!==g&&g,m=n.minMatchCharLength,k=void 0===m?1:m;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:d,tokenSeparator:p,findAllMatches:y,minMatchCharLength:k},this.pattern=this.options.isCaseSensitive?t:t.toLowerCase(),this.pattern.length<=u&&(this.patternAlphabet=a(this.pattern))}var t,n,s;return t=e,(n=[{key:"search",value:function(e){if(this.options.isCaseSensitive||(e=e.toLowerCase()),this.pattern===e)return{isMatch:!0,score:0,matchedIndices:[[0,e.length-1]]};var t=this.options,n=t.maxPatternLength,r=t.tokenSeparator;if(this.pattern.length>n)return o(e,this.pattern,r);var a=this.options,s=a.location,c=a.distance,h=a.threshold,l=a.findAllMatches,u=a.minMatchCharLength;return i(e,this.pattern,this.patternAlphabet,{location:s,distance:c,threshold:h,findAllMatches:l,minMatchCharLength:u})}}])&&r(t.prototype,n),s&&r(t,s),e}();e.exports=s},function(e,t){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(n,"\\$&").replace(r,"|")),i=e.match(o),a=!!i,s=[];if(a)for(var c=0,h=i.length;c<h;c+=1){var l=i[c];s.push([e.indexOf(l),l.length-1])}return{score:a?.5:1,isMatch:a,matchedIndices:s}}},function(e,t,n){var r=n(5),o=n(6);e.exports=function(e,t,n,i){for(var a=i.location,s=void 0===a?0:a,c=i.distance,h=void 0===c?100:c,l=i.threshold,u=void 0===l?.6:l,f=i.findAllMatches,d=void 0!==f&&f,v=i.minMatchCharLength,p=void 0===v?1:v,g=s,y=e.length,m=u,k=e.indexOf(t,g),S=t.length,x=[],b=0;b<y;b+=1)x[b]=0;if(-1!==k){var M=r(t,{errors:0,currentLocation:k,expectedLocation:g,distance:h});if(m=Math.min(M,m),-1!==(k=e.lastIndexOf(t,g+S))){var _=r(t,{errors:0,currentLocation:k,expectedLocation:g,distance:h});m=Math.min(_,m)}}k=-1;for(var L=[],w=1,A=S+y,C=1<<S-1,I=0;I<S;I+=1){for(var O=0,j=A;O<j;){r(t,{errors:I,currentLocation:g+j,expectedLocation:g,distance:h})<=m?O=j:A=j,j=Math.floor((A-O)/2+O)}A=j;var P=Math.max(1,g-j+1),F=d?y:Math.min(g+j,y)+S,T=Array(F+2);T[F+1]=(1<<I)-1;for(var z=F;z>=P;z-=1){var E=z-1,K=n[e.charAt(E)];if(K&&(x[E]=1),T[z]=(T[z+1]<<1|1)&K,0!==I&&(T[z]|=(L[z+1]|L[z])<<1|1|L[z+1]),T[z]&C&&(w=r(t,{errors:I,currentLocation:E,expectedLocation:g,distance:h}))<=m){if(m=w,(k=E)<=g)break;P=Math.max(1,2*g-k)}}if(r(t,{errors:I+1,currentLocation:g,expectedLocation:g,distance:h})>m)break;L=T}return{isMatch:k>=0,score:0===w?.001:w,matchedIndices:o(x,p)}}},function(e,t){e.exports=function(e,t){var n=t.errors,r=void 0===n?0:n,o=t.currentLocation,i=void 0===o?0:o,a=t.expectedLocation,s=void 0===a?0:a,c=t.distance,h=void 0===c?100:c,l=r/e.length,u=Math.abs(s-i);return h?l+u/h:u?1:l}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,o=-1,i=0,a=e.length;i<a;i+=1){var s=e[i];s&&-1===r?r=i:s||-1===r||((o=i-1)-r+1>=t&&n.push([r,o]),r=-1)}return e[i-1]&&i-r>=t&&n.push([r,i-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,r=0;r<n;r+=1)t[e.charAt(r)]=0;for(var o=0;o<n;o+=1)t[e.charAt(o)]|=1<<n-o-1;return t}},function(e,t,n){var r=n(0);e.exports=function(e,t){return function e(t,n,o){if(n){var i=n.indexOf("."),a=n,s=null;-1!==i&&(a=n.slice(0,i),s=n.slice(i+1));var c=t[a];if(null!=c)if(s||"string"!=typeof c&&"number"!=typeof c)if(r(c))for(var h=0,l=c.length;h<l;h+=1)e(c[h],s,o);else s&&e(c,s,o);else o.push(c.toString())}else o.push(t);return o}(e,t,[])}}])});

/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_20511__) {

"use strict";
/* harmony export (binding) */ __nested_webpack_require_20511__.d(__webpack_exports__, "a", function() { return symbolObservablePonyfill; });
function symbolObservablePonyfill(root) {
	var result;
	var Symbol = root.Symbol;

	if (typeof Symbol === 'function') {
		if (Symbol.observable) {
			result = Symbol.observable;
		} else {
			result = Symbol('observable');
			Symbol.observable = result;
		}
	} else {
		result = '@@observable';
	}

	return result;
};


/***/ }),
/* 4 */
/***/ (function(module, exports, __nested_webpack_require_21049__) {

module.exports = __nested_webpack_require_21049__(7);


/***/ }),
/* 5 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 6 */
/***/ (function(module, exports) {

module.exports = function(originalModule) {
	if (!originalModule.webpackPolyfill) {
		var module = Object.create(originalModule);
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		Object.defineProperty(module, "exports", {
			enumerable: true
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),
/* 7 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_22336__) {

"use strict";
__nested_webpack_require_22336__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/fuse.js/dist/fuse.js
var dist_fuse = __nested_webpack_require_22336__(2);
var fuse_default = /*#__PURE__*/__nested_webpack_require_22336__.n(dist_fuse);

// EXTERNAL MODULE: ./node_modules/deepmerge/dist/cjs.js
var cjs = __nested_webpack_require_22336__(0);
var cjs_default = /*#__PURE__*/__nested_webpack_require_22336__.n(cjs);

// EXTERNAL MODULE: ./node_modules/symbol-observable/es/index.js
var es = __nested_webpack_require_22336__(1);

// CONCATENATED MODULE: ./node_modules/redux/es/redux.js


/**
 * These are private action types reserved by Redux.
 * For any unknown actions, you must return the current state.
 * If the current state is undefined, you must return the initial state.
 * Do not reference these action types directly in your code.
 */
var randomString = function randomString() {
  return Math.random().toString(36).substring(7).split('').join('.');
};

var ActionTypes = {
  INIT: "@@redux/INIT" + randomString(),
  REPLACE: "@@redux/REPLACE" + randomString(),
  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {
    return "@@redux/PROBE_UNKNOWN_ACTION" + randomString();
  }
};

/**
 * @param {any} obj The object to inspect.
 * @returns {boolean} True if the argument appears to be a plain object.
 */
function isPlainObject(obj) {
  if (typeof obj !== 'object' || obj === null) return false;
  var proto = obj;

  while (Object.getPrototypeOf(proto) !== null) {
    proto = Object.getPrototypeOf(proto);
  }

  return Object.getPrototypeOf(obj) === proto;
}

/**
 * Creates a Redux store that holds the state tree.
 * The only way to change the data in the store is to call `dispatch()` on it.
 *
 * There should only be a single store in your app. To specify how different
 * parts of the state tree respond to actions, you may combine several reducers
 * into a single reducer function by using `combineReducers`.
 *
 * @param {Function} reducer A function that returns the next state tree, given
 * the current state tree and the action to handle.
 *
 * @param {any} [preloadedState] The initial state. You may optionally specify it
 * to hydrate the state from the server in universal apps, or to restore a
 * previously serialized user session.
 * If you use `combineReducers` to produce the root reducer function, this must be
 * an object with the same shape as `combineReducers` keys.
 *
 * @param {Function} [enhancer] The store enhancer. You may optionally specify it
 * to enhance the store with third-party capabilities such as middleware,
 * time travel, persistence, etc. The only store enhancer that ships with Redux
 * is `applyMiddleware()`.
 *
 * @returns {Store} A Redux store that lets you read the state, dispatch actions
 * and subscribe to changes.
 */

function createStore(reducer, preloadedState, enhancer) {
  var _ref2;

  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {
    throw new Error('It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function.');
  }

  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {
    enhancer = preloadedState;
    preloadedState = undefined;
  }

  if (typeof enhancer !== 'undefined') {
    if (typeof enhancer !== 'function') {
      throw new Error('Expected the enhancer to be a function.');
    }

    return enhancer(createStore)(reducer, preloadedState);
  }

  if (typeof reducer !== 'function') {
    throw new Error('Expected the reducer to be a function.');
  }

  var currentReducer = reducer;
  var currentState = preloadedState;
  var currentListeners = [];
  var nextListeners = currentListeners;
  var isDispatching = false;
  /**
   * This makes a shallow copy of currentListeners so we can use
   * nextListeners as a temporary list while dispatching.
   *
   * This prevents any bugs around consumers calling
   * subscribe/unsubscribe in the middle of a dispatch.
   */

  function ensureCanMutateNextListeners() {
    if (nextListeners === currentListeners) {
      nextListeners = currentListeners.slice();
    }
  }
  /**
   * Reads the state tree managed by the store.
   *
   * @returns {any} The current state tree of your application.
   */


  function getState() {
    if (isDispatching) {
      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');
    }

    return currentState;
  }
  /**
   * Adds a change listener. It will be called any time an action is dispatched,
   * and some part of the state tree may potentially have changed. You may then
   * call `getState()` to read the current state tree inside the callback.
   *
   * You may call `dispatch()` from a change listener, with the following
   * caveats:
   *
   * 1. The subscriptions are snapshotted just before every `dispatch()` call.
   * If you subscribe or unsubscribe while the listeners are being invoked, this
   * will not have any effect on the `dispatch()` that is currently in progress.
   * However, the next `dispatch()` call, whether nested or not, will use a more
   * recent snapshot of the subscription list.
   *
   * 2. The listener should not expect to see all state changes, as the state
   * might have been updated multiple times during a nested `dispatch()` before
   * the listener is called. It is, however, guaranteed that all subscribers
   * registered before the `dispatch()` started will be called with the latest
   * state by the time it exits.
   *
   * @param {Function} listener A callback to be invoked on every dispatch.
   * @returns {Function} A function to remove this change listener.
   */


  function subscribe(listener) {
    if (typeof listener !== 'function') {
      throw new Error('Expected the listener to be a function.');
    }

    if (isDispatching) {
      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');
    }

    var isSubscribed = true;
    ensureCanMutateNextListeners();
    nextListeners.push(listener);
    return function unsubscribe() {
      if (!isSubscribed) {
        return;
      }

      if (isDispatching) {
        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');
      }

      isSubscribed = false;
      ensureCanMutateNextListeners();
      var index = nextListeners.indexOf(listener);
      nextListeners.splice(index, 1);
    };
  }
  /**
   * Dispatches an action. It is the only way to trigger a state change.
   *
   * The `reducer` function, used to create the store, will be called with the
   * current state tree and the given `action`. Its return value will
   * be considered the **next** state of the tree, and the change listeners
   * will be notified.
   *
   * The base implementation only supports plain object actions. If you want to
   * dispatch a Promise, an Observable, a thunk, or something else, you need to
   * wrap your store creating function into the corresponding middleware. For
   * example, see the documentation for the `redux-thunk` package. Even the
   * middleware will eventually dispatch plain object actions using this method.
   *
   * @param {Object} action A plain object representing “what changed”. It is
   * a good idea to keep actions serializable so you can record and replay user
   * sessions, or use the time travelling `redux-devtools`. An action must have
   * a `type` property which may not be `undefined`. It is a good idea to use
   * string constants for action types.
   *
   * @returns {Object} For convenience, the same action object you dispatched.
   *
   * Note that, if you use a custom middleware, it may wrap `dispatch()` to
   * return something else (for example, a Promise you can await).
   */


  function dispatch(action) {
    if (!isPlainObject(action)) {
      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');
    }

    if (typeof action.type === 'undefined') {
      throw new Error('Actions may not have an undefined "type" property. ' + 'Have you misspelled a constant?');
    }

    if (isDispatching) {
      throw new Error('Reducers may not dispatch actions.');
    }

    try {
      isDispatching = true;
      currentState = currentReducer(currentState, action);
    } finally {
      isDispatching = false;
    }

    var listeners = currentListeners = nextListeners;

    for (var i = 0; i < listeners.length; i++) {
      var listener = listeners[i];
      listener();
    }

    return action;
  }
  /**
   * Replaces the reducer currently used by the store to calculate the state.
   *
   * You might need this if your app implements code splitting and you want to
   * load some of the reducers dynamically. You might also need this if you
   * implement a hot reloading mechanism for Redux.
   *
   * @param {Function} nextReducer The reducer for the store to use instead.
   * @returns {void}
   */


  function replaceReducer(nextReducer) {
    if (typeof nextReducer !== 'function') {
      throw new Error('Expected the nextReducer to be a function.');
    }

    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.
    // Any reducers that existed in both the new and old rootReducer
    // will receive the previous state. This effectively populates
    // the new state tree with any relevant data from the old one.

    dispatch({
      type: ActionTypes.REPLACE
    });
  }
  /**
   * Interoperability point for observable/reactive libraries.
   * @returns {observable} A minimal observable of state changes.
   * For more information, see the observable proposal:
   * https://github.com/tc39/proposal-observable
   */


  function observable() {
    var _ref;

    var outerSubscribe = subscribe;
    return _ref = {
      /**
       * The minimal observable subscription method.
       * @param {Object} observer Any object that can be used as an observer.
       * The observer object should have a `next` method.
       * @returns {subscription} An object with an `unsubscribe` method that can
       * be used to unsubscribe the observable from the store, and prevent further
       * emission of values from the observable.
       */
      subscribe: function subscribe(observer) {
        if (typeof observer !== 'object' || observer === null) {
          throw new TypeError('Expected the observer to be an object.');
        }

        function observeState() {
          if (observer.next) {
            observer.next(getState());
          }
        }

        observeState();
        var unsubscribe = outerSubscribe(observeState);
        return {
          unsubscribe: unsubscribe
        };
      }
    }, _ref[es["a" /* default */]] = function () {
      return this;
    }, _ref;
  } // When a store is created, an "INIT" action is dispatched so that every
  // reducer returns their initial state. This effectively populates
  // the initial state tree.


  dispatch({
    type: ActionTypes.INIT
  });
  return _ref2 = {
    dispatch: dispatch,
    subscribe: subscribe,
    getState: getState,
    replaceReducer: replaceReducer
  }, _ref2[es["a" /* default */]] = observable, _ref2;
}

/**
 * Prints a warning in the console if it exists.
 *
 * @param {String} message The warning message.
 * @returns {void}
 */
function warning(message) {
  /* eslint-disable no-console */
  if (typeof console !== 'undefined' && typeof console.error === 'function') {
    console.error(message);
  }
  /* eslint-enable no-console */


  try {
    // This error was thrown as a convenience so that if you enable
    // "break on all exceptions" in your console,
    // it would pause the execution at this line.
    throw new Error(message);
  } catch (e) {} // eslint-disable-line no-empty

}

function getUndefinedStateErrorMessage(key, action) {
  var actionType = action && action.type;
  var actionDescription = actionType && "action \"" + String(actionType) + "\"" || 'an action';
  return "Given " + actionDescription + ", reducer \"" + key + "\" returned undefined. " + "To ignore an action, you must explicitly return the previous state. " + "If you want this reducer to hold no value, you can return null instead of undefined.";
}

function getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {
  var reducerKeys = Object.keys(reducers);
  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';

  if (reducerKeys.length === 0) {
    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';
  }

  if (!isPlainObject(inputState)) {
    return "The " + argumentName + " has unexpected type of \"" + {}.toString.call(inputState).match(/\s([a-z|A-Z]+)/)[1] + "\". Expected argument to be an object with the following " + ("keys: \"" + reducerKeys.join('", "') + "\"");
  }

  var unexpectedKeys = Object.keys(inputState).filter(function (key) {
    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];
  });
  unexpectedKeys.forEach(function (key) {
    unexpectedKeyCache[key] = true;
  });
  if (action && action.type === ActionTypes.REPLACE) return;

  if (unexpectedKeys.length > 0) {
    return "Unexpected " + (unexpectedKeys.length > 1 ? 'keys' : 'key') + " " + ("\"" + unexpectedKeys.join('", "') + "\" found in " + argumentName + ". ") + "Expected to find one of the known reducer keys instead: " + ("\"" + reducerKeys.join('", "') + "\". Unexpected keys will be ignored.");
  }
}

function assertReducerShape(reducers) {
  Object.keys(reducers).forEach(function (key) {
    var reducer = reducers[key];
    var initialState = reducer(undefined, {
      type: ActionTypes.INIT
    });

    if (typeof initialState === 'undefined') {
      throw new Error("Reducer \"" + key + "\" returned undefined during initialization. " + "If the state passed to the reducer is undefined, you must " + "explicitly return the initial state. The initial state may " + "not be undefined. If you don't want to set a value for this reducer, " + "you can use null instead of undefined.");
    }

    if (typeof reducer(undefined, {
      type: ActionTypes.PROBE_UNKNOWN_ACTION()
    }) === 'undefined') {
      throw new Error("Reducer \"" + key + "\" returned undefined when probed with a random type. " + ("Don't try to handle " + ActionTypes.INIT + " or other actions in \"redux/*\" ") + "namespace. They are considered private. Instead, you must return the " + "current state for any unknown actions, unless it is undefined, " + "in which case you must return the initial state, regardless of the " + "action type. The initial state may not be undefined, but can be null.");
    }
  });
}
/**
 * Turns an object whose values are different reducer functions, into a single
 * reducer function. It will call every child reducer, and gather their results
 * into a single state object, whose keys correspond to the keys of the passed
 * reducer functions.
 *
 * @param {Object} reducers An object whose values correspond to different
 * reducer functions that need to be combined into one. One handy way to obtain
 * it is to use ES6 `import * as reducers` syntax. The reducers may never return
 * undefined for any action. Instead, they should return their initial state
 * if the state passed to them was undefined, and the current state for any
 * unrecognized action.
 *
 * @returns {Function} A reducer function that invokes every reducer inside the
 * passed object, and builds a state object with the same shape.
 */


function combineReducers(reducers) {
  var reducerKeys = Object.keys(reducers);
  var finalReducers = {};

  for (var i = 0; i < reducerKeys.length; i++) {
    var key = reducerKeys[i];

    if (false) {}

    if (typeof reducers[key] === 'function') {
      finalReducers[key] = reducers[key];
    }
  }

  var finalReducerKeys = Object.keys(finalReducers); // This is used to make sure we don't warn about the same
  // keys multiple times.

  var unexpectedKeyCache;

  if (false) {}

  var shapeAssertionError;

  try {
    assertReducerShape(finalReducers);
  } catch (e) {
    shapeAssertionError = e;
  }

  return function combination(state, action) {
    if (state === void 0) {
      state = {};
    }

    if (shapeAssertionError) {
      throw shapeAssertionError;
    }

    if (false) { var warningMessage; }

    var hasChanged = false;
    var nextState = {};

    for (var _i = 0; _i < finalReducerKeys.length; _i++) {
      var _key = finalReducerKeys[_i];
      var reducer = finalReducers[_key];
      var previousStateForKey = state[_key];
      var nextStateForKey = reducer(previousStateForKey, action);

      if (typeof nextStateForKey === 'undefined') {
        var errorMessage = getUndefinedStateErrorMessage(_key, action);
        throw new Error(errorMessage);
      }

      nextState[_key] = nextStateForKey;
      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;
    }

    return hasChanged ? nextState : state;
  };
}

function bindActionCreator(actionCreator, dispatch) {
  return function () {
    return dispatch(actionCreator.apply(this, arguments));
  };
}
/**
 * Turns an object whose values are action creators, into an object with the
 * same keys, but with every function wrapped into a `dispatch` call so they
 * may be invoked directly. This is just a convenience method, as you can call
 * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.
 *
 * For convenience, you can also pass an action creator as the first argument,
 * and get a dispatch wrapped function in return.
 *
 * @param {Function|Object} actionCreators An object whose values are action
 * creator functions. One handy way to obtain it is to use ES6 `import * as`
 * syntax. You may also pass a single function.
 *
 * @param {Function} dispatch The `dispatch` function available on your Redux
 * store.
 *
 * @returns {Function|Object} The object mimicking the original object, but with
 * every action creator wrapped into the `dispatch` call. If you passed a
 * function as `actionCreators`, the return value will also be a single
 * function.
 */


function bindActionCreators(actionCreators, dispatch) {
  if (typeof actionCreators === 'function') {
    return bindActionCreator(actionCreators, dispatch);
  }

  if (typeof actionCreators !== 'object' || actionCreators === null) {
    throw new Error("bindActionCreators expected an object or a function, instead received " + (actionCreators === null ? 'null' : typeof actionCreators) + ". " + "Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?");
  }

  var boundActionCreators = {};

  for (var key in actionCreators) {
    var actionCreator = actionCreators[key];

    if (typeof actionCreator === 'function') {
      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);
    }
  }

  return boundActionCreators;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    keys.push.apply(keys, Object.getOwnPropertySymbols(object));
  }

  if (enumerableOnly) keys = keys.filter(function (sym) {
    return Object.getOwnPropertyDescriptor(object, sym).enumerable;
  });
  return keys;
}

function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(source, true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(source).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

/**
 * Composes single-argument functions from right to left. The rightmost
 * function can take multiple arguments as it provides the signature for
 * the resulting composite function.
 *
 * @param {...Function} funcs The functions to compose.
 * @returns {Function} A function obtained by composing the argument functions
 * from right to left. For example, compose(f, g, h) is identical to doing
 * (...args) => f(g(h(...args))).
 */
function compose() {
  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {
    funcs[_key] = arguments[_key];
  }

  if (funcs.length === 0) {
    return function (arg) {
      return arg;
    };
  }

  if (funcs.length === 1) {
    return funcs[0];
  }

  return funcs.reduce(function (a, b) {
    return function () {
      return a(b.apply(void 0, arguments));
    };
  });
}

/**
 * Creates a store enhancer that applies middleware to the dispatch method
 * of the Redux store. This is handy for a variety of tasks, such as expressing
 * asynchronous actions in a concise manner, or logging every action payload.
 *
 * See `redux-thunk` package as an example of the Redux middleware.
 *
 * Because middleware is potentially asynchronous, this should be the first
 * store enhancer in the composition chain.
 *
 * Note that each middleware will be given the `dispatch` and `getState` functions
 * as named arguments.
 *
 * @param {...Function} middlewares The middleware chain to be applied.
 * @returns {Function} A store enhancer applying the middleware.
 */

function applyMiddleware() {
  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {
    middlewares[_key] = arguments[_key];
  }

  return function (createStore) {
    return function () {
      var store = createStore.apply(void 0, arguments);

      var _dispatch = function dispatch() {
        throw new Error('Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.');
      };

      var middlewareAPI = {
        getState: store.getState,
        dispatch: function dispatch() {
          return _dispatch.apply(void 0, arguments);
        }
      };
      var chain = middlewares.map(function (middleware) {
        return middleware(middlewareAPI);
      });
      _dispatch = compose.apply(void 0, chain)(store.dispatch);
      return _objectSpread2({}, store, {
        dispatch: _dispatch
      });
    };
  };
}

/*
 * This is a dummy function to check if the function name has been altered by minification.
 * If the function has been minified and NODE_ENV !== 'production', warn the user.
 */

function isCrushed() {}

if (false) {}



// CONCATENATED MODULE: ./src/scripts/reducers/items.js
var defaultState = [];
function items_items(state, action) {
  if (state === void 0) {
    state = defaultState;
  }

  switch (action.type) {
    case 'ADD_ITEM':
      {
        // Add object to items array
        var newState = [].concat(state, [{
          id: action.id,
          choiceId: action.choiceId,
          groupId: action.groupId,
          value: action.value,
          label: action.label,
          active: true,
          highlighted: false,
          customProperties: action.customProperties,
          placeholder: action.placeholder || false,
          keyCode: null
        }]);
        return newState.map(function (obj) {
          var item = obj;
          item.highlighted = false;
          return item;
        });
      }

    case 'REMOVE_ITEM':
      {
        // Set item to inactive
        return state.map(function (obj) {
          var item = obj;

          if (item.id === action.id) {
            item.active = false;
          }

          return item;
        });
      }

    case 'HIGHLIGHT_ITEM':
      {
        return state.map(function (obj) {
          var item = obj;

          if (item.id === action.id) {
            item.highlighted = action.highlighted;
          }

          return item;
        });
      }

    default:
      {
        return state;
      }
  }
}
// CONCATENATED MODULE: ./src/scripts/reducers/groups.js
var groups_defaultState = [];
function groups(state, action) {
  if (state === void 0) {
    state = groups_defaultState;
  }

  switch (action.type) {
    case 'ADD_GROUP':
      {
        return [].concat(state, [{
          id: action.id,
          value: action.value,
          active: action.active,
          disabled: action.disabled
        }]);
      }

    case 'CLEAR_CHOICES':
      {
        return [];
      }

    default:
      {
        return state;
      }
  }
}
// CONCATENATED MODULE: ./src/scripts/reducers/choices.js
var choices_defaultState = [];
function choices_choices(state, action) {
  if (state === void 0) {
    state = choices_defaultState;
  }

  switch (action.type) {
    case 'ADD_CHOICE':
      {
        /*
            A disabled choice appears in the choice dropdown but cannot be selected
            A selected choice has been added to the passed input's value (added as an item)
            An active choice appears within the choice dropdown
         */
        return [].concat(state, [{
          id: action.id,
          elementId: action.elementId,
          groupId: action.groupId,
          value: action.value,
          label: action.label || action.value,
          disabled: action.disabled || false,
          selected: false,
          active: true,
          score: 9999,
          customProperties: action.customProperties,
          placeholder: action.placeholder || false,
          keyCode: null
        }]);
      }

    case 'ADD_ITEM':
      {
        // If all choices need to be activated
        if (action.activateOptions) {
          return state.map(function (obj) {
            var choice = obj;
            choice.active = action.active;
            return choice;
          });
        } // When an item is added and it has an associated choice,
        // we want to disable it so it can't be chosen again


        if (action.choiceId > -1) {
          return state.map(function (obj) {
            var choice = obj;

            if (choice.id === parseInt(action.choiceId, 10)) {
              choice.selected = true;
            }

            return choice;
          });
        }

        return state;
      }

    case 'REMOVE_ITEM':
      {
        // When an item is removed and it has an associated choice,
        // we want to re-enable it so it can be chosen again
        if (action.choiceId > -1) {
          return state.map(function (obj) {
            var choice = obj;

            if (choice.id === parseInt(action.choiceId, 10)) {
              choice.selected = false;
            }

            return choice;
          });
        }

        return state;
      }

    case 'FILTER_CHOICES':
      {
        return state.map(function (obj) {
          var choice = obj; // Set active state based on whether choice is
          // within filtered results

          choice.active = action.results.some(function (_ref) {
            var item = _ref.item,
                score = _ref.score;

            if (item.id === choice.id) {
              choice.score = score;
              return true;
            }

            return false;
          });
          return choice;
        });
      }

    case 'ACTIVATE_CHOICES':
      {
        return state.map(function (obj) {
          var choice = obj;
          choice.active = action.active;
          return choice;
        });
      }

    case 'CLEAR_CHOICES':
      {
        return choices_defaultState;
      }

    default:
      {
        return state;
      }
  }
}
// CONCATENATED MODULE: ./src/scripts/reducers/general.js
var general_defaultState = {
  loading: false
};

var general = function general(state, action) {
  if (state === void 0) {
    state = general_defaultState;
  }

  switch (action.type) {
    case 'SET_IS_LOADING':
      {
        return {
          loading: action.isLoading
        };
      }

    default:
      {
        return state;
      }
  }
};

/* harmony default export */ var reducers_general = (general);
// CONCATENATED MODULE: ./src/scripts/lib/utils.js
/**
 * @param {number} min
 * @param {number} max
 * @returns {number}
 */
var getRandomNumber = function getRandomNumber(min, max) {
  return Math.floor(Math.random() * (max - min) + min);
};
/**
 * @param {number} length
 * @returns {string}
 */

var generateChars = function generateChars(length) {
  return Array.from({
    length: length
  }, function () {
    return getRandomNumber(0, 36).toString(36);
  }).join('');
};
/**
 * @param {HTMLInputElement | HTMLSelectElement} element
 * @param {string} prefix
 * @returns {string}
 */

var generateId = function generateId(element, prefix) {
  var id = element.id || element.name && element.name + "-" + generateChars(2) || generateChars(4);
  id = id.replace(/(:|\.|\[|\]|,)/g, '');
  id = prefix + "-" + id;
  return id;
};
/**
 * @param {any} obj
 * @returns {string}
 */

var getType = function getType(obj) {
  return Object.prototype.toString.call(obj).slice(8, -1);
};
/**
 * @param {string} type
 * @param {any} obj
 * @returns {boolean}
 */

var isType = function isType(type, obj) {
  return obj !== undefined && obj !== null && getType(obj) === type;
};
/**
 * @param {HTMLElement} element
 * @param {HTMLElement} [wrapper={HTMLDivElement}]
 * @returns {HTMLElement}
 */

var utils_wrap = function wrap(element, wrapper) {
  if (wrapper === void 0) {
    wrapper = document.createElement('div');
  }

  if (element.nextSibling) {
    element.parentNode.insertBefore(wrapper, element.nextSibling);
  } else {
    element.parentNode.appendChild(wrapper);
  }

  return wrapper.appendChild(element);
};
/**
 * @param {Element} startEl
 * @param {string} selector
 * @param {1 | -1} direction
 * @returns {Element | undefined}
 */

var getAdjacentEl = function getAdjacentEl(startEl, selector, direction) {
  if (direction === void 0) {
    direction = 1;
  }

  if (!(startEl instanceof Element) || typeof selector !== 'string') {
    return undefined;
  }

  var prop = (direction > 0 ? 'next' : 'previous') + "ElementSibling";
  var sibling = startEl[prop];

  while (sibling) {
    if (sibling.matches(selector)) {
      return sibling;
    }

    sibling = sibling[prop];
  }

  return sibling;
};
/**
 * @param {Element} element
 * @param {Element} parent
 * @param {-1 | 1} direction
 * @returns {boolean}
 */

var isScrolledIntoView = function isScrolledIntoView(element, parent, direction) {
  if (direction === void 0) {
    direction = 1;
  }

  if (!element) {
    return false;
  }

  var isVisible;

  if (direction > 0) {
    // In view from bottom
    isVisible = parent.scrollTop + parent.offsetHeight >= element.offsetTop + element.offsetHeight;
  } else {
    // In view from top
    isVisible = element.offsetTop >= parent.scrollTop;
  }

  return isVisible;
};
/**
 * @param {any} value
 * @returns {any}
 */

var sanitise = function sanitise(value) {
  if (typeof value !== 'string') {
    return value;
  }

  return value.replace(/&/g, '&amp;').replace(/>/g, '&rt;').replace(/</g, '&lt;').replace(/"/g, '&quot;');
};
/**
 * @returns {() => (str: string) => Element}
 */

var strToEl = function () {
  var tmpEl = document.createElement('div');
  return function (str) {
    var cleanedInput = str.trim();
    tmpEl.innerHTML = cleanedInput;
    var firldChild = tmpEl.children[0];

    while (tmpEl.firstChild) {
      tmpEl.removeChild(tmpEl.firstChild);
    }

    return firldChild;
  };
}();
/**
 * @param {{ label?: string, value: string }} a
 * @param {{ label?: string, value: string }} b
 * @returns {number}
 */

var sortByAlpha = function sortByAlpha(_ref, _ref2) {
  var value = _ref.value,
      _ref$label = _ref.label,
      label = _ref$label === void 0 ? value : _ref$label;
  var value2 = _ref2.value,
      _ref2$label = _ref2.label,
      label2 = _ref2$label === void 0 ? value2 : _ref2$label;
  return label.localeCompare(label2, [], {
    sensitivity: 'base',
    ignorePunctuation: true,
    numeric: true
  });
};
/**
 * @param {{ score: number }} a
 * @param {{ score: number }} b
 */

var sortByScore = function sortByScore(a, b) {
  return a.score - b.score;
};
/**
 * @param {HTMLElement} element
 * @param {string} type
 * @param {object} customArgs
 */

var dispatchEvent = function dispatchEvent(element, type, customArgs) {
  if (customArgs === void 0) {
    customArgs = null;
  }

  var event = new CustomEvent(type, {
    detail: customArgs,
    bubbles: true,
    cancelable: true
  });
  return element.dispatchEvent(event);
};
/**
 * @param {array} array
 * @param {any} value
 * @param {string} [key="value"]
 * @returns {boolean}
 */

var existsInArray = function existsInArray(array, value, key) {
  if (key === void 0) {
    key = 'value';
  }

  return array.some(function (item) {
    if (typeof value === 'string') {
      return item[key] === value.trim();
    }

    return item[key] === value;
  });
};
/**
 * @param {any} obj
 * @returns {any}
 */

var cloneObject = function cloneObject(obj) {
  return JSON.parse(JSON.stringify(obj));
};
/**
 * Returns an array of keys present on the first but missing on the second object
 * @param {object} a
 * @param {object} b
 * @returns {string[]}
 */

var diff = function diff(a, b) {
  var aKeys = Object.keys(a).sort();
  var bKeys = Object.keys(b).sort();
  return aKeys.filter(function (i) {
    return bKeys.indexOf(i) < 0;
  });
};
// CONCATENATED MODULE: ./src/scripts/reducers/index.js






var appReducer = combineReducers({
  items: items_items,
  groups: groups,
  choices: choices_choices,
  general: reducers_general
});

var reducers_rootReducer = function rootReducer(passedState, action) {
  var state = passedState; // If we are clearing all items, groups and options we reassign
  // state and then pass that state to our proper reducer. This isn't
  // mutating our actual state
  // See: http://stackoverflow.com/a/35641992

  if (action.type === 'CLEAR_ALL') {
    state = undefined;
  } else if (action.type === 'RESET_TO') {
    return cloneObject(action.state);
  }

  return appReducer(state, action);
};

/* harmony default export */ var reducers = (reducers_rootReducer);
// CONCATENATED MODULE: ./src/scripts/store/store.js
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }



/**
 * @typedef {import('../../../types/index').Choices.Choice} Choice
 * @typedef {import('../../../types/index').Choices.Group} Group
 * @typedef {import('../../../types/index').Choices.Item} Item
 */

var store_Store =
/*#__PURE__*/
function () {
  function Store() {
    this._store = createStore(reducers, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__());
  }
  /**
   * Subscribe store to function call (wrapped Redux method)
   * @param  {Function} onChange Function to trigger when state changes
   * @return
   */


  var _proto = Store.prototype;

  _proto.subscribe = function subscribe(onChange) {
    this._store.subscribe(onChange);
  }
  /**
   * Dispatch event to store (wrapped Redux method)
   * @param  {{ type: string, [x: string]: any }} action Action to trigger
   * @return
   */
  ;

  _proto.dispatch = function dispatch(action) {
    this._store.dispatch(action);
  }
  /**
   * Get store object (wrapping Redux method)
   * @returns {object} State
   */
  ;

  /**
   * Get loading state from store
   * @returns {boolean} Loading State
   */
  _proto.isLoading = function isLoading() {
    return this.state.general.loading;
  }
  /**
   * Get single choice by it's ID
   * @param {string} id
   * @returns {Choice | undefined} Found choice
   */
  ;

  _proto.getChoiceById = function getChoiceById(id) {
    return this.activeChoices.find(function (choice) {
      return choice.id === parseInt(id, 10);
    });
  }
  /**
   * Get group by group id
   * @param  {number} id Group ID
   * @returns {Group | undefined} Group data
   */
  ;

  _proto.getGroupById = function getGroupById(id) {
    return this.groups.find(function (group) {
      return group.id === id;
    });
  };

  _createClass(Store, [{
    key: "state",
    get: function get() {
      return this._store.getState();
    }
    /**
     * Get items from store
     * @returns {Item[]} Item objects
     */

  }, {
    key: "items",
    get: function get() {
      return this.state.items;
    }
    /**
     * Get active items from store
     * @returns {Item[]} Item objects
     */

  }, {
    key: "activeItems",
    get: function get() {
      return this.items.filter(function (item) {
        return item.active === true;
      });
    }
    /**
     * Get highlighted items from store
     * @returns {Item[]} Item objects
     */

  }, {
    key: "highlightedActiveItems",
    get: function get() {
      return this.items.filter(function (item) {
        return item.active && item.highlighted;
      });
    }
    /**
     * Get choices from store
     * @returns {Choice[]} Option objects
     */

  }, {
    key: "choices",
    get: function get() {
      return this.state.choices;
    }
    /**
     * Get active choices from store
     * @returns {Choice[]} Option objects
     */

  }, {
    key: "activeChoices",
    get: function get() {
      return this.choices.filter(function (choice) {
        return choice.active === true;
      });
    }
    /**
     * Get selectable choices from store
     * @returns {Choice[]} Option objects
     */

  }, {
    key: "selectableChoices",
    get: function get() {
      return this.choices.filter(function (choice) {
        return choice.disabled !== true;
      });
    }
    /**
     * Get choices that can be searched (excluding placeholders)
     * @returns {Choice[]} Option objects
     */

  }, {
    key: "searchableChoices",
    get: function get() {
      return this.selectableChoices.filter(function (choice) {
        return choice.placeholder !== true;
      });
    }
    /**
     * Get placeholder choice from store
     * @returns {Choice | undefined} Found placeholder
     */

  }, {
    key: "placeholderChoice",
    get: function get() {
      return [].concat(this.choices).reverse().find(function (choice) {
        return choice.placeholder === true;
      });
    }
    /**
     * Get groups from store
     * @returns {Group[]} Group objects
     */

  }, {
    key: "groups",
    get: function get() {
      return this.state.groups;
    }
    /**
     * Get active groups from store
     * @returns {Group[]} Group objects
     */

  }, {
    key: "activeGroups",
    get: function get() {
      var groups = this.groups,
          choices = this.choices;
      return groups.filter(function (group) {
        var isActive = group.active === true && group.disabled === false;
        var hasActiveOptions = choices.some(function (choice) {
          return choice.active === true && choice.disabled === false;
        });
        return isActive && hasActiveOptions;
      }, []);
    }
  }]);

  return Store;
}();


// CONCATENATED MODULE: ./src/scripts/components/dropdown.js
function dropdown_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function dropdown_createClass(Constructor, protoProps, staticProps) { if (protoProps) dropdown_defineProperties(Constructor.prototype, protoProps); if (staticProps) dropdown_defineProperties(Constructor, staticProps); return Constructor; }

/**
 * @typedef {import('../../../types/index').Choices.passedElement} passedElement
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 */
var Dropdown =
/*#__PURE__*/
function () {
  /**
   * @param {{
   *  element: HTMLElement,
   *  type: passedElement['type'],
   *  classNames: ClassNames,
   * }} args
   */
  function Dropdown(_ref) {
    var element = _ref.element,
        type = _ref.type,
        classNames = _ref.classNames;
    this.element = element;
    this.classNames = classNames;
    this.type = type;
    this.isActive = false;
  }
  /**
   * Bottom position of dropdown in viewport coordinates
   * @returns {number} Vertical position
   */


  var _proto = Dropdown.prototype;

  /**
   * Find element that matches passed selector
   * @param {string} selector
   * @returns {HTMLElement | null}
   */
  _proto.getChild = function getChild(selector) {
    return this.element.querySelector(selector);
  }
  /**
   * Show dropdown to user by adding active state class
   * @returns {this}
   */
  ;

  _proto.show = function show() {
    this.element.classList.add(this.classNames.activeState);
    this.element.setAttribute('aria-expanded', 'true');
    this.isActive = true;
    return this;
  }
  /**
   * Hide dropdown from user
   * @returns {this}
   */
  ;

  _proto.hide = function hide() {
    this.element.classList.remove(this.classNames.activeState);
    this.element.setAttribute('aria-expanded', 'false');
    this.isActive = false;
    return this;
  };

  dropdown_createClass(Dropdown, [{
    key: "distanceFromTopWindow",
    get: function get() {
      return this.element.getBoundingClientRect().bottom;
    }
  }]);

  return Dropdown;
}();


// CONCATENATED MODULE: ./src/scripts/constants.js

/**
 * @typedef {import('../../types/index').Choices.ClassNames} ClassNames
 * @typedef {import('../../types/index').Choices.Options} Options
 */

/** @type {ClassNames} */

var DEFAULT_CLASSNAMES = {
  containerOuter: 'choices',
  containerInner: 'choices__inner',
  input: 'choices__input',
  inputCloned: 'choices__input--cloned',
  list: 'choices__list',
  listItems: 'choices__list--multiple',
  listSingle: 'choices__list--single',
  listDropdown: 'choices__list--dropdown',
  item: 'choices__item',
  itemSelectable: 'choices__item--selectable',
  itemDisabled: 'choices__item--disabled',
  itemChoice: 'choices__item--choice',
  placeholder: 'choices__placeholder',
  group: 'choices__group',
  groupHeading: 'choices__heading',
  button: 'choices__button',
  activeState: 'is-active',
  focusState: 'is-focused',
  openState: 'is-open',
  disabledState: 'is-disabled',
  highlightedState: 'is-highlighted',
  selectedState: 'is-selected',
  flippedState: 'is-flipped',
  loadingState: 'is-loading',
  noResults: 'has-no-results',
  noChoices: 'has-no-choices'
};
/** @type {Options} */

var DEFAULT_CONFIG = {
  items: [],
  choices: [],
  silent: false,
  renderChoiceLimit: -1,
  maxItemCount: -1,
  addItems: true,
  addItemFilter: null,
  removeItems: true,
  removeItemButton: false,
  editItems: false,
  duplicateItemsAllowed: true,
  delimiter: ',',
  paste: true,
  searchEnabled: true,
  searchChoices: true,
  searchFloor: 1,
  searchResultLimit: 4,
  searchFields: ['label', 'value'],
  position: 'auto',
  resetScrollPosition: true,
  shouldSort: true,
  shouldSortItems: false,
  sorter: sortByAlpha,
  placeholder: true,
  placeholderValue: null,
  searchPlaceholderValue: null,
  prependValue: null,
  appendValue: null,
  renderSelectedChoices: 'auto',
  loadingText: 'Loading...',
  noResultsText: 'No results found',
  noChoicesText: 'No choices to choose from',
  itemSelectText: 'Press to select',
  uniqueItemText: 'Only unique values can be added',
  customAddItemText: 'Only values matching specific conditions can be added',
  addItemText: function addItemText(value) {
    return "Press Enter to add <b>\"" + sanitise(value) + "\"</b>";
  },
  maxItemText: function maxItemText(maxItemCount) {
    return "Only " + maxItemCount + " values can be added";
  },
  valueComparer: function valueComparer(value1, value2) {
    return value1 === value2;
  },
  fuseOptions: {
    includeScore: true
  },
  callbackOnInit: null,
  callbackOnCreateTemplates: null,
  classNames: DEFAULT_CLASSNAMES
};
var EVENTS = {
  showDropdown: 'showDropdown',
  hideDropdown: 'hideDropdown',
  change: 'change',
  choice: 'choice',
  search: 'search',
  addItem: 'addItem',
  removeItem: 'removeItem',
  highlightItem: 'highlightItem',
  highlightChoice: 'highlightChoice'
};
var ACTION_TYPES = {
  ADD_CHOICE: 'ADD_CHOICE',
  FILTER_CHOICES: 'FILTER_CHOICES',
  ACTIVATE_CHOICES: 'ACTIVATE_CHOICES',
  CLEAR_CHOICES: 'CLEAR_CHOICES',
  ADD_GROUP: 'ADD_GROUP',
  ADD_ITEM: 'ADD_ITEM',
  REMOVE_ITEM: 'REMOVE_ITEM',
  HIGHLIGHT_ITEM: 'HIGHLIGHT_ITEM',
  CLEAR_ALL: 'CLEAR_ALL'
};
var KEY_CODES = {
  BACK_KEY: 46,
  DELETE_KEY: 8,
  ENTER_KEY: 13,
  A_KEY: 65,
  ESC_KEY: 27,
  UP_KEY: 38,
  DOWN_KEY: 40,
  PAGE_UP_KEY: 33,
  PAGE_DOWN_KEY: 34
};
var TEXT_TYPE = 'text';
var SELECT_ONE_TYPE = 'select-one';
var SELECT_MULTIPLE_TYPE = 'select-multiple';
var SCROLLING_SPEED = 4;
// CONCATENATED MODULE: ./src/scripts/components/container.js


/**
 * @typedef {import('../../../types/index').Choices.passedElement} passedElement
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 */

var container_Container =
/*#__PURE__*/
function () {
  /**
   * @param {{
   *  element: HTMLElement,
   *  type: passedElement['type'],
   *  classNames: ClassNames,
   *  position
   * }} args
   */
  function Container(_ref) {
    var element = _ref.element,
        type = _ref.type,
        classNames = _ref.classNames,
        position = _ref.position;
    this.element = element;
    this.classNames = classNames;
    this.type = type;
    this.position = position;
    this.isOpen = false;
    this.isFlipped = false;
    this.isFocussed = false;
    this.isDisabled = false;
    this.isLoading = false;
    this._onFocus = this._onFocus.bind(this);
    this._onBlur = this._onBlur.bind(this);
  }

  var _proto = Container.prototype;

  _proto.addEventListeners = function addEventListeners() {
    this.element.addEventListener('focus', this._onFocus);
    this.element.addEventListener('blur', this._onBlur);
  };

  _proto.removeEventListeners = function removeEventListeners() {
    this.element.removeEventListener('focus', this._onFocus);
    this.element.removeEventListener('blur', this._onBlur);
  }
  /**
   * Determine whether container should be flipped based on passed
   * dropdown position
   * @param {number} dropdownPos
   * @returns {boolean}
   */
  ;

  _proto.shouldFlip = function shouldFlip(dropdownPos) {
    if (typeof dropdownPos !== 'number') {
      return false;
    } // If flip is enabled and the dropdown bottom position is
    // greater than the window height flip the dropdown.


    var shouldFlip = false;

    if (this.position === 'auto') {
      shouldFlip = !window.matchMedia("(min-height: " + (dropdownPos + 1) + "px)").matches;
    } else if (this.position === 'top') {
      shouldFlip = true;
    }

    return shouldFlip;
  }
  /**
   * @param {string} activeDescendantID
   */
  ;

  _proto.setActiveDescendant = function setActiveDescendant(activeDescendantID) {
    this.element.setAttribute('aria-activedescendant', activeDescendantID);
  };

  _proto.removeActiveDescendant = function removeActiveDescendant() {
    this.element.removeAttribute('aria-activedescendant');
  }
  /**
   * @param {number} dropdownPos
   */
  ;

  _proto.open = function open(dropdownPos) {
    this.element.classList.add(this.classNames.openState);
    this.element.setAttribute('aria-expanded', 'true');
    this.isOpen = true;

    if (this.shouldFlip(dropdownPos)) {
      this.element.classList.add(this.classNames.flippedState);
      this.isFlipped = true;
    }
  };

  _proto.close = function close() {
    this.element.classList.remove(this.classNames.openState);
    this.element.setAttribute('aria-expanded', 'false');
    this.removeActiveDescendant();
    this.isOpen = false; // A dropdown flips if it does not have space within the page

    if (this.isFlipped) {
      this.element.classList.remove(this.classNames.flippedState);
      this.isFlipped = false;
    }
  };

  _proto.focus = function focus() {
    if (!this.isFocussed) {
      this.element.focus();
    }
  };

  _proto.addFocusState = function addFocusState() {
    this.element.classList.add(this.classNames.focusState);
  };

  _proto.removeFocusState = function removeFocusState() {
    this.element.classList.remove(this.classNames.focusState);
  };

  _proto.enable = function enable() {
    this.element.classList.remove(this.classNames.disabledState);
    this.element.removeAttribute('aria-disabled');

    if (this.type === SELECT_ONE_TYPE) {
      this.element.setAttribute('tabindex', '0');
    }

    this.isDisabled = false;
  };

  _proto.disable = function disable() {
    this.element.classList.add(this.classNames.disabledState);
    this.element.setAttribute('aria-disabled', 'true');

    if (this.type === SELECT_ONE_TYPE) {
      this.element.setAttribute('tabindex', '-1');
    }

    this.isDisabled = true;
  }
  /**
   * @param {HTMLElement} element
   */
  ;

  _proto.wrap = function wrap(element) {
    utils_wrap(element, this.element);
  }
  /**
   * @param {Element} element
   */
  ;

  _proto.unwrap = function unwrap(element) {
    // Move passed element outside this element
    this.element.parentNode.insertBefore(element, this.element); // Remove this element

    this.element.parentNode.removeChild(this.element);
  };

  _proto.addLoadingState = function addLoadingState() {
    this.element.classList.add(this.classNames.loadingState);
    this.element.setAttribute('aria-busy', 'true');
    this.isLoading = true;
  };

  _proto.removeLoadingState = function removeLoadingState() {
    this.element.classList.remove(this.classNames.loadingState);
    this.element.removeAttribute('aria-busy');
    this.isLoading = false;
  };

  _proto._onFocus = function _onFocus() {
    this.isFocussed = true;
  };

  _proto._onBlur = function _onBlur() {
    this.isFocussed = false;
  };

  return Container;
}();


// CONCATENATED MODULE: ./src/scripts/components/input.js
function input_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function input_createClass(Constructor, protoProps, staticProps) { if (protoProps) input_defineProperties(Constructor.prototype, protoProps); if (staticProps) input_defineProperties(Constructor, staticProps); return Constructor; }



/**
 * @typedef {import('../../../types/index').Choices.passedElement} passedElement
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 */

var input_Input =
/*#__PURE__*/
function () {
  /**
   * @param {{
   *  element: HTMLInputElement,
   *  type: passedElement['type'],
   *  classNames: ClassNames,
   *  preventPaste: boolean
   * }} args
   */
  function Input(_ref) {
    var element = _ref.element,
        type = _ref.type,
        classNames = _ref.classNames,
        preventPaste = _ref.preventPaste;
    this.element = element;
    this.type = type;
    this.classNames = classNames;
    this.preventPaste = preventPaste;
    this.isFocussed = this.element === document.activeElement;
    this.isDisabled = element.disabled;
    this._onPaste = this._onPaste.bind(this);
    this._onInput = this._onInput.bind(this);
    this._onFocus = this._onFocus.bind(this);
    this._onBlur = this._onBlur.bind(this);
  }
  /**
   * @param {string} placeholder
   */


  var _proto = Input.prototype;

  _proto.addEventListeners = function addEventListeners() {
    this.element.addEventListener('paste', this._onPaste);
    this.element.addEventListener('input', this._onInput, {
      passive: true
    });
    this.element.addEventListener('focus', this._onFocus, {
      passive: true
    });
    this.element.addEventListener('blur', this._onBlur, {
      passive: true
    });
  };

  _proto.removeEventListeners = function removeEventListeners() {
    this.element.removeEventListener('input', this._onInput, {
      passive: true
    });
    this.element.removeEventListener('paste', this._onPaste);
    this.element.removeEventListener('focus', this._onFocus, {
      passive: true
    });
    this.element.removeEventListener('blur', this._onBlur, {
      passive: true
    });
  };

  _proto.enable = function enable() {
    this.element.removeAttribute('disabled');
    this.isDisabled = false;
  };

  _proto.disable = function disable() {
    this.element.setAttribute('disabled', '');
    this.isDisabled = true;
  };

  _proto.focus = function focus() {
    if (!this.isFocussed) {
      this.element.focus();
    }
  };

  _proto.blur = function blur() {
    if (this.isFocussed) {
      this.element.blur();
    }
  }
  /**
   * Set value of input to blank
   * @param {boolean} setWidth
   * @returns {this}
   */
  ;

  _proto.clear = function clear(setWidth) {
    if (setWidth === void 0) {
      setWidth = true;
    }

    if (this.element.value) {
      this.element.value = '';
    }

    if (setWidth) {
      this.setWidth();
    }

    return this;
  }
  /**
   * Set the correct input width based on placeholder
   * value or input value
   */
  ;

  _proto.setWidth = function setWidth() {
    // Resize input to contents or placeholder
    var _this$element = this.element,
        style = _this$element.style,
        value = _this$element.value,
        placeholder = _this$element.placeholder;
    style.minWidth = placeholder.length + 1 + "ch";
    style.width = value.length + 1 + "ch";
  }
  /**
   * @param {string} activeDescendantID
   */
  ;

  _proto.setActiveDescendant = function setActiveDescendant(activeDescendantID) {
    this.element.setAttribute('aria-activedescendant', activeDescendantID);
  };

  _proto.removeActiveDescendant = function removeActiveDescendant() {
    this.element.removeAttribute('aria-activedescendant');
  };

  _proto._onInput = function _onInput() {
    if (this.type !== SELECT_ONE_TYPE) {
      this.setWidth();
    }
  }
  /**
   * @param {Event} event
   */
  ;

  _proto._onPaste = function _onPaste(event) {
    if (this.preventPaste) {
      event.preventDefault();
    }
  };

  _proto._onFocus = function _onFocus() {
    this.isFocussed = true;
  };

  _proto._onBlur = function _onBlur() {
    this.isFocussed = false;
  };

  input_createClass(Input, [{
    key: "placeholder",
    set: function set(placeholder) {
      this.element.placeholder = placeholder;
    }
    /**
     * @returns {string}
     */

  }, {
    key: "value",
    get: function get() {
      return sanitise(this.element.value);
    }
    /**
     * @param {string} value
     */
    ,
    set: function set(value) {
      this.element.value = value;
    }
  }]);

  return Input;
}();


// CONCATENATED MODULE: ./src/scripts/components/list.js

/**
 * @typedef {import('../../../types/index').Choices.Choice} Choice
 */

var list_List =
/*#__PURE__*/
function () {
  /**
   * @param {{ element: HTMLElement }} args
   */
  function List(_ref) {
    var element = _ref.element;
    this.element = element;
    this.scrollPos = this.element.scrollTop;
    this.height = this.element.offsetHeight;
  }

  var _proto = List.prototype;

  _proto.clear = function clear() {
    this.element.innerHTML = '';
  }
  /**
   * @param {Element | DocumentFragment} node
   */
  ;

  _proto.append = function append(node) {
    this.element.appendChild(node);
  }
  /**
   * @param {string} selector
   * @returns {Element | null}
   */
  ;

  _proto.getChild = function getChild(selector) {
    return this.element.querySelector(selector);
  }
  /**
   * @returns {boolean}
   */
  ;

  _proto.hasChildren = function hasChildren() {
    return this.element.hasChildNodes();
  };

  _proto.scrollToTop = function scrollToTop() {
    this.element.scrollTop = 0;
  }
  /**
   * @param {Element} element
   * @param {1 | -1} direction
   */
  ;

  _proto.scrollToChildElement = function scrollToChildElement(element, direction) {
    var _this = this;

    if (!element) {
      return;
    }

    var listHeight = this.element.offsetHeight; // Scroll position of dropdown

    var listScrollPosition = this.element.scrollTop + listHeight;
    var elementHeight = element.offsetHeight; // Distance from bottom of element to top of parent

    var elementPos = element.offsetTop + elementHeight; // Difference between the element and scroll position

    var destination = direction > 0 ? this.element.scrollTop + elementPos - listScrollPosition : element.offsetTop;
    requestAnimationFrame(function () {
      _this._animateScroll(destination, direction);
    });
  }
  /**
   * @param {number} scrollPos
   * @param {number} strength
   * @param {number} destination
   */
  ;

  _proto._scrollDown = function _scrollDown(scrollPos, strength, destination) {
    var easing = (destination - scrollPos) / strength;
    var distance = easing > 1 ? easing : 1;
    this.element.scrollTop = scrollPos + distance;
  }
  /**
   * @param {number} scrollPos
   * @param {number} strength
   * @param {number} destination
   */
  ;

  _proto._scrollUp = function _scrollUp(scrollPos, strength, destination) {
    var easing = (scrollPos - destination) / strength;
    var distance = easing > 1 ? easing : 1;
    this.element.scrollTop = scrollPos - distance;
  }
  /**
   * @param {*} destination
   * @param {*} direction
   */
  ;

  _proto._animateScroll = function _animateScroll(destination, direction) {
    var _this2 = this;

    var strength = SCROLLING_SPEED;
    var choiceListScrollTop = this.element.scrollTop;
    var continueAnimation = false;

    if (direction > 0) {
      this._scrollDown(choiceListScrollTop, strength, destination);

      if (choiceListScrollTop < destination) {
        continueAnimation = true;
      }
    } else {
      this._scrollUp(choiceListScrollTop, strength, destination);

      if (choiceListScrollTop > destination) {
        continueAnimation = true;
      }
    }

    if (continueAnimation) {
      requestAnimationFrame(function () {
        _this2._animateScroll(destination, direction);
      });
    }
  };

  return List;
}();


// CONCATENATED MODULE: ./src/scripts/components/wrapped-element.js
function wrapped_element_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function wrapped_element_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_element_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_element_defineProperties(Constructor, staticProps); return Constructor; }


/**
 * @typedef {import('../../../types/index').Choices.passedElement} passedElement
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 */

var wrapped_element_WrappedElement =
/*#__PURE__*/
function () {
  /**
   * @param {{
   *  element: HTMLInputElement | HTMLSelectElement,
   *  classNames: ClassNames,
   * }} args
   */
  function WrappedElement(_ref) {
    var element = _ref.element,
        classNames = _ref.classNames;
    this.element = element;
    this.classNames = classNames;

    if (!(element instanceof HTMLInputElement) && !(element instanceof HTMLSelectElement)) {
      throw new TypeError('Invalid element passed');
    }

    this.isDisabled = false;
  }

  var _proto = WrappedElement.prototype;

  _proto.conceal = function conceal() {
    // Hide passed input
    this.element.classList.add(this.classNames.input);
    this.element.hidden = true; // Remove element from tab index

    this.element.tabIndex = -1; // Backup original styles if any

    var origStyle = this.element.getAttribute('style');

    if (origStyle) {
      this.element.setAttribute('data-choice-orig-style', origStyle);
    }

    this.element.setAttribute('data-choice', 'active');
  };

  _proto.reveal = function reveal() {
    // Reinstate passed element
    this.element.classList.remove(this.classNames.input);
    this.element.hidden = false;
    this.element.removeAttribute('tabindex'); // Recover original styles if any

    var origStyle = this.element.getAttribute('data-choice-orig-style');

    if (origStyle) {
      this.element.removeAttribute('data-choice-orig-style');
      this.element.setAttribute('style', origStyle);
    } else {
      this.element.removeAttribute('style');
    }

    this.element.removeAttribute('data-choice'); // Re-assign values - this is weird, I know
    // @todo Figure out why we need to do this

    this.element.value = this.element.value; // eslint-disable-line no-self-assign
  };

  _proto.enable = function enable() {
    this.element.removeAttribute('disabled');
    this.element.disabled = false;
    this.isDisabled = false;
  };

  _proto.disable = function disable() {
    this.element.setAttribute('disabled', '');
    this.element.disabled = true;
    this.isDisabled = true;
  };

  _proto.triggerEvent = function triggerEvent(eventType, data) {
    dispatchEvent(this.element, eventType, data);
  };

  wrapped_element_createClass(WrappedElement, [{
    key: "isActive",
    get: function get() {
      return this.element.dataset.choice === 'active';
    }
  }, {
    key: "dir",
    get: function get() {
      return this.element.dir;
    }
  }, {
    key: "value",
    get: function get() {
      return this.element.value;
    },
    set: function set(value) {
      // you must define setter here otherwise it will be readonly property
      this.element.value = value;
    }
  }]);

  return WrappedElement;
}();


// CONCATENATED MODULE: ./src/scripts/components/wrapped-input.js
function wrapped_input_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function wrapped_input_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_input_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_input_defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }


/**
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 * @typedef {import('../../../types/index').Choices.Item} Item
 */

var WrappedInput =
/*#__PURE__*/
function (_WrappedElement) {
  _inheritsLoose(WrappedInput, _WrappedElement);

  /**
   * @param {{
   *  element: HTMLInputElement,
   *  classNames: ClassNames,
   *  delimiter: string
   * }} args
   */
  function WrappedInput(_ref) {
    var _this;

    var element = _ref.element,
        classNames = _ref.classNames,
        delimiter = _ref.delimiter;
    _this = _WrappedElement.call(this, {
      element: element,
      classNames: classNames
    }) || this;
    _this.delimiter = delimiter;
    return _this;
  }
  /**
   * @returns {string}
   */


  wrapped_input_createClass(WrappedInput, [{
    key: "value",
    get: function get() {
      return this.element.value;
    }
    /**
     * @param {Item[]} items
     */
    ,
    set: function set(items) {
      var itemValues = items.map(function (_ref2) {
        var value = _ref2.value;
        return value;
      });
      var joinedValues = itemValues.join(this.delimiter);
      this.element.setAttribute('value', joinedValues);
      this.element.value = joinedValues;
    }
  }]);

  return WrappedInput;
}(wrapped_element_WrappedElement);


// CONCATENATED MODULE: ./src/scripts/components/wrapped-select.js
function wrapped_select_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function wrapped_select_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_select_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_select_defineProperties(Constructor, staticProps); return Constructor; }

function wrapped_select_inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }


/**
 * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames
 * @typedef {import('../../../types/index').Choices.Item} Item
 * @typedef {import('../../../types/index').Choices.Choice} Choice
 */

var WrappedSelect =
/*#__PURE__*/
function (_WrappedElement) {
  wrapped_select_inheritsLoose(WrappedSelect, _WrappedElement);

  /**
   * @param {{
   *  element: HTMLSelectElement,
   *  classNames: ClassNames,
   *  delimiter: string
   *  template: function
   * }} args
   */
  function WrappedSelect(_ref) {
    var _this;

    var element = _ref.element,
        classNames = _ref.classNames,
        template = _ref.template;
    _this = _WrappedElement.call(this, {
      element: element,
      classNames: classNames
    }) || this;
    _this.template = template;
    return _this;
  }

  var _proto = WrappedSelect.prototype;

  /**
   * @param {DocumentFragment} fragment
   */
  _proto.appendDocFragment = function appendDocFragment(fragment) {
    this.element.innerHTML = '';
    this.element.appendChild(fragment);
  };

  wrapped_select_createClass(WrappedSelect, [{
    key: "placeholderOption",
    get: function get() {
      return this.element.querySelector('option[value=""]') || // Backward compatibility layer for the non-standard placeholder attribute supported in older versions.
      this.element.querySelector('option[placeholder]');
    }
    /**
     * @returns {Element[]}
     */

  }, {
    key: "optionGroups",
    get: function get() {
      return Array.from(this.element.getElementsByTagName('OPTGROUP'));
    }
    /**
     * @returns {Item[] | Choice[]}
     */

  }, {
    key: "options",
    get: function get() {
      return Array.from(this.element.options);
    }
    /**
     * @param {Item[] | Choice[]} options
     */
    ,
    set: function set(options) {
      var _this2 = this;

      var fragment = document.createDocumentFragment();

      var addOptionToFragment = function addOptionToFragment(data) {
        // Create a standard select option
        var option = _this2.template(data); // Append it to fragment


        fragment.appendChild(option);
      }; // Add each list item to list


      options.forEach(function (optionData) {
        return addOptionToFragment(optionData);
      });
      this.appendDocFragment(fragment);
    }
  }]);

  return WrappedSelect;
}(wrapped_element_WrappedElement);


// CONCATENATED MODULE: ./src/scripts/components/index.js







// CONCATENATED MODULE: ./src/scripts/templates.js
/**
 * Helpers to create HTML elements used by Choices
 * Can be overridden by providing `callbackOnCreateTemplates` option
 * @typedef {import('../../types/index').Choices.Templates} Templates
 * @typedef {import('../../types/index').Choices.ClassNames} ClassNames
 * @typedef {import('../../types/index').Choices.Options} Options
 * @typedef {import('../../types/index').Choices.Item} Item
 * @typedef {import('../../types/index').Choices.Choice} Choice
 * @typedef {import('../../types/index').Choices.Group} Group
 */
var TEMPLATES =
/** @type {Templates} */
{
  /**
   * @param {Partial<ClassNames>} classNames
   * @param {"ltr" | "rtl" | "auto"} dir
   * @param {boolean} isSelectElement
   * @param {boolean} isSelectOneElement
   * @param {boolean} searchEnabled
   * @param {"select-one" | "select-multiple" | "text"} passedElementType
   */
  containerOuter: function containerOuter(_ref, dir, isSelectElement, isSelectOneElement, searchEnabled, passedElementType) {
    var _containerOuter = _ref.containerOuter;
    var div = Object.assign(document.createElement('div'), {
      className: _containerOuter
    });
    div.dataset.type = passedElementType;

    if (dir) {
      div.dir = dir;
    }

    if (isSelectOneElement) {
      div.tabIndex = 0;
    }

    if (isSelectElement) {
      div.setAttribute('role', searchEnabled ? 'combobox' : 'listbox');

      if (searchEnabled) {
        div.setAttribute('aria-autocomplete', 'list');
      }
    }

    div.setAttribute('aria-haspopup', 'true');
    div.setAttribute('aria-expanded', 'false');
    return div;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   */
  containerInner: function containerInner(_ref2) {
    var _containerInner = _ref2.containerInner;
    return Object.assign(document.createElement('div'), {
      className: _containerInner
    });
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {boolean} isSelectOneElement
   */
  itemList: function itemList(_ref3, isSelectOneElement) {
    var list = _ref3.list,
        listSingle = _ref3.listSingle,
        listItems = _ref3.listItems;
    return Object.assign(document.createElement('div'), {
      className: list + " " + (isSelectOneElement ? listSingle : listItems)
    });
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {string} value
   */
  placeholder: function placeholder(_ref4, value) {
    var _placeholder = _ref4.placeholder;
    return Object.assign(document.createElement('div'), {
      className: _placeholder,
      innerHTML: value
    });
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {Item} item
   * @param {boolean} removeItemButton
   */
  item: function item(_ref5, _ref6, removeItemButton) {
    var _item = _ref5.item,
        button = _ref5.button,
        highlightedState = _ref5.highlightedState,
        itemSelectable = _ref5.itemSelectable,
        placeholder = _ref5.placeholder;
    var id = _ref6.id,
        value = _ref6.value,
        label = _ref6.label,
        customProperties = _ref6.customProperties,
        active = _ref6.active,
        disabled = _ref6.disabled,
        highlighted = _ref6.highlighted,
        isPlaceholder = _ref6.placeholder;
    var div = Object.assign(document.createElement('div'), {
      className: _item,
      innerHTML: label
    });
    Object.assign(div.dataset, {
      item: '',
      id: id,
      value: value,
      customProperties: customProperties
    });

    if (active) {
      div.setAttribute('aria-selected', 'true');
    }

    if (disabled) {
      div.setAttribute('aria-disabled', 'true');
    }

    if (isPlaceholder) {
      div.classList.add(placeholder);
    }

    div.classList.add(highlighted ? highlightedState : itemSelectable);

    if (removeItemButton) {
      if (disabled) {
        div.classList.remove(itemSelectable);
      }

      div.dataset.deletable = '';
      /** @todo This MUST be localizable, not hardcoded! */

      var REMOVE_ITEM_TEXT = 'Remove item';
      var removeButton = Object.assign(document.createElement('button'), {
        type: 'button',
        className: button,
        innerHTML: REMOVE_ITEM_TEXT
      });
      removeButton.setAttribute('aria-label', REMOVE_ITEM_TEXT + ": '" + value + "'");
      removeButton.dataset.button = '';
      div.appendChild(removeButton);
    }

    return div;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {boolean} isSelectOneElement
   */
  choiceList: function choiceList(_ref7, isSelectOneElement) {
    var list = _ref7.list;
    var div = Object.assign(document.createElement('div'), {
      className: list
    });

    if (!isSelectOneElement) {
      div.setAttribute('aria-multiselectable', 'true');
    }

    div.setAttribute('role', 'listbox');
    return div;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {Group} group
   */
  choiceGroup: function choiceGroup(_ref8, _ref9) {
    var group = _ref8.group,
        groupHeading = _ref8.groupHeading,
        itemDisabled = _ref8.itemDisabled;
    var id = _ref9.id,
        value = _ref9.value,
        disabled = _ref9.disabled;
    var div = Object.assign(document.createElement('div'), {
      className: group + " " + (disabled ? itemDisabled : '')
    });
    div.setAttribute('role', 'group');
    Object.assign(div.dataset, {
      group: '',
      id: id,
      value: value
    });

    if (disabled) {
      div.setAttribute('aria-disabled', 'true');
    }

    div.appendChild(Object.assign(document.createElement('div'), {
      className: groupHeading,
      innerHTML: value
    }));
    return div;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {Choice} choice
   * @param {Options['itemSelectText']} selectText
   */
  choice: function choice(_ref10, _ref11, selectText) {
    var item = _ref10.item,
        itemChoice = _ref10.itemChoice,
        itemSelectable = _ref10.itemSelectable,
        selectedState = _ref10.selectedState,
        itemDisabled = _ref10.itemDisabled,
        placeholder = _ref10.placeholder;
    var id = _ref11.id,
        value = _ref11.value,
        label = _ref11.label,
        groupId = _ref11.groupId,
        elementId = _ref11.elementId,
        isDisabled = _ref11.disabled,
        isSelected = _ref11.selected,
        isPlaceholder = _ref11.placeholder;
    var div = Object.assign(document.createElement('div'), {
      id: elementId,
      innerHTML: label,
      className: item + " " + itemChoice
    });

    if (isSelected) {
      div.classList.add(selectedState);
    }

    if (isPlaceholder) {
      div.classList.add(placeholder);
    }

    div.setAttribute('role', groupId > 0 ? 'treeitem' : 'option');
    Object.assign(div.dataset, {
      choice: '',
      id: id,
      value: value,
      selectText: selectText
    });

    if (isDisabled) {
      div.classList.add(itemDisabled);
      div.dataset.choiceDisabled = '';
      div.setAttribute('aria-disabled', 'true');
    } else {
      div.classList.add(itemSelectable);
      div.dataset.choiceSelectable = '';
    }

    return div;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   * @param {string} placeholderValue
   */
  input: function input(_ref12, placeholderValue) {
    var _input = _ref12.input,
        inputCloned = _ref12.inputCloned;
    var inp = Object.assign(document.createElement('input'), {
      type: 'text',
      className: _input + " " + inputCloned,
      autocomplete: 'off',
      autocapitalize: 'off',
      spellcheck: false
    });
    inp.setAttribute('role', 'textbox');
    inp.setAttribute('aria-autocomplete', 'list');
    inp.setAttribute('aria-label', placeholderValue);
    return inp;
  },

  /**
   * @param {Partial<ClassNames>} classNames
   */
  dropdown: function dropdown(_ref13) {
    var list = _ref13.list,
        listDropdown = _ref13.listDropdown;
    var div = document.createElement('div');
    div.classList.add(list, listDropdown);
    div.setAttribute('aria-expanded', 'false');
    return div;
  },

  /**
   *
   * @param {Partial<ClassNames>} classNames
   * @param {string} innerHTML
   * @param {"no-choices" | "no-results" | ""} type
   */
  notice: function notice(_ref14, innerHTML, type) {
    var item = _ref14.item,
        itemChoice = _ref14.itemChoice,
        noResults = _ref14.noResults,
        noChoices = _ref14.noChoices;

    if (type === void 0) {
      type = '';
    }

    var classes = [item, itemChoice];

    if (type === 'no-choices') {
      classes.push(noChoices);
    } else if (type === 'no-results') {
      classes.push(noResults);
    }

    return Object.assign(document.createElement('div'), {
      innerHTML: innerHTML,
      className: classes.join(' ')
    });
  },

  /**
   * @param {Item} option
   */
  option: function option(_ref15) {
    var label = _ref15.label,
        value = _ref15.value,
        customProperties = _ref15.customProperties,
        active = _ref15.active,
        disabled = _ref15.disabled;
    var opt = new Option(label, value, false, active);

    if (customProperties) {
      opt.dataset.customProperties = customProperties;
    }

    opt.disabled = disabled;
    return opt;
  }
};
/* harmony default export */ var templates = (TEMPLATES);
// CONCATENATED MODULE: ./src/scripts/actions/choices.js
/**
 * @typedef {import('redux').Action} Action
 * @typedef {import('../../../types/index').Choices.Choice} Choice
 */

/**
 * @argument {Choice} choice
 * @returns {Action & Choice}
 */

var choices_addChoice = function addChoice(_ref) {
  var value = _ref.value,
      label = _ref.label,
      id = _ref.id,
      groupId = _ref.groupId,
      disabled = _ref.disabled,
      elementId = _ref.elementId,
      customProperties = _ref.customProperties,
      placeholder = _ref.placeholder,
      keyCode = _ref.keyCode;
  return {
    type: ACTION_TYPES.ADD_CHOICE,
    value: value,
    label: label,
    id: id,
    groupId: groupId,
    disabled: disabled,
    elementId: elementId,
    customProperties: customProperties,
    placeholder: placeholder,
    keyCode: keyCode
  };
};
/**
 * @argument {Choice[]} results
 * @returns {Action & { results: Choice[] }}
 */

var choices_filterChoices = function filterChoices(results) {
  return {
    type: ACTION_TYPES.FILTER_CHOICES,
    results: results
  };
};
/**
 * @argument {boolean} active
 * @returns {Action & { active: boolean }}
 */

var choices_activateChoices = function activateChoices(active) {
  if (active === void 0) {
    active = true;
  }

  return {
    type: ACTION_TYPES.ACTIVATE_CHOICES,
    active: active
  };
};
/**
 * @returns {Action}
 */

var choices_clearChoices = function clearChoices() {
  return {
    type: ACTION_TYPES.CLEAR_CHOICES
  };
};
// CONCATENATED MODULE: ./src/scripts/actions/items.js

/**
 * @typedef {import('redux').Action} Action
 * @typedef {import('../../../types/index').Choices.Item} Item
 */

/**
 * @param {Item} item
 * @returns {Action & Item}
 */

var items_addItem = function addItem(_ref) {
  var value = _ref.value,
      label = _ref.label,
      id = _ref.id,
      choiceId = _ref.choiceId,
      groupId = _ref.groupId,
      customProperties = _ref.customProperties,
      placeholder = _ref.placeholder,
      keyCode = _ref.keyCode;
  return {
    type: ACTION_TYPES.ADD_ITEM,
    value: value,
    label: label,
    id: id,
    choiceId: choiceId,
    groupId: groupId,
    customProperties: customProperties,
    placeholder: placeholder,
    keyCode: keyCode
  };
};
/**
 * @param {string} id
 * @param {string} choiceId
 * @returns {Action & { id: string, choiceId: string }}
 */

var items_removeItem = function removeItem(id, choiceId) {
  return {
    type: ACTION_TYPES.REMOVE_ITEM,
    id: id,
    choiceId: choiceId
  };
};
/**
 * @param {string} id
 * @param {boolean} highlighted
 * @returns {Action & { id: string, highlighted: boolean }}
 */

var items_highlightItem = function highlightItem(id, highlighted) {
  return {
    type: ACTION_TYPES.HIGHLIGHT_ITEM,
    id: id,
    highlighted: highlighted
  };
};
// CONCATENATED MODULE: ./src/scripts/actions/groups.js

/**
 * @typedef {import('redux').Action} Action
 * @typedef {import('../../../types/index').Choices.Group} Group
 */

/**
 * @param {Group} group
 * @returns {Action & Group}
 */

var groups_addGroup = function addGroup(_ref) {
  var value = _ref.value,
      id = _ref.id,
      active = _ref.active,
      disabled = _ref.disabled;
  return {
    type: ACTION_TYPES.ADD_GROUP,
    value: value,
    id: id,
    active: active,
    disabled: disabled
  };
};
// CONCATENATED MODULE: ./src/scripts/actions/misc.js
/**
 * @typedef {import('redux').Action} Action
 */

/**
 * @returns {Action}
 */
var clearAll = function clearAll() {
  return {
    type: 'CLEAR_ALL'
  };
};
/**
 * @param {any} state
 * @returns {Action & { state: object }}
 */

var resetTo = function resetTo(state) {
  return {
    type: 'RESET_TO',
    state: state
  };
};
/**
 * @param {boolean} isLoading
 * @returns {Action & { isLoading: boolean }}
 */

var setIsLoading = function setIsLoading(isLoading) {
  return {
    type: 'SET_IS_LOADING',
    isLoading: isLoading
  };
};
// CONCATENATED MODULE: ./src/scripts/choices.js
function choices_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function choices_createClass(Constructor, protoProps, staticProps) { if (protoProps) choices_defineProperties(Constructor.prototype, protoProps); if (staticProps) choices_defineProperties(Constructor, staticProps); return Constructor; }












/** @see {@link http://browserhacks.com/#hack-acea075d0ac6954f275a70023906050c} */

var IS_IE11 = '-ms-scroll-limit' in document.documentElement.style && '-ms-ime-align' in document.documentElement.style;
/**
 * @typedef {import('../../types/index').Choices.Choice} Choice
 * @typedef {import('../../types/index').Choices.Item} Item
 * @typedef {import('../../types/index').Choices.Group} Group
 * @typedef {import('../../types/index').Choices.Options} Options
 */

/** @type {Partial<Options>} */

var USER_DEFAULTS = {};
/**
 * Choices
 * @author Josh Johnson<josh@joshuajohnson.co.uk>
 */

var choices_Choices =
/*#__PURE__*/
function () {
  choices_createClass(Choices, null, [{
    key: "defaults",
    get: function get() {
      return Object.preventExtensions({
        get options() {
          return USER_DEFAULTS;
        },

        get templates() {
          return TEMPLATES;
        }

      });
    }
    /**
     * @param {string | HTMLInputElement | HTMLSelectElement} element
     * @param {Partial<Options>} userConfig
     */

  }]);

  function Choices(element, userConfig) {
    var _this = this;

    if (element === void 0) {
      element = '[data-choice]';
    }

    if (userConfig === void 0) {
      userConfig = {};
    }

    /** @type {Partial<Options>} */
    this.config = cjs_default.a.all([DEFAULT_CONFIG, Choices.defaults.options, userConfig], // When merging array configs, replace with a copy of the userConfig array,
    // instead of concatenating with the default array
    {
      arrayMerge: function arrayMerge(_, sourceArray) {
        return [].concat(sourceArray);
      }
    });
    var invalidConfigOptions = diff(this.config, DEFAULT_CONFIG);

    if (invalidConfigOptions.length) {
      console.warn('Unknown config option(s) passed', invalidConfigOptions.join(', '));
    }

    var passedElement = typeof element === 'string' ? document.querySelector(element) : element;

    if (!(passedElement instanceof HTMLInputElement || passedElement instanceof HTMLSelectElement)) {
      throw TypeError('Expected one of the following types text|select-one|select-multiple');
    }

    this._isTextElement = passedElement.type === TEXT_TYPE;
    this._isSelectOneElement = passedElement.type === SELECT_ONE_TYPE;
    this._isSelectMultipleElement = passedElement.type === SELECT_MULTIPLE_TYPE;
    this._isSelectElement = this._isSelectOneElement || this._isSelectMultipleElement;
    this.config.searchEnabled = this._isSelectMultipleElement || this.config.searchEnabled;

    if (!['auto', 'always'].includes(this.config.renderSelectedChoices)) {
      this.config.renderSelectedChoices = 'auto';
    }

    if (userConfig.addItemFilter && typeof userConfig.addItemFilter !== 'function') {
      var re = userConfig.addItemFilter instanceof RegExp ? userConfig.addItemFilter : new RegExp(userConfig.addItemFilter);
      this.config.addItemFilter = re.test.bind(re);
    }

    if (this._isTextElement) {
      this.passedElement = new WrappedInput({
        element: passedElement,
        classNames: this.config.classNames,
        delimiter: this.config.delimiter
      });
    } else {
      this.passedElement = new WrappedSelect({
        element: passedElement,
        classNames: this.config.classNames,
        template: function template(data) {
          return _this._templates.option(data);
        }
      });
    }

    this.initialised = false;
    this._store = new store_Store();
    this._initialState = {};
    this._currentState = {};
    this._prevState = {};
    this._currentValue = '';
    this._canSearch = this.config.searchEnabled;
    this._isScrollingOnIe = false;
    this._highlightPosition = 0;
    this._wasTap = true;
    this._placeholderValue = this._generatePlaceholderValue();
    this._baseId = generateId(this.passedElement.element, 'choices-');
    /**
     * setting direction in cases where it's explicitly set on passedElement
     * or when calculated direction is different from the document
     * @type {HTMLElement['dir']}
     */

    this._direction = this.passedElement.dir;

    if (!this._direction) {
      var _window$getComputedSt = window.getComputedStyle(this.passedElement.element),
          elementDirection = _window$getComputedSt.direction;

      var _window$getComputedSt2 = window.getComputedStyle(document.documentElement),
          documentDirection = _window$getComputedSt2.direction;

      if (elementDirection !== documentDirection) {
        this._direction = elementDirection;
      }
    }

    this._idNames = {
      itemChoice: 'item-choice'
    }; // Assign preset groups from passed element

    this._presetGroups = this.passedElement.optionGroups; // Assign preset options from passed element

    this._presetOptions = this.passedElement.options; // Assign preset choices from passed object

    this._presetChoices = this.config.choices; // Assign preset items from passed object first

    this._presetItems = this.config.items; // Add any values passed from attribute

    if (this.passedElement.value) {
      this._presetItems = this._presetItems.concat(this.passedElement.value.split(this.config.delimiter));
    } // Create array of choices from option elements


    if (this.passedElement.options) {
      this.passedElement.options.forEach(function (o) {
        _this._presetChoices.push({
          value: o.value,
          label: o.innerHTML,
          selected: o.selected,
          disabled: o.disabled || o.parentNode.disabled,
          placeholder: o.value === '' || o.hasAttribute('placeholder'),
          customProperties: o.getAttribute('data-custom-properties')
        });
      });
    }

    this._render = this._render.bind(this);
    this._onFocus = this._onFocus.bind(this);
    this._onBlur = this._onBlur.bind(this);
    this._onKeyUp = this._onKeyUp.bind(this);
    this._onKeyDown = this._onKeyDown.bind(this);
    this._onClick = this._onClick.bind(this);
    this._onTouchMove = this._onTouchMove.bind(this);
    this._onTouchEnd = this._onTouchEnd.bind(this);
    this._onMouseDown = this._onMouseDown.bind(this);
    this._onMouseOver = this._onMouseOver.bind(this);
    this._onFormReset = this._onFormReset.bind(this);
    this._onAKey = this._onAKey.bind(this);
    this._onEnterKey = this._onEnterKey.bind(this);
    this._onEscapeKey = this._onEscapeKey.bind(this);
    this._onDirectionKey = this._onDirectionKey.bind(this);
    this._onDeleteKey = this._onDeleteKey.bind(this); // If element has already been initialised with Choices, fail silently

    if (this.passedElement.isActive) {
      if (!this.config.silent) {
        console.warn('Trying to initialise Choices on element already initialised');
      }

      this.initialised = true;
      return;
    } // Let's go


    this.init();
  }

  var _proto = Choices.prototype;

  _proto.init = function init() {
    if (this.initialised) {
      return;
    }

    this._createTemplates();

    this._createElements();

    this._createStructure(); // Set initial state (We need to clone the state because some reducers
    // modify the inner objects properties in the state) 🤢


    this._initialState = cloneObject(this._store.state);

    this._store.subscribe(this._render);

    this._render();

    this._addEventListeners();

    var shouldDisable = !this.config.addItems || this.passedElement.element.hasAttribute('disabled');

    if (shouldDisable) {
      this.disable();
    }

    this.initialised = true;
    var callbackOnInit = this.config.callbackOnInit; // Run callback if it is a function

    if (callbackOnInit && typeof callbackOnInit === 'function') {
      callbackOnInit.call(this);
    }
  };

  _proto.destroy = function destroy() {
    if (!this.initialised) {
      return;
    }

    this._removeEventListeners();

    this.passedElement.reveal();
    this.containerOuter.unwrap(this.passedElement.element);
    this.clearStore();

    if (this._isSelectElement) {
      this.passedElement.options = this._presetOptions;
    }

    this._templates = null;
    this.initialised = false;
  };

  _proto.enable = function enable() {
    if (this.passedElement.isDisabled) {
      this.passedElement.enable();
    }

    if (this.containerOuter.isDisabled) {
      this._addEventListeners();

      this.input.enable();
      this.containerOuter.enable();
    }

    return this;
  };

  _proto.disable = function disable() {
    if (!this.passedElement.isDisabled) {
      this.passedElement.disable();
    }

    if (!this.containerOuter.isDisabled) {
      this._removeEventListeners();

      this.input.disable();
      this.containerOuter.disable();
    }

    return this;
  };

  _proto.highlightItem = function highlightItem(item, runEvent) {
    if (runEvent === void 0) {
      runEvent = true;
    }

    if (!item) {
      return this;
    }

    var id = item.id,
        _item$groupId = item.groupId,
        groupId = _item$groupId === void 0 ? -1 : _item$groupId,
        _item$value = item.value,
        value = _item$value === void 0 ? '' : _item$value,
        _item$label = item.label,
        label = _item$label === void 0 ? '' : _item$label;
    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;

    this._store.dispatch(items_highlightItem(id, true));

    if (runEvent) {
      this.passedElement.triggerEvent(EVENTS.highlightItem, {
        id: id,
        value: value,
        label: label,
        groupValue: group && group.value ? group.value : null
      });
    }

    return this;
  };

  _proto.unhighlightItem = function unhighlightItem(item) {
    if (!item) {
      return this;
    }

    var id = item.id,
        _item$groupId2 = item.groupId,
        groupId = _item$groupId2 === void 0 ? -1 : _item$groupId2,
        _item$value2 = item.value,
        value = _item$value2 === void 0 ? '' : _item$value2,
        _item$label2 = item.label,
        label = _item$label2 === void 0 ? '' : _item$label2;
    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;

    this._store.dispatch(items_highlightItem(id, false));

    this.passedElement.triggerEvent(EVENTS.highlightItem, {
      id: id,
      value: value,
      label: label,
      groupValue: group && group.value ? group.value : null
    });
    return this;
  };

  _proto.highlightAll = function highlightAll() {
    var _this2 = this;

    this._store.items.forEach(function (item) {
      return _this2.highlightItem(item);
    });

    return this;
  };

  _proto.unhighlightAll = function unhighlightAll() {
    var _this3 = this;

    this._store.items.forEach(function (item) {
      return _this3.unhighlightItem(item);
    });

    return this;
  };

  _proto.removeActiveItemsByValue = function removeActiveItemsByValue(value) {
    var _this4 = this;

    this._store.activeItems.filter(function (item) {
      return item.value === value;
    }).forEach(function (item) {
      return _this4._removeItem(item);
    });

    return this;
  };

  _proto.removeActiveItems = function removeActiveItems(excludedId) {
    var _this5 = this;

    this._store.activeItems.filter(function (_ref) {
      var id = _ref.id;
      return id !== excludedId;
    }).forEach(function (item) {
      return _this5._removeItem(item);
    });

    return this;
  };

  _proto.removeHighlightedItems = function removeHighlightedItems(runEvent) {
    var _this6 = this;

    if (runEvent === void 0) {
      runEvent = false;
    }

    this._store.highlightedActiveItems.forEach(function (item) {
      _this6._removeItem(item); // If this action was performed by the user
      // trigger the event


      if (runEvent) {
        _this6._triggerChange(item.value);
      }
    });

    return this;
  };

  _proto.showDropdown = function showDropdown(preventInputFocus) {
    var _this7 = this;

    if (this.dropdown.isActive) {
      return this;
    }

    requestAnimationFrame(function () {
      _this7.dropdown.show();

      _this7.containerOuter.open(_this7.dropdown.distanceFromTopWindow);

      if (!preventInputFocus && _this7._canSearch) {
        _this7.input.focus();
      }

      _this7.passedElement.triggerEvent(EVENTS.showDropdown, {});
    });
    return this;
  };

  _proto.hideDropdown = function hideDropdown(preventInputBlur) {
    var _this8 = this;

    if (!this.dropdown.isActive) {
      return this;
    }

    requestAnimationFrame(function () {
      _this8.dropdown.hide();

      _this8.containerOuter.close();

      if (!preventInputBlur && _this8._canSearch) {
        _this8.input.removeActiveDescendant();

        _this8.input.blur();
      }

      _this8.passedElement.triggerEvent(EVENTS.hideDropdown, {});
    });
    return this;
  };

  _proto.getValue = function getValue(valueOnly) {
    if (valueOnly === void 0) {
      valueOnly = false;
    }

    var values = this._store.activeItems.reduce(function (selectedItems, item) {
      var itemValue = valueOnly ? item.value : item;
      selectedItems.push(itemValue);
      return selectedItems;
    }, []);

    return this._isSelectOneElement ? values[0] : values;
  }
  /**
   * @param {string[] | import('../../types/index').Choices.Item[]} items
   */
  ;

  _proto.setValue = function setValue(items) {
    var _this9 = this;

    if (!this.initialised) {
      return this;
    }

    items.forEach(function (value) {
      return _this9._setChoiceOrItem(value);
    });
    return this;
  };

  _proto.setChoiceByValue = function setChoiceByValue(value) {
    var _this10 = this;

    if (!this.initialised || this._isTextElement) {
      return this;
    } // If only one value has been passed, convert to array


    var choiceValue = Array.isArray(value) ? value : [value]; // Loop through each value and

    choiceValue.forEach(function (val) {
      return _this10._findAndSelectChoiceByValue(val);
    });
    return this;
  }
  /**
   * Set choices of select input via an array of objects (or function that returns array of object or promise of it),
   * a value field name and a label field name.
   * This behaves the same as passing items via the choices option but can be called after initialising Choices.
   * This can also be used to add groups of choices (see example 2); Optionally pass a true `replaceChoices` value to remove any existing choices.
   * Optionally pass a `customProperties` object to add additional data to your choices (useful when searching/filtering etc).
   *
   * **Input types affected:** select-one, select-multiple
   *
   * @template {Choice[] | ((instance: Choices) => object[] | Promise<object[]>)} T
   * @param {T} [choicesArrayOrFetcher]
   * @param {string} [value = 'value'] - name of `value` field
   * @param {string} [label = 'label'] - name of 'label' field
   * @param {boolean} [replaceChoices = false] - whether to replace of add choices
   * @returns {this | Promise<this>}
   *
   * @example
   * ```js
   * const example = new Choices(element);
   *
   * example.setChoices([
   *   {value: 'One', label: 'Label One', disabled: true},
   *   {value: 'Two', label: 'Label Two', selected: true},
   *   {value: 'Three', label: 'Label Three'},
   * ], 'value', 'label', false);
   * ```
   *
   * @example
   * ```js
   * const example = new Choices(element);
   *
   * example.setChoices(async () => {
   *   try {
   *      const items = await fetch('/items');
   *      return items.json()
   *   } catch(err) {
   *      console.error(err)
   *   }
   * });
   * ```
   *
   * @example
   * ```js
   * const example = new Choices(element);
   *
   * example.setChoices([{
   *   label: 'Group one',
   *   id: 1,
   *   disabled: false,
   *   choices: [
   *     {value: 'Child One', label: 'Child One', selected: true},
   *     {value: 'Child Two', label: 'Child Two',  disabled: true},
   *     {value: 'Child Three', label: 'Child Three'},
   *   ]
   * },
   * {
   *   label: 'Group two',
   *   id: 2,
   *   disabled: false,
   *   choices: [
   *     {value: 'Child Four', label: 'Child Four', disabled: true},
   *     {value: 'Child Five', label: 'Child Five'},
   *     {value: 'Child Six', label: 'Child Six', customProperties: {
   *       description: 'Custom description about child six',
   *       random: 'Another random custom property'
   *     }},
   *   ]
   * }], 'value', 'label', false);
   * ```
   */
  ;

  _proto.setChoices = function setChoices(choicesArrayOrFetcher, value, label, replaceChoices) {
    var _this11 = this;

    if (choicesArrayOrFetcher === void 0) {
      choicesArrayOrFetcher = [];
    }

    if (value === void 0) {
      value = 'value';
    }

    if (label === void 0) {
      label = 'label';
    }

    if (replaceChoices === void 0) {
      replaceChoices = false;
    }

    if (!this.initialised) {
      throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");
    }

    if (!this._isSelectElement) {
      throw new TypeError("setChoices can't be used with INPUT based Choices");
    }

    if (typeof value !== 'string' || !value) {
      throw new TypeError("value parameter must be a name of 'value' field in passed objects");
    } // Clear choices if needed


    if (replaceChoices) {
      this.clearChoices();
    }

    if (typeof choicesArrayOrFetcher === 'function') {
      // it's a choices fetcher function
      var fetcher = choicesArrayOrFetcher(this);

      if (typeof Promise === 'function' && fetcher instanceof Promise) {
        // that's a promise
        // eslint-disable-next-line compat/compat
        return new Promise(function (resolve) {
          return requestAnimationFrame(resolve);
        }).then(function () {
          return _this11._handleLoadingState(true);
        }).then(function () {
          return fetcher;
        }).then(function (data) {
          return _this11.setChoices(data, value, label, replaceChoices);
        }).catch(function (err) {
          if (!_this11.config.silent) {
            console.error(err);
          }
        }).then(function () {
          return _this11._handleLoadingState(false);
        }).then(function () {
          return _this11;
        });
      } // function returned something else than promise, let's check if it's an array of choices


      if (!Array.isArray(fetcher)) {
        throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: " + typeof fetcher);
      } // recursion with results, it's sync and choices were cleared already


      return this.setChoices(fetcher, value, label, false);
    }

    if (!Array.isArray(choicesArrayOrFetcher)) {
      throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");
    }

    this.containerOuter.removeLoadingState();

    this._startLoading();

    choicesArrayOrFetcher.forEach(function (groupOrChoice) {
      if (groupOrChoice.choices) {
        _this11._addGroup({
          id: parseInt(groupOrChoice.id, 10) || null,
          group: groupOrChoice,
          valueKey: value,
          labelKey: label
        });
      } else {
        _this11._addChoice({
          value: groupOrChoice[value],
          label: groupOrChoice[label],
          isSelected: groupOrChoice.selected,
          isDisabled: groupOrChoice.disabled,
          customProperties: groupOrChoice.customProperties,
          placeholder: groupOrChoice.placeholder
        });
      }
    });

    this._stopLoading();

    return this;
  };

  _proto.clearChoices = function clearChoices() {
    this._store.dispatch(choices_clearChoices());

    return this;
  };

  _proto.clearStore = function clearStore() {
    this._store.dispatch(clearAll());

    return this;
  };

  _proto.clearInput = function clearInput() {
    var shouldSetInputWidth = !this._isSelectOneElement;
    this.input.clear(shouldSetInputWidth);

    if (!this._isTextElement && this._canSearch) {
      this._isSearching = false;

      this._store.dispatch(choices_activateChoices(true));
    }

    return this;
  };

  _proto._render = function _render() {
    if (this._store.isLoading()) {
      return;
    }

    this._currentState = this._store.state;
    var stateChanged = this._currentState.choices !== this._prevState.choices || this._currentState.groups !== this._prevState.groups || this._currentState.items !== this._prevState.items;
    var shouldRenderChoices = this._isSelectElement;
    var shouldRenderItems = this._currentState.items !== this._prevState.items;

    if (!stateChanged) {
      return;
    }

    if (shouldRenderChoices) {
      this._renderChoices();
    }

    if (shouldRenderItems) {
      this._renderItems();
    }

    this._prevState = this._currentState;
  };

  _proto._renderChoices = function _renderChoices() {
    var _this12 = this;

    var _this$_store = this._store,
        activeGroups = _this$_store.activeGroups,
        activeChoices = _this$_store.activeChoices;
    var choiceListFragment = document.createDocumentFragment();
    this.choiceList.clear();

    if (this.config.resetScrollPosition) {
      requestAnimationFrame(function () {
        return _this12.choiceList.scrollToTop();
      });
    } // If we have grouped options


    if (activeGroups.length >= 1 && !this._isSearching) {
      // If we have a placeholder choice along with groups
      var activePlaceholders = activeChoices.filter(function (activeChoice) {
        return activeChoice.placeholder === true && activeChoice.groupId === -1;
      });

      if (activePlaceholders.length >= 1) {
        choiceListFragment = this._createChoicesFragment(activePlaceholders, choiceListFragment);
      }

      choiceListFragment = this._createGroupsFragment(activeGroups, activeChoices, choiceListFragment);
    } else if (activeChoices.length >= 1) {
      choiceListFragment = this._createChoicesFragment(activeChoices, choiceListFragment);
    } // If we have choices to show


    if (choiceListFragment.childNodes && choiceListFragment.childNodes.length > 0) {
      var activeItems = this._store.activeItems;

      var canAddItem = this._canAddItem(activeItems, this.input.value); // ...and we can select them


      if (canAddItem.response) {
        // ...append them and highlight the first choice
        this.choiceList.append(choiceListFragment);

        this._highlightChoice();
      } else {
        // ...otherwise show a notice
        this.choiceList.append(this._getTemplate('notice', canAddItem.notice));
      }
    } else {
      // Otherwise show a notice
      var dropdownItem;
      var notice;

      if (this._isSearching) {
        notice = typeof this.config.noResultsText === 'function' ? this.config.noResultsText() : this.config.noResultsText;
        dropdownItem = this._getTemplate('notice', notice, 'no-results');
      } else {
        notice = typeof this.config.noChoicesText === 'function' ? this.config.noChoicesText() : this.config.noChoicesText;
        dropdownItem = this._getTemplate('notice', notice, 'no-choices');
      }

      this.choiceList.append(dropdownItem);
    }
  };

  _proto._renderItems = function _renderItems() {
    var activeItems = this._store.activeItems || [];
    this.itemList.clear(); // Create a fragment to store our list items
    // (so we don't have to update the DOM for each item)

    var itemListFragment = this._createItemsFragment(activeItems); // If we have items to add, append them


    if (itemListFragment.childNodes) {
      this.itemList.append(itemListFragment);
    }
  };

  _proto._createGroupsFragment = function _createGroupsFragment(groups, choices, fragment) {
    var _this13 = this;

    if (fragment === void 0) {
      fragment = document.createDocumentFragment();
    }

    var getGroupChoices = function getGroupChoices(group) {
      return choices.filter(function (choice) {
        if (_this13._isSelectOneElement) {
          return choice.groupId === group.id;
        }

        return choice.groupId === group.id && (_this13.config.renderSelectedChoices === 'always' || !choice.selected);
      });
    }; // If sorting is enabled, filter groups


    if (this.config.shouldSort) {
      groups.sort(this.config.sorter);
    }

    groups.forEach(function (group) {
      var groupChoices = getGroupChoices(group);

      if (groupChoices.length >= 1) {
        var dropdownGroup = _this13._getTemplate('choiceGroup', group);

        fragment.appendChild(dropdownGroup);

        _this13._createChoicesFragment(groupChoices, fragment, true);
      }
    });
    return fragment;
  };

  _proto._createChoicesFragment = function _createChoicesFragment(choices, fragment, withinGroup) {
    var _this14 = this;

    if (fragment === void 0) {
      fragment = document.createDocumentFragment();
    }

    if (withinGroup === void 0) {
      withinGroup = false;
    }

    // Create a fragment to store our list items (so we don't have to update the DOM for each item)
    var _this$config = this.config,
        renderSelectedChoices = _this$config.renderSelectedChoices,
        searchResultLimit = _this$config.searchResultLimit,
        renderChoiceLimit = _this$config.renderChoiceLimit;
    var filter = this._isSearching ? sortByScore : this.config.sorter;

    var appendChoice = function appendChoice(choice) {
      var shouldRender = renderSelectedChoices === 'auto' ? _this14._isSelectOneElement || !choice.selected : true;

      if (shouldRender) {
        var dropdownItem = _this14._getTemplate('choice', choice, _this14.config.itemSelectText);

        fragment.appendChild(dropdownItem);
      }
    };

    var rendererableChoices = choices;

    if (renderSelectedChoices === 'auto' && !this._isSelectOneElement) {
      rendererableChoices = choices.filter(function (choice) {
        return !choice.selected;
      });
    } // Split array into placeholders and "normal" choices


    var _rendererableChoices$ = rendererableChoices.reduce(function (acc, choice) {
      if (choice.placeholder) {
        acc.placeholderChoices.push(choice);
      } else {
        acc.normalChoices.push(choice);
      }

      return acc;
    }, {
      placeholderChoices: [],
      normalChoices: []
    }),
        placeholderChoices = _rendererableChoices$.placeholderChoices,
        normalChoices = _rendererableChoices$.normalChoices; // If sorting is enabled or the user is searching, filter choices


    if (this.config.shouldSort || this._isSearching) {
      normalChoices.sort(filter);
    }

    var choiceLimit = rendererableChoices.length; // Prepend placeholeder

    var sortedChoices = this._isSelectOneElement ? [].concat(placeholderChoices, normalChoices) : normalChoices;

    if (this._isSearching) {
      choiceLimit = searchResultLimit;
    } else if (renderChoiceLimit && renderChoiceLimit > 0 && !withinGroup) {
      choiceLimit = renderChoiceLimit;
    } // Add each choice to dropdown within range


    for (var i = 0; i < choiceLimit; i += 1) {
      if (sortedChoices[i]) {
        appendChoice(sortedChoices[i]);
      }
    }

    return fragment;
  };

  _proto._createItemsFragment = function _createItemsFragment(items, fragment) {
    var _this15 = this;

    if (fragment === void 0) {
      fragment = document.createDocumentFragment();
    }

    // Create fragment to add elements to
    var _this$config2 = this.config,
        shouldSortItems = _this$config2.shouldSortItems,
        sorter = _this$config2.sorter,
        removeItemButton = _this$config2.removeItemButton; // If sorting is enabled, filter items

    if (shouldSortItems && !this._isSelectOneElement) {
      items.sort(sorter);
    }

    if (this._isTextElement) {
      // Update the value of the hidden input
      this.passedElement.value = items;
    } else {
      // Update the options of the hidden input
      this.passedElement.options = items;
    }

    var addItemToFragment = function addItemToFragment(item) {
      // Create new list element
      var listItem = _this15._getTemplate('item', item, removeItemButton); // Append it to list


      fragment.appendChild(listItem);
    }; // Add each list item to list


    items.forEach(addItemToFragment);
    return fragment;
  };

  _proto._triggerChange = function _triggerChange(value) {
    if (value === undefined || value === null) {
      return;
    }

    this.passedElement.triggerEvent(EVENTS.change, {
      value: value
    });
  };

  _proto._selectPlaceholderChoice = function _selectPlaceholderChoice() {
    var placeholderChoice = this._store.placeholderChoice;

    if (placeholderChoice) {
      this._addItem({
        value: placeholderChoice.value,
        label: placeholderChoice.label,
        choiceId: placeholderChoice.id,
        groupId: placeholderChoice.groupId,
        placeholder: placeholderChoice.placeholder
      });

      this._triggerChange(placeholderChoice.value);
    }
  };

  _proto._handleButtonAction = function _handleButtonAction(activeItems, element) {
    if (!activeItems || !element || !this.config.removeItems || !this.config.removeItemButton) {
      return;
    }

    var itemId = element.parentNode.getAttribute('data-id');
    var itemToRemove = activeItems.find(function (item) {
      return item.id === parseInt(itemId, 10);
    }); // Remove item associated with button

    this._removeItem(itemToRemove);

    this._triggerChange(itemToRemove.value);

    if (this._isSelectOneElement) {
      this._selectPlaceholderChoice();
    }
  };

  _proto._handleItemAction = function _handleItemAction(activeItems, element, hasShiftKey) {
    var _this16 = this;

    if (hasShiftKey === void 0) {
      hasShiftKey = false;
    }

    if (!activeItems || !element || !this.config.removeItems || this._isSelectOneElement) {
      return;
    }

    var passedId = element.getAttribute('data-id'); // We only want to select one item with a click
    // so we deselect any items that aren't the target
    // unless shift is being pressed

    activeItems.forEach(function (item) {
      if (item.id === parseInt(passedId, 10) && !item.highlighted) {
        _this16.highlightItem(item);
      } else if (!hasShiftKey && item.highlighted) {
        _this16.unhighlightItem(item);
      }
    }); // Focus input as without focus, a user cannot do anything with a
    // highlighted item

    this.input.focus();
  };

  _proto._handleChoiceAction = function _handleChoiceAction(activeItems, element) {
    if (!activeItems || !element) {
      return;
    } // If we are clicking on an option


    var id = element.dataset.id;

    var choice = this._store.getChoiceById(id);

    if (!choice) {
      return;
    }

    var passedKeyCode = activeItems[0] && activeItems[0].keyCode ? activeItems[0].keyCode : null;
    var hasActiveDropdown = this.dropdown.isActive; // Update choice keyCode

    choice.keyCode = passedKeyCode;
    this.passedElement.triggerEvent(EVENTS.choice, {
      choice: choice
    });

    if (!choice.selected && !choice.disabled) {
      var canAddItem = this._canAddItem(activeItems, choice.value);

      if (canAddItem.response) {
        this._addItem({
          value: choice.value,
          label: choice.label,
          choiceId: choice.id,
          groupId: choice.groupId,
          customProperties: choice.customProperties,
          placeholder: choice.placeholder,
          keyCode: choice.keyCode
        });

        this._triggerChange(choice.value);
      }
    }

    this.clearInput(); // We want to close the dropdown if we are dealing with a single select box

    if (hasActiveDropdown && this._isSelectOneElement) {
      this.hideDropdown(true);
      this.containerOuter.focus();
    }
  };

  _proto._handleBackspace = function _handleBackspace(activeItems) {
    if (!this.config.removeItems || !activeItems) {
      return;
    }

    var lastItem = activeItems[activeItems.length - 1];
    var hasHighlightedItems = activeItems.some(function (item) {
      return item.highlighted;
    }); // If editing the last item is allowed and there are not other selected items,
    // we can edit the item value. Otherwise if we can remove items, remove all selected items

    if (this.config.editItems && !hasHighlightedItems && lastItem) {
      this.input.value = lastItem.value;
      this.input.setWidth();

      this._removeItem(lastItem);

      this._triggerChange(lastItem.value);
    } else {
      if (!hasHighlightedItems) {
        // Highlight last item if none already highlighted
        this.highlightItem(lastItem, false);
      }

      this.removeHighlightedItems(true);
    }
  };

  _proto._startLoading = function _startLoading() {
    this._store.dispatch(setIsLoading(true));
  };

  _proto._stopLoading = function _stopLoading() {
    this._store.dispatch(setIsLoading(false));
  };

  _proto._handleLoadingState = function _handleLoadingState(setLoading) {
    if (setLoading === void 0) {
      setLoading = true;
    }

    var placeholderItem = this.itemList.getChild("." + this.config.classNames.placeholder);

    if (setLoading) {
      this.disable();
      this.containerOuter.addLoadingState();

      if (this._isSelectOneElement) {
        if (!placeholderItem) {
          placeholderItem = this._getTemplate('placeholder', this.config.loadingText);
          this.itemList.append(placeholderItem);
        } else {
          placeholderItem.innerHTML = this.config.loadingText;
        }
      } else {
        this.input.placeholder = this.config.loadingText;
      }
    } else {
      this.enable();
      this.containerOuter.removeLoadingState();

      if (this._isSelectOneElement) {
        placeholderItem.innerHTML = this._placeholderValue || '';
      } else {
        this.input.placeholder = this._placeholderValue || '';
      }
    }
  };

  _proto._handleSearch = function _handleSearch(value) {
    if (!value || !this.input.isFocussed) {
      return;
    }

    var choices = this._store.choices;
    var _this$config3 = this.config,
        searchFloor = _this$config3.searchFloor,
        searchChoices = _this$config3.searchChoices;
    var hasUnactiveChoices = choices.some(function (option) {
      return !option.active;
    }); // Check that we have a value to search and the input was an alphanumeric character

    if (value && value.length >= searchFloor) {
      var resultCount = searchChoices ? this._searchChoices(value) : 0; // Trigger search event

      this.passedElement.triggerEvent(EVENTS.search, {
        value: value,
        resultCount: resultCount
      });
    } else if (hasUnactiveChoices) {
      // Otherwise reset choices to active
      this._isSearching = false;

      this._store.dispatch(choices_activateChoices(true));
    }
  };

  _proto._canAddItem = function _canAddItem(activeItems, value) {
    var canAddItem = true;
    var notice = typeof this.config.addItemText === 'function' ? this.config.addItemText(value) : this.config.addItemText;

    if (!this._isSelectOneElement) {
      var isDuplicateValue = existsInArray(activeItems, value);

      if (this.config.maxItemCount > 0 && this.config.maxItemCount <= activeItems.length) {
        // If there is a max entry limit and we have reached that limit
        // don't update
        canAddItem = false;
        notice = typeof this.config.maxItemText === 'function' ? this.config.maxItemText(this.config.maxItemCount) : this.config.maxItemText;
      }

      if (!this.config.duplicateItemsAllowed && isDuplicateValue && canAddItem) {
        canAddItem = false;
        notice = typeof this.config.uniqueItemText === 'function' ? this.config.uniqueItemText(value) : this.config.uniqueItemText;
      }

      if (this._isTextElement && this.config.addItems && canAddItem && typeof this.config.addItemFilter === 'function' && !this.config.addItemFilter(value)) {
        canAddItem = false;
        notice = typeof this.config.customAddItemText === 'function' ? this.config.customAddItemText(value) : this.config.customAddItemText;
      }
    }

    return {
      response: canAddItem,
      notice: notice
    };
  };

  _proto._searchChoices = function _searchChoices(value) {
    var newValue = typeof value === 'string' ? value.trim() : value;
    var currentValue = typeof this._currentValue === 'string' ? this._currentValue.trim() : this._currentValue;

    if (newValue.length < 1 && newValue === currentValue + " ") {
      return 0;
    } // If new value matches the desired length and is not the same as the current value with a space


    var haystack = this._store.searchableChoices;
    var needle = newValue;
    var keys = [].concat(this.config.searchFields);
    var options = Object.assign(this.config.fuseOptions, {
      keys: keys
    });
    var fuse = new fuse_default.a(haystack, options);
    var results = fuse.search(needle);
    this._currentValue = newValue;
    this._highlightPosition = 0;
    this._isSearching = true;

    this._store.dispatch(choices_filterChoices(results));

    return results.length;
  };

  _proto._addEventListeners = function _addEventListeners() {
    var _document = document,
        documentElement = _document.documentElement; // capture events - can cancel event processing or propagation

    documentElement.addEventListener('touchend', this._onTouchEnd, true);
    this.containerOuter.element.addEventListener('keydown', this._onKeyDown, true);
    this.containerOuter.element.addEventListener('mousedown', this._onMouseDown, true); // passive events - doesn't call `preventDefault` or `stopPropagation`

    documentElement.addEventListener('click', this._onClick, {
      passive: true
    });
    documentElement.addEventListener('touchmove', this._onTouchMove, {
      passive: true
    });
    this.dropdown.element.addEventListener('mouseover', this._onMouseOver, {
      passive: true
    });

    if (this._isSelectOneElement) {
      this.containerOuter.element.addEventListener('focus', this._onFocus, {
        passive: true
      });
      this.containerOuter.element.addEventListener('blur', this._onBlur, {
        passive: true
      });
    }

    this.input.element.addEventListener('keyup', this._onKeyUp, {
      passive: true
    });
    this.input.element.addEventListener('focus', this._onFocus, {
      passive: true
    });
    this.input.element.addEventListener('blur', this._onBlur, {
      passive: true
    });

    if (this.input.element.form) {
      this.input.element.form.addEventListener('reset', this._onFormReset, {
        passive: true
      });
    }

    this.input.addEventListeners();
  };

  _proto._removeEventListeners = function _removeEventListeners() {
    var _document2 = document,
        documentElement = _document2.documentElement;
    documentElement.removeEventListener('touchend', this._onTouchEnd, true);
    this.containerOuter.element.removeEventListener('keydown', this._onKeyDown, true);
    this.containerOuter.element.removeEventListener('mousedown', this._onMouseDown, true);
    documentElement.removeEventListener('click', this._onClick);
    documentElement.removeEventListener('touchmove', this._onTouchMove);
    this.dropdown.element.removeEventListener('mouseover', this._onMouseOver);

    if (this._isSelectOneElement) {
      this.containerOuter.element.removeEventListener('focus', this._onFocus);
      this.containerOuter.element.removeEventListener('blur', this._onBlur);
    }

    this.input.element.removeEventListener('keyup', this._onKeyUp);
    this.input.element.removeEventListener('focus', this._onFocus);
    this.input.element.removeEventListener('blur', this._onBlur);

    if (this.input.element.form) {
      this.input.element.form.removeEventListener('reset', this._onFormReset);
    }

    this.input.removeEventListeners();
  }
  /**
   * @param {KeyboardEvent} event
   */
  ;

  _proto._onKeyDown = function _onKeyDown(event) {
    var _keyDownActions;

    var target = event.target,
        keyCode = event.keyCode,
        ctrlKey = event.ctrlKey,
        metaKey = event.metaKey;
    var activeItems = this._store.activeItems;
    var hasFocusedInput = this.input.isFocussed;
    var hasActiveDropdown = this.dropdown.isActive;
    var hasItems = this.itemList.hasChildren();
    var keyString = String.fromCharCode(keyCode);
    var BACK_KEY = KEY_CODES.BACK_KEY,
        DELETE_KEY = KEY_CODES.DELETE_KEY,
        ENTER_KEY = KEY_CODES.ENTER_KEY,
        A_KEY = KEY_CODES.A_KEY,
        ESC_KEY = KEY_CODES.ESC_KEY,
        UP_KEY = KEY_CODES.UP_KEY,
        DOWN_KEY = KEY_CODES.DOWN_KEY,
        PAGE_UP_KEY = KEY_CODES.PAGE_UP_KEY,
        PAGE_DOWN_KEY = KEY_CODES.PAGE_DOWN_KEY;
    var hasCtrlDownKeyPressed = ctrlKey || metaKey; // If a user is typing and the dropdown is not active

    if (!this._isTextElement && /[a-zA-Z0-9-_ ]/.test(keyString)) {
      this.showDropdown();
    } // Map keys to key actions


    var keyDownActions = (_keyDownActions = {}, _keyDownActions[A_KEY] = this._onAKey, _keyDownActions[ENTER_KEY] = this._onEnterKey, _keyDownActions[ESC_KEY] = this._onEscapeKey, _keyDownActions[UP_KEY] = this._onDirectionKey, _keyDownActions[PAGE_UP_KEY] = this._onDirectionKey, _keyDownActions[DOWN_KEY] = this._onDirectionKey, _keyDownActions[PAGE_DOWN_KEY] = this._onDirectionKey, _keyDownActions[DELETE_KEY] = this._onDeleteKey, _keyDownActions[BACK_KEY] = this._onDeleteKey, _keyDownActions); // If keycode has a function, run it

    if (keyDownActions[keyCode]) {
      keyDownActions[keyCode]({
        event: event,
        target: target,
        keyCode: keyCode,
        metaKey: metaKey,
        activeItems: activeItems,
        hasFocusedInput: hasFocusedInput,
        hasActiveDropdown: hasActiveDropdown,
        hasItems: hasItems,
        hasCtrlDownKeyPressed: hasCtrlDownKeyPressed
      });
    }
  };

  _proto._onKeyUp = function _onKeyUp(_ref2) {
    var target = _ref2.target,
        keyCode = _ref2.keyCode;
    var value = this.input.value;
    var activeItems = this._store.activeItems;

    var canAddItem = this._canAddItem(activeItems, value);

    var backKey = KEY_CODES.BACK_KEY,
        deleteKey = KEY_CODES.DELETE_KEY; // We are typing into a text input and have a value, we want to show a dropdown
    // notice. Otherwise hide the dropdown

    if (this._isTextElement) {
      var canShowDropdownNotice = canAddItem.notice && value;

      if (canShowDropdownNotice) {
        var dropdownItem = this._getTemplate('notice', canAddItem.notice);

        this.dropdown.element.innerHTML = dropdownItem.outerHTML;
        this.showDropdown(true);
      } else {
        this.hideDropdown(true);
      }
    } else {
      var userHasRemovedValue = (keyCode === backKey || keyCode === deleteKey) && !target.value;
      var canReactivateChoices = !this._isTextElement && this._isSearching;
      var canSearch = this._canSearch && canAddItem.response;

      if (userHasRemovedValue && canReactivateChoices) {
        this._isSearching = false;

        this._store.dispatch(choices_activateChoices(true));
      } else if (canSearch) {
        this._handleSearch(this.input.value);
      }
    }

    this._canSearch = this.config.searchEnabled;
  };

  _proto._onAKey = function _onAKey(_ref3) {
    var hasItems = _ref3.hasItems,
        hasCtrlDownKeyPressed = _ref3.hasCtrlDownKeyPressed;

    // If CTRL + A or CMD + A have been pressed and there are items to select
    if (hasCtrlDownKeyPressed && hasItems) {
      this._canSearch = false;
      var shouldHightlightAll = this.config.removeItems && !this.input.value && this.input.element === document.activeElement;

      if (shouldHightlightAll) {
        this.highlightAll();
      }
    }
  };

  _proto._onEnterKey = function _onEnterKey(_ref4) {
    var event = _ref4.event,
        target = _ref4.target,
        activeItems = _ref4.activeItems,
        hasActiveDropdown = _ref4.hasActiveDropdown;
    var enterKey = KEY_CODES.ENTER_KEY;
    var targetWasButton = target.hasAttribute('data-button');

    if (this._isTextElement && target.value) {
      var value = this.input.value;

      var canAddItem = this._canAddItem(activeItems, value);

      if (canAddItem.response) {
        this.hideDropdown(true);

        this._addItem({
          value: value
        });

        this._triggerChange(value);

        this.clearInput();
      }
    }

    if (targetWasButton) {
      this._handleButtonAction(activeItems, target);

      event.preventDefault();
    }

    if (hasActiveDropdown) {
      var highlightedChoice = this.dropdown.getChild("." + this.config.classNames.highlightedState);

      if (highlightedChoice) {
        // add enter keyCode value
        if (activeItems[0]) {
          activeItems[0].keyCode = enterKey; // eslint-disable-line no-param-reassign
        }

        this._handleChoiceAction(activeItems, highlightedChoice);
      }

      event.preventDefault();
    } else if (this._isSelectOneElement) {
      this.showDropdown();
      event.preventDefault();
    }
  };

  _proto._onEscapeKey = function _onEscapeKey(_ref5) {
    var hasActiveDropdown = _ref5.hasActiveDropdown;

    if (hasActiveDropdown) {
      this.hideDropdown(true);
      this.containerOuter.focus();
    }
  };

  _proto._onDirectionKey = function _onDirectionKey(_ref6) {
    var event = _ref6.event,
        hasActiveDropdown = _ref6.hasActiveDropdown,
        keyCode = _ref6.keyCode,
        metaKey = _ref6.metaKey;
    var downKey = KEY_CODES.DOWN_KEY,
        pageUpKey = KEY_CODES.PAGE_UP_KEY,
        pageDownKey = KEY_CODES.PAGE_DOWN_KEY; // If up or down key is pressed, traverse through options

    if (hasActiveDropdown || this._isSelectOneElement) {
      this.showDropdown();
      this._canSearch = false;
      var directionInt = keyCode === downKey || keyCode === pageDownKey ? 1 : -1;
      var skipKey = metaKey || keyCode === pageDownKey || keyCode === pageUpKey;
      var selectableChoiceIdentifier = '[data-choice-selectable]';
      var nextEl;

      if (skipKey) {
        if (directionInt > 0) {
          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier + ":last-of-type");
        } else {
          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);
        }
      } else {
        var currentEl = this.dropdown.element.querySelector("." + this.config.classNames.highlightedState);

        if (currentEl) {
          nextEl = getAdjacentEl(currentEl, selectableChoiceIdentifier, directionInt);
        } else {
          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);
        }
      }

      if (nextEl) {
        // We prevent default to stop the cursor moving
        // when pressing the arrow
        if (!isScrolledIntoView(nextEl, this.choiceList.element, directionInt)) {
          this.choiceList.scrollToChildElement(nextEl, directionInt);
        }

        this._highlightChoice(nextEl);
      } // Prevent default to maintain cursor position whilst
      // traversing dropdown options


      event.preventDefault();
    }
  };

  _proto._onDeleteKey = function _onDeleteKey(_ref7) {
    var event = _ref7.event,
        target = _ref7.target,
        hasFocusedInput = _ref7.hasFocusedInput,
        activeItems = _ref7.activeItems;

    // If backspace or delete key is pressed and the input has no value
    if (hasFocusedInput && !target.value && !this._isSelectOneElement) {
      this._handleBackspace(activeItems);

      event.preventDefault();
    }
  };

  _proto._onTouchMove = function _onTouchMove() {
    if (this._wasTap) {
      this._wasTap = false;
    }
  };

  _proto._onTouchEnd = function _onTouchEnd(event) {
    var _ref8 = event || event.touches[0],
        target = _ref8.target;

    var touchWasWithinContainer = this._wasTap && this.containerOuter.element.contains(target);

    if (touchWasWithinContainer) {
      var containerWasExactTarget = target === this.containerOuter.element || target === this.containerInner.element;

      if (containerWasExactTarget) {
        if (this._isTextElement) {
          this.input.focus();
        } else if (this._isSelectMultipleElement) {
          this.showDropdown();
        }
      } // Prevents focus event firing


      event.stopPropagation();
    }

    this._wasTap = true;
  }
  /**
   * Handles mousedown event in capture mode for containetOuter.element
   * @param {MouseEvent} event
   */
  ;

  _proto._onMouseDown = function _onMouseDown(event) {
    var target = event.target;

    if (!(target instanceof HTMLElement)) {
      return;
    } // If we have our mouse down on the scrollbar and are on IE11...


    if (IS_IE11 && this.choiceList.element.contains(target)) {
      // check if click was on a scrollbar area
      var firstChoice =
      /** @type {HTMLElement} */
      this.choiceList.element.firstElementChild;
      var isOnScrollbar = this._direction === 'ltr' ? event.offsetX >= firstChoice.offsetWidth : event.offsetX < firstChoice.offsetLeft;
      this._isScrollingOnIe = isOnScrollbar;
    }

    if (target === this.input.element) {
      return;
    }

    var item = target.closest('[data-button],[data-item],[data-choice]');

    if (item instanceof HTMLElement) {
      var hasShiftKey = event.shiftKey;
      var activeItems = this._store.activeItems;
      var dataset = item.dataset;

      if ('button' in dataset) {
        this._handleButtonAction(activeItems, item);
      } else if ('item' in dataset) {
        this._handleItemAction(activeItems, item, hasShiftKey);
      } else if ('choice' in dataset) {
        this._handleChoiceAction(activeItems, item);
      }
    }

    event.preventDefault();
  }
  /**
   * Handles mouseover event over this.dropdown
   * @param {MouseEvent} event
   */
  ;

  _proto._onMouseOver = function _onMouseOver(_ref9) {
    var target = _ref9.target;

    if (target instanceof HTMLElement && 'choice' in target.dataset) {
      this._highlightChoice(target);
    }
  };

  _proto._onClick = function _onClick(_ref10) {
    var target = _ref10.target;
    var clickWasWithinContainer = this.containerOuter.element.contains(target);

    if (clickWasWithinContainer) {
      if (!this.dropdown.isActive && !this.containerOuter.isDisabled) {
        if (this._isTextElement) {
          if (document.activeElement !== this.input.element) {
            this.input.focus();
          }
        } else {
          this.showDropdown();
          this.containerOuter.focus();
        }
      } else if (this._isSelectOneElement && target !== this.input.element && !this.dropdown.element.contains(target)) {
        this.hideDropdown();
      }
    } else {
      var hasHighlightedItems = this._store.highlightedActiveItems.length > 0;

      if (hasHighlightedItems) {
        this.unhighlightAll();
      }

      this.containerOuter.removeFocusState();
      this.hideDropdown(true);
    }
  };

  _proto._onFocus = function _onFocus(_ref11) {
    var _this17 = this,
        _focusActions;

    var target = _ref11.target;
    var focusWasWithinContainer = this.containerOuter.element.contains(target);

    if (!focusWasWithinContainer) {
      return;
    }

    var focusActions = (_focusActions = {}, _focusActions[TEXT_TYPE] = function () {
      if (target === _this17.input.element) {
        _this17.containerOuter.addFocusState();
      }
    }, _focusActions[SELECT_ONE_TYPE] = function () {
      _this17.containerOuter.addFocusState();

      if (target === _this17.input.element) {
        _this17.showDropdown(true);
      }
    }, _focusActions[SELECT_MULTIPLE_TYPE] = function () {
      if (target === _this17.input.element) {
        _this17.showDropdown(true); // If element is a select box, the focused element is the container and the dropdown
        // isn't already open, focus and show dropdown


        _this17.containerOuter.addFocusState();
      }
    }, _focusActions);
    focusActions[this.passedElement.element.type]();
  };

  _proto._onBlur = function _onBlur(_ref12) {
    var _this18 = this;

    var target = _ref12.target;
    var blurWasWithinContainer = this.containerOuter.element.contains(target);

    if (blurWasWithinContainer && !this._isScrollingOnIe) {
      var _blurActions;

      var activeItems = this._store.activeItems;
      var hasHighlightedItems = activeItems.some(function (item) {
        return item.highlighted;
      });
      var blurActions = (_blurActions = {}, _blurActions[TEXT_TYPE] = function () {
        if (target === _this18.input.element) {
          _this18.containerOuter.removeFocusState();

          if (hasHighlightedItems) {
            _this18.unhighlightAll();
          }

          _this18.hideDropdown(true);
        }
      }, _blurActions[SELECT_ONE_TYPE] = function () {
        _this18.containerOuter.removeFocusState();

        if (target === _this18.input.element || target === _this18.containerOuter.element && !_this18._canSearch) {
          _this18.hideDropdown(true);
        }
      }, _blurActions[SELECT_MULTIPLE_TYPE] = function () {
        if (target === _this18.input.element) {
          _this18.containerOuter.removeFocusState();

          _this18.hideDropdown(true);

          if (hasHighlightedItems) {
            _this18.unhighlightAll();
          }
        }
      }, _blurActions);
      blurActions[this.passedElement.element.type]();
    } else {
      // On IE11, clicking the scollbar blurs our input and thus
      // closes the dropdown. To stop this, we refocus our input
      // if we know we are on IE *and* are scrolling.
      this._isScrollingOnIe = false;
      this.input.element.focus();
    }
  };

  _proto._onFormReset = function _onFormReset() {
    this._store.dispatch(resetTo(this._initialState));
  };

  _proto._highlightChoice = function _highlightChoice(el) {
    var _this19 = this;

    if (el === void 0) {
      el = null;
    }

    var choices = Array.from(this.dropdown.element.querySelectorAll('[data-choice-selectable]'));

    if (!choices.length) {
      return;
    }

    var passedEl = el;
    var highlightedChoices = Array.from(this.dropdown.element.querySelectorAll("." + this.config.classNames.highlightedState)); // Remove any highlighted choices

    highlightedChoices.forEach(function (choice) {
      choice.classList.remove(_this19.config.classNames.highlightedState);
      choice.setAttribute('aria-selected', 'false');
    });

    if (passedEl) {
      this._highlightPosition = choices.indexOf(passedEl);
    } else {
      // Highlight choice based on last known highlight location
      if (choices.length > this._highlightPosition) {
        // If we have an option to highlight
        passedEl = choices[this._highlightPosition];
      } else {
        // Otherwise highlight the option before
        passedEl = choices[choices.length - 1];
      }

      if (!passedEl) {
        passedEl = choices[0];
      }
    }

    passedEl.classList.add(this.config.classNames.highlightedState);
    passedEl.setAttribute('aria-selected', 'true');
    this.passedElement.triggerEvent(EVENTS.highlightChoice, {
      el: passedEl
    });

    if (this.dropdown.isActive) {
      // IE11 ignores aria-label and blocks virtual keyboard
      // if aria-activedescendant is set without a dropdown
      this.input.setActiveDescendant(passedEl.id);
      this.containerOuter.setActiveDescendant(passedEl.id);
    }
  };

  _proto._addItem = function _addItem(_ref13) {
    var value = _ref13.value,
        _ref13$label = _ref13.label,
        label = _ref13$label === void 0 ? null : _ref13$label,
        _ref13$choiceId = _ref13.choiceId,
        choiceId = _ref13$choiceId === void 0 ? -1 : _ref13$choiceId,
        _ref13$groupId = _ref13.groupId,
        groupId = _ref13$groupId === void 0 ? -1 : _ref13$groupId,
        _ref13$customProperti = _ref13.customProperties,
        customProperties = _ref13$customProperti === void 0 ? null : _ref13$customProperti,
        _ref13$placeholder = _ref13.placeholder,
        placeholder = _ref13$placeholder === void 0 ? false : _ref13$placeholder,
        _ref13$keyCode = _ref13.keyCode,
        keyCode = _ref13$keyCode === void 0 ? null : _ref13$keyCode;
    var passedValue = typeof value === 'string' ? value.trim() : value;
    var passedKeyCode = keyCode;
    var passedCustomProperties = customProperties;
    var items = this._store.items;
    var passedLabel = label || passedValue;
    var passedOptionId = choiceId || -1;
    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;
    var id = items ? items.length + 1 : 1; // If a prepended value has been passed, prepend it

    if (this.config.prependValue) {
      passedValue = this.config.prependValue + passedValue.toString();
    } // If an appended value has been passed, append it


    if (this.config.appendValue) {
      passedValue += this.config.appendValue.toString();
    }

    this._store.dispatch(items_addItem({
      value: passedValue,
      label: passedLabel,
      id: id,
      choiceId: passedOptionId,
      groupId: groupId,
      customProperties: customProperties,
      placeholder: placeholder,
      keyCode: passedKeyCode
    }));

    if (this._isSelectOneElement) {
      this.removeActiveItems(id);
    } // Trigger change event


    this.passedElement.triggerEvent(EVENTS.addItem, {
      id: id,
      value: passedValue,
      label: passedLabel,
      customProperties: passedCustomProperties,
      groupValue: group && group.value ? group.value : undefined,
      keyCode: passedKeyCode
    });
    return this;
  };

  _proto._removeItem = function _removeItem(item) {
    if (!item || !isType('Object', item)) {
      return this;
    }

    var id = item.id,
        value = item.value,
        label = item.label,
        choiceId = item.choiceId,
        groupId = item.groupId;
    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;

    this._store.dispatch(items_removeItem(id, choiceId));

    if (group && group.value) {
      this.passedElement.triggerEvent(EVENTS.removeItem, {
        id: id,
        value: value,
        label: label,
        groupValue: group.value
      });
    } else {
      this.passedElement.triggerEvent(EVENTS.removeItem, {
        id: id,
        value: value,
        label: label
      });
    }

    return this;
  };

  _proto._addChoice = function _addChoice(_ref14) {
    var value = _ref14.value,
        _ref14$label = _ref14.label,
        label = _ref14$label === void 0 ? null : _ref14$label,
        _ref14$isSelected = _ref14.isSelected,
        isSelected = _ref14$isSelected === void 0 ? false : _ref14$isSelected,
        _ref14$isDisabled = _ref14.isDisabled,
        isDisabled = _ref14$isDisabled === void 0 ? false : _ref14$isDisabled,
        _ref14$groupId = _ref14.groupId,
        groupId = _ref14$groupId === void 0 ? -1 : _ref14$groupId,
        _ref14$customProperti = _ref14.customProperties,
        customProperties = _ref14$customProperti === void 0 ? null : _ref14$customProperti,
        _ref14$placeholder = _ref14.placeholder,
        placeholder = _ref14$placeholder === void 0 ? false : _ref14$placeholder,
        _ref14$keyCode = _ref14.keyCode,
        keyCode = _ref14$keyCode === void 0 ? null : _ref14$keyCode;

    if (typeof value === 'undefined' || value === null) {
      return;
    } // Generate unique id


    var choices = this._store.choices;
    var choiceLabel = label || value;
    var choiceId = choices ? choices.length + 1 : 1;
    var choiceElementId = this._baseId + "-" + this._idNames.itemChoice + "-" + choiceId;

    this._store.dispatch(choices_addChoice({
      id: choiceId,
      groupId: groupId,
      elementId: choiceElementId,
      value: value,
      label: choiceLabel,
      disabled: isDisabled,
      customProperties: customProperties,
      placeholder: placeholder,
      keyCode: keyCode
    }));

    if (isSelected) {
      this._addItem({
        value: value,
        label: choiceLabel,
        choiceId: choiceId,
        customProperties: customProperties,
        placeholder: placeholder,
        keyCode: keyCode
      });
    }
  };

  _proto._addGroup = function _addGroup(_ref15) {
    var _this20 = this;

    var group = _ref15.group,
        id = _ref15.id,
        _ref15$valueKey = _ref15.valueKey,
        valueKey = _ref15$valueKey === void 0 ? 'value' : _ref15$valueKey,
        _ref15$labelKey = _ref15.labelKey,
        labelKey = _ref15$labelKey === void 0 ? 'label' : _ref15$labelKey;
    var groupChoices = isType('Object', group) ? group.choices : Array.from(group.getElementsByTagName('OPTION'));
    var groupId = id || Math.floor(new Date().valueOf() * Math.random());
    var isDisabled = group.disabled ? group.disabled : false;

    if (groupChoices) {
      this._store.dispatch(groups_addGroup({
        value: group.label,
        id: groupId,
        active: true,
        disabled: isDisabled
      }));

      var addGroupChoices = function addGroupChoices(choice) {
        var isOptDisabled = choice.disabled || choice.parentNode && choice.parentNode.disabled;

        _this20._addChoice({
          value: choice[valueKey],
          label: isType('Object', choice) ? choice[labelKey] : choice.innerHTML,
          isSelected: choice.selected,
          isDisabled: isOptDisabled,
          groupId: groupId,
          customProperties: choice.customProperties,
          placeholder: choice.placeholder
        });
      };

      groupChoices.forEach(addGroupChoices);
    } else {
      this._store.dispatch(groups_addGroup({
        value: group.label,
        id: group.id,
        active: false,
        disabled: group.disabled
      }));
    }
  };

  _proto._getTemplate = function _getTemplate(template) {
    var _this$_templates$temp;

    if (!template) {
      return null;
    }

    var classNames = this.config.classNames;

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    return (_this$_templates$temp = this._templates[template]).call.apply(_this$_templates$temp, [this, classNames].concat(args));
  };

  _proto._createTemplates = function _createTemplates() {
    var callbackOnCreateTemplates = this.config.callbackOnCreateTemplates;
    var userTemplates = {};

    if (callbackOnCreateTemplates && typeof callbackOnCreateTemplates === 'function') {
      userTemplates = callbackOnCreateTemplates.call(this, strToEl);
    }

    this._templates = cjs_default()(TEMPLATES, userTemplates);
  };

  _proto._createElements = function _createElements() {
    this.containerOuter = new container_Container({
      element: this._getTemplate('containerOuter', this._direction, this._isSelectElement, this._isSelectOneElement, this.config.searchEnabled, this.passedElement.element.type),
      classNames: this.config.classNames,
      type: this.passedElement.element.type,
      position: this.config.position
    });
    this.containerInner = new container_Container({
      element: this._getTemplate('containerInner'),
      classNames: this.config.classNames,
      type: this.passedElement.element.type,
      position: this.config.position
    });
    this.input = new input_Input({
      element: this._getTemplate('input', this._placeholderValue),
      classNames: this.config.classNames,
      type: this.passedElement.element.type,
      preventPaste: !this.config.paste
    });
    this.choiceList = new list_List({
      element: this._getTemplate('choiceList', this._isSelectOneElement)
    });
    this.itemList = new list_List({
      element: this._getTemplate('itemList', this._isSelectOneElement)
    });
    this.dropdown = new Dropdown({
      element: this._getTemplate('dropdown'),
      classNames: this.config.classNames,
      type: this.passedElement.element.type
    });
  };

  _proto._createStructure = function _createStructure() {
    // Hide original element
    this.passedElement.conceal(); // Wrap input in container preserving DOM ordering

    this.containerInner.wrap(this.passedElement.element); // Wrapper inner container with outer container

    this.containerOuter.wrap(this.containerInner.element);

    if (this._isSelectOneElement) {
      this.input.placeholder = this.config.searchPlaceholderValue || '';
    } else if (this._placeholderValue) {
      this.input.placeholder = this._placeholderValue;
      this.input.setWidth();
    }

    this.containerOuter.element.appendChild(this.containerInner.element);
    this.containerOuter.element.appendChild(this.dropdown.element);
    this.containerInner.element.appendChild(this.itemList.element);

    if (!this._isTextElement) {
      this.dropdown.element.appendChild(this.choiceList.element);
    }

    if (!this._isSelectOneElement) {
      this.containerInner.element.appendChild(this.input.element);
    } else if (this.config.searchEnabled) {
      this.dropdown.element.insertBefore(this.input.element, this.dropdown.element.firstChild);
    }

    if (this._isSelectElement) {
      this._highlightPosition = 0;
      this._isSearching = false;

      this._startLoading();

      if (this._presetGroups.length) {
        this._addPredefinedGroups(this._presetGroups);
      } else {
        this._addPredefinedChoices(this._presetChoices);
      }

      this._stopLoading();
    }

    if (this._isTextElement) {
      this._addPredefinedItems(this._presetItems);
    }
  };

  _proto._addPredefinedGroups = function _addPredefinedGroups(groups) {
    var _this21 = this;

    // If we have a placeholder option
    var placeholderChoice = this.passedElement.placeholderOption;

    if (placeholderChoice && placeholderChoice.parentNode.tagName === 'SELECT') {
      this._addChoice({
        value: placeholderChoice.value,
        label: placeholderChoice.innerHTML,
        isSelected: placeholderChoice.selected,
        isDisabled: placeholderChoice.disabled,
        placeholder: true
      });
    }

    groups.forEach(function (group) {
      return _this21._addGroup({
        group: group,
        id: group.id || null
      });
    });
  };

  _proto._addPredefinedChoices = function _addPredefinedChoices(choices) {
    var _this22 = this;

    // If sorting is enabled or the user is searching, filter choices
    if (this.config.shouldSort) {
      choices.sort(this.config.sorter);
    }

    var hasSelectedChoice = choices.some(function (choice) {
      return choice.selected;
    });
    var firstEnabledChoiceIndex = choices.findIndex(function (choice) {
      return choice.disabled === undefined || !choice.disabled;
    });
    choices.forEach(function (choice, index) {
      var value = choice.value,
          label = choice.label,
          customProperties = choice.customProperties,
          placeholder = choice.placeholder;

      if (_this22._isSelectElement) {
        // If the choice is actually a group
        if (choice.choices) {
          _this22._addGroup({
            group: choice,
            id: choice.id || null
          });
        } else {
          /**
           * If there is a selected choice already or the choice is not the first in
           * the array, add each choice normally.
           *
           * Otherwise we pre-select the first enabled choice in the array ("select-one" only)
           */
          var shouldPreselect = _this22._isSelectOneElement && !hasSelectedChoice && index === firstEnabledChoiceIndex;
          var isSelected = shouldPreselect ? true : choice.selected;
          var isDisabled = choice.disabled;

          _this22._addChoice({
            value: value,
            label: label,
            isSelected: isSelected,
            isDisabled: isDisabled,
            customProperties: customProperties,
            placeholder: placeholder
          });
        }
      } else {
        _this22._addChoice({
          value: value,
          label: label,
          isSelected: choice.selected,
          isDisabled: choice.disabled,
          customProperties: customProperties,
          placeholder: placeholder
        });
      }
    });
  }
  /**
   * @param {Item[]} items
   */
  ;

  _proto._addPredefinedItems = function _addPredefinedItems(items) {
    var _this23 = this;

    items.forEach(function (item) {
      if (typeof item === 'object' && item.value) {
        _this23._addItem({
          value: item.value,
          label: item.label,
          choiceId: item.id,
          customProperties: item.customProperties,
          placeholder: item.placeholder
        });
      }

      if (typeof item === 'string') {
        _this23._addItem({
          value: item
        });
      }
    });
  };

  _proto._setChoiceOrItem = function _setChoiceOrItem(item) {
    var _this24 = this;

    var itemType = getType(item).toLowerCase();
    var handleType = {
      object: function object() {
        if (!item.value) {
          return;
        } // If we are dealing with a select input, we need to create an option first
        // that is then selected. For text inputs we can just add items normally.


        if (!_this24._isTextElement) {
          _this24._addChoice({
            value: item.value,
            label: item.label,
            isSelected: true,
            isDisabled: false,
            customProperties: item.customProperties,
            placeholder: item.placeholder
          });
        } else {
          _this24._addItem({
            value: item.value,
            label: item.label,
            choiceId: item.id,
            customProperties: item.customProperties,
            placeholder: item.placeholder
          });
        }
      },
      string: function string() {
        if (!_this24._isTextElement) {
          _this24._addChoice({
            value: item,
            label: item,
            isSelected: true,
            isDisabled: false
          });
        } else {
          _this24._addItem({
            value: item
          });
        }
      }
    };
    handleType[itemType]();
  };

  _proto._findAndSelectChoiceByValue = function _findAndSelectChoiceByValue(val) {
    var _this25 = this;

    var choices = this._store.choices; // Check 'value' property exists and the choice isn't already selected

    var foundChoice = choices.find(function (choice) {
      return _this25.config.valueComparer(choice.value, val);
    });

    if (foundChoice && !foundChoice.selected) {
      this._addItem({
        value: foundChoice.value,
        label: foundChoice.label,
        choiceId: foundChoice.id,
        groupId: foundChoice.groupId,
        customProperties: foundChoice.customProperties,
        placeholder: foundChoice.placeholder,
        keyCode: foundChoice.keyCode
      });
    }
  };

  _proto._generatePlaceholderValue = function _generatePlaceholderValue() {
    if (this._isSelectElement) {
      var placeholderOption = this.passedElement.placeholderOption;
      return placeholderOption ? placeholderOption.text : false;
    }

    var _this$config4 = this.config,
        placeholder = _this$config4.placeholder,
        placeholderValue = _this$config4.placeholderValue;
    var dataset = this.passedElement.element.dataset;

    if (placeholder) {
      if (placeholderValue) {
        return placeholderValue;
      }

      if (dataset.placeholder) {
        return dataset.placeholder;
      }
    }

    return false;
  };

  return Choices;
}();

/* harmony default export */ var scripts_choices = __webpack_exports__["default"] = (choices_Choices);

/***/ })
/******/ ])["default"];
});

/***/ }),

/***/ "./node_modules/filepond/dist/filepond.js":
/*!************************************************!*\
  !*** ./node_modules/filepond/dist/filepond.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

/*!
 * FilePond 4.30.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */

/* eslint-disable */

(function(global, factory) {
     true
        ? factory(exports)
        : 0;
})(this, function(exports) {
    'use strict';

    var isNode = function isNode(value) {
        return value instanceof HTMLElement;
    };

    var createStore = function createStore(initialState) {
        var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
        var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
        // internal state
        var state = Object.assign({}, initialState);

        // contains all actions for next frame, is clear when actions are requested
        var actionQueue = [];
        var dispatchQueue = [];

        // returns a duplicate of the current state
        var getState = function getState() {
            return Object.assign({}, state);
        };

        // returns a duplicate of the actions array and clears the actions array
        var processActionQueue = function processActionQueue() {
            // create copy of actions queue
            var queue = [].concat(actionQueue);

            // clear actions queue (we don't want no double actions)
            actionQueue.length = 0;

            return queue;
        };

        // processes actions that might block the main UI thread
        var processDispatchQueue = function processDispatchQueue() {
            // create copy of actions queue
            var queue = [].concat(dispatchQueue);

            // clear actions queue (we don't want no double actions)
            dispatchQueue.length = 0;

            // now dispatch these actions
            queue.forEach(function(_ref) {
                var type = _ref.type,
                    data = _ref.data;
                dispatch(type, data);
            });
        };

        // adds a new action, calls its handler and
        var dispatch = function dispatch(type, data, isBlocking) {
            // is blocking action (should never block if document is hidden)
            if (isBlocking && !document.hidden) {
                dispatchQueue.push({ type: type, data: data });
                return;
            }

            // if this action has a handler, handle the action
            if (actionHandlers[type]) {
                actionHandlers[type](data);
            }

            // now add action
            actionQueue.push({
                type: type,
                data: data,
            });
        };

        var query = function query(str) {
            var _queryHandles;
            for (
                var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1;
                _key < _len;
                _key++
            ) {
                args[_key - 1] = arguments[_key];
            }
            return queryHandles[str]
                ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args)
                : null;
        };

        var api = {
            getState: getState,
            processActionQueue: processActionQueue,
            processDispatchQueue: processDispatchQueue,
            dispatch: dispatch,
            query: query,
        };

        var queryHandles = {};
        queries.forEach(function(query) {
            queryHandles = Object.assign({}, query(state), {}, queryHandles);
        });

        var actionHandlers = {};
        actions.forEach(function(action) {
            actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);
        });

        return api;
    };

    var defineProperty = function defineProperty(obj, property, definition) {
        if (typeof definition === 'function') {
            obj[property] = definition;
            return;
        }
        Object.defineProperty(obj, property, Object.assign({}, definition));
    };

    var forin = function forin(obj, cb) {
        for (var key in obj) {
            if (!obj.hasOwnProperty(key)) {
                continue;
            }

            cb(key, obj[key]);
        }
    };

    var createObject = function createObject(definition) {
        var obj = {};
        forin(definition, function(property) {
            defineProperty(obj, property, definition[property]);
        });
        return obj;
    };

    var attr = function attr(node, name) {
        var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
        if (value === null) {
            return node.getAttribute(name) || node.hasAttribute(name);
        }
        node.setAttribute(name, value);
    };

    var ns = 'http://www.w3.org/2000/svg';
    var svgElements = ['svg', 'path']; // only svg elements used

    var isSVGElement = function isSVGElement(tag) {
        return svgElements.includes(tag);
    };

    var createElement = function createElement(tag, className) {
        var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        if (typeof className === 'object') {
            attributes = className;
            className = null;
        }
        var element = isSVGElement(tag)
            ? document.createElementNS(ns, tag)
            : document.createElement(tag);
        if (className) {
            if (isSVGElement(tag)) {
                attr(element, 'class', className);
            } else {
                element.className = className;
            }
        }
        forin(attributes, function(name, value) {
            attr(element, name, value);
        });
        return element;
    };

    var appendChild = function appendChild(parent) {
        return function(child, index) {
            if (typeof index !== 'undefined' && parent.children[index]) {
                parent.insertBefore(child, parent.children[index]);
            } else {
                parent.appendChild(child);
            }
        };
    };

    var appendChildView = function appendChildView(parent, childViews) {
        return function(view, index) {
            if (typeof index !== 'undefined') {
                childViews.splice(index, 0, view);
            } else {
                childViews.push(view);
            }

            return view;
        };
    };

    var removeChildView = function removeChildView(parent, childViews) {
        return function(view) {
            // remove from child views
            childViews.splice(childViews.indexOf(view), 1);

            // remove the element
            if (view.element.parentNode) {
                parent.removeChild(view.element);
            }

            return view;
        };
    };

    var IS_BROWSER = (function() {
        return typeof window !== 'undefined' && typeof window.document !== 'undefined';
    })();
    var isBrowser = function isBrowser() {
        return IS_BROWSER;
    };

    var testElement = isBrowser() ? createElement('svg') : {};
    var getChildCount =
        'children' in testElement
            ? function(el) {
                  return el.children.length;
              }
            : function(el) {
                  return el.childNodes.length;
              };

    var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {
        var left = offset[0] || elementRect.left;
        var top = offset[1] || elementRect.top;
        var right = left + elementRect.width;
        var bottom = top + elementRect.height * (scale[1] || 1);

        var rect = {
            // the rectangle of the element itself
            element: Object.assign({}, elementRect),

            // the rectangle of the element expanded to contain its children, does not include any margins
            inner: {
                left: elementRect.left,
                top: elementRect.top,
                right: elementRect.right,
                bottom: elementRect.bottom,
            },

            // the rectangle of the element expanded to contain its children including own margin and child margins
            // margins will be added after we've recalculated the size
            outer: {
                left: left,
                top: top,
                right: right,
                bottom: bottom,
            },
        };

        // expand rect to fit all child rectangles
        childViews
            .filter(function(childView) {
                return !childView.isRectIgnored();
            })
            .map(function(childView) {
                return childView.rect;
            })
            .forEach(function(childViewRect) {
                expandRect(rect.inner, Object.assign({}, childViewRect.inner));
                expandRect(rect.outer, Object.assign({}, childViewRect.outer));
            });

        // calculate inner width and height
        calculateRectSize(rect.inner);

        // append additional margin (top and left margins are included in top and left automatically)
        rect.outer.bottom += rect.element.marginBottom;
        rect.outer.right += rect.element.marginRight;

        // calculate outer width and height
        calculateRectSize(rect.outer);

        return rect;
    };

    var expandRect = function expandRect(parent, child) {
        // adjust for parent offset
        child.top += parent.top;
        child.right += parent.left;
        child.bottom += parent.top;
        child.left += parent.left;

        if (child.bottom > parent.bottom) {
            parent.bottom = child.bottom;
        }

        if (child.right > parent.right) {
            parent.right = child.right;
        }
    };

    var calculateRectSize = function calculateRectSize(rect) {
        rect.width = rect.right - rect.left;
        rect.height = rect.bottom - rect.top;
    };

    var isNumber = function isNumber(value) {
        return typeof value === 'number';
    };

    /**
     * Determines if position is at destination
     * @param position
     * @param destination
     * @param velocity
     * @param errorMargin
     * @returns {boolean}
     */
    var thereYet = function thereYet(position, destination, velocity) {
        var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;
        return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;
    };

    /**
     * Spring animation
     */
    var spring =
        // default options
        function spring() // method definition
        {
            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                _ref$stiffness = _ref.stiffness,
                stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,
                _ref$damping = _ref.damping,
                damping = _ref$damping === void 0 ? 0.75 : _ref$damping,
                _ref$mass = _ref.mass,
                mass = _ref$mass === void 0 ? 10 : _ref$mass;
            var target = null;
            var position = null;
            var velocity = 0;
            var resting = false;

            // updates spring state
            var interpolate = function interpolate(ts, skipToEndState) {
                // in rest, don't animate
                if (resting) return;

                // need at least a target or position to do springy things
                if (!(isNumber(target) && isNumber(position))) {
                    resting = true;
                    velocity = 0;
                    return;
                }

                // calculate spring force
                var f = -(position - target) * stiffness;

                // update velocity by adding force based on mass
                velocity += f / mass;

                // update position by adding velocity
                position += velocity;

                // slow down based on amount of damping
                velocity *= damping;

                // we've arrived if we're near target and our velocity is near zero
                if (thereYet(position, target, velocity) || skipToEndState) {
                    position = target;
                    velocity = 0;
                    resting = true;

                    // we done
                    api.onupdate(position);
                    api.oncomplete(position);
                } else {
                    // progress update
                    api.onupdate(position);
                }
            };

            /**
             * Set new target value
             * @param value
             */
            var setTarget = function setTarget(value) {
                // if currently has no position, set target and position to this value
                if (isNumber(value) && !isNumber(position)) {
                    position = value;
                }

                // next target value will not be animated to
                if (target === null) {
                    target = value;
                    position = value;
                }

                // let start moving to target
                target = value;

                // already at target
                if (position === target || typeof target === 'undefined') {
                    // now resting as target is current position, stop moving
                    resting = true;
                    velocity = 0;

                    // done!
                    api.onupdate(position);
                    api.oncomplete(position);

                    return;
                }

                resting = false;
            };

            // need 'api' to call onupdate callback
            var api = createObject({
                interpolate: interpolate,
                target: {
                    set: setTarget,
                    get: function get() {
                        return target;
                    },
                },

                resting: {
                    get: function get() {
                        return resting;
                    },
                },

                onupdate: function onupdate(value) {},
                oncomplete: function oncomplete(value) {},
            });

            return api;
        };

    var easeLinear = function easeLinear(t) {
        return t;
    };
    var easeInOutQuad = function easeInOutQuad(t) {
        return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
    };

    var tween =
        // default values
        function tween() // method definition
        {
            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                _ref$duration = _ref.duration,
                duration = _ref$duration === void 0 ? 500 : _ref$duration,
                _ref$easing = _ref.easing,
                easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,
                _ref$delay = _ref.delay,
                delay = _ref$delay === void 0 ? 0 : _ref$delay;
            var start = null;
            var t;
            var p;
            var resting = true;
            var reverse = false;
            var target = null;

            var interpolate = function interpolate(ts, skipToEndState) {
                if (resting || target === null) return;

                if (start === null) {
                    start = ts;
                }

                if (ts - start < delay) return;

                t = ts - start - delay;

                if (t >= duration || skipToEndState) {
                    t = 1;
                    p = reverse ? 0 : 1;
                    api.onupdate(p * target);
                    api.oncomplete(p * target);
                    resting = true;
                } else {
                    p = t / duration;
                    api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);
                }
            };

            // need 'api' to call onupdate callback
            var api = createObject({
                interpolate: interpolate,
                target: {
                    get: function get() {
                        return reverse ? 0 : target;
                    },
                    set: function set(value) {
                        // is initial value
                        if (target === null) {
                            target = value;
                            api.onupdate(value);
                            api.oncomplete(value);
                            return;
                        }

                        // want to tween to a smaller value and have a current value
                        if (value < target) {
                            target = 1;
                            reverse = true;
                        } else {
                            // not tweening to a smaller value
                            reverse = false;
                            target = value;
                        }

                        // let's go!
                        resting = false;
                        start = null;
                    },
                },

                resting: {
                    get: function get() {
                        return resting;
                    },
                },

                onupdate: function onupdate(value) {},
                oncomplete: function oncomplete(value) {},
            });

            return api;
        };

    var animator = {
        spring: spring,
        tween: tween,
    };

    /*
                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };
                       { translation: { type: 'spring', ... }, ... }
                       { translation: { x: { type: 'spring', ... } } }
                      */
    var createAnimator = function createAnimator(definition, category, property) {
        // default is single definition
        // we check if transform is set, if so, we check if property is set
        var def =
            definition[category] && typeof definition[category][property] === 'object'
                ? definition[category][property]
                : definition[category] || definition;

        var type = typeof def === 'string' ? def : def.type;
        var props = typeof def === 'object' ? Object.assign({}, def) : {};

        return animator[type] ? animator[type](props) : null;
    };

    var addGetSet = function addGetSet(keys, obj, props) {
        var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
        obj = Array.isArray(obj) ? obj : [obj];
        obj.forEach(function(o) {
            keys.forEach(function(key) {
                var name = key;
                var getter = function getter() {
                    return props[key];
                };
                var setter = function setter(value) {
                    return (props[key] = value);
                };

                if (typeof key === 'object') {
                    name = key.key;
                    getter = key.getter || getter;
                    setter = key.setter || setter;
                }

                if (o[name] && !overwrite) {
                    return;
                }

                o[name] = {
                    get: getter,
                    set: setter,
                };
            });
        });
    };

    // add to state,
    // add getters and setters to internal and external api (if not set)
    // setup animators

    var animations = function animations(_ref) {
        var mixinConfig = _ref.mixinConfig,
            viewProps = _ref.viewProps,
            viewInternalAPI = _ref.viewInternalAPI,
            viewExternalAPI = _ref.viewExternalAPI;
        // initial properties
        var initialProps = Object.assign({}, viewProps);

        // list of all active animations
        var animations = [];

        // setup animators
        forin(mixinConfig, function(property, animation) {
            var animator = createAnimator(animation);
            if (!animator) {
                return;
            }

            // when the animator updates, update the view state value
            animator.onupdate = function(value) {
                viewProps[property] = value;
            };

            // set animator target
            animator.target = initialProps[property];

            // when value is set, set the animator target value
            var prop = {
                key: property,
                setter: function setter(value) {
                    // if already at target, we done!
                    if (animator.target === value) {
                        return;
                    }

                    animator.target = value;
                },
                getter: function getter() {
                    return viewProps[property];
                },
            };

            // add getters and setters
            addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);

            // add it to the list for easy updating from the _write method
            animations.push(animator);
        });

        // expose internal write api
        return {
            write: function write(ts) {
                var skipToEndState = document.hidden;
                var resting = true;
                animations.forEach(function(animation) {
                    if (!animation.resting) resting = false;
                    animation.interpolate(ts, skipToEndState);
                });
                return resting;
            },
            destroy: function destroy() {},
        };
    };

    var addEvent = function addEvent(element) {
        return function(type, fn) {
            element.addEventListener(type, fn);
        };
    };

    var removeEvent = function removeEvent(element) {
        return function(type, fn) {
            element.removeEventListener(type, fn);
        };
    };

    // mixin
    var listeners = function listeners(_ref) {
        var mixinConfig = _ref.mixinConfig,
            viewProps = _ref.viewProps,
            viewInternalAPI = _ref.viewInternalAPI,
            viewExternalAPI = _ref.viewExternalAPI,
            viewState = _ref.viewState,
            view = _ref.view;
        var events = [];

        var add = addEvent(view.element);
        var remove = removeEvent(view.element);

        viewExternalAPI.on = function(type, fn) {
            events.push({
                type: type,
                fn: fn,
            });

            add(type, fn);
        };

        viewExternalAPI.off = function(type, fn) {
            events.splice(
                events.findIndex(function(event) {
                    return event.type === type && event.fn === fn;
                }),
                1
            );

            remove(type, fn);
        };

        return {
            write: function write() {
                // not busy
                return true;
            },
            destroy: function destroy() {
                events.forEach(function(event) {
                    remove(event.type, event.fn);
                });
            },
        };
    };

    // add to external api and link to props

    var apis = function apis(_ref) {
        var mixinConfig = _ref.mixinConfig,
            viewProps = _ref.viewProps,
            viewExternalAPI = _ref.viewExternalAPI;
        addGetSet(mixinConfig, viewExternalAPI, viewProps);
    };

    var isDefined = function isDefined(value) {
        return value != null;
    };

    // add to state,
    // add getters and setters to internal and external api (if not set)
    // set initial state based on props in viewProps
    // apply as transforms each frame

    var defaults = {
        opacity: 1,
        scaleX: 1,
        scaleY: 1,
        translateX: 0,
        translateY: 0,
        rotateX: 0,
        rotateY: 0,
        rotateZ: 0,
        originX: 0,
        originY: 0,
    };

    var styles = function styles(_ref) {
        var mixinConfig = _ref.mixinConfig,
            viewProps = _ref.viewProps,
            viewInternalAPI = _ref.viewInternalAPI,
            viewExternalAPI = _ref.viewExternalAPI,
            view = _ref.view;
        // initial props
        var initialProps = Object.assign({}, viewProps);

        // current props
        var currentProps = {};

        // we will add those properties to the external API and link them to the viewState
        addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);

        // override rect on internal and external rect getter so it takes in account transforms
        var getOffset = function getOffset() {
            return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];
        };

        var getScale = function getScale() {
            return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];
        };
        var getRect = function getRect() {
            return view.rect
                ? getViewRect(view.rect, view.childViews, getOffset(), getScale())
                : null;
        };
        viewInternalAPI.rect = { get: getRect };
        viewExternalAPI.rect = { get: getRect };

        // apply view props
        mixinConfig.forEach(function(key) {
            viewProps[key] =
                typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];
        });

        // expose api
        return {
            write: function write() {
                // see if props have changed
                if (!propsHaveChanged(currentProps, viewProps)) {
                    return;
                }

                // moves element to correct position on screen
                applyStyles(view.element, viewProps);

                // store new transforms
                Object.assign(currentProps, Object.assign({}, viewProps));

                // no longer busy
                return true;
            },
            destroy: function destroy() {},
        };
    };

    var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {
        // different amount of keys
        if (Object.keys(currentProps).length !== Object.keys(newProps).length) {
            return true;
        }

        // lets analyze the individual props
        for (var prop in newProps) {
            if (newProps[prop] !== currentProps[prop]) {
                return true;
            }
        }

        return false;
    };

    var applyStyles = function applyStyles(element, _ref2) {
        var opacity = _ref2.opacity,
            perspective = _ref2.perspective,
            translateX = _ref2.translateX,
            translateY = _ref2.translateY,
            scaleX = _ref2.scaleX,
            scaleY = _ref2.scaleY,
            rotateX = _ref2.rotateX,
            rotateY = _ref2.rotateY,
            rotateZ = _ref2.rotateZ,
            originX = _ref2.originX,
            originY = _ref2.originY,
            width = _ref2.width,
            height = _ref2.height;

        var transforms = '';
        var styles = '';

        // handle transform origin
        if (isDefined(originX) || isDefined(originY)) {
            styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';
        }

        // transform order is relevant
        // 0. perspective
        if (isDefined(perspective)) {
            transforms += 'perspective(' + perspective + 'px) ';
        }

        // 1. translate
        if (isDefined(translateX) || isDefined(translateY)) {
            transforms +=
                'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';
        }

        // 2. scale
        if (isDefined(scaleX) || isDefined(scaleY)) {
            transforms +=
                'scale3d(' +
                (isDefined(scaleX) ? scaleX : 1) +
                ', ' +
                (isDefined(scaleY) ? scaleY : 1) +
                ', 1) ';
        }

        // 3. rotate
        if (isDefined(rotateZ)) {
            transforms += 'rotateZ(' + rotateZ + 'rad) ';
        }

        if (isDefined(rotateX)) {
            transforms += 'rotateX(' + rotateX + 'rad) ';
        }

        if (isDefined(rotateY)) {
            transforms += 'rotateY(' + rotateY + 'rad) ';
        }

        // add transforms
        if (transforms.length) {
            styles += 'transform:' + transforms + ';';
        }

        // add opacity
        if (isDefined(opacity)) {
            styles += 'opacity:' + opacity + ';';

            // if we reach zero, we make the element inaccessible
            if (opacity === 0) {
                styles += 'visibility:hidden;';
            }

            // if we're below 100% opacity this element can't be clicked
            if (opacity < 1) {
                styles += 'pointer-events:none;';
            }
        }

        // add height
        if (isDefined(height)) {
            styles += 'height:' + height + 'px;';
        }

        // add width
        if (isDefined(width)) {
            styles += 'width:' + width + 'px;';
        }

        // apply styles
        var elementCurrentStyle = element.elementCurrentStyle || '';

        // if new styles does not match current styles, lets update!
        if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {
            element.style.cssText = styles;
            // store current styles so we can compare them to new styles later on
            // _not_ getting the style value is faster
            element.elementCurrentStyle = styles;
        }
    };

    var Mixins = {
        styles: styles,
        listeners: listeners,
        animations: animations,
        apis: apis,
    };

    var updateRect = function updateRect() {
        var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

        if (!element.layoutCalculated) {
            rect.paddingTop = parseInt(style.paddingTop, 10) || 0;
            rect.marginTop = parseInt(style.marginTop, 10) || 0;
            rect.marginRight = parseInt(style.marginRight, 10) || 0;
            rect.marginBottom = parseInt(style.marginBottom, 10) || 0;
            rect.marginLeft = parseInt(style.marginLeft, 10) || 0;
            element.layoutCalculated = true;
        }

        rect.left = element.offsetLeft || 0;
        rect.top = element.offsetTop || 0;
        rect.width = element.offsetWidth || 0;
        rect.height = element.offsetHeight || 0;

        rect.right = rect.left + rect.width;
        rect.bottom = rect.top + rect.height;

        rect.scrollTop = element.scrollTop;

        rect.hidden = element.offsetParent === null;

        return rect;
    };

    var createView =
        // default view definition
        function createView() {
            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
                _ref$tag = _ref.tag,
                tag = _ref$tag === void 0 ? 'div' : _ref$tag,
                _ref$name = _ref.name,
                name = _ref$name === void 0 ? null : _ref$name,
                _ref$attributes = _ref.attributes,
                attributes = _ref$attributes === void 0 ? {} : _ref$attributes,
                _ref$read = _ref.read,
                read = _ref$read === void 0 ? function() {} : _ref$read,
                _ref$write = _ref.write,
                write = _ref$write === void 0 ? function() {} : _ref$write,
                _ref$create = _ref.create,
                create = _ref$create === void 0 ? function() {} : _ref$create,
                _ref$destroy = _ref.destroy,
                destroy = _ref$destroy === void 0 ? function() {} : _ref$destroy,
                _ref$filterFrameActio = _ref.filterFrameActionsForChild,
                filterFrameActionsForChild =
                    _ref$filterFrameActio === void 0
                        ? function(child, actions) {
                              return actions;
                          }
                        : _ref$filterFrameActio,
                _ref$didCreateView = _ref.didCreateView,
                didCreateView = _ref$didCreateView === void 0 ? function() {} : _ref$didCreateView,
                _ref$didWriteView = _ref.didWriteView,
                didWriteView = _ref$didWriteView === void 0 ? function() {} : _ref$didWriteView,
                _ref$ignoreRect = _ref.ignoreRect,
                ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,
                _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,
                ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,
                _ref$mixins = _ref.mixins,
                mixins = _ref$mixins === void 0 ? [] : _ref$mixins;
            return function(
                // each view requires reference to store
                store
            ) {
                var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                // root element should not be changed
                var element = createElement(tag, 'filepond--' + name, attributes);

                // style reference should also not be changed
                var style = window.getComputedStyle(element, null);

                // element rectangle
                var rect = updateRect();
                var frameRect = null;

                // rest state
                var isResting = false;

                // pretty self explanatory
                var childViews = [];

                // loaded mixins
                var activeMixins = [];

                // references to created children
                var ref = {};

                // state used for each instance
                var state = {};

                // list of writers that will be called to update this view
                var writers = [
                    write, // default writer
                ];

                var readers = [
                    read, // default reader
                ];

                var destroyers = [
                    destroy, // default destroy
                ];

                // core view methods
                var getElement = function getElement() {
                    return element;
                };
                var getChildViews = function getChildViews() {
                    return childViews.concat();
                };
                var getReference = function getReference() {
                    return ref;
                };
                var createChildView = function createChildView(store) {
                    return function(view, props) {
                        return view(store, props);
                    };
                };
                var getRect = function getRect() {
                    if (frameRect) {
                        return frameRect;
                    }
                    frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);
                    return frameRect;
                };
                var getStyle = function getStyle() {
                    return style;
                };

                /**
                 * Read data from DOM
                 * @private
                 */
                var _read = function _read() {
                    frameRect = null;

                    // read child views
                    childViews.forEach(function(child) {
                        return child._read();
                    });

                    var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);
                    if (shouldUpdate) {
                        updateRect(rect, element, style);
                    }

                    // readers
                    var api = { root: internalAPI, props: props, rect: rect };
                    readers.forEach(function(reader) {
                        return reader(api);
                    });
                };

                /**
                 * Write data to DOM
                 * @private
                 */
                var _write = function _write(ts, frameActions, shouldOptimize) {
                    // if no actions, we assume that the view is resting
                    var resting = frameActions.length === 0;

                    // writers
                    writers.forEach(function(writer) {
                        var writerResting = writer({
                            props: props,
                            root: internalAPI,
                            actions: frameActions,
                            timestamp: ts,
                            shouldOptimize: shouldOptimize,
                        });

                        if (writerResting === false) {
                            resting = false;
                        }
                    });

                    // run mixins
                    activeMixins.forEach(function(mixin) {
                        // if one of the mixins is still busy after write operation, we are not resting
                        var mixinResting = mixin.write(ts);
                        if (mixinResting === false) {
                            resting = false;
                        }
                    });

                    // updates child views that are currently attached to the DOM
                    childViews
                        .filter(function(child) {
                            return !!child.element.parentNode;
                        })
                        .forEach(function(child) {
                            // if a child view is not resting, we are not resting
                            var childResting = child._write(
                                ts,
                                filterFrameActionsForChild(child, frameActions),
                                shouldOptimize
                            );

                            if (!childResting) {
                                resting = false;
                            }
                        });

                    // append new elements to DOM and update those
                    childViews
                        //.filter(child => !child.element.parentNode)
                        .forEach(function(child, index) {
                            // skip
                            if (child.element.parentNode) {
                                return;
                            }

                            // append to DOM
                            internalAPI.appendChild(child.element, index);

                            // call read (need to know the size of these elements)
                            child._read();

                            // re-call write
                            child._write(
                                ts,
                                filterFrameActionsForChild(child, frameActions),
                                shouldOptimize
                            );

                            // we just added somthing to the dom, no rest
                            resting = false;
                        });

                    // update resting state
                    isResting = resting;

                    didWriteView({
                        props: props,
                        root: internalAPI,
                        actions: frameActions,
                        timestamp: ts,
                    });

                    // let parent know if we are resting
                    return resting;
                };

                var _destroy = function _destroy() {
                    activeMixins.forEach(function(mixin) {
                        return mixin.destroy();
                    });
                    destroyers.forEach(function(destroyer) {
                        destroyer({ root: internalAPI, props: props });
                    });
                    childViews.forEach(function(child) {
                        return child._destroy();
                    });
                };

                // sharedAPI
                var sharedAPIDefinition = {
                    element: {
                        get: getElement,
                    },

                    style: {
                        get: getStyle,
                    },

                    childViews: {
                        get: getChildViews,
                    },
                };

                // private API definition
                var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {
                    rect: {
                        get: getRect,
                    },

                    // access to custom children references
                    ref: {
                        get: getReference,
                    },

                    // dom modifiers
                    is: function is(needle) {
                        return name === needle;
                    },
                    appendChild: appendChild(element),
                    createChildView: createChildView(store),
                    linkView: function linkView(view) {
                        childViews.push(view);
                        return view;
                    },
                    unlinkView: function unlinkView(view) {
                        childViews.splice(childViews.indexOf(view), 1);
                    },
                    appendChildView: appendChildView(element, childViews),
                    removeChildView: removeChildView(element, childViews),
                    registerWriter: function registerWriter(writer) {
                        return writers.push(writer);
                    },
                    registerReader: function registerReader(reader) {
                        return readers.push(reader);
                    },
                    registerDestroyer: function registerDestroyer(destroyer) {
                        return destroyers.push(destroyer);
                    },
                    invalidateLayout: function invalidateLayout() {
                        return (element.layoutCalculated = false);
                    },

                    // access to data store
                    dispatch: store.dispatch,
                    query: store.query,
                });

                // public view API methods
                var externalAPIDefinition = {
                    element: {
                        get: getElement,
                    },

                    childViews: {
                        get: getChildViews,
                    },

                    rect: {
                        get: getRect,
                    },

                    resting: {
                        get: function get() {
                            return isResting;
                        },
                    },

                    isRectIgnored: function isRectIgnored() {
                        return ignoreRect;
                    },
                    _read: _read,
                    _write: _write,
                    _destroy: _destroy,
                };

                // mixin API methods
                var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {
                    rect: {
                        get: function get() {
                            return rect;
                        },
                    },
                });

                // add mixin functionality
                Object.keys(mixins)
                    .sort(function(a, b) {
                        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)
                        if (a === 'styles') {
                            return 1;
                        } else if (b === 'styles') {
                            return -1;
                        }
                        return 0;
                    })
                    .forEach(function(key) {
                        var mixinAPI = Mixins[key]({
                            mixinConfig: mixins[key],
                            viewProps: props,
                            viewState: state,
                            viewInternalAPI: internalAPIDefinition,
                            viewExternalAPI: externalAPIDefinition,
                            view: createObject(mixinAPIDefinition),
                        });

                        if (mixinAPI) {
                            activeMixins.push(mixinAPI);
                        }
                    });

                // construct private api
                var internalAPI = createObject(internalAPIDefinition);

                // create the view
                create({
                    root: internalAPI,
                    props: props,
                });

                // append created child views to root node
                var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order
                childViews.forEach(function(child, index) {
                    internalAPI.appendChild(child.element, childCount + index);
                });

                // call did create
                didCreateView(internalAPI);

                // expose public api
                return createObject(externalAPIDefinition);
            };
        };

    var createPainter = function createPainter(read, write) {
        var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;

        var name = '__framePainter';

        // set global painter
        if (window[name]) {
            window[name].readers.push(read);
            window[name].writers.push(write);
            return;
        }

        window[name] = {
            readers: [read],
            writers: [write],
        };

        var painter = window[name];

        var interval = 1000 / fps;
        var last = null;
        var id = null;
        var requestTick = null;
        var cancelTick = null;

        var setTimerType = function setTimerType() {
            if (document.hidden) {
                requestTick = function requestTick() {
                    return window.setTimeout(function() {
                        return tick(performance.now());
                    }, interval);
                };
                cancelTick = function cancelTick() {
                    return window.clearTimeout(id);
                };
            } else {
                requestTick = function requestTick() {
                    return window.requestAnimationFrame(tick);
                };
                cancelTick = function cancelTick() {
                    return window.cancelAnimationFrame(id);
                };
            }
        };

        document.addEventListener('visibilitychange', function() {
            if (cancelTick) cancelTick();
            setTimerType();
            tick(performance.now());
        });

        var tick = function tick(ts) {
            // queue next tick
            id = requestTick(tick);

            // limit fps
            if (!last) {
                last = ts;
            }

            var delta = ts - last;

            if (delta <= interval) {
                // skip frame
                return;
            }

            // align next frame
            last = ts - (delta % interval);

            // update view
            painter.readers.forEach(function(read) {
                return read();
            });
            painter.writers.forEach(function(write) {
                return write(ts);
            });
        };

        setTimerType();
        tick(performance.now());

        return {
            pause: function pause() {
                cancelTick(id);
            },
        };
    };

    var createRoute = function createRoute(routes, fn) {
        return function(_ref) {
            var root = _ref.root,
                props = _ref.props,
                _ref$actions = _ref.actions,
                actions = _ref$actions === void 0 ? [] : _ref$actions,
                timestamp = _ref.timestamp,
                shouldOptimize = _ref.shouldOptimize;
            actions
                .filter(function(action) {
                    return routes[action.type];
                })
                .forEach(function(action) {
                    return routes[action.type]({
                        root: root,
                        props: props,
                        action: action.data,
                        timestamp: timestamp,
                        shouldOptimize: shouldOptimize,
                    });
                });

            if (fn) {
                fn({
                    root: root,
                    props: props,
                    actions: actions,
                    timestamp: timestamp,
                    shouldOptimize: shouldOptimize,
                });
            }
        };
    };

    var insertBefore = function insertBefore(newNode, referenceNode) {
        return referenceNode.parentNode.insertBefore(newNode, referenceNode);
    };

    var insertAfter = function insertAfter(newNode, referenceNode) {
        return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
    };

    var isArray = function isArray(value) {
        return Array.isArray(value);
    };

    var isEmpty = function isEmpty(value) {
        return value == null;
    };

    var trim = function trim(str) {
        return str.trim();
    };

    var toString = function toString(value) {
        return '' + value;
    };

    var toArray = function toArray(value) {
        var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';
        if (isEmpty(value)) {
            return [];
        }
        if (isArray(value)) {
            return value;
        }
        return toString(value)
            .split(splitter)
            .map(trim)
            .filter(function(str) {
                return str.length;
            });
    };

    var isBoolean = function isBoolean(value) {
        return typeof value === 'boolean';
    };

    var toBoolean = function toBoolean(value) {
        return isBoolean(value) ? value : value === 'true';
    };

    var isString = function isString(value) {
        return typeof value === 'string';
    };

    var toNumber = function toNumber(value) {
        return isNumber(value)
            ? value
            : isString(value)
            ? toString(value).replace(/[a-z]+/gi, '')
            : 0;
    };

    var toInt = function toInt(value) {
        return parseInt(toNumber(value), 10);
    };

    var toFloat = function toFloat(value) {
        return parseFloat(toNumber(value));
    };

    var isInt = function isInt(value) {
        return isNumber(value) && isFinite(value) && Math.floor(value) === value;
    };

    var toBytes = function toBytes(value) {
        var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;
        // is in bytes
        if (isInt(value)) {
            return value;
        }

        // is natural file size
        var naturalFileSize = toString(value).trim();

        // if is value in megabytes
        if (/MB$/i.test(naturalFileSize)) {
            naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();
            return toInt(naturalFileSize) * base * base;
        }

        // if is value in kilobytes
        if (/KB/i.test(naturalFileSize)) {
            naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();
            return toInt(naturalFileSize) * base;
        }

        return toInt(naturalFileSize);
    };

    var isFunction = function isFunction(value) {
        return typeof value === 'function';
    };

    var toFunctionReference = function toFunctionReference(string) {
        var ref = self;
        var levels = string.split('.');
        var level = null;
        while ((level = levels.shift())) {
            ref = ref[level];
            if (!ref) {
                return null;
            }
        }
        return ref;
    };

    var methods = {
        process: 'POST',
        patch: 'PATCH',
        revert: 'DELETE',
        fetch: 'GET',
        restore: 'GET',
        load: 'GET',
    };

    var createServerAPI = function createServerAPI(outline) {
        var api = {};

        api.url = isString(outline) ? outline : outline.url || '';
        api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;
        api.headers = outline.headers ? outline.headers : {};

        forin(methods, function(key) {
            api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);
        });

        // remove process if no url or process on outline
        api.process = outline.process || isString(outline) || outline.url ? api.process : null;

        // special treatment for remove
        api.remove = outline.remove || null;

        // remove generic headers from api object
        delete api.headers;

        return api;
    };

    var createAction = function createAction(name, outline, method, timeout, headers) {
        // is explicitely set to null so disable
        if (outline === null) {
            return null;
        }

        // if is custom function, done! Dev handles everything.
        if (typeof outline === 'function') {
            return outline;
        }

        // build action object
        var action = {
            url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',
            method: method,
            headers: headers,
            withCredentials: false,
            timeout: timeout,
            onload: null,
            ondata: null,
            onerror: null,
        };

        // is a single url
        if (isString(outline)) {
            action.url = outline;
            return action;
        }

        // overwrite
        Object.assign(action, outline);

        // see if should reformat headers;
        if (isString(action.headers)) {
            var parts = action.headers.split(/:(.+)/);
            action.headers = {
                header: parts[0],
                value: parts[1],
            };
        }

        // if is bool withCredentials
        action.withCredentials = toBoolean(action.withCredentials);

        return action;
    };

    var toServerAPI = function toServerAPI(value) {
        return createServerAPI(value);
    };

    var isNull = function isNull(value) {
        return value === null;
    };

    var isObject = function isObject(value) {
        return typeof value === 'object' && value !== null;
    };

    var isAPI = function isAPI(value) {
        return (
            isObject(value) &&
            isString(value.url) &&
            isObject(value.process) &&
            isObject(value.revert) &&
            isObject(value.restore) &&
            isObject(value.fetch)
        );
    };

    var getType = function getType(value) {
        if (isArray(value)) {
            return 'array';
        }

        if (isNull(value)) {
            return 'null';
        }

        if (isInt(value)) {
            return 'int';
        }

        if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {
            return 'bytes';
        }

        if (isAPI(value)) {
            return 'api';
        }

        return typeof value;
    };

    var replaceSingleQuotes = function replaceSingleQuotes(str) {
        return str
            .replace(/{\s*'/g, '{"')
            .replace(/'\s*}/g, '"}')
            .replace(/'\s*:/g, '":')
            .replace(/:\s*'/g, ':"')
            .replace(/,\s*'/g, ',"')
            .replace(/'\s*,/g, '",');
    };

    var conversionTable = {
        array: toArray,
        boolean: toBoolean,
        int: function int(value) {
            return getType(value) === 'bytes' ? toBytes(value) : toInt(value);
        },
        number: toFloat,
        float: toFloat,
        bytes: toBytes,
        string: function string(value) {
            return isFunction(value) ? value : toString(value);
        },
        function: function _function(value) {
            return toFunctionReference(value);
        },
        serverapi: toServerAPI,
        object: function object(value) {
            try {
                return JSON.parse(replaceSingleQuotes(value));
            } catch (e) {
                return null;
            }
        },
    };

    var convertTo = function convertTo(value, type) {
        return conversionTable[type](value);
    };

    var getValueByType = function getValueByType(newValue, defaultValue, valueType) {
        // can always assign default value
        if (newValue === defaultValue) {
            return newValue;
        }

        // get the type of the new value
        var newValueType = getType(newValue);

        // is valid type?
        if (newValueType !== valueType) {
            // is string input, let's attempt to convert
            var convertedValue = convertTo(newValue, valueType);

            // what is the type now
            newValueType = getType(convertedValue);

            // no valid conversions found
            if (convertedValue === null) {
                throw 'Trying to assign value with incorrect type to "' +
                    option +
                    '", allowed type: "' +
                    valueType +
                    '"';
            } else {
                newValue = convertedValue;
            }
        }

        // assign new value
        return newValue;
    };

    var createOption = function createOption(defaultValue, valueType) {
        var currentValue = defaultValue;
        return {
            enumerable: true,
            get: function get() {
                return currentValue;
            },
            set: function set(newValue) {
                currentValue = getValueByType(newValue, defaultValue, valueType);
            },
        };
    };

    var createOptions = function createOptions(options) {
        var obj = {};
        forin(options, function(prop) {
            var optionDefinition = options[prop];
            obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);
        });
        return createObject(obj);
    };

    var createInitialState = function createInitialState(options) {
        return {
            // model
            items: [],

            // timeout used for calling update items
            listUpdateTimeout: null,

            // timeout used for stacking metadata updates
            itemUpdateTimeout: null,

            // queue of items waiting to be processed
            processingQueue: [],

            // options
            options: createOptions(options),
        };
    };

    var fromCamels = function fromCamels(string) {
        var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';
        return string
            .split(/(?=[A-Z])/)
            .map(function(part) {
                return part.toLowerCase();
            })
            .join(separator);
    };

    var createOptionAPI = function createOptionAPI(store, options) {
        var obj = {};
        forin(options, function(key) {
            obj[key] = {
                get: function get() {
                    return store.getState().options[key];
                },
                set: function set(value) {
                    store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {
                        value: value,
                    });
                },
            };
        });
        return obj;
    };

    var createOptionActions = function createOptionActions(options) {
        return function(dispatch, query, state) {
            var obj = {};
            forin(options, function(key) {
                var name = fromCamels(key, '_').toUpperCase();

                obj['SET_' + name] = function(action) {
                    try {
                        state.options[key] = action.value;
                    } catch (e) {} // nope, failed

                    // we successfully set the value of this option
                    dispatch('DID_SET_' + name, { value: state.options[key] });
                };
            });
            return obj;
        };
    };

    var createOptionQueries = function createOptionQueries(options) {
        return function(state) {
            var obj = {};
            forin(options, function(key) {
                obj['GET_' + fromCamels(key, '_').toUpperCase()] = function(action) {
                    return state.options[key];
                };
            });
            return obj;
        };
    };

    var InteractionMethod = {
        API: 1,
        DROP: 2,
        BROWSE: 3,
        PASTE: 4,
        NONE: 5,
    };

    var getUniqueId = function getUniqueId() {
        return Math.random()
            .toString(36)
            .substr(2, 9);
    };

    function _typeof(obj) {
        if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {
            _typeof = function(obj) {
                return typeof obj;
            };
        } else {
            _typeof = function(obj) {
                return obj &&
                    typeof Symbol === 'function' &&
                    obj.constructor === Symbol &&
                    obj !== Symbol.prototype
                    ? 'symbol'
                    : typeof obj;
            };
        }

        return _typeof(obj);
    }

    var REACT_ELEMENT_TYPE;

    function _jsx(type, props, key, children) {
        if (!REACT_ELEMENT_TYPE) {
            REACT_ELEMENT_TYPE =
                (typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element')) ||
                0xeac7;
        }

        var defaultProps = type && type.defaultProps;
        var childrenLength = arguments.length - 3;

        if (!props && childrenLength !== 0) {
            props = {
                children: void 0,
            };
        }

        if (props && defaultProps) {
            for (var propName in defaultProps) {
                if (props[propName] === void 0) {
                    props[propName] = defaultProps[propName];
                }
            }
        } else if (!props) {
            props = defaultProps || {};
        }

        if (childrenLength === 1) {
            props.children = children;
        } else if (childrenLength > 1) {
            var childArray = new Array(childrenLength);

            for (var i = 0; i < childrenLength; i++) {
                childArray[i] = arguments[i + 3];
            }

            props.children = childArray;
        }

        return {
            $$typeof: REACT_ELEMENT_TYPE,
            type: type,
            key: key === undefined ? null : '' + key,
            ref: null,
            props: props,
            _owner: null,
        };
    }

    function _asyncIterator(iterable) {
        var method;

        if (typeof Symbol !== 'undefined') {
            if (Symbol.asyncIterator) {
                method = iterable[Symbol.asyncIterator];
                if (method != null) return method.call(iterable);
            }

            if (Symbol.iterator) {
                method = iterable[Symbol.iterator];
                if (method != null) return method.call(iterable);
            }
        }

        throw new TypeError('Object is not async iterable');
    }

    function _AwaitValue(value) {
        this.wrapped = value;
    }

    function _AsyncGenerator(gen) {
        var front, back;

        function send(key, arg) {
            return new Promise(function(resolve, reject) {
                var request = {
                    key: key,
                    arg: arg,
                    resolve: resolve,
                    reject: reject,
                    next: null,
                };

                if (back) {
                    back = back.next = request;
                } else {
                    front = back = request;
                    resume(key, arg);
                }
            });
        }

        function resume(key, arg) {
            try {
                var result = gen[key](arg);
                var value = result.value;
                var wrappedAwait = value instanceof _AwaitValue;
                Promise.resolve(wrappedAwait ? value.wrapped : value).then(
                    function(arg) {
                        if (wrappedAwait) {
                            resume('next', arg);
                            return;
                        }

                        settle(result.done ? 'return' : 'normal', arg);
                    },
                    function(err) {
                        resume('throw', err);
                    }
                );
            } catch (err) {
                settle('throw', err);
            }
        }

        function settle(type, value) {
            switch (type) {
                case 'return':
                    front.resolve({
                        value: value,
                        done: true,
                    });
                    break;

                case 'throw':
                    front.reject(value);
                    break;

                default:
                    front.resolve({
                        value: value,
                        done: false,
                    });
                    break;
            }

            front = front.next;

            if (front) {
                resume(front.key, front.arg);
            } else {
                back = null;
            }
        }

        this._invoke = send;

        if (typeof gen.return !== 'function') {
            this.return = undefined;
        }
    }

    if (typeof Symbol === 'function' && Symbol.asyncIterator) {
        _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {
            return this;
        };
    }

    _AsyncGenerator.prototype.next = function(arg) {
        return this._invoke('next', arg);
    };

    _AsyncGenerator.prototype.throw = function(arg) {
        return this._invoke('throw', arg);
    };

    _AsyncGenerator.prototype.return = function(arg) {
        return this._invoke('return', arg);
    };

    function _wrapAsyncGenerator(fn) {
        return function() {
            return new _AsyncGenerator(fn.apply(this, arguments));
        };
    }

    function _awaitAsyncGenerator(value) {
        return new _AwaitValue(value);
    }

    function _asyncGeneratorDelegate(inner, awaitWrap) {
        var iter = {},
            waiting = false;

        function pump(key, value) {
            waiting = true;
            value = new Promise(function(resolve) {
                resolve(inner[key](value));
            });
            return {
                done: false,
                value: awaitWrap(value),
            };
        }

        if (typeof Symbol === 'function' && Symbol.iterator) {
            iter[Symbol.iterator] = function() {
                return this;
            };
        }

        iter.next = function(value) {
            if (waiting) {
                waiting = false;
                return value;
            }

            return pump('next', value);
        };

        if (typeof inner.throw === 'function') {
            iter.throw = function(value) {
                if (waiting) {
                    waiting = false;
                    throw value;
                }

                return pump('throw', value);
            };
        }

        if (typeof inner.return === 'function') {
            iter.return = function(value) {
                return pump('return', value);
            };
        }

        return iter;
    }

    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
        try {
            var info = gen[key](arg);
            var value = info.value;
        } catch (error) {
            reject(error);
            return;
        }

        if (info.done) {
            resolve(value);
        } else {
            Promise.resolve(value).then(_next, _throw);
        }
    }

    function _asyncToGenerator(fn) {
        return function() {
            var self = this,
                args = arguments;
            return new Promise(function(resolve, reject) {
                var gen = fn.apply(self, args);

                function _next(value) {
                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);
                }

                function _throw(err) {
                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);
                }

                _next(undefined);
            });
        };
    }

    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError('Cannot call a class as a function');
        }
    }

    function _defineProperties(target, props) {
        for (var i = 0; i < props.length; i++) {
            var descriptor = props[i];
            descriptor.enumerable = descriptor.enumerable || false;
            descriptor.configurable = true;
            if ('value' in descriptor) descriptor.writable = true;
            Object.defineProperty(target, descriptor.key, descriptor);
        }
    }

    function _createClass(Constructor, protoProps, staticProps) {
        if (protoProps) _defineProperties(Constructor.prototype, protoProps);
        if (staticProps) _defineProperties(Constructor, staticProps);
        return Constructor;
    }

    function _defineEnumerableProperties(obj, descs) {
        for (var key in descs) {
            var desc = descs[key];
            desc.configurable = desc.enumerable = true;
            if ('value' in desc) desc.writable = true;
            Object.defineProperty(obj, key, desc);
        }

        if (Object.getOwnPropertySymbols) {
            var objectSymbols = Object.getOwnPropertySymbols(descs);

            for (var i = 0; i < objectSymbols.length; i++) {
                var sym = objectSymbols[i];
                var desc = descs[sym];
                desc.configurable = desc.enumerable = true;
                if ('value' in desc) desc.writable = true;
                Object.defineProperty(obj, sym, desc);
            }
        }

        return obj;
    }

    function _defaults(obj, defaults) {
        var keys = Object.getOwnPropertyNames(defaults);

        for (var i = 0; i < keys.length; i++) {
            var key = keys[i];
            var value = Object.getOwnPropertyDescriptor(defaults, key);

            if (value && value.configurable && obj[key] === undefined) {
                Object.defineProperty(obj, key, value);
            }
        }

        return obj;
    }

    function _defineProperty(obj, key, value) {
        if (key in obj) {
            Object.defineProperty(obj, key, {
                value: value,
                enumerable: true,
                configurable: true,
                writable: true,
            });
        } else {
            obj[key] = value;
        }

        return obj;
    }

    function _extends() {
        _extends =
            Object.assign ||
            function(target) {
                for (var i = 1; i < arguments.length; i++) {
                    var source = arguments[i];

                    for (var key in source) {
                        if (Object.prototype.hasOwnProperty.call(source, key)) {
                            target[key] = source[key];
                        }
                    }
                }

                return target;
            };

        return _extends.apply(this, arguments);
    }

    function _objectSpread(target) {
        for (var i = 1; i < arguments.length; i++) {
            var source = arguments[i] != null ? arguments[i] : {};
            var ownKeys = Object.keys(source);

            if (typeof Object.getOwnPropertySymbols === 'function') {
                ownKeys = ownKeys.concat(
                    Object.getOwnPropertySymbols(source).filter(function(sym) {
                        return Object.getOwnPropertyDescriptor(source, sym).enumerable;
                    })
                );
            }

            ownKeys.forEach(function(key) {
                _defineProperty(target, key, source[key]);
            });
        }

        return target;
    }

    function ownKeys(object, enumerableOnly) {
        var keys = Object.keys(object);

        if (Object.getOwnPropertySymbols) {
            var symbols = Object.getOwnPropertySymbols(object);
            if (enumerableOnly)
                symbols = symbols.filter(function(sym) {
                    return Object.getOwnPropertyDescriptor(object, sym).enumerable;
                });
            keys.push.apply(keys, symbols);
        }

        return keys;
    }

    function _objectSpread2(target) {
        for (var i = 1; i < arguments.length; i++) {
            var source = arguments[i] != null ? arguments[i] : {};

            if (i % 2) {
                ownKeys(source, true).forEach(function(key) {
                    _defineProperty(target, key, source[key]);
                });
            } else if (Object.getOwnPropertyDescriptors) {
                Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
            } else {
                ownKeys(source).forEach(function(key) {
                    Object.defineProperty(
                        target,
                        key,
                        Object.getOwnPropertyDescriptor(source, key)
                    );
                });
            }
        }

        return target;
    }

    function _inherits(subClass, superClass) {
        if (typeof superClass !== 'function' && superClass !== null) {
            throw new TypeError('Super expression must either be null or a function');
        }

        subClass.prototype = Object.create(superClass && superClass.prototype, {
            constructor: {
                value: subClass,
                writable: true,
                configurable: true,
            },
        });
        if (superClass) _setPrototypeOf(subClass, superClass);
    }

    function _inheritsLoose(subClass, superClass) {
        subClass.prototype = Object.create(superClass.prototype);
        subClass.prototype.constructor = subClass;
        subClass.__proto__ = superClass;
    }

    function _getPrototypeOf(o) {
        _getPrototypeOf = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function _getPrototypeOf(o) {
                  return o.__proto__ || Object.getPrototypeOf(o);
              };
        return _getPrototypeOf(o);
    }

    function _setPrototypeOf(o, p) {
        _setPrototypeOf =
            Object.setPrototypeOf ||
            function _setPrototypeOf(o, p) {
                o.__proto__ = p;
                return o;
            };

        return _setPrototypeOf(o, p);
    }

    function isNativeReflectConstruct() {
        if (typeof Reflect === 'undefined' || !Reflect.construct) return false;
        if (Reflect.construct.sham) return false;
        if (typeof Proxy === 'function') return true;

        try {
            Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));
            return true;
        } catch (e) {
            return false;
        }
    }

    function _construct(Parent, args, Class) {
        if (isNativeReflectConstruct()) {
            _construct = Reflect.construct;
        } else {
            _construct = function _construct(Parent, args, Class) {
                var a = [null];
                a.push.apply(a, args);
                var Constructor = Function.bind.apply(Parent, a);
                var instance = new Constructor();
                if (Class) _setPrototypeOf(instance, Class.prototype);
                return instance;
            };
        }

        return _construct.apply(null, arguments);
    }

    function _isNativeFunction(fn) {
        return Function.toString.call(fn).indexOf('[native code]') !== -1;
    }

    function _wrapNativeSuper(Class) {
        var _cache = typeof Map === 'function' ? new Map() : undefined;

        _wrapNativeSuper = function _wrapNativeSuper(Class) {
            if (Class === null || !_isNativeFunction(Class)) return Class;

            if (typeof Class !== 'function') {
                throw new TypeError('Super expression must either be null or a function');
            }

            if (typeof _cache !== 'undefined') {
                if (_cache.has(Class)) return _cache.get(Class);

                _cache.set(Class, Wrapper);
            }

            function Wrapper() {
                return _construct(Class, arguments, _getPrototypeOf(this).constructor);
            }

            Wrapper.prototype = Object.create(Class.prototype, {
                constructor: {
                    value: Wrapper,
                    enumerable: false,
                    writable: true,
                    configurable: true,
                },
            });
            return _setPrototypeOf(Wrapper, Class);
        };

        return _wrapNativeSuper(Class);
    }

    function _instanceof(left, right) {
        if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {
            return !!right[Symbol.hasInstance](left);
        } else {
            return left instanceof right;
        }
    }

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule
            ? obj
            : {
                  default: obj,
              };
    }

    function _interopRequireWildcard(obj) {
        if (obj && obj.__esModule) {
            return obj;
        } else {
            var newObj = {};

            if (obj != null) {
                for (var key in obj) {
                    if (Object.prototype.hasOwnProperty.call(obj, key)) {
                        var desc =
                            Object.defineProperty && Object.getOwnPropertyDescriptor
                                ? Object.getOwnPropertyDescriptor(obj, key)
                                : {};

                        if (desc.get || desc.set) {
                            Object.defineProperty(newObj, key, desc);
                        } else {
                            newObj[key] = obj[key];
                        }
                    }
                }
            }

            newObj.default = obj;
            return newObj;
        }
    }

    function _newArrowCheck(innerThis, boundThis) {
        if (innerThis !== boundThis) {
            throw new TypeError('Cannot instantiate an arrow function');
        }
    }

    function _objectDestructuringEmpty(obj) {
        if (obj == null) throw new TypeError('Cannot destructure undefined');
    }

    function _objectWithoutPropertiesLoose(source, excluded) {
        if (source == null) return {};
        var target = {};
        var sourceKeys = Object.keys(source);
        var key, i;

        for (i = 0; i < sourceKeys.length; i++) {
            key = sourceKeys[i];
            if (excluded.indexOf(key) >= 0) continue;
            target[key] = source[key];
        }

        return target;
    }

    function _objectWithoutProperties(source, excluded) {
        if (source == null) return {};

        var target = _objectWithoutPropertiesLoose(source, excluded);

        var key, i;

        if (Object.getOwnPropertySymbols) {
            var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

            for (i = 0; i < sourceSymbolKeys.length; i++) {
                key = sourceSymbolKeys[i];
                if (excluded.indexOf(key) >= 0) continue;
                if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
                target[key] = source[key];
            }
        }

        return target;
    }

    function _assertThisInitialized(self) {
        if (self === void 0) {
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }

        return self;
    }

    function _possibleConstructorReturn(self, call) {
        if (call && (typeof call === 'object' || typeof call === 'function')) {
            return call;
        }

        return _assertThisInitialized(self);
    }

    function _superPropBase(object, property) {
        while (!Object.prototype.hasOwnProperty.call(object, property)) {
            object = _getPrototypeOf(object);
            if (object === null) break;
        }

        return object;
    }

    function _get(target, property, receiver) {
        if (typeof Reflect !== 'undefined' && Reflect.get) {
            _get = Reflect.get;
        } else {
            _get = function _get(target, property, receiver) {
                var base = _superPropBase(target, property);

                if (!base) return;
                var desc = Object.getOwnPropertyDescriptor(base, property);

                if (desc.get) {
                    return desc.get.call(receiver);
                }

                return desc.value;
            };
        }

        return _get(target, property, receiver || target);
    }

    function set(target, property, value, receiver) {
        if (typeof Reflect !== 'undefined' && Reflect.set) {
            set = Reflect.set;
        } else {
            set = function set(target, property, value, receiver) {
                var base = _superPropBase(target, property);

                var desc;

                if (base) {
                    desc = Object.getOwnPropertyDescriptor(base, property);

                    if (desc.set) {
                        desc.set.call(receiver, value);
                        return true;
                    } else if (!desc.writable) {
                        return false;
                    }
                }

                desc = Object.getOwnPropertyDescriptor(receiver, property);

                if (desc) {
                    if (!desc.writable) {
                        return false;
                    }

                    desc.value = value;
                    Object.defineProperty(receiver, property, desc);
                } else {
                    _defineProperty(receiver, property, value);
                }

                return true;
            };
        }

        return set(target, property, value, receiver);
    }

    function _set(target, property, value, receiver, isStrict) {
        var s = set(target, property, value, receiver || target);

        if (!s && isStrict) {
            throw new Error('failed to set property');
        }

        return value;
    }

    function _taggedTemplateLiteral(strings, raw) {
        if (!raw) {
            raw = strings.slice(0);
        }

        return Object.freeze(
            Object.defineProperties(strings, {
                raw: {
                    value: Object.freeze(raw),
                },
            })
        );
    }

    function _taggedTemplateLiteralLoose(strings, raw) {
        if (!raw) {
            raw = strings.slice(0);
        }

        strings.raw = raw;
        return strings;
    }

    function _temporalRef(val, name) {
        if (val === _temporalUndefined) {
            throw new ReferenceError(name + ' is not defined - temporal dead zone');
        } else {
            return val;
        }
    }

    function _readOnlyError(name) {
        throw new Error('"' + name + '" is read-only');
    }

    function _classNameTDZError(name) {
        throw new Error('Class "' + name + '" cannot be referenced in computed property keys.');
    }

    var _temporalUndefined = {};

    function _slicedToArray(arr, i) {
        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
    }

    function _slicedToArrayLoose(arr, i) {
        return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();
    }

    function _toArray(arr) {
        return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();
    }

    function _toConsumableArray(arr) {
        return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();
    }

    function _arrayWithoutHoles(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];

            return arr2;
        }
    }

    function _arrayWithHoles(arr) {
        if (Array.isArray(arr)) return arr;
    }

    function _iterableToArray(iter) {
        if (
            Symbol.iterator in Object(iter) ||
            Object.prototype.toString.call(iter) === '[object Arguments]'
        )
            return Array.from(iter);
    }

    function _iterableToArrayLimit(arr, i) {
        var _arr = [];
        var _n = true;
        var _d = false;
        var _e = undefined;

        try {
            for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                _arr.push(_s.value);

                if (i && _arr.length === i) break;
            }
        } catch (err) {
            _d = true;
            _e = err;
        } finally {
            try {
                if (!_n && _i['return'] != null) _i['return']();
            } finally {
                if (_d) throw _e;
            }
        }

        return _arr;
    }

    function _iterableToArrayLimitLoose(arr, i) {
        var _arr = [];

        for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {
            _arr.push(_step.value);

            if (i && _arr.length === i) break;
        }

        return _arr;
    }

    function _nonIterableSpread() {
        throw new TypeError('Invalid attempt to spread non-iterable instance');
    }

    function _nonIterableRest() {
        throw new TypeError('Invalid attempt to destructure non-iterable instance');
    }

    function _skipFirstGeneratorNext(fn) {
        return function() {
            var it = fn.apply(this, arguments);
            it.next();
            return it;
        };
    }

    function _toPrimitive(input, hint) {
        if (typeof input !== 'object' || input === null) return input;
        var prim = input[Symbol.toPrimitive];

        if (prim !== undefined) {
            var res = prim.call(input, hint || 'default');
            if (typeof res !== 'object') return res;
            throw new TypeError('@@toPrimitive must return a primitive value.');
        }

        return (hint === 'string' ? String : Number)(input);
    }

    function _toPropertyKey(arg) {
        var key = _toPrimitive(arg, 'string');

        return typeof key === 'symbol' ? key : String(key);
    }

    function _initializerWarningHelper(descriptor, context) {
        throw new Error(
            'Decorating class property failed. Please ensure that ' +
                'proposal-class-properties is enabled and set to use loose mode. ' +
                'To use proposal-class-properties in spec mode with decorators, wait for ' +
                'the next major version of decorators in stage 2.'
        );
    }

    function _initializerDefineProperty(target, property, descriptor, context) {
        if (!descriptor) return;
        Object.defineProperty(target, property, {
            enumerable: descriptor.enumerable,
            configurable: descriptor.configurable,
            writable: descriptor.writable,
            value: descriptor.initializer ? descriptor.initializer.call(context) : void 0,
        });
    }

    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
        var desc = {};
        Object.keys(descriptor).forEach(function(key) {
            desc[key] = descriptor[key];
        });
        desc.enumerable = !!desc.enumerable;
        desc.configurable = !!desc.configurable;

        if ('value' in desc || desc.initializer) {
            desc.writable = true;
        }

        desc = decorators
            .slice()
            .reverse()
            .reduce(function(desc, decorator) {
                return decorator(target, property, desc) || desc;
            }, desc);

        if (context && desc.initializer !== void 0) {
            desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
            desc.initializer = undefined;
        }

        if (desc.initializer === void 0) {
            Object.defineProperty(target, property, desc);
            desc = null;
        }

        return desc;
    }

    var id = 0;

    function _classPrivateFieldLooseKey(name) {
        return '__private_' + id++ + '_' + name;
    }

    function _classPrivateFieldLooseBase(receiver, privateKey) {
        if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {
            throw new TypeError('attempted to use private field on non-instance');
        }

        return receiver;
    }

    function _classPrivateFieldGet(receiver, privateMap) {
        var descriptor = privateMap.get(receiver);

        if (!descriptor) {
            throw new TypeError('attempted to get private field on non-instance');
        }

        if (descriptor.get) {
            return descriptor.get.call(receiver);
        }

        return descriptor.value;
    }

    function _classPrivateFieldSet(receiver, privateMap, value) {
        var descriptor = privateMap.get(receiver);

        if (!descriptor) {
            throw new TypeError('attempted to set private field on non-instance');
        }

        if (descriptor.set) {
            descriptor.set.call(receiver, value);
        } else {
            if (!descriptor.writable) {
                throw new TypeError('attempted to set read only private field');
            }

            descriptor.value = value;
        }

        return value;
    }

    function _classPrivateFieldDestructureSet(receiver, privateMap) {
        if (!privateMap.has(receiver)) {
            throw new TypeError('attempted to set private field on non-instance');
        }

        var descriptor = privateMap.get(receiver);

        if (descriptor.set) {
            if (!('__destrObj' in descriptor)) {
                descriptor.__destrObj = {
                    set value(v) {
                        descriptor.set.call(receiver, v);
                    },
                };
            }

            return descriptor.__destrObj;
        } else {
            if (!descriptor.writable) {
                throw new TypeError('attempted to set read only private field');
            }

            return descriptor;
        }
    }

    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {
        if (receiver !== classConstructor) {
            throw new TypeError('Private static access of wrong provenance');
        }

        return descriptor.value;
    }

    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {
        if (receiver !== classConstructor) {
            throw new TypeError('Private static access of wrong provenance');
        }

        if (!descriptor.writable) {
            throw new TypeError('attempted to set read only private field');
        }

        descriptor.value = value;
        return value;
    }

    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {
        if (receiver !== classConstructor) {
            throw new TypeError('Private static access of wrong provenance');
        }

        return method;
    }

    function _classStaticPrivateMethodSet() {
        throw new TypeError('attempted to set read only static private field');
    }

    function _decorate(decorators, factory, superClass, mixins) {
        var api = _getDecoratorsApi();

        if (mixins) {
            for (var i = 0; i < mixins.length; i++) {
                api = mixins[i](api);
            }
        }

        var r = factory(function initialize(O) {
            api.initializeInstanceElements(O, decorated.elements);
        }, superClass);
        var decorated = api.decorateClass(
            _coalesceClassElements(r.d.map(_createElementDescriptor)),
            decorators
        );
        api.initializeClassElements(r.F, decorated.elements);
        return api.runClassFinishers(r.F, decorated.finishers);
    }

    function _getDecoratorsApi() {
        _getDecoratorsApi = function() {
            return api;
        };

        var api = {
            elementsDefinitionOrder: [['method'], ['field']],
            initializeInstanceElements: function(O, elements) {
                ['method', 'field'].forEach(function(kind) {
                    elements.forEach(function(element) {
                        if (element.kind === kind && element.placement === 'own') {
                            this.defineClassElement(O, element);
                        }
                    }, this);
                }, this);
            },
            initializeClassElements: function(F, elements) {
                var proto = F.prototype;
                ['method', 'field'].forEach(function(kind) {
                    elements.forEach(function(element) {
                        var placement = element.placement;

                        if (
                            element.kind === kind &&
                            (placement === 'static' || placement === 'prototype')
                        ) {
                            var receiver = placement === 'static' ? F : proto;
                            this.defineClassElement(receiver, element);
                        }
                    }, this);
                }, this);
            },
            defineClassElement: function(receiver, element) {
                var descriptor = element.descriptor;

                if (element.kind === 'field') {
                    var initializer = element.initializer;
                    descriptor = {
                        enumerable: descriptor.enumerable,
                        writable: descriptor.writable,
                        configurable: descriptor.configurable,
                        value: initializer === void 0 ? void 0 : initializer.call(receiver),
                    };
                }

                Object.defineProperty(receiver, element.key, descriptor);
            },
            decorateClass: function(elements, decorators) {
                var newElements = [];
                var finishers = [];
                var placements = {
                    static: [],
                    prototype: [],
                    own: [],
                };
                elements.forEach(function(element) {
                    this.addElementPlacement(element, placements);
                }, this);
                elements.forEach(function(element) {
                    if (!_hasDecorators(element)) return newElements.push(element);
                    var elementFinishersExtras = this.decorateElement(element, placements);
                    newElements.push(elementFinishersExtras.element);
                    newElements.push.apply(newElements, elementFinishersExtras.extras);
                    finishers.push.apply(finishers, elementFinishersExtras.finishers);
                }, this);

                if (!decorators) {
                    return {
                        elements: newElements,
                        finishers: finishers,
                    };
                }

                var result = this.decorateConstructor(newElements, decorators);
                finishers.push.apply(finishers, result.finishers);
                result.finishers = finishers;
                return result;
            },
            addElementPlacement: function(element, placements, silent) {
                var keys = placements[element.placement];

                if (!silent && keys.indexOf(element.key) !== -1) {
                    throw new TypeError('Duplicated element (' + element.key + ')');
                }

                keys.push(element.key);
            },
            decorateElement: function(element, placements) {
                var extras = [];
                var finishers = [];

                for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {
                    var keys = placements[element.placement];
                    keys.splice(keys.indexOf(element.key), 1);
                    var elementObject = this.fromElementDescriptor(element);
                    var elementFinisherExtras = this.toElementFinisherExtras(
                        (0, decorators[i])(elementObject) || elementObject
                    );
                    element = elementFinisherExtras.element;
                    this.addElementPlacement(element, placements);

                    if (elementFinisherExtras.finisher) {
                        finishers.push(elementFinisherExtras.finisher);
                    }

                    var newExtras = elementFinisherExtras.extras;

                    if (newExtras) {
                        for (var j = 0; j < newExtras.length; j++) {
                            this.addElementPlacement(newExtras[j], placements);
                        }

                        extras.push.apply(extras, newExtras);
                    }
                }

                return {
                    element: element,
                    finishers: finishers,
                    extras: extras,
                };
            },
            decorateConstructor: function(elements, decorators) {
                var finishers = [];

                for (var i = decorators.length - 1; i >= 0; i--) {
                    var obj = this.fromClassDescriptor(elements);
                    var elementsAndFinisher = this.toClassDescriptor(
                        (0, decorators[i])(obj) || obj
                    );

                    if (elementsAndFinisher.finisher !== undefined) {
                        finishers.push(elementsAndFinisher.finisher);
                    }

                    if (elementsAndFinisher.elements !== undefined) {
                        elements = elementsAndFinisher.elements;

                        for (var j = 0; j < elements.length - 1; j++) {
                            for (var k = j + 1; k < elements.length; k++) {
                                if (
                                    elements[j].key === elements[k].key &&
                                    elements[j].placement === elements[k].placement
                                ) {
                                    throw new TypeError(
                                        'Duplicated element (' + elements[j].key + ')'
                                    );
                                }
                            }
                        }
                    }
                }

                return {
                    elements: elements,
                    finishers: finishers,
                };
            },
            fromElementDescriptor: function(element) {
                var obj = {
                    kind: element.kind,
                    key: element.key,
                    placement: element.placement,
                    descriptor: element.descriptor,
                };
                var desc = {
                    value: 'Descriptor',
                    configurable: true,
                };
                Object.defineProperty(obj, Symbol.toStringTag, desc);
                if (element.kind === 'field') obj.initializer = element.initializer;
                return obj;
            },
            toElementDescriptors: function(elementObjects) {
                if (elementObjects === undefined) return;
                return _toArray(elementObjects).map(function(elementObject) {
                    var element = this.toElementDescriptor(elementObject);
                    this.disallowProperty(elementObject, 'finisher', 'An element descriptor');
                    this.disallowProperty(elementObject, 'extras', 'An element descriptor');
                    return element;
                }, this);
            },
            toElementDescriptor: function(elementObject) {
                var kind = String(elementObject.kind);

                if (kind !== 'method' && kind !== 'field') {
                    throw new TypeError(
                        'An element descriptor\'s .kind property must be either "method" or' +
                            ' "field", but a decorator created an element descriptor with' +
                            ' .kind "' +
                            kind +
                            '"'
                    );
                }

                var key = _toPropertyKey(elementObject.key);

                var placement = String(elementObject.placement);

                if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {
                    throw new TypeError(
                        'An element descriptor\'s .placement property must be one of "static",' +
                            ' "prototype" or "own", but a decorator created an element descriptor' +
                            ' with .placement "' +
                            placement +
                            '"'
                    );
                }

                var descriptor = elementObject.descriptor;
                this.disallowProperty(elementObject, 'elements', 'An element descriptor');
                var element = {
                    kind: kind,
                    key: key,
                    placement: placement,
                    descriptor: Object.assign({}, descriptor),
                };

                if (kind !== 'field') {
                    this.disallowProperty(elementObject, 'initializer', 'A method descriptor');
                } else {
                    this.disallowProperty(
                        descriptor,
                        'get',
                        'The property descriptor of a field descriptor'
                    );
                    this.disallowProperty(
                        descriptor,
                        'set',
                        'The property descriptor of a field descriptor'
                    );
                    this.disallowProperty(
                        descriptor,
                        'value',
                        'The property descriptor of a field descriptor'
                    );
                    element.initializer = elementObject.initializer;
                }

                return element;
            },
            toElementFinisherExtras: function(elementObject) {
                var element = this.toElementDescriptor(elementObject);

                var finisher = _optionalCallableProperty(elementObject, 'finisher');

                var extras = this.toElementDescriptors(elementObject.extras);
                return {
                    element: element,
                    finisher: finisher,
                    extras: extras,
                };
            },
            fromClassDescriptor: function(elements) {
                var obj = {
                    kind: 'class',
                    elements: elements.map(this.fromElementDescriptor, this),
                };
                var desc = {
                    value: 'Descriptor',
                    configurable: true,
                };
                Object.defineProperty(obj, Symbol.toStringTag, desc);
                return obj;
            },
            toClassDescriptor: function(obj) {
                var kind = String(obj.kind);

                if (kind !== 'class') {
                    throw new TypeError(
                        'A class descriptor\'s .kind property must be "class", but a decorator' +
                            ' created a class descriptor with .kind "' +
                            kind +
                            '"'
                    );
                }

                this.disallowProperty(obj, 'key', 'A class descriptor');
                this.disallowProperty(obj, 'placement', 'A class descriptor');
                this.disallowProperty(obj, 'descriptor', 'A class descriptor');
                this.disallowProperty(obj, 'initializer', 'A class descriptor');
                this.disallowProperty(obj, 'extras', 'A class descriptor');

                var finisher = _optionalCallableProperty(obj, 'finisher');

                var elements = this.toElementDescriptors(obj.elements);
                return {
                    elements: elements,
                    finisher: finisher,
                };
            },
            runClassFinishers: function(constructor, finishers) {
                for (var i = 0; i < finishers.length; i++) {
                    var newConstructor = (0, finishers[i])(constructor);

                    if (newConstructor !== undefined) {
                        if (typeof newConstructor !== 'function') {
                            throw new TypeError('Finishers must return a constructor.');
                        }

                        constructor = newConstructor;
                    }
                }

                return constructor;
            },
            disallowProperty: function(obj, name, objectType) {
                if (obj[name] !== undefined) {
                    throw new TypeError(objectType + " can't have a ." + name + ' property.');
                }
            },
        };
        return api;
    }

    function _createElementDescriptor(def) {
        var key = _toPropertyKey(def.key);

        var descriptor;

        if (def.kind === 'method') {
            descriptor = {
                value: def.value,
                writable: true,
                configurable: true,
                enumerable: false,
            };
        } else if (def.kind === 'get') {
            descriptor = {
                get: def.value,
                configurable: true,
                enumerable: false,
            };
        } else if (def.kind === 'set') {
            descriptor = {
                set: def.value,
                configurable: true,
                enumerable: false,
            };
        } else if (def.kind === 'field') {
            descriptor = {
                configurable: true,
                writable: true,
                enumerable: true,
            };
        }

        var element = {
            kind: def.kind === 'field' ? 'field' : 'method',
            key: key,
            placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',
            descriptor: descriptor,
        };
        if (def.decorators) element.decorators = def.decorators;
        if (def.kind === 'field') element.initializer = def.value;
        return element;
    }

    function _coalesceGetterSetter(element, other) {
        if (element.descriptor.get !== undefined) {
            other.descriptor.get = element.descriptor.get;
        } else {
            other.descriptor.set = element.descriptor.set;
        }
    }

    function _coalesceClassElements(elements) {
        var newElements = [];

        var isSameElement = function(other) {
            return (
                other.kind === 'method' &&
                other.key === element.key &&
                other.placement === element.placement
            );
        };

        for (var i = 0; i < elements.length; i++) {
            var element = elements[i];
            var other;

            if (element.kind === 'method' && (other = newElements.find(isSameElement))) {
                if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {
                    if (_hasDecorators(element) || _hasDecorators(other)) {
                        throw new ReferenceError(
                            'Duplicated methods (' + element.key + ") can't be decorated."
                        );
                    }

                    other.descriptor = element.descriptor;
                } else {
                    if (_hasDecorators(element)) {
                        if (_hasDecorators(other)) {
                            throw new ReferenceError(
                                "Decorators can't be placed on different accessors with for " +
                                    'the same property (' +
                                    element.key +
                                    ').'
                            );
                        }

                        other.decorators = element.decorators;
                    }

                    _coalesceGetterSetter(element, other);
                }
            } else {
                newElements.push(element);
            }
        }

        return newElements;
    }

    function _hasDecorators(element) {
        return element.decorators && element.decorators.length;
    }

    function _isDataDescriptor(desc) {
        return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);
    }

    function _optionalCallableProperty(obj, name) {
        var value = obj[name];

        if (value !== undefined && typeof value !== 'function') {
            throw new TypeError("Expected '" + name + "' to be a function");
        }

        return value;
    }

    function _classPrivateMethodGet(receiver, privateSet, fn) {
        if (!privateSet.has(receiver)) {
            throw new TypeError('attempted to get private field on non-instance');
        }

        return fn;
    }

    function _classPrivateMethodSet() {
        throw new TypeError('attempted to reassign private method');
    }

    function _wrapRegExp(re, groups) {
        _wrapRegExp = function(re, groups) {
            return new BabelRegExp(re, groups);
        };

        var _RegExp = _wrapNativeSuper(RegExp);

        var _super = RegExp.prototype;

        var _groups = new WeakMap();

        function BabelRegExp(re, groups) {
            var _this = _RegExp.call(this, re);

            _groups.set(_this, groups);

            return _this;
        }

        _inherits(BabelRegExp, _RegExp);

        BabelRegExp.prototype.exec = function(str) {
            var result = _super.exec.call(this, str);

            if (result) result.groups = buildGroups(result, this);
            return result;
        };

        BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {
            if (typeof substitution === 'string') {
                var groups = _groups.get(this);

                return _super[Symbol.replace].call(
                    this,
                    str,
                    substitution.replace(/\$<([^>]+)>/g, function(_, name) {
                        return '$' + groups[name];
                    })
                );
            } else if (typeof substitution === 'function') {
                var _this = this;

                return _super[Symbol.replace].call(this, str, function() {
                    var args = [];
                    args.push.apply(args, arguments);

                    if (typeof args[args.length - 1] !== 'object') {
                        args.push(buildGroups(args, _this));
                    }

                    return substitution.apply(this, args);
                });
            } else {
                return _super[Symbol.replace].call(this, str, substitution);
            }
        };

        function buildGroups(result, re) {
            var g = _groups.get(re);

            return Object.keys(g).reduce(function(groups, name) {
                groups[name] = result[g[name]];
                return groups;
            }, Object.create(null));
        }

        return _wrapRegExp.apply(this, arguments);
    }

    var arrayRemove = function arrayRemove(arr, index) {
        return arr.splice(index, 1);
    };

    var run = function run(cb, sync) {
        if (sync) {
            cb();
        } else if (document.hidden) {
            Promise.resolve(1).then(cb);
        } else {
            setTimeout(cb, 0);
        }
    };

    var on = function on() {
        var listeners = [];
        var off = function off(event, cb) {
            arrayRemove(
                listeners,
                listeners.findIndex(function(listener) {
                    return listener.event === event && (listener.cb === cb || !cb);
                })
            );
        };
        var _fire = function fire(event, args, sync) {
            listeners
                .filter(function(listener) {
                    return listener.event === event;
                })
                .map(function(listener) {
                    return listener.cb;
                })
                .forEach(function(cb) {
                    return run(function() {
                        return cb.apply(void 0, _toConsumableArray(args));
                    }, sync);
                });
        };
        return {
            fireSync: function fireSync(event) {
                for (
                    var _len = arguments.length,
                        args = new Array(_len > 1 ? _len - 1 : 0),
                        _key = 1;
                    _key < _len;
                    _key++
                ) {
                    args[_key - 1] = arguments[_key];
                }
                _fire(event, args, true);
            },
            fire: function fire(event) {
                for (
                    var _len2 = arguments.length,
                        args = new Array(_len2 > 1 ? _len2 - 1 : 0),
                        _key2 = 1;
                    _key2 < _len2;
                    _key2++
                ) {
                    args[_key2 - 1] = arguments[_key2];
                }
                _fire(event, args, false);
            },
            on: function on(event, cb) {
                listeners.push({ event: event, cb: cb });
            },
            onOnce: function onOnce(event, _cb) {
                listeners.push({
                    event: event,
                    cb: function cb() {
                        off(event, _cb);
                        _cb.apply(void 0, arguments);
                    },
                });
            },
            off: off,
        };
    };

    var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(
        src,
        target,
        excluded
    ) {
        Object.getOwnPropertyNames(src)
            .filter(function(property) {
                return !excluded.includes(property);
            })
            .forEach(function(key) {
                return Object.defineProperty(
                    target,
                    key,
                    Object.getOwnPropertyDescriptor(src, key)
                );
            });
    };

    var PRIVATE = [
        'fire',
        'process',
        'revert',
        'load',
        'on',
        'off',
        'onOnce',
        'retryLoad',
        'extend',
        'archive',
        'archived',
        'release',
        'released',
        'requestProcessing',
        'freeze',
    ];

    var createItemAPI = function createItemAPI(item) {
        var api = {};
        copyObjectPropertiesToObject(item, api, PRIVATE);
        return api;
    };

    var removeReleasedItems = function removeReleasedItems(items) {
        items.forEach(function(item, index) {
            if (item.released) {
                arrayRemove(items, index);
            }
        });
    };

    var ItemStatus = {
        INIT: 1,
        IDLE: 2,
        PROCESSING_QUEUED: 9,
        PROCESSING: 3,
        PROCESSING_COMPLETE: 5,
        PROCESSING_ERROR: 6,
        PROCESSING_REVERT_ERROR: 10,
        LOADING: 7,
        LOAD_ERROR: 8,
    };

    var FileOrigin = {
        INPUT: 1,
        LIMBO: 2,
        LOCAL: 3,
    };

    var getNonNumeric = function getNonNumeric(str) {
        return /[^0-9]+/.exec(str);
    };

    var getDecimalSeparator = function getDecimalSeparator() {
        return getNonNumeric((1.1).toLocaleString())[0];
    };

    var getThousandsSeparator = function getThousandsSeparator() {
        // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)
        // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot
        var decimalSeparator = getDecimalSeparator();
        var thousandsStringWithSeparator = (1000.0).toLocaleString();
        var thousandsStringWithoutSeparator = (1000.0).toString();
        if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {
            return getNonNumeric(thousandsStringWithSeparator)[0];
        }
        return decimalSeparator === '.' ? ',' : '.';
    };

    var Type = {
        BOOLEAN: 'boolean',
        INT: 'int',
        NUMBER: 'number',
        STRING: 'string',
        ARRAY: 'array',
        OBJECT: 'object',
        FUNCTION: 'function',
        ACTION: 'action',
        SERVER_API: 'serverapi',
        REGEX: 'regex',
    };

    // all registered filters
    var filters = [];

    // loops over matching filters and passes options to each filter, returning the mapped results
    var applyFilterChain = function applyFilterChain(key, value, utils) {
        return new Promise(function(resolve, reject) {
            // find matching filters for this key
            var matchingFilters = filters
                .filter(function(f) {
                    return f.key === key;
                })
                .map(function(f) {
                    return f.cb;
                });

            // resolve now
            if (matchingFilters.length === 0) {
                resolve(value);
                return;
            }

            // first filter to kick things of
            var initialFilter = matchingFilters.shift();

            // chain filters
            matchingFilters
                .reduce(
                    // loop over promises passing value to next promise
                    function(current, next) {
                        return current.then(function(value) {
                            return next(value, utils);
                        });
                    },

                    // call initial filter, will return a promise
                    initialFilter(value, utils)

                    // all executed
                )
                .then(function(value) {
                    return resolve(value);
                })
                .catch(function(error) {
                    return reject(error);
                });
        });
    };

    var applyFilters = function applyFilters(key, value, utils) {
        return filters
            .filter(function(f) {
                return f.key === key;
            })
            .map(function(f) {
                return f.cb(value, utils);
            });
    };

    // adds a new filter to the list
    var addFilter = function addFilter(key, cb) {
        return filters.push({ key: key, cb: cb });
    };

    var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {
        return Object.assign(defaultOptions, additionalOptions);
    };

    var getOptions = function getOptions() {
        return Object.assign({}, defaultOptions);
    };

    var setOptions = function setOptions(opts) {
        forin(opts, function(key, value) {
            // key does not exist, so this option cannot be set
            if (!defaultOptions[key]) {
                return;
            }
            defaultOptions[key][0] = getValueByType(
                value,
                defaultOptions[key][0],
                defaultOptions[key][1]
            );
        });
    };

    // default options on app
    var defaultOptions = {
        // the id to add to the root element
        id: [null, Type.STRING],

        // input field name to use
        name: ['filepond', Type.STRING],

        // disable the field
        disabled: [false, Type.BOOLEAN],

        // classname to put on wrapper
        className: [null, Type.STRING],

        // is the field required
        required: [false, Type.BOOLEAN],

        // Allow media capture when value is set
        captureMethod: [null, Type.STRING],
        // - "camera", "microphone" or "camcorder",
        // - Does not work with multiple on apple devices
        // - If set, acceptedFileTypes must be made to match with media wildcard "image/*", "audio/*" or "video/*"

        // sync `acceptedFileTypes` property with `accept` attribute
        allowSyncAcceptAttribute: [true, Type.BOOLEAN],

        // Feature toggles
        allowDrop: [true, Type.BOOLEAN], // Allow dropping of files
        allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system
        allowPaste: [true, Type.BOOLEAN], // Allow pasting files
        allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)
        allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)
        allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload
        allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file
        allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button
        allowReorder: [false, Type.BOOLEAN], // Allow reordering of files
        allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)

        // Try store file if `server` not set
        storeAsFile: [false, Type.BOOLEAN],

        // Revert mode
        forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal

        // Input requirements
        maxFiles: [null, Type.INT], // Max number of files
        checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages

        // Where to put file
        itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list
        itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list
        itemInsertInterval: [75, Type.INT],

        // Drag 'n Drop related
        dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)
        dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)
        dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop
        ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],

        // Upload related
        instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop
        maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel
        allowMinimumUploadDuration: [true, Type.BOOLEAN], // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened

        // Chunks
        chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads
        chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size
        chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)
        chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY], // Amount of times to retry upload of a chunk when it fails

        // The server api end points to use for uploading (see docs)
        server: [null, Type.SERVER_API],

        // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000
        fileSizeBase: [1000, Type.INT],

        // Labels and status messages
        labelFileSizeBytes: ['bytes', Type.STRING],
        labelFileSizeKilobytes: ['KB', Type.STRING],
        labelFileSizeMegabytes: ['MB', Type.STRING],
        labelFileSizeGigabytes: ['GB', Type.STRING],

        labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator
        labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator

        labelIdle: [
            'Drag & Drop your files or <span class="filepond--label-action">Browse</span>',
            Type.STRING,
        ],

        labelInvalidField: ['Field contains invalid files', Type.STRING],
        labelFileWaitingForSize: ['Waiting for size', Type.STRING],
        labelFileSizeNotAvailable: ['Size not available', Type.STRING],
        labelFileCountSingular: ['file in list', Type.STRING],
        labelFileCountPlural: ['files in list', Type.STRING],
        labelFileLoading: ['Loading', Type.STRING],
        labelFileAdded: ['Added', Type.STRING], // assistive only
        labelFileLoadError: ['Error during load', Type.STRING],
        labelFileRemoved: ['Removed', Type.STRING], // assistive only
        labelFileRemoveError: ['Error during remove', Type.STRING],
        labelFileProcessing: ['Uploading', Type.STRING],
        labelFileProcessingComplete: ['Upload complete', Type.STRING],
        labelFileProcessingAborted: ['Upload cancelled', Type.STRING],
        labelFileProcessingError: ['Error during upload', Type.STRING],
        labelFileProcessingRevertError: ['Error during revert', Type.STRING],

        labelTapToCancel: ['tap to cancel', Type.STRING],
        labelTapToRetry: ['tap to retry', Type.STRING],
        labelTapToUndo: ['tap to undo', Type.STRING],

        labelButtonRemoveItem: ['Remove', Type.STRING],
        labelButtonAbortItemLoad: ['Abort', Type.STRING],
        labelButtonRetryItemLoad: ['Retry', Type.STRING],
        labelButtonAbortItemProcessing: ['Cancel', Type.STRING],
        labelButtonUndoItemProcessing: ['Undo', Type.STRING],
        labelButtonRetryItemProcessing: ['Retry', Type.STRING],
        labelButtonProcessItem: ['Upload', Type.STRING],

        // make sure width and height plus viewpox are even numbers so icons are nicely centered
        iconRemove: [
            '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',
            Type.STRING,
        ],

        iconProcess: [
            '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',
            Type.STRING,
        ],

        iconRetry: [
            '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',
            Type.STRING,
        ],

        iconUndo: [
            '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',
            Type.STRING,
        ],

        iconDone: [
            '<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',
            Type.STRING,
        ],

        // event handlers
        oninit: [null, Type.FUNCTION],
        onwarning: [null, Type.FUNCTION],
        onerror: [null, Type.FUNCTION],
        onactivatefile: [null, Type.FUNCTION],
        oninitfile: [null, Type.FUNCTION],
        onaddfilestart: [null, Type.FUNCTION],
        onaddfileprogress: [null, Type.FUNCTION],
        onaddfile: [null, Type.FUNCTION],
        onprocessfilestart: [null, Type.FUNCTION],
        onprocessfileprogress: [null, Type.FUNCTION],
        onprocessfileabort: [null, Type.FUNCTION],
        onprocessfilerevert: [null, Type.FUNCTION],
        onprocessfile: [null, Type.FUNCTION],
        onprocessfiles: [null, Type.FUNCTION],
        onremovefile: [null, Type.FUNCTION],
        onpreparefile: [null, Type.FUNCTION],
        onupdatefiles: [null, Type.FUNCTION],
        onreorderfiles: [null, Type.FUNCTION],

        // hooks
        beforeDropFile: [null, Type.FUNCTION],
        beforeAddFile: [null, Type.FUNCTION],
        beforeRemoveFile: [null, Type.FUNCTION],
        beforePrepareFile: [null, Type.FUNCTION],

        // styles
        stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'
        stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1
        styleItemPanelAspectRatio: [null, Type.STRING],
        styleButtonRemoveItemPosition: ['left', Type.STRING],
        styleButtonProcessItemPosition: ['right', Type.STRING],
        styleLoadIndicatorPosition: ['right', Type.STRING],
        styleProgressIndicatorPosition: ['right', Type.STRING],
        styleButtonRemoveItemAlign: [false, Type.BOOLEAN],

        // custom initial files array
        files: [[], Type.ARRAY],

        // show support by displaying credits
        credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY],
    };

    var getItemByQuery = function getItemByQuery(items, query) {
        // just return first index
        if (isEmpty(query)) {
            return items[0] || null;
        }

        // query is index
        if (isInt(query)) {
            return items[query] || null;
        }

        // if query is item, get the id
        if (typeof query === 'object') {
            query = query.id;
        }

        // assume query is a string and return item by id
        return (
            items.find(function(item) {
                return item.id === query;
            }) || null
        );
    };

    var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {
        if (isEmpty(aspectRatio)) {
            return aspectRatio;
        }
        if (/:/.test(aspectRatio)) {
            var parts = aspectRatio.split(':');
            return parts[1] / parts[0];
        }
        return parseFloat(aspectRatio);
    };

    var getActiveItems = function getActiveItems(items) {
        return items.filter(function(item) {
            return !item.archived;
        });
    };

    var Status = {
        EMPTY: 0,
        IDLE: 1, // waiting
        ERROR: 2, // a file is in error state
        BUSY: 3, // busy processing or loading
        READY: 4, // all files uploaded
    };

    var res = null;
    var canUpdateFileInput = function canUpdateFileInput() {
        if (res === null) {
            try {
                var dataTransfer = new DataTransfer();
                dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));
                var el = document.createElement('input');
                el.setAttribute('type', 'file');
                el.files = dataTransfer.files;
                res = el.files.length === 1;
            } catch (err) {
                res = false;
            }
        }
        return res;
    };

    var ITEM_ERROR = [
        ItemStatus.LOAD_ERROR,
        ItemStatus.PROCESSING_ERROR,
        ItemStatus.PROCESSING_REVERT_ERROR,
    ];

    var ITEM_BUSY = [
        ItemStatus.LOADING,
        ItemStatus.PROCESSING,
        ItemStatus.PROCESSING_QUEUED,
        ItemStatus.INIT,
    ];

    var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];

    var isItemInErrorState = function isItemInErrorState(item) {
        return ITEM_ERROR.includes(item.status);
    };
    var isItemInBusyState = function isItemInBusyState(item) {
        return ITEM_BUSY.includes(item.status);
    };
    var isItemInReadyState = function isItemInReadyState(item) {
        return ITEM_READY.includes(item.status);
    };

    var isAsync = function isAsync(state) {
        return (
            isObject(state.options.server) &&
            (isObject(state.options.server.process) || isFunction(state.options.server.process))
        );
    };

    var queries = function queries(state) {
        return {
            GET_STATUS: function GET_STATUS() {
                var items = getActiveItems(state.items);
                var EMPTY = Status.EMPTY,
                    ERROR = Status.ERROR,
                    BUSY = Status.BUSY,
                    IDLE = Status.IDLE,
                    READY = Status.READY;

                if (items.length === 0) return EMPTY;

                if (items.some(isItemInErrorState)) return ERROR;

                if (items.some(isItemInBusyState)) return BUSY;

                if (items.some(isItemInReadyState)) return READY;

                return IDLE;
            },

            GET_ITEM: function GET_ITEM(query) {
                return getItemByQuery(state.items, query);
            },

            GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {
                return getItemByQuery(getActiveItems(state.items), query);
            },

            GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {
                return getActiveItems(state.items);
            },

            GET_ITEMS: function GET_ITEMS() {
                return state.items;
            },

            GET_ITEM_NAME: function GET_ITEM_NAME(query) {
                var item = getItemByQuery(state.items, query);
                return item ? item.filename : null;
            },

            GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {
                var item = getItemByQuery(state.items, query);
                return item ? item.fileSize : null;
            },

            GET_STYLES: function GET_STYLES() {
                return Object.keys(state.options)
                    .filter(function(key) {
                        return /^style/.test(key);
                    })
                    .map(function(option) {
                        return {
                            name: option,
                            value: state.options[option],
                        };
                    });
            },

            GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {
                var isShapeCircle = /circle/.test(state.options.stylePanelLayout);
                var aspectRatio = isShapeCircle
                    ? 1
                    : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);
                return aspectRatio;
            },

            GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {
                return state.options.styleItemPanelAspectRatio;
            },

            GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {
                return getActiveItems(state.items).filter(function(item) {
                    return item.status === status;
                });
            },

            GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {
                return getActiveItems(state.items).length;
            },

            SHOULD_UPDATE_FILE_INPUT: function SHOULD_UPDATE_FILE_INPUT() {
                return state.options.storeAsFile && canUpdateFileInput() && !isAsync(state);
            },

            IS_ASYNC: function IS_ASYNC() {
                return isAsync(state);
            },

            GET_FILE_SIZE_LABELS: function GET_FILE_SIZE_LABELS(query) {
                return {
                    labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,
                    labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,
                    labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,
                    labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined,
                };
            },
        };
    };

    var hasRoomForItem = function hasRoomForItem(state) {
        var count = getActiveItems(state.items).length;

        // if cannot have multiple items, to add one item it should currently not contain items
        if (!state.options.allowMultiple) {
            return count === 0;
        }

        // if allows multiple items, we check if a max item count has been set, if not, there's no limit
        var maxFileCount = state.options.maxFiles;
        if (maxFileCount === null) {
            return true;
        }

        // we check if the current count is smaller than the max count, if so, another file can still be added
        if (count < maxFileCount) {
            return true;
        }

        // no more room for another file
        return false;
    };

    var limit = function limit(value, min, max) {
        return Math.max(Math.min(max, value), min);
    };

    var arrayInsert = function arrayInsert(arr, index, item) {
        return arr.splice(index, 0, item);
    };

    var insertItem = function insertItem(items, item, index) {
        if (isEmpty(item)) {
            return null;
        }

        // if index is undefined, append
        if (typeof index === 'undefined') {
            items.push(item);
            return item;
        }

        // limit the index to the size of the items array
        index = limit(index, 0, items.length);

        // add item to array
        arrayInsert(items, index, item);

        // expose
        return item;
    };

    var isBase64DataURI = function isBase64DataURI(str) {
        return /^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(
            str
        );
    };

    var getFilenameFromURL = function getFilenameFromURL(url) {
        return url
            .split('/')
            .pop()
            .split('?')
            .shift();
    };

    var getExtensionFromFilename = function getExtensionFromFilename(name) {
        return name.split('.').pop();
    };

    var guesstimateExtension = function guesstimateExtension(type) {
        // if no extension supplied, exit here
        if (typeof type !== 'string') {
            return '';
        }

        // get subtype
        var subtype = type.split('/').pop();

        // is svg subtype
        if (/svg/.test(subtype)) {
            return 'svg';
        }

        if (/zip|compressed/.test(subtype)) {
            return 'zip';
        }

        if (/plain/.test(subtype)) {
            return 'txt';
        }

        if (/msword/.test(subtype)) {
            return 'doc';
        }

        // if is valid subtype
        if (/[a-z]+/.test(subtype)) {
            // always use jpg extension
            if (subtype === 'jpeg') {
                return 'jpg';
            }

            // return subtype
            return subtype;
        }

        return '';
    };

    var leftPad = function leftPad(value) {
        var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
        return (padding + value).slice(-padding.length);
    };

    var getDateString = function getDateString() {
        var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();
        return (
            date.getFullYear() +
            '-' +
            leftPad(date.getMonth() + 1, '00') +
            '-' +
            leftPad(date.getDate(), '00') +
            '_' +
            leftPad(date.getHours(), '00') +
            '-' +
            leftPad(date.getMinutes(), '00') +
            '-' +
            leftPad(date.getSeconds(), '00')
        );
    };

    var getFileFromBlob = function getFileFromBlob(blob, filename) {
        var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
        var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
        var file =
            typeof type === 'string'
                ? blob.slice(0, blob.size, type)
                : blob.slice(0, blob.size, blob.type);
        file.lastModifiedDate = new Date();

        // copy relative path
        if (blob._relativePath) file._relativePath = blob._relativePath;

        // if blob has name property, use as filename if no filename supplied
        if (!isString(filename)) {
            filename = getDateString();
        }

        // if filename supplied but no extension and filename has extension
        if (filename && extension === null && getExtensionFromFilename(filename)) {
            file.name = filename;
        } else {
            extension = extension || guesstimateExtension(file.type);
            file.name = filename + (extension ? '.' + extension : '');
        }

        return file;
    };

    var getBlobBuilder = function getBlobBuilder() {
        return (window.BlobBuilder =
            window.BlobBuilder ||
            window.WebKitBlobBuilder ||
            window.MozBlobBuilder ||
            window.MSBlobBuilder);
    };

    var createBlob = function createBlob(arrayBuffer, mimeType) {
        var BB = getBlobBuilder();

        if (BB) {
            var bb = new BB();
            bb.append(arrayBuffer);
            return bb.getBlob(mimeType);
        }

        return new Blob([arrayBuffer], {
            type: mimeType,
        });
    };

    var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(
        byteString,
        mimeType
    ) {
        var ab = new ArrayBuffer(byteString.length);
        var ia = new Uint8Array(ab);

        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }

        return createBlob(ab, mimeType);
    };

    var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {
        return (/^data:(.+);/.exec(dataURI) || [])[1] || null;
    };

    var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {
        // get data part of string (remove data:image/jpeg...,)
        var data = dataURI.split(',')[1];

        // remove any whitespace as that causes InvalidCharacterError in IE
        return data.replace(/\s/g, '');
    };

    var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {
        return atob(getBase64DataFromBase64DataURI(dataURI));
    };

    var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {
        var mimeType = getMimeTypeFromBase64DataURI(dataURI);
        var byteString = getByteStringFromBase64DataURI(dataURI);

        return getBlobFromByteStringWithMimeType(byteString, mimeType);
    };

    var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {
        return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);
    };

    var getFileNameFromHeader = function getFileNameFromHeader(header) {
        // test if is content disposition header, if not exit
        if (!/^content-disposition:/i.test(header)) return null;

        // get filename parts
        var matches = header
            .split(/filename=|filename\*=.+''/)
            .splice(1)
            .map(function(name) {
                return name.trim().replace(/^["']|[;"']{0,2}$/g, '');
            })
            .filter(function(name) {
                return name.length;
            });

        return matches.length ? decodeURI(matches[matches.length - 1]) : null;
    };

    var getFileSizeFromHeader = function getFileSizeFromHeader(header) {
        if (/content-length:/i.test(header)) {
            var size = header.match(/[0-9]+/)[0];
            return size ? parseInt(size, 10) : null;
        }
        return null;
    };

    var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {
        if (/x-content-transfer-id:/i.test(header)) {
            var id = (header.split(':')[1] || '').trim();
            return id || null;
        }
        return null;
    };

    var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {
        var info = {
            source: null,
            name: null,
            size: null,
        };

        var rows = headers.split('\n');
        var _iteratorNormalCompletion = true;
        var _didIteratorError = false;
        var _iteratorError = undefined;
        try {
            for (
                var _iterator = rows[Symbol.iterator](), _step;
                !(_iteratorNormalCompletion = (_step = _iterator.next()).done);
                _iteratorNormalCompletion = true
            ) {
                var header = _step.value;

                var name = getFileNameFromHeader(header);
                if (name) {
                    info.name = name;
                    continue;
                }

                var size = getFileSizeFromHeader(header);
                if (size) {
                    info.size = size;
                    continue;
                }

                var source = getTranfserIdFromHeader(header);
                if (source) {
                    info.source = source;
                    continue;
                }
            }
        } catch (err) {
            _didIteratorError = true;
            _iteratorError = err;
        } finally {
            try {
                if (!_iteratorNormalCompletion && _iterator.return != null) {
                    _iterator.return();
                }
            } finally {
                if (_didIteratorError) {
                    throw _iteratorError;
                }
            }
        }

        return info;
    };

    var createFileLoader = function createFileLoader(fetchFn) {
        var state = {
            source: null,
            complete: false,
            progress: 0,
            size: null,
            timestamp: null,
            duration: 0,
            request: null,
        };

        var getProgress = function getProgress() {
            return state.progress;
        };
        var abort = function abort() {
            if (state.request && state.request.abort) {
                state.request.abort();
            }
        };

        // load source
        var load = function load() {
            // get quick reference
            var source = state.source;

            api.fire('init', source);

            // Load Files
            if (source instanceof File) {
                api.fire('load', source);
            } else if (source instanceof Blob) {
                // Load blobs, set default name to current date
                api.fire('load', getFileFromBlob(source, source.name));
            } else if (isBase64DataURI(source)) {
                // Load base 64, set default name to current date
                api.fire('load', getFileFromBase64DataURI(source));
            } else {
                // Deal as if is external URL, let's load it!
                loadURL(source);
            }
        };

        // loads a url
        var loadURL = function loadURL(url) {
            // is remote url and no fetch method supplied
            if (!fetchFn) {
                api.fire('error', {
                    type: 'error',
                    body: "Can't load URL",
                    code: 400,
                });

                return;
            }

            // set request start
            state.timestamp = Date.now();

            // load file
            state.request = fetchFn(
                url,
                function(response) {
                    // update duration
                    state.duration = Date.now() - state.timestamp;

                    // done!
                    state.complete = true;

                    // turn blob response into a file
                    if (response instanceof Blob) {
                        response = getFileFromBlob(
                            response,
                            response.name || getFilenameFromURL(url)
                        );
                    }

                    api.fire(
                        'load',
                        // if has received blob, we go with blob, if no response, we return null
                        response instanceof Blob ? response : response ? response.body : null
                    );
                },
                function(error) {
                    api.fire(
                        'error',
                        typeof error === 'string'
                            ? {
                                  type: 'error',
                                  code: 0,
                                  body: error,
                              }
                            : error
                    );
                },
                function(computable, current, total) {
                    // collected some meta data already
                    if (total) {
                        state.size = total;
                    }

                    // update duration
                    state.duration = Date.now() - state.timestamp;

                    // if we can't compute progress, we're not going to fire progress events
                    if (!computable) {
                        state.progress = null;
                        return;
                    }

                    // update progress percentage
                    state.progress = current / total;

                    // expose
                    api.fire('progress', state.progress);
                },
                function() {
                    api.fire('abort');
                },
                function(response) {
                    var fileinfo = getFileInfoFromHeaders(
                        typeof response === 'string' ? response : response.headers
                    );
                    api.fire('meta', {
                        size: state.size || fileinfo.size,
                        filename: fileinfo.name,
                        source: fileinfo.source,
                    });
                }
            );
        };

        var api = Object.assign({}, on(), {
            setSource: function setSource(source) {
                return (state.source = source);
            },
            getProgress: getProgress, // file load progress
            abort: abort, // abort file load
            load: load, // start load
        });

        return api;
    };

    var isGet = function isGet(method) {
        return /GET|HEAD/.test(method);
    };

    var sendRequest = function sendRequest(data, url, options) {
        var api = {
            onheaders: function onheaders() {},
            onprogress: function onprogress() {},
            onload: function onload() {},
            ontimeout: function ontimeout() {},
            onerror: function onerror() {},
            onabort: function onabort() {},
            abort: function abort() {
                aborted = true;
                xhr.abort();
            },
        };

        // timeout identifier, only used when timeout is defined
        var aborted = false;
        var headersReceived = false;

        // set default options
        options = Object.assign(
            {
                method: 'POST',
                headers: {},
                withCredentials: false,
            },
            options
        );

        // encode url
        url = encodeURI(url);

        // if method is GET, add any received data to url

        if (isGet(options.method) && data) {
            url =
                '' +
                url +
                encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));
        }

        // create request
        var xhr = new XMLHttpRequest();

        // progress of load
        var process = isGet(options.method) ? xhr : xhr.upload;
        process.onprogress = function(e) {
            // no progress event when aborted ( onprogress is called once after abort() )
            if (aborted) {
                return;
            }

            api.onprogress(e.lengthComputable, e.loaded, e.total);
        };

        // tries to get header info to the app as fast as possible
        xhr.onreadystatechange = function() {
            // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)
            if (xhr.readyState < 2) {
                return;
            }

            // no server response
            if (xhr.readyState === 4 && xhr.status === 0) {
                return;
            }

            if (headersReceived) {
                return;
            }

            headersReceived = true;

            // we've probably received some useful data in response headers
            api.onheaders(xhr);
        };

        // load successful
        xhr.onload = function() {
            // is classified as valid response
            if (xhr.status >= 200 && xhr.status < 300) {
                api.onload(xhr);
            } else {
                api.onerror(xhr);
            }
        };

        // error during load
        xhr.onerror = function() {
            return api.onerror(xhr);
        };

        // request aborted
        xhr.onabort = function() {
            aborted = true;
            api.onabort();
        };

        // request timeout
        xhr.ontimeout = function() {
            return api.ontimeout(xhr);
        };

        // open up open up!
        xhr.open(options.method, url, true);

        // set timeout if defined (do it after open so IE11 plays ball)
        if (isInt(options.timeout)) {
            xhr.timeout = options.timeout;
        }

        // add headers
        Object.keys(options.headers).forEach(function(key) {
            var value = unescape(encodeURIComponent(options.headers[key]));
            xhr.setRequestHeader(key, value);
        });

        // set type of response
        if (options.responseType) {
            xhr.responseType = options.responseType;
        }

        // set credentials
        if (options.withCredentials) {
            xhr.withCredentials = true;
        }

        // let's send our data
        xhr.send(data);

        return api;
    };

    var createResponse = function createResponse(type, code, body, headers) {
        return {
            type: type,
            code: code,
            body: body,
            headers: headers,
        };
    };

    var createTimeoutResponse = function createTimeoutResponse(cb) {
        return function(xhr) {
            cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));
        };
    };

    var hasQS = function hasQS(str) {
        return /\?/.test(str);
    };
    var buildURL = function buildURL() {
        var url = '';
        for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {
            parts[_key] = arguments[_key];
        }
        parts.forEach(function(part) {
            url += hasQS(url) && hasQS(part) ? part.replace(/\?/, '&') : part;
        });
        return url;
    };

    var createFetchFunction = function createFetchFunction() {
        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        var action = arguments.length > 1 ? arguments[1] : undefined;
        // custom handler (should also handle file, load, error, progress and abort)
        if (typeof action === 'function') {
            return action;
        }

        // no action supplied
        if (!action || !isString(action.url)) {
            return null;
        }

        // set onload hanlder
        var onload =
            action.onload ||
            function(res) {
                return res;
            };
        var onerror =
            action.onerror ||
            function(res) {
                return null;
            };

        // internal handler
        return function(url, load, error, progress, abort, headers) {
            // do local or remote request based on if the url is external
            var request = sendRequest(
                url,
                buildURL(apiUrl, action.url),
                Object.assign({}, action, {
                    responseType: 'blob',
                })
            );

            request.onload = function(xhr) {
                // get headers
                var headers = xhr.getAllResponseHeaders();

                // get filename
                var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);

                // create response
                load(
                    createResponse(
                        'load',
                        xhr.status,
                        action.method === 'HEAD'
                            ? null
                            : getFileFromBlob(onload(xhr.response), filename),
                        headers
                    )
                );
            };

            request.onerror = function(xhr) {
                error(
                    createResponse(
                        'error',
                        xhr.status,
                        onerror(xhr.response) || xhr.statusText,
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.onheaders = function(xhr) {
                headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));
            };

            request.ontimeout = createTimeoutResponse(error);
            request.onprogress = progress;
            request.onabort = abort;

            // should return request
            return request;
        };
    };

    var ChunkStatus = {
        QUEUED: 0,
        COMPLETE: 1,
        PROCESSING: 2,
        ERROR: 3,
        WAITING: 4,
    };

    /*
                                                       function signature:
                                                         (file, metadata, load, error, progress, abort, transfer, options) => {
                                                           return {
                                                           abort:() => {}
                                                         }
                                                       }
                                                       */

    // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options
    var processFileChunked = function processFileChunked(
        apiUrl,
        action,
        name,
        file,
        metadata,
        load,
        error,
        progress,
        abort,
        transfer,
        options
    ) {
        // all chunks
        var chunks = [];
        var chunkTransferId = options.chunkTransferId,
            chunkServer = options.chunkServer,
            chunkSize = options.chunkSize,
            chunkRetryDelays = options.chunkRetryDelays;

        // default state
        var state = {
            serverId: chunkTransferId,
            aborted: false,
        };

        // set onload handlers
        var ondata =
            action.ondata ||
            function(fd) {
                return fd;
            };
        var onload =
            action.onload ||
            function(xhr, method) {
                return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;
            };
        var onerror =
            action.onerror ||
            function(res) {
                return null;
            };

        // create server hook
        var requestTransferId = function requestTransferId(cb) {
            var formData = new FormData();

            // add metadata under same name
            if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));

            var headers =
                typeof action.headers === 'function'
                    ? action.headers(file, metadata)
                    : Object.assign({}, action.headers, {
                          'Upload-Length': file.size,
                      });

            var requestParams = Object.assign({}, action, {
                headers: headers,
            });

            // send request object
            var request = sendRequest(
                ondata(formData),
                buildURL(apiUrl, action.url),
                requestParams
            );

            request.onload = function(xhr) {
                return cb(onload(xhr, requestParams.method));
            };

            request.onerror = function(xhr) {
                return error(
                    createResponse(
                        'error',
                        xhr.status,
                        onerror(xhr.response) || xhr.statusText,
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.ontimeout = createTimeoutResponse(error);
        };

        var requestTransferOffset = function requestTransferOffset(cb) {
            var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);

            var headers =
                typeof action.headers === 'function'
                    ? action.headers(state.serverId)
                    : Object.assign({}, action.headers);

            var requestParams = {
                headers: headers,
                method: 'HEAD',
            };

            var request = sendRequest(null, requestUrl, requestParams);

            request.onload = function(xhr) {
                return cb(onload(xhr, requestParams.method));
            };

            request.onerror = function(xhr) {
                return error(
                    createResponse(
                        'error',
                        xhr.status,
                        onerror(xhr.response) || xhr.statusText,
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.ontimeout = createTimeoutResponse(error);
        };

        // create chunks
        var lastChunkIndex = Math.floor(file.size / chunkSize);
        for (var i = 0; i <= lastChunkIndex; i++) {
            var offset = i * chunkSize;
            var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');
            chunks[i] = {
                index: i,
                size: data.size,
                offset: offset,
                data: data,
                file: file,
                progress: 0,
                retries: _toConsumableArray(chunkRetryDelays),
                status: ChunkStatus.QUEUED,
                error: null,
                request: null,
                timeout: null,
            };
        }

        var completeProcessingChunks = function completeProcessingChunks() {
            return load(state.serverId);
        };

        var canProcessChunk = function canProcessChunk(chunk) {
            return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;
        };

        var processChunk = function processChunk(chunk) {
            // processing is paused, wait here
            if (state.aborted) return;

            // get next chunk to process
            chunk = chunk || chunks.find(canProcessChunk);

            // no more chunks to process
            if (!chunk) {
                // all done?
                if (
                    chunks.every(function(chunk) {
                        return chunk.status === ChunkStatus.COMPLETE;
                    })
                ) {
                    completeProcessingChunks();
                }

                // no chunk to handle
                return;
            }

            // now processing this chunk
            chunk.status = ChunkStatus.PROCESSING;
            chunk.progress = null;

            // allow parsing of formdata
            var ondata =
                chunkServer.ondata ||
                function(fd) {
                    return fd;
                };
            var onerror =
                chunkServer.onerror ||
                function(res) {
                    return null;
                };

            // send request object
            var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);

            var headers =
                typeof chunkServer.headers === 'function'
                    ? chunkServer.headers(chunk)
                    : Object.assign({}, chunkServer.headers, {
                          'Content-Type': 'application/offset+octet-stream',
                          'Upload-Offset': chunk.offset,
                          'Upload-Length': file.size,
                          'Upload-Name': file.name,
                      });

            var request = (chunk.request = sendRequest(
                ondata(chunk.data),
                requestUrl,
                Object.assign({}, chunkServer, {
                    headers: headers,
                })
            ));

            request.onload = function() {
                // done!
                chunk.status = ChunkStatus.COMPLETE;

                // remove request reference
                chunk.request = null;

                // start processing more chunks
                processChunks();
            };

            request.onprogress = function(lengthComputable, loaded, total) {
                chunk.progress = lengthComputable ? loaded : null;
                updateTotalProgress();
            };

            request.onerror = function(xhr) {
                chunk.status = ChunkStatus.ERROR;
                chunk.request = null;
                chunk.error = onerror(xhr.response) || xhr.statusText;
                if (!retryProcessChunk(chunk)) {
                    error(
                        createResponse(
                            'error',
                            xhr.status,
                            onerror(xhr.response) || xhr.statusText,
                            xhr.getAllResponseHeaders()
                        )
                    );
                }
            };

            request.ontimeout = function(xhr) {
                chunk.status = ChunkStatus.ERROR;
                chunk.request = null;
                if (!retryProcessChunk(chunk)) {
                    createTimeoutResponse(error)(xhr);
                }
            };

            request.onabort = function() {
                chunk.status = ChunkStatus.QUEUED;
                chunk.request = null;
                abort();
            };
        };

        var retryProcessChunk = function retryProcessChunk(chunk) {
            // no more retries left
            if (chunk.retries.length === 0) return false;

            // new retry
            chunk.status = ChunkStatus.WAITING;
            clearTimeout(chunk.timeout);
            chunk.timeout = setTimeout(function() {
                processChunk(chunk);
            }, chunk.retries.shift());

            // we're going to retry
            return true;
        };

        var updateTotalProgress = function updateTotalProgress() {
            // calculate total progress fraction
            var totalBytesTransfered = chunks.reduce(function(p, chunk) {
                if (p === null || chunk.progress === null) return null;
                return p + chunk.progress;
            }, 0);

            // can't compute progress
            if (totalBytesTransfered === null) return progress(false, 0, 0);

            // calculate progress values
            var totalSize = chunks.reduce(function(total, chunk) {
                return total + chunk.size;
            }, 0);

            // can update progress indicator
            progress(true, totalBytesTransfered, totalSize);
        };

        // process new chunks
        var processChunks = function processChunks() {
            var totalProcessing = chunks.filter(function(chunk) {
                return chunk.status === ChunkStatus.PROCESSING;
            }).length;
            if (totalProcessing >= 1) return;
            processChunk();
        };

        var abortChunks = function abortChunks() {
            chunks.forEach(function(chunk) {
                clearTimeout(chunk.timeout);
                if (chunk.request) {
                    chunk.request.abort();
                }
            });
        };

        // let's go!
        if (!state.serverId) {
            requestTransferId(function(serverId) {
                // stop here if aborted, might have happened in between request and callback
                if (state.aborted) return;

                // pass back to item so we can use it if something goes wrong
                transfer(serverId);

                // store internally
                state.serverId = serverId;
                processChunks();
            });
        } else {
            requestTransferOffset(function(offset) {
                // stop here if aborted, might have happened in between request and callback
                if (state.aborted) return;

                // mark chunks with lower offset as complete
                chunks
                    .filter(function(chunk) {
                        return chunk.offset < offset;
                    })
                    .forEach(function(chunk) {
                        chunk.status = ChunkStatus.COMPLETE;
                        chunk.progress = chunk.size;
                    });

                // continue processing
                processChunks();
            });
        }

        return {
            abort: function abort() {
                state.aborted = true;
                abortChunks();
            },
        };
    };

    /*
                                                               function signature:
                                                                 (file, metadata, load, error, progress, abort) => {
                                                                   return {
                                                                   abort:() => {}
                                                                 }
                                                               }
                                                               */
    var createFileProcessorFunction = function createFileProcessorFunction(
        apiUrl,
        action,
        name,
        options
    ) {
        return function(file, metadata, load, error, progress, abort, transfer) {
            // no file received
            if (!file) return;

            // if was passed a file, and we can chunk it, exit here
            var canChunkUpload = options.chunkUploads;
            var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;
            var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);
            if (file instanceof Blob && willChunkUpload)
                return processFileChunked(
                    apiUrl,
                    action,
                    name,
                    file,
                    metadata,
                    load,
                    error,
                    progress,
                    abort,
                    transfer,
                    options
                );

            // set handlers
            var ondata =
                action.ondata ||
                function(fd) {
                    return fd;
                };
            var onload =
                action.onload ||
                function(res) {
                    return res;
                };
            var onerror =
                action.onerror ||
                function(res) {
                    return null;
                };

            var headers =
                typeof action.headers === 'function'
                    ? action.headers(file, metadata) || {}
                    : Object.assign(
                          {},

                          action.headers
                      );

            var requestParams = Object.assign({}, action, {
                headers: headers,
            });

            // create formdata object
            var formData = new FormData();

            // add metadata under same name
            if (isObject(metadata)) {
                formData.append(name, JSON.stringify(metadata));
            }

            // Turn into an array of objects so no matter what the input, we can handle it the same way
            (file instanceof Blob ? [{ name: null, file: file }] : file).forEach(function(item) {
                formData.append(
                    name,
                    item.file,
                    item.name === null ? item.file.name : '' + item.name + item.file.name
                );
            });

            // send request object
            var request = sendRequest(
                ondata(formData),
                buildURL(apiUrl, action.url),
                requestParams
            );
            request.onload = function(xhr) {
                load(
                    createResponse(
                        'load',
                        xhr.status,
                        onload(xhr.response),
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.onerror = function(xhr) {
                error(
                    createResponse(
                        'error',
                        xhr.status,
                        onerror(xhr.response) || xhr.statusText,
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.ontimeout = createTimeoutResponse(error);
            request.onprogress = progress;
            request.onabort = abort;

            // should return request
            return request;
        };
    };

    var createProcessorFunction = function createProcessorFunction() {
        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        var action = arguments.length > 1 ? arguments[1] : undefined;
        var name = arguments.length > 2 ? arguments[2] : undefined;
        var options = arguments.length > 3 ? arguments[3] : undefined;

        // custom handler (should also handle file, load, error, progress and abort)
        if (typeof action === 'function')
            return function() {
                for (
                    var _len = arguments.length, params = new Array(_len), _key = 0;
                    _key < _len;
                    _key++
                ) {
                    params[_key] = arguments[_key];
                }
                return action.apply(void 0, [name].concat(params, [options]));
            };

        // no action supplied
        if (!action || !isString(action.url)) return null;

        // internal handler
        return createFileProcessorFunction(apiUrl, action, name, options);
    };

    /*
                                                      function signature:
                                                      (uniqueFileId, load, error) => { }
                                                      */
    var createRevertFunction = function createRevertFunction() {
        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        var action = arguments.length > 1 ? arguments[1] : undefined;
        // is custom implementation
        if (typeof action === 'function') {
            return action;
        }

        // no action supplied, return stub function, interface will work, but file won't be removed
        if (!action || !isString(action.url)) {
            return function(uniqueFileId, load) {
                return load();
            };
        }

        // set onload hanlder
        var onload =
            action.onload ||
            function(res) {
                return res;
            };
        var onerror =
            action.onerror ||
            function(res) {
                return null;
            };

        // internal implementation
        return function(uniqueFileId, load, error) {
            var request = sendRequest(
                uniqueFileId,
                apiUrl + action.url,
                action // contains method, headers and withCredentials properties
            );
            request.onload = function(xhr) {
                load(
                    createResponse(
                        'load',
                        xhr.status,
                        onload(xhr.response),
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.onerror = function(xhr) {
                error(
                    createResponse(
                        'error',
                        xhr.status,
                        onerror(xhr.response) || xhr.statusText,
                        xhr.getAllResponseHeaders()
                    )
                );
            };

            request.ontimeout = createTimeoutResponse(error);

            return request;
        };
    };

    var getRandomNumber = function getRandomNumber() {
        var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
        var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
        return min + Math.random() * (max - min);
    };

    var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {
        var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;
        var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
        var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;
        var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;
        var timeout = null;
        var start = Date.now();

        var tick = function tick() {
            var runtime = Date.now() - start;
            var delay = getRandomNumber(tickMin, tickMax);

            if (runtime + delay > duration) {
                delay = runtime + delay - duration;
            }

            var progress = runtime / duration;
            if (progress >= 1 || document.hidden) {
                cb(1);
                return;
            }

            cb(progress);

            timeout = setTimeout(tick, delay);
        };

        if (duration > 0) tick();

        return {
            clear: function clear() {
                clearTimeout(timeout);
            },
        };
    };

    var createFileProcessor = function createFileProcessor(processFn, options) {
        var state = {
            complete: false,
            perceivedProgress: 0,
            perceivedPerformanceUpdater: null,
            progress: null,
            timestamp: null,
            perceivedDuration: 0,
            duration: 0,
            request: null,
            response: null,
        };
        var allowMinimumUploadDuration = options.allowMinimumUploadDuration;

        var process = function process(file, metadata) {
            var progressFn = function progressFn() {
                // we've not yet started the real download, stop here
                // the request might not go through, for instance, there might be some server trouble
                // if state.progress is null, the server does not allow computing progress and we show the spinner instead
                if (state.duration === 0 || state.progress === null) return;

                // as we're now processing, fire the progress event
                api.fire('progress', api.getProgress());
            };

            var completeFn = function completeFn() {
                state.complete = true;
                api.fire('load-perceived', state.response.body);
            };

            // let's start processing
            api.fire('start');

            // set request start
            state.timestamp = Date.now();

            // create perceived performance progress indicator
            state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(
                function(progress) {
                    state.perceivedProgress = progress;
                    state.perceivedDuration = Date.now() - state.timestamp;

                    progressFn();

                    // if fake progress is done, and a response has been received,
                    // and we've not yet called the complete method
                    if (state.response && state.perceivedProgress === 1 && !state.complete) {
                        // we done!
                        completeFn();
                    }
                },
                // random delay as in a list of files you start noticing
                // files uploading at the exact same speed
                allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0
            );

            // remember request so we can abort it later
            state.request = processFn(
                // the file to process
                file,

                // the metadata to send along
                metadata,

                // callbacks (load, error, progress, abort, transfer)
                // load expects the body to be a server id if
                // you want to make use of revert
                function(response) {
                    // we put the response in state so we can access
                    // it outside of this method
                    state.response = isObject(response)
                        ? response
                        : {
                              type: 'load',
                              code: 200,
                              body: '' + response,
                              headers: {},
                          };

                    // update duration
                    state.duration = Date.now() - state.timestamp;

                    // force progress to 1 as we're now done
                    state.progress = 1;

                    // actual load is done let's share results
                    api.fire('load', state.response.body);

                    // we are really done
                    // if perceived progress is 1 ( wait for perceived progress to complete )
                    // or if server does not support progress ( null )
                    if (
                        !allowMinimumUploadDuration ||
                        (allowMinimumUploadDuration && state.perceivedProgress === 1)
                    ) {
                        completeFn();
                    }
                },

                // error is expected to be an object with type, code, body
                function(error) {
                    // cancel updater
                    state.perceivedPerformanceUpdater.clear();

                    // update others about this error
                    api.fire(
                        'error',
                        isObject(error)
                            ? error
                            : {
                                  type: 'error',
                                  code: 0,
                                  body: '' + error,
                              }
                    );
                },

                // actual processing progress
                function(computable, current, total) {
                    // update actual duration
                    state.duration = Date.now() - state.timestamp;

                    // update actual progress
                    state.progress = computable ? current / total : null;

                    progressFn();
                },

                // abort does not expect a value
                function() {
                    // stop updater
                    state.perceivedPerformanceUpdater.clear();

                    // fire the abort event so we can switch visuals
                    api.fire('abort', state.response ? state.response.body : null);
                },

                // register the id for this transfer
                function(transferId) {
                    api.fire('transfer', transferId);
                }
            );
        };

        var abort = function abort() {
            // no request running, can't abort
            if (!state.request) return;

            // stop updater
            state.perceivedPerformanceUpdater.clear();

            // abort actual request
            if (state.request.abort) state.request.abort();

            // if has response object, we've completed the request
            state.complete = true;
        };

        var reset = function reset() {
            abort();
            state.complete = false;
            state.perceivedProgress = 0;
            state.progress = 0;
            state.timestamp = null;
            state.perceivedDuration = 0;
            state.duration = 0;
            state.request = null;
            state.response = null;
        };

        var getProgress = allowMinimumUploadDuration
            ? function() {
                  return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;
              }
            : function() {
                  return state.progress || null;
              };

        var getDuration = allowMinimumUploadDuration
            ? function() {
                  return Math.min(state.duration, state.perceivedDuration);
              }
            : function() {
                  return state.duration;
              };

        var api = Object.assign({}, on(), {
            process: process, // start processing file
            abort: abort, // abort active process request
            getProgress: getProgress,
            getDuration: getDuration,
            reset: reset,
        });

        return api;
    };

    var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {
        return name.substr(0, name.lastIndexOf('.')) || name;
    };

    var createFileStub = function createFileStub(source) {
        var data = [source.name, source.size, source.type];

        // is blob or base64, then we need to set the name
        if (source instanceof Blob || isBase64DataURI(source)) {
            data[0] = source.name || getDateString();
        } else if (isBase64DataURI(source)) {
            // if is base64 data uri we need to determine the average size and type
            data[1] = source.length;
            data[2] = getMimeTypeFromBase64DataURI(source);
        } else if (isString(source)) {
            // url
            data[0] = getFilenameFromURL(source);
            data[1] = 0;
            data[2] = 'application/octet-stream';
        }

        return {
            name: data[0],
            size: data[1],
            type: data[2],
        };
    };

    var isFile = function isFile(value) {
        return !!(value instanceof File || (value instanceof Blob && value.name));
    };

    var deepCloneObject = function deepCloneObject(src) {
        if (!isObject(src)) return src;
        var target = isArray(src) ? [] : {};
        for (var key in src) {
            if (!src.hasOwnProperty(key)) continue;
            var v = src[key];
            target[key] = v && isObject(v) ? deepCloneObject(v) : v;
        }
        return target;
    };

    var createItem = function createItem() {
        var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
        var serverFileReference =
            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
        var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
        // unique id for this item, is used to identify the item across views
        var id = getUniqueId();

        /**
         * Internal item state
         */
        var state = {
            // is archived
            archived: false,

            // if is frozen, no longer fires events
            frozen: false,

            // removed from view
            released: false,

            // original source
            source: null,

            // file model reference
            file: file,

            // id of file on server
            serverFileReference: serverFileReference,

            // id of file transfer on server
            transferId: null,

            // is aborted
            processingAborted: false,

            // current item status
            status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,

            // active processes
            activeLoader: null,
            activeProcessor: null,
        };

        // callback used when abort processing is called to link back to the resolve method
        var abortProcessingRequestComplete = null;

        /**
         * Externally added item metadata
         */
        var metadata = {};

        // item data
        var setStatus = function setStatus(status) {
            return (state.status = status);
        };

        // fire event unless the item has been archived
        var fire = function fire(event) {
            if (state.released || state.frozen) return;
            for (
                var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1;
                _key < _len;
                _key++
            ) {
                params[_key - 1] = arguments[_key];
            }
            api.fire.apply(api, [event].concat(params));
        };

        // file data
        var getFileExtension = function getFileExtension() {
            return getExtensionFromFilename(state.file.name);
        };
        var getFileType = function getFileType() {
            return state.file.type;
        };
        var getFileSize = function getFileSize() {
            return state.file.size;
        };
        var getFile = function getFile() {
            return state.file;
        };

        //
        // logic to load a file
        //
        var load = function load(source, loader, onload) {
            // remember the original item source
            state.source = source;

            // source is known
            api.fireSync('init');

            // file stub is already there
            if (state.file) {
                api.fireSync('load-skip');
                return;
            }

            // set a stub file object while loading the actual data
            state.file = createFileStub(source);

            // starts loading
            loader.on('init', function() {
                fire('load-init');
            });

            // we'eve received a size indication, let's update the stub
            loader.on('meta', function(meta) {
                // set size of file stub
                state.file.size = meta.size;

                // set name of file stub
                state.file.filename = meta.filename;

                // if has received source, we done
                if (meta.source) {
                    origin = FileOrigin.LIMBO;
                    state.serverFileReference = meta.source;
                    state.status = ItemStatus.PROCESSING_COMPLETE;
                }

                // size has been updated
                fire('load-meta');
            });

            // the file is now loading we need to update the progress indicators
            loader.on('progress', function(progress) {
                setStatus(ItemStatus.LOADING);

                fire('load-progress', progress);
            });

            // an error was thrown while loading the file, we need to switch to error state
            loader.on('error', function(error) {
                setStatus(ItemStatus.LOAD_ERROR);

                fire('load-request-error', error);
            });

            // user or another process aborted the file load (cannot retry)
            loader.on('abort', function() {
                setStatus(ItemStatus.INIT);
                fire('load-abort');
            });

            // done loading
            loader.on('load', function(file) {
                // as we've now loaded the file the loader is no longer required
                state.activeLoader = null;

                // called when file has loaded succesfully
                var success = function success(result) {
                    // set (possibly) transformed file
                    state.file = isFile(result) ? result : state.file;

                    // file received
                    if (origin === FileOrigin.LIMBO && state.serverFileReference) {
                        setStatus(ItemStatus.PROCESSING_COMPLETE);
                    } else {
                        setStatus(ItemStatus.IDLE);
                    }

                    fire('load');
                };

                var error = function error(result) {
                    // set original file
                    state.file = file;
                    fire('load-meta');

                    setStatus(ItemStatus.LOAD_ERROR);
                    fire('load-file-error', result);
                };

                // if we already have a server file reference, we don't need to call the onload method
                if (state.serverFileReference) {
                    success(file);
                    return;
                }

                // no server id, let's give this file the full treatment
                onload(file, success, error);
            });

            // set loader source data
            loader.setSource(source);

            // set as active loader
            state.activeLoader = loader;

            // load the source data
            loader.load();
        };

        var retryLoad = function retryLoad() {
            if (!state.activeLoader) {
                return;
            }
            state.activeLoader.load();
        };

        var abortLoad = function abortLoad() {
            if (state.activeLoader) {
                state.activeLoader.abort();
                return;
            }
            setStatus(ItemStatus.INIT);
            fire('load-abort');
        };

        //
        // logic to process a file
        //
        var process = function process(processor, onprocess) {
            // processing was aborted
            if (state.processingAborted) {
                state.processingAborted = false;
                return;
            }

            // now processing
            setStatus(ItemStatus.PROCESSING);

            // reset abort callback
            abortProcessingRequestComplete = null;

            // if no file loaded we'll wait for the load event
            if (!(state.file instanceof Blob)) {
                api.on('load', function() {
                    process(processor, onprocess);
                });
                return;
            }

            // setup processor
            processor.on('load', function(serverFileReference) {
                // need this id to be able to revert the upload
                state.transferId = null;
                state.serverFileReference = serverFileReference;
            });

            // register transfer id
            processor.on('transfer', function(transferId) {
                // need this id to be able to revert the upload
                state.transferId = transferId;
            });

            processor.on('load-perceived', function(serverFileReference) {
                // no longer required
                state.activeProcessor = null;

                // need this id to be able to rever the upload
                state.transferId = null;
                state.serverFileReference = serverFileReference;

                setStatus(ItemStatus.PROCESSING_COMPLETE);
                fire('process-complete', serverFileReference);
            });

            processor.on('start', function() {
                fire('process-start');
            });

            processor.on('error', function(error) {
                state.activeProcessor = null;
                setStatus(ItemStatus.PROCESSING_ERROR);
                fire('process-error', error);
            });

            processor.on('abort', function(serverFileReference) {
                state.activeProcessor = null;

                // if file was uploaded but processing was cancelled during perceived processor time store file reference
                state.serverFileReference = serverFileReference;

                setStatus(ItemStatus.IDLE);
                fire('process-abort');

                // has timeout so doesn't interfere with remove action
                if (abortProcessingRequestComplete) {
                    abortProcessingRequestComplete();
                }
            });

            processor.on('progress', function(progress) {
                fire('process-progress', progress);
            });

            // when successfully transformed
            var success = function success(file) {
                // if was archived in the mean time, don't process
                if (state.archived) return;

                // process file!
                processor.process(file, Object.assign({}, metadata));
            };

            // something went wrong during transform phase
            var error = console.error;

            // start processing the file
            onprocess(state.file, success, error);

            // set as active processor
            state.activeProcessor = processor;
        };

        var requestProcessing = function requestProcessing() {
            state.processingAborted = false;
            setStatus(ItemStatus.PROCESSING_QUEUED);
        };

        var abortProcessing = function abortProcessing() {
            return new Promise(function(resolve) {
                if (!state.activeProcessor) {
                    state.processingAborted = true;

                    setStatus(ItemStatus.IDLE);
                    fire('process-abort');

                    resolve();
                    return;
                }

                abortProcessingRequestComplete = function abortProcessingRequestComplete() {
                    resolve();
                };

                state.activeProcessor.abort();
            });
        };

        //
        // logic to revert a processed file
        //
        var revert = function revert(revertFileUpload, forceRevert) {
            return new Promise(function(resolve, reject) {
                // a completed upload will have a serverFileReference, a failed chunked upload where
                // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set
                var serverTransferId =
                    state.serverFileReference !== null
                        ? state.serverFileReference
                        : state.transferId;

                // cannot revert without a server id for this process
                if (serverTransferId === null) {
                    resolve();
                    return;
                }

                // revert the upload (fire and forget)
                revertFileUpload(
                    serverTransferId,
                    function() {
                        // reset file server id and transfer id as now it's not available on the server
                        state.serverFileReference = null;
                        state.transferId = null;
                        resolve();
                    },
                    function(error) {
                        // don't set error state when reverting is optional, it will always resolve
                        if (!forceRevert) {
                            resolve();
                            return;
                        }

                        // oh no errors
                        setStatus(ItemStatus.PROCESSING_REVERT_ERROR);
                        fire('process-revert-error');
                        reject(error);
                    }
                );

                // fire event
                setStatus(ItemStatus.IDLE);
                fire('process-revert');
            });
        };

        // exposed methods
        var _setMetadata = function setMetadata(key, value, silent) {
            var keys = key.split('.');
            var root = keys[0];
            var last = keys.pop();
            var data = metadata;
            keys.forEach(function(key) {
                return (data = data[key]);
            });

            // compare old value against new value, if they're the same, we're not updating
            if (JSON.stringify(data[last]) === JSON.stringify(value)) return;

            // update value
            data[last] = value;

            // fire update
            fire('metadata-update', {
                key: root,
                value: metadata[root],
                silent: silent,
            });
        };

        var getMetadata = function getMetadata(key) {
            return deepCloneObject(key ? metadata[key] : metadata);
        };

        var api = Object.assign(
            {
                id: {
                    get: function get() {
                        return id;
                    },
                },
                origin: {
                    get: function get() {
                        return origin;
                    },
                    set: function set(value) {
                        return (origin = value);
                    },
                },
                serverId: {
                    get: function get() {
                        return state.serverFileReference;
                    },
                },
                transferId: {
                    get: function get() {
                        return state.transferId;
                    },
                },
                status: {
                    get: function get() {
                        return state.status;
                    },
                },
                filename: {
                    get: function get() {
                        return state.file.name;
                    },
                },
                filenameWithoutExtension: {
                    get: function get() {
                        return getFilenameWithoutExtension(state.file.name);
                    },
                },
                fileExtension: { get: getFileExtension },
                fileType: { get: getFileType },
                fileSize: { get: getFileSize },
                file: { get: getFile },
                relativePath: {
                    get: function get() {
                        return state.file._relativePath;
                    },
                },

                source: {
                    get: function get() {
                        return state.source;
                    },
                },

                getMetadata: getMetadata,
                setMetadata: function setMetadata(key, value, silent) {
                    if (isObject(key)) {
                        var data = key;
                        Object.keys(data).forEach(function(key) {
                            _setMetadata(key, data[key], value);
                        });
                        return key;
                    }
                    _setMetadata(key, value, silent);
                    return value;
                },

                extend: function extend(name, handler) {
                    return (itemAPI[name] = handler);
                },

                abortLoad: abortLoad,
                retryLoad: retryLoad,
                requestProcessing: requestProcessing,
                abortProcessing: abortProcessing,

                load: load,
                process: process,
                revert: revert,
            },

            on(),
            {
                freeze: function freeze() {
                    return (state.frozen = true);
                },

                release: function release() {
                    return (state.released = true);
                },
                released: {
                    get: function get() {
                        return state.released;
                    },
                },

                archive: function archive() {
                    return (state.archived = true);
                },
                archived: {
                    get: function get() {
                        return state.archived;
                    },
                },
            }
        );

        // create it here instead of returning it instantly so we can extend it later
        var itemAPI = createObject(api);

        return itemAPI;
    };

    var getItemIndexByQuery = function getItemIndexByQuery(items, query) {
        // just return first index
        if (isEmpty(query)) {
            return 0;
        }

        // invalid queries
        if (!isString(query)) {
            return -1;
        }

        // return item by id (or -1 if not found)
        return items.findIndex(function(item) {
            return item.id === query;
        });
    };

    var getItemById = function getItemById(items, itemId) {
        var index = getItemIndexByQuery(items, itemId);
        if (index < 0) {
            return;
        }
        return items[index] || null;
    };

    var fetchBlob = function fetchBlob(url, load, error, progress, abort, headers) {
        var request = sendRequest(null, url, {
            method: 'GET',
            responseType: 'blob',
        });

        request.onload = function(xhr) {
            // get headers
            var headers = xhr.getAllResponseHeaders();

            // get filename
            var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);

            // create response
            load(
                createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers)
            );
        };

        request.onerror = function(xhr) {
            error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));
        };

        request.onheaders = function(xhr) {
            headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));
        };

        request.ontimeout = createTimeoutResponse(error);
        request.onprogress = progress;
        request.onabort = abort;

        // should return request
        return request;
    };

    var getDomainFromURL = function getDomainFromURL(url) {
        if (url.indexOf('//') === 0) {
            url = location.protocol + url;
        }
        return url
            .toLowerCase()
            .replace('blob:', '')
            .replace(/([a-z])?:\/\//, '$1')
            .split('/')[0];
    };

    var isExternalURL = function isExternalURL(url) {
        return (
            (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&
            getDomainFromURL(location.href) !== getDomainFromURL(url)
        );
    };

    var dynamicLabel = function dynamicLabel(label) {
        return function() {
            return isFunction(label) ? label.apply(void 0, arguments) : label;
        };
    };

    var isMockItem = function isMockItem(item) {
        return !isFile(item.file);
    };

    var listUpdated = function listUpdated(dispatch, state) {
        clearTimeout(state.listUpdateTimeout);
        state.listUpdateTimeout = setTimeout(function() {
            dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });
        }, 0);
    };

    var optionalPromise = function optionalPromise(fn) {
        for (
            var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1;
            _key < _len;
            _key++
        ) {
            params[_key - 1] = arguments[_key];
        }
        return new Promise(function(resolve) {
            if (!fn) {
                return resolve(true);
            }

            var result = fn.apply(void 0, params);

            if (result == null) {
                return resolve(true);
            }

            if (typeof result === 'boolean') {
                return resolve(result);
            }

            if (typeof result.then === 'function') {
                result.then(resolve);
            }
        });
    };

    var sortItems = function sortItems(state, compare) {
        state.items.sort(function(a, b) {
            return compare(createItemAPI(a), createItemAPI(b));
        });
    };

    // returns item based on state
    var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {
        return function() {
            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
            var query = _ref.query,
                _ref$success = _ref.success,
                success = _ref$success === void 0 ? function() {} : _ref$success,
                _ref$failure = _ref.failure,
                failure = _ref$failure === void 0 ? function() {} : _ref$failure,
                options = _objectWithoutProperties(_ref, ['query', 'success', 'failure']);
            var item = getItemByQuery(state.items, query);
            if (!item) {
                failure({
                    error: createResponse('error', 0, 'Item not found'),
                    file: null,
                });

                return;
            }
            itemHandler(item, success, failure, options || {});
        };
    };

    var actions = function actions(dispatch, query, state) {
        return {
            /**
             * Aborts all ongoing processes
             */
            ABORT_ALL: function ABORT_ALL() {
                getActiveItems(state.items).forEach(function(item) {
                    item.freeze();
                    item.abortLoad();
                    item.abortProcessing();
                });
            },

            /**
             * Sets initial files
             */
            DID_SET_FILES: function DID_SET_FILES(_ref2) {
                var _ref2$value = _ref2.value,
                    value = _ref2$value === void 0 ? [] : _ref2$value;
                // map values to file objects
                var files = value.map(function(file) {
                    return {
                        source: file.source ? file.source : file,
                        options: file.options,
                    };
                });

                // loop over files, if file is in list, leave it be, if not, remove
                // test if items should be moved
                var activeItems = getActiveItems(state.items);

                activeItems.forEach(function(item) {
                    // if item not is in new value, remove
                    if (
                        !files.find(function(file) {
                            return file.source === item.source || file.source === item.file;
                        })
                    ) {
                        dispatch('REMOVE_ITEM', { query: item, remove: false });
                    }
                });

                // add new files
                activeItems = getActiveItems(state.items);
                files.forEach(function(file, index) {
                    // if file is already in list
                    if (
                        activeItems.find(function(item) {
                            return item.source === file.source || item.file === file.source;
                        })
                    )
                        return;

                    // not in list, add
                    dispatch(
                        'ADD_ITEM',
                        Object.assign({}, file, {
                            interactionMethod: InteractionMethod.NONE,
                            index: index,
                        })
                    );
                });
            },

            DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {
                var id = _ref3.id,
                    action = _ref3.action,
                    change = _ref3.change;
                // don't do anything
                if (change.silent) return;

                // if is called multiple times in close succession we combined all calls together to save resources
                clearTimeout(state.itemUpdateTimeout);
                state.itemUpdateTimeout = setTimeout(function() {
                    var item = getItemById(state.items, id);

                    // only revert and attempt to upload when we're uploading to a server
                    if (!query('IS_ASYNC')) {
                        // should we update the output data
                        applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {
                            item: item,
                            query: query,
                            action: action,
                            change: change,
                        }).then(function(shouldPrepareOutput) {
                            // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook
                            var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');
                            if (beforePrepareFile)
                                shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);

                            if (!shouldPrepareOutput) return;

                            dispatch(
                                'REQUEST_PREPARE_OUTPUT',
                                {
                                    query: id,
                                    item: item,
                                    success: function success(file) {
                                        dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });
                                    },
                                },

                                true
                            );
                        });

                        return;
                    }

                    // if is local item we need to enable upload button so change can be propagated to server
                    if (item.origin === FileOrigin.LOCAL) {
                        dispatch('DID_LOAD_ITEM', {
                            id: item.id,
                            error: null,
                            serverFileReference: item.source,
                        });
                    }

                    // for async scenarios
                    var upload = function upload() {
                        // we push this forward a bit so the interface is updated correctly
                        setTimeout(function() {
                            dispatch('REQUEST_ITEM_PROCESSING', { query: id });
                        }, 32);
                    };

                    var revert = function revert(doUpload) {
                        item.revert(
                            createRevertFunction(
                                state.options.server.url,
                                state.options.server.revert
                            ),
                            query('GET_FORCE_REVERT')
                        )
                            .then(doUpload ? upload : function() {})
                            .catch(function() {});
                    };

                    var abort = function abort(doUpload) {
                        item.abortProcessing().then(doUpload ? upload : function() {});
                    };

                    // if we should re-upload the file immediately
                    if (item.status === ItemStatus.PROCESSING_COMPLETE) {
                        return revert(state.options.instantUpload);
                    }

                    // if currently uploading, cancel upload
                    if (item.status === ItemStatus.PROCESSING) {
                        return abort(state.options.instantUpload);
                    }

                    if (state.options.instantUpload) {
                        upload();
                    }
                }, 0);
            },

            MOVE_ITEM: function MOVE_ITEM(_ref4) {
                var query = _ref4.query,
                    index = _ref4.index;
                var item = getItemByQuery(state.items, query);
                if (!item) return;
                var currentIndex = state.items.indexOf(item);
                index = limit(index, 0, state.items.length - 1);
                if (currentIndex === index) return;
                state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);
            },

            SORT: function SORT(_ref5) {
                var compare = _ref5.compare;
                sortItems(state, compare);
                dispatch('DID_SORT_ITEMS', {
                    items: query('GET_ACTIVE_ITEMS'),
                });
            },

            ADD_ITEMS: function ADD_ITEMS(_ref6) {
                var items = _ref6.items,
                    index = _ref6.index,
                    interactionMethod = _ref6.interactionMethod,
                    _ref6$success = _ref6.success,
                    success = _ref6$success === void 0 ? function() {} : _ref6$success,
                    _ref6$failure = _ref6.failure,
                    failure = _ref6$failure === void 0 ? function() {} : _ref6$failure;
                var currentIndex = index;

                if (index === -1 || typeof index === 'undefined') {
                    var insertLocation = query('GET_ITEM_INSERT_LOCATION');
                    var totalItems = query('GET_TOTAL_ITEMS');
                    currentIndex = insertLocation === 'before' ? 0 : totalItems;
                }

                var ignoredFiles = query('GET_IGNORED_FILES');
                var isValidFile = function isValidFile(source) {
                    return isFile(source)
                        ? !ignoredFiles.includes(source.name.toLowerCase())
                        : !isEmpty(source);
                };
                var validItems = items.filter(isValidFile);

                var promises = validItems.map(function(source) {
                    return new Promise(function(resolve, reject) {
                        dispatch('ADD_ITEM', {
                            interactionMethod: interactionMethod,
                            source: source.source || source,
                            success: resolve,
                            failure: reject,
                            index: currentIndex++,
                            options: source.options || {},
                        });
                    });
                });

                Promise.all(promises)
                    .then(success)
                    .catch(failure);
            },

            /**
             * @param source
             * @param index
             * @param interactionMethod
             */
            ADD_ITEM: function ADD_ITEM(_ref7) {
                var source = _ref7.source,
                    _ref7$index = _ref7.index,
                    index = _ref7$index === void 0 ? -1 : _ref7$index,
                    interactionMethod = _ref7.interactionMethod,
                    _ref7$success = _ref7.success,
                    success = _ref7$success === void 0 ? function() {} : _ref7$success,
                    _ref7$failure = _ref7.failure,
                    failure = _ref7$failure === void 0 ? function() {} : _ref7$failure,
                    _ref7$options = _ref7.options,
                    options = _ref7$options === void 0 ? {} : _ref7$options;
                // if no source supplied
                if (isEmpty(source)) {
                    failure({
                        error: createResponse('error', 0, 'No source'),
                        file: null,
                    });

                    return;
                }

                // filter out invalid file items, used to filter dropped directory contents
                if (
                    isFile(source) &&
                    state.options.ignoredFiles.includes(source.name.toLowerCase())
                ) {
                    // fail silently
                    return;
                }

                // test if there's still room in the list of files
                if (!hasRoomForItem(state)) {
                    // if multiple allowed, we can't replace
                    // or if only a single item is allowed but we're not allowed to replace it we exit
                    if (
                        state.options.allowMultiple ||
                        (!state.options.allowMultiple && !state.options.allowReplace)
                    ) {
                        var error = createResponse('warning', 0, 'Max files');

                        dispatch('DID_THROW_MAX_FILES', {
                            source: source,
                            error: error,
                        });

                        failure({ error: error, file: null });

                        return;
                    }

                    // let's replace the item
                    // id of first item we're about to remove
                    var _item = getActiveItems(state.items)[0];

                    // if has been processed remove it from the server as well
                    if (
                        _item.status === ItemStatus.PROCESSING_COMPLETE ||
                        _item.status === ItemStatus.PROCESSING_REVERT_ERROR
                    ) {
                        var forceRevert = query('GET_FORCE_REVERT');
                        _item
                            .revert(
                                createRevertFunction(
                                    state.options.server.url,
                                    state.options.server.revert
                                ),
                                forceRevert
                            )
                            .then(function() {
                                if (!forceRevert) return;

                                // try to add now
                                dispatch('ADD_ITEM', {
                                    source: source,
                                    index: index,
                                    interactionMethod: interactionMethod,
                                    success: success,
                                    failure: failure,
                                    options: options,
                                });
                            })
                            .catch(function() {}); // no need to handle this catch state for now

                        if (forceRevert) return;
                    }

                    // remove first item as it will be replaced by this item
                    dispatch('REMOVE_ITEM', { query: _item.id });
                }

                // where did the file originate
                var origin =
                    options.type === 'local'
                        ? FileOrigin.LOCAL
                        : options.type === 'limbo'
                        ? FileOrigin.LIMBO
                        : FileOrigin.INPUT;

                // create a new blank item
                var item = createItem(
                    // where did this file come from
                    origin,

                    // an input file never has a server file reference
                    origin === FileOrigin.INPUT ? null : source,

                    // file mock data, if defined
                    options.file
                );

                // set initial meta data
                Object.keys(options.metadata || {}).forEach(function(key) {
                    item.setMetadata(key, options.metadata[key]);
                });

                // created the item, let plugins add methods
                applyFilters('DID_CREATE_ITEM', item, { query: query, dispatch: dispatch });

                // where to insert new items
                var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');

                // adjust index if is not allowed to pick location
                if (!state.options.itemInsertLocationFreedom) {
                    index = itemInsertLocation === 'before' ? -1 : state.items.length;
                }

                // add item to list
                insertItem(state.items, item, index);

                // sort items in list
                if (isFunction(itemInsertLocation) && source) {
                    sortItems(state, itemInsertLocation);
                }

                // get a quick reference to the item id
                var id = item.id;

                // observe item events
                item.on('init', function() {
                    dispatch('DID_INIT_ITEM', { id: id });
                });

                item.on('load-init', function() {
                    dispatch('DID_START_ITEM_LOAD', { id: id });
                });

                item.on('load-meta', function() {
                    dispatch('DID_UPDATE_ITEM_META', { id: id });
                });

                item.on('load-progress', function(progress) {
                    dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', { id: id, progress: progress });
                });

                item.on('load-request-error', function(error) {
                    var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);

                    // is client error, no way to recover
                    if (error.code >= 400 && error.code < 500) {
                        dispatch('DID_THROW_ITEM_INVALID', {
                            id: id,
                            error: error,
                            status: {
                                main: mainStatus,
                                sub: error.code + ' (' + error.body + ')',
                            },
                        });

                        // reject the file so can be dealt with through API
                        failure({ error: error, file: createItemAPI(item) });
                        return;
                    }

                    // is possible server error, so might be possible to retry
                    dispatch('DID_THROW_ITEM_LOAD_ERROR', {
                        id: id,
                        error: error,
                        status: {
                            main: mainStatus,
                            sub: state.options.labelTapToRetry,
                        },
                    });
                });

                item.on('load-file-error', function(error) {
                    dispatch('DID_THROW_ITEM_INVALID', {
                        id: id,
                        error: error.status,
                        status: error.status,
                    });

                    failure({ error: error.status, file: createItemAPI(item) });
                });

                item.on('load-abort', function() {
                    dispatch('REMOVE_ITEM', { query: id });
                });

                item.on('load-skip', function() {
                    dispatch('COMPLETE_LOAD_ITEM', {
                        query: id,
                        item: item,
                        data: {
                            source: source,
                            success: success,
                        },
                    });
                });

                item.on('load', function() {
                    var handleAdd = function handleAdd(shouldAdd) {
                        // no should not add this file
                        if (!shouldAdd) {
                            dispatch('REMOVE_ITEM', {
                                query: id,
                            });

                            return;
                        }

                        // now interested in metadata updates
                        item.on('metadata-update', function(change) {
                            dispatch('DID_UPDATE_ITEM_METADATA', { id: id, change: change });
                        });

                        // let plugins decide if the output data should be prepared at this point
                        // means we'll do this and wait for idle state
                        applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {
                            item: item,
                            query: query,
                        }).then(function(shouldPrepareOutput) {
                            // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook
                            var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');
                            if (beforePrepareFile)
                                shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);

                            var loadComplete = function loadComplete() {
                                dispatch('COMPLETE_LOAD_ITEM', {
                                    query: id,
                                    item: item,
                                    data: {
                                        source: source,
                                        success: success,
                                    },
                                });

                                listUpdated(dispatch, state);
                            };

                            // exit
                            if (shouldPrepareOutput) {
                                // wait for idle state and then run PREPARE_OUTPUT
                                dispatch(
                                    'REQUEST_PREPARE_OUTPUT',
                                    {
                                        query: id,
                                        item: item,
                                        success: function success(file) {
                                            dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });
                                            loadComplete();
                                        },
                                    },

                                    true
                                );

                                return;
                            }

                            loadComplete();
                        });
                    };

                    // item loaded, allow plugins to
                    // - read data (quickly)
                    // - add metadata
                    applyFilterChain('DID_LOAD_ITEM', item, { query: query, dispatch: dispatch })
                        .then(function() {
                            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(
                                handleAdd
                            );
                        })
                        .catch(function(e) {
                            if (!e || !e.error || !e.status) return handleAdd(false);
                            dispatch('DID_THROW_ITEM_INVALID', {
                                id: id,
                                error: e.error,
                                status: e.status,
                            });
                        });
                });

                item.on('process-start', function() {
                    dispatch('DID_START_ITEM_PROCESSING', { id: id });
                });

                item.on('process-progress', function(progress) {
                    dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', { id: id, progress: progress });
                });

                item.on('process-error', function(error) {
                    dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {
                        id: id,
                        error: error,
                        status: {
                            main: dynamicLabel(state.options.labelFileProcessingError)(error),
                            sub: state.options.labelTapToRetry,
                        },
                    });
                });

                item.on('process-revert-error', function(error) {
                    dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {
                        id: id,
                        error: error,
                        status: {
                            main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),
                            sub: state.options.labelTapToRetry,
                        },
                    });
                });

                item.on('process-complete', function(serverFileReference) {
                    dispatch('DID_COMPLETE_ITEM_PROCESSING', {
                        id: id,
                        error: null,
                        serverFileReference: serverFileReference,
                    });

                    dispatch('DID_DEFINE_VALUE', { id: id, value: serverFileReference });
                });

                item.on('process-abort', function() {
                    dispatch('DID_ABORT_ITEM_PROCESSING', { id: id });
                });

                item.on('process-revert', function() {
                    dispatch('DID_REVERT_ITEM_PROCESSING', { id: id });
                    dispatch('DID_DEFINE_VALUE', { id: id, value: null });
                });

                // let view know the item has been inserted
                dispatch('DID_ADD_ITEM', {
                    id: id,
                    index: index,
                    interactionMethod: interactionMethod,
                });

                listUpdated(dispatch, state);

                // start loading the source
                var _ref8 = state.options.server || {},
                    url = _ref8.url,
                    load = _ref8.load,
                    restore = _ref8.restore,
                    fetch = _ref8.fetch;

                item.load(
                    source,

                    // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)
                    createFileLoader(
                        origin === FileOrigin.INPUT
                            ? // input, if is remote, see if should use custom fetch, else use default fetchBlob
                              isString(source) && isExternalURL(source)
                                ? fetch
                                    ? createFetchFunction(url, fetch)
                                    : fetchBlob // remote url
                                : fetchBlob // try to fetch url
                            : // limbo or local
                            origin === FileOrigin.LIMBO
                            ? createFetchFunction(url, restore) // limbo
                            : createFetchFunction(url, load) // local
                    ),

                    // called when the file is loaded so it can be piped through the filters
                    function(file, success, error) {
                        // let's process the file
                        applyFilterChain('LOAD_FILE', file, { query: query })
                            .then(success)
                            .catch(error);
                    }
                );
            },

            REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {
                var item = _ref9.item,
                    success = _ref9.success,
                    _ref9$failure = _ref9.failure,
                    failure = _ref9$failure === void 0 ? function() {} : _ref9$failure;
                // error response if item archived
                var err = {
                    error: createResponse('error', 0, 'Item not found'),
                    file: null,
                };

                // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared
                if (item.archived) return failure(err);

                // allow plugins to alter the file data
                applyFilterChain('PREPARE_OUTPUT', item.file, { query: query, item: item }).then(
                    function(result) {
                        applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {
                            query: query,
                            item: item,
                        }).then(function(result) {
                            // don't handle archived items, an item could have been archived (load aborted) while being prepared
                            if (item.archived) return failure(err);

                            // we done!
                            success(result);
                        });
                    }
                );
            },

            COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {
                var item = _ref10.item,
                    data = _ref10.data;
                var success = data.success,
                    source = data.source;

                // sort items in list
                var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');
                if (isFunction(itemInsertLocation) && source) {
                    sortItems(state, itemInsertLocation);
                }

                // let interface know the item has loaded
                dispatch('DID_LOAD_ITEM', {
                    id: item.id,
                    error: null,
                    serverFileReference: item.origin === FileOrigin.INPUT ? null : source,
                });

                // item has been successfully loaded and added to the
                // list of items so can now be safely returned for use
                success(createItemAPI(item));

                // if this is a local server file we need to show a different state
                if (item.origin === FileOrigin.LOCAL) {
                    dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });
                    return;
                }

                // if is a temp server file we prevent async upload call here (as the file is already on the server)
                if (item.origin === FileOrigin.LIMBO) {
                    dispatch('DID_COMPLETE_ITEM_PROCESSING', {
                        id: item.id,
                        error: null,
                        serverFileReference: source,
                    });

                    dispatch('DID_DEFINE_VALUE', {
                        id: item.id,
                        value: item.serverId || source,
                    });

                    return;
                }

                // id we are allowed to upload the file immediately, lets do it
                if (query('IS_ASYNC') && state.options.instantUpload) {
                    dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });
                }
            },

            RETRY_ITEM_LOAD: getItemByQueryFromState(state, function(item) {
                // try loading the source one more time
                item.retryLoad();
            }),

            REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function(item, _success, failure) {
                dispatch(
                    'REQUEST_PREPARE_OUTPUT',
                    {
                        query: item.id,
                        item: item,
                        success: function success(file) {
                            dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });
                            _success({
                                file: item,
                                output: file,
                            });
                        },
                        failure: failure,
                    },

                    true
                );
            }),

            REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function(
                item,
                success,
                failure
            ) {
                // cannot be queued (or is already queued)
                var itemCanBeQueuedForProcessing =
                    // waiting for something
                    item.status === ItemStatus.IDLE ||
                    // processing went wrong earlier
                    item.status === ItemStatus.PROCESSING_ERROR;

                // not ready to be processed
                if (!itemCanBeQueuedForProcessing) {
                    var processNow = function processNow() {
                        return dispatch('REQUEST_ITEM_PROCESSING', {
                            query: item,
                            success: success,
                            failure: failure,
                        });
                    };

                    var process = function process() {
                        return document.hidden ? processNow() : setTimeout(processNow, 32);
                    };

                    // if already done processing or tried to revert but didn't work, try again
                    if (
                        item.status === ItemStatus.PROCESSING_COMPLETE ||
                        item.status === ItemStatus.PROCESSING_REVERT_ERROR
                    ) {
                        item.revert(
                            createRevertFunction(
                                state.options.server.url,
                                state.options.server.revert
                            ),
                            query('GET_FORCE_REVERT')
                        )
                            .then(process)
                            .catch(function() {}); // don't continue with processing if something went wrong
                    } else if (item.status === ItemStatus.PROCESSING) {
                        item.abortProcessing().then(process);
                    }

                    return;
                }

                // already queued for processing
                if (item.status === ItemStatus.PROCESSING_QUEUED) return;

                item.requestProcessing();

                dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });

                dispatch('PROCESS_ITEM', { query: item, success: success, failure: failure }, true);
            }),

            PROCESS_ITEM: getItemByQueryFromState(state, function(item, success, failure) {
                var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');
                var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING)
                    .length;

                // queue and wait till queue is freed up
                if (totalCurrentUploads === maxParallelUploads) {
                    // queue for later processing
                    state.processingQueue.push({
                        id: item.id,
                        success: success,
                        failure: failure,
                    });

                    // stop it!
                    return;
                }

                // if was not queued or is already processing exit here
                if (item.status === ItemStatus.PROCESSING) return;

                var processNext = function processNext() {
                    // process queueud items
                    var queueEntry = state.processingQueue.shift();

                    // no items left
                    if (!queueEntry) return;

                    // get item reference
                    var id = queueEntry.id,
                        success = queueEntry.success,
                        failure = queueEntry.failure;
                    var itemReference = getItemByQuery(state.items, id);

                    // if item was archived while in queue, jump to next
                    if (!itemReference || itemReference.archived) {
                        processNext();
                        return;
                    }

                    // process queued item
                    dispatch(
                        'PROCESS_ITEM',
                        { query: id, success: success, failure: failure },
                        true
                    );
                };

                // we done function
                item.onOnce('process-complete', function() {
                    success(createItemAPI(item));
                    processNext();

                    // if origin is local, and we're instant uploading, trigger remove of original
                    // as revert will remove file from list
                    var server = state.options.server;
                    var instantUpload = state.options.instantUpload;
                    if (
                        instantUpload &&
                        item.origin === FileOrigin.LOCAL &&
                        isFunction(server.remove)
                    ) {
                        var noop = function noop() {};
                        item.origin = FileOrigin.LIMBO;
                        state.options.server.remove(item.source, noop, noop);
                    }

                    // All items processed? No errors?
                    var allItemsProcessed =
                        query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length ===
                        state.items.length;
                    if (allItemsProcessed) {
                        dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');
                    }
                });

                // we error function
                item.onOnce('process-error', function(error) {
                    failure({ error: error, file: createItemAPI(item) });
                    processNext();
                });

                // start file processing
                var options = state.options;
                item.process(
                    createFileProcessor(
                        createProcessorFunction(
                            options.server.url,
                            options.server.process,
                            options.name,
                            {
                                chunkTransferId: item.transferId,
                                chunkServer: options.server.patch,
                                chunkUploads: options.chunkUploads,
                                chunkForce: options.chunkForce,
                                chunkSize: options.chunkSize,
                                chunkRetryDelays: options.chunkRetryDelays,
                            }
                        ),

                        {
                            allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION'),
                        }
                    ),

                    // called when the file is about to be processed so it can be piped through the transform filters
                    function(file, success, error) {
                        // allow plugins to alter the file data
                        applyFilterChain('PREPARE_OUTPUT', file, { query: query, item: item })
                            .then(function(file) {
                                dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });

                                success(file);
                            })
                            .catch(error);
                    }
                );
            }),

            RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {
                dispatch('REQUEST_ITEM_PROCESSING', { query: item });
            }),

            REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function(item) {
                optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function(
                    shouldRemove
                ) {
                    if (!shouldRemove) {
                        return;
                    }
                    dispatch('REMOVE_ITEM', { query: item });
                });
            }),

            RELEASE_ITEM: getItemByQueryFromState(state, function(item) {
                item.release();
            }),

            REMOVE_ITEM: getItemByQueryFromState(state, function(item, success, failure, options) {
                var removeFromView = function removeFromView() {
                    // get id reference
                    var id = item.id;

                    // archive the item, this does not remove it from the list
                    getItemById(state.items, id).archive();

                    // tell the view the item has been removed
                    dispatch('DID_REMOVE_ITEM', { error: null, id: id, item: item });

                    // now the list has been modified
                    listUpdated(dispatch, state);

                    // correctly removed
                    success(createItemAPI(item));
                };

                // if this is a local file and the `server.remove` function has been configured,
                // send source there so dev can remove file from server
                var server = state.options.server;
                if (
                    item.origin === FileOrigin.LOCAL &&
                    server &&
                    isFunction(server.remove) &&
                    options.remove !== false
                ) {
                    dispatch('DID_START_ITEM_REMOVE', { id: item.id });

                    server.remove(
                        item.source,
                        function() {
                            return removeFromView();
                        },
                        function(status) {
                            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {
                                id: item.id,
                                error: createResponse('error', 0, status, null),
                                status: {
                                    main: dynamicLabel(state.options.labelFileRemoveError)(status),
                                    sub: state.options.labelTapToRetry,
                                },
                            });
                        }
                    );
                } else {
                    // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)
                    if (
                        (options.revert &&
                            item.origin !== FileOrigin.LOCAL &&
                            item.serverId !== null) ||
                        // if chunked uploads are enabled and we're uploading in chunks for this specific file
                        // or if the file isn't big enough for chunked uploads but chunkForce is set then call
                        // revert before removing from the view...
                        (state.options.chunkUploads && item.file.size > state.options.chunkSize) ||
                        (state.options.chunkUploads && state.options.chunkForce)
                    ) {
                        item.revert(
                            createRevertFunction(
                                state.options.server.url,
                                state.options.server.revert
                            ),
                            query('GET_FORCE_REVERT')
                        );
                    }

                    // can now safely remove from view
                    removeFromView();
                }
            }),

            ABORT_ITEM_LOAD: getItemByQueryFromState(state, function(item) {
                item.abortLoad();
            }),

            ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {
                // test if is already processed
                if (item.serverId) {
                    dispatch('REVERT_ITEM_PROCESSING', { id: item.id });
                    return;
                }

                // abort
                item.abortProcessing().then(function() {
                    var shouldRemove = state.options.instantUpload;
                    if (shouldRemove) {
                        dispatch('REMOVE_ITEM', { query: item.id });
                    }
                });
            }),

            REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {
                // not instant uploading, revert immediately
                if (!state.options.instantUpload) {
                    dispatch('REVERT_ITEM_PROCESSING', { query: item });
                    return;
                }

                // if we're instant uploading the file will also be removed if we revert,
                // so if a before remove file hook is defined we need to run it now
                var handleRevert = function handleRevert(shouldRevert) {
                    if (!shouldRevert) return;
                    dispatch('REVERT_ITEM_PROCESSING', { query: item });
                };

                var fn = query('GET_BEFORE_REMOVE_FILE');
                if (!fn) {
                    return handleRevert(true);
                }

                var requestRemoveResult = fn(createItemAPI(item));
                if (requestRemoveResult == null) {
                    // undefined or null
                    return handleRevert(true);
                }

                if (typeof requestRemoveResult === 'boolean') {
                    return handleRevert(requestRemoveResult);
                }

                if (typeof requestRemoveResult.then === 'function') {
                    requestRemoveResult.then(handleRevert);
                }
            }),

            REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {
                item.revert(
                    createRevertFunction(state.options.server.url, state.options.server.revert),
                    query('GET_FORCE_REVERT')
                )
                    .then(function() {
                        var shouldRemove = state.options.instantUpload || isMockItem(item);
                        if (shouldRemove) {
                            dispatch('REMOVE_ITEM', { query: item.id });
                        }
                    })
                    .catch(function() {});
            }),

            SET_OPTIONS: function SET_OPTIONS(_ref11) {
                var options = _ref11.options;
                // get all keys passed
                var optionKeys = Object.keys(options);

                // get prioritized keyed to include (remove once not in options object)
                var prioritizedOptionKeys = PrioritizedOptions.filter(function(key) {
                    return optionKeys.includes(key);
                });

                // order the keys, prioritized first, then rest
                var orderedOptionKeys = [].concat(
                    _toConsumableArray(prioritizedOptionKeys),
                    _toConsumableArray(
                        Object.keys(options).filter(function(key) {
                            return !prioritizedOptionKeys.includes(key);
                        })
                    )
                );

                // dispatch set event for each option
                orderedOptionKeys.forEach(function(key) {
                    dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {
                        value: options[key],
                    });
                });
            },
        };
    };

    var PrioritizedOptions = ['server'];

    var formatFilename = function formatFilename(name) {
        return name;
    };

    var createElement$1 = function createElement(tagName) {
        return document.createElement(tagName);
    };

    var text = function text(node, value) {
        var textNode = node.childNodes[0];
        if (!textNode) {
            textNode = document.createTextNode(value);
            node.appendChild(textNode);
        } else if (value !== textNode.nodeValue) {
            textNode.nodeValue = value;
        }
    };

    var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
        var angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;
        return {
            x: centerX + radius * Math.cos(angleInRadians),
            y: centerY + radius * Math.sin(angleInRadians),
        };
    };

    var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {
        var start = polarToCartesian(x, y, radius, endAngle);
        var end = polarToCartesian(x, y, radius, startAngle);
        return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');
    };

    var percentageArc = function percentageArc(x, y, radius, from, to) {
        var arcSweep = 1;
        if (to > from && to - from <= 0.5) {
            arcSweep = 0;
        }
        if (from > to && from - to >= 0.5) {
            arcSweep = 0;
        }
        return describeArc(
            x,
            y,
            radius,
            Math.min(0.9999, from) * 360,
            Math.min(0.9999, to) * 360,
            arcSweep
        );
    };

    var create = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        // start at 0
        props.spin = false;
        props.progress = 0;
        props.opacity = 0;

        // svg
        var svg = createElement('svg');
        root.ref.path = createElement('path', {
            'stroke-width': 2,
            'stroke-linecap': 'round',
        });

        svg.appendChild(root.ref.path);

        root.ref.svg = svg;

        root.appendChild(svg);
    };

    var write = function write(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;
        if (props.opacity === 0) {
            return;
        }

        if (props.align) {
            root.element.dataset.align = props.align;
        }

        // get width of stroke
        var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);

        // calculate size of ring
        var size = root.rect.element.width * 0.5;

        // ring state
        var ringFrom = 0;
        var ringTo = 0;

        // now in busy mode
        if (props.spin) {
            ringFrom = 0;
            ringTo = 0.5;
        } else {
            ringFrom = 0;
            ringTo = props.progress;
        }

        // get arc path
        var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);

        // update progress bar
        attr(root.ref.path, 'd', coordinates);

        // hide while contains 0 value
        attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);
    };

    var progressIndicator = createView({
        tag: 'div',
        name: 'progress-indicator',
        ignoreRectUpdate: true,
        ignoreRect: true,
        create: create,
        write: write,
        mixins: {
            apis: ['progress', 'spin', 'align'],
            styles: ['opacity'],
            animations: {
                opacity: { type: 'tween', duration: 500 },
                progress: {
                    type: 'spring',
                    stiffness: 0.95,
                    damping: 0.65,
                    mass: 10,
                },
            },
        },
    });

    var create$1 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');

        props.isDisabled = false;
    };

    var write$1 = function write(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;
        var isDisabled = props.isDisabled;
        var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;

        if (shouldDisable && !isDisabled) {
            props.isDisabled = true;
            attr(root.element, 'disabled', 'disabled');
        } else if (!shouldDisable && isDisabled) {
            props.isDisabled = false;
            root.element.removeAttribute('disabled');
        }
    };

    var fileActionButton = createView({
        tag: 'button',
        attributes: {
            type: 'button',
        },

        ignoreRect: true,
        ignoreRectUpdate: true,
        name: 'file-action-button',
        mixins: {
            apis: ['label'],
            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],
            animations: {
                scaleX: 'spring',
                scaleY: 'spring',
                translateX: 'spring',
                translateY: 'spring',
                opacity: { type: 'tween', duration: 250 },
            },

            listeners: true,
        },

        create: create$1,
        write: write$1,
    });

    var toNaturalFileSize = function toNaturalFileSize(bytes) {
        var decimalSeparator =
            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';
        var base = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000;
        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
        var _options$labelBytes = options.labelBytes,
            labelBytes = _options$labelBytes === void 0 ? 'bytes' : _options$labelBytes,
            _options$labelKilobyt = options.labelKilobytes,
            labelKilobytes = _options$labelKilobyt === void 0 ? 'KB' : _options$labelKilobyt,
            _options$labelMegabyt = options.labelMegabytes,
            labelMegabytes = _options$labelMegabyt === void 0 ? 'MB' : _options$labelMegabyt,
            _options$labelGigabyt = options.labelGigabytes,
            labelGigabytes = _options$labelGigabyt === void 0 ? 'GB' : _options$labelGigabyt;

        // no negative byte sizes
        bytes = Math.round(Math.abs(bytes));

        var KB = base;
        var MB = base * base;
        var GB = base * base * base;

        // just bytes
        if (bytes < KB) {
            return bytes + ' ' + labelBytes;
        }

        // kilobytes
        if (bytes < MB) {
            return Math.floor(bytes / KB) + ' ' + labelKilobytes;
        }

        // megabytes
        if (bytes < GB) {
            return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' ' + labelMegabytes;
        }

        // gigabytes
        return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' ' + labelGigabytes;
    };

    var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {
        return value
            .toFixed(decimalCount)
            .split('.')
            .filter(function(part) {
                return part !== '0';
            })
            .join(separator);
    };

    var create$2 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        // filename
        var fileName = createElement$1('span');
        fileName.className = 'filepond--file-info-main';
        // hide for screenreaders
        // the file is contained in a fieldset with legend that contains the filename
        // no need to read it twice
        attr(fileName, 'aria-hidden', 'true');
        root.appendChild(fileName);
        root.ref.fileName = fileName;

        // filesize
        var fileSize = createElement$1('span');
        fileSize.className = 'filepond--file-info-sub';
        root.appendChild(fileSize);
        root.ref.fileSize = fileSize;

        // set initial values
        text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));
        text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));
    };

    var updateFile = function updateFile(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;
        text(
            root.ref.fileSize,
            toNaturalFileSize(
                root.query('GET_ITEM_SIZE', props.id),
                '.',
                root.query('GET_FILE_SIZE_BASE'),
                root.query('GET_FILE_SIZE_LABELS', root.query)
            )
        );

        text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));
    };

    var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {
        var root = _ref3.root,
            props = _ref3.props;
        // if size is available don't fallback to unknown size message
        if (isInt(root.query('GET_ITEM_SIZE', props.id))) {
            updateFile({ root: root, props: props });
            return;
        }

        text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));
    };

    var fileInfo = createView({
        name: 'file-info',
        ignoreRect: true,
        ignoreRectUpdate: true,
        write: createRoute({
            DID_LOAD_ITEM: updateFile,
            DID_UPDATE_ITEM_META: updateFile,
            DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,
            DID_THROW_ITEM_INVALID: updateFileSizeOnError,
        }),

        didCreateView: function didCreateView(root) {
            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));
        },
        create: create$2,
        mixins: {
            styles: ['translateX', 'translateY'],
            animations: {
                translateX: 'spring',
                translateY: 'spring',
            },
        },
    });

    var toPercentage = function toPercentage(value) {
        return Math.round(value * 100);
    };

    var create$3 = function create(_ref) {
        var root = _ref.root;

        // main status
        var main = createElement$1('span');
        main.className = 'filepond--file-status-main';
        root.appendChild(main);
        root.ref.main = main;

        // sub status
        var sub = createElement$1('span');
        sub.className = 'filepond--file-status-sub';
        root.appendChild(sub);
        root.ref.sub = sub;

        didSetItemLoadProgress({ root: root, action: { progress: null } });
    };

    var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {
        var root = _ref2.root,
            action = _ref2.action;
        var title =
            action.progress === null
                ? root.query('GET_LABEL_FILE_LOADING')
                : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';

        text(root.ref.main, title);
        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));
    };

    var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {
        var root = _ref3.root,
            action = _ref3.action;
        var title =
            action.progress === null
                ? root.query('GET_LABEL_FILE_PROCESSING')
                : root.query('GET_LABEL_FILE_PROCESSING') +
                  ' ' +
                  toPercentage(action.progress) +
                  '%';

        text(root.ref.main, title);
        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));
    };

    var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {
        var root = _ref4.root;
        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));
        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));
    };

    var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {
        var root = _ref5.root;
        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));
        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));
    };

    var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {
        var root = _ref6.root;
        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));
        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));
    };

    var clear = function clear(_ref7) {
        var root = _ref7.root;
        text(root.ref.main, '');
        text(root.ref.sub, '');
    };

    var error = function error(_ref8) {
        var root = _ref8.root,
            action = _ref8.action;
        text(root.ref.main, action.status.main);
        text(root.ref.sub, action.status.sub);
    };

    var fileStatus = createView({
        name: 'file-status',
        ignoreRect: true,
        ignoreRectUpdate: true,
        write: createRoute({
            DID_LOAD_ITEM: clear,
            DID_REVERT_ITEM_PROCESSING: clear,
            DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,
            DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,
            DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,
            DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,
            DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,
            DID_THROW_ITEM_LOAD_ERROR: error,
            DID_THROW_ITEM_INVALID: error,
            DID_THROW_ITEM_PROCESSING_ERROR: error,
            DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,
            DID_THROW_ITEM_REMOVE_ERROR: error,
        }),

        didCreateView: function didCreateView(root) {
            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));
        },
        create: create$3,
        mixins: {
            styles: ['translateX', 'translateY', 'opacity'],
            animations: {
                opacity: { type: 'tween', duration: 250 },
                translateX: 'spring',
                translateY: 'spring',
            },
        },
    });

    /**
     * Button definitions for the file view
     */

    var Buttons = {
        AbortItemLoad: {
            label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',
            action: 'ABORT_ITEM_LOAD',
            className: 'filepond--action-abort-item-load',
            align: 'LOAD_INDICATOR_POSITION', // right
        },
        RetryItemLoad: {
            label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',
            action: 'RETRY_ITEM_LOAD',
            icon: 'GET_ICON_RETRY',
            className: 'filepond--action-retry-item-load',
            align: 'BUTTON_PROCESS_ITEM_POSITION', // right
        },
        RemoveItem: {
            label: 'GET_LABEL_BUTTON_REMOVE_ITEM',
            action: 'REQUEST_REMOVE_ITEM',
            icon: 'GET_ICON_REMOVE',
            className: 'filepond--action-remove-item',
            align: 'BUTTON_REMOVE_ITEM_POSITION', // left
        },
        ProcessItem: {
            label: 'GET_LABEL_BUTTON_PROCESS_ITEM',
            action: 'REQUEST_ITEM_PROCESSING',
            icon: 'GET_ICON_PROCESS',
            className: 'filepond--action-process-item',
            align: 'BUTTON_PROCESS_ITEM_POSITION', // right
        },
        AbortItemProcessing: {
            label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',
            action: 'ABORT_ITEM_PROCESSING',
            className: 'filepond--action-abort-item-processing',
            align: 'BUTTON_PROCESS_ITEM_POSITION', // right
        },
        RetryItemProcessing: {
            label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',
            action: 'RETRY_ITEM_PROCESSING',
            icon: 'GET_ICON_RETRY',
            className: 'filepond--action-retry-item-processing',
            align: 'BUTTON_PROCESS_ITEM_POSITION', // right
        },
        RevertItemProcessing: {
            label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',
            action: 'REQUEST_REVERT_ITEM_PROCESSING',
            icon: 'GET_ICON_UNDO',
            className: 'filepond--action-revert-item-processing',
            align: 'BUTTON_PROCESS_ITEM_POSITION', // right
        },
    };

    // make a list of buttons, we can then remove buttons from this list if they're disabled
    var ButtonKeys = [];
    forin(Buttons, function(key) {
        ButtonKeys.push(key);
    });

    var calculateFileInfoOffset = function calculateFileInfoOffset(root) {
        if (getRemoveIndicatorAligment(root) === 'right') return 0;
        var buttonRect = root.ref.buttonRemoveItem.rect.element;
        return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;
    };

    var calculateButtonWidth = function calculateButtonWidth(root) {
        var buttonRect = root.ref.buttonAbortItemLoad.rect.element;
        return buttonRect.width;
    };

    // Force on full pixels so text stays crips
    var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {
        return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);
    };
    var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {
        return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);
    };

    var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {
        return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');
    };
    var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {
        return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');
    };
    var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {
        return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');
    };

    var DefaultStyle = {
        buttonAbortItemLoad: { opacity: 0 },
        buttonRetryItemLoad: { opacity: 0 },
        buttonRemoveItem: { opacity: 0 },
        buttonProcessItem: { opacity: 0 },
        buttonAbortItemProcessing: { opacity: 0 },
        buttonRetryItemProcessing: { opacity: 0 },
        buttonRevertItemProcessing: { opacity: 0 },
        loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },
        processProgressIndicator: { opacity: 0, align: getProcessIndicatorAlignment },
        processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },
        info: { translateX: 0, translateY: 0, opacity: 0 },
        status: { translateX: 0, translateY: 0, opacity: 0 },
    };

    var IdleStyle = {
        buttonRemoveItem: { opacity: 1 },
        buttonProcessItem: { opacity: 1 },
        info: { translateX: calculateFileInfoOffset },
        status: { translateX: calculateFileInfoOffset },
    };

    var ProcessingStyle = {
        buttonAbortItemProcessing: { opacity: 1 },
        processProgressIndicator: { opacity: 1 },
        status: { opacity: 1 },
    };

    var StyleMap = {
        DID_THROW_ITEM_INVALID: {
            buttonRemoveItem: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
            status: { translateX: calculateFileInfoOffset, opacity: 1 },
        },

        DID_START_ITEM_LOAD: {
            buttonAbortItemLoad: { opacity: 1 },
            loadProgressIndicator: { opacity: 1 },
            status: { opacity: 1 },
        },

        DID_THROW_ITEM_LOAD_ERROR: {
            buttonRetryItemLoad: { opacity: 1 },
            buttonRemoveItem: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
            status: { opacity: 1 },
        },

        DID_START_ITEM_REMOVE: {
            processProgressIndicator: { opacity: 1, align: getRemoveIndicatorAligment },
            info: { translateX: calculateFileInfoOffset },
            status: { opacity: 0 },
        },

        DID_THROW_ITEM_REMOVE_ERROR: {
            processProgressIndicator: { opacity: 0, align: getRemoveIndicatorAligment },
            buttonRemoveItem: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
            status: { opacity: 1, translateX: calculateFileInfoOffset },
        },

        DID_LOAD_ITEM: IdleStyle,
        DID_LOAD_LOCAL_ITEM: {
            buttonRemoveItem: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
            status: { translateX: calculateFileInfoOffset },
        },

        DID_START_ITEM_PROCESSING: ProcessingStyle,
        DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,
        DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,
        DID_COMPLETE_ITEM_PROCESSING: {
            buttonRevertItemProcessing: { opacity: 1 },
            info: { opacity: 1 },
            status: { opacity: 1 },
        },

        DID_THROW_ITEM_PROCESSING_ERROR: {
            buttonRemoveItem: { opacity: 1 },
            buttonRetryItemProcessing: { opacity: 1 },
            status: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
        },

        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {
            buttonRevertItemProcessing: { opacity: 1 },
            status: { opacity: 1 },
            info: { opacity: 1 },
        },

        DID_ABORT_ITEM_PROCESSING: {
            buttonRemoveItem: { opacity: 1 },
            buttonProcessItem: { opacity: 1 },
            info: { translateX: calculateFileInfoOffset },
            status: { opacity: 1 },
        },

        DID_REVERT_ITEM_PROCESSING: IdleStyle,
    };

    // complete indicator view
    var processingCompleteIndicatorView = createView({
        create: function create(_ref) {
            var root = _ref.root;
            root.element.innerHTML = root.query('GET_ICON_DONE');
        },
        name: 'processing-complete-indicator',
        ignoreRect: true,
        mixins: {
            styles: ['scaleX', 'scaleY', 'opacity'],
            animations: {
                scaleX: 'spring',
                scaleY: 'spring',
                opacity: { type: 'tween', duration: 250 },
            },
        },
    });

    /**
     * Creates the file view
     */
    var create$4 = function create(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;
        // copy Buttons object
        var LocalButtons = Object.keys(Buttons).reduce(function(prev, curr) {
            prev[curr] = Object.assign({}, Buttons[curr]);
            return prev;
        }, {});
        var id = props.id;

        // allow reverting upload
        var allowRevert = root.query('GET_ALLOW_REVERT');

        // allow remove file
        var allowRemove = root.query('GET_ALLOW_REMOVE');

        // allow processing upload
        var allowProcess = root.query('GET_ALLOW_PROCESS');

        // is instant uploading, need this to determine the icon of the undo button
        var instantUpload = root.query('GET_INSTANT_UPLOAD');

        // is async set up
        var isAsync = root.query('IS_ASYNC');

        // should align remove item buttons
        var alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');

        // enabled buttons array
        var buttonFilter;
        if (isAsync) {
            if (allowProcess && !allowRevert) {
                // only remove revert button
                buttonFilter = function buttonFilter(key) {
                    return !/RevertItemProcessing/.test(key);
                };
            } else if (!allowProcess && allowRevert) {
                // only remove process button
                buttonFilter = function buttonFilter(key) {
                    return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);
                };
            } else if (!allowProcess && !allowRevert) {
                // remove all process buttons
                buttonFilter = function buttonFilter(key) {
                    return !/Process/.test(key);
                };
            }
        } else {
            // no process controls available
            buttonFilter = function buttonFilter(key) {
                return !/Process/.test(key);
            };
        }

        var enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();

        // update icon and label for revert button when instant uploading
        if (instantUpload && allowRevert) {
            LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';
            LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';
        }

        // remove last button (revert) if not allowed
        if (isAsync && !allowRevert) {
            var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];
            map.info.translateX = calculateFileHorizontalCenterOffset;
            map.info.translateY = calculateFileVerticalCenterOffset;
            map.status.translateY = calculateFileVerticalCenterOffset;
            map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };
        }

        // should align center
        if (isAsync && !allowProcess) {
            [
                'DID_START_ITEM_PROCESSING',
                'DID_REQUEST_ITEM_PROCESSING',
                'DID_UPDATE_ITEM_PROCESS_PROGRESS',
                'DID_THROW_ITEM_PROCESSING_ERROR',
            ].forEach(function(key) {
                StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;
            });
            StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;
        }

        // move remove button to right
        if (alignRemoveItemButton && allowRevert) {
            LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';
            var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];
            _map.info.translateX = calculateFileInfoOffset;
            _map.status.translateY = calculateFileVerticalCenterOffset;
            _map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };
        }

        // show/hide RemoveItem button
        if (!allowRemove) {
            LocalButtons['RemoveItem'].disabled = true;
        }

        // create the button views
        forin(LocalButtons, function(key, definition) {
            // create button
            var buttonView = root.createChildView(fileActionButton, {
                label: root.query(definition.label),
                icon: root.query(definition.icon),
                opacity: 0,
            });

            // should be appended?
            if (enabledButtons.includes(key)) {
                root.appendChildView(buttonView);
            }

            // toggle
            if (definition.disabled) {
                buttonView.element.setAttribute('disabled', 'disabled');
                buttonView.element.setAttribute('hidden', 'hidden');
            }

            // add position attribute
            buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align);

            // add class
            buttonView.element.classList.add(definition.className);

            // handle interactions
            buttonView.on('click', function(e) {
                e.stopPropagation();
                if (definition.disabled) return;
                root.dispatch(definition.action, { query: id });
            });

            // set reference
            root.ref['button' + key] = buttonView;
        });

        // checkmark
        root.ref.processingCompleteIndicator = root.appendChildView(
            root.createChildView(processingCompleteIndicatorView)
        );

        root.ref.processingCompleteIndicator.element.dataset.align = root.query(
            'GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'
        );

        // create file info view
        root.ref.info = root.appendChildView(root.createChildView(fileInfo, { id: id }));

        // create file status view
        root.ref.status = root.appendChildView(root.createChildView(fileStatus, { id: id }));

        // add progress indicators
        var loadIndicatorView = root.appendChildView(
            root.createChildView(progressIndicator, {
                opacity: 0,
                align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION'),
            })
        );

        loadIndicatorView.element.classList.add('filepond--load-indicator');
        root.ref.loadProgressIndicator = loadIndicatorView;

        var progressIndicatorView = root.appendChildView(
            root.createChildView(progressIndicator, {
                opacity: 0,
                align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION'),
            })
        );

        progressIndicatorView.element.classList.add('filepond--process-indicator');
        root.ref.processProgressIndicator = progressIndicatorView;

        // current active styles
        root.ref.activeStyles = [];
    };

    var write$2 = function write(_ref3) {
        var root = _ref3.root,
            actions = _ref3.actions,
            props = _ref3.props;
        // route actions
        route({ root: root, actions: actions, props: props });

        // select last state change action
        var action = actions
            .concat()
            .filter(function(action) {
                return /^DID_/.test(action.type);
            })
            .reverse()
            .find(function(action) {
                return StyleMap[action.type];
            });

        // a new action happened, let's get the matching styles
        if (action) {
            // define new active styles
            root.ref.activeStyles = [];

            var stylesToApply = StyleMap[action.type];
            forin(DefaultStyle, function(name, defaultStyles) {
                // get reference to control
                var control = root.ref[name];

                // loop over all styles for this control
                forin(defaultStyles, function(key, defaultValue) {
                    var value =
                        stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined'
                            ? stylesToApply[name][key]
                            : defaultValue;
                    root.ref.activeStyles.push({ control: control, key: key, value: value });
                });
            });
        }

        // apply active styles to element
        root.ref.activeStyles.forEach(function(_ref4) {
            var control = _ref4.control,
                key = _ref4.key,
                value = _ref4.value;
            control[key] = typeof value === 'function' ? value(root) : value;
        });
    };

    var route = createRoute({
        DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(
            _ref5
        ) {
            var root = _ref5.root,
                action = _ref5.action;
            root.ref.buttonAbortItemProcessing.label = action.value;
        },
        DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {
            var root = _ref6.root,
                action = _ref6.action;
            root.ref.buttonAbortItemLoad.label = action.value;
        },
        DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(
            _ref7
        ) {
            var root = _ref7.root,
                action = _ref7.action;
            root.ref.buttonAbortItemRemoval.label = action.value;
        },
        DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {
            var root = _ref8.root;
            root.ref.processProgressIndicator.spin = true;
            root.ref.processProgressIndicator.progress = 0;
        },
        DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {
            var root = _ref9.root;
            root.ref.loadProgressIndicator.spin = true;
            root.ref.loadProgressIndicator.progress = 0;
        },
        DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {
            var root = _ref10.root;
            root.ref.processProgressIndicator.spin = true;
            root.ref.processProgressIndicator.progress = 0;
        },
        DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {
            var root = _ref11.root,
                action = _ref11.action;
            root.ref.loadProgressIndicator.spin = false;
            root.ref.loadProgressIndicator.progress = action.progress;
        },
        DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {
            var root = _ref12.root,
                action = _ref12.action;
            root.ref.processProgressIndicator.spin = false;
            root.ref.processProgressIndicator.progress = action.progress;
        },
    });

    var file = createView({
        create: create$4,
        write: write$2,
        didCreateView: function didCreateView(root) {
            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));
        },
        name: 'file',
    });

    /**
     * Creates the file view
     */
    var create$5 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;

        // filename
        root.ref.fileName = createElement$1('legend');
        root.appendChild(root.ref.fileName);

        // file appended
        root.ref.file = root.appendChildView(root.createChildView(file, { id: props.id }));

        // data has moved to data.js
        root.ref.data = false;
    };

    /**
     * Data storage
     */
    var didLoadItem = function didLoadItem(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;
        // updates the legend of the fieldset so screenreaders can better group buttons
        text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));
    };

    var fileWrapper = createView({
        create: create$5,
        ignoreRect: true,
        write: createRoute({
            DID_LOAD_ITEM: didLoadItem,
        }),

        didCreateView: function didCreateView(root) {
            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));
        },
        tag: 'fieldset',
        name: 'file-wrapper',
    });

    var PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };

    var create$6 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        [
            {
                name: 'top',
            },

            {
                name: 'center',
                props: {
                    translateY: null,
                    scaleY: null,
                },

                mixins: {
                    animations: {
                        scaleY: PANEL_SPRING_PROPS,
                    },

                    styles: ['translateY', 'scaleY'],
                },
            },

            {
                name: 'bottom',
                props: {
                    translateY: null,
                },

                mixins: {
                    animations: {
                        translateY: PANEL_SPRING_PROPS,
                    },

                    styles: ['translateY'],
                },
            },
        ].forEach(function(section) {
            createSection(root, section, props.name);
        });

        root.element.classList.add('filepond--' + props.name);

        root.ref.scalable = null;
    };

    var createSection = function createSection(root, section, className) {
        var viewConstructor = createView({
            name: 'panel-' + section.name + ' filepond--' + className,
            mixins: section.mixins,
            ignoreRectUpdate: true,
        });

        var view = root.createChildView(viewConstructor, section.props);

        root.ref[section.name] = root.appendChildView(view);
    };

    var write$3 = function write(_ref2) {
        var root = _ref2.root,
            props = _ref2.props;

        // update scalable state
        if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {
            root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;
            root.element.dataset.scalable = root.ref.scalable;
        }

        // no height, can't set
        if (!props.height) return;

        // get child rects
        var topRect = root.ref.top.rect.element;
        var bottomRect = root.ref.bottom.rect.element;

        // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)
        var height = Math.max(topRect.height + bottomRect.height, props.height);

        // offset center part
        root.ref.center.translateY = topRect.height;

        // scale center part
        // use math ceil to prevent transparent lines because of rounding errors
        root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;

        // offset bottom part
        root.ref.bottom.translateY = height - bottomRect.height;
    };

    var panel = createView({
        name: 'panel',
        read: function read(_ref3) {
            var root = _ref3.root,
                props = _ref3.props;
            return (props.heightCurrent = root.ref.bottom.translateY);
        },
        write: write$3,
        create: create$6,
        ignoreRect: true,
        mixins: {
            apis: ['height', 'heightCurrent', 'scalable'],
        },
    });

    var createDragHelper = function createDragHelper(items) {
        var itemIds = items.map(function(item) {
            return item.id;
        });
        var prevIndex = undefined;
        return {
            setIndex: function setIndex(index) {
                prevIndex = index;
            },
            getIndex: function getIndex() {
                return prevIndex;
            },
            getItemIndex: function getItemIndex(item) {
                return itemIds.indexOf(item.id);
            },
        };
    };

    var ITEM_TRANSLATE_SPRING = {
        type: 'spring',
        stiffness: 0.75,
        damping: 0.45,
        mass: 10,
    };

    var ITEM_SCALE_SPRING = 'spring';

    var StateMap = {
        DID_START_ITEM_LOAD: 'busy',
        DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',
        DID_THROW_ITEM_INVALID: 'load-invalid',
        DID_THROW_ITEM_LOAD_ERROR: 'load-error',
        DID_LOAD_ITEM: 'idle',
        DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',
        DID_START_ITEM_REMOVE: 'busy',
        DID_START_ITEM_PROCESSING: 'busy processing',
        DID_REQUEST_ITEM_PROCESSING: 'busy processing',
        DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',
        DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',
        DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',
        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',
        DID_ABORT_ITEM_PROCESSING: 'cancelled',
        DID_REVERT_ITEM_PROCESSING: 'idle',
    };

    /**
     * Creates the file view
     */
    var create$7 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;

        // select
        root.ref.handleClick = function(e) {
            return root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });
        };

        // set id
        root.element.id = 'filepond--item-' + props.id;
        root.element.addEventListener('click', root.ref.handleClick);

        // file view
        root.ref.container = root.appendChildView(
            root.createChildView(fileWrapper, { id: props.id })
        );

        // file panel
        root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'item-panel' }));

        // default start height
        root.ref.panel.height = null;

        // by default not marked for removal
        props.markedForRemoval = false;

        // if not allowed to reorder file items, exit here
        if (!root.query('GET_ALLOW_REORDER')) return;

        // set to idle so shows grab cursor
        root.element.dataset.dragState = 'idle';

        var grab = function grab(e) {
            if (!e.isPrimary) return;

            var removedActivateListener = false;

            var origin = {
                x: e.pageX,
                y: e.pageY,
            };

            props.dragOrigin = {
                x: root.translateX,
                y: root.translateY,
            };

            props.dragCenter = {
                x: e.offsetX,
                y: e.offsetY,
            };

            var dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));

            root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState: dragState });

            var drag = function drag(e) {
                if (!e.isPrimary) return;

                e.stopPropagation();
                e.preventDefault();

                props.dragOffset = {
                    x: e.pageX - origin.x,
                    y: e.pageY - origin.y,
                };

                // if dragged stop listening to clicks, will re-add when done dragging
                var dist =
                    props.dragOffset.x * props.dragOffset.x +
                    props.dragOffset.y * props.dragOffset.y;
                if (dist > 16 && !removedActivateListener) {
                    removedActivateListener = true;
                    root.element.removeEventListener('click', root.ref.handleClick);
                }

                root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState: dragState });
            };

            var drop = function drop(e) {
                if (!e.isPrimary) return;

                document.removeEventListener('pointermove', drag);
                document.removeEventListener('pointerup', drop);

                props.dragOffset = {
                    x: e.pageX - origin.x,
                    y: e.pageY - origin.y,
                };

                root.dispatch('DID_DROP_ITEM', { id: props.id, dragState: dragState });

                // start listening to clicks again
                if (removedActivateListener) {
                    setTimeout(function() {
                        return root.element.addEventListener('click', root.ref.handleClick);
                    }, 0);
                }
            };

            document.addEventListener('pointermove', drag);
            document.addEventListener('pointerup', drop);
        };

        root.element.addEventListener('pointerdown', grab);
    };

    var route$1 = createRoute({
        DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {
            var root = _ref2.root,
                action = _ref2.action;
            root.height = action.height;
        },
    });

    var write$4 = createRoute(
        {
            DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {
                var root = _ref3.root,
                    props = _ref3.props;
                props.dragOrigin = {
                    x: root.translateX,
                    y: root.translateY,
                };
            },
            DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {
                var root = _ref4.root;
                root.element.dataset.dragState = 'drag';
            },
            DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {
                var root = _ref5.root,
                    props = _ref5.props;
                props.dragOffset = null;
                props.dragOrigin = null;
                root.element.dataset.dragState = 'drop';
            },
        },
        function(_ref6) {
            var root = _ref6.root,
                actions = _ref6.actions,
                props = _ref6.props,
                shouldOptimize = _ref6.shouldOptimize;

            if (root.element.dataset.dragState === 'drop') {
                if (root.scaleX <= 1) {
                    root.element.dataset.dragState = 'idle';
                }
            }

            // select last state change action
            var action = actions
                .concat()
                .filter(function(action) {
                    return /^DID_/.test(action.type);
                })
                .reverse()
                .find(function(action) {
                    return StateMap[action.type];
                });

            // no need to set same state twice
            if (action && action.type !== props.currentState) {
                // set current state
                props.currentState = action.type;

                // set state
                root.element.dataset.filepondItemState = StateMap[props.currentState] || '';
            }

            // route actions
            var aspectRatio =
                root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');
            if (!aspectRatio) {
                route$1({ root: root, actions: actions, props: props });
                if (!root.height && root.ref.container.rect.element.height > 0) {
                    root.height = root.ref.container.rect.element.height;
                }
            } else if (!shouldOptimize) {
                root.height = root.rect.element.width * aspectRatio;
            }

            // sync panel height with item height
            if (shouldOptimize) {
                root.ref.panel.height = null;
            }

            root.ref.panel.height = root.height;
        }
    );

    var item = createView({
        create: create$7,
        write: write$4,
        destroy: function destroy(_ref7) {
            var root = _ref7.root,
                props = _ref7.props;
            root.element.removeEventListener('click', root.ref.handleClick);
            root.dispatch('RELEASE_ITEM', { query: props.id });
        },
        tag: 'li',
        name: 'item',
        mixins: {
            apis: [
                'id',
                'interactionMethod',
                'markedForRemoval',
                'spawnDate',
                'dragCenter',
                'dragOrigin',
                'dragOffset',
            ],
            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],

            animations: {
                scaleX: ITEM_SCALE_SPRING,
                scaleY: ITEM_SCALE_SPRING,
                translateX: ITEM_TRANSLATE_SPRING,
                translateY: ITEM_TRANSLATE_SPRING,
                opacity: { type: 'tween', duration: 150 },
            },
        },
    });

    var getItemsPerRow = function(horizontalSpace, itemWidth) {
        // add one pixel leeway, when using percentages for item width total items can be 1.99 per row

        return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));
    };

    var getItemIndexByPosition = function getItemIndexByPosition(view, children, positionInView) {
        if (!positionInView) return;

        var horizontalSpace = view.rect.element.width;
        // const children = view.childViews;
        var l = children.length;
        var last = null;

        // -1, don't move items to accomodate (either add to top or bottom)
        if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;

        // let's get the item width
        var item = children[0];
        var itemRect = item.rect.element;
        var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;
        var itemWidth = itemRect.width + itemHorizontalMargin;
        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);

        // stack
        if (itemsPerRow === 1) {
            for (var index = 0; index < l; index++) {
                var child = children[index];
                var childMid = child.rect.outer.top + child.rect.element.height * 0.5;
                if (positionInView.top < childMid) {
                    return index;
                }
            }
            return l;
        }

        // grid
        var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;
        var itemHeight = itemRect.height + itemVerticalMargin;
        for (var _index = 0; _index < l; _index++) {
            var indexX = _index % itemsPerRow;
            var indexY = Math.floor(_index / itemsPerRow);

            var offsetX = indexX * itemWidth;
            var offsetY = indexY * itemHeight;

            var itemTop = offsetY - itemRect.marginTop;
            var itemRight = offsetX + itemWidth;
            var itemBottom = offsetY + itemHeight + itemRect.marginBottom;

            if (positionInView.top < itemBottom && positionInView.top > itemTop) {
                if (positionInView.left < itemRight) {
                    return _index;
                } else if (_index !== l - 1) {
                    last = _index;
                } else {
                    last = null;
                }
            }
        }

        if (last !== null) {
            return last;
        }

        return l;
    };

    var dropAreaDimensions = {
        height: 0,
        width: 0,
        get getHeight() {
            return this.height;
        },
        set setHeight(val) {
            if (this.height === 0 || val === 0) this.height = val;
        },
        get getWidth() {
            return this.width;
        },
        set setWidth(val) {
            if (this.width === 0 || val === 0) this.width = val;
        },
        setDimensions: function setDimensions(height, width) {
            if (this.height === 0 || height === 0) this.height = height;
            if (this.width === 0 || width === 0) this.width = width;
        },
    };

    var create$8 = function create(_ref) {
        var root = _ref.root;
        // need to set role to list as otherwise it won't be read as a list by VoiceOver
        attr(root.element, 'role', 'list');

        root.ref.lastItemSpanwDate = Date.now();
    };

    /**
     * Inserts a new item
     * @param root
     * @param action
     */
    var addItemView = function addItemView(_ref2) {
        var root = _ref2.root,
            action = _ref2.action;
        var id = action.id,
            index = action.index,
            interactionMethod = action.interactionMethod;

        root.ref.addIndex = index;

        var now = Date.now();
        var spawnDate = now;
        var opacity = 1;

        if (interactionMethod !== InteractionMethod.NONE) {
            opacity = 0;
            var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');
            var dist = now - root.ref.lastItemSpanwDate;
            spawnDate = dist < cooldown ? now + (cooldown - dist) : now;
        }

        root.ref.lastItemSpanwDate = spawnDate;

        root.appendChildView(
            root.createChildView(
                // view type
                item,

                // props
                {
                    spawnDate: spawnDate,
                    id: id,
                    opacity: opacity,
                    interactionMethod: interactionMethod,
                }
            ),

            index
        );
    };

    var moveItem = function moveItem(item, x, y) {
        var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
        var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;
        // set to null to remove animation while dragging
        if (item.dragOffset) {
            item.translateX = null;
            item.translateY = null;
            item.translateX = item.dragOrigin.x + item.dragOffset.x;
            item.translateY = item.dragOrigin.y + item.dragOffset.y;
            item.scaleX = 1.025;
            item.scaleY = 1.025;
        } else {
            item.translateX = x;
            item.translateY = y;

            if (Date.now() > item.spawnDate) {
                // reveal element
                if (item.opacity === 0) {
                    introItemView(item, x, y, vx, vy);
                }

                // make sure is default scale every frame
                item.scaleX = 1;
                item.scaleY = 1;
                item.opacity = 1;
            }
        }
    };

    var introItemView = function introItemView(item, x, y, vx, vy) {
        if (item.interactionMethod === InteractionMethod.NONE) {
            item.translateX = null;
            item.translateX = x;
            item.translateY = null;
            item.translateY = y;
        } else if (item.interactionMethod === InteractionMethod.DROP) {
            item.translateX = null;
            item.translateX = x - vx * 20;

            item.translateY = null;
            item.translateY = y - vy * 10;

            item.scaleX = 0.8;
            item.scaleY = 0.8;
        } else if (item.interactionMethod === InteractionMethod.BROWSE) {
            item.translateY = null;
            item.translateY = y - 30;
        } else if (item.interactionMethod === InteractionMethod.API) {
            item.translateX = null;
            item.translateX = x - 30;
            item.translateY = null;
        }
    };

    /**
     * Removes an existing item
     * @param root
     * @param action
     */
    var removeItemView = function removeItemView(_ref3) {
        var root = _ref3.root,
            action = _ref3.action;
        var id = action.id;

        // get the view matching the given id
        var view = root.childViews.find(function(child) {
            return child.id === id;
        });

        // if no view found, exit
        if (!view) {
            return;
        }

        // animate view out of view
        view.scaleX = 0.9;
        view.scaleY = 0.9;
        view.opacity = 0;

        // mark for removal
        view.markedForRemoval = true;
    };

    var getItemHeight = function getItemHeight(child) {
        return (
            child.rect.element.height +
            child.rect.element.marginBottom * 0.5 +
            child.rect.element.marginTop * 0.5
        );
    };
    var getItemWidth = function getItemWidth(child) {
        return (
            child.rect.element.width +
            child.rect.element.marginLeft * 0.5 +
            child.rect.element.marginRight * 0.5
        );
    };

    var dragItem = function dragItem(_ref4) {
        var root = _ref4.root,
            action = _ref4.action;
        var id = action.id,
            dragState = action.dragState;

        // reference to item
        var item = root.query('GET_ITEM', { id: id });

        // get the view matching the given id
        var view = root.childViews.find(function(child) {
            return child.id === id;
        });

        var numItems = root.childViews.length;
        var oldIndex = dragState.getItemIndex(item);

        // if no view found, exit
        if (!view) return;

        var dragPosition = {
            x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,
            y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y,
        };

        // get drag area dimensions
        var dragHeight = getItemHeight(view);
        var dragWidth = getItemWidth(view);

        // get rows and columns (There will always be at least one row and one column if a file is present)
        var cols = Math.floor(root.rect.outer.width / dragWidth);
        if (cols > numItems) cols = numItems;

        // rows are used to find when we have left the preview area bounding box
        var rows = Math.floor(numItems / cols + 1);

        dropAreaDimensions.setHeight = dragHeight * rows;
        dropAreaDimensions.setWidth = dragWidth * cols;

        // get new index of dragged item
        var location = {
            y: Math.floor(dragPosition.y / dragHeight),
            x: Math.floor(dragPosition.x / dragWidth),
            getGridIndex: function getGridIndex() {
                if (
                    dragPosition.y > dropAreaDimensions.getHeight ||
                    dragPosition.y < 0 ||
                    dragPosition.x > dropAreaDimensions.getWidth ||
                    dragPosition.x < 0
                )
                    return oldIndex;
                return this.y * cols + this.x;
            },
            getColIndex: function getColIndex() {
                var items = root.query('GET_ACTIVE_ITEMS');
                var visibleChildren = root.childViews.filter(function(child) {
                    return child.rect.element.height;
                });
                var children = items.map(function(item) {
                    return visibleChildren.find(function(childView) {
                        return childView.id === item.id;
                    });
                });

                var currentIndex = children.findIndex(function(child) {
                    return child === view;
                });
                var dragHeight = getItemHeight(view);
                var l = children.length;
                var idx = l;
                var childHeight = 0;
                var childBottom = 0;
                var childTop = 0;
                for (var i = 0; i < l; i++) {
                    childHeight = getItemHeight(children[i]);
                    childTop = childBottom;
                    childBottom = childTop + childHeight;
                    if (dragPosition.y < childBottom) {
                        if (currentIndex > i) {
                            if (dragPosition.y < childTop + dragHeight) {
                                idx = i;
                                break;
                            }
                            continue;
                        }
                        idx = i;
                        break;
                    }
                }
                return idx;
            },
        };

        // get new index
        var index = cols > 1 ? location.getGridIndex() : location.getColIndex();
        root.dispatch('MOVE_ITEM', { query: view, index: index });

        // if the index of the item changed, dispatch reorder action
        var currentIndex = dragState.getIndex();

        if (currentIndex === undefined || currentIndex !== index) {
            dragState.setIndex(index);

            if (currentIndex === undefined) return;

            root.dispatch('DID_REORDER_ITEMS', {
                items: root.query('GET_ACTIVE_ITEMS'),
                origin: oldIndex,
                target: index,
            });
        }
    };

    /**
     * Setup action routes
     */
    var route$2 = createRoute({
        DID_ADD_ITEM: addItemView,
        DID_REMOVE_ITEM: removeItemView,
        DID_DRAG_ITEM: dragItem,
    });

    /**
     * Write to view
     * @param root
     * @param actions
     * @param props
     */
    var write$5 = function write(_ref5) {
        var root = _ref5.root,
            props = _ref5.props,
            actions = _ref5.actions,
            shouldOptimize = _ref5.shouldOptimize;
        // route actions
        route$2({ root: root, props: props, actions: actions });
        var dragCoordinates = props.dragCoordinates;

        // available space on horizontal axis
        var horizontalSpace = root.rect.element.width;

        // only draw children that have dimensions
        var visibleChildren = root.childViews.filter(function(child) {
            return child.rect.element.height;
        });

        // sort based on current active items
        var children = root
            .query('GET_ACTIVE_ITEMS')
            .map(function(item) {
                return visibleChildren.find(function(child) {
                    return child.id === item.id;
                });
            })
            .filter(function(item) {
                return item;
            });

        // get index
        var dragIndex = dragCoordinates
            ? getItemIndexByPosition(root, children, dragCoordinates)
            : null;

        // add index is used to reserve the dropped/added item index till the actual item is rendered
        var addIndex = root.ref.addIndex || null;

        // add index no longer needed till possibly next draw
        root.ref.addIndex = null;

        var dragIndexOffset = 0;
        var removeIndexOffset = 0;
        var addIndexOffset = 0;

        if (children.length === 0) return;

        var childRect = children[0].rect.element;
        var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;
        var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;
        var itemWidth = childRect.width + itemHorizontalMargin;
        var itemHeight = childRect.height + itemVerticalMargin;
        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);

        // stack
        if (itemsPerRow === 1) {
            var offsetY = 0;
            var dragOffset = 0;

            children.forEach(function(child, index) {
                if (dragIndex) {
                    var dist = index - dragIndex;
                    if (dist === -2) {
                        dragOffset = -itemVerticalMargin * 0.25;
                    } else if (dist === -1) {
                        dragOffset = -itemVerticalMargin * 0.75;
                    } else if (dist === 0) {
                        dragOffset = itemVerticalMargin * 0.75;
                    } else if (dist === 1) {
                        dragOffset = itemVerticalMargin * 0.25;
                    } else {
                        dragOffset = 0;
                    }
                }

                if (shouldOptimize) {
                    child.translateX = null;
                    child.translateY = null;
                }

                if (!child.markedForRemoval) {
                    moveItem(child, 0, offsetY + dragOffset);
                }

                var itemHeight = child.rect.element.height + itemVerticalMargin;

                var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);

                offsetY += visualHeight;
            });
        }
        // grid
        else {
            var prevX = 0;
            var prevY = 0;

            children.forEach(function(child, index) {
                if (index === dragIndex) {
                    dragIndexOffset = 1;
                }

                if (index === addIndex) {
                    addIndexOffset += 1;
                }

                if (child.markedForRemoval && child.opacity < 0.5) {
                    removeIndexOffset -= 1;
                }

                var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;

                var indexX = visualIndex % itemsPerRow;
                var indexY = Math.floor(visualIndex / itemsPerRow);

                var offsetX = indexX * itemWidth;
                var offsetY = indexY * itemHeight;

                var vectorX = Math.sign(offsetX - prevX);
                var vectorY = Math.sign(offsetY - prevY);

                prevX = offsetX;
                prevY = offsetY;

                if (child.markedForRemoval) return;

                if (shouldOptimize) {
                    child.translateX = null;
                    child.translateY = null;
                }

                moveItem(child, offsetX, offsetY, vectorX, vectorY);
            });
        }
    };

    /**
     * Filters actions that are meant specifically for a certain child of the list
     * @param child
     * @param actions
     */
    var filterSetItemActions = function filterSetItemActions(child, actions) {
        return actions.filter(function(action) {
            // if action has an id, filter out actions that don't have this child id
            if (action.data && action.data.id) {
                return child.id === action.data.id;
            }

            // allow all other actions
            return true;
        });
    };

    var list = createView({
        create: create$8,
        write: write$5,
        tag: 'ul',
        name: 'list',
        didWriteView: function didWriteView(_ref6) {
            var root = _ref6.root;
            root.childViews
                .filter(function(view) {
                    return view.markedForRemoval && view.opacity === 0 && view.resting;
                })
                .forEach(function(view) {
                    view._destroy();
                    root.removeChildView(view);
                });
        },
        filterFrameActionsForChild: filterSetItemActions,
        mixins: {
            apis: ['dragCoordinates'],
        },
    });

    var create$9 = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        root.ref.list = root.appendChildView(root.createChildView(list));
        props.dragCoordinates = null;
        props.overflowing = false;
    };

    var storeDragCoordinates = function storeDragCoordinates(_ref2) {
        var root = _ref2.root,
            props = _ref2.props,
            action = _ref2.action;
        if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;
        props.dragCoordinates = {
            left: action.position.scopeLeft - root.ref.list.rect.element.left,
            top:
                action.position.scopeTop -
                (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop),
        };
    };

    var clearDragCoordinates = function clearDragCoordinates(_ref3) {
        var props = _ref3.props;
        props.dragCoordinates = null;
    };

    var route$3 = createRoute({
        DID_DRAG: storeDragCoordinates,
        DID_END_DRAG: clearDragCoordinates,
    });

    var write$6 = function write(_ref4) {
        var root = _ref4.root,
            props = _ref4.props,
            actions = _ref4.actions;

        // route actions
        route$3({ root: root, props: props, actions: actions });

        // current drag position
        root.ref.list.dragCoordinates = props.dragCoordinates;

        // if currently overflowing but no longer received overflow
        if (props.overflowing && !props.overflow) {
            props.overflowing = false;

            // reset overflow state
            root.element.dataset.state = '';
            root.height = null;
        }

        // if is not overflowing currently but does receive overflow value
        if (props.overflow) {
            var newHeight = Math.round(props.overflow);
            if (newHeight !== root.height) {
                props.overflowing = true;
                root.element.dataset.state = 'overflow';
                root.height = newHeight;
            }
        }
    };

    var listScroller = createView({
        create: create$9,
        write: write$6,
        name: 'list-scroller',
        mixins: {
            apis: ['overflow', 'dragCoordinates'],
            styles: ['height', 'translateY'],
            animations: {
                translateY: 'spring',
            },
        },
    });

    var attrToggle = function attrToggle(element, name, state) {
        var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
        if (state) {
            attr(element, name, enabledValue);
        } else {
            element.removeAttribute(name);
        }
    };

    var resetFileInput = function resetFileInput(input) {
        // no value, no need to reset
        if (!input || input.value === '') {
            return;
        }

        try {
            // for modern browsers
            input.value = '';
        } catch (err) {}

        // for IE10
        if (input.value) {
            // quickly append input to temp form and reset form
            var form = createElement$1('form');
            var parentNode = input.parentNode;
            var ref = input.nextSibling;
            form.appendChild(input);
            form.reset();

            // re-inject input where it originally was
            if (ref) {
                parentNode.insertBefore(input, ref);
            } else {
                parentNode.appendChild(input);
            }
        }
    };

    var create$a = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;

        // set id so can be referenced from outside labels
        root.element.id = 'filepond--browser-' + props.id;

        // set name of element (is removed when a value is set)
        attr(root.element, 'name', root.query('GET_NAME'));

        // we have to link this element to the status element
        attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);

        // set label, we use labelled by as otherwise the screenreader does not read the "browse" text in the label (as it has tabindex: 0)
        attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);

        // set configurable props
        setAcceptedFileTypes({
            root: root,
            action: { value: root.query('GET_ACCEPTED_FILE_TYPES') },
        });
        toggleAllowMultiple({ root: root, action: { value: root.query('GET_ALLOW_MULTIPLE') } });
        toggleDirectoryFilter({
            root: root,
            action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') },
        });
        toggleDisabled({ root: root });
        toggleRequired({ root: root, action: { value: root.query('GET_REQUIRED') } });
        setCaptureMethod({ root: root, action: { value: root.query('GET_CAPTURE_METHOD') } });

        // handle changes to the input field
        root.ref.handleChange = function(e) {
            if (!root.element.value) {
                return;
            }

            // extract files and move value of webkitRelativePath path to _relativePath
            var files = Array.from(root.element.files).map(function(file) {
                file._relativePath = file.webkitRelativePath;
                return file;
            });

            // we add a little delay so the OS file select window can move out of the way before we add our file
            setTimeout(function() {
                // load files
                props.onload(files);

                // reset input, it's just for exposing a method to drop files, should not retain any state
                resetFileInput(root.element);
            }, 250);
        };

        root.element.addEventListener('change', root.ref.handleChange);
    };

    var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {
        var root = _ref2.root,
            action = _ref2.action;
        if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;
        attrToggle(
            root.element,
            'accept',
            !!action.value,
            action.value ? action.value.join(',') : ''
        );
    };

    var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {
        var root = _ref3.root,
            action = _ref3.action;
        attrToggle(root.element, 'multiple', action.value);
    };

    var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {
        var root = _ref4.root,
            action = _ref4.action;
        attrToggle(root.element, 'webkitdirectory', action.value);
    };

    var toggleDisabled = function toggleDisabled(_ref5) {
        var root = _ref5.root;
        var isDisabled = root.query('GET_DISABLED');
        var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');
        var disableField = isDisabled || !doesAllowBrowse;
        attrToggle(root.element, 'disabled', disableField);
    };

    var toggleRequired = function toggleRequired(_ref6) {
        var root = _ref6.root,
            action = _ref6.action;
        // want to remove required, always possible
        if (!action.value) {
            attrToggle(root.element, 'required', false);
        }
        // if want to make required, only possible when zero items
        else if (root.query('GET_TOTAL_ITEMS') === 0) {
            attrToggle(root.element, 'required', true);
        }
    };

    var setCaptureMethod = function setCaptureMethod(_ref7) {
        var root = _ref7.root,
            action = _ref7.action;
        attrToggle(
            root.element,
            'capture',
            !!action.value,
            action.value === true ? '' : action.value
        );
    };

    var updateRequiredStatus = function updateRequiredStatus(_ref8) {
        var root = _ref8.root;
        var element = root.element;
        // always remove the required attribute when more than zero items
        if (root.query('GET_TOTAL_ITEMS') > 0) {
            attrToggle(element, 'required', false);
            attrToggle(element, 'name', false);
        } else {
            // add name attribute
            attrToggle(element, 'name', true, root.query('GET_NAME'));

            // remove any validation messages
            var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');
            if (shouldCheckValidity) {
                element.setCustomValidity('');
            }

            // we only add required if the field has been deemed required
            if (root.query('GET_REQUIRED')) {
                attrToggle(element, 'required', true);
            }
        }
    };

    var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {
        var root = _ref9.root;
        var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');
        if (!shouldCheckValidity) return;
        root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));
    };

    var browser = createView({
        tag: 'input',
        name: 'browser',
        ignoreRect: true,
        ignoreRectUpdate: true,
        attributes: {
            type: 'file',
        },

        create: create$a,
        destroy: function destroy(_ref10) {
            var root = _ref10.root;
            root.element.removeEventListener('change', root.ref.handleChange);
        },
        write: createRoute({
            DID_LOAD_ITEM: updateRequiredStatus,
            DID_REMOVE_ITEM: updateRequiredStatus,
            DID_THROW_ITEM_INVALID: updateFieldValidityStatus,

            DID_SET_DISABLED: toggleDisabled,
            DID_SET_ALLOW_BROWSE: toggleDisabled,
            DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,
            DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,
            DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,
            DID_SET_CAPTURE_METHOD: setCaptureMethod,
            DID_SET_REQUIRED: toggleRequired,
        }),
    });

    var Key = {
        ENTER: 13,
        SPACE: 32,
    };

    var create$b = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;

        // create the label and link it to the file browser
        var label = createElement$1('label');
        attr(label, 'for', 'filepond--browser-' + props.id);

        // use for labeling file input (aria-labelledby on file input)
        attr(label, 'id', 'filepond--drop-label-' + props.id);

        // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.
        attr(label, 'aria-hidden', 'true');

        // handle keys
        root.ref.handleKeyDown = function(e) {
            var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;
            if (!isActivationKey) return;
            // stops from triggering the element a second time
            e.preventDefault();

            // click link (will then in turn activate file input)
            root.ref.label.click();
        };

        root.ref.handleClick = function(e) {
            var isLabelClick = e.target === label || label.contains(e.target);

            // don't want to click twice
            if (isLabelClick) return;

            // click link (will then in turn activate file input)
            root.ref.label.click();
        };

        // attach events
        label.addEventListener('keydown', root.ref.handleKeyDown);
        root.element.addEventListener('click', root.ref.handleClick);

        // update
        updateLabelValue(label, props.caption);

        // add!
        root.appendChild(label);
        root.ref.label = label;
    };

    var updateLabelValue = function updateLabelValue(label, value) {
        label.innerHTML = value;
        var clickable = label.querySelector('.filepond--label-action');
        if (clickable) {
            attr(clickable, 'tabindex', '0');
        }
        return value;
    };

    var dropLabel = createView({
        name: 'drop-label',
        ignoreRect: true,
        create: create$b,
        destroy: function destroy(_ref2) {
            var root = _ref2.root;
            root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);
            root.element.removeEventListener('click', root.ref.handleClick);
        },
        write: createRoute({
            DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {
                var root = _ref3.root,
                    action = _ref3.action;
                updateLabelValue(root.ref.label, action.value);
            },
        }),

        mixins: {
            styles: ['opacity', 'translateX', 'translateY'],
            animations: {
                opacity: { type: 'tween', duration: 150 },
                translateX: 'spring',
                translateY: 'spring',
            },
        },
    });

    var blob = createView({
        name: 'drip-blob',
        ignoreRect: true,
        mixins: {
            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],
            animations: {
                scaleX: 'spring',
                scaleY: 'spring',
                translateX: 'spring',
                translateY: 'spring',
                opacity: { type: 'tween', duration: 250 },
            },
        },
    });

    var addBlob = function addBlob(_ref) {
        var root = _ref.root;
        var centerX = root.rect.element.width * 0.5;
        var centerY = root.rect.element.height * 0.5;

        root.ref.blob = root.appendChildView(
            root.createChildView(blob, {
                opacity: 0,
                scaleX: 2.5,
                scaleY: 2.5,
                translateX: centerX,
                translateY: centerY,
            })
        );
    };

    var moveBlob = function moveBlob(_ref2) {
        var root = _ref2.root,
            action = _ref2.action;
        if (!root.ref.blob) {
            addBlob({ root: root });
            return;
        }

        root.ref.blob.translateX = action.position.scopeLeft;
        root.ref.blob.translateY = action.position.scopeTop;
        root.ref.blob.scaleX = 1;
        root.ref.blob.scaleY = 1;
        root.ref.blob.opacity = 1;
    };

    var hideBlob = function hideBlob(_ref3) {
        var root = _ref3.root;
        if (!root.ref.blob) {
            return;
        }
        root.ref.blob.opacity = 0;
    };

    var explodeBlob = function explodeBlob(_ref4) {
        var root = _ref4.root;
        if (!root.ref.blob) {
            return;
        }
        root.ref.blob.scaleX = 2.5;
        root.ref.blob.scaleY = 2.5;
        root.ref.blob.opacity = 0;
    };

    var write$7 = function write(_ref5) {
        var root = _ref5.root,
            props = _ref5.props,
            actions = _ref5.actions;
        route$4({ root: root, props: props, actions: actions });
        var blob = root.ref.blob;

        if (actions.length === 0 && blob && blob.opacity === 0) {
            root.removeChildView(blob);
            root.ref.blob = null;
        }
    };

    var route$4 = createRoute({
        DID_DRAG: moveBlob,
        DID_DROP: explodeBlob,
        DID_END_DRAG: hideBlob,
    });

    var drip = createView({
        ignoreRect: true,
        ignoreRectUpdate: true,
        name: 'drip',
        write: write$7,
    });

    var setInputFiles = function setInputFiles(element, files) {
        try {
            // Create a DataTransfer instance and add a newly created file
            var dataTransfer = new DataTransfer();
            files.forEach(function(file) {
                if (file instanceof File) {
                    dataTransfer.items.add(file);
                } else {
                    dataTransfer.items.add(
                        new File([file], file.name, {
                            type: file.type,
                        })
                    );
                }
            });

            // Assign the DataTransfer files list to the file input
            element.files = dataTransfer.files;
        } catch (err) {
            return false;
        }
        return true;
    };

    var create$c = function create(_ref) {
        var root = _ref.root;
        return (root.ref.fields = {});
    };

    var getField = function getField(root, id) {
        return root.ref.fields[id];
    };

    var syncFieldPositionsWithItems = function syncFieldPositionsWithItems(root) {
        root.query('GET_ACTIVE_ITEMS').forEach(function(item) {
            if (!root.ref.fields[item.id]) return;
            root.element.appendChild(root.ref.fields[item.id]);
        });
    };

    var didReorderItems = function didReorderItems(_ref2) {
        var root = _ref2.root;
        return syncFieldPositionsWithItems(root);
    };

    var didAddItem = function didAddItem(_ref3) {
        var root = _ref3.root,
            action = _ref3.action;
        var fileItem = root.query('GET_ITEM', action.id);
        var isLocalFile = fileItem.origin === FileOrigin.LOCAL;
        var shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');
        var dataContainer = createElement$1('input');
        dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';
        dataContainer.name = root.query('GET_NAME');
        dataContainer.disabled = root.query('GET_DISABLED');
        root.ref.fields[action.id] = dataContainer;
        syncFieldPositionsWithItems(root);
    };

    var didLoadItem$1 = function didLoadItem(_ref4) {
        var root = _ref4.root,
            action = _ref4.action;
        var field = getField(root, action.id);
        if (!field) return;

        // store server ref in hidden input
        if (action.serverFileReference !== null) field.value = action.serverFileReference;

        // store file item in file input
        if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;

        var fileItem = root.query('GET_ITEM', action.id);
        setInputFiles(field, [fileItem.file]);
    };

    var didPrepareOutput = function didPrepareOutput(_ref5) {
        var root = _ref5.root,
            action = _ref5.action;
        // this timeout pushes the handler after 'load'
        if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;
        setTimeout(function() {
            var field = getField(root, action.id);
            if (!field) return;
            setInputFiles(field, [action.file]);
        }, 0);
    };

    var didSetDisabled = function didSetDisabled(_ref6) {
        var root = _ref6.root;
        root.element.disabled = root.query('GET_DISABLED');
    };

    var didRemoveItem = function didRemoveItem(_ref7) {
        var root = _ref7.root,
            action = _ref7.action;
        var field = getField(root, action.id);
        if (!field) return;
        if (field.parentNode) field.parentNode.removeChild(field);
        delete root.ref.fields[action.id];
    };

    // only runs for server files (so doesn't deal with file input)
    var didDefineValue = function didDefineValue(_ref8) {
        var root = _ref8.root,
            action = _ref8.action;
        var field = getField(root, action.id);
        if (!field) return;
        if (action.value === null) {
            // clear field value
            field.removeAttribute('value');
        } else {
            // set field value
            field.value = action.value;
        }
        syncFieldPositionsWithItems(root);
    };

    var write$8 = createRoute({
        DID_SET_DISABLED: didSetDisabled,
        DID_ADD_ITEM: didAddItem,
        DID_LOAD_ITEM: didLoadItem$1,
        DID_REMOVE_ITEM: didRemoveItem,
        DID_DEFINE_VALUE: didDefineValue,
        DID_PREPARE_OUTPUT: didPrepareOutput,
        DID_REORDER_ITEMS: didReorderItems,
        DID_SORT_ITEMS: didReorderItems,
    });

    var data = createView({
        tag: 'fieldset',
        name: 'data',
        create: create$c,
        write: write$8,
        ignoreRect: true,
    });

    var getRootNode = function getRootNode(element) {
        return 'getRootNode' in element ? element.getRootNode() : document;
    };

    var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];
    var text$1 = ['css', 'csv', 'html', 'txt'];
    var map = {
        zip: 'zip|compressed',
        epub: 'application/epub+zip',
    };

    var guesstimateMimeType = function guesstimateMimeType() {
        var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        extension = extension.toLowerCase();
        if (images.includes(extension)) {
            return (
                'image/' +
                (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension)
            );
        }
        if (text$1.includes(extension)) {
            return 'text/' + extension;
        }

        return map[extension] || '';
    };

    var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {
        return new Promise(function(resolve, reject) {
            // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)
            var links = getLinks(dataTransfer);
            if (links.length && !hasFiles(dataTransfer)) {
                return resolve(links);
            }
            // try to get files from the transfer
            getFiles(dataTransfer).then(resolve);
        });
    };

    /**
     * Test if datatransfer has files
     */
    var hasFiles = function hasFiles(dataTransfer) {
        if (dataTransfer.files) return dataTransfer.files.length > 0;
        return false;
    };

    /**
     * Extracts files from a DataTransfer object
     */
    var getFiles = function getFiles(dataTransfer) {
        return new Promise(function(resolve, reject) {
            // get the transfer items as promises
            var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : [])
                // only keep file system items (files and directories)
                .filter(function(item) {
                    return isFileSystemItem(item);
                })

                // map each item to promise
                .map(function(item) {
                    return getFilesFromItem(item);
                });

            // if is empty, see if we can extract some info from the files property as a fallback
            if (!promisedFiles.length) {
                // TODO: test for directories (should not be allowed)
                // Use FileReader, problem is that the files property gets lost in the process
                resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);
                return;
            }

            // done!
            Promise.all(promisedFiles)
                .then(function(returnedFileGroups) {
                    // flatten groups
                    var files = [];
                    returnedFileGroups.forEach(function(group) {
                        files.push.apply(files, group);
                    });

                    // done (filter out empty files)!
                    resolve(
                        files
                            .filter(function(file) {
                                return file;
                            })
                            .map(function(file) {
                                if (!file._relativePath)
                                    file._relativePath = file.webkitRelativePath;
                                return file;
                            })
                    );
                })
                .catch(console.error);
        });
    };

    var isFileSystemItem = function isFileSystemItem(item) {
        if (isEntry(item)) {
            var entry = getAsEntry(item);
            if (entry) {
                return entry.isFile || entry.isDirectory;
            }
        }
        return item.kind === 'file';
    };

    var getFilesFromItem = function getFilesFromItem(item) {
        return new Promise(function(resolve, reject) {
            if (isDirectoryEntry(item)) {
                getFilesInDirectory(getAsEntry(item))
                    .then(resolve)
                    .catch(reject);
                return;
            }

            resolve([item.getAsFile()]);
        });
    };

    var getFilesInDirectory = function getFilesInDirectory(entry) {
        return new Promise(function(resolve, reject) {
            var files = [];

            // the total entries to read
            var dirCounter = 0;
            var fileCounter = 0;

            var resolveIfDone = function resolveIfDone() {
                if (fileCounter === 0 && dirCounter === 0) {
                    resolve(files);
                }
            };

            // the recursive function
            var readEntries = function readEntries(dirEntry) {
                dirCounter++;

                var directoryReader = dirEntry.createReader();

                // directories are returned in batches, we need to process all batches before we're done
                var readBatch = function readBatch() {
                    directoryReader.readEntries(function(entries) {
                        if (entries.length === 0) {
                            dirCounter--;
                            resolveIfDone();
                            return;
                        }

                        entries.forEach(function(entry) {
                            // recursively read more directories
                            if (entry.isDirectory) {
                                readEntries(entry);
                            } else {
                                // read as file
                                fileCounter++;

                                entry.file(function(file) {
                                    var correctedFile = correctMissingFileType(file);
                                    if (entry.fullPath)
                                        correctedFile._relativePath = entry.fullPath;
                                    files.push(correctedFile);
                                    fileCounter--;
                                    resolveIfDone();
                                });
                            }
                        });

                        // try to get next batch of files
                        readBatch();
                    }, reject);
                };

                // read first batch of files
                readBatch();
            };

            // go!
            readEntries(entry);
        });
    };

    var correctMissingFileType = function correctMissingFileType(file) {
        if (file.type.length) return file;
        var date = file.lastModifiedDate;
        var name = file.name;
        var type = guesstimateMimeType(getExtensionFromFilename(file.name));
        if (!type.length) return file;
        file = file.slice(0, file.size, type);
        file.name = name;
        file.lastModifiedDate = date;
        return file;
    };

    var isDirectoryEntry = function isDirectoryEntry(item) {
        return isEntry(item) && (getAsEntry(item) || {}).isDirectory;
    };

    var isEntry = function isEntry(item) {
        return 'webkitGetAsEntry' in item;
    };

    var getAsEntry = function getAsEntry(item) {
        return item.webkitGetAsEntry();
    };

    /**
     * Extracts links from a DataTransfer object
     */
    var getLinks = function getLinks(dataTransfer) {
        var links = [];
        try {
            // look in meta data property
            links = getLinksFromTransferMetaData(dataTransfer);
            if (links.length) {
                return links;
            }
            links = getLinksFromTransferURLData(dataTransfer);
        } catch (e) {
            // nope nope nope (probably IE trouble)
        }
        return links;
    };

    var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {
        var data = dataTransfer.getData('url');
        if (typeof data === 'string' && data.length) {
            return [data];
        }
        return [];
    };

    var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {
        var data = dataTransfer.getData('text/html');
        if (typeof data === 'string' && data.length) {
            var matches = data.match(/src\s*=\s*"(.+?)"/);
            if (matches) {
                return [matches[1]];
            }
        }
        return [];
    };

    var dragNDropObservers = [];

    var eventPosition = function eventPosition(e) {
        return {
            pageLeft: e.pageX,
            pageTop: e.pageY,
            scopeLeft: e.offsetX || e.layerX,
            scopeTop: e.offsetY || e.layerY,
        };
    };

    var createDragNDropClient = function createDragNDropClient(
        element,
        scopeToObserve,
        filterElement
    ) {
        var observer = getDragNDropObserver(scopeToObserve);

        var client = {
            element: element,
            filterElement: filterElement,
            state: null,
            ondrop: function ondrop() {},
            onenter: function onenter() {},
            ondrag: function ondrag() {},
            onexit: function onexit() {},
            onload: function onload() {},
            allowdrop: function allowdrop() {},
        };

        client.destroy = observer.addListener(client);

        return client;
    };

    var getDragNDropObserver = function getDragNDropObserver(element) {
        // see if already exists, if so, return
        var observer = dragNDropObservers.find(function(item) {
            return item.element === element;
        });
        if (observer) {
            return observer;
        }

        // create new observer, does not yet exist for this element
        var newObserver = createDragNDropObserver(element);
        dragNDropObservers.push(newObserver);
        return newObserver;
    };

    var createDragNDropObserver = function createDragNDropObserver(element) {
        var clients = [];

        var routes = {
            dragenter: dragenter,
            dragover: dragover,
            dragleave: dragleave,
            drop: drop,
        };

        var handlers = {};

        forin(routes, function(event, createHandler) {
            handlers[event] = createHandler(element, clients);
            element.addEventListener(event, handlers[event], false);
        });

        var observer = {
            element: element,
            addListener: function addListener(client) {
                // add as client
                clients.push(client);

                // return removeListener function
                return function() {
                    // remove client
                    clients.splice(clients.indexOf(client), 1);

                    // if no more clients, clean up observer
                    if (clients.length === 0) {
                        dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);

                        forin(routes, function(event) {
                            element.removeEventListener(event, handlers[event], false);
                        });
                    }
                };
            },
        };

        return observer;
    };

    var elementFromPoint = function elementFromPoint(root, point) {
        if (!('elementFromPoint' in root)) {
            root = document;
        }
        return root.elementFromPoint(point.x, point.y);
    };

    var isEventTarget = function isEventTarget(e, target) {
        // get root
        var root = getRootNode(target);

        // get element at position
        // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document
        var elementAtPosition = elementFromPoint(root, {
            x: e.pageX - window.pageXOffset,
            y: e.pageY - window.pageYOffset,
        });

        // test if target is the element or if one of its children is
        return elementAtPosition === target || target.contains(elementAtPosition);
    };

    var initialTarget = null;

    var setDropEffect = function setDropEffect(dataTransfer, effect) {
        // is in try catch as IE11 will throw error if not
        try {
            dataTransfer.dropEffect = effect;
        } catch (e) {}
    };

    var dragenter = function dragenter(root, clients) {
        return function(e) {
            e.preventDefault();

            initialTarget = e.target;

            clients.forEach(function(client) {
                var element = client.element,
                    onenter = client.onenter;

                if (isEventTarget(e, element)) {
                    client.state = 'enter';

                    // fire enter event
                    onenter(eventPosition(e));
                }
            });
        };
    };

    var dragover = function dragover(root, clients) {
        return function(e) {
            e.preventDefault();

            var dataTransfer = e.dataTransfer;

            requestDataTransferItems(dataTransfer).then(function(items) {
                var overDropTarget = false;

                clients.some(function(client) {
                    var filterElement = client.filterElement,
                        element = client.element,
                        onenter = client.onenter,
                        onexit = client.onexit,
                        ondrag = client.ondrag,
                        allowdrop = client.allowdrop;

                    // by default we can drop
                    setDropEffect(dataTransfer, 'copy');

                    // allow transfer of these items
                    var allowsTransfer = allowdrop(items);

                    // only used when can be dropped on page
                    if (!allowsTransfer) {
                        setDropEffect(dataTransfer, 'none');
                        return;
                    }

                    // targetting this client
                    if (isEventTarget(e, element)) {
                        overDropTarget = true;

                        // had no previous state, means we are entering this client
                        if (client.state === null) {
                            client.state = 'enter';
                            onenter(eventPosition(e));
                            return;
                        }

                        // now over element (no matter if it allows the drop or not)
                        client.state = 'over';

                        // needs to allow transfer
                        if (filterElement && !allowsTransfer) {
                            setDropEffect(dataTransfer, 'none');
                            return;
                        }

                        // dragging
                        ondrag(eventPosition(e));
                    } else {
                        // should be over an element to drop
                        if (filterElement && !overDropTarget) {
                            setDropEffect(dataTransfer, 'none');
                        }

                        // might have just left this client?
                        if (client.state) {
                            client.state = null;
                            onexit(eventPosition(e));
                        }
                    }
                });
            });
        };
    };

    var drop = function drop(root, clients) {
        return function(e) {
            e.preventDefault();

            var dataTransfer = e.dataTransfer;

            requestDataTransferItems(dataTransfer).then(function(items) {
                clients.forEach(function(client) {
                    var filterElement = client.filterElement,
                        element = client.element,
                        ondrop = client.ondrop,
                        onexit = client.onexit,
                        allowdrop = client.allowdrop;

                    client.state = null;

                    // if we're filtering on element we need to be over the element to drop
                    if (filterElement && !isEventTarget(e, element)) return;

                    // no transfer for this client
                    if (!allowdrop(items)) return onexit(eventPosition(e));

                    // we can drop these items on this client
                    ondrop(eventPosition(e), items);
                });
            });
        };
    };

    var dragleave = function dragleave(root, clients) {
        return function(e) {
            if (initialTarget !== e.target) {
                return;
            }

            clients.forEach(function(client) {
                var onexit = client.onexit;

                client.state = null;

                onexit(eventPosition(e));
            });
        };
    };

    var createHopper = function createHopper(scope, validateItems, options) {
        // is now hopper scope
        scope.classList.add('filepond--hopper');

        // shortcuts
        var catchesDropsOnPage = options.catchesDropsOnPage,
            requiresDropOnElement = options.requiresDropOnElement,
            _options$filterItems = options.filterItems,
            filterItems =
                _options$filterItems === void 0
                    ? function(items) {
                          return items;
                      }
                    : _options$filterItems;

        // create a dnd client
        var client = createDragNDropClient(
            scope,
            catchesDropsOnPage ? document.documentElement : scope,
            requiresDropOnElement
        );

        // current client state
        var lastState = '';
        var currentState = '';

        // determines if a file may be dropped
        client.allowdrop = function(items) {
            // TODO: if we can, throw error to indicate the items cannot by dropped

            return validateItems(filterItems(items));
        };

        client.ondrop = function(position, items) {
            var filteredItems = filterItems(items);

            if (!validateItems(filteredItems)) {
                api.ondragend(position);
                return;
            }

            currentState = 'drag-drop';

            api.onload(filteredItems, position);
        };

        client.ondrag = function(position) {
            api.ondrag(position);
        };

        client.onenter = function(position) {
            currentState = 'drag-over';

            api.ondragstart(position);
        };

        client.onexit = function(position) {
            currentState = 'drag-exit';

            api.ondragend(position);
        };

        var api = {
            updateHopperState: function updateHopperState() {
                if (lastState !== currentState) {
                    scope.dataset.hopperState = currentState;
                    lastState = currentState;
                }
            },
            onload: function onload() {},
            ondragstart: function ondragstart() {},
            ondrag: function ondrag() {},
            ondragend: function ondragend() {},
            destroy: function destroy() {
                // destroy client
                client.destroy();
            },
        };

        return api;
    };

    var listening = false;
    var listeners$1 = [];

    var handlePaste = function handlePaste(e) {
        // if is pasting in input or textarea and the target is outside of a filepond scope, ignore
        var activeEl = document.activeElement;
        if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {
            // test textarea or input is contained in filepond root
            var inScope = false;
            var element = activeEl;
            while (element !== document.body) {
                if (element.classList.contains('filepond--root')) {
                    inScope = true;
                    break;
                }
                element = element.parentNode;
            }

            if (!inScope) return;
        }

        requestDataTransferItems(e.clipboardData).then(function(files) {
            // no files received
            if (!files.length) {
                return;
            }

            // notify listeners of received files
            listeners$1.forEach(function(listener) {
                return listener(files);
            });
        });
    };

    var listen = function listen(cb) {
        // can't add twice
        if (listeners$1.includes(cb)) {
            return;
        }

        // add initial listener
        listeners$1.push(cb);

        // setup paste listener for entire page
        if (listening) {
            return;
        }

        listening = true;
        document.addEventListener('paste', handlePaste);
    };

    var unlisten = function unlisten(listener) {
        arrayRemove(listeners$1, listeners$1.indexOf(listener));

        // clean up
        if (listeners$1.length === 0) {
            document.removeEventListener('paste', handlePaste);
            listening = false;
        }
    };

    var createPaster = function createPaster() {
        var cb = function cb(files) {
            api.onload(files);
        };

        var api = {
            destroy: function destroy() {
                unlisten(cb);
            },
            onload: function onload() {},
        };

        listen(cb);

        return api;
    };

    /**
     * Creates the file view
     */
    var create$d = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        root.element.id = 'filepond--assistant-' + props.id;
        attr(root.element, 'role', 'status');
        attr(root.element, 'aria-live', 'polite');
        attr(root.element, 'aria-relevant', 'additions');
    };

    var addFilesNotificationTimeout = null;
    var notificationClearTimeout = null;

    var filenames = [];

    var assist = function assist(root, message) {
        root.element.textContent = message;
    };

    var clear$1 = function clear(root) {
        root.element.textContent = '';
    };

    var listModified = function listModified(root, filename, label) {
        var total = root.query('GET_TOTAL_ITEMS');
        assist(
            root,
            label +
                ' ' +
                filename +
                ', ' +
                total +
                ' ' +
                (total === 1
                    ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')
                    : root.query('GET_LABEL_FILE_COUNT_PLURAL'))
        );

        // clear group after set amount of time so the status is not read twice
        clearTimeout(notificationClearTimeout);
        notificationClearTimeout = setTimeout(function() {
            clear$1(root);
        }, 1500);
    };

    var isUsingFilePond = function isUsingFilePond(root) {
        return root.element.parentNode.contains(document.activeElement);
    };

    var itemAdded = function itemAdded(_ref2) {
        var root = _ref2.root,
            action = _ref2.action;
        if (!isUsingFilePond(root)) {
            return;
        }

        root.element.textContent = '';
        var item = root.query('GET_ITEM', action.id);
        filenames.push(item.filename);

        clearTimeout(addFilesNotificationTimeout);
        addFilesNotificationTimeout = setTimeout(function() {
            listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));

            filenames.length = 0;
        }, 750);
    };

    var itemRemoved = function itemRemoved(_ref3) {
        var root = _ref3.root,
            action = _ref3.action;
        if (!isUsingFilePond(root)) {
            return;
        }

        var item = action.item;
        listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));
    };

    var itemProcessed = function itemProcessed(_ref4) {
        var root = _ref4.root,
            action = _ref4.action;
        // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file

        var item = root.query('GET_ITEM', action.id);
        var filename = item.filename;
        var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');

        assist(root, filename + ' ' + label);
    };

    var itemProcessedUndo = function itemProcessedUndo(_ref5) {
        var root = _ref5.root,
            action = _ref5.action;
        var item = root.query('GET_ITEM', action.id);
        var filename = item.filename;
        var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');

        assist(root, filename + ' ' + label);
    };

    var itemError = function itemError(_ref6) {
        var root = _ref6.root,
            action = _ref6.action;
        var item = root.query('GET_ITEM', action.id);
        var filename = item.filename;

        // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file

        assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);
    };

    var assistant = createView({
        create: create$d,
        ignoreRect: true,
        ignoreRectUpdate: true,
        write: createRoute({
            DID_LOAD_ITEM: itemAdded,
            DID_REMOVE_ITEM: itemRemoved,
            DID_COMPLETE_ITEM_PROCESSING: itemProcessed,

            DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,
            DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,

            DID_THROW_ITEM_REMOVE_ERROR: itemError,
            DID_THROW_ITEM_LOAD_ERROR: itemError,
            DID_THROW_ITEM_INVALID: itemError,
            DID_THROW_ITEM_PROCESSING_ERROR: itemError,
        }),

        tag: 'span',
        name: 'assistant',
    });

    var toCamels = function toCamels(string) {
        var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';
        return string.replace(new RegExp(separator + '.', 'g'), function(sub) {
            return sub.charAt(1).toUpperCase();
        });
    };

    var debounce = function debounce(func) {
        var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;
        var immidiateOnly =
            arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
        var last = Date.now();
        var timeout = null;

        return function() {
            for (
                var _len = arguments.length, args = new Array(_len), _key = 0;
                _key < _len;
                _key++
            ) {
                args[_key] = arguments[_key];
            }
            clearTimeout(timeout);

            var dist = Date.now() - last;

            var fn = function fn() {
                last = Date.now();
                func.apply(void 0, args);
            };

            if (dist < interval) {
                // we need to delay by the difference between interval and dist
                // for example: if distance is 10 ms and interval is 16 ms,
                // we need to wait an additional 6ms before calling the function)
                if (!immidiateOnly) {
                    timeout = setTimeout(fn, interval - dist);
                }
            } else {
                // go!
                fn();
            }
        };
    };

    var MAX_FILES_LIMIT = 1000000;

    var prevent = function prevent(e) {
        return e.preventDefault();
    };

    var create$e = function create(_ref) {
        var root = _ref.root,
            props = _ref.props;
        // Add id
        var id = root.query('GET_ID');
        if (id) {
            root.element.id = id;
        }

        // Add className
        var className = root.query('GET_CLASS_NAME');
        if (className) {
            className
                .split(' ')
                .filter(function(name) {
                    return name.length;
                })
                .forEach(function(name) {
                    root.element.classList.add(name);
                });
        }

        // Field label
        root.ref.label = root.appendChildView(
            root.createChildView(
                dropLabel,
                Object.assign({}, props, {
                    translateY: null,
                    caption: root.query('GET_LABEL_IDLE'),
                })
            )
        );

        // List of items
        root.ref.list = root.appendChildView(
            root.createChildView(listScroller, { translateY: null })
        );

        // Background panel
        root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'panel-root' }));

        // Assistant notifies assistive tech when content changes
        root.ref.assistant = root.appendChildView(
            root.createChildView(assistant, Object.assign({}, props))
        );

        // Data
        root.ref.data = root.appendChildView(root.createChildView(data, Object.assign({}, props)));

        // Measure (tests if fixed height was set)
        // DOCTYPE needs to be set for this to work
        root.ref.measure = createElement$1('div');
        root.ref.measure.style.height = '100%';
        root.element.appendChild(root.ref.measure);

        // information on the root height or fixed height status
        root.ref.bounds = null;

        // apply initial style properties
        root.query('GET_STYLES')
            .filter(function(style) {
                return !isEmpty(style.value);
            })
            .map(function(_ref2) {
                var name = _ref2.name,
                    value = _ref2.value;
                root.element.dataset[name] = value;
            });

        // determine if width changed
        root.ref.widthPrevious = null;
        root.ref.widthUpdated = debounce(function() {
            root.ref.updateHistory = [];
            root.dispatch('DID_RESIZE_ROOT');
        }, 250);

        // history of updates
        root.ref.previousAspectRatio = null;
        root.ref.updateHistory = [];

        // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)
        var canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;
        var hasPointerEvents = 'PointerEvent' in window;
        if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {
            root.element.addEventListener('touchmove', prevent, { passive: false });
            root.element.addEventListener('gesturestart', prevent);
        }

        // add credits
        var credits = root.query('GET_CREDITS');
        var hasCredits = credits.length === 2;
        if (hasCredits) {
            var frag = document.createElement('a');
            frag.className = 'filepond--credits';
            frag.setAttribute('aria-hidden', 'true');
            frag.href = credits[0];
            frag.tabindex = -1;
            frag.target = '_blank';
            frag.rel = 'noopener noreferrer';
            frag.textContent = credits[1];
            root.element.appendChild(frag);
            root.ref.credits = frag;
        }
    };

    var write$9 = function write(_ref3) {
        var root = _ref3.root,
            props = _ref3.props,
            actions = _ref3.actions;
        // route actions
        route$5({ root: root, props: props, actions: actions });

        // apply style properties
        actions
            .filter(function(action) {
                return /^DID_SET_STYLE_/.test(action.type);
            })
            .filter(function(action) {
                return !isEmpty(action.data.value);
            })
            .map(function(_ref4) {
                var type = _ref4.type,
                    data = _ref4.data;
                var name = toCamels(type.substr(8).toLowerCase(), '_');
                root.element.dataset[name] = data.value;
                root.invalidateLayout();
            });

        if (root.rect.element.hidden) return;

        if (root.rect.element.width !== root.ref.widthPrevious) {
            root.ref.widthPrevious = root.rect.element.width;
            root.ref.widthUpdated();
        }

        // get box bounds, we do this only once
        var bounds = root.ref.bounds;
        if (!bounds) {
            bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);

            // destroy measure element
            root.element.removeChild(root.ref.measure);
            root.ref.measure = null;
        }

        // get quick references to various high level parts of the upload tool
        var _root$ref = root.ref,
            hopper = _root$ref.hopper,
            label = _root$ref.label,
            list = _root$ref.list,
            panel = _root$ref.panel;

        // sets correct state to hopper scope
        if (hopper) {
            hopper.updateHopperState();
        }

        // bool to indicate if we're full or not
        var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');
        var isMultiItem = root.query('GET_ALLOW_MULTIPLE');
        var totalItems = root.query('GET_TOTAL_ITEMS');
        var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;
        var atMaxCapacity = totalItems === maxItems;

        // action used to add item
        var addAction = actions.find(function(action) {
            return action.type === 'DID_ADD_ITEM';
        });

        // if reached max capacity and we've just reached it
        if (atMaxCapacity && addAction) {
            // get interaction type
            var interactionMethod = addAction.data.interactionMethod;

            // hide label
            label.opacity = 0;

            if (isMultiItem) {
                label.translateY = -40;
            } else {
                if (interactionMethod === InteractionMethod.API) {
                    label.translateX = 40;
                } else if (interactionMethod === InteractionMethod.BROWSE) {
                    label.translateY = 40;
                } else {
                    label.translateY = 30;
                }
            }
        } else if (!atMaxCapacity) {
            label.opacity = 1;
            label.translateX = 0;
            label.translateY = 0;
        }

        var listItemMargin = calculateListItemMargin(root);

        var listHeight = calculateListHeight(root);

        var labelHeight = label.rect.element.height;
        var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;

        var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;
        var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;

        var visualHeight =
            currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;
        var boundsHeight =
            currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;

        // link list to label bottom position
        list.translateY =
            Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;

        if (aspectRatio) {
            // fixed aspect ratio

            // calculate height based on width
            var width = root.rect.element.width;
            var height = width * aspectRatio;

            // clear history if aspect ratio has changed
            if (aspectRatio !== root.ref.previousAspectRatio) {
                root.ref.previousAspectRatio = aspectRatio;
                root.ref.updateHistory = [];
            }

            // remember this width
            var history = root.ref.updateHistory;
            history.push(width);

            var MAX_BOUNCES = 2;
            if (history.length > MAX_BOUNCES * 2) {
                var l = history.length;
                var bottom = l - 10;
                var bounces = 0;
                for (var i = l; i >= bottom; i--) {
                    if (history[i] === history[i - 2]) {
                        bounces++;
                    }

                    if (bounces >= MAX_BOUNCES) {
                        // dont adjust height
                        return;
                    }
                }
            }

            // fix height of panel so it adheres to aspect ratio
            panel.scalable = false;
            panel.height = height;

            // available height for list
            var listAvailableHeight =
                // the height of the panel minus the label height
                height -
                currentLabelHeight -
                // the room we leave open between the end of the list and the panel bottom
                (listMarginBottom - listItemMargin.bottom) -
                // if we're full we need to leave some room between the top of the panel and the list
                (atMaxCapacity ? listMarginTop : 0);

            if (listHeight.visual > listAvailableHeight) {
                list.overflow = listAvailableHeight;
            } else {
                list.overflow = null;
            }

            // set container bounds (so pushes siblings downwards)
            root.height = height;
        } else if (bounds.fixedHeight) {
            // fixed height

            // fix height of panel
            panel.scalable = false;

            // available height for list
            var _listAvailableHeight =
                // the height of the panel minus the label height
                bounds.fixedHeight -
                currentLabelHeight -
                // the room we leave open between the end of the list and the panel bottom
                (listMarginBottom - listItemMargin.bottom) -
                // if we're full we need to leave some room between the top of the panel and the list
                (atMaxCapacity ? listMarginTop : 0);

            // set list height
            if (listHeight.visual > _listAvailableHeight) {
                list.overflow = _listAvailableHeight;
            } else {
                list.overflow = null;
            }

            // no need to set container bounds as these are handles by CSS fixed height
        } else if (bounds.cappedHeight) {
            // max-height

            // not a fixed height panel
            var isCappedHeight = visualHeight >= bounds.cappedHeight;
            var panelHeight = Math.min(bounds.cappedHeight, visualHeight);
            panel.scalable = true;
            panel.height = isCappedHeight
                ? panelHeight
                : panelHeight - listItemMargin.top - listItemMargin.bottom;

            // available height for list
            var _listAvailableHeight2 =
                // the height of the panel minus the label height
                panelHeight -
                currentLabelHeight -
                // the room we leave open between the end of the list and the panel bottom
                (listMarginBottom - listItemMargin.bottom) -
                // if we're full we need to leave some room between the top of the panel and the list
                (atMaxCapacity ? listMarginTop : 0);

            // set list height (if is overflowing)
            if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {
                list.overflow = _listAvailableHeight2;
            } else {
                list.overflow = null;
            }

            // set container bounds (so pushes siblings downwards)
            root.height = Math.min(
                bounds.cappedHeight,
                boundsHeight - listItemMargin.top - listItemMargin.bottom
            );
        } else {
            // flexible height

            // not a fixed height panel
            var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;
            panel.scalable = true;
            panel.height = Math.max(labelHeight, visualHeight - itemMargin);

            // set container bounds (so pushes siblings downwards)
            root.height = Math.max(labelHeight, boundsHeight - itemMargin);
        }

        // move credits to bottom
        if (root.ref.credits && panel.heightCurrent)
            root.ref.credits.style.transform = 'translateY(' + panel.heightCurrent + 'px)';
    };

    var calculateListItemMargin = function calculateListItemMargin(root) {
        var item = root.ref.list.childViews[0].childViews[0];
        return item
            ? {
                  top: item.rect.element.marginTop,
                  bottom: item.rect.element.marginBottom,
              }
            : {
                  top: 0,
                  bottom: 0,
              };
    };

    var calculateListHeight = function calculateListHeight(root) {
        var visual = 0;
        var bounds = 0;

        // get file list reference
        var scrollList = root.ref.list;
        var itemList = scrollList.childViews[0];
        var visibleChildren = itemList.childViews.filter(function(child) {
            return child.rect.element.height;
        });
        var children = root
            .query('GET_ACTIVE_ITEMS')
            .map(function(item) {
                return visibleChildren.find(function(child) {
                    return child.id === item.id;
                });
            })
            .filter(function(item) {
                return item;
            });

        // no children, done!
        if (children.length === 0) return { visual: visual, bounds: bounds };

        var horizontalSpace = itemList.rect.element.width;
        var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);

        var childRect = children[0].rect.element;

        var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;
        var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;

        var itemWidth = childRect.width + itemHorizontalMargin;
        var itemHeight = childRect.height + itemVerticalMargin;

        var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;
        var removedItem = children.find(function(child) {
            return child.markedForRemoval && child.opacity < 0.45;
        })
            ? -1
            : 0;
        var verticalItemCount = children.length + newItem + removedItem;
        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);

        // stack
        if (itemsPerRow === 1) {
            children.forEach(function(item) {
                var height = item.rect.element.height + itemVerticalMargin;
                bounds += height;
                visual += height * item.opacity;
            });
        }
        // grid
        else {
            bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;
            visual = bounds;
        }

        return { visual: visual, bounds: bounds };
    };

    var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {
        var height = root.ref.measureHeight || null;
        var cappedHeight = parseInt(root.style.maxHeight, 10) || null;
        var fixedHeight = height === 0 ? null : height;

        return {
            cappedHeight: cappedHeight,
            fixedHeight: fixedHeight,
        };
    };

    var exceedsMaxFiles = function exceedsMaxFiles(root, items) {
        var allowReplace = root.query('GET_ALLOW_REPLACE');
        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');
        var totalItems = root.query('GET_TOTAL_ITEMS');
        var maxItems = root.query('GET_MAX_FILES');

        // total amount of items being dragged
        var totalBrowseItems = items.length;

        // if does not allow multiple items and dragging more than one item
        if (!allowMultiple && totalBrowseItems > 1) {
            return true;
        }

        // limit max items to one if not allowed to drop multiple items
        maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;

        // no more room?
        var hasMaxItems = isInt(maxItems);
        if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {
            root.dispatch('DID_THROW_MAX_FILES', {
                source: items,
                error: createResponse('warning', 0, 'Max files'),
            });

            return true;
        }

        return false;
    };

    var getDragIndex = function getDragIndex(list, children, position) {
        var itemList = list.childViews[0];
        return getItemIndexByPosition(itemList, children, {
            left: position.scopeLeft - itemList.rect.element.left,
            top:
                position.scopeTop -
                (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop),
        });
    };

    /**
     * Enable or disable file drop functionality
     */
    var toggleDrop = function toggleDrop(root) {
        var isAllowed = root.query('GET_ALLOW_DROP');
        var isDisabled = root.query('GET_DISABLED');
        var enabled = isAllowed && !isDisabled;
        if (enabled && !root.ref.hopper) {
            var hopper = createHopper(
                root.element,
                function(items) {
                    // allow quick validation of dropped items
                    var beforeDropFile =
                        root.query('GET_BEFORE_DROP_FILE') ||
                        function() {
                            return true;
                        };

                    // all items should be validated by all filters as valid
                    var dropValidation = root.query('GET_DROP_VALIDATION');
                    return dropValidation
                        ? items.every(function(item) {
                              return (
                                  applyFilters('ALLOW_HOPPER_ITEM', item, {
                                      query: root.query,
                                  }).every(function(result) {
                                      return result === true;
                                  }) && beforeDropFile(item)
                              );
                          })
                        : true;
                },
                {
                    filterItems: function filterItems(items) {
                        var ignoredFiles = root.query('GET_IGNORED_FILES');
                        return items.filter(function(item) {
                            if (isFile(item)) {
                                return !ignoredFiles.includes(item.name.toLowerCase());
                            }
                            return true;
                        });
                    },
                    catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),
                    requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT'),
                }
            );

            hopper.onload = function(items, position) {
                // get item children elements and sort based on list sort
                var list = root.ref.list.childViews[0];
                var visibleChildren = list.childViews.filter(function(child) {
                    return child.rect.element.height;
                });
                var children = root
                    .query('GET_ACTIVE_ITEMS')
                    .map(function(item) {
                        return visibleChildren.find(function(child) {
                            return child.id === item.id;
                        });
                    })
                    .filter(function(item) {
                        return item;
                    });

                applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(function(
                    queue
                ) {
                    // these files don't fit so stop here
                    if (exceedsMaxFiles(root, queue)) return false;

                    // go
                    root.dispatch('ADD_ITEMS', {
                        items: queue,
                        index: getDragIndex(root.ref.list, children, position),
                        interactionMethod: InteractionMethod.DROP,
                    });
                });

                root.dispatch('DID_DROP', { position: position });

                root.dispatch('DID_END_DRAG', { position: position });
            };

            hopper.ondragstart = function(position) {
                root.dispatch('DID_START_DRAG', { position: position });
            };

            hopper.ondrag = debounce(function(position) {
                root.dispatch('DID_DRAG', { position: position });
            });

            hopper.ondragend = function(position) {
                root.dispatch('DID_END_DRAG', { position: position });
            };

            root.ref.hopper = hopper;

            root.ref.drip = root.appendChildView(root.createChildView(drip));
        } else if (!enabled && root.ref.hopper) {
            root.ref.hopper.destroy();
            root.ref.hopper = null;
            root.removeChildView(root.ref.drip);
        }
    };

    /**
     * Enable or disable browse functionality
     */
    var toggleBrowse = function toggleBrowse(root, props) {
        var isAllowed = root.query('GET_ALLOW_BROWSE');
        var isDisabled = root.query('GET_DISABLED');
        var enabled = isAllowed && !isDisabled;
        if (enabled && !root.ref.browser) {
            root.ref.browser = root.appendChildView(
                root.createChildView(
                    browser,
                    Object.assign({}, props, {
                        onload: function onload(items) {
                            applyFilterChain('ADD_ITEMS', items, {
                                dispatch: root.dispatch,
                            }).then(function(queue) {
                                // these files don't fit so stop here
                                if (exceedsMaxFiles(root, queue)) return false;

                                // add items!
                                root.dispatch('ADD_ITEMS', {
                                    items: queue,
                                    index: -1,
                                    interactionMethod: InteractionMethod.BROWSE,
                                });
                            });
                        },
                    })
                ),

                0
            );
        } else if (!enabled && root.ref.browser) {
            root.removeChildView(root.ref.browser);
            root.ref.browser = null;
        }
    };

    /**
     * Enable or disable paste functionality
     */
    var togglePaste = function togglePaste(root) {
        var isAllowed = root.query('GET_ALLOW_PASTE');
        var isDisabled = root.query('GET_DISABLED');
        var enabled = isAllowed && !isDisabled;
        if (enabled && !root.ref.paster) {
            root.ref.paster = createPaster();
            root.ref.paster.onload = function(items) {
                applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(function(
                    queue
                ) {
                    // these files don't fit so stop here
                    if (exceedsMaxFiles(root, queue)) return false;

                    // add items!
                    root.dispatch('ADD_ITEMS', {
                        items: queue,
                        index: -1,
                        interactionMethod: InteractionMethod.PASTE,
                    });
                });
            };
        } else if (!enabled && root.ref.paster) {
            root.ref.paster.destroy();
            root.ref.paster = null;
        }
    };

    /**
     * Route actions
     */
    var route$5 = createRoute({
        DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {
            var root = _ref5.root,
                props = _ref5.props;
            toggleBrowse(root, props);
        },
        DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {
            var root = _ref6.root;
            toggleDrop(root);
        },
        DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {
            var root = _ref7.root;
            togglePaste(root);
        },
        DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {
            var root = _ref8.root,
                props = _ref8.props;
            toggleDrop(root);
            togglePaste(root);
            toggleBrowse(root, props);
            var isDisabled = root.query('GET_DISABLED');
            if (isDisabled) {
                root.element.dataset.disabled = 'disabled';
            } else {
                // delete root.element.dataset.disabled; <= this does not work on iOS 10
                root.element.removeAttribute('data-disabled');
            }
        },
    });

    var root = createView({
        name: 'root',
        read: function read(_ref9) {
            var root = _ref9.root;
            if (root.ref.measure) {
                root.ref.measureHeight = root.ref.measure.offsetHeight;
            }
        },
        create: create$e,
        write: write$9,
        destroy: function destroy(_ref10) {
            var root = _ref10.root;
            if (root.ref.paster) {
                root.ref.paster.destroy();
            }
            if (root.ref.hopper) {
                root.ref.hopper.destroy();
            }
            root.element.removeEventListener('touchmove', prevent);
            root.element.removeEventListener('gesturestart', prevent);
        },
        mixins: {
            styles: ['height'],
        },
    });

    // creates the app
    var createApp = function createApp() {
        var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        // let element
        var originalElement = null;

        // get default options
        var defaultOptions = getOptions();

        // create the data store, this will contain all our app info
        var store = createStore(
            // initial state (should be serializable)
            createInitialState(defaultOptions),

            // queries
            [queries, createOptionQueries(defaultOptions)],

            // action handlers
            [actions, createOptionActions(defaultOptions)]
        );

        // set initial options
        store.dispatch('SET_OPTIONS', { options: initialOptions });

        // kick thread if visibility changes
        var visibilityHandler = function visibilityHandler() {
            if (document.hidden) return;
            store.dispatch('KICK');
        };
        document.addEventListener('visibilitychange', visibilityHandler);

        // re-render on window resize start and finish
        var resizeDoneTimer = null;
        var isResizing = false;
        var isResizingHorizontally = false;
        var initialWindowWidth = null;
        var currentWindowWidth = null;
        var resizeHandler = function resizeHandler() {
            if (!isResizing) {
                isResizing = true;
            }
            clearTimeout(resizeDoneTimer);
            resizeDoneTimer = setTimeout(function() {
                isResizing = false;
                initialWindowWidth = null;
                currentWindowWidth = null;
                if (isResizingHorizontally) {
                    isResizingHorizontally = false;
                    store.dispatch('DID_STOP_RESIZE');
                }
            }, 500);
        };
        window.addEventListener('resize', resizeHandler);

        // render initial view
        var view = root(store, { id: getUniqueId() });

        //
        // PRIVATE API -------------------------------------------------------------------------------------
        //
        var isResting = false;
        var isHidden = false;

        var readWriteApi = {
            // necessary for update loop

            /**
             * Reads from dom (never call manually)
             * @private
             */
            _read: function _read() {
                // test if we're resizing horizontally
                // TODO: see if we can optimize this by measuring root rect
                if (isResizing) {
                    currentWindowWidth = window.innerWidth;
                    if (!initialWindowWidth) {
                        initialWindowWidth = currentWindowWidth;
                    }

                    if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {
                        store.dispatch('DID_START_RESIZE');
                        isResizingHorizontally = true;
                    }
                }

                if (isHidden && isResting) {
                    // test if is no longer hidden
                    isResting = view.element.offsetParent === null;
                }

                // if resting, no need to read as numbers will still all be correct
                if (isResting) return;

                // read view data
                view._read();

                // if is hidden we need to know so we exit rest mode when revealed
                isHidden = view.rect.element.hidden;
            },

            /**
             * Writes to dom (never call manually)
             * @private
             */
            _write: function _write(ts) {
                // get all actions from store
                var actions = store
                    .processActionQueue()

                    // filter out set actions (these will automatically trigger DID_SET)
                    .filter(function(action) {
                        return !/^SET_/.test(action.type);
                    });

                // if was idling and no actions stop here
                if (isResting && !actions.length) return;

                // some actions might trigger events
                routeActionsToEvents(actions);

                // update the view
                isResting = view._write(ts, actions, isResizingHorizontally);

                // will clean up all archived items
                removeReleasedItems(store.query('GET_ITEMS'));

                // now idling
                if (isResting) {
                    store.processDispatchQueue();
                }
            },
        };

        //
        // EXPOSE EVENTS -------------------------------------------------------------------------------------
        //
        var createEvent = function createEvent(name) {
            return function(data) {
                // create default event
                var event = {
                    type: name,
                };

                // no data to add
                if (!data) {
                    return event;
                }

                // copy relevant props
                if (data.hasOwnProperty('error')) {
                    event.error = data.error ? Object.assign({}, data.error) : null;
                }

                if (data.status) {
                    event.status = Object.assign({}, data.status);
                }

                if (data.file) {
                    event.output = data.file;
                }

                // only source is available, else add item if possible
                if (data.source) {
                    event.file = data.source;
                } else if (data.item || data.id) {
                    var item = data.item ? data.item : store.query('GET_ITEM', data.id);
                    event.file = item ? createItemAPI(item) : null;
                }

                // map all items in a possible items array
                if (data.items) {
                    event.items = data.items.map(createItemAPI);
                }

                // if this is a progress event add the progress amount
                if (/progress/.test(name)) {
                    event.progress = data.progress;
                }

                // copy relevant props
                if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {
                    event.origin = data.origin;
                    event.target = data.target;
                }

                return event;
            };
        };

        var eventRoutes = {
            DID_DESTROY: createEvent('destroy'),

            DID_INIT: createEvent('init'),

            DID_THROW_MAX_FILES: createEvent('warning'),

            DID_INIT_ITEM: createEvent('initfile'),
            DID_START_ITEM_LOAD: createEvent('addfilestart'),
            DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),
            DID_LOAD_ITEM: createEvent('addfile'),

            DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],

            DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],

            DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],

            DID_PREPARE_OUTPUT: createEvent('preparefile'),

            DID_START_ITEM_PROCESSING: createEvent('processfilestart'),
            DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),
            DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),
            DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),
            DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),
            DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),

            DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],

            DID_REMOVE_ITEM: createEvent('removefile'),

            DID_UPDATE_ITEMS: createEvent('updatefiles'),

            DID_ACTIVATE_ITEM: createEvent('activatefile'),

            DID_REORDER_ITEMS: createEvent('reorderfiles'),
        };

        var exposeEvent = function exposeEvent(event) {
            // create event object to be dispatched
            var detail = Object.assign({ pond: exports }, event);
            delete detail.type;
            view.element.dispatchEvent(
                new CustomEvent('FilePond:' + event.type, {
                    // event info
                    detail: detail,

                    // event behaviour
                    bubbles: true,
                    cancelable: true,
                    composed: true, // triggers listeners outside of shadow root
                })
            );

            // event object to params used for `on()` event handlers and callbacks `oninit()`
            var params = [];

            // if is possible error event, make it the first param
            if (event.hasOwnProperty('error')) {
                params.push(event.error);
            }

            // file is always section
            if (event.hasOwnProperty('file')) {
                params.push(event.file);
            }

            // append other props
            var filtered = ['type', 'error', 'file'];
            Object.keys(event)
                .filter(function(key) {
                    return !filtered.includes(key);
                })
                .forEach(function(key) {
                    return params.push(event[key]);
                });

            // on(type, () => { })
            exports.fire.apply(exports, [event.type].concat(params));

            // oninit = () => {}
            var handler = store.query('GET_ON' + event.type.toUpperCase());
            if (handler) {
                handler.apply(void 0, params);
            }
        };

        var routeActionsToEvents = function routeActionsToEvents(actions) {
            if (!actions.length) return;
            actions
                .filter(function(action) {
                    return eventRoutes[action.type];
                })
                .forEach(function(action) {
                    var routes = eventRoutes[action.type];
                    (Array.isArray(routes) ? routes : [routes]).forEach(function(route) {
                        // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init
                        if (action.type === 'DID_INIT_ITEM') {
                            exposeEvent(route(action.data));
                        } else {
                            setTimeout(function() {
                                exposeEvent(route(action.data));
                            }, 0);
                        }
                    });
                });
        };

        //
        // PUBLIC API -------------------------------------------------------------------------------------
        //
        var setOptions = function setOptions(options) {
            return store.dispatch('SET_OPTIONS', { options: options });
        };

        var getFile = function getFile(query) {
            return store.query('GET_ACTIVE_ITEM', query);
        };

        var prepareFile = function prepareFile(query) {
            return new Promise(function(resolve, reject) {
                store.dispatch('REQUEST_ITEM_PREPARE', {
                    query: query,
                    success: function success(item) {
                        resolve(item);
                    },
                    failure: function failure(error) {
                        reject(error);
                    },
                });
            });
        };

        var addFile = function addFile(source) {
            var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
            return new Promise(function(resolve, reject) {
                addFiles([{ source: source, options: options }], { index: options.index })
                    .then(function(items) {
                        return resolve(items && items[0]);
                    })
                    .catch(reject);
            });
        };

        var isFilePondFile = function isFilePondFile(obj) {
            return obj.file && obj.id;
        };

        var removeFile = function removeFile(query, options) {
            // if only passed options
            if (typeof query === 'object' && !isFilePondFile(query) && !options) {
                options = query;
                query = undefined;
            }

            // request item removal
            store.dispatch('REMOVE_ITEM', Object.assign({}, options, { query: query }));

            // see if item has been removed
            return store.query('GET_ACTIVE_ITEM', query) === null;
        };

        var addFiles = function addFiles() {
            for (
                var _len = arguments.length, args = new Array(_len), _key = 0;
                _key < _len;
                _key++
            ) {
                args[_key] = arguments[_key];
            }
            return new Promise(function(resolve, reject) {
                var sources = [];
                var options = {};

                // user passed a sources array
                if (isArray(args[0])) {
                    sources.push.apply(sources, args[0]);
                    Object.assign(options, args[1] || {});
                } else {
                    // user passed sources as arguments, last one might be options object
                    var lastArgument = args[args.length - 1];
                    if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {
                        Object.assign(options, args.pop());
                    }

                    // add rest to sources
                    sources.push.apply(sources, args);
                }

                store.dispatch('ADD_ITEMS', {
                    items: sources,
                    index: options.index,
                    interactionMethod: InteractionMethod.API,
                    success: resolve,
                    failure: reject,
                });
            });
        };

        var getFiles = function getFiles() {
            return store.query('GET_ACTIVE_ITEMS');
        };

        var processFile = function processFile(query) {
            return new Promise(function(resolve, reject) {
                store.dispatch('REQUEST_ITEM_PROCESSING', {
                    query: query,
                    success: function success(item) {
                        resolve(item);
                    },
                    failure: function failure(error) {
                        reject(error);
                    },
                });
            });
        };

        var prepareFiles = function prepareFiles() {
            for (
                var _len2 = arguments.length, args = new Array(_len2), _key2 = 0;
                _key2 < _len2;
                _key2++
            ) {
                args[_key2] = arguments[_key2];
            }
            var queries = Array.isArray(args[0]) ? args[0] : args;
            var items = queries.length ? queries : getFiles();
            return Promise.all(items.map(prepareFile));
        };

        var processFiles = function processFiles() {
            for (
                var _len3 = arguments.length, args = new Array(_len3), _key3 = 0;
                _key3 < _len3;
                _key3++
            ) {
                args[_key3] = arguments[_key3];
            }
            var queries = Array.isArray(args[0]) ? args[0] : args;
            if (!queries.length) {
                var files = getFiles().filter(function(item) {
                    return (
                        !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) &&
                        item.status !== ItemStatus.PROCESSING &&
                        item.status !== ItemStatus.PROCESSING_COMPLETE &&
                        item.status !== ItemStatus.PROCESSING_REVERT_ERROR
                    );
                });

                return Promise.all(files.map(processFile));
            }
            return Promise.all(queries.map(processFile));
        };

        var removeFiles = function removeFiles() {
            for (
                var _len4 = arguments.length, args = new Array(_len4), _key4 = 0;
                _key4 < _len4;
                _key4++
            ) {
                args[_key4] = arguments[_key4];
            }

            var queries = Array.isArray(args[0]) ? args[0] : args;

            var options;
            if (typeof queries[queries.length - 1] === 'object') {
                options = queries.pop();
            } else if (Array.isArray(args[0])) {
                options = args[1];
            }

            var files = getFiles();

            if (!queries.length)
                return Promise.all(
                    files.map(function(file) {
                        return removeFile(file, options);
                    })
                );

            // when removing by index the indexes shift after each file removal so we need to convert indexes to ids
            var mappedQueries = queries
                .map(function(query) {
                    return isNumber(query) ? (files[query] ? files[query].id : null) : query;
                })
                .filter(function(query) {
                    return query;
                });

            return mappedQueries.map(function(q) {
                return removeFile(q, options);
            });
        };

        var exports = Object.assign(
            {},

            on(),
            {},

            readWriteApi,
            {},

            createOptionAPI(store, defaultOptions),
            {
                /**
                 * Override options defined in options object
                 * @param options
                 */
                setOptions: setOptions,

                /**
                 * Load the given file
                 * @param source - the source of the file (either a File, base64 data uri or url)
                 * @param options - object, { index: 0 }
                 */
                addFile: addFile,

                /**
                 * Load the given files
                 * @param sources - the sources of the files to load
                 * @param options - object, { index: 0 }
                 */
                addFiles: addFiles,

                /**
                 * Returns the file objects matching the given query
                 * @param query { string, number, null }
                 */
                getFile: getFile,

                /**
                 * Upload file with given name
                 * @param query { string, number, null  }
                 */
                processFile: processFile,

                /**
                 * Request prepare output for file with given name
                 * @param query { string, number, null  }
                 */
                prepareFile: prepareFile,

                /**
                 * Removes a file by its name
                 * @param query { string, number, null  }
                 */
                removeFile: removeFile,

                /**
                 * Moves a file to a new location in the files list
                 */
                moveFile: function moveFile(query, index) {
                    return store.dispatch('MOVE_ITEM', { query: query, index: index });
                },

                /**
                 * Returns all files (wrapped in public api)
                 */
                getFiles: getFiles,

                /**
                 * Starts uploading all files
                 */
                processFiles: processFiles,

                /**
                 * Clears all files from the files list
                 */
                removeFiles: removeFiles,

                /**
                 * Starts preparing output of all files
                 */
                prepareFiles: prepareFiles,

                /**
                 * Sort list of files
                 */
                sort: function sort(compare) {
                    return store.dispatch('SORT', { compare: compare });
                },

                /**
                 * Browse the file system for a file
                 */
                browse: function browse() {
                    // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)
                    var input = view.element.querySelector('input[type=file]');
                    if (input) {
                        input.click();
                    }
                },

                /**
                 * Destroys the app
                 */
                destroy: function destroy() {
                    // request destruction
                    exports.fire('destroy', view.element);

                    // stop active processes (file uploads, fetches, stuff like that)
                    // loop over items and depending on states call abort for ongoing processes
                    store.dispatch('ABORT_ALL');

                    // destroy view
                    view._destroy();

                    // stop listening to resize
                    window.removeEventListener('resize', resizeHandler);

                    // stop listening to the visiblitychange event
                    document.removeEventListener('visibilitychange', visibilityHandler);

                    // dispatch destroy
                    store.dispatch('DID_DESTROY');
                },

                /**
                 * Inserts the plugin before the target element
                 */
                insertBefore: function insertBefore$1(element) {
                    return insertBefore(view.element, element);
                },

                /**
                 * Inserts the plugin after the target element
                 */
                insertAfter: function insertAfter$1(element) {
                    return insertAfter(view.element, element);
                },

                /**
                 * Appends the plugin to the target element
                 */
                appendTo: function appendTo(element) {
                    return element.appendChild(view.element);
                },

                /**
                 * Replaces an element with the app
                 */
                replaceElement: function replaceElement(element) {
                    // insert the app before the element
                    insertBefore(view.element, element);

                    // remove the original element
                    element.parentNode.removeChild(element);

                    // remember original element
                    originalElement = element;
                },

                /**
                 * Restores the original element
                 */
                restoreElement: function restoreElement() {
                    if (!originalElement) {
                        return; // no element to restore
                    }

                    // restore original element
                    insertAfter(originalElement, view.element);

                    // remove our element
                    view.element.parentNode.removeChild(view.element);

                    // remove reference
                    originalElement = null;
                },

                /**
                 * Returns true if the app root is attached to given element
                 * @param element
                 */
                isAttachedTo: function isAttachedTo(element) {
                    return view.element === element || originalElement === element;
                },

                /**
                 * Returns the root element
                 */
                element: {
                    get: function get() {
                        return view.element;
                    },
                },

                /**
                 * Returns the current pond status
                 */
                status: {
                    get: function get() {
                        return store.query('GET_STATUS');
                    },
                },
            }
        );

        // Done!
        store.dispatch('DID_INIT');

        // create actual api object
        return createObject(exports);
    };

    var createAppObject = function createAppObject() {
        var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        // default options
        var defaultOptions = {};
        forin(getOptions(), function(key, value) {
            defaultOptions[key] = value[0];
        });

        // set app options
        var app = createApp(
            Object.assign(
                {},

                defaultOptions,
                {},

                customOptions
            )
        );

        // return the plugin instance
        return app;
    };

    var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {
        return string.charAt(0).toLowerCase() + string.slice(1);
    };

    var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {
        return toCamels(attributeName.replace(/^data-/, ''));
    };

    var mapObject = function mapObject(object, propertyMap) {
        // remove unwanted
        forin(propertyMap, function(selector, mapping) {
            forin(object, function(property, value) {
                // create regexp shortcut
                var selectorRegExp = new RegExp(selector);

                // tests if
                var matches = selectorRegExp.test(property);

                // no match, skip
                if (!matches) {
                    return;
                }

                // if there's a mapping, the original property is always removed
                delete object[property];

                // should only remove, we done!
                if (mapping === false) {
                    return;
                }

                // move value to new property
                if (isString(mapping)) {
                    object[mapping] = value;
                    return;
                }

                // move to group
                var group = mapping.group;
                if (isObject(mapping) && !object[group]) {
                    object[group] = {};
                }

                object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;
            });

            // do submapping
            if (mapping.mapping) {
                mapObject(object[mapping.group], mapping.mapping);
            }
        });
    };

    var getAttributesAsObject = function getAttributesAsObject(node) {
        var attributeMapping =
            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        // turn attributes into object
        var attributes = [];
        forin(node.attributes, function(index) {
            attributes.push(node.attributes[index]);
        });

        var output = attributes
            .filter(function(attribute) {
                return attribute.name;
            })
            .reduce(function(obj, attribute) {
                var value = attr(node, attribute.name);

                obj[attributeNameToPropertyName(attribute.name)] =
                    value === attribute.name ? true : value;
                return obj;
            }, {});

        // do mapping of object properties
        mapObject(output, attributeMapping);

        return output;
    };

    var createAppAtElement = function createAppAtElement(element) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        // how attributes of the input element are mapped to the options for the plugin
        var attributeMapping = {
            // translate to other name
            '^class$': 'className',
            '^multiple$': 'allowMultiple',
            '^capture$': 'captureMethod',
            '^webkitdirectory$': 'allowDirectoriesOnly',

            // group under single property
            '^server': {
                group: 'server',
                mapping: {
                    '^process': {
                        group: 'process',
                    },

                    '^revert': {
                        group: 'revert',
                    },

                    '^fetch': {
                        group: 'fetch',
                    },

                    '^restore': {
                        group: 'restore',
                    },

                    '^load': {
                        group: 'load',
                    },
                },
            },

            // don't include in object
            '^type$': false,
            '^files$': false,
        };

        // add additional option translators
        applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);

        // create final options object by setting options object and then overriding options supplied on element
        var mergedOptions = Object.assign({}, options);

        var attributeOptions = getAttributesAsObject(
            element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element,
            attributeMapping
        );

        // merge with options object
        Object.keys(attributeOptions).forEach(function(key) {
            if (isObject(attributeOptions[key])) {
                if (!isObject(mergedOptions[key])) {
                    mergedOptions[key] = {};
                }
                Object.assign(mergedOptions[key], attributeOptions[key]);
            } else {
                mergedOptions[key] = attributeOptions[key];
            }
        });

        // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields
        // these will then be automatically set to the initial files
        mergedOptions.files = (options.files || []).concat(
            Array.from(element.querySelectorAll('input:not([type=file])')).map(function(input) {
                return {
                    source: input.value,
                    options: {
                        type: input.dataset.type,
                    },
                };
            })
        );

        // build plugin
        var app = createAppObject(mergedOptions);

        // add already selected files
        if (element.files) {
            Array.from(element.files).forEach(function(file) {
                app.addFile(file);
            });
        }

        // replace the target element
        app.replaceElement(element);

        // expose
        return app;
    };

    // if an element is passed, we create the instance at that element, if not, we just create an up object
    var createApp$1 = function createApp() {
        return isNode(arguments.length <= 0 ? undefined : arguments[0])
            ? createAppAtElement.apply(void 0, arguments)
            : createAppObject.apply(void 0, arguments);
    };

    var PRIVATE_METHODS = ['fire', '_read', '_write'];

    var createAppAPI = function createAppAPI(app) {
        var api = {};

        copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);

        return api;
    };

    /**
     * Replaces placeholders in given string with replacements
     * @param string - "Foo {bar}""
     * @param replacements - { "bar": 10 }
     */
    var replaceInString = function replaceInString(string, replacements) {
        return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {
            return replacements[group];
        });
    };

    var createWorker = function createWorker(fn) {
        var workerBlob = new Blob(['(', fn.toString(), ')()'], {
            type: 'application/javascript',
        });

        var workerURL = URL.createObjectURL(workerBlob);
        var worker = new Worker(workerURL);

        return {
            transfer: function transfer(message, cb) {},
            post: function post(message, cb, transferList) {
                var id = getUniqueId();

                worker.onmessage = function(e) {
                    if (e.data.id === id) {
                        cb(e.data.message);
                    }
                };

                worker.postMessage(
                    {
                        id: id,
                        message: message,
                    },

                    transferList
                );
            },
            terminate: function terminate() {
                worker.terminate();
                URL.revokeObjectURL(workerURL);
            },
        };
    };

    var loadImage = function loadImage(url) {
        return new Promise(function(resolve, reject) {
            var img = new Image();
            img.onload = function() {
                resolve(img);
            };
            img.onerror = function(e) {
                reject(e);
            };
            img.src = url;
        });
    };

    var renameFile = function renameFile(file, name) {
        var renamedFile = file.slice(0, file.size, file.type);
        renamedFile.lastModifiedDate = file.lastModifiedDate;
        renamedFile.name = name;
        return renamedFile;
    };

    var copyFile = function copyFile(file) {
        return renameFile(file, file.name);
    };

    // already registered plugins (can't register twice)
    var registeredPlugins = [];

    // pass utils to plugin
    var createAppPlugin = function createAppPlugin(plugin) {
        // already registered
        if (registeredPlugins.includes(plugin)) {
            return;
        }

        // remember this plugin
        registeredPlugins.push(plugin);

        // setup!
        var pluginOutline = plugin({
            addFilter: addFilter,
            utils: {
                Type: Type,
                forin: forin,
                isString: isString,
                isFile: isFile,
                toNaturalFileSize: toNaturalFileSize,
                replaceInString: replaceInString,
                getExtensionFromFilename: getExtensionFromFilename,
                getFilenameWithoutExtension: getFilenameWithoutExtension,
                guesstimateMimeType: guesstimateMimeType,
                getFileFromBlob: getFileFromBlob,
                getFilenameFromURL: getFilenameFromURL,
                createRoute: createRoute,
                createWorker: createWorker,
                createView: createView,
                createItemAPI: createItemAPI,
                loadImage: loadImage,
                copyFile: copyFile,
                renameFile: renameFile,
                createBlob: createBlob,
                applyFilterChain: applyFilterChain,
                text: text,
                getNumericAspectRatioFromString: getNumericAspectRatioFromString,
            },

            views: {
                fileActionButton: fileActionButton,
            },
        });

        // add plugin options to default options
        extendDefaultOptions(pluginOutline.options);
    };

    // feature detection used by supported() method
    var isOperaMini = function isOperaMini() {
        return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';
    };
    var hasPromises = function hasPromises() {
        return 'Promise' in window;
    };
    var hasBlobSlice = function hasBlobSlice() {
        return 'slice' in Blob.prototype;
    };
    var hasCreateObjectURL = function hasCreateObjectURL() {
        return 'URL' in window && 'createObjectURL' in window.URL;
    };
    var hasVisibility = function hasVisibility() {
        return 'visibilityState' in document;
    };
    var hasTiming = function hasTiming() {
        return 'performance' in window;
    }; // iOS 8.x
    var hasCSSSupports = function hasCSSSupports() {
        return 'supports' in (window.CSS || {});
    }; // use to detect Safari 9+
    var isIE11 = function isIE11() {
        return /MSIE|Trident/.test(window.navigator.userAgent);
    };

    var supported = (function() {
        // Runs immediately and then remembers result for subsequent calls
        var isSupported =
            // Has to be a browser
            isBrowser() &&
            // Can't run on Opera Mini due to lack of everything
            !isOperaMini() &&
            // Require these APIs to feature detect a modern browser
            hasVisibility() &&
            hasPromises() &&
            hasBlobSlice() &&
            hasCreateObjectURL() &&
            hasTiming() &&
            // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)
            (hasCSSSupports() || isIE11());

        return function() {
            return isSupported;
        };
    })();

    /**
     * Plugin internal state (over all instances)
     */
    var state = {
        // active app instances, used to redraw the apps and to find the later
        apps: [],
    };

    // plugin name
    var name = 'filepond';

    /**
     * Public Plugin methods
     */
    var fn = function fn() {};
    exports.Status = {};
    exports.FileStatus = {};
    exports.FileOrigin = {};
    exports.OptionTypes = {};
    exports.create = fn;
    exports.destroy = fn;
    exports.parse = fn;
    exports.find = fn;
    exports.registerPlugin = fn;
    exports.getOptions = fn;
    exports.setOptions = fn;

    // if not supported, no API
    if (supported()) {
        // start painter and fire load event
        createPainter(
            function() {
                state.apps.forEach(function(app) {
                    return app._read();
                });
            },
            function(ts) {
                state.apps.forEach(function(app) {
                    return app._write(ts);
                });
            }
        );

        // fire loaded event so we know when FilePond is available
        var dispatch = function dispatch() {
            // let others know we have area ready
            document.dispatchEvent(
                new CustomEvent('FilePond:loaded', {
                    detail: {
                        supported: supported,
                        create: exports.create,
                        destroy: exports.destroy,
                        parse: exports.parse,
                        find: exports.find,
                        registerPlugin: exports.registerPlugin,
                        setOptions: exports.setOptions,
                    },
                })
            );

            // clean up event
            document.removeEventListener('DOMContentLoaded', dispatch);
        };

        if (document.readyState !== 'loading') {
            // move to back of execution queue, FilePond should have been exported by then
            setTimeout(function() {
                return dispatch();
            }, 0);
        } else {
            document.addEventListener('DOMContentLoaded', dispatch);
        }

        // updates the OptionTypes object based on the current options
        var updateOptionTypes = function updateOptionTypes() {
            return forin(getOptions(), function(key, value) {
                exports.OptionTypes[key] = value[1];
            });
        };

        exports.Status = Object.assign({}, Status);
        exports.FileOrigin = Object.assign({}, FileOrigin);
        exports.FileStatus = Object.assign({}, ItemStatus);

        exports.OptionTypes = {};
        updateOptionTypes();

        // create method, creates apps and adds them to the app array
        exports.create = function create() {
            var app = createApp$1.apply(void 0, arguments);
            app.on('destroy', exports.destroy);
            state.apps.push(app);
            return createAppAPI(app);
        };

        // destroys apps and removes them from the app array
        exports.destroy = function destroy(hook) {
            // returns true if the app was destroyed successfully
            var indexToRemove = state.apps.findIndex(function(app) {
                return app.isAttachedTo(hook);
            });
            if (indexToRemove >= 0) {
                // remove from apps
                var app = state.apps.splice(indexToRemove, 1)[0];

                // restore original dom element
                app.restoreElement();

                return true;
            }

            return false;
        };

        // parses the given context for plugins (does not include the context element itself)
        exports.parse = function parse(context) {
            // get all possible hooks
            var matchedHooks = Array.from(context.querySelectorAll('.' + name));

            // filter out already active hooks
            var newHooks = matchedHooks.filter(function(newHook) {
                return !state.apps.find(function(app) {
                    return app.isAttachedTo(newHook);
                });
            });

            // create new instance for each hook
            return newHooks.map(function(hook) {
                return exports.create(hook);
            });
        };

        // returns an app based on the given element hook
        exports.find = function find(hook) {
            var app = state.apps.find(function(app) {
                return app.isAttachedTo(hook);
            });
            if (!app) {
                return null;
            }
            return createAppAPI(app);
        };

        // adds a plugin extension
        exports.registerPlugin = function registerPlugin() {
            for (
                var _len = arguments.length, plugins = new Array(_len), _key = 0;
                _key < _len;
                _key++
            ) {
                plugins[_key] = arguments[_key];
            }

            // register plugins
            plugins.forEach(createAppPlugin);

            // update OptionTypes, each plugin might have extended the default options
            updateOptionTypes();
        };

        exports.getOptions = function getOptions$1() {
            var opts = {};
            forin(getOptions(), function(key, value) {
                opts[key] = value[0];
            });
            return opts;
        };

        exports.setOptions = function setOptions$1(opts) {
            if (isObject(opts)) {
                // update existing plugins
                state.apps.forEach(function(app) {
                    app.setOptions(opts);
                });

                // override defaults
                setOptions(opts);
            }

            // return new options
            return exports.getOptions();
        };
    }

    exports.supported = supported;

    Object.defineProperty(exports, '__esModule', { value: true });
});


/***/ }),

/***/ "./node_modules/intl-tel-input/build/js/intlTelInput.js":
/*!**************************************************************!*\
  !*** ./node_modules/intl-tel-input/build/js/intlTelInput.js ***!
  \**************************************************************/
/***/ ((module) => {

/*
 * International Telephone Input v17.0.19
 * https://github.com/jackocnr/intl-tel-input.git
 * Licensed under the MIT license
 */

// wrap in UMD
(function(factory) {
    if ( true && module.exports) module.exports = factory(); else window.intlTelInput = factory();
})(function(undefined) {
    "use strict";
    return function() {
        // Array of country objects for the flag dropdown.
        // Here is the criteria for the plugin to support a given country/territory
        // - It has an iso2 code: https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
        // - It has it's own country calling code (it is not a sub-region of another country): https://en.wikipedia.org/wiki/List_of_country_calling_codes
        // - It has a flag in the region-flags project: https://github.com/behdad/region-flags/tree/gh-pages/png
        // - It is supported by libphonenumber (it must be listed on this page): https://github.com/googlei18n/libphonenumber/blob/master/resources/ShortNumberMetadata.xml
        // Each country array has the following information:
        // [
        //    Country name,
        //    iso2 code,
        //    International dial code,
        //    Order (if >1 country with same dial code),
        //    Area codes
        // ]
        var allCountries = [ [ "Afghanistan (‫افغانستان‬‎)", "af", "93" ], [ "Albania (Shqipëri)", "al", "355" ], [ "Algeria (‫الجزائر‬‎)", "dz", "213" ], [ "American Samoa", "as", "1", 5, [ "684" ] ], [ "Andorra", "ad", "376" ], [ "Angola", "ao", "244" ], [ "Anguilla", "ai", "1", 6, [ "264" ] ], [ "Antigua and Barbuda", "ag", "1", 7, [ "268" ] ], [ "Argentina", "ar", "54" ], [ "Armenia (Հայաստան)", "am", "374" ], [ "Aruba", "aw", "297" ], [ "Ascension Island", "ac", "247" ], [ "Australia", "au", "61", 0 ], [ "Austria (Österreich)", "at", "43" ], [ "Azerbaijan (Azərbaycan)", "az", "994" ], [ "Bahamas", "bs", "1", 8, [ "242" ] ], [ "Bahrain (‫البحرين‬‎)", "bh", "973" ], [ "Bangladesh (বাংলাদেশ)", "bd", "880" ], [ "Barbados", "bb", "1", 9, [ "246" ] ], [ "Belarus (Беларусь)", "by", "375" ], [ "Belgium (België)", "be", "32" ], [ "Belize", "bz", "501" ], [ "Benin (Bénin)", "bj", "229" ], [ "Bermuda", "bm", "1", 10, [ "441" ] ], [ "Bhutan (འབྲུག)", "bt", "975" ], [ "Bolivia", "bo", "591" ], [ "Bosnia and Herzegovina (Босна и Херцеговина)", "ba", "387" ], [ "Botswana", "bw", "267" ], [ "Brazil (Brasil)", "br", "55" ], [ "British Indian Ocean Territory", "io", "246" ], [ "British Virgin Islands", "vg", "1", 11, [ "284" ] ], [ "Brunei", "bn", "673" ], [ "Bulgaria (България)", "bg", "359" ], [ "Burkina Faso", "bf", "226" ], [ "Burundi (Uburundi)", "bi", "257" ], [ "Cambodia (កម្ពុជា)", "kh", "855" ], [ "Cameroon (Cameroun)", "cm", "237" ], [ "Canada", "ca", "1", 1, [ "204", "226", "236", "249", "250", "289", "306", "343", "365", "387", "403", "416", "418", "431", "437", "438", "450", "506", "514", "519", "548", "579", "581", "587", "604", "613", "639", "647", "672", "705", "709", "742", "778", "780", "782", "807", "819", "825", "867", "873", "902", "905" ] ], [ "Cape Verde (Kabu Verdi)", "cv", "238" ], [ "Caribbean Netherlands", "bq", "599", 1, [ "3", "4", "7" ] ], [ "Cayman Islands", "ky", "1", 12, [ "345" ] ], [ "Central African Republic (République centrafricaine)", "cf", "236" ], [ "Chad (Tchad)", "td", "235" ], [ "Chile", "cl", "56" ], [ "China (中国)", "cn", "86" ], [ "Christmas Island", "cx", "61", 2, [ "89164" ] ], [ "Cocos (Keeling) Islands", "cc", "61", 1, [ "89162" ] ], [ "Colombia", "co", "57" ], [ "Comoros (‫جزر القمر‬‎)", "km", "269" ], [ "Congo (DRC) (Jamhuri ya Kidemokrasia ya Kongo)", "cd", "243" ], [ "Congo (Republic) (Congo-Brazzaville)", "cg", "242" ], [ "Cook Islands", "ck", "682" ], [ "Costa Rica", "cr", "506" ], [ "Côte d’Ivoire", "ci", "225" ], [ "Croatia (Hrvatska)", "hr", "385" ], [ "Cuba", "cu", "53" ], [ "Curaçao", "cw", "599", 0 ], [ "Cyprus (Κύπρος)", "cy", "357" ], [ "Czech Republic (Česká republika)", "cz", "420" ], [ "Denmark (Danmark)", "dk", "45" ], [ "Djibouti", "dj", "253" ], [ "Dominica", "dm", "1", 13, [ "767" ] ], [ "Dominican Republic (República Dominicana)", "do", "1", 2, [ "809", "829", "849" ] ], [ "Ecuador", "ec", "593" ], [ "Egypt (‫مصر‬‎)", "eg", "20" ], [ "El Salvador", "sv", "503" ], [ "Equatorial Guinea (Guinea Ecuatorial)", "gq", "240" ], [ "Eritrea", "er", "291" ], [ "Estonia (Eesti)", "ee", "372" ], [ "Eswatini", "sz", "268" ], [ "Ethiopia", "et", "251" ], [ "Falkland Islands (Islas Malvinas)", "fk", "500" ], [ "Faroe Islands (Føroyar)", "fo", "298" ], [ "Fiji", "fj", "679" ], [ "Finland (Suomi)", "fi", "358", 0 ], [ "France", "fr", "33" ], [ "French Guiana (Guyane française)", "gf", "594" ], [ "French Polynesia (Polynésie française)", "pf", "689" ], [ "Gabon", "ga", "241" ], [ "Gambia", "gm", "220" ], [ "Georgia (საქართველო)", "ge", "995" ], [ "Germany (Deutschland)", "de", "49" ], [ "Ghana (Gaana)", "gh", "233" ], [ "Gibraltar", "gi", "350" ], [ "Greece (Ελλάδα)", "gr", "30" ], [ "Greenland (Kalaallit Nunaat)", "gl", "299" ], [ "Grenada", "gd", "1", 14, [ "473" ] ], [ "Guadeloupe", "gp", "590", 0 ], [ "Guam", "gu", "1", 15, [ "671" ] ], [ "Guatemala", "gt", "502" ], [ "Guernsey", "gg", "44", 1, [ "1481", "7781", "7839", "7911" ] ], [ "Guinea (Guinée)", "gn", "224" ], [ "Guinea-Bissau (Guiné Bissau)", "gw", "245" ], [ "Guyana", "gy", "592" ], [ "Haiti", "ht", "509" ], [ "Honduras", "hn", "504" ], [ "Hong Kong (香港)", "hk", "852" ], [ "Hungary (Magyarország)", "hu", "36" ], [ "Iceland (Ísland)", "is", "354" ], [ "India (भारत)", "in", "91" ], [ "Indonesia", "id", "62" ], [ "Iran (‫ایران‬‎)", "ir", "98" ], [ "Iraq (‫العراق‬‎)", "iq", "964" ], [ "Ireland", "ie", "353" ], [ "Isle of Man", "im", "44", 2, [ "1624", "74576", "7524", "7924", "7624" ] ], [ "Israel (‫ישראל‬‎)", "il", "972" ], [ "Italy (Italia)", "it", "39", 0 ], [ "Jamaica", "jm", "1", 4, [ "876", "658" ] ], [ "Japan (日本)", "jp", "81" ], [ "Jersey", "je", "44", 3, [ "1534", "7509", "7700", "7797", "7829", "7937" ] ], [ "Jordan (‫الأردن‬‎)", "jo", "962" ], [ "Kazakhstan (Казахстан)", "kz", "7", 1, [ "33", "7" ] ], [ "Kenya", "ke", "254" ], [ "Kiribati", "ki", "686" ], [ "Kosovo", "xk", "383" ], [ "Kuwait (‫الكويت‬‎)", "kw", "965" ], [ "Kyrgyzstan (Кыргызстан)", "kg", "996" ], [ "Laos (ລາວ)", "la", "856" ], [ "Latvia (Latvija)", "lv", "371" ], [ "Lebanon (‫لبنان‬‎)", "lb", "961" ], [ "Lesotho", "ls", "266" ], [ "Liberia", "lr", "231" ], [ "Libya (‫ليبيا‬‎)", "ly", "218" ], [ "Liechtenstein", "li", "423" ], [ "Lithuania (Lietuva)", "lt", "370" ], [ "Luxembourg", "lu", "352" ], [ "Macau (澳門)", "mo", "853" ], [ "North Macedonia (Македонија)", "mk", "389" ], [ "Madagascar (Madagasikara)", "mg", "261" ], [ "Malawi", "mw", "265" ], [ "Malaysia", "my", "60" ], [ "Maldives", "mv", "960" ], [ "Mali", "ml", "223" ], [ "Malta", "mt", "356" ], [ "Marshall Islands", "mh", "692" ], [ "Martinique", "mq", "596" ], [ "Mauritania (‫موريتانيا‬‎)", "mr", "222" ], [ "Mauritius (Moris)", "mu", "230" ], [ "Mayotte", "yt", "262", 1, [ "269", "639" ] ], [ "Mexico (México)", "mx", "52" ], [ "Micronesia", "fm", "691" ], [ "Moldova (Republica Moldova)", "md", "373" ], [ "Monaco", "mc", "377" ], [ "Mongolia (Монгол)", "mn", "976" ], [ "Montenegro (Crna Gora)", "me", "382" ], [ "Montserrat", "ms", "1", 16, [ "664" ] ], [ "Morocco (‫المغرب‬‎)", "ma", "212", 0 ], [ "Mozambique (Moçambique)", "mz", "258" ], [ "Myanmar (Burma) (မြန်မာ)", "mm", "95" ], [ "Namibia (Namibië)", "na", "264" ], [ "Nauru", "nr", "674" ], [ "Nepal (नेपाल)", "np", "977" ], [ "Netherlands (Nederland)", "nl", "31" ], [ "New Caledonia (Nouvelle-Calédonie)", "nc", "687" ], [ "New Zealand", "nz", "64" ], [ "Nicaragua", "ni", "505" ], [ "Niger (Nijar)", "ne", "227" ], [ "Nigeria", "ng", "234" ], [ "Niue", "nu", "683" ], [ "Norfolk Island", "nf", "672" ], [ "North Korea (조선 민주주의 인민 공화국)", "kp", "850" ], [ "Northern Mariana Islands", "mp", "1", 17, [ "670" ] ], [ "Norway (Norge)", "no", "47", 0 ], [ "Oman (‫عُمان‬‎)", "om", "968" ], [ "Pakistan (‫پاکستان‬‎)", "pk", "92" ], [ "Palau", "pw", "680" ], [ "Palestine (‫فلسطين‬‎)", "ps", "970" ], [ "Panama (Panamá)", "pa", "507" ], [ "Papua New Guinea", "pg", "675" ], [ "Paraguay", "py", "595" ], [ "Peru (Perú)", "pe", "51" ], [ "Philippines", "ph", "63" ], [ "Poland (Polska)", "pl", "48" ], [ "Portugal", "pt", "351" ], [ "Puerto Rico", "pr", "1", 3, [ "787", "939" ] ], [ "Qatar (‫قطر‬‎)", "qa", "974" ], [ "Réunion (La Réunion)", "re", "262", 0 ], [ "Romania (România)", "ro", "40" ], [ "Russia (Россия)", "ru", "7", 0 ], [ "Rwanda", "rw", "250" ], [ "Saint Barthélemy", "bl", "590", 1 ], [ "Saint Helena", "sh", "290" ], [ "Saint Kitts and Nevis", "kn", "1", 18, [ "869" ] ], [ "Saint Lucia", "lc", "1", 19, [ "758" ] ], [ "Saint Martin (Saint-Martin (partie française))", "mf", "590", 2 ], [ "Saint Pierre and Miquelon (Saint-Pierre-et-Miquelon)", "pm", "508" ], [ "Saint Vincent and the Grenadines", "vc", "1", 20, [ "784" ] ], [ "Samoa", "ws", "685" ], [ "San Marino", "sm", "378" ], [ "São Tomé and Príncipe (São Tomé e Príncipe)", "st", "239" ], [ "Saudi Arabia (‫المملكة العربية السعودية‬‎)", "sa", "966" ], [ "Senegal (Sénégal)", "sn", "221" ], [ "Serbia (Србија)", "rs", "381" ], [ "Seychelles", "sc", "248" ], [ "Sierra Leone", "sl", "232" ], [ "Singapore", "sg", "65" ], [ "Sint Maarten", "sx", "1", 21, [ "721" ] ], [ "Slovakia (Slovensko)", "sk", "421" ], [ "Slovenia (Slovenija)", "si", "386" ], [ "Solomon Islands", "sb", "677" ], [ "Somalia (Soomaaliya)", "so", "252" ], [ "South Africa", "za", "27" ], [ "South Korea (대한민국)", "kr", "82" ], [ "South Sudan (‫جنوب السودان‬‎)", "ss", "211" ], [ "Spain (España)", "es", "34" ], [ "Sri Lanka (ශ්‍රී ලංකාව)", "lk", "94" ], [ "Sudan (‫السودان‬‎)", "sd", "249" ], [ "Suriname", "sr", "597" ], [ "Svalbard and Jan Mayen", "sj", "47", 1, [ "79" ] ], [ "Sweden (Sverige)", "se", "46" ], [ "Switzerland (Schweiz)", "ch", "41" ], [ "Syria (‫سوريا‬‎)", "sy", "963" ], [ "Taiwan (台灣)", "tw", "886" ], [ "Tajikistan", "tj", "992" ], [ "Tanzania", "tz", "255" ], [ "Thailand (ไทย)", "th", "66" ], [ "Timor-Leste", "tl", "670" ], [ "Togo", "tg", "228" ], [ "Tokelau", "tk", "690" ], [ "Tonga", "to", "676" ], [ "Trinidad and Tobago", "tt", "1", 22, [ "868" ] ], [ "Tunisia (‫تونس‬‎)", "tn", "216" ], [ "Turkey (Türkiye)", "tr", "90" ], [ "Turkmenistan", "tm", "993" ], [ "Turks and Caicos Islands", "tc", "1", 23, [ "649" ] ], [ "Tuvalu", "tv", "688" ], [ "U.S. Virgin Islands", "vi", "1", 24, [ "340" ] ], [ "Uganda", "ug", "256" ], [ "Ukraine (Україна)", "ua", "380" ], [ "United Arab Emirates (‫الإمارات العربية المتحدة‬‎)", "ae", "971" ], [ "United Kingdom", "gb", "44", 0 ], [ "United States", "us", "1", 0 ], [ "Uruguay", "uy", "598" ], [ "Uzbekistan (Oʻzbekiston)", "uz", "998" ], [ "Vanuatu", "vu", "678" ], [ "Vatican City (Città del Vaticano)", "va", "39", 1, [ "06698" ] ], [ "Venezuela", "ve", "58" ], [ "Vietnam (Việt Nam)", "vn", "84" ], [ "Wallis and Futuna (Wallis-et-Futuna)", "wf", "681" ], [ "Western Sahara (‫الصحراء الغربية‬‎)", "eh", "212", 1, [ "5288", "5289" ] ], [ "Yemen (‫اليمن‬‎)", "ye", "967" ], [ "Zambia", "zm", "260" ], [ "Zimbabwe", "zw", "263" ], [ "Åland Islands", "ax", "358", 1, [ "18" ] ] ];
        // loop over all of the countries above, restructuring the data to be objects with named keys
        for (var i = 0; i < allCountries.length; i++) {
            var c = allCountries[i];
            allCountries[i] = {
                name: c[0],
                iso2: c[1],
                dialCode: c[2],
                priority: c[3] || 0,
                areaCodes: c[4] || null
            };
        }
        "use strict";
        function _classCallCheck(instance, Constructor) {
            if (!(instance instanceof Constructor)) {
                throw new TypeError("Cannot call a class as a function");
            }
        }
        function _defineProperties(target, props) {
            for (var i = 0; i < props.length; i++) {
                var descriptor = props[i];
                descriptor.enumerable = descriptor.enumerable || false;
                descriptor.configurable = true;
                if ("value" in descriptor) descriptor.writable = true;
                Object.defineProperty(target, descriptor.key, descriptor);
            }
        }
        function _createClass(Constructor, protoProps, staticProps) {
            if (protoProps) _defineProperties(Constructor.prototype, protoProps);
            if (staticProps) _defineProperties(Constructor, staticProps);
            return Constructor;
        }
        var intlTelInputGlobals = {
            getInstance: function getInstance(input) {
                var id = input.getAttribute("data-intl-tel-input-id");
                return window.intlTelInputGlobals.instances[id];
            },
            instances: {},
            // using a global like this allows us to mock it in the tests
            documentReady: function documentReady() {
                return document.readyState === "complete";
            }
        };
        if (typeof window === "object") window.intlTelInputGlobals = intlTelInputGlobals;
        // these vars persist through all instances of the plugin
        var id = 0;
        var defaults = {
            // whether or not to allow the dropdown
            allowDropdown: true,
            // if there is just a dial code in the input: remove it on blur
            autoHideDialCode: true,
            // add a placeholder in the input with an example number for the selected country
            autoPlaceholder: "polite",
            // modify the parentClass
            customContainer: "",
            // modify the auto placeholder
            customPlaceholder: null,
            // append menu to specified element
            dropdownContainer: null,
            // don't display these countries
            excludeCountries: [],
            // format the input value during initialisation and on setNumber
            formatOnDisplay: true,
            // geoIp lookup function
            geoIpLookup: null,
            // inject a hidden input with this name, and on submit, populate it with the result of getNumber
            hiddenInput: "",
            // initial country
            initialCountry: "",
            // localized country names e.g. { 'de': 'Deutschland' }
            localizedCountries: null,
            // don't insert international dial codes
            nationalMode: true,
            // display only these countries
            onlyCountries: [],
            // number type to use for placeholders
            placeholderNumberType: "MOBILE",
            // the countries at the top of the list. defaults to united states and united kingdom
            preferredCountries: [ "us", "gb" ],
            // display the country dial code next to the selected flag so it's not part of the typed number
            separateDialCode: false,
            // specify the path to the libphonenumber script to enable validation/formatting
            utilsScript: ""
        };
        // https://en.wikipedia.org/wiki/List_of_North_American_Numbering_Plan_area_codes#Non-geographic_area_codes
        var regionlessNanpNumbers = [ "800", "822", "833", "844", "855", "866", "877", "880", "881", "882", "883", "884", "885", "886", "887", "888", "889" ];
        // utility function to iterate over an object. can't use Object.entries or native forEach because
        // of IE11
        var forEachProp = function forEachProp(obj, callback) {
            var keys = Object.keys(obj);
            for (var i = 0; i < keys.length; i++) {
                callback(keys[i], obj[keys[i]]);
            }
        };
        // run a method on each instance of the plugin
        var forEachInstance = function forEachInstance(method) {
            forEachProp(window.intlTelInputGlobals.instances, function(key) {
                window.intlTelInputGlobals.instances[key][method]();
            });
        };
        // this is our plugin class that we will create an instance of
        // eslint-disable-next-line no-unused-vars
        var Iti = /*#__PURE__*/
        function() {
            function Iti(input, options) {
                var _this = this;
                _classCallCheck(this, Iti);
                this.id = id++;
                this.telInput = input;
                this.activeItem = null;
                this.highlightedItem = null;
                // process specified options / defaults
                // alternative to Object.assign, which isn't supported by IE11
                var customOptions = options || {};
                this.options = {};
                forEachProp(defaults, function(key, value) {
                    _this.options[key] = customOptions.hasOwnProperty(key) ? customOptions[key] : value;
                });
                this.hadInitialPlaceholder = Boolean(input.getAttribute("placeholder"));
            }
            _createClass(Iti, [ {
                key: "_init",
                value: function _init() {
                    var _this2 = this;
                    // if in nationalMode, disable options relating to dial codes
                    if (this.options.nationalMode) this.options.autoHideDialCode = false;
                    // if separateDialCode then doesn't make sense to A) insert dial code into input
                    // (autoHideDialCode), and B) display national numbers (because we're displaying the country
                    // dial code next to them)
                    if (this.options.separateDialCode) {
                        this.options.autoHideDialCode = this.options.nationalMode = false;
                    }
                    // we cannot just test screen size as some smartphones/website meta tags will report desktop
                    // resolutions
                    // Note: for some reason jasmine breaks if you put this in the main Plugin function with the
                    // rest of these declarations
                    // Note: to target Android Mobiles (and not Tablets), we must find 'Android' and 'Mobile'
                    this.isMobile = /Android.+Mobile|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                    if (this.isMobile) {
                        // trigger the mobile dropdown css
                        document.body.classList.add("iti-mobile");
                        // on mobile, we want a full screen dropdown, so we must append it to the body
                        if (!this.options.dropdownContainer) this.options.dropdownContainer = document.body;
                    }
                    // these promises get resolved when their individual requests complete
                    // this way the dev can do something like iti.promise.then(...) to know when all requests are
                    // complete
                    if (typeof Promise !== "undefined") {
                        var autoCountryPromise = new Promise(function(resolve, reject) {
                            _this2.resolveAutoCountryPromise = resolve;
                            _this2.rejectAutoCountryPromise = reject;
                        });
                        var utilsScriptPromise = new Promise(function(resolve, reject) {
                            _this2.resolveUtilsScriptPromise = resolve;
                            _this2.rejectUtilsScriptPromise = reject;
                        });
                        this.promise = Promise.all([ autoCountryPromise, utilsScriptPromise ]);
                    } else {
                        // prevent errors when Promise doesn't exist
                        this.resolveAutoCountryPromise = this.rejectAutoCountryPromise = function() {};
                        this.resolveUtilsScriptPromise = this.rejectUtilsScriptPromise = function() {};
                    }
                    // in various situations there could be no country selected initially, but we need to be able
                    // to assume this variable exists
                    this.selectedCountryData = {};
                    // process all the data: onlyCountries, excludeCountries, preferredCountries etc
                    this._processCountryData();
                    // generate the markup
                    this._generateMarkup();
                    // set the initial state of the input value and the selected flag
                    this._setInitialState();
                    // start all of the event listeners: autoHideDialCode, input keydown, selectedFlag click
                    this._initListeners();
                    // utils script, and auto country
                    this._initRequests();
                }
            }, {
                key: "_processCountryData",
                value: function _processCountryData() {
                    // process onlyCountries or excludeCountries array if present
                    this._processAllCountries();
                    // process the countryCodes map
                    this._processCountryCodes();
                    // process the preferredCountries
                    this._processPreferredCountries();
                    // translate countries according to localizedCountries option
                    if (this.options.localizedCountries) this._translateCountriesByLocale();
                    // sort countries by name
                    if (this.options.onlyCountries.length || this.options.localizedCountries) {
                        this.countries.sort(this._countryNameSort);
                    }
                }
            }, {
                key: "_addCountryCode",
                value: function _addCountryCode(iso2, countryCode, priority) {
                    if (countryCode.length > this.countryCodeMaxLen) {
                        this.countryCodeMaxLen = countryCode.length;
                    }
                    if (!this.countryCodes.hasOwnProperty(countryCode)) {
                        this.countryCodes[countryCode] = [];
                    }
                    // bail if we already have this country for this countryCode
                    for (var i = 0; i < this.countryCodes[countryCode].length; i++) {
                        if (this.countryCodes[countryCode][i] === iso2) return;
                    }
                    // check for undefined as 0 is falsy
                    var index = priority !== undefined ? priority : this.countryCodes[countryCode].length;
                    this.countryCodes[countryCode][index] = iso2;
                }
            }, {
                key: "_processAllCountries",
                value: function _processAllCountries() {
                    if (this.options.onlyCountries.length) {
                        var lowerCaseOnlyCountries = this.options.onlyCountries.map(function(country) {
                            return country.toLowerCase();
                        });
                        this.countries = allCountries.filter(function(country) {
                            return lowerCaseOnlyCountries.indexOf(country.iso2) > -1;
                        });
                    } else if (this.options.excludeCountries.length) {
                        var lowerCaseExcludeCountries = this.options.excludeCountries.map(function(country) {
                            return country.toLowerCase();
                        });
                        this.countries = allCountries.filter(function(country) {
                            return lowerCaseExcludeCountries.indexOf(country.iso2) === -1;
                        });
                    } else {
                        this.countries = allCountries;
                    }
                }
            }, {
                key: "_translateCountriesByLocale",
                value: function _translateCountriesByLocale() {
                    for (var i = 0; i < this.countries.length; i++) {
                        var iso = this.countries[i].iso2.toLowerCase();
                        if (this.options.localizedCountries.hasOwnProperty(iso)) {
                            this.countries[i].name = this.options.localizedCountries[iso];
                        }
                    }
                }
            }, {
                key: "_countryNameSort",
                value: function _countryNameSort(a, b) {
                    return a.name.localeCompare(b.name);
                }
            }, {
                key: "_processCountryCodes",
                value: function _processCountryCodes() {
                    this.countryCodeMaxLen = 0;
                    // here we store just dial codes
                    this.dialCodes = {};
                    // here we store "country codes" (both dial codes and their area codes)
                    this.countryCodes = {};
                    // first: add dial codes
                    for (var i = 0; i < this.countries.length; i++) {
                        var c = this.countries[i];
                        if (!this.dialCodes[c.dialCode]) this.dialCodes[c.dialCode] = true;
                        this._addCountryCode(c.iso2, c.dialCode, c.priority);
                    }
                    // next: add area codes
                    // this is a second loop over countries, to make sure we have all of the "root" countries
                    // already in the map, so that we can access them, as each time we add an area code substring
                    // to the map, we also need to include the "root" country's code, as that also matches
                    for (var _i = 0; _i < this.countries.length; _i++) {
                        var _c = this.countries[_i];
                        // area codes
                        if (_c.areaCodes) {
                            var rootCountryCode = this.countryCodes[_c.dialCode][0];
                            // for each area code
                            for (var j = 0; j < _c.areaCodes.length; j++) {
                                var areaCode = _c.areaCodes[j];
                                // for each digit in the area code to add all partial matches as well
                                for (var k = 1; k < areaCode.length; k++) {
                                    var partialDialCode = _c.dialCode + areaCode.substr(0, k);
                                    // start with the root country, as that also matches this dial code
                                    this._addCountryCode(rootCountryCode, partialDialCode);
                                    this._addCountryCode(_c.iso2, partialDialCode);
                                }
                                // add the full area code
                                this._addCountryCode(_c.iso2, _c.dialCode + areaCode);
                            }
                        }
                    }
                }
            }, {
                key: "_processPreferredCountries",
                value: function _processPreferredCountries() {
                    this.preferredCountries = [];
                    for (var i = 0; i < this.options.preferredCountries.length; i++) {
                        var countryCode = this.options.preferredCountries[i].toLowerCase();
                        var countryData = this._getCountryData(countryCode, false, true);
                        if (countryData) this.preferredCountries.push(countryData);
                    }
                }
            }, {
                key: "_createEl",
                value: function _createEl(name, attrs, container) {
                    var el = document.createElement(name);
                    if (attrs) forEachProp(attrs, function(key, value) {
                        return el.setAttribute(key, value);
                    });
                    if (container) container.appendChild(el);
                    return el;
                }
            }, {
                key: "_generateMarkup",
                value: function _generateMarkup() {
                    // if autocomplete does not exist on the element and its form, then
                    // prevent autocomplete as there's no safe, cross-browser event we can react to, so it can
                    // easily put the plugin in an inconsistent state e.g. the wrong flag selected for the
                    // autocompleted number, which on submit could mean wrong number is saved (esp in nationalMode)
                    if (!this.telInput.hasAttribute("autocomplete") && !(this.telInput.form && this.telInput.form.hasAttribute("autocomplete"))) {
                        this.telInput.setAttribute("autocomplete", "off");
                    }
                    // containers (mostly for positioning)
                    var parentClass = "iti";
                    if (this.options.allowDropdown) parentClass += " iti--allow-dropdown";
                    if (this.options.separateDialCode) parentClass += " iti--separate-dial-code";
                    if (this.options.customContainer) {
                        parentClass += " ";
                        parentClass += this.options.customContainer;
                    }
                    var wrapper = this._createEl("div", {
                        "class": parentClass
                    });
                    this.telInput.parentNode.insertBefore(wrapper, this.telInput);
                    this.flagsContainer = this._createEl("div", {
                        "class": "iti__flag-container"
                    }, wrapper);
                    wrapper.appendChild(this.telInput);
                    // selected flag (displayed to left of input)
                    this.selectedFlag = this._createEl("div", {
                        "class": "iti__selected-flag",
                        role: "combobox",
                        "aria-controls": "iti-".concat(this.id, "__country-listbox"),
                        "aria-owns": "iti-".concat(this.id, "__country-listbox"),
                        "aria-expanded": "false"
                    }, this.flagsContainer);
                    this.selectedFlagInner = this._createEl("div", {
                        "class": "iti__flag"
                    }, this.selectedFlag);
                    if (this.options.separateDialCode) {
                        this.selectedDialCode = this._createEl("div", {
                            "class": "iti__selected-dial-code"
                        }, this.selectedFlag);
                    }
                    if (this.options.allowDropdown) {
                        // make element focusable and tab navigable
                        this.selectedFlag.setAttribute("tabindex", "0");
                        this.dropdownArrow = this._createEl("div", {
                            "class": "iti__arrow"
                        }, this.selectedFlag);
                        // country dropdown: preferred countries, then divider, then all countries
                        this.countryList = this._createEl("ul", {
                            "class": "iti__country-list iti__hide",
                            id: "iti-".concat(this.id, "__country-listbox"),
                            role: "listbox",
                            "aria-label": "List of countries"
                        });
                        if (this.preferredCountries.length) {
                            this._appendListItems(this.preferredCountries, "iti__preferred", true);
                            this._createEl("li", {
                                "class": "iti__divider",
                                role: "separator",
                                "aria-disabled": "true"
                            }, this.countryList);
                        }
                        this._appendListItems(this.countries, "iti__standard");
                        // create dropdownContainer markup
                        if (this.options.dropdownContainer) {
                            this.dropdown = this._createEl("div", {
                                "class": "iti iti--container"
                            });
                            this.dropdown.appendChild(this.countryList);
                        } else {
                            this.flagsContainer.appendChild(this.countryList);
                        }
                    }
                    if (this.options.hiddenInput) {
                        var hiddenInputName = this.options.hiddenInput;
                        var name = this.telInput.getAttribute("name");
                        if (name) {
                            var i = name.lastIndexOf("[");
                            // if input name contains square brackets, then give the hidden input the same name,
                            // replacing the contents of the last set of brackets with the given hiddenInput name
                            if (i !== -1) hiddenInputName = "".concat(name.substr(0, i), "[").concat(hiddenInputName, "]");
                        }
                        this.hiddenInput = this._createEl("input", {
                            type: "hidden",
                            name: hiddenInputName
                        });
                        wrapper.appendChild(this.hiddenInput);
                    }
                }
            }, {
                key: "_appendListItems",
                value: function _appendListItems(countries, className, preferred) {
                    // we create so many DOM elements, it is faster to build a temp string
                    // and then add everything to the DOM in one go at the end
                    var tmp = "";
                    // for each country
                    for (var i = 0; i < countries.length; i++) {
                        var c = countries[i];
                        var idSuffix = preferred ? "-preferred" : "";
                        // open the list item
                        tmp += "<li class='iti__country ".concat(className, "' tabIndex='-1' id='iti-").concat(this.id, "__item-").concat(c.iso2).concat(idSuffix, "' role='option' data-dial-code='").concat(c.dialCode, "' data-country-code='").concat(c.iso2, "' aria-selected='false'>");
                        // add the flag
                        tmp += "<div class='iti__flag-box'><div class='iti__flag iti__".concat(c.iso2, "'></div></div>");
                        // and the country name and dial code
                        tmp += "<span class='iti__country-name'>".concat(c.name, "</span>");
                        tmp += "<span class='iti__dial-code'>+".concat(c.dialCode, "</span>");
                        // close the list item
                        tmp += "</li>";
                    }
                    this.countryList.insertAdjacentHTML("beforeend", tmp);
                }
            }, {
                key: "_setInitialState",
                value: function _setInitialState() {
                    // fix firefox bug: when first load page (with input with value set to number with intl dial
                    // code) and initialising plugin removes the dial code from the input, then refresh page,
                    // and we try to init plugin again but this time on number without dial code so get grey flag
                    var attributeValue = this.telInput.getAttribute("value");
                    var inputValue = this.telInput.value;
                    var useAttribute = attributeValue && attributeValue.charAt(0) === "+" && (!inputValue || inputValue.charAt(0) !== "+");
                    var val = useAttribute ? attributeValue : inputValue;
                    var dialCode = this._getDialCode(val);
                    var isRegionlessNanp = this._isRegionlessNanp(val);
                    var _this$options = this.options, initialCountry = _this$options.initialCountry, nationalMode = _this$options.nationalMode, autoHideDialCode = _this$options.autoHideDialCode, separateDialCode = _this$options.separateDialCode;
                    // if we already have a dial code, and it's not a regionlessNanp, we can go ahead and set the
                    // flag, else fall back to the default country
                    if (dialCode && !isRegionlessNanp) {
                        this._updateFlagFromNumber(val);
                    } else if (initialCountry !== "auto") {
                        // see if we should select a flag
                        if (initialCountry) {
                            this._setFlag(initialCountry.toLowerCase());
                        } else {
                            if (dialCode && isRegionlessNanp) {
                                // has intl dial code, is regionless nanp, and no initialCountry, so default to US
                                this._setFlag("us");
                            } else {
                                // no dial code and no initialCountry, so default to first in list
                                this.defaultCountry = this.preferredCountries.length ? this.preferredCountries[0].iso2 : this.countries[0].iso2;
                                if (!val) {
                                    this._setFlag(this.defaultCountry);
                                }
                            }
                        }
                        // if empty and no nationalMode and no autoHideDialCode then insert the default dial code
                        if (!val && !nationalMode && !autoHideDialCode && !separateDialCode) {
                            this.telInput.value = "+".concat(this.selectedCountryData.dialCode);
                        }
                    }
                    // NOTE: if initialCountry is set to auto, that will be handled separately
                    // format - note this wont be run after _updateDialCode as that's only called if no val
                    if (val) this._updateValFromNumber(val);
                }
            }, {
                key: "_initListeners",
                value: function _initListeners() {
                    this._initKeyListeners();
                    if (this.options.autoHideDialCode) this._initBlurListeners();
                    if (this.options.allowDropdown) this._initDropdownListeners();
                    if (this.hiddenInput) this._initHiddenInputListener();
                }
            }, {
                key: "_initHiddenInputListener",
                value: function _initHiddenInputListener() {
                    var _this3 = this;
                    this._handleHiddenInputSubmit = function() {
                        _this3.hiddenInput.value = _this3.getNumber();
                    };
                    if (this.telInput.form) this.telInput.form.addEventListener("submit", this._handleHiddenInputSubmit);
                }
            }, {
                key: "_getClosestLabel",
                value: function _getClosestLabel() {
                    var el = this.telInput;
                    while (el && el.tagName !== "LABEL") {
                        el = el.parentNode;
                    }
                    return el;
                }
            }, {
                key: "_initDropdownListeners",
                value: function _initDropdownListeners() {
                    var _this4 = this;
                    // hack for input nested inside label (which is valid markup): clicking the selected-flag to
                    // open the dropdown would then automatically trigger a 2nd click on the input which would
                    // close it again
                    this._handleLabelClick = function(e) {
                        // if the dropdown is closed, then focus the input, else ignore the click
                        if (_this4.countryList.classList.contains("iti__hide")) _this4.telInput.focus(); else e.preventDefault();
                    };
                    var label = this._getClosestLabel();
                    if (label) label.addEventListener("click", this._handleLabelClick);
                    // toggle country dropdown on click
                    this._handleClickSelectedFlag = function() {
                        // only intercept this event if we're opening the dropdown
                        // else let it bubble up to the top ("click-off-to-close" listener)
                        // we cannot just stopPropagation as it may be needed to close another instance
                        if (_this4.countryList.classList.contains("iti__hide") && !_this4.telInput.disabled && !_this4.telInput.readOnly) {
                            _this4._showDropdown();
                        }
                    };
                    this.selectedFlag.addEventListener("click", this._handleClickSelectedFlag);
                    // open dropdown list if currently focused
                    this._handleFlagsContainerKeydown = function(e) {
                        var isDropdownHidden = _this4.countryList.classList.contains("iti__hide");
                        if (isDropdownHidden && [ "ArrowUp", "Up", "ArrowDown", "Down", " ", "Enter" ].indexOf(e.key) !== -1) {
                            // prevent form from being submitted if "ENTER" was pressed
                            e.preventDefault();
                            // prevent event from being handled again by document
                            e.stopPropagation();
                            _this4._showDropdown();
                        }
                        // allow navigation from dropdown to input on TAB
                        if (e.key === "Tab") _this4._closeDropdown();
                    };
                    this.flagsContainer.addEventListener("keydown", this._handleFlagsContainerKeydown);
                }
            }, {
                key: "_initRequests",
                value: function _initRequests() {
                    var _this5 = this;
                    // if the user has specified the path to the utils script, fetch it on window.load, else resolve
                    if (this.options.utilsScript && !window.intlTelInputUtils) {
                        // if the plugin is being initialised after the window.load event has already been fired
                        if (window.intlTelInputGlobals.documentReady()) {
                            window.intlTelInputGlobals.loadUtils(this.options.utilsScript);
                        } else {
                            // wait until the load event so we don't block any other requests e.g. the flags image
                            window.addEventListener("load", function() {
                                window.intlTelInputGlobals.loadUtils(_this5.options.utilsScript);
                            });
                        }
                    } else this.resolveUtilsScriptPromise();
                    if (this.options.initialCountry === "auto") this._loadAutoCountry(); else this.resolveAutoCountryPromise();
                }
            }, {
                key: "_loadAutoCountry",
                value: function _loadAutoCountry() {
                    // 3 options:
                    // 1) already loaded (we're done)
                    // 2) not already started loading (start)
                    // 3) already started loading (do nothing - just wait for loading callback to fire)
                    if (window.intlTelInputGlobals.autoCountry) {
                        this.handleAutoCountry();
                    } else if (!window.intlTelInputGlobals.startedLoadingAutoCountry) {
                        // don't do this twice!
                        window.intlTelInputGlobals.startedLoadingAutoCountry = true;
                        if (typeof this.options.geoIpLookup === "function") {
                            this.options.geoIpLookup(function(countryCode) {
                                window.intlTelInputGlobals.autoCountry = countryCode.toLowerCase();
                                // tell all instances the auto country is ready
                                // TODO: this should just be the current instances
                                // UPDATE: use setTimeout in case their geoIpLookup function calls this callback straight
                                // away (e.g. if they have already done the geo ip lookup somewhere else). Using
                                // setTimeout means that the current thread of execution will finish before executing
                                // this, which allows the plugin to finish initialising.
                                setTimeout(function() {
                                    return forEachInstance("handleAutoCountry");
                                });
                            }, function() {
                                return forEachInstance("rejectAutoCountryPromise");
                            });
                        }
                    }
                }
            }, {
                key: "_initKeyListeners",
                value: function _initKeyListeners() {
                    var _this6 = this;
                    // update flag on keyup
                    this._handleKeyupEvent = function() {
                        if (_this6._updateFlagFromNumber(_this6.telInput.value)) {
                            _this6._triggerCountryChange();
                        }
                    };
                    this.telInput.addEventListener("keyup", this._handleKeyupEvent);
                    // update flag on cut/paste events (now supported in all major browsers)
                    this._handleClipboardEvent = function() {
                        // hack because "paste" event is fired before input is updated
                        setTimeout(_this6._handleKeyupEvent);
                    };
                    this.telInput.addEventListener("cut", this._handleClipboardEvent);
                    this.telInput.addEventListener("paste", this._handleClipboardEvent);
                }
            }, {
                key: "_cap",
                value: function _cap(number) {
                    var max = this.telInput.getAttribute("maxlength");
                    return max && number.length > max ? number.substr(0, max) : number;
                }
            }, {
                key: "_initBlurListeners",
                value: function _initBlurListeners() {
                    var _this7 = this;
                    // on blur or form submit: if just a dial code then remove it
                    this._handleSubmitOrBlurEvent = function() {
                        _this7._removeEmptyDialCode();
                    };
                    if (this.telInput.form) this.telInput.form.addEventListener("submit", this._handleSubmitOrBlurEvent);
                    this.telInput.addEventListener("blur", this._handleSubmitOrBlurEvent);
                }
            }, {
                key: "_removeEmptyDialCode",
                value: function _removeEmptyDialCode() {
                    if (this.telInput.value.charAt(0) === "+") {
                        var numeric = this._getNumeric(this.telInput.value);
                        // if just a plus, or if just a dial code
                        if (!numeric || this.selectedCountryData.dialCode === numeric) {
                            this.telInput.value = "";
                        }
                    }
                }
            }, {
                key: "_getNumeric",
                value: function _getNumeric(s) {
                    return s.replace(/\D/g, "");
                }
            }, {
                key: "_trigger",
                value: function _trigger(name) {
                    // have to use old school document.createEvent as IE11 doesn't support `new Event()` syntax
                    var e = document.createEvent("Event");
                    e.initEvent(name, true, true);
                    // can bubble, and is cancellable
                    this.telInput.dispatchEvent(e);
                }
            }, {
                key: "_showDropdown",
                value: function _showDropdown() {
                    this.countryList.classList.remove("iti__hide");
                    this.selectedFlag.setAttribute("aria-expanded", "true");
                    this._setDropdownPosition();
                    // update highlighting and scroll to active list item
                    if (this.activeItem) {
                        this._highlightListItem(this.activeItem, false);
                        this._scrollTo(this.activeItem, true);
                    }
                    // bind all the dropdown-related listeners: mouseover, click, click-off, keydown
                    this._bindDropdownListeners();
                    // update the arrow
                    this.dropdownArrow.classList.add("iti__arrow--up");
                    this._trigger("open:countrydropdown");
                }
            }, {
                key: "_toggleClass",
                value: function _toggleClass(el, className, shouldHaveClass) {
                    if (shouldHaveClass && !el.classList.contains(className)) el.classList.add(className); else if (!shouldHaveClass && el.classList.contains(className)) el.classList.remove(className);
                }
            }, {
                key: "_setDropdownPosition",
                value: function _setDropdownPosition() {
                    var _this8 = this;
                    if (this.options.dropdownContainer) {
                        this.options.dropdownContainer.appendChild(this.dropdown);
                    }
                    if (!this.isMobile) {
                        var pos = this.telInput.getBoundingClientRect();
                        // windowTop from https://stackoverflow.com/a/14384091/217866
                        var windowTop = window.pageYOffset || document.documentElement.scrollTop;
                        var inputTop = pos.top + windowTop;
                        var dropdownHeight = this.countryList.offsetHeight;
                        // dropdownFitsBelow = (dropdownBottom < windowBottom)
                        var dropdownFitsBelow = inputTop + this.telInput.offsetHeight + dropdownHeight < windowTop + window.innerHeight;
                        var dropdownFitsAbove = inputTop - dropdownHeight > windowTop;
                        // by default, the dropdown will be below the input. If we want to position it above the
                        // input, we add the dropup class.
                        this._toggleClass(this.countryList, "iti__country-list--dropup", !dropdownFitsBelow && dropdownFitsAbove);
                        // if dropdownContainer is enabled, calculate postion
                        if (this.options.dropdownContainer) {
                            // by default the dropdown will be directly over the input because it's not in the flow.
                            // If we want to position it below, we need to add some extra top value.
                            var extraTop = !dropdownFitsBelow && dropdownFitsAbove ? 0 : this.telInput.offsetHeight;
                            // calculate placement
                            this.dropdown.style.top = "".concat(inputTop + extraTop, "px");
                            this.dropdown.style.left = "".concat(pos.left + document.body.scrollLeft, "px");
                            // close menu on window scroll
                            this._handleWindowScroll = function() {
                                return _this8._closeDropdown();
                            };
                            window.addEventListener("scroll", this._handleWindowScroll);
                        }
                    }
                }
            }, {
                key: "_getClosestListItem",
                value: function _getClosestListItem(target) {
                    var el = target;
                    while (el && el !== this.countryList && !el.classList.contains("iti__country")) {
                        el = el.parentNode;
                    }
                    // if we reached the countryList element, then return null
                    return el === this.countryList ? null : el;
                }
            }, {
                key: "_bindDropdownListeners",
                value: function _bindDropdownListeners() {
                    var _this9 = this;
                    // when mouse over a list item, just highlight that one
                    // we add the class "highlight", so if they hit "enter" we know which one to select
                    this._handleMouseoverCountryList = function(e) {
                        // handle event delegation, as we're listening for this event on the countryList
                        var listItem = _this9._getClosestListItem(e.target);
                        if (listItem) _this9._highlightListItem(listItem, false);
                    };
                    this.countryList.addEventListener("mouseover", this._handleMouseoverCountryList);
                    // listen for country selection
                    this._handleClickCountryList = function(e) {
                        var listItem = _this9._getClosestListItem(e.target);
                        if (listItem) _this9._selectListItem(listItem);
                    };
                    this.countryList.addEventListener("click", this._handleClickCountryList);
                    // click off to close
                    // (except when this initial opening click is bubbling up)
                    // we cannot just stopPropagation as it may be needed to close another instance
                    var isOpening = true;
                    this._handleClickOffToClose = function() {
                        if (!isOpening) _this9._closeDropdown();
                        isOpening = false;
                    };
                    document.documentElement.addEventListener("click", this._handleClickOffToClose);
                    // listen for up/down scrolling, enter to select, or letters to jump to country name.
                    // use keydown as keypress doesn't fire for non-char keys and we want to catch if they
                    // just hit down and hold it to scroll down (no keyup event).
                    // listen on the document because that's where key events are triggered if no input has focus
                    var query = "";
                    var queryTimer = null;
                    this._handleKeydownOnDropdown = function(e) {
                        // prevent down key from scrolling the whole page,
                        // and enter key from submitting a form etc
                        e.preventDefault();
                        // up and down to navigate
                        if (e.key === "ArrowUp" || e.key === "Up" || e.key === "ArrowDown" || e.key === "Down") _this9._handleUpDownKey(e.key); else if (e.key === "Enter") _this9._handleEnterKey(); else if (e.key === "Escape") _this9._closeDropdown(); else if (/^[a-zA-ZÀ-ÿа-яА-Я ]$/.test(e.key)) {
                            // jump to countries that start with the query string
                            if (queryTimer) clearTimeout(queryTimer);
                            query += e.key.toLowerCase();
                            _this9._searchForCountry(query);
                            // if the timer hits 1 second, reset the query
                            queryTimer = setTimeout(function() {
                                query = "";
                            }, 1e3);
                        }
                    };
                    document.addEventListener("keydown", this._handleKeydownOnDropdown);
                }
            }, {
                key: "_handleUpDownKey",
                value: function _handleUpDownKey(key) {
                    var next = key === "ArrowUp" || key === "Up" ? this.highlightedItem.previousElementSibling : this.highlightedItem.nextElementSibling;
                    if (next) {
                        // skip the divider
                        if (next.classList.contains("iti__divider")) {
                            next = key === "ArrowUp" || key === "Up" ? next.previousElementSibling : next.nextElementSibling;
                        }
                        this._highlightListItem(next, true);
                    }
                }
            }, {
                key: "_handleEnterKey",
                value: function _handleEnterKey() {
                    if (this.highlightedItem) this._selectListItem(this.highlightedItem);
                }
            }, {
                key: "_searchForCountry",
                value: function _searchForCountry(query) {
                    for (var i = 0; i < this.countries.length; i++) {
                        if (this._startsWith(this.countries[i].name, query)) {
                            var listItem = this.countryList.querySelector("#iti-".concat(this.id, "__item-").concat(this.countries[i].iso2));
                            // update highlighting and scroll
                            this._highlightListItem(listItem, false);
                            this._scrollTo(listItem, true);
                            break;
                        }
                    }
                }
            }, {
                key: "_startsWith",
                value: function _startsWith(a, b) {
                    return a.substr(0, b.length).toLowerCase() === b;
                }
            }, {
                key: "_updateValFromNumber",
                value: function _updateValFromNumber(originalNumber) {
                    var number = originalNumber;
                    if (this.options.formatOnDisplay && window.intlTelInputUtils && this.selectedCountryData) {
                        var useNational = !this.options.separateDialCode && (this.options.nationalMode || number.charAt(0) !== "+");
                        var _intlTelInputUtils$nu = intlTelInputUtils.numberFormat, NATIONAL = _intlTelInputUtils$nu.NATIONAL, INTERNATIONAL = _intlTelInputUtils$nu.INTERNATIONAL;
                        var format = useNational ? NATIONAL : INTERNATIONAL;
                        number = intlTelInputUtils.formatNumber(number, this.selectedCountryData.iso2, format);
                    }
                    number = this._beforeSetNumber(number);
                    this.telInput.value = number;
                }
            }, {
                key: "_updateFlagFromNumber",
                value: function _updateFlagFromNumber(originalNumber) {
                    // if we're in nationalMode and we already have US/Canada selected, make sure the number starts
                    // with a +1 so _getDialCode will be able to extract the area code
                    // update: if we dont yet have selectedCountryData, but we're here (trying to update the flag
                    // from the number), that means we're initialising the plugin with a number that already has a
                    // dial code, so fine to ignore this bit
                    var number = originalNumber;
                    var selectedDialCode = this.selectedCountryData.dialCode;
                    var isNanp = selectedDialCode === "1";
                    if (number && this.options.nationalMode && isNanp && number.charAt(0) !== "+") {
                        if (number.charAt(0) !== "1") number = "1".concat(number);
                        number = "+".concat(number);
                    }
                    // update flag if user types area code for another country
                    if (this.options.separateDialCode && selectedDialCode && number.charAt(0) !== "+") {
                        number = "+".concat(selectedDialCode).concat(number);
                    }
                    // try and extract valid dial code from input
                    var dialCode = this._getDialCode(number, true);
                    var numeric = this._getNumeric(number);
                    var countryCode = null;
                    if (dialCode) {
                        var countryCodes = this.countryCodes[this._getNumeric(dialCode)];
                        // check if the right country is already selected. this should be false if the number is
                        // longer than the matched dial code because in this case we need to make sure that if
                        // there are multiple country matches, that the first one is selected (note: we could
                        // just check that here, but it requires the same loop that we already have later)
                        var alreadySelected = countryCodes.indexOf(this.selectedCountryData.iso2) !== -1 && numeric.length <= dialCode.length - 1;
                        var isRegionlessNanpNumber = selectedDialCode === "1" && this._isRegionlessNanp(numeric);
                        // only update the flag if:
                        // A) NOT (we currently have a NANP flag selected, and the number is a regionlessNanp)
                        // AND
                        // B) the right country is not already selected
                        if (!isRegionlessNanpNumber && !alreadySelected) {
                            // if using onlyCountries option, countryCodes[0] may be empty, so we must find the first
                            // non-empty index
                            for (var j = 0; j < countryCodes.length; j++) {
                                if (countryCodes[j]) {
                                    countryCode = countryCodes[j];
                                    break;
                                }
                            }
                        }
                    } else if (number.charAt(0) === "+" && numeric.length) {
                        // invalid dial code, so empty
                        // Note: use getNumeric here because the number has not been formatted yet, so could contain
                        // bad chars
                        countryCode = "";
                    } else if (!number || number === "+") {
                        // empty, or just a plus, so default
                        countryCode = this.defaultCountry;
                    }
                    if (countryCode !== null) {
                        return this._setFlag(countryCode);
                    }
                    return false;
                }
            }, {
                key: "_isRegionlessNanp",
                value: function _isRegionlessNanp(number) {
                    var numeric = this._getNumeric(number);
                    if (numeric.charAt(0) === "1") {
                        var areaCode = numeric.substr(1, 3);
                        return regionlessNanpNumbers.indexOf(areaCode) !== -1;
                    }
                    return false;
                }
            }, {
                key: "_highlightListItem",
                value: function _highlightListItem(listItem, shouldFocus) {
                    var prevItem = this.highlightedItem;
                    if (prevItem) prevItem.classList.remove("iti__highlight");
                    this.highlightedItem = listItem;
                    this.highlightedItem.classList.add("iti__highlight");
                    if (shouldFocus) this.highlightedItem.focus();
                }
            }, {
                key: "_getCountryData",
                value: function _getCountryData(countryCode, ignoreOnlyCountriesOption, allowFail) {
                    var countryList = ignoreOnlyCountriesOption ? allCountries : this.countries;
                    for (var i = 0; i < countryList.length; i++) {
                        if (countryList[i].iso2 === countryCode) {
                            return countryList[i];
                        }
                    }
                    if (allowFail) {
                        return null;
                    }
                    throw new Error("No country data for '".concat(countryCode, "'"));
                }
            }, {
                key: "_setFlag",
                value: function _setFlag(countryCode) {
                    var prevCountry = this.selectedCountryData.iso2 ? this.selectedCountryData : {};
                    // do this first as it will throw an error and stop if countryCode is invalid
                    this.selectedCountryData = countryCode ? this._getCountryData(countryCode, false, false) : {};
                    // update the defaultCountry - we only need the iso2 from now on, so just store that
                    if (this.selectedCountryData.iso2) {
                        this.defaultCountry = this.selectedCountryData.iso2;
                    }
                    this.selectedFlagInner.setAttribute("class", "iti__flag iti__".concat(countryCode));
                    // update the selected country's title attribute
                    var title = countryCode ? "".concat(this.selectedCountryData.name, ": +").concat(this.selectedCountryData.dialCode) : "Unknown";
                    this.selectedFlag.setAttribute("title", title);
                    if (this.options.separateDialCode) {
                        var dialCode = this.selectedCountryData.dialCode ? "+".concat(this.selectedCountryData.dialCode) : "";
                        this.selectedDialCode.innerHTML = dialCode;
                        // offsetWidth is zero if input is in a hidden container during initialisation
                        var selectedFlagWidth = this.selectedFlag.offsetWidth || this._getHiddenSelectedFlagWidth();
                        // add 6px of padding after the grey selected-dial-code box, as this is what we use in the css
                        this.telInput.style.paddingLeft = "".concat(selectedFlagWidth + 6, "px");
                    }
                    // and the input's placeholder
                    this._updatePlaceholder();
                    // update the active list item
                    if (this.options.allowDropdown) {
                        var prevItem = this.activeItem;
                        if (prevItem) {
                            prevItem.classList.remove("iti__active");
                            prevItem.setAttribute("aria-selected", "false");
                        }
                        if (countryCode) {
                            // check if there is a preferred item first, else fall back to standard
                            var nextItem = this.countryList.querySelector("#iti-".concat(this.id, "__item-").concat(countryCode, "-preferred")) || this.countryList.querySelector("#iti-".concat(this.id, "__item-").concat(countryCode));
                            nextItem.setAttribute("aria-selected", "true");
                            nextItem.classList.add("iti__active");
                            this.activeItem = nextItem;
                            this.selectedFlag.setAttribute("aria-activedescendant", nextItem.getAttribute("id"));
                        }
                    }
                    // return if the flag has changed or not
                    return prevCountry.iso2 !== countryCode;
                }
            }, {
                key: "_getHiddenSelectedFlagWidth",
                value: function _getHiddenSelectedFlagWidth() {
                    // to get the right styling to apply, all we need is a shallow clone of the container,
                    // and then to inject a deep clone of the selectedFlag element
                    var containerClone = this.telInput.parentNode.cloneNode();
                    containerClone.style.visibility = "hidden";
                    document.body.appendChild(containerClone);
                    var flagsContainerClone = this.flagsContainer.cloneNode();
                    containerClone.appendChild(flagsContainerClone);
                    var selectedFlagClone = this.selectedFlag.cloneNode(true);
                    flagsContainerClone.appendChild(selectedFlagClone);
                    var width = selectedFlagClone.offsetWidth;
                    containerClone.parentNode.removeChild(containerClone);
                    return width;
                }
            }, {
                key: "_updatePlaceholder",
                value: function _updatePlaceholder() {
                    var shouldSetPlaceholder = this.options.autoPlaceholder === "aggressive" || !this.hadInitialPlaceholder && this.options.autoPlaceholder === "polite";
                    if (window.intlTelInputUtils && shouldSetPlaceholder) {
                        var numberType = intlTelInputUtils.numberType[this.options.placeholderNumberType];
                        var placeholder = this.selectedCountryData.iso2 ? intlTelInputUtils.getExampleNumber(this.selectedCountryData.iso2, this.options.nationalMode, numberType) : "";
                        placeholder = this._beforeSetNumber(placeholder);
                        if (typeof this.options.customPlaceholder === "function") {
                            placeholder = this.options.customPlaceholder(placeholder, this.selectedCountryData);
                        }
                        this.telInput.setAttribute("placeholder", placeholder);
                    }
                }
            }, {
                key: "_selectListItem",
                value: function _selectListItem(listItem) {
                    // update selected flag and active list item
                    var flagChanged = this._setFlag(listItem.getAttribute("data-country-code"));
                    this._closeDropdown();
                    this._updateDialCode(listItem.getAttribute("data-dial-code"), true);
                    // focus the input
                    this.telInput.focus();
                    // put cursor at end - this fix is required for FF and IE11 (with nationalMode=false i.e. auto
                    // inserting dial code), who try to put the cursor at the beginning the first time
                    var len = this.telInput.value.length;
                    this.telInput.setSelectionRange(len, len);
                    if (flagChanged) {
                        this._triggerCountryChange();
                    }
                }
            }, {
                key: "_closeDropdown",
                value: function _closeDropdown() {
                    this.countryList.classList.add("iti__hide");
                    this.selectedFlag.setAttribute("aria-expanded", "false");
                    // update the arrow
                    this.dropdownArrow.classList.remove("iti__arrow--up");
                    // unbind key events
                    document.removeEventListener("keydown", this._handleKeydownOnDropdown);
                    document.documentElement.removeEventListener("click", this._handleClickOffToClose);
                    this.countryList.removeEventListener("mouseover", this._handleMouseoverCountryList);
                    this.countryList.removeEventListener("click", this._handleClickCountryList);
                    // remove menu from container
                    if (this.options.dropdownContainer) {
                        if (!this.isMobile) window.removeEventListener("scroll", this._handleWindowScroll);
                        if (this.dropdown.parentNode) this.dropdown.parentNode.removeChild(this.dropdown);
                    }
                    this._trigger("close:countrydropdown");
                }
            }, {
                key: "_scrollTo",
                value: function _scrollTo(element, middle) {
                    var container = this.countryList;
                    // windowTop from https://stackoverflow.com/a/14384091/217866
                    var windowTop = window.pageYOffset || document.documentElement.scrollTop;
                    var containerHeight = container.offsetHeight;
                    var containerTop = container.getBoundingClientRect().top + windowTop;
                    var containerBottom = containerTop + containerHeight;
                    var elementHeight = element.offsetHeight;
                    var elementTop = element.getBoundingClientRect().top + windowTop;
                    var elementBottom = elementTop + elementHeight;
                    var newScrollTop = elementTop - containerTop + container.scrollTop;
                    var middleOffset = containerHeight / 2 - elementHeight / 2;
                    if (elementTop < containerTop) {
                        // scroll up
                        if (middle) newScrollTop -= middleOffset;
                        container.scrollTop = newScrollTop;
                    } else if (elementBottom > containerBottom) {
                        // scroll down
                        if (middle) newScrollTop += middleOffset;
                        var heightDifference = containerHeight - elementHeight;
                        container.scrollTop = newScrollTop - heightDifference;
                    }
                }
            }, {
                key: "_updateDialCode",
                value: function _updateDialCode(newDialCodeBare, hasSelectedListItem) {
                    var inputVal = this.telInput.value;
                    // save having to pass this every time
                    var newDialCode = "+".concat(newDialCodeBare);
                    var newNumber;
                    if (inputVal.charAt(0) === "+") {
                        // there's a plus so we're dealing with a replacement (doesn't matter if nationalMode or not)
                        var prevDialCode = this._getDialCode(inputVal);
                        if (prevDialCode) {
                            // current number contains a valid dial code, so replace it
                            newNumber = inputVal.replace(prevDialCode, newDialCode);
                        } else {
                            // current number contains an invalid dial code, so ditch it
                            // (no way to determine where the invalid dial code ends and the rest of the number begins)
                            newNumber = newDialCode;
                        }
                    } else if (this.options.nationalMode || this.options.separateDialCode) {
                        // don't do anything
                        return;
                    } else {
                        // nationalMode is disabled
                        if (inputVal) {
                            // there is an existing value with no dial code: prefix the new dial code
                            newNumber = newDialCode + inputVal;
                        } else if (hasSelectedListItem || !this.options.autoHideDialCode) {
                            // no existing value and either they've just selected a list item, or autoHideDialCode is
                            // disabled: insert new dial code
                            newNumber = newDialCode;
                        } else {
                            return;
                        }
                    }
                    this.telInput.value = newNumber;
                }
            }, {
                key: "_getDialCode",
                value: function _getDialCode(number, includeAreaCode) {
                    var dialCode = "";
                    // only interested in international numbers (starting with a plus)
                    if (number.charAt(0) === "+") {
                        var numericChars = "";
                        // iterate over chars
                        for (var i = 0; i < number.length; i++) {
                            var c = number.charAt(i);
                            // if char is number (https://stackoverflow.com/a/8935649/217866)
                            if (!isNaN(parseInt(c, 10))) {
                                numericChars += c;
                                // if current numericChars make a valid dial code
                                if (includeAreaCode) {
                                    if (this.countryCodes[numericChars]) {
                                        // store the actual raw string (useful for matching later)
                                        dialCode = number.substr(0, i + 1);
                                    }
                                } else {
                                    if (this.dialCodes[numericChars]) {
                                        dialCode = number.substr(0, i + 1);
                                        // if we're just looking for a dial code, we can break as soon as we find one
                                        break;
                                    }
                                }
                                // stop searching as soon as we can - in this case when we hit max len
                                if (numericChars.length === this.countryCodeMaxLen) {
                                    break;
                                }
                            }
                        }
                    }
                    return dialCode;
                }
            }, {
                key: "_getFullNumber",
                value: function _getFullNumber() {
                    var val = this.telInput.value.trim();
                    var dialCode = this.selectedCountryData.dialCode;
                    var prefix;
                    var numericVal = this._getNumeric(val);
                    if (this.options.separateDialCode && val.charAt(0) !== "+" && dialCode && numericVal) {
                        // when using separateDialCode, it is visible so is effectively part of the typed number
                        prefix = "+".concat(dialCode);
                    } else {
                        prefix = "";
                    }
                    return prefix + val;
                }
            }, {
                key: "_beforeSetNumber",
                value: function _beforeSetNumber(originalNumber) {
                    var number = originalNumber;
                    if (this.options.separateDialCode) {
                        var dialCode = this._getDialCode(number);
                        // if there is a valid dial code
                        if (dialCode) {
                            // in case _getDialCode returned an area code as well
                            dialCode = "+".concat(this.selectedCountryData.dialCode);
                            // a lot of numbers will have a space separating the dial code and the main number, and
                            // some NANP numbers will have a hyphen e.g. +1 684-733-1234 - in both cases we want to get
                            // rid of it
                            // NOTE: don't just trim all non-numerics as may want to preserve an open parenthesis etc
                            var start = number[dialCode.length] === " " || number[dialCode.length] === "-" ? dialCode.length + 1 : dialCode.length;
                            number = number.substr(start);
                        }
                    }
                    return this._cap(number);
                }
            }, {
                key: "_triggerCountryChange",
                value: function _triggerCountryChange() {
                    this._trigger("countrychange");
                }
            }, {
                key: "handleAutoCountry",
                value: function handleAutoCountry() {
                    if (this.options.initialCountry === "auto") {
                        // we must set this even if there is an initial val in the input: in case the initial val is
                        // invalid and they delete it - they should see their auto country
                        this.defaultCountry = window.intlTelInputGlobals.autoCountry;
                        // if there's no initial value in the input, then update the flag
                        if (!this.telInput.value) {
                            this.setCountry(this.defaultCountry);
                        }
                        this.resolveAutoCountryPromise();
                    }
                }
            }, {
                key: "handleUtils",
                value: function handleUtils() {
                    // if the request was successful
                    if (window.intlTelInputUtils) {
                        // if there's an initial value in the input, then format it
                        if (this.telInput.value) {
                            this._updateValFromNumber(this.telInput.value);
                        }
                        this._updatePlaceholder();
                    }
                    this.resolveUtilsScriptPromise();
                }
            }, {
                key: "destroy",
                value: function destroy() {
                    var form = this.telInput.form;
                    if (this.options.allowDropdown) {
                        // make sure the dropdown is closed (and unbind listeners)
                        this._closeDropdown();
                        this.selectedFlag.removeEventListener("click", this._handleClickSelectedFlag);
                        this.flagsContainer.removeEventListener("keydown", this._handleFlagsContainerKeydown);
                        // label click hack
                        var label = this._getClosestLabel();
                        if (label) label.removeEventListener("click", this._handleLabelClick);
                    }
                    // unbind hiddenInput listeners
                    if (this.hiddenInput && form) form.removeEventListener("submit", this._handleHiddenInputSubmit);
                    // unbind autoHideDialCode listeners
                    if (this.options.autoHideDialCode) {
                        if (form) form.removeEventListener("submit", this._handleSubmitOrBlurEvent);
                        this.telInput.removeEventListener("blur", this._handleSubmitOrBlurEvent);
                    }
                    // unbind key events, and cut/paste events
                    this.telInput.removeEventListener("keyup", this._handleKeyupEvent);
                    this.telInput.removeEventListener("cut", this._handleClipboardEvent);
                    this.telInput.removeEventListener("paste", this._handleClipboardEvent);
                    // remove attribute of id instance: data-intl-tel-input-id
                    this.telInput.removeAttribute("data-intl-tel-input-id");
                    // remove markup (but leave the original input)
                    var wrapper = this.telInput.parentNode;
                    wrapper.parentNode.insertBefore(this.telInput, wrapper);
                    wrapper.parentNode.removeChild(wrapper);
                    delete window.intlTelInputGlobals.instances[this.id];
                }
            }, {
                key: "getExtension",
                value: function getExtension() {
                    if (window.intlTelInputUtils) {
                        return intlTelInputUtils.getExtension(this._getFullNumber(), this.selectedCountryData.iso2);
                    }
                    return "";
                }
            }, {
                key: "getNumber",
                value: function getNumber(format) {
                    if (window.intlTelInputUtils) {
                        var iso2 = this.selectedCountryData.iso2;
                        return intlTelInputUtils.formatNumber(this._getFullNumber(), iso2, format);
                    }
                    return "";
                }
            }, {
                key: "getNumberType",
                value: function getNumberType() {
                    if (window.intlTelInputUtils) {
                        return intlTelInputUtils.getNumberType(this._getFullNumber(), this.selectedCountryData.iso2);
                    }
                    return -99;
                }
            }, {
                key: "getSelectedCountryData",
                value: function getSelectedCountryData() {
                    return this.selectedCountryData;
                }
            }, {
                key: "getValidationError",
                value: function getValidationError() {
                    if (window.intlTelInputUtils) {
                        var iso2 = this.selectedCountryData.iso2;
                        return intlTelInputUtils.getValidationError(this._getFullNumber(), iso2);
                    }
                    return -99;
                }
            }, {
                key: "isValidNumber",
                value: function isValidNumber() {
                    var val = this._getFullNumber().trim();
                    var countryCode = this.options.nationalMode ? this.selectedCountryData.iso2 : "";
                    return window.intlTelInputUtils ? intlTelInputUtils.isValidNumber(val, countryCode) : null;
                }
            }, {
                key: "setCountry",
                value: function setCountry(originalCountryCode) {
                    var countryCode = originalCountryCode.toLowerCase();
                    // check if already selected
                    if (!this.selectedFlagInner.classList.contains("iti__".concat(countryCode))) {
                        this._setFlag(countryCode);
                        this._updateDialCode(this.selectedCountryData.dialCode, false);
                        this._triggerCountryChange();
                    }
                }
            }, {
                key: "setNumber",
                value: function setNumber(number) {
                    // we must update the flag first, which updates this.selectedCountryData, which is used for
                    // formatting the number before displaying it
                    var flagChanged = this._updateFlagFromNumber(number);
                    this._updateValFromNumber(number);
                    if (flagChanged) {
                        this._triggerCountryChange();
                    }
                }
            }, {
                key: "setPlaceholderNumberType",
                value: function setPlaceholderNumberType(type) {
                    this.options.placeholderNumberType = type;
                    this._updatePlaceholder();
                }
            } ]);
            return Iti;
        }();
        /********************
 *  STATIC METHODS
 ********************/
        // get the country data object
        intlTelInputGlobals.getCountryData = function() {
            return allCountries;
        };
        // inject a <script> element to load utils.js
        var injectScript = function injectScript(path, handleSuccess, handleFailure) {
            // inject a new script element into the page
            var script = document.createElement("script");
            script.onload = function() {
                forEachInstance("handleUtils");
                if (handleSuccess) handleSuccess();
            };
            script.onerror = function() {
                forEachInstance("rejectUtilsScriptPromise");
                if (handleFailure) handleFailure();
            };
            script.className = "iti-load-utils";
            script.async = true;
            script.src = path;
            document.body.appendChild(script);
        };
        // load the utils script
        intlTelInputGlobals.loadUtils = function(path) {
            // 2 options:
            // 1) not already started loading (start)
            // 2) already started loading (do nothing - just wait for the onload callback to fire, which will
            // trigger handleUtils on all instances, invoking their resolveUtilsScriptPromise functions)
            if (!window.intlTelInputUtils && !window.intlTelInputGlobals.startedLoadingUtilsScript) {
                // only do this once
                window.intlTelInputGlobals.startedLoadingUtilsScript = true;
                // if we have promises, then return a promise
                if (typeof Promise !== "undefined") {
                    return new Promise(function(resolve, reject) {
                        return injectScript(path, resolve, reject);
                    });
                }
                injectScript(path);
            }
            return null;
        };
        // default options
        intlTelInputGlobals.defaults = defaults;
        // version
        intlTelInputGlobals.version = "17.0.19";
        // convenience wrapper
        return function(input, options) {
            var iti = new Iti(input, options);
            iti._init();
            input.setAttribute("data-intl-tel-input-id", iti.id);
            window.intlTelInputGlobals.instances[iti.id] = iti;
            return iti;
        };
    }();
});

/***/ }),

/***/ "./node_modules/intl-tel-input/index.js":
/*!**********************************************!*\
  !*** ./node_modules/intl-tel-input/index.js ***!
  \**********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

/**
 * Exposing intl-tel-input as a component
 */
module.exports = __webpack_require__(/*! ./build/js/intlTelInput */ "./node_modules/intl-tel-input/build/js/intlTelInput.js");


/***/ }),

/***/ "./node_modules/mapbox-gl/dist/mapbox-gl.js":
/*!**************************************************!*\
  !*** ./node_modules/mapbox-gl/dist/mapbox-gl.js ***!
  \**************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

/* provided dependency */ var process = __webpack_require__(/*! process/browser.js */ "./node_modules/process/browser.js");
/* Mapbox GL JS is Copyright © 2020 Mapbox and subject to the Mapbox Terms of Service ((https://www.mapbox.com/legal/tos/). */
(function (global, factory) {
 true ? module.exports = factory() :
0;
}(this, (function () { 'use strict';

/* eslint-disable */

var shared, worker, mapboxgl;
// define gets called three times: one for each chunk. we rely on the order
// they're imported to know which is which
function define(_, chunk) {
if (!shared) {
    shared = chunk;
} else if (!worker) {
    worker = chunk;
} else {
    var workerBundleString = "self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; (" + shared + ")(sharedChunk); (" + worker + ")(sharedChunk); self.onerror = null;"

    var sharedChunk = {};
    shared(sharedChunk);
    mapboxgl = chunk(sharedChunk);
    if (typeof window !== 'undefined') {
        mapboxgl.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], { type: 'text/javascript' }));
    }
}
}


define(["exports"],(function(t){"use strict";var e="2.6.1",r=n;function n(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n;}n.prototype.sampleCurveX=function(t){return ((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return ((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return (3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){var r,n,i,s,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(s=this.sampleCurveX(i)-t,Math.abs(s)<e)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i-=s/o;}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(s=this.sampleCurveX(i),Math.abs(s-t)<e)return i;t>s?r=i:n=i,i=.5*(n-r)+r;}return i},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=s;function s(t,e){this.x=t,this.y=e;}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=n,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-n*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(t){return t instanceof s?t:Array.isArray(t)?new s(t[0],t[1]):t};var a="undefined"!=typeof self?self:{};const o=Math.pow(2,53)-1,l=Math.PI/180,u=180/Math.PI;function c(t){return t*l}function h(t){return t*u}const p=[[0,0],[1,0],[1,1],[0,1]];function d(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function f(t,e,n,i){const s=new r(t,e,n,i);return function(t){return s.solve(t)}}const y=f(.25,.1,.25,1);function m(t,e,r){return Math.min(r,Math.max(e,t))}function g(t,e,r){const n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function x(t,e,r){if(!t.length)return r(null,[]);let n=t.length;const i=new Array(t.length);let s=null;t.forEach(((t,a)=>{e(t,((t,e)=>{t&&(s=t),i[a]=e,0==--n&&r(s,i);}));}));}function v(t){const e=[];for(const r in t)e.push(t[r]);return e}function b(t,...e){for(const r of e)for(const e in r)t[e]=r[e];return t}let w=1;function _(){return w++}function A(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function k(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function S(t){return !!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function I(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e));}));}function z(t,e){return -1!==t.indexOf(e,t.length-e.length)}function T(t,e,r){const n={};for(const i in t)n[i]=e.call(r||this,t[i],i,t);return n}function M(t,e,r){const n={};for(const i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function C(t){return Array.isArray(t)?t.map(C):"object"==typeof t&&t?T(t,C):t}const B={};function E(t){B[t]||("undefined"!=typeof console&&console.warn(t),B[t]=!0);}function D(t,e,r){return (r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function P(t){let e=0;for(let r,n,i=0,s=t.length,a=s-1;i<s;a=i++)r=t[i],n=t[a],e+=(n.x-r.x)*(r.y+n.y);return e}function V(){return "undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function F(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,r,n,i)=>{const s=n||i;return e[r]=!s||s.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t;}return e}let L,R,$,U=null;function O(t){if(null==U){const e=t.navigator?t.navigator.userAgent:null;U=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")));}return U}function j(t){try{const e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return !1}}const q={now:()=>void 0!==$?$:a.performance.now(),setNow(t){$=t;},restoreNow(){$=void 0;},frame(t){const e=a.requestAnimationFrame(t);return {cancel:()=>a.cancelAnimationFrame(e)}},getImageData(t,e=0){const r=a.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(L||(L=a.document.createElement("a")),L.href=t,L.href),get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return !!a.matchMedia&&(null==R&&(R=a.matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}};let N;const Z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==N){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{N=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t;}catch(e){N=t;}}return N},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},G={supported:!1,testSupport:function(t){!Y&&K&&(H?J(t):X=t);}};let X,K,Y=!1,H=!1;function J(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,K),t.isContextLost())return;G.supported=!0;}catch(t){}t.deleteTexture(e),Y=!0;}a.document&&(K=a.document.createElement("img"),K.onload=function(){X&&J(X),X=null,H=!0;},K.onerror=function(){Y=!0,X=null;},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const W="01",Q="NO_ACCESS_TOKEN";function tt(t){return 0===t.indexOf("mapbox:")}function et(t){return Z.API_URL_REGEX.test(t)}const rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function nt(t){const e=t.match(rt);if(!e)throw new Error("Unable to parse URL object");return {protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function it(t){const e=t.params.length?`?${t.params.join("&")}`:"";return `${t.protocol}://${t.authority}${t.path}${e}`}function st(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(t){return null}}class at{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null;}getStorageKey(t){const e=st(Z.ACCESS_TOKEN);let r="";return r=e&&e.u?a.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(Number("0x"+e))))):Z.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${r}`:`mapbox.eventData:${r}`}fetchEventData(){const t=j("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const t=a.localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const n=a.localStorage.getItem(r);n&&(this.anonId=n);}catch(t){E("Unable to read from LocalStorage");}}saveEventData(){const t=j("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(e,JSON.stringify(this.eventData));}catch(t){E("Unable to write to LocalStorage");}}processRequests(t){}postEvent(t,r,n,i){if(!Z.EVENTS_URL)return;const s=nt(Z.EVENTS_URL);s.params.push(`access_token=${i||Z.ACCESS_TOKEN||""}`);const a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:W,userId:this.anonId},o=r?b(a,r):a,l={url:it(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([o])};this.pendingRequest=zt(l,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(i);}));}queueRequest(t,e){this.queue.push(t),this.processRequests(e);}}const ot=new class extends at{constructor(t){super("appUserTurnstile"),this._customAccessToken=t;}postTurnstileEvent(t,e){Z.EVENTS_URL&&Z.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>tt(t)||et(t)))&&this.queueRequest(Date.now(),e);}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=st(Z.ACCESS_TOKEN),r=e?e.u:Z.ACCESS_TOKEN;let n=r!==this.eventData.tokenU;S(this.anonId)||(this.anonId=A(),n=!0);const i=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(i),r=(i-this.eventData.lastSuccess)/864e5;n=n||r>=1||r<-1||t.getDate()!==e.getDate();}else n=!0;if(!n)return this.processRequests();this.postEvent(i,{"enabled.telemetry":!1},(t=>{t||(this.eventData.lastSuccess=i,this.eventData.tokenU=r);}),t);}},lt=ot.postTurnstileEvent.bind(ot),ut=new class extends at{constructor(){super("map.load"),this.success={},this.skuToken="";}postMapLoadEvent(t,e,r,n){this.skuToken=e,this.errorCb=n,Z.EVENTS_URL&&(r||Z.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(Q)));}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),S(this.anonId)||(this.anonId=A()),this.postEvent(r,{skuToken:this.skuToken},(t=>{t?this.errorCb(t):e&&(this.success[e]=!0);}),t));}},ct=ut.postMapLoadEvent.bind(ut),ht=new class extends at{constructor(){super("map.auth"),this.success={},this.skuToken="";}getSession(t,e,r,n){if(!Z.API_URL||!Z.SESSION_PATH)return;const i=nt(Z.API_URL+Z.SESSION_PATH);i.params.push(`sku=${e||""}`),i.params.push(`access_token=${n||Z.ACCESS_TOKEN||""}`);const s={url:it(i),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Tt(s,(t=>{this.pendingRequest=null,r(t),this.saveEventData(),this.processRequests(n);}));}getSessionAPI(t,e,r,n){this.skuToken=e,this.errorCb=n,Z.SESSION_PATH&&Z.API_URL&&(r||Z.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(Q)));}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,(t=>{t?this.errorCb(t):e&&(this.success[e]=!0);}),t);}},pt=ht.getSessionAPI.bind(ht),dt=new Set,ft="mapbox-tiles";let yt,mt,gt=500,xt=50;function vt(){a.caches&&!yt&&(yt=a.caches.open(ft));}function bt(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let wt=1/0;const _t={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(_t);class At extends Error{constructor(t,e,r){401===e&&et(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=r;}toString(){return `${this.name}: ${this.message} (${this.status}): ${this.url}`}}const kt=V()?()=>self.worker&&self.worker.referrer:()=>("blob:"===a.location.protocol?a.parent:a).location.href;const St=function(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(kt())&&!/^\w+:/.test(r))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){const r=new a.AbortController,n=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:kt(),signal:r.signal});let i=!1,s=!1;const o=(l=n.url).indexOf("sku=")>0&&et(l);var l;"json"===t.type&&n.headers.set("Accept","application/json");const u=(r,i,l)=>{if(s)return;if(r&&"SecurityError"!==r.message&&E(r),i&&l)return c(i);const u=Date.now();a.fetch(n).then((r=>{if(r.ok){const t=o?r.clone():null;return c(r,t,u)}return e(new At(r.statusText,r.status,t.url))})).catch((t=>{20!==t.code&&e(new Error(t.message));}));},c=(r,o,l)=>{("arrayBuffer"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text()).then((t=>{s||(o&&l&&function(t,e,r){if(vt(),!yt)return;const n={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach(((t,e)=>n.headers.set(e,t)));const i=F(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&n.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-r<42e4||function(t,e){if(void 0===mt)try{new Response(new ReadableStream),mt=!0;}catch(t){mt=!1;}mt?e(t.body):t.blob().then(e);}(e,(e=>{const r=new a.Response(e,n);vt(),yt&&yt.then((e=>e.put(bt(t.url),r))).catch((t=>E(t.message)));})));}(n,o,l),i=!0,e(null,t,r.headers.get("Cache-Control"),r.headers.get("Expires")));})).catch((t=>{s||e(new Error(t.message));}));};return o?function(t,e){if(vt(),!yt)return e(null);const r=bt(t.url);yt.then((t=>{t.match(r).then((n=>{const i=function(t){if(!t)return !1;const e=new Date(t.headers.get("Expires")||0),r=F(t.headers.get("Cache-Control")||"");return e>Date.now()&&!r["no-cache"]}(n);t.delete(r),i&&t.put(r,n.clone()),e(null,n,i);})).catch(e);})).catch(e);}(n,u):u(null,null),{cancel:()=>{s=!0,i||r.abort();}}}(t,e);if(V()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(t,e){const r=new a.XMLHttpRequest;r.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(r.responseType="arraybuffer");for(const e in t.headers)r.setRequestHeader(e,t.headers[e]);return "json"===t.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===t.credentials,r.onerror=()=>{e(new Error(r.statusText));},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let n=r.response;if("json"===t.type)try{n=JSON.parse(r.response);}catch(t){return e(t)}e(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"));}else e(new At(r.statusText,r.status,t.url));},r.send(t.body),{cancel:()=>r.abort()}}(t,e)},It=function(t,e){return St(b(t,{type:"arrayBuffer"}),e)},zt=function(t,e){return St(b(t,{method:"POST"}),e)},Tt=function(t,e){return St(b(t,{method:"GET"}),e)};function Mt(t){const e=a.document.createElement("a");return e.href=t,e.protocol===a.document.location.protocol&&e.host===a.document.location.host}const Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Bt,Et;Bt=[],Et=0;const Dt=function(t,e){if(G.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Et>=Z.MAX_PARALLEL_IMAGE_REQUESTS){const r={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0;}};return Bt.push(r),r}Et++;let r=!1;const n=()=>{if(!r)for(r=!0,Et--;Bt.length&&Et<Z.MAX_PARALLEL_IMAGE_REQUESTS;){const t=Bt.shift(),{requestParameters:e,callback:r,cancelled:n}=t;n||(t.cancel=Dt(e,r).cancel);}},i=It(t,((t,r,i,s)=>{n(),t?e(t):r&&(a.createImageBitmap?function(t,e){const r=new a.Blob([new Uint8Array(t)],{type:"image/png"});a.createImageBitmap(r).then((t=>{e(null,t);})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`));}));}(r,((t,r)=>e(t,r,i,s))):function(t,e){const r=new a.Image,n=a.URL;r.onload=()=>{e(null,r),n.revokeObjectURL(r.src),r.onload=null,a.requestAnimationFrame((()=>{r.src=Ct;}));},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new a.Blob([new Uint8Array(t)],{type:"image/png"});r.src=t.byteLength?n.createObjectURL(i):Ct;}(r,((t,r)=>e(t,r,i,s))));}));return {cancel:()=>{i.cancel(),n();}}};function Pt(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e));}function Vt(t,e,r){if(r&&r[t]){const n=r[t].indexOf(e);-1!==n&&r[t].splice(n,1);}}class Ft{constructor(t,e={}){b(this,e),this.type=t;}}class Lt extends Ft{constructor(t,e={}){super("error",b({error:t},e));}}class Rt{on(t,e){return this._listeners=this._listeners||{},Pt(t,e,this._listeners),this}off(t,e){return Vt(t,e,this._listeners),Vt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Pt(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new Ft(t,e||{}));const r=t.type;if(this.listens(r)){t.target=this;const e=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of e)r.call(this,t);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const e of n)Vt(r,e,this._oneTimeListeners),e.call(this,t);const i=this._eventedParent;i&&(b(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(t));}else t instanceof Lt&&console.error(t.error);return this}listens(t){return !!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var $t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Ut{constructor(t,e,r,n){this.message=(t?`${t}: `:"")+r,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__);}}function Ot(t){const e=t.value;return e?[new Ut(t.key,e,"constants have been deprecated as of v8")]:[]}function jt(t,...e){for(const r of e)for(const e in r)t[e]=r[e];return t}function qt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Nt(t){if(Array.isArray(t))return t.map(Nt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const r in t)e[r]=Nt(t[r]);return e}return qt(t)}class Zt extends Error{constructor(t,e){super(e),this.message=e,this.key=t;}}class Gt{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,r]of e)this.bindings[t]=r;}concat(t){return new Gt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return !!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Xt={kind:"null"},Kt={kind:"number"},Yt={kind:"string"},Ht={kind:"boolean"},Jt={kind:"color"},Wt={kind:"object"},Qt={kind:"value"},te={kind:"collator"},ee={kind:"formatted"},re={kind:"resolvedImage"};function ne(t,e){return {kind:"array",itemType:t,N:e}}function ie(t){if("array"===t.kind){const e=ie(t.itemType);return "number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const se=[Xt,Kt,Yt,Ht,Jt,ee,Wt,ne(Qt),re];function ae(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ae(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else {if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of se)if(!ae(t,e))return null}return `Expected ${ie(t)} but found ${ie(e)} instead.`}function oe(t,e){return e.some((e=>e.kind===t.kind))}function le(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function ue(t){var e={exports:{}};return t(e,e.exports),e.exports}var ce=ue((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return (t=Math.round(t))<0?0:t>255?255:t}function i(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function s(t){return (e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e;}function a(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,o=t.replace(/ /g,"").toLowerCase();if(o in r)return r[o].slice();if("#"===o[0])return 4===o.length?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===o.length&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=o.indexOf("("),u=o.indexOf(")");if(-1!==l&&u+1===o.length){var c=o.substr(0,l),h=o.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=s(h.pop());case"rgb":return 3!==h.length?null:[i(h[0]),i(h[1]),i(h[2]),p];case"hsla":if(4!==h.length)return null;p=s(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=s(h[1]),y=s(h[2]),m=y<=.5?y*(f+1):y+f-y*f,g=2*y-m;return [n(255*a(g,m,d+1/3)),n(255*a(g,m,d)),n(255*a(g,m,d-1/3)),p];default:return null}}return null};}catch(t){}}));class he{constructor(t,e,r,n=1){this.r=t,this.g=e,this.b=r,this.a=n;}static parse(t){if(!t)return;if(t instanceof he)return t;if("string"!=typeof t)return;const e=ce.parseCSSColor(t);return e?new he(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,r,n]=this.toArray();return `rgba(${Math.round(t)},${Math.round(e)},${Math.round(r)},${n})`}toArray(){const{r:t,g:e,b:r,a:n}=this;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]}}he.black=new he(0,0,0,1),he.white=new he(1,1,1,1),he.transparent=new he(0,0,0,0),he.red=new he(1,0,0,1),he.blue=new he(0,0,1,1);class pe{constructor(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"});}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class de{constructor(t,e,r,n,i){this.text=t,this.image=e,this.scale=r,this.fontStack=n,this.textColor=i;}}class fe{constructor(t){this.sections=t;}static fromString(t){return new fe([new de(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof fe?t:fe.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const r={};e.fontStack&&(r["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(r["font-scale"]=e.scale),e.textColor&&(r["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(r);}return t}}class ye{constructor(t){this.name=t.name,this.available=t.available;}toString(){return this.name}static fromString(t){return t?new ye({name:t,available:!1}):null}serialize(){return ["image",this.name]}}function me(t,e,r,n){return "number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[t,e,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ge(t){if(null===t)return !0;if("string"==typeof t)return !0;if("boolean"==typeof t)return !0;if("number"==typeof t)return !0;if(t instanceof he)return !0;if(t instanceof pe)return !0;if(t instanceof fe)return !0;if(t instanceof ye)return !0;if(Array.isArray(t)){for(const e of t)if(!ge(e))return !1;return !0}if("object"==typeof t){for(const e in t)if(!ge(t[e]))return !1;return !0}return !1}function xe(t){if(null===t)return Xt;if("string"==typeof t)return Yt;if("boolean"==typeof t)return Ht;if("number"==typeof t)return Kt;if(t instanceof he)return Jt;if(t instanceof pe)return te;if(t instanceof fe)return ee;if(t instanceof ye)return re;if(Array.isArray(t)){const e=t.length;let r;for(const e of t){const t=xe(e);if(r){if(r===t)continue;r=Qt;break}r=t;}return ne(r||Qt,e)}return Wt}function ve(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof he||t instanceof fe||t instanceof ye?t.toString():JSON.stringify(t)}class be{constructor(t,e){this.type=t,this.value=e;}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ge(t[1]))return e.error("invalid value");const r=t[1];let n=xe(r);const i=e.expectedType;return "array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new be(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return !0}serialize(){return "array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof he?["rgba"].concat(this.value.toArray()):this.value instanceof fe?this.value.serialize():this.value}}class we{constructor(t){this.name="ExpressionEvaluationError",this.message=t;}toJSON(){return this.message}}const _e={string:Yt,number:Kt,boolean:Ht,object:Wt};class Ae{constructor(t,e){this.type=t,this.args=e;}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let r,n=1;const i=t[0];if("array"===i){let i,s;if(t.length>2){const r=t[1];if("string"!=typeof r||!(r in _e)||"object"===r)return e.error('The item type argument of "array" must be one of string, number, boolean',1);i=_e[r],n++;}else i=Qt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],n++;}r=ne(i,s);}else r=_e[i];const s=[];for(;n<t.length;n++){const r=e.parse(t[n],n,Qt);if(!r)return null;s.push(r);}return new Ae(r,s)}evaluate(t){for(let e=0;e<this.args.length;e++){const r=this.args[e].evaluate(t);if(!ae(this.type,xe(r)))return r;if(e===this.args.length-1)throw new we(`Expected value to be of type ${ie(this.type)}, but found ${ie(xe(r))} instead.`)}return null}eachChild(t){this.args.forEach(t);}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);const n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n);}}return e.concat(this.args.map((t=>t.serialize())))}}class ke{constructor(t){this.type=ee,this.sections=t;}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=t.length-1;++r){const s=t[r];if(i&&"object"==typeof s&&!Array.isArray(s)){i=!1;let t=null;if(s["font-scale"]&&(t=e.parse(s["font-scale"],1,Kt),!t))return null;let r=null;if(s["text-font"]&&(r=e.parse(s["text-font"],1,ne(Yt)),!r))return null;let a=null;if(s["text-color"]&&(a=e.parse(s["text-color"],1,Jt),!a))return null;const o=n[n.length-1];o.scale=t,o.font=r,o.textColor=a;}else {const s=e.parse(t[r],1,Qt);if(!s)return null;const a=s.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:s,scale:null,font:null,textColor:null});}}return new ke(n)}evaluate(t){return new fe(this.sections.map((e=>{const r=e.content.evaluate(t);return xe(r)===re?new de("",r,null,null,null):new de(ve(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor);}outputDefined(){return !1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const r={};e.scale&&(r["font-scale"]=e.scale.serialize()),e.font&&(r["text-font"]=e.font.serialize()),e.textColor&&(r["text-color"]=e.textColor.serialize()),t.push(r);}return t}}class Se{constructor(t){this.type=re,this.input=t;}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const r=e.parse(t[1],1,Yt);return r?new Se(r):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),r=ye.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r}eachChild(t){t(this.input);}outputDefined(){return !1}serialize(){return ["image",this.input.serialize()]}}const Ie={"to-boolean":Ht,"to-color":Jt,"to-number":Kt,"to-string":Yt};class ze{constructor(t,e){this.type=t,this.args=e;}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");const n=Ie[r],i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],r,Qt);if(!n)return null;i.push(n);}return new ze(n,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,r;for(const n of this.args){if(e=n.evaluate(t),r=null,e instanceof he)return e;if("string"==typeof e){const r=t.parseColor(e);if(r)return r}else if(Array.isArray(e)&&(r=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:me(e[0],e[1],e[2],e[3]),!r))return new he(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new we(r||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const r of this.args){if(e=r.evaluate(t),null===e)return 0;const n=Number(e);if(!isNaN(n))return n}throw new we(`Could not convert ${JSON.stringify(e)} to number.`)}return "formatted"===this.type.kind?fe.fromString(ve(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?ye.fromString(ve(this.args[0].evaluate(t))):ve(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t);}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new ke([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Se(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize());})),t}}const Te=["Unknown","Point","LineString","Polygon"];class Me{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null;}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Te[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:n}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-t[0])+this.featureDistanceData.bearing[1]*(n*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=he.parse(t)),e}}class Ce{constructor(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n;}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t);}outputDefined(){return !1}serialize(){return [this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const r=t[0],n=Ce.definitions[r];if(!n)return e.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,s=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=s.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let o=null;for(const[n,s]of a){o=new Qe(e.registry,e.path,null,e.scope);const a=[];let l=!1;for(let e=1;e<t.length;e++){const r=t[e],i=Array.isArray(n)?n[e-1]:n.type,s=o.parse(r,1+a.length,i);if(!s){l=!0;break}a.push(s);}if(!l)if(Array.isArray(n)&&n.length!==a.length)o.error(`Expected ${n.length} arguments, but found ${a.length} instead.`);else {for(let t=0;t<a.length;t++){const e=Array.isArray(n)?n[t]:n.type,r=a[t];o.concat(t+1).checkSubtype(e,r.type);}if(0===o.errors.length)return new Ce(r,i,s,a)}}if(1===a.length)e.errors.push(...o.errors);else {const r=(a.length?a:s).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(ie).join(", ")})`:`(${ie(e.type)}...)`;var e;})).join(" | "),n=[];for(let r=1;r<t.length;r++){const i=e.parse(t[r],1+n.length);if(!i)return null;n.push(ie(i.type));}e.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`);}return null}static register(t,e){Ce.definitions=e;for(const r in e)t[r]=Ce;}}class Be{constructor(t,e,r){this.type=te,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e;}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");const n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Ht);if(!n)return null;const i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Ht);if(!i)return null;let s=null;return r.locale&&(s=e.parse(r.locale,1,Yt),!s)?null:new Be(n,i,s)}evaluate(t){return new pe(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale);}outputDefined(){return !1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ee=8192;function De(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1]);}function Pe(t,e){return !(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ve(t,e){const r=(180+t[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return [Math.round(r*i*Ee),Math.round(n*i*Ee)]}function Fe(t,e,r){const n=t[0]-e[0],i=t[1]-e[1],s=t[0]-r[0],a=t[1]-r[1];return n*a-s*i==0&&n*s<=0&&i*a<=0}function Le(t,e){let r=!1;for(let a=0,o=e.length;a<o;a++){const o=e[a];for(let e=0,a=o.length;e<a-1;e++){if(Fe(t,o[e],o[e+1]))return !1;(i=o[e])[1]>(n=t)[1]!=(s=o[e+1])[1]>n[1]&&n[0]<(s[0]-i[0])*(n[1]-i[1])/(s[1]-i[1])+i[0]&&(r=!r);}}var n,i,s;return r}function Re(t,e){for(let r=0;r<e.length;r++)if(Le(t,e[r]))return !0;return !1}function $e(t,e,r,n){const i=n[0]-r[0],s=n[1]-r[1],a=(t[0]-r[0])*s-i*(t[1]-r[1]),o=(e[0]-r[0])*s-i*(e[1]-r[1]);return a>0&&o<0||a<0&&o>0}function Ue(t,e,r){for(const u of r)for(let r=0;r<u.length-1;++r)if(0!=(o=[(a=u[r+1])[0]-(s=u[r])[0],a[1]-s[1]])[0]*(l=[(i=e)[0]-(n=t)[0],i[1]-n[1]])[1]-o[1]*l[0]&&$e(n,i,s,a)&&$e(s,a,n,i))return !0;var n,i,s,a,o,l;return !1}function Oe(t,e){for(let r=0;r<t.length;++r)if(!Le(t[r],e))return !1;for(let r=0;r<t.length-1;++r)if(Ue(t[r],t[r+1],e))return !1;return !0}function je(t,e){for(let r=0;r<e.length;r++)if(Oe(t,e[r]))return !0;return !1}function qe(t,e,r){const n=[];for(let i=0;i<t.length;i++){const s=[];for(let n=0;n<t[i].length;n++){const a=Ve(t[i][n],r);De(e,a),s.push(a);}n.push(s);}return n}function Ne(t,e,r){const n=[];for(let i=0;i<t.length;i++){const s=qe(t[i],e,r);n.push(s);}return n}function Ze(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){const e=.5*n;let i=t[0]-r[0]>e?-n:r[0]-t[0]>e?n:0;0===i&&(i=t[0]-r[2]>e?-n:r[2]-t[0]>e?n:0),t[0]+=i;}De(e,t);}function Ge(t,e,r,n){const i=Math.pow(2,n.z)*Ee,s=[n.x*Ee,n.y*Ee],a=[];for(const n of t)for(const t of n){const n=[t.x+s[0],t.y+s[1]];Ze(n,e,r,i),a.push(n);}return a}function Xe(t,e,r,n){const i=Math.pow(2,n.z)*Ee,s=[n.x*Ee,n.y*Ee],a=[];for(const r of t){const t=[];for(const n of r){const r=[n.x+s[0],n.y+s[1]];De(e,r),t.push(r);}a.push(t);}if(e[2]-e[0]<=i/2){(o=e)[0]=o[1]=1/0,o[2]=o[3]=-1/0;for(const t of a)for(const n of t)Ze(n,e,r,i);}var o;return a}class Ke{constructor(t,e){this.type=Ht,this.geojson=t,this.geometries=e;}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ge(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const r=e.features[t].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new Ke(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new Ke(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new Ke(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const s=qe(e.coordinates,n,i),a=Ge(t.geometry(),r,n,i);if(!Pe(r,n))return !1;for(const t of a)if(!Le(t,s))return !1}if("MultiPolygon"===e.type){const s=Ne(e.coordinates,n,i),a=Ge(t.geometry(),r,n,i);if(!Pe(r,n))return !1;for(const t of a)if(!Re(t,s))return !1}return !0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const s=qe(e.coordinates,n,i),a=Xe(t.geometry(),r,n,i);if(!Pe(r,n))return !1;for(const t of a)if(!Oe(t,s))return !1}if("MultiPolygon"===e.type){const s=Ne(e.coordinates,n,i),a=Xe(t.geometry(),r,n,i);if(!Pe(r,n))return !1;for(const t of a)if(!je(t,s))return !1}return !0}(t,this.geometries)}return !1}eachChild(){}outputDefined(){return !0}serialize(){return ["within",this.geojson]}}function Ye(t){if(t instanceof Ce){if("get"===t.name&&1===t.args.length)return !1;if("feature-state"===t.name)return !1;if("has"===t.name&&1===t.args.length)return !1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return !1;if(/^filter-/.test(t.name))return !1}if(t instanceof Ke)return !1;let e=!0;return t.eachChild((t=>{e&&!Ye(t)&&(e=!1);})),e}function He(t){if(t instanceof Ce&&"feature-state"===t.name)return !1;let e=!0;return t.eachChild((t=>{e&&!He(t)&&(e=!1);})),e}function Je(t,e){if(t instanceof Ce&&e.indexOf(t.name)>=0)return !1;let r=!0;return t.eachChild((t=>{r&&!Je(t,e)&&(r=!1);})),r}class We{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e;}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const r=t[1];return e.scope.has(r)?new We(r,e.scope.get(r)):e.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return !1}serialize(){return ["var",this.name]}}class Qe{constructor(t,e=[],r,n=new Gt,i=[]){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=n,this.errors=i,this.expectedType=r;}parse(t,e,r,n,i={}){return e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)}_parse(t,e){function r(t,e,r){return "assert"===r?new Ae(e,[t]):"coerce"===r?new ze(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=t[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(t,this);if(!n)return null;if(this.expectedType){const t=this.expectedType,i=n.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(t,i))return null}else n=r(n,t,e.typeAnnotation||"coerce");else n=r(n,t,e.typeAnnotation||"assert");}if(!(n instanceof be)&&"resolvedImage"!==n.type.kind&&tr(n)){const t=new Me;try{n=new be(n.type,n.evaluate(t));}catch(t){return this.error(t.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,r){const n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Qe(this.registry,n,e||null,i,this.errors)}error(t,...e){const r=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new Zt(r,t));}checkSubtype(t,e){const r=ae(t,e);return r&&this.error(r),r}}function tr(t){if(t instanceof We)return tr(t.boundExpression);if(t instanceof Ce&&"error"===t.name)return !1;if(t instanceof Be)return !1;if(t instanceof Ke)return !1;const e=t instanceof ze||t instanceof Ae;let r=!0;return t.eachChild((t=>{r=e?r&&tr(t):r&&t instanceof be;})),!!r&&Ye(t)&&Je(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function er(t,e){const r=t.length-1;let n,i,s=0,a=r,o=0;for(;s<=a;)if(o=Math.floor((s+a)/2),n=t[o],i=t[o+1],n<=e){if(o===r||e<i)return o;s=o+1;}else {if(!(n>e))throw new we("Input is not a number.");a=o-1;}return 0}class rr{constructor(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e);}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const r=e.parse(t[1],1,Kt);if(!r)return null;const n=[];let i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(let r=1;r<t.length;r+=2){const s=1===r?-1/0:t[r],a=t[r+1],o=r,l=r+1;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(n.length&&n[n.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);const u=e.parse(a,l,i);if(!u)return null;i=i||u.type,n.push([s,u]);}return new rr(i,r,n)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);const i=e.length;return n>=e[i-1]?r[i-1].evaluate(t):r[er(e,n)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e);}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}function nr(t,e,r){return t*(1-r)+e*r}var ir=Object.freeze({__proto__:null,number:nr,color:function(t,e,r){return new he(nr(t.r,e.r,r),nr(t.g,e.g,r),nr(t.b,e.b,r),nr(t.a,e.a,r))},array:function(t,e,r){return t.map(((t,n)=>nr(t,e[n],r)))}});const sr=.95047,ar=1.08883,or=4/29,lr=6/29,ur=3*lr*lr,cr=Math.PI/180,hr=180/Math.PI;function pr(t){return t>.008856451679035631?Math.pow(t,1/3):t/ur+or}function dr(t){return t>lr?t*t*t:ur*(t-or)}function fr(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function yr(t){return (t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function mr(t){const e=yr(t.r),r=yr(t.g),n=yr(t.b),i=pr((.4124564*e+.3575761*r+.1804375*n)/sr),s=pr((.2126729*e+.7151522*r+.072175*n)/1);return {l:116*s-16,a:500*(i-s),b:200*(s-pr((.0193339*e+.119192*r+.9503041*n)/ar)),alpha:t.a}}function gr(t){let e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*dr(e),r=sr*dr(r),n=ar*dr(n),new he(fr(3.2404542*r-1.5371385*e-.4985314*n),fr(-.969266*r+1.8760108*e+.041556*n),fr(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}function xr(t,e,r){const n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const vr={forward:mr,reverse:gr,interpolate:function(t,e,r){return {l:nr(t.l,e.l,r),a:nr(t.a,e.a,r),b:nr(t.b,e.b,r),alpha:nr(t.alpha,e.alpha,r)}}},br={forward:function(t){const{l:e,a:r,b:n}=mr(t),i=Math.atan2(n,r)*hr;return {h:i<0?i+360:i,c:Math.sqrt(r*r+n*n),l:e,alpha:t.a}},reverse:function(t){const e=t.h*cr,r=t.c;return gr({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return {h:xr(t.h,e.h,r),c:nr(t.c,e.c,r),l:nr(t.l,e.l,r),alpha:nr(t.alpha,e.alpha,r)}}};var wr=Object.freeze({__proto__:null,lab:vr,hcl:br});class _r{constructor(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e);}static interpolationFactor(t,e,n,i){let s=0;if("exponential"===t.name)s=Ar(e,t.base,n,i);else if("linear"===t.name)s=Ar(e,1,n,i);else if("cubic-bezier"===t.name){const a=t.controlPoints;s=new r(a[0],a[1],a[2],a[3]).solve(Ar(e,1,n,i));}return s}static parse(t,e){let[r,n,i,...s]=t;if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const t=n[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:t};}else {if("cubic-bezier"!==n[0])return e.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const t=n.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:t};}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(i=e.parse(i,2,Kt),!i)return null;const a=[];let o=null;"interpolate-hcl"===r||"interpolate-lab"===r?o=Jt:e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType);for(let t=0;t<s.length;t+=2){const r=s[t],n=s[t+1],i=t+3,l=t+4;if("number"!=typeof r)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(a.length&&a[a.length-1][0]>=r)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const u=e.parse(n,l,o);if(!u)return null;o=o||u.type,a.push([r,u]);}return "number"===o.kind||"color"===o.kind||"array"===o.kind&&"number"===o.itemType.kind&&"number"==typeof o.N?new _r(o,r,n,i,a):e.error(`Type ${ie(o)} is not interpolatable.`)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);const i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);const s=er(e,n),a=_r.interpolationFactor(this.interpolation,n,e[s],e[s+1]),o=r[s].evaluate(t),l=r[s+1].evaluate(t);return "interpolate"===this.operator?ir[this.type.kind.toLowerCase()](o,l,a):"interpolate-hcl"===this.operator?br.reverse(br.interpolate(br.forward(o),br.forward(l),a)):vr.reverse(vr.interpolate(vr.forward(o),vr.forward(l),a))}eachChild(t){t(this.input);for(const e of this.outputs)t(e);}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function Ar(t,e,r,n){const i=n-r,s=t-r;return 0===i?0:1===e?s/i:(Math.pow(e,s)-1)/(Math.pow(e,i)-1)}class kr{constructor(t,e){this.type=t,this.args=e;}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let r=null;const n=e.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of t.slice(1)){const t=e.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!t)return null;r=r||t.type,i.push(t);}const s=n&&i.some((t=>ae(n,t.type)));return new kr(s?Qt:r,i)}evaluate(t){let e,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(t),r&&r instanceof ye&&!r.available&&(e||(e=r.name),r=null,n===this.args.length&&(r=e)),null!==r)break;return r}eachChild(t){this.args.forEach(t);}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize());})),t}}class Sr{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e;}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result);}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const r=[];for(let n=1;n<t.length-1;n+=2){const i=t[n];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,n);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);const s=e.parse(t[n+1],n+1);if(!s)return null;r.push([i,s]);}const n=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return n?new Sr(r,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,r]of this.bindings)t.push(e,r.serialize());return t.push(this.result.serialize()),t}}class Ir{constructor(t,e,r){this.type=t,this.index=e,this.input=r;}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,Kt),n=e.parse(t[2],2,ne(e.expectedType||Qt));return r&&n?new Ir(n.type.itemType,r,n):null}evaluate(t){const e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new we(`Array index out of bounds: ${e} < 0.`);if(e>=r.length)throw new we(`Array index out of bounds: ${e} > ${r.length-1}.`);if(e!==Math.floor(e))throw new we(`Array index must be an integer, but found ${e} instead.`);return r[e]}eachChild(t){t(this.index),t(this.input);}outputDefined(){return !1}serialize(){return ["at",this.index.serialize(),this.input.serialize()]}}class zr{constructor(t,e){this.type=Ht,this.needle=t,this.haystack=e;}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,Qt),n=e.parse(t[2],2,Qt);return r&&n?oe(r.type,[Ht,Yt,Kt,Xt,Qt])?new zr(r,n):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(r.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return !1;if(!le(e,["boolean","string","number","null"]))throw new we(`Expected first argument to be of type boolean, string, number or null, but found ${ie(xe(e))} instead.`);if(!le(r,["string","array"]))throw new we(`Expected second argument to be of type array or string, but found ${ie(xe(r))} instead.`);return r.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack);}outputDefined(){return !0}serialize(){return ["in",this.needle.serialize(),this.haystack.serialize()]}}class Tr{constructor(t,e,r){this.type=Kt,this.needle=t,this.haystack=e,this.fromIndex=r;}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,Qt),n=e.parse(t[2],2,Qt);if(!r||!n)return null;if(!oe(r.type,[Ht,Yt,Kt,Xt,Qt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(r.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,Kt);return i?new Tr(r,n,i):null}return new Tr(r,n)}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!le(e,["boolean","string","number","null"]))throw new we(`Expected first argument to be of type boolean, string, number or null, but found ${ie(xe(e))} instead.`);if(!le(r,["string","array"]))throw new we(`Expected second argument to be of type array or string, but found ${ie(xe(r))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(t);return r.indexOf(e,n)}return r.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex);}outputDefined(){return !1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return ["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return ["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Mr{constructor(t,e,r,n,i,s){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=s;}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i={},s=[];for(let a=2;a<t.length-1;a+=2){let o=t[a];const l=t[a+1];Array.isArray(o)||(o=[o]);const u=e.concat(a);if(0===o.length)return u.error("Expected at least one branch label.");for(const t of o){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,xe(t)))return null}else r=xe(t);if(void 0!==i[String(t)])return u.error("Branch labels must be unique.");i[String(t)]=s.length;}const c=e.parse(l,a,n);if(!c)return null;n=n||c.type,s.push(c);}const a=e.parse(t[1],1,Qt);if(!a)return null;const o=e.parse(t[t.length-1],t.length-1,n);return o?"value"!==a.type.kind&&e.concat(1).checkSubtype(r,a.type)?null:new Mr(r,n,a,i,s,o):null}evaluate(t){const e=this.input.evaluate(t);return (xe(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise);}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),r=[],n={};for(const t of e){const e=n[this.cases[t]];void 0===e?(n[this.cases[t]]=r.length,r.push([this.cases[t],[t]])):r[e][1].push(t);}const i=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,n]of r)t.push(1===n.length?i(n[0]):n.map(i)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class Cr{constructor(t,e,r){this.type=t,this.branches=e,this.otherwise=r;}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const n=[];for(let i=1;i<t.length-1;i+=2){const s=e.parse(t[i],i,Ht);if(!s)return null;const a=e.parse(t[i+1],i+1,r);if(!a)return null;n.push([s,a]),r=r||a.type;}const i=e.parse(t[t.length-1],t.length-1,r);return i?new Cr(r,n,i):null}evaluate(t){for(const[e,r]of this.branches)if(e.evaluate(t))return r.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,r]of this.branches)t(e),t(r);t(this.otherwise);}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize());})),t}}class Br{constructor(t,e,r,n){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=n;}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,Qt),n=e.parse(t[2],2,Kt);if(!r||!n)return null;if(!oe(r.type,[ne(Qt),Yt,Qt]))return e.error(`Expected first argument to be of type array or string, but found ${ie(r.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,Kt);return i?new Br(r.type,r,n,i):null}return new Br(r.type,r,n)}evaluate(t){const e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!le(e,["string","array"]))throw new we(`Expected first argument to be of type array or string, but found ${ie(xe(e))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(t);return e.slice(r,n)}return e.slice(r)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex);}outputDefined(){return !1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return ["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return ["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Er(t,e){return "=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Dr(t,e,r,n){return 0===n.compare(e,r)}function Pr(t,e,r){const n="=="!==t&&"!="!==t;return class i{constructor(t,e,r){this.type=Ht,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind;}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const r=t[0];let s=e.parse(t[1],1,Qt);if(!s)return null;if(!Er(r,s.type))return e.concat(1).error(`"${r}" comparisons are not supported for type '${ie(s.type)}'.`);let a=e.parse(t[2],2,Qt);if(!a)return null;if(!Er(r,a.type))return e.concat(2).error(`"${r}" comparisons are not supported for type '${ie(a.type)}'.`);if(s.type.kind!==a.type.kind&&"value"!==s.type.kind&&"value"!==a.type.kind)return e.error(`Cannot compare types '${ie(s.type)}' and '${ie(a.type)}'.`);n&&("value"===s.type.kind&&"value"!==a.type.kind?s=new Ae(a.type,[s]):"value"!==s.type.kind&&"value"===a.type.kind&&(a=new Ae(s.type,[a])));let o=null;if(4===t.length){if("string"!==s.type.kind&&"string"!==a.type.kind&&"value"!==s.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(o=e.parse(t[3],3,te),!o)return null}return new i(s,a,o)}evaluate(i){const s=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const e=xe(s),r=xe(a);if(e.kind!==r.kind||"string"!==e.kind&&"number"!==e.kind)throw new we(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const t=xe(s),r=xe(a);if("string"!==t.kind||"string"!==r.kind)return e(i,s,a)}return this.collator?r(i,s,a,this.collator.evaluate(i)):e(i,s,a)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator);}outputDefined(){return !0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize());})),e}}}const Vr=Pr("==",(function(t,e,r){return e===r}),Dr),Fr=Pr("!=",(function(t,e,r){return e!==r}),(function(t,e,r,n){return !Dr(0,e,r,n)})),Lr=Pr("<",(function(t,e,r){return e<r}),(function(t,e,r,n){return n.compare(e,r)<0})),Rr=Pr(">",(function(t,e,r){return e>r}),(function(t,e,r,n){return n.compare(e,r)>0})),$r=Pr("<=",(function(t,e,r){return e<=r}),(function(t,e,r,n){return n.compare(e,r)<=0})),Ur=Pr(">=",(function(t,e,r){return e>=r}),(function(t,e,r,n){return n.compare(e,r)>=0}));class Or{constructor(t,e,r,n,i){this.type=Yt,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i;}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const r=e.parse(t[1],1,Kt);if(!r)return null;const n=t[2];if("object"!=typeof n||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=e.parse(n.locale,1,Yt),!i))return null;let s=null;if(n.currency&&(s=e.parse(n.currency,1,Yt),!s))return null;let a=null;if(n["min-fraction-digits"]&&(a=e.parse(n["min-fraction-digits"],1,Kt),!a))return null;let o=null;return n["max-fraction-digits"]&&(o=e.parse(n["max-fraction-digits"],1,Kt),!o)?null:new Or(r,i,s,a,o)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits);}outputDefined(){return !1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class jr{constructor(t){this.type=Kt,this.input=t;}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error(`Expected argument of type string or array, but found ${ie(r.type)} instead.`):new jr(r):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new we(`Expected value to be of type string or array, but found ${ie(xe(e))} instead.`)}eachChild(t){t(this.input);}outputDefined(){return !1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize());})),t}}const qr={"==":Vr,"!=":Fr,">":Rr,"<":Lr,">=":Ur,"<=":$r,array:Ae,at:Ir,boolean:Ae,case:Cr,coalesce:kr,collator:Be,format:ke,image:Se,in:zr,"index-of":Tr,interpolate:_r,"interpolate-hcl":_r,"interpolate-lab":_r,length:jr,let:Sr,literal:be,match:Mr,number:Ae,"number-format":Or,object:Ae,slice:Br,step:rr,string:Ae,"to-boolean":ze,"to-color":ze,"to-number":ze,"to-string":ze,var:We,within:Ke};function Nr(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);const s=i?i.evaluate(t):1,a=me(e,r,n,s);if(a)throw new we(a);return new he(e/255*s,r/255*s,n/255*s,s)}function Zr(t,e){return t in e}function Gr(t,e){const r=e[t];return void 0===r?null:r}function Xr(t){return {type:t}}function Kr(t){return {result:"success",value:t}}function Yr(t){return {result:"error",value:t}}function Hr(t){return "data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Jr(t){return !!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Wr(t){return !!t.expression&&t.expression.interpolated}function Qr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function tn(t){return "object"==typeof t&&null!==t&&!Array.isArray(t)}function en(t){return t}function rn(t,e){const r="color"===e.type,n=t.stops&&"object"==typeof t.stops[0][0],i=n||!(n||void 0!==t.property),s=t.type||(Wr(e)?"exponential":"interval");if(r&&((t=jt({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],he.parse(t[1])]))),t.default=he.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!wr[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let a,o,l;if("exponential"===s)a=on;else if("interval"===s)a=an;else if("categorical"===s){a=sn,o=Object.create(null);for(const e of t.stops)o[e[0]]=e[1];l=typeof t.stops[0][0];}else {if("identity"!==s)throw new Error(`Unknown function type "${s}"`);a=ln;}if(n){const r={},n=[];for(let e=0;e<t.stops.length;e++){const i=t.stops[e],s=i[0].zoom;void 0===r[s]&&(r[s]={zoom:s,type:t.type,property:t.property,default:t.default,stops:[]},n.push(s)),r[s].stops.push([i[0].value,i[1]]);}const i=[];for(const t of n)i.push([r[t].zoom,rn(r[t],e)]);const s={name:"linear"};return {kind:"composite",interpolationType:s,interpolationFactor:_r.interpolationFactor.bind(void 0,s),zoomStops:i.map((t=>t[0])),evaluate:({zoom:r},n)=>on({stops:i,base:t.base},e,r).evaluate(r,n)}}if(i){const r="exponential"===s?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return {kind:"camera",interpolationType:r,interpolationFactor:_r.interpolationFactor.bind(void 0,r),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:r})=>a(t,e,r,o,l)}}return {kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[t.property]:void 0;return void 0===i?nn(t.default,e.default):a(t,e,i,o,l)}}}function nn(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function sn(t,e,r,n,i){return nn(typeof r===i?n[r]:void 0,t.default,e.default)}function an(t,e,r){if("number"!==Qr(r))return nn(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];const i=er(t.stops.map((t=>t[0])),r);return t.stops[i][1]}function on(t,e,r){const n=void 0!==t.base?t.base:1;if("number"!==Qr(r))return nn(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];const s=er(t.stops.map((t=>t[0])),r),a=function(t,e,r,n){const i=n-r,s=t-r;return 0===i?0:1===e?s/i:(Math.pow(e,s)-1)/(Math.pow(e,i)-1)}(r,n,t.stops[s][0],t.stops[s+1][0]),o=t.stops[s][1],l=t.stops[s+1][1];let u=ir[e.type]||en;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=wr[t.colorSpace];u=(t,r)=>e.reverse(e.interpolate(e.forward(t),e.forward(r),a));}return "function"==typeof o.evaluate?{evaluate(...t){const e=o.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==r)return u(e,r,a)}}:u(o,l,a)}function ln(t,e,r){return "color"===e.type?r=he.parse(r):"formatted"===e.type?r=fe.fromString(r.toString()):"resolvedImage"===e.type?r=ye.fromString(r.toString()):Qr(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),nn(r,t.default,e.default)}Ce.register(qr,{error:[{kind:"error"},[Yt],(t,[e])=>{throw new we(e.evaluate(t))}],typeof:[Yt,[Qt],(t,[e])=>ie(xe(e.evaluate(t)))],"to-rgba":[ne(Kt,4),[Jt],(t,[e])=>e.evaluate(t).toArray()],rgb:[Jt,[Kt,Kt,Kt],Nr],rgba:[Jt,[Kt,Kt,Kt,Kt],Nr],has:{type:Ht,overloads:[[[Yt],(t,[e])=>Zr(e.evaluate(t),t.properties())],[[Yt,Wt],(t,[e,r])=>Zr(e.evaluate(t),r.evaluate(t))]]},get:{type:Qt,overloads:[[[Yt],(t,[e])=>Gr(e.evaluate(t),t.properties())],[[Yt,Wt],(t,[e,r])=>Gr(e.evaluate(t),r.evaluate(t))]]},"feature-state":[Qt,[Yt],(t,[e])=>Gr(e.evaluate(t),t.featureState||{})],properties:[Wt,[],t=>t.properties()],"geometry-type":[Yt,[],t=>t.geometryType()],id:[Qt,[],t=>t.id()],zoom:[Kt,[],t=>t.globals.zoom],pitch:[Kt,[],t=>t.globals.pitch||0],"distance-from-center":[Kt,[],t=>t.distanceFromCenter()],"heatmap-density":[Kt,[],t=>t.globals.heatmapDensity||0],"line-progress":[Kt,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Kt,[],t=>t.globals.skyRadialProgress||0],accumulated:[Qt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Kt,Xr(Kt),(t,e)=>{let r=0;for(const n of e)r+=n.evaluate(t);return r}],"*":[Kt,Xr(Kt),(t,e)=>{let r=1;for(const n of e)r*=n.evaluate(t);return r}],"-":{type:Kt,overloads:[[[Kt,Kt],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[Kt],(t,[e])=>-e.evaluate(t)]]},"/":[Kt,[Kt,Kt],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[Kt,[Kt,Kt],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[Kt,[Kt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Kt,[Kt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Kt,[Kt],(t,[e])=>Math.log(e.evaluate(t))],log2:[Kt,[Kt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Kt,[Kt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Kt,[Kt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Kt,[Kt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Kt,[Kt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Kt,[Kt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Kt,[Kt],(t,[e])=>Math.atan(e.evaluate(t))],min:[Kt,Xr(Kt),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[Kt,Xr(Kt),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[Kt,[Kt],(t,[e])=>Math.abs(e.evaluate(t))],round:[Kt,[Kt],(t,[e])=>{const r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Kt,[Kt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Kt,[Kt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Ht,[Yt,Qt],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[Ht,[Qt],(t,[e])=>t.id()===e.value],"filter-type-==":[Ht,[Yt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Ht,[Yt,Qt],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Ht,[Qt],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[Ht,[Yt,Qt],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Ht,[Qt],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[Ht,[Yt,Qt],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Ht,[Qt],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[Ht,[Yt,Qt],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Ht,[Qt],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[Ht,[Qt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Ht,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Ht,[ne(Yt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Ht,[ne(Qt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Ht,[Yt,ne(Qt)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Ht,[Yt,ne(Qt)],(t,[e,r])=>function(t,e,r,n){for(;r<=n;){const i=r+n>>1;if(e[i]===t)return !0;e[i]>t?n=i-1:r=i+1;}return !1}(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Ht,overloads:[[[Ht,Ht],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Xr(Ht),(t,e)=>{for(const r of e)if(!r.evaluate(t))return !1;return !0}]]},any:{type:Ht,overloads:[[[Ht,Ht],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Xr(Ht),(t,e)=>{for(const r of e)if(r.evaluate(t))return !0;return !1}]]},"!":[Ht,[Ht],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Ht,[Yt],(t,[e])=>{const r=t.globals&&t.globals.isSupportedScript;return !r||r(e.evaluate(t))}],upcase:[Yt,[Yt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Yt,[Yt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Yt,Xr(Qt),(t,e)=>e.map((e=>ve(e.evaluate(t)))).join("")],"resolved-locale":[Yt,[te],(t,[e])=>e.evaluate(t).resolvedLocale()]});class un{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Me,this._defaultValue=e?function(t){return "color"===t.type&&tn(t.default)?new he(0,0,0,0):"color"===t.type?he.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null;}evaluateWithoutErrorHandling(t,e,r,n,i,s,a,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=s,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=o||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,r,n,i,s,a,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=s||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=o||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new we(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function cn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in qr}function hn(t,e){const r=new Qe(qr,[],e?function(t){const e={color:Jt,string:Yt,number:Kt,enum:Yt,boolean:Ht,formatted:ee,resolvedImage:re};return "array"===t.type?ne(e[t.value]||Qt,t.length):e[t.type]}(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?Kr(new un(n,e)):Yr(r.errors)}class pn{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!He(e.expression);}evaluateWithoutErrorHandling(t,e,r,n,i,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,s)}evaluate(t,e,r,n,i,s){return this._styleExpression.evaluate(t,e,r,n,i,s)}}class dn{constructor(t,e,r,n){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!He(e.expression),this.interpolationType=n;}evaluateWithoutErrorHandling(t,e,r,n,i,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,s)}evaluate(t,e,r,n,i,s){return this._styleExpression.evaluate(t,e,r,n,i,s)}interpolationFactor(t,e,r){return this.interpolationType?_r.interpolationFactor(this.interpolationType,t,e,r):0}}function fn(t,e){if("error"===(t=hn(t,e)).result)return t;const r=t.value.expression,n=Ye(r);if(!n&&!Hr(e))return Yr([new Zt("","data expressions not supported")]);const i=Je(r,["zoom","pitch","distance-from-center"]);if(!i&&!Jr(e))return Yr([new Zt("","zoom expressions not supported")]);const s=mn(r);return s||i?s instanceof Zt?Yr([s]):s instanceof _r&&!Wr(e)?Yr([new Zt("",'"interpolate" expressions cannot be used with this property')]):Kr(s?new dn(n?"camera":"composite",t.value,s.labels,s instanceof _r?s.interpolation:void 0):new pn(n?"constant":"source",t.value)):Yr([new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class yn{constructor(t,e){this._parameters=t,this._specification=e,jt(this,rn(this._parameters,this._specification));}static deserialize(t){return new yn(t._parameters,t._specification)}static serialize(t){return {_parameters:t._parameters,_specification:t._specification}}}function mn(t){let e=null;if(t instanceof Sr)e=mn(t.result);else if(t instanceof kr){for(const r of t.args)if(e=mn(r),e)break}else (t instanceof rr||t instanceof _r)&&t.input instanceof Ce&&"zoom"===t.input.name&&(e=t);return e instanceof Zt||t.eachChild((t=>{const r=mn(t);r instanceof Zt?e=r:!e&&r?e=new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new Zt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));})),e}function gn(t){const e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},s=t.style,a=t.styleSpec;let o=[];const l=Qr(r);if("object"!==l)return [new Ut(e,r,`object expected, ${l} found`)];for(const t in r){const l=t.split(".")[0],u=n[l]||n["*"];let c;if(i[l])c=i[l];else if(n[l])c=Hn;else if(i["*"])c=i["*"];else {if(!n["*"]){o.push(new Ut(e,r[t],`unknown property "${t}"`));continue}c=Hn;}o=o.concat(c({key:(e?`${e}.`:e)+t,value:r[t],valueSpec:u,style:s,styleSpec:a,object:r,objectKey:t},r));}for(const t in n)i[t]||n[t].required&&void 0===n[t].default&&void 0===r[t]&&o.push(new Ut(e,r,`missing required property "${t}"`));return o}function xn(t){const e=t.value,r=t.valueSpec,n=t.style,i=t.styleSpec,s=t.key,a=t.arrayElementValidator||Hn;if("array"!==Qr(e))return [new Ut(s,e,`array expected, ${Qr(e)} found`)];if(r.length&&e.length!==r.length)return [new Ut(s,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return [new Ut(s,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let o={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum};i.$version<7&&(o.function=r.function),"object"===Qr(r.value)&&(o=r.value);let l=[];for(let t=0;t<e.length;t++)l=l.concat(a({array:e,arrayIndex:t,value:e[t],valueSpec:o,style:n,styleSpec:i,key:`${s}[${t}]`}));return l}function vn(t){const e=t.key,r=t.value,n=t.valueSpec;let i=Qr(r);if("number"===i&&r!=r&&(i="NaN"),"number"!==i)return [new Ut(e,r,`number expected, ${i} found`)];if("minimum"in n){let i=n.minimum;if("array"===Qr(n.minimum)&&(i=n.minimum[t.arrayIndex]),r<i)return [new Ut(e,r,`${r} is less than the minimum value ${i}`)]}if("maximum"in n){let i=n.maximum;if("array"===Qr(n.maximum)&&(i=n.maximum[t.arrayIndex]),r>i)return [new Ut(e,r,`${r} is greater than the maximum value ${i}`)]}return []}function bn(t){const e=t.valueSpec,r=qt(t.value.type);let n,i,s,a={};const o="categorical"!==r&&void 0===t.value.property,l=!o,u="array"===Qr(t.value.stops)&&"array"===Qr(t.value.stops[0])&&"object"===Qr(t.value.stops[0][0]),c=gn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===r)return [new Ut(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const n=t.value;return e=e.concat(xn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Qr(n)&&0===n.length&&e.push(new Ut(t.key,n,"array must have at least one stop")),e},default:function(t){return Hn({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return "identity"===r&&o&&c.push(new Ut(t.key,t.value,'missing required property "property"')),"identity"===r||t.value.stops||c.push(new Ut(t.key,t.value,'missing required property "stops"')),"exponential"===r&&t.valueSpec.expression&&!Wr(t.valueSpec)&&c.push(new Ut(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Hr(t.valueSpec)?c.push(new Ut(t.key,t.value,"property functions not supported")):o&&!Jr(t.valueSpec)&&c.push(new Ut(t.key,t.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==t.value.property||c.push(new Ut(t.key,t.value,'"property" property is required')),c;function h(t){let r=[];const n=t.value,o=t.key;if("array"!==Qr(n))return [new Ut(o,n,`array expected, ${Qr(n)} found`)];if(2!==n.length)return [new Ut(o,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==Qr(n[0]))return [new Ut(o,n,`object expected, ${Qr(n[0])} found`)];if(void 0===n[0].zoom)return [new Ut(o,n,"object stop key must have zoom")];if(void 0===n[0].value)return [new Ut(o,n,"object stop key must have value")];if(s&&s>qt(n[0].zoom))return [new Ut(o,n[0].zoom,"stop zoom values must appear in ascending order")];qt(n[0].zoom)!==s&&(s=qt(n[0].zoom),i=void 0,a={}),r=r.concat(gn({key:`${o}[0]`,value:n[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:vn,value:p}}));}else r=r.concat(p({key:`${o}[0]`,value:n[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},n));return cn(Nt(n[1]))?r.concat([new Ut(`${o}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(Hn({key:`${o}[1]`,value:n[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function p(t,s){const o=Qr(t.value),l=qt(t.value),u=null!==t.value?t.value:s;if(n){if(o!==n)return [new Ut(t.key,u,`${o} stop domain type must match previous stop domain type ${n}`)]}else n=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return [new Ut(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==r){let n=`number expected, ${o} found`;return Hr(e)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(t.key,u,n)]}return "categorical"!==r||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===o&&void 0!==i&&l<i?[new Ut(t.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in a?[new Ut(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new Ut(t.key,u,`integer expected, found ${l}`)]}}function wn(t){const e=("property"===t.expressionContext?fn:hn)(Nt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new Ut(`${t.key}${e.key}`,t.value,e.message)));const r=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return [new Ut(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!He(r))return [new Ut(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return _n(r,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Je(r,["zoom","feature-state"]))return [new Ut(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ye(r))return [new Ut(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return []}function _n(t,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const t of e.valueSpec.expression.parameters)r.delete(t);if(0===r.size)return [];const n=[];return t instanceof Ce&&r.has(t.name)?[new Ut(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild((t=>{n.push(..._n(t,e));})),n)}function An(t){const e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(qt(r))&&i.push(new Ut(e,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(qt(r))&&i.push(new Ut(e,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function kn(t){if(!0===t||!1===t)return !0;if(!Array.isArray(t)||0===t.length)return !1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return !1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!kn(e)&&"boolean"!=typeof e)return !1;return !0;default:return !0}}function Sn(t,e="fill"){if(null==t)return {filter:()=>!0,needGeometry:!1,needFeature:!1};kn(t)||(t=En(t));const r=t;let n=!0;try{n=function(t){if(!Tn(t))return t;let e=Nt(t);return zn(e),e=In(e),e}(r);}catch(t){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `);}const i=$t[`filter_${e}`],s=hn(n,i);let a=null;if("error"===s.result)throw new Error(s.value.map((t=>`${t.key}: ${t.message}`)).join(", "));a=(t,e,r)=>s.value.evaluate(t,e,{},r);let o=null,l=null;if(n!==r){const t=hn(r,i);if("error"===t.result)throw new Error(t.value.map((t=>`${t.key}: ${t.message}`)).join(", "));o=(e,r,n,i,s)=>t.value.evaluate(e,r,{},n,void 0,void 0,i,s),l=!Ye(t.value.expression);}return a=a,{filter:a,dynamicFilter:o||void 0,needGeometry:Bn(n),needFeature:!!l}}function In(t){if(!Array.isArray(t))return t;const e=function(t){if(Mn.has(t[0]))for(let e=1;e<t.length;e++)if(Tn(t[e]))return !0;return t}(t);return !0===e?e:e.map((t=>In(t)))}function zn(t){let e=!1;const r=[];if("case"===t[0]){for(let n=1;n<t.length-1;n+=2)e=e||Tn(t[n]),r.push(t[n+1]);r.push(t[t.length-1]);}else if("match"===t[0]){e=e||Tn(t[1]);for(let e=2;e<t.length-1;e+=2)r.push(t[e+1]);r.push(t[t.length-1]);}else if("step"===t[0]){e=e||Tn(t[1]);for(let e=1;e<t.length-1;e+=2)r.push(t[e+1]);}e&&(t.length=0,t.push("any",...r));for(let e=1;e<t.length;e++)zn(t[e]);}function Tn(t){if(!Array.isArray(t))return !1;if("pitch"===(e=t[0])||"distance-from-center"===e)return !0;var e;for(let e=1;e<t.length;e++)if(Tn(t[e]))return !0;return !1}const Mn=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Cn(t,e){return t<e?-1:t>e?1:0}function Bn(t){if(!Array.isArray(t))return !1;if("within"===t[0])return !0;for(let e=1;e<t.length;e++)if(Bn(t[e]))return !0;return !1}function En(t){if(!t)return !0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Dn(t[1],t[2],"=="):"!="===e?Fn(Dn(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Dn(t[1],t[2],e):"any"===e?(r=t.slice(1),["any"].concat(r.map(En))):"all"===e?["all"].concat(t.slice(1).map(En)):"none"===e?["all"].concat(t.slice(1).map(En).map(Fn)):"in"===e?Pn(t[1],t.slice(2)):"!in"===e?Fn(Pn(t[1],t.slice(2))):"has"===e?Vn(t[1]):"!has"===e?Fn(Vn(t[1])):"within"!==e||t;var r;}function Dn(t,e,r){switch(t){case"$type":return [`filter-type-${r}`,e];case"$id":return [`filter-id-${r}`,e];default:return [`filter-${r}`,t,e]}}function Pn(t,e){if(0===e.length)return !1;switch(t){case"$type":return ["filter-type-in",["literal",e]];case"$id":return ["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(Cn)]]:["filter-in-small",t,["literal",e]]}}function Vn(t){switch(t){case"$type":return !0;case"$id":return ["filter-has-id"];default:return ["filter-has",t]}}function Fn(t){return ["!",t]}function Ln(t){if(kn(Nt(t.value))){const e=Nt(t.layerType);return wn(jt({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${e||"fill"}`]}))}return Rn(t)}function Rn(t){const e=t.value,r=t.key;if("array"!==Qr(e))return [new Ut(r,e,`array expected, ${Qr(e)} found`)];const n=t.styleSpec;let i,s=[];if(e.length<1)return [new Ut(r,e,"filter array must have at least 1 element")];switch(s=s.concat(An({key:`${r}[0]`,value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),qt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===qt(e[1])&&s.push(new Ut(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&s.push(new Ut(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(i=Qr(e[1]),"string"!==i&&s.push(new Ut(`${r}[1]`,e[1],`string expected, ${i} found`)));for(let a=2;a<e.length;a++)i=Qr(e[a]),"$type"===qt(e[1])?s=s.concat(An({key:`${r}[${a}]`,value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&s.push(new Ut(`${r}[${a}]`,e[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<e.length;n++)s=s.concat(Rn({key:`${r}[${n}]`,value:e[n],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=Qr(e[1]),2!==e.length?s.push(new Ut(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==i&&s.push(new Ut(`${r}[1]`,e[1],`string expected, ${i} found`));break;case"within":i=Qr(e[1]),2!==e.length?s.push(new Ut(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==i&&s.push(new Ut(`${r}[1]`,e[1],`object expected, ${i} found`));}return s}function $n(t,e){const r=t.key,n=t.style,i=t.styleSpec,s=t.value,a=t.objectKey,o=i[`${e}_${t.layerType}`];if(!o)return [];const l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&o[l[1]]&&o[l[1]].transition)return Hn({key:r,value:s,valueSpec:i.transition,style:n,styleSpec:i});const u=t.valueSpec||o[a];if(!u)return [new Ut(r,s,`unknown property "${a}"`)];let c;if("string"===Qr(s)&&Hr(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(s)))return [new Ut(r,s,`"${a}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const h=[];return "symbol"===t.layerType&&("text-field"===a&&n&&!n.glyphs&&h.push(new Ut(r,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&tn(Nt(s))&&"identity"===qt(s.type)&&h.push(new Ut(r,s,'"text-font" does not support identity functions'))),h.concat(Hn({key:t.key,value:s,valueSpec:u,style:n,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function Un(t){return $n(t,"paint")}function On(t){return $n(t,"layout")}function jn(t){let e=[];const r=t.value,n=t.key,i=t.style,s=t.styleSpec;r.type||r.ref||e.push(new Ut(n,r,'either "type" or "ref" is required'));let a=qt(r.type);const o=qt(r.ref);if(r.id){const s=qt(r.id);for(let a=0;a<t.arrayIndex;a++){const t=i.layers[a];qt(t.id)===s&&e.push(new Ut(n,r.id,`duplicate layer id "${r.id}", previously used at line ${t.id.__line__}`));}}if("ref"in r){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in r&&e.push(new Ut(n,r[t],`"${t}" is prohibited for ref layers`));})),i.layers.forEach((e=>{qt(e.id)===o&&(t=e);})),t?t.ref?e.push(new Ut(n,r.ref,"ref cannot reference another ref layer")):a=qt(t.type):e.push(new Ut(n,r.ref,`ref layer "${o}" not found`));}else if("background"!==a&&"sky"!==a)if(r.source){const t=i.sources&&i.sources[r.source],s=t&&qt(t.type);t?"vector"===s&&"raster"===a?e.push(new Ut(n,r.source,`layer "${r.id}" requires a raster source`)):"raster"===s&&"raster"!==a?e.push(new Ut(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==s||r["source-layer"]?"raster-dem"===s&&"hillshade"!==a?e.push(new Ut(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!r.paint||!r.paint["line-gradient"]||"geojson"===s&&t.lineMetrics||e.push(new Ut(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ut(n,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new Ut(n,r.source,`source "${r.source}" not found`));}else e.push(new Ut(n,r,'missing required property "source"'));return e=e.concat(gn({key:n,value:r,valueSpec:s.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hn({key:`${n}.type`,value:r.type,valueSpec:s.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"}),filter:t=>Ln(jt({layerType:a},t)),layout:t=>gn({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>On(jt({layerType:a},t))}}),paint:t=>gn({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Un(jt({layerType:a},t))}})}})),e}function qn(t){const e=t.value,r=t.key,n=Qr(e);return "string"!==n?[new Ut(r,e,`string expected, ${n} found`)]:[]}const Nn={promoteId:function({key:t,value:e}){if("string"===Qr(e))return qn({key:t,value:e});{const r=[];for(const n in e)r.push(...qn({key:`${t}.${n}`,value:e[n]}));return r}}};function Zn(t){const e=t.value,r=t.key,n=t.styleSpec,i=t.style;if(!e.type)return [new Ut(r,e,'"type" is required')];const s=qt(e.type);let a;switch(s){case"vector":case"raster":case"raster-dem":return a=gn({key:r,value:e,valueSpec:n[`source_${s.replace("-","_")}`],style:t.style,styleSpec:n,objectElementValidators:Nn}),a;case"geojson":if(a=gn({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,objectElementValidators:Nn}),e.cluster)for(const t in e.clusterProperties){const[n,i]=e.clusterProperties[t],s="string"==typeof n?[n,["accumulated"],["get",t]]:n;a.push(...wn({key:`${r}.${t}.map`,value:i,expressionContext:"cluster-map"})),a.push(...wn({key:`${r}.${t}.reduce`,value:s,expressionContext:"cluster-reduce"}));}return a;case"video":return gn({key:r,value:e,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return gn({key:r,value:e,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return [new Ut(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return An({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function Gn(t){const e=t.value,r=t.styleSpec,n=r.light,i=t.style;let s=[];const a=Qr(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new Ut("light",e,`object expected, ${a} found`)]),s;for(const t in e){const a=t.match(/^(.*)-transition$/);s=s.concat(a&&n[a[1]]&&n[a[1]].transition?Hn({key:t,value:e[t],valueSpec:r.transition,style:i,styleSpec:r}):n[t]?Hn({key:t,value:e[t],valueSpec:n[t],style:i,styleSpec:r}):[new Ut(t,e[t],`unknown property "${t}"`)]);}return s}function Xn(t){const e=t.value,r=t.key,n=t.style,i=t.styleSpec,s=i.terrain;let a=[];const o=Qr(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new Ut("terrain",e,`object expected, ${o} found`)]),a;for(const t in e){const r=t.match(/^(.*)-transition$/);a=a.concat(r&&s[r[1]]&&s[r[1]].transition?Hn({key:t,value:e[t],valueSpec:i.transition,style:n,styleSpec:i}):s[t]?Hn({key:t,value:e[t],valueSpec:s[t],style:n,styleSpec:i}):[new Ut(t,e[t],`unknown property "${t}"`)]);}if(e.source){const t=n.sources&&n.sources[e.source],i=t&&qt(t.type);t?"raster-dem"!==i&&a.push(new Ut(r,e.source,`terrain cannot be used with a source of type ${i}, it only be used with a "raster-dem" source type`)):a.push(new Ut(r,e.source,`source "${e.source}" not found`));}else a.push(new Ut(r,e,'terrain is missing required property "source"'));return a}function Kn(t){const e=t.value,r=t.style,n=t.styleSpec,i=n.fog;let s=[];const a=Qr(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new Ut("fog",e,`object expected, ${a} found`)]),s;for(const t in e){const a=t.match(/^(.*)-transition$/);s=s.concat(a&&i[a[1]]&&i[a[1]].transition?Hn({key:t,value:e[t],valueSpec:n.transition,style:r,styleSpec:n}):i[t]?Hn({key:t,value:e[t],valueSpec:i[t],style:r,styleSpec:n}):[new Ut(t,e[t],`unknown property "${t}"`)]);}return s}const Yn={"*":()=>[],array:xn,boolean:function(t){const e=t.value,r=t.key,n=Qr(e);return "boolean"!==n?[new Ut(r,e,`boolean expected, ${n} found`)]:[]},number:vn,color:function(t){const e=t.key,r=t.value,n=Qr(r);return "string"!==n?[new Ut(e,r,`color expected, ${n} found`)]:null===ce.parseCSSColor(r)?[new Ut(e,r,`color expected, "${r}" found`)]:[]},constants:Ot,enum:An,filter:Ln,function:bn,layer:jn,object:gn,source:Zn,light:Gn,terrain:Xn,fog:Kn,string:qn,formatted:function(t){return 0===qn(t).length?[]:wn(t)},resolvedImage:function(t){return 0===qn(t).length?[]:wn(t)},projection:function(t){const e=t.value,r=t.styleSpec,n=r.projection,i=t.style;let s=[];const a=Qr(e);if("object"===a)for(const t in e)s=s.concat(Hn({key:t,value:e[t],valueSpec:n[t],style:i,styleSpec:r}));else "string"!==a&&(s=s.concat([new Ut("projection",e,`object or string expected, ${a} found`)]));return s}};function Hn(t){const e=t.value,r=t.valueSpec,n=t.styleSpec;return r.expression&&tn(qt(e))?bn(t):r.expression&&cn(Nt(e))?wn(t):r.type&&Yn[r.type]?Yn[r.type](t):gn(jt({},t,{valueSpec:r.type?n[r.type]:r}))}function Jn(t){const e=t.value,r=t.key,n=qn(t);return n.length||(-1===e.indexOf("{fontstack}")&&n.push(new Ut(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new Ut(r,e,'"glyphs" url must include a "{range}" token'))),n}function Wn(t,e=$t){let r=[];return r=r.concat(Hn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Jn,"*":()=>[]}})),t.constants&&(r=r.concat(Ot({key:"constants",value:t.constants,style:t,styleSpec:e}))),Qn(r)}function Qn(t){return [].concat(t).sort(((t,e)=>t.line-e.line))}function ti(t){return function(...e){return Qn(t.apply(this,e))}}Wn.source=ti(Zn),Wn.light=ti(Gn),Wn.terrain=ti(Xn),Wn.fog=ti(Kn),Wn.layer=ti(jn),Wn.filter=ti(Ln),Wn.paintProperty=ti(Un),Wn.layoutProperty=ti(On);const ei=Wn,ri=ei.light,ni=ei.fog,ii=ei.paintProperty,si=ei.layoutProperty;function ai(t,e){let r=!1;if(e&&e.length)for(const n of e)t.fire(new Lt(new Error(n.message))),r=!0;return r}var oi=li;function li(t,e,r){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(r=i[2]);for(var s=0;s<this.d*this.d;s++){var a=i[3+s],o=i[3+s+1];n.push(a===o?null:i.subarray(a,o));}var l=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],l),this.bboxes=i.subarray(l),this.insert=this._insertReadonly;}else {this.d=e+2*r;for(var u=0;u<this.d*this.d;u++)n.push([]);this.keys=[],this.bboxes=[];}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var c=r/e*t;this.min=-c,this.max=t+c;}li.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i);},li.prototype._insertReadonly=function(){throw "Cannot insert into a GridIndex created from an ArrayBuffer."},li.prototype._insertCell=function(t,e,r,n,i,s){this.cells[i].push(s);},li.prototype.query=function(t,e,r,n,i){var s=this.min,a=this.max;if(t<=s&&e<=s&&a<=r&&a<=n&&!i)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(t,e,r,n,this._queryCell,o,{},i),o},li.prototype._queryCell=function(t,e,r,n,i,s,a,o){var l=this.cells[i];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var p=l[h];if(void 0===a[p]){var d=4*p;(o?o(c[d+0],c[d+1],c[d+2],c[d+3]):t<=c[d+2]&&e<=c[d+3]&&r>=c[d+0]&&n>=c[d+1])?(a[p]=!0,s.push(u[p])):a[p]=!1;}}},li.prototype._forEachCell=function(t,e,r,n,i,s,a,o){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),h=this._convertToCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++){var f=this.d*d+p;if((!o||o(this._convertFromCellCoord(p),this._convertFromCellCoord(d),this._convertFromCellCoord(p+1),this._convertFromCellCoord(d+1)))&&i.call(this,t,e,r,n,f,s,a,o))return}},li.prototype._convertFromCellCoord=function(t){return (t-this.padding)/this.scale},li.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},li.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(e+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var s=e,a=0;a<t.length;a++){var o=t[a];i[3+a]=s,i.set(o,s),s+=o.length;}return i[3+t.length]=s,i.set(this.keys,s),i[3+t.length+1]=s+=this.keys.length,i.set(this.bboxes,s),s+=this.bboxes.length,i.buffer};const{ImageData:ui,ImageBitmap:ci}=a,hi={};function pi(t,e,r={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),hi[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]};}pi("Object",Object),oi.serialize=function(t,e){const r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},oi.deserialize=function(t){return new oi(t.buffer)},pi("Grid",oi),pi("Color",he),pi("Error",Error),pi("ResolvedImage",ye),pi("StylePropertyFunction",yn),pi("StyleExpression",un,{omit:["_evaluator"]}),pi("ZoomDependentExpression",dn),pi("ZoomConstantExpression",pn),pi("CompoundExpression",Ce,{omit:["_evaluate"]});for(const t in qr)qr[t]._classRegistryKey||pi(`Expression_${t}`,qr[t]);function di(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function fi(t){return ci&&t instanceof ci}function yi(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(di(t)||fi(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const r=t;return e&&e.push(r.buffer),r}if(t instanceof ui)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const r=[];for(const n of t)r.push(yi(n,e));return r}if("object"==typeof t){const r=t.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class");const i=r.serialize?r.serialize(t,e):{};if(!r.serialize){for(const r in t){if(!t.hasOwnProperty(r))continue;if(hi[n].omit.indexOf(r)>=0)continue;const s=t[r];i[r]=hi[n].shallow.indexOf(r)>=0?s:yi(s,e);}t instanceof Error&&(i.message=t.message);}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return "Object"!==n&&(i.$name=n),i}throw new Error("can't serialize object of type "+typeof t)}function mi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||di(t)||fi(t)||ArrayBuffer.isView(t)||t instanceof ui)return t;if(Array.isArray(t))return t.map(mi);if("object"==typeof t){const e=t.$name||"Object",{klass:r}=hi[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(t);const n=Object.create(r.prototype);for(const r of Object.keys(t)){if("$name"===r)continue;const i=t[r];n[r]=hi[e].shallow.indexOf(r)>=0?i:mi(i);}return n}throw new Error("can't deserialize object of type "+typeof t)}class gi{constructor(){this.first=!0;}update(t,e){const r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))}}const xi=t=>t>=1536&&t<=1791,vi=t=>t>=1872&&t<=1919,bi=t=>t>=2208&&t<=2303,wi=t=>t>=11904&&t<=12031,_i=t=>t>=12032&&t<=12255,Ai=t=>t>=12272&&t<=12287,ki=t=>t>=12288&&t<=12351,Si=t=>t>=12352&&t<=12447,Ii=t=>t>=12448&&t<=12543,zi=t=>t>=12544&&t<=12591,Ti=t=>t>=12704&&t<=12735,Mi=t=>t>=12736&&t<=12783,Ci=t=>t>=12784&&t<=12799,Bi=t=>t>=12800&&t<=13055,Ei=t=>t>=13056&&t<=13311,Di=t=>t>=13312&&t<=19903,Pi=t=>t>=19968&&t<=40959,Vi=t=>t>=40960&&t<=42127,Fi=t=>t>=42128&&t<=42191,Li=t=>t>=44032&&t<=55215,Ri=t=>t>=63744&&t<=64255,$i=t=>t>=64336&&t<=65023,Ui=t=>t>=65040&&t<=65055,Oi=t=>t>=65072&&t<=65103,ji=t=>t>=65104&&t<=65135,qi=t=>t>=65136&&t<=65279,Ni=t=>t>=65280&&t<=65519;function Zi(t){for(const e of t)if(Ki(e.charCodeAt(0)))return !0;return !1}function Gi(t){for(const e of t)if(!Xi(e.charCodeAt(0)))return !1;return !0}function Xi(t){return !(xi(t)||vi(t)||bi(t)||$i(t)||qi(t))}function Ki(t){return !(746!==t&&747!==t&&(t<4352||!(Ti(t)||zi(t)||Oi(t)&&!(t>=65097&&t<=65103)||Ri(t)||Ei(t)||wi(t)||Mi(t)||!(!ki(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Di(t)||Pi(t)||Bi(t)||(t=>t>=12592&&t<=12687)(t)||(t=>t>=43360&&t<=43391)(t)||(t=>t>=55216&&t<=55295)(t)||(t=>t>=4352&&t<=4607)(t)||Li(t)||Si(t)||Ai(t)||(t=>t>=12688&&t<=12703)(t)||_i(t)||Ci(t)||Ii(t)&&12540!==t||!(!Ni(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!ji(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(t=>t>=5120&&t<=5759)(t)||(t=>t>=6320&&t<=6399)(t)||Ui(t)||(t=>t>=19904&&t<=19967)(t)||Vi(t)||Fi(t))))}function Yi(t){return !(Ki(t)||function(t){return !!((t=>t>=128&&t<=255)(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||(t=>t>=8192&&t<=8303)(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||(t=>t>=8448&&t<=8527)(t)||(t=>t>=8528&&t<=8591)(t)||(t=>t>=8960&&t<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||(t=>t>=9216&&t<=9279)(t)&&9251!==t||(t=>t>=9280&&t<=9311)(t)||(t=>t>=9312&&t<=9471)(t)||(t=>t>=9632&&t<=9727)(t)||(t=>t>=9728&&t<=9983)(t)&&!(t>=9754&&t<=9759)||(t=>t>=11008&&t<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ki(t)||Ii(t)||(t=>t>=57344&&t<=63743)(t)||Oi(t)||ji(t)||Ni(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Hi(t){return t>=1424&&t<=2303||$i(t)||qi(t)}function Ji(t,e){return !(!e&&Hi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(t=>t>=6016&&t<=6143)(t))}function Wi(t){for(const e of t)if(Hi(e.charCodeAt(0)))return !0;return !1}const Qi="deferred",ts="loading",es="loaded";let rs=null,ns="unavailable",is=null;const ss=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(ns="error"),rs&&rs(t);};function as(){os.fire(new Ft("pluginStateChange",{pluginStatus:ns,pluginURL:is}));}const os=new Rt,ls=function(){return ns},us=function(){if(ns!==Qi||!is)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ns=ts,as(),is&&It({url:is},(t=>{t?ss(t):(ns=es,as());}));},cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ns===es||null!=cs.applyArabicShaping,isLoading:()=>ns===ts,setState(t){ns=t.pluginStatus,is=t.pluginURL;},isParsed:()=>null!=cs.applyArabicShaping&&null!=cs.processBidirectionalText&&null!=cs.processStyledBidirectionalText,getPluginURL:()=>is};class hs{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition,this.pitch=e.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new gi,this.transition={},this.pitch=0);}isSupportedScript(t){return function(t,e){for(const r of t)if(!Ji(r.charCodeAt(0),e))return !1;return !0}(t,cs.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}}}class ps{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(tn(t))return new yn(t,e);if(cn(t)){const r=fn(t,e);if("error"===r.result)throw new Error(r.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return r.value}{let r=t;return "string"==typeof t&&"color"===e.type&&(r=he.parse(t)),{kind:"constant",evaluate:()=>r}}}(void 0===e?t.specification.default:e,t.specification);}isDataDriven(){return "source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)}}class ds{constructor(t){this.property=t,this.value=new ps(t,void 0);}transitioned(t,e){return new ys(this.property,this.value,e,b({},t.transition,this.transition),t.now)}untransitioned(){return new ys(this.property,this.value,null,{},0)}}class fs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues);}getValue(t){return C(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ds(this._values[t].property)),this._values[t].value=new ps(this._values[t].property,null===e?void 0:C(e));}getTransition(t){return C(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ds(this._values[t].property)),this._values[t].transition=C(e)||void 0;}serialize(){const t={};for(const e of Object.keys(this._values)){const r=this.getValue(e);void 0!==r&&(t[e]=r);const n=this.getTransition(e);void 0!==n&&(t[`${e}-transition`]=n);}return t}transitioned(t,e){const r=new ms(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(t,e._values[n]);return r}untransitioned(){const t=new ms(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class ys{constructor(t,e,r,n,i){const s=n.delay||0,a=n.duration||0;i=i||0,this.property=t,this.value=e,this.begin=i+s,this.end=this.begin+a,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r);}possiblyEvaluate(t,e,r){const n=t.now||0,i=this.value.possiblyEvaluate(t,e,r),s=this.prior;if(s){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return s.possiblyEvaluate(t,e,r);{const a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(t,e,r),i,d(a))}}return i}}class ms{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues);}possiblyEvaluate(t,e,r){const n=new vs(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(t,e,r);return n}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return !0;return !1}}class gs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues);}getValue(t){return C(this._values[t].value)}setValue(t,e){this._values[t]=new ps(this._values[t].property,null===e?void 0:C(e));}serialize(){const t={};for(const e of Object.keys(this._values)){const r=this.getValue(e);void 0!==r&&(t[e]=r);}return t}possiblyEvaluate(t,e,r){const n=new vs(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(t,e,r);return n}}class xs{constructor(t,e,r){this.property=t,this.value=e,this.parameters=r;}isConstant(){return "constant"===this.value.kind}constantOr(t){return "constant"===this.value.kind?this.value.value:t}evaluate(t,e,r,n){return this.property.evaluate(this.value,this.parameters,t,e,r,n)}}class vs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues);}get(t){return this._values[t]}}class bs{constructor(t){this.specification=t;}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,r){const n=ir[this.specification.type];return n?n(t,e,r):t}}class ws{constructor(t,e){this.specification=t,this.overrides=e;}possiblyEvaluate(t,e,r,n){return new xs(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},r,n)}:t.expression,e)}interpolate(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new xs(this,{kind:"constant",value:void 0},t.parameters);const n=ir[this.specification.type];return n?new xs(this,{kind:"constant",value:n(t.value.value,e.value.value,r)},t.parameters):t}evaluate(t,e,r,n,i,s){return "constant"===t.kind?t.value:t.evaluate(e,r,n,i,s)}}class _s extends ws{possiblyEvaluate(t,e,r,n){if(void 0===t.value)return new xs(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},r,n),s="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(s,s,s,e);return new xs(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){const r=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new xs(this,{kind:"constant",value:r},e)}return new xs(this,t.expression,e)}evaluate(t,e,r,n,i,s){if("source"===t.kind){const a=t.evaluate(e,r,n,i,s);return this._calculate(a,a,a,e)}return "composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,n),t.evaluate({zoom:Math.floor(e.zoom)},r,n),t.evaluate({zoom:Math.floor(e.zoom)+1},r,n),e):t.value}_calculate(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e,other:r}:{from:r,to:e,other:t}}interpolate(t){return t}}class As{constructor(t){this.specification=t;}possiblyEvaluate(t,e,r,n){if(void 0!==t.value){if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},r,n);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new hs(Math.floor(e.zoom-1),e)),t.expression.evaluate(new hs(Math.floor(e.zoom),e)),t.expression.evaluate(new hs(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}}interpolate(t){return t}}class ks{constructor(t){this.specification=t;}possiblyEvaluate(t,e,r,n){return !!t.expression.evaluate(e,null,{},r,n)}interpolate(){return !1}}class Ss{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const r=t[e];r.specification.overridable&&this.overridableProperties.push(e);const n=this.defaultPropertyValues[e]=new ps(r,void 0),i=this.defaultTransitionablePropertyValues[e]=new ds(r);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({});}}}function Is(t,e){return 256*(t=m(Math.floor(t),0,255))+m(Math.floor(e),0,255)}pi("DataDrivenProperty",ws),pi("DataConstantProperty",bs),pi("CrossFadedDataDrivenProperty",_s),pi("CrossFadedProperty",As),pi("ColorRampProperty",ks);const zs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ts{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8;}}class Ms{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0);}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews());}clear(){this.length=0;}resize(t){this.reserve(t),this.length=t;}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e);}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Cs(t,e=1){let r=0,n=0;return {members:t.map((t=>{const i=zs[t.type].BYTES_PER_ELEMENT,s=r=Bs(r,Math.max(e,i)),a=t.components||1;return n=Math.max(n,i),r+=i*a,{name:t.name,type:t.type,components:a,offset:s}})),size:Bs(r,Math.max(n,e)),alignment:e}}function Bs(t,e){return Math.ceil(t/e)*e}class Es extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer);}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const n=2*t;return this.int16[n+0]=e,this.int16[n+1]=r,t}}Es.prototype.bytesPerElement=4,pi("StructArrayLayout2i4",Es);class Ds extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer);}emplaceBack(t,e,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,n)}emplace(t,e,r,n,i){const s=4*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,t}}Ds.prototype.bytesPerElement=8,pi("StructArrayLayout4i8",Ds);class Ps extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,n,i,s,a)}emplace(t,e,r,n,i,s,a,o){const l=6*t,u=12*t,c=3*t;return this.int16[l+0]=e,this.int16[l+1]=r,this.uint8[u+4]=n,this.uint8[u+5]=i,this.uint8[u+6]=s,this.uint8[u+7]=a,this.float32[c+2]=o,t}}Ps.prototype.bytesPerElement=12,pi("StructArrayLayout2i4ub1f12",Ps);class Vs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t,e,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r)}emplace(t,e,r,n){const i=3*t;return this.float32[i+0]=e,this.float32[i+1]=r,this.float32[i+2]=n,t}}Vs.prototype.bytesPerElement=12,pi("StructArrayLayout3f12",Vs);class Fs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,r,n,i,s,a,o,l,u)}emplace(t,e,r,n,i,s,a,o,l,u,c){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=r,this.uint16[h+2]=n,this.uint16[h+3]=i,this.uint16[h+4]=s,this.uint16[h+5]=a,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,t}}Fs.prototype.bytesPerElement=20,pi("StructArrayLayout10ui20",Fs);class Ls extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,e,r,n,i,s,a,o)}emplace(t,e,r,n,i,s,a,o,l){const u=8*t;return this.uint16[u+0]=e,this.uint16[u+1]=r,this.uint16[u+2]=n,this.uint16[u+3]=i,this.uint16[u+4]=s,this.uint16[u+5]=a,this.uint16[u+6]=o,this.uint16[u+7]=l,t}}Ls.prototype.bytesPerElement=16,pi("StructArrayLayout8ui16",Ls);class Rs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y){const m=this.length;return this.resize(m+1),this.emplace(m,t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y)}emplace(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m){const g=16*t;return this.int16[g+0]=e,this.int16[g+1]=r,this.int16[g+2]=n,this.int16[g+3]=i,this.uint16[g+4]=s,this.uint16[g+5]=a,this.uint16[g+6]=o,this.uint16[g+7]=l,this.int16[g+8]=u,this.int16[g+9]=c,this.int16[g+10]=h,this.int16[g+11]=p,this.int16[g+12]=d,this.int16[g+13]=f,this.int16[g+14]=y,this.int16[g+15]=m,t}}Rs.prototype.bytesPerElement=32,pi("StructArrayLayout4i4ui4i4i32",Rs);class $s extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer);}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}$s.prototype.bytesPerElement=4,pi("StructArrayLayout1ul4",$s);class Us extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o,l,u,c,h,p){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,r,n,i,s,a,o,l,u,c,h,p)}emplace(t,e,r,n,i,s,a,o,l,u,c,h,p,d){const f=20*t,y=10*t;return this.int16[f+0]=e,this.int16[f+1]=r,this.int16[f+2]=n,this.int16[f+3]=i,this.int16[f+4]=s,this.float32[y+3]=a,this.float32[y+4]=o,this.float32[y+5]=l,this.float32[y+6]=u,this.int16[f+14]=c,this.uint32[y+8]=h,this.uint16[f+18]=p,this.uint16[f+19]=d,t}}Us.prototype.bytesPerElement=40,pi("StructArrayLayout5i4f1i1ul2ui40",Us);class Os extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,n,i,s,a)}emplace(t,e,r,n,i,s,a,o){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=r,this.int16[l+2]=n,this.int16[l+4]=i,this.int16[l+5]=s,this.int16[l+6]=a,this.int16[l+7]=o,t}}Os.prototype.bytesPerElement=16,pi("StructArrayLayout3i2i2i16",Os);class js extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,r,n,i)}emplace(t,e,r,n,i,s){const a=4*t,o=8*t;return this.float32[a+0]=e,this.float32[a+1]=r,this.float32[a+2]=n,this.int16[o+6]=i,this.int16[o+7]=s,t}}js.prototype.bytesPerElement=16,pi("StructArrayLayout2f1f2i16",js);class qs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t,e,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,n)}emplace(t,e,r,n,i){const s=12*t,a=3*t;return this.uint8[s+0]=e,this.uint8[s+1]=r,this.float32[a+1]=n,this.float32[a+2]=i,t}}qs.prototype.bytesPerElement=12,pi("StructArrayLayout2ub2f12",qs);class Ns extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r)}emplace(t,e,r,n){const i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,this.uint16[i+2]=n,t}}Ns.prototype.bytesPerElement=6,pi("StructArrayLayout3ui6",Ns);class Zs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b)}emplace(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b,w){const _=30*t,A=15*t,k=60*t;return this.int16[_+0]=e,this.int16[_+1]=r,this.int16[_+2]=n,this.float32[A+2]=i,this.float32[A+3]=s,this.uint16[_+8]=a,this.uint16[_+9]=o,this.uint32[A+5]=l,this.uint32[A+6]=u,this.uint32[A+7]=c,this.uint16[_+16]=h,this.uint16[_+17]=p,this.uint16[_+18]=d,this.float32[A+10]=f,this.float32[A+11]=y,this.uint8[k+48]=m,this.uint8[k+49]=g,this.uint8[k+50]=x,this.uint32[A+13]=v,this.int16[_+28]=b,this.uint8[k+58]=w,t}}Zs.prototype.bytesPerElement=60,pi("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Zs);class Gs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer);}emplaceBack(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b,w,_,A,k,S,I,z,T,M){const C=this.length;return this.resize(C+1),this.emplace(C,t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b,w,_,A,k,S,I,z,T,M)}emplace(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b,w,_,A,k,S,I,z,T,M,C){const B=38*t,E=19*t;return this.int16[B+0]=e,this.int16[B+1]=r,this.int16[B+2]=n,this.float32[E+2]=i,this.float32[E+3]=s,this.int16[B+8]=a,this.int16[B+9]=o,this.int16[B+10]=l,this.int16[B+11]=u,this.int16[B+12]=c,this.int16[B+13]=h,this.uint16[B+14]=p,this.uint16[B+15]=d,this.uint16[B+16]=f,this.uint16[B+17]=y,this.uint16[B+18]=m,this.uint16[B+19]=g,this.uint16[B+20]=x,this.uint16[B+21]=v,this.uint16[B+22]=b,this.uint16[B+23]=w,this.uint16[B+24]=_,this.uint16[B+25]=A,this.uint16[B+26]=k,this.uint16[B+27]=S,this.uint16[B+28]=I,this.uint32[E+15]=z,this.float32[E+16]=T,this.float32[E+17]=M,this.float32[E+18]=C,t}}Gs.prototype.bytesPerElement=76,pi("StructArrayLayout3i2f6i15ui1ul3f76",Gs);class Xs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Xs.prototype.bytesPerElement=4,pi("StructArrayLayout1f4",Xs);class Ks extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer);}emplaceBack(t,e,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r)}emplace(t,e,r,n){const i=3*t;return this.int16[i+0]=e,this.int16[i+1]=r,this.int16[i+2]=n,t}}Ks.prototype.bytesPerElement=6,pi("StructArrayLayout3i6",Ks);class Ys extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,n)}emplace(t,e,r,n,i){const s=6*t;return this.uint32[3*t+0]=e,this.uint16[s+2]=r,this.uint16[s+3]=n,this.uint16[s+4]=i,t}}Ys.prototype.bytesPerElement=12,pi("StructArrayLayout1ul3ui12",Ys);class Hs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=r,t}}Hs.prototype.bytesPerElement=4,pi("StructArrayLayout2ui4",Hs);class Js extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer);}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Js.prototype.bytesPerElement=2,pi("StructArrayLayout1ui2",Js);class Ws extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const n=2*t;return this.float32[n+0]=e,this.float32[n+1]=r,t}}Ws.prototype.bytesPerElement=8,pi("StructArrayLayout2f8",Ws);class Qs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer);}emplaceBack(t,e,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,n)}emplace(t,e,r,n,i){const s=4*t;return this.float32[s+0]=e,this.float32[s+1]=r,this.float32[s+2]=n,this.float32[s+3]=i,t}}Qs.prototype.bytesPerElement=16,pi("StructArrayLayout4f16",Qs);class ta extends Ts{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ta.prototype.size=40;class ea extends Us{get(t){return new ta(this,t)}}pi("CollisionBoxArray",ea);class ra extends Ts{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t;}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t;}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t;}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t;}}ra.prototype.size=60;class na extends Zs{get(t){return new ra(this,t)}}pi("PlacedSymbolArray",na);class ia extends Ts{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t;}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ia.prototype.size=76;class sa extends Gs{get(t){return new ia(this,t)}}pi("SymbolInstanceArray",sa);class aa extends Xs{getoffsetX(t){return this.float32[1*t+0]}}pi("GlyphOffsetArray",aa);class oa extends Ks{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}pi("SymbolLineVertexArray",oa);class la extends Ts{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}la.prototype.size=12;class ua extends Ys{get(t){return new la(this,t)}}pi("FeatureIndexArray",ua);class ca extends Ts{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}ca.prototype.size=4;class ha extends Hs{get(t){return new ca(this,t)}}pi("FillExtrusionCentroidArray",ha);const pa=Cs([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),da=Cs([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var fa=ue((function(t){t.exports=function(t,e){var r,n,i,s,a,o,l,u;for(n=t.length-(r=3&t.length),i=e,a=3432918353,o=461845907,u=0;u<n;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(s=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295;}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};})),ya=ue((function(t){t.exports=function(t,e){for(var r,n=t.length,i=e^n,s=0;n>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(s)|(255&t.charCodeAt(++s))<<8|(255&t.charCodeAt(++s))<<16|(255&t.charCodeAt(++s))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++s;switch(n){case 3:i^=(255&t.charCodeAt(s+2))<<16;case 2:i^=(255&t.charCodeAt(s+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(s)))+((1540483477*(i>>>16)&65535)<<16);}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};})),ma=fa,ga=ya;ma.murmur3=fa,ma.murmur2=ga;class xa{constructor(){this.ids=[],this.positions=[],this.indexed=!1;}add(t,e,r,n){this.ids.push(va(t)),this.positions.push(e,r,n);}getPositions(t){const e=va(t);let r=0,n=this.ids.length-1;for(;r<n;){const t=r+n>>1;this.ids[t]>=e?n=t:r=t+1;}const i=[];for(;this.ids[r]===e;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(t,e){const r=new Float64Array(t.ids),n=new Uint32Array(t.positions);return ba(r,n,0,r.length-1),e&&e.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(t){const e=new xa;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function va(t){const e=+t;return !isNaN(e)&&e<=o?e:ma(String(t))}function ba(t,e,r,n){for(;r<n;){const i=t[r+n>>1];let s=r-1,a=n+1;for(;;){do{s++;}while(t[s]<i);do{a--;}while(t[a]>i);if(s>=a)break;wa(t,s,a),wa(e,3*s,3*a),wa(e,3*s+1,3*a+1),wa(e,3*s+2,3*a+2);}a-r<n-a?(ba(t,e,r,a),r=a+1):(ba(t,e,a+1,n),n=a);}}function wa(t,e,r){const n=t[e];t[e]=t[r],t[r]=n;}pi("FeaturePositionMap",xa);class _a{constructor(t,e){this.gl=t.gl,this.location=e;}}class Aa extends _a{constructor(t,e){super(t,e),this.current=0;}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t));}}class ka extends _a{constructor(t,e){super(t,e),this.current=[0,0,0,0];}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]));}}class Sa extends _a{constructor(t,e){super(t,e),this.current=he.transparent;}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a));}}const Ia=new Float32Array(16),za=new Float32Array(9),Ta=new Float32Array(4);function Ma(t){return [Is(255*t.r,255*t.g),Is(255*t.b,255*t.a)]}class Ca{constructor(t,e,r){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=r;}setUniform(t,e,r){t.set(r.constantOr(this.value));}getBinding(t,e,r){return "color"===this.type?new Sa(t,e):new Aa(t,e)}}class Ba{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1;}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tl.concat(e.br),this.patternTo=t.tl.concat(t.br);}setUniform(t,e,r,n){const i="u_pattern_to"===n||"u_dash_to"===n?this.patternTo:"u_pattern_from"===n||"u_dash_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;i&&t.set(i);}getBinding(t,e,r){return "u_pattern_from"===r||"u_pattern_to"===r||"u_dash_from"===r||"u_dash_to"===r?new ka(t,e):new Aa(t,e)}}class Ea{constructor(t,e,r,n){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n;}populatePaintArray(t,e,r,n,i,s){const a=this.paintVertexArray.length,o=this.expression.evaluate(new hs(0),e,{},i,n,s);this.paintVertexArray.resize(t),this._setPaintValue(a,t,o);}updatePaintArray(t,e,r,n,i){const s=this.expression.evaluate({zoom:0},r,n,void 0,i);this._setPaintValue(t,e,s);}_setPaintValue(t,e,r){if("color"===this.type){const n=Ma(r);for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n[0],n[1]);}else {for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r));}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent));}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy();}}class Da{constructor(t,e,r,n,i,s){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new s;}populatePaintArray(t,e,r,n,i,s){const a=this.expression.evaluate(new hs(this.zoom),e,{},i,n,s),o=this.expression.evaluate(new hs(this.zoom+1),e,{},i,n,s),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,a,o);}updatePaintArray(t,e,r,n,i){const s=this.expression.evaluate({zoom:this.zoom},r,n,void 0,i),a=this.expression.evaluate({zoom:this.zoom+1},r,n,void 0,i);this._setPaintValue(t,e,s,a);}_setPaintValue(t,e,r,n){if("color"===this.type){const i=Ma(r),s=Ma(n);for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i[0],i[1],s[0],s[1]);}else {for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n));}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent));}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy();}setUniform(t,e){const r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,n=m(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(n);}getBinding(t,e,r){return new Aa(t,e)}}class Pa{constructor(t,e,r,n,i,s,a){this.expression=t,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.paintVertexAttributes=("array"===r?da:pa).members;for(let t=0;t<e.length;++t);this.zoomInPaintVertexArray=new s,this.zoomOutPaintVertexArray=new s;}populatePaintArray(t,e,r){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(n,t,e.patterns&&e.patterns[this.layerId],r);}updatePaintArray(t,e,r,n,i,s){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],s);}_setPaintValues(t,e,r,n){if(!n||!r)return;const{min:i,mid:s,max:a}=r,o=n[i],l=n[s],u=n[a];if(o&&l&&u)for(let r=t;r<e;r++)this._setPaintValue(this.zoomInPaintVertexArray,r,l,o),this._setPaintValue(this.zoomOutPaintVertexArray,r,l,u);}_setPaintValue(t,e,r,n){t.emplace(e,r.tl[0],r.tl[1],r.br[0],r.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],r.pixelRatio,n.pixelRatio);}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent));}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy();}}class Va{constructor(t,e,r=(()=>!0)){this.binders={},this._buffers=[];const n=[];for(const i in t.paint._values){if(!r(i))continue;const s=t.paint.get(i);if(!(s instanceof xs&&Hr(s.property.specification)))continue;const a=Ra(i,t.type),o=s.value,l=s.property.specification.type,u=s.property.useIntegerZoom,c=s.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c,p="line-dasharray"===String(i)&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==o.kind||p)if("source"===o.kind||p||h){const r=Oa(i,l,"source");this.binders[i]=h?new Pa(o,a,l,u,e,r,t.id):new Ea(o,a,l,r),n.push(`/a_${i}`);}else {const t=Oa(i,l,"composite");this.binders[i]=new Da(o,a,l,u,e,t),n.push(`/z_${i}`);}else this.binders[i]=h?new Ba(o.value,a):new Ca(o.value,a,l),n.push(`/u_${i}`);}this.cacheKey=n.sort().join("");}getMaxValue(t){const e=this.binders[t];return e instanceof Ea||e instanceof Da?e.maxValue:0}populatePaintArrays(t,e,r,n,i,s){for(const a in this.binders){const o=this.binders[a];(o instanceof Ea||o instanceof Da||o instanceof Pa)&&o.populatePaintArray(t,e,r,n,i,s);}}setConstantPatternPositions(t,e){for(const r in this.binders){const n=this.binders[r];n instanceof Ba&&n.setConstantPatternPositions(t,e);}}updatePaintArrays(t,e,r,n,i,s){let a=!1;for(const o in t){const l=e.getPositions(o);for(const e of l){const l=r.feature(e.index);for(const r in this.binders){const u=this.binders[r];if((u instanceof Ea||u instanceof Da||u instanceof Pa)&&!0===u.expression.isStateDependent){const c=n.paint.get(r);u.expression=c.value,u.updatePaintArray(e.start,e.end,l,t[o],i,s),a=!0;}}}}return a}defines(){const t=[];for(const e in this.binders){const r=this.binders[e];(r instanceof Ca||r instanceof Ba)&&t.push(...r.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)));}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const r=this.binders[e];if(r instanceof Ea||r instanceof Da||r instanceof Pa)for(let e=0;e<r.paintVertexAttributes.length;e++)t.push(r.paintVertexAttributes[e].name);}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const r=this.binders[e];if(r instanceof Ca||r instanceof Ba||r instanceof Da)for(const e of r.uniformNames)t.push(e);}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const r=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof Ca||i instanceof Ba||i instanceof Da)for(const s of i.uniformNames)if(e[s]){const a=i.getBinding(t,e[s],s);r.push({name:s,property:n,binding:a});}}return r}setUniforms(t,e,r,n){for(const{name:t,property:i,binding:s}of e)this.binders[i].setUniform(s,n,r.get(i),t);}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const r=this.binders[e];if(t&&r instanceof Pa){const e=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;e&&this._buffers.push(e);}else (r instanceof Ea||r instanceof Da)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer);}}upload(t){for(const e in this.binders){const r=this.binders[e];(r instanceof Ea||r instanceof Da||r instanceof Pa)&&r.upload(t);}this.updatePaintBuffers();}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Ea||e instanceof Da||e instanceof Pa)&&e.destroy();}}}class Fa{constructor(t,e,r=(()=>!0)){this.programConfigurations={};for(const n of t)this.programConfigurations[n.id]=new Va(n,e,r);this.needsUpload=!1,this._featureMap=new xa,this._bufferOffset=0;}populatePaintArrays(t,e,r,n,i,s,a){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(t,e,n,i,s,a);void 0!==e.id&&this._featureMap.add(e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0;}updatePaintArrays(t,e,r,n,i){for(const s of r)this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(t,this._featureMap,e,s,n,i)||this.needsUpload;}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1;}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy();}}const La={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Ra(t,e){return La[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const $a={"line-pattern":{source:Fs,composite:Fs},"fill-pattern":{source:Fs,composite:Fs},"fill-extrusion-pattern":{source:Fs,composite:Fs},"line-dasharray":{source:Ls,composite:Ls}},Ua={color:{source:Ws,composite:Qs},number:{source:Xs,composite:Ws}};function Oa(t,e,r){const n=$a[t];return n&&n[r]||Ua[e][r]}pi("ConstantBinder",Ca),pi("CrossFadedConstantBinder",Ba),pi("SourceExpressionBinder",Ea),pi("CrossFadedCompositeBinder",Pa),pi("CompositeExpressionBinder",Da),pi("ProgramConfiguration",Va,{omit:["_buffers"]}),pi("ProgramConfigurationSet",Fa);const ja="-transition";class qa extends Rt{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new gs(e.layout)),e.paint)){this._transitionablePaint=new fs(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vs(e.paint);}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return "visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,r={}){null!=e&&this._validate(si,`layers.${this.id}.layout.${t}`,t,e,r)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e);}getPaintProperty(t){return z(t,ja)?this._transitionablePaint.getTransition(t.slice(0,-ja.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,r={}){if(null!=e&&this._validate(ii,`layers.${this.id}.paint.${t}`,t,e,r))return !1;if(z(t,ja))return this._transitionablePaint.setTransition(t.slice(0,-ja.length),e||void 0),!1;{const r=this._transitionablePaint._values[t],n="cross-faded-data-driven"===r.property.specification["property-type"],i=r.value.isDataDriven(),s=r.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const a=this._transitionablePaint._values[t].value;return a.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(t,s,a)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,r){return !1}isHidden(t){return !!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint);}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e);}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),M(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,r,n,i={}){return (!i||!1!==i.validate)&&ai(this,t.call(ei,{key:e,layerType:this.type,objectKey:r,value:n,styleSpec:$t,style:{glyphs:!0,sprite:!0}}))}is3D(){return !1}isSky(){return !1}isTileClipped(){return !1}hasOffscreenPass(){return !1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof xs&&Hr(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return !0}return !1}compileFilter(){this._filterCompiled||(this._featureFilter=Sn(this.filter),this._filterCompiled=!0);}invalidateCompiledFilter(){this._filterCompiled=!1;}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Na=Cs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Za}=Na;class Ga{constructor(t=[]){this.segments=t;}prepareSegment(t,e,r,n){let i=this.segments[this.segments.length-1];return t>Ga.MAX_VERTEX_ARRAY_LENGTH&&E(`Max vertices per segment is ${Ga.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!i||i.vertexLength+t>Ga.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(i.sortKey=n),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy();}static simpleSegment(t,e,r,n){return new Ga([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}Ga.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pi("SegmentVector",Ga);var Xa=8192;class Ka{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]));}setNorthEast(t){return this._ne=t instanceof Ha?new Ha(t.lng,t.lat):Ha.convert(t),this}setSouthWest(t){return this._sw=t instanceof Ha?new Ha(t.lng,t.lat):Ha.convert(t),this}extend(t){const e=this._sw,r=this._ne;let n,i;if(t instanceof Ha)n=t,i=t;else {if(!(t instanceof Ka))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ka.convert(t)):this.extend(Ha.convert(t)):this;if(n=t._sw,i=t._ne,!n||!i)return this}return e||r?(e.lng=Math.min(n.lng,e.lng),e.lat=Math.min(n.lat,e.lat),r.lng=Math.max(i.lng,r.lng),r.lat=Math.max(i.lat,r.lat)):(this._sw=new Ha(n.lng,n.lat),this._ne=new Ha(i.lng,i.lat)),this}getCenter(){return new Ha((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ha(this.getWest(),this.getNorth())}getSouthEast(){return new Ha(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return [this._sw.toArray(),this._ne.toArray()]}toString(){return `LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return !(this._sw&&this._ne)}contains(t){const{lng:e,lat:r}=Ha.convert(t);let n=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n}static convert(t){return !t||t instanceof Ka?t:new Ka(t)}}const Ya=6371008.8;class Ha{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ha(g(this.lng,-180,180),this.lat)}toArray(){return [this.lng,this.lat]}toString(){return `LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,r=this.lat*e,n=t.lat*e,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((t.lng-this.lng)*e);return Ya*Math.acos(Math.min(i,1))}toBounds(t=0){const e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new Ka(new Ha(this.lng-r,this.lat-e),new Ha(this.lng+r,this.lat+e))}static convert(t){if(t instanceof Ha)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Ha(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Ha(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ja=2*Math.PI*Ya;function Wa(t){return Ja*Math.cos(t*Math.PI/180)}function Qa(t){return (180+t)/360}function to(t){return (180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function eo(t,e){return t/Wa(e)}function ro(t){return 360*t-180}function no(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function io(t,e){return t*Wa(no(e))}const so=85.051129;class ao{constructor(t,e,r=0){this.x=+t,this.y=+e,this.z=+r;}static fromLngLat(t,e=0){const r=Ha.convert(t);return new ao(Qa(r.lng),to(r.lat),eo(e,r.lat))}toLngLat(){return new Ha(ro(this.x),no(this.y))}toAltitude(){return io(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ja*(t=no(this.y),1/Math.cos(t*Math.PI/180));var t;}}function oo(t,e,r,n,s,a,o,l,u){const c=(e+n)/2,h=(r+s)/2,p=new i(c,h);l(p),function(t,e,r,n,i,s){const a=r-i,o=n-s;return Math.abs((n-e)*a-(r-t)*o)/Math.hypot(a,o)}(p.x,p.y,a.x,a.y,o.x,o.y)>=u?(oo(t,e,r,c,h,a,p,l,u),oo(t,c,h,n,s,p,o,l,u)):t.push(o);}function lo(t,e,r){const n=[];let i,s,a;for(const o of t){const{x:t,y:l}=o;e(o),a?oo(n,i,s,t,l,a,o,e,r):n.push(o),i=t,s=l,a=o;}return n}const uo=Math.pow(2,14)-1,co=-uo-1;function ho(t,e){const r=Math.round(t.x*e),n=Math.round(t.y*e);return t.x=m(r,co,uo),t.y=m(n,co,uo),(r<t.x||r>t.x+1||n<t.y||n>t.y+1)&&E("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function po(t,e,r){const n=t.loadGeometry(),i=t.extent,s=Xa/i;if(e&&r&&"mercator"!==r.projection.name){const s=1<<e.z,{scale:a,x:o,y:l,projection:u}=r,c=t=>{const r=ro((e.x+t.x/i)/s),n=no((e.y+t.y/i)/s),c=u.project(r,n);t.x=(c.x*a-o)*i,t.y=(c.y*a-l)*i;};for(let e=0;e<n.length;e++)if(1!==t.type)n[e]=lo(n[e],c,1);else {const t=[];for(const r of n[e])r.x<0||r.x>=i||r.y<0||r.y>=i||(c(r),t.push(r));n[e]=t;}}for(const t of n)for(const e of t)ho(e,s);return n}function fo(t,e){return {type:t.type,id:t.id,properties:t.properties,geometry:e?po(t):[]}}function yo(t,e,r,n,i){t.emplaceBack(2*e+(n+1)/2,2*r+(i+1)/2);}class mo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Es,this.indexArray=new Ns,this.segments=new Ga,this.programConfigurations=new Fa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id));}populate(t,e,r,n){const i=this.layers[0],s=[];let a=null;"circle"===i.type&&(a=i.layout.get("circle-sort-key"));for(const{feature:e,id:i,index:o,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,u=fo(e,t);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),u,r))continue;const c=a?a.evaluate(u,{},r):void 0,h={id:i,properties:e.properties,type:e.type,sourceLayerIndex:l,index:o,geometry:t?u.geometry:po(e,r,n),patterns:{},sortKey:c};s.push(h);}a&&s.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of s){const{geometry:i,index:s,sourceLayerIndex:a}=n,o=t[s].feature;this.addFeature(n,i,s,e.availableImages,r),e.featureIndex.insert(o,i,s,a,this.index);}}update(t,e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r,n);}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return !this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Za),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0;}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy());}addFeature(t,e,r,n,i){for(const r of e)for(const e of r){const r=e.x,n=e.y;if(r<0||r>=Xa||n<0||n>=Xa)continue;const i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),s=i.vertexLength;yo(this.layoutVertexArray,r,n,-1,-1),yo(this.layoutVertexArray,r,n,1,-1),yo(this.layoutVertexArray,r,n,1,1),yo(this.layoutVertexArray,r,n,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+3,s+2),i.vertexLength+=4,i.primitiveLength+=2;}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},n,i);}}function go(t,e){for(let r=0;r<t.length;r++)if(Io(e,t[r]))return !0;for(let r=0;r<e.length;r++)if(Io(t,e[r]))return !0;return !!wo(t,e)}function xo(t,e,r){return !!Io(t,e)||!!Ao(e,t,r)}function vo(t,e){if(1===t.length)return So(e,t[0]);for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<n.length;e++)if(Io(t,n[e]))return !0}for(let r=0;r<t.length;r++)if(So(e,t[r]))return !0;for(let r=0;r<e.length;r++)if(wo(t,e[r]))return !0;return !1}function bo(t,e,r){if(t.length>1){if(wo(t,e))return !0;for(let n=0;n<e.length;n++)if(Ao(e[n],t,r))return !0}for(let n=0;n<t.length;n++)if(Ao(t[n],e,r))return !0;return !1}function wo(t,e){if(0===t.length||0===e.length)return !1;for(let r=0;r<t.length-1;r++){const n=t[r],i=t[r+1];for(let t=0;t<e.length-1;t++)if(_o(n,i,e[t],e[t+1]))return !0}return !1}function _o(t,e,r,n){return D(t,r,n)!==D(e,r,n)&&D(t,e,r)!==D(t,e,n)}function Ao(t,e,r){const n=r*r;if(1===e.length)return t.distSqr(e[0])<n;for(let r=1;r<e.length;r++)if(ko(t,e[r-1],e[r])<n)return !0;return !1}function ko(t,e,r){const n=e.distSqr(r);if(0===n)return t.distSqr(e);const i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return t.distSqr(i<0?e:i>1?r:r.sub(e)._mult(i)._add(e))}function So(t,e){let r,n,i,s=!1;for(let a=0;a<t.length;a++){r=t[a];for(let t=0,a=r.length-1;t<r.length;a=t++)n=r[t],i=r[a],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(s=!s);}return s}function Io(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){const s=t[n],a=t[i];s.y>e.y!=a.y>e.y&&e.x<(a.x-s.x)*(e.y-s.y)/(a.y-s.y)+s.x&&(r=!r);}return r}function zo(t,e,r,n,s){for(const i of t)if(e<=i.x&&r<=i.y&&n>=i.x&&s>=i.y)return !0;const a=[new i(e,r),new i(e,s),new i(n,s),new i(n,r)];if(t.length>2)for(const e of a)if(Io(t,e))return !0;for(let e=0;e<t.length-1;e++)if(To(t[e],t[e+1],a))return !0;return !1}function To(t,e,r){const n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return !1;const s=D(t,e,r[0]);return s!==D(t,e,r[1])||s!==D(t,e,r[2])||s!==D(t,e,r[3])}function Mo(t,e,r){const n=e.paint.get(t).value;return "constant"===n.kind?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function Co(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Bo(t,e,r,n,s){if(!e[0]&&!e[1])return t;const a=i.convert(e)._mult(s);"viewport"===r&&a._rotate(-n);const o=[];for(let e=0;e<t.length;e++)o.push(t[e].sub(a));return o}function Eo(t,e,r,n){const s=i.convert(t)._mult(n);return "viewport"===e&&s._rotate(-r),s}pi("CircleBucket",mo,{omit:["layers"]});const Do=new Ss({"circle-sort-key":new ws($t.layout_circle["circle-sort-key"])});var Po={paint:new Ss({"circle-radius":new ws($t.paint_circle["circle-radius"]),"circle-color":new ws($t.paint_circle["circle-color"]),"circle-blur":new ws($t.paint_circle["circle-blur"]),"circle-opacity":new ws($t.paint_circle["circle-opacity"]),"circle-translate":new bs($t.paint_circle["circle-translate"]),"circle-translate-anchor":new bs($t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bs($t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bs($t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ws($t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ws($t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ws($t.paint_circle["circle-stroke-opacity"])}),layout:Do},Vo="undefined"!=typeof Float32Array?Float32Array:Array;function Fo(){var t=new Vo(9);return Vo!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Lo(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ro(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],y=e[12],m=e[13],g=e[14],x=e[15],v=r[0],b=r[1],w=r[2],_=r[3];return t[0]=v*n+b*o+w*h+_*y,t[1]=v*i+b*l+w*p+_*m,t[2]=v*s+b*u+w*d+_*g,t[3]=v*a+b*c+w*f+_*x,t[4]=(v=r[4])*n+(b=r[5])*o+(w=r[6])*h+(_=r[7])*y,t[5]=v*i+b*l+w*p+_*m,t[6]=v*s+b*u+w*d+_*g,t[7]=v*a+b*c+w*f+_*x,t[8]=(v=r[8])*n+(b=r[9])*o+(w=r[10])*h+(_=r[11])*y,t[9]=v*i+b*l+w*p+_*m,t[10]=v*s+b*u+w*d+_*g,t[11]=v*a+b*c+w*f+_*x,t[12]=(v=r[12])*n+(b=r[13])*o+(w=r[14])*h+(_=r[15])*y,t[13]=v*i+b*l+w*p+_*m,t[14]=v*s+b*u+w*d+_*g,t[15]=v*a+b*c+w*f+_*x,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var $o=Ro;function Uo(){var t=new Vo(3);return Vo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Oo(t){return Math.hypot(t[0],t[1],t[2])}function jo(t,e,r){var n=new Vo(3);return n[0]=t,n[1]=e,n[2]=r,n}function qo(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function No(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Zo(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function Go(t,e){var r=e[0],n=e[1],i=e[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Xo(t,e,r){var n=r[0],i=r[1],s=r[2],a=e[0],o=e[1],l=e[2],u=i*l-s*o,c=s*a-n*l,h=n*o-i*a,p=i*h-s*c,d=s*u-n*h,f=n*c-i*u,y=2*r[3];return c*=y,h*=y,d*=2,f*=2,t[0]=a+(u*=y)+(p*=2),t[1]=o+c+d,t[2]=l+h+f,t}var Ko,Yo=qo,Ho=No,Jo=Oo;function Wo(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*a,t}function Qo(){var t=new Vo(4);return Vo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function tl(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function el(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*o,t[1]=i*l+s*o,t[2]=s*l-i*o,t[3]=a*l-n*o,t}function rl(t,e){return t[0]===e[0]&&t[1]===e[1]}function nl(t,e,r,n,i,s,a,o,l){if(s&&t.queryGeometry.isAboveHorizon)return !1;s&&(l*=t.pixelToTileUnitsFactor);for(const u of e)for(const e of u){const u=e.add(o),c=i&&r.elevation?r.elevation.exaggeration()*i.getElevationAt(u.x,u.y,!0):0,h=s?u:il(u,c,n),p=s?t.tilespaceRays.map((t=>ol(t,c))):t.queryGeometry.screenGeometry,d=Wo([],[e.x,e.y,c,1],n);if(!a&&s?l*=d[3]/r.cameraToCenterDistance:a&&!s&&(l*=r.cameraToCenterDistance/d[3]),xo(p,h,l))return !0}return !1}function il(t,e,r){const n=Wo([],[t.x,t.y,e,1],r);return new i(n[0]/n[3],n[1]/n[3])}Uo(),Ko=new Vo(4),Vo!=Float32Array&&(Ko[0]=0,Ko[1]=0,Ko[2]=0,Ko[3]=0),Uo(),jo(1,0,0),jo(0,1,0),Qo(),Qo(),Fo(),function(){var t;t=new Vo(2),Vo!=Float32Array&&(t[0]=0,t[1]=0);}();const sl=jo(0,0,0),al=jo(0,0,1);function ol(t,e){const r=Uo();return sl[2]=e,t.intersectsPlane(sl,al,r),new i(r[0],r[1])}class ll extends mo{}function ul(t,{width:e,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(e*r*n);return t.width=e,t.height=r,t.data=i,t}function cl(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;const i=ul({},{width:e,height:r},n);hl(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data;}function hl(t,e,r,n,i,s){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const a=t.data,o=e.data;for(let l=0;l<i.height;l++){const u=((r.y+l)*t.width+r.x)*s,c=((n.y+l)*e.width+n.x)*s;for(let t=0;t<i.width*s;t++)o[c+t]=a[u+t];}return e}pi("HeatmapBucket",ll,{omit:["layers"]});class pl{constructor(t,e){ul(this,t,1,e);}resize(t){cl(this,t,1);}clone(){return new pl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,r,n,i){hl(t,e,r,n,i,1);}}class dl{constructor(t,e){ul(this,t,4,e);}resize(t){cl(this,t,4);}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t;}clone(){return new dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,r,n,i){hl(t,e,r,n,i,4);}}pi("AlphaImage",pl),pi("RGBAImage",dl);var fl={paint:new Ss({"heatmap-radius":new ws($t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ws($t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bs($t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ks($t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bs($t.paint_heatmap["heatmap-opacity"])})};function yl(t){const e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new dl({width:r,height:n}),s=(r,n,s)=>{e[t.evaluationKey]=s;const a=t.expression.evaluate(e);i.data[r+n+0]=Math.floor(255*a.r/a.a),i.data[r+n+1]=Math.floor(255*a.g/a.a),i.data[r+n+2]=Math.floor(255*a.b/a.a),i.data[r+n+3]=Math.floor(255*a.a);};if(t.clips)for(let e=0,i=0;e<n;++e,i+=4*r)for(let n=0,a=0;n<r;n++,a+=4){const o=n/(r-1),{start:l,end:u}=t.clips[e];s(i,a,l*(1-o)+u*o);}else for(let t=0,e=0;t<r;t++,e+=4)s(0,e,t/(r-1));return i}var ml={paint:new Ss({"hillshade-illumination-direction":new bs($t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bs($t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bs($t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bs($t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bs($t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bs($t.paint_hillshade["hillshade-accent-color"])})};const gl=Cs([{name:"a_pos",components:2,type:"Int16"}],4),{members:xl}=gl;var vl=wl,bl=wl;function wl(t,e,r){r=r||2;var n,i,s,a,o,l,u,c=e&&e.length,h=c?e[0]*r:t.length,p=_l(t,0,h,r,!0),d=[];if(!p||p.next===p.prev)return d;if(c&&(p=function(t,e,r,n){var i,s,a,o=[];for(i=0,s=e.length;i<s;i++)(a=_l(t,e[i]*n,i<s-1?e[i+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),o.push(Dl(a));for(o.sort(Ml),i=0;i<o.length;i++)r=Al(r=Cl(o[i],r),r.next);return r}(t,e,p,r)),t.length>80*r){n=s=t[0],i=a=t[1];for(var f=r;f<h;f+=r)(o=t[f])<n&&(n=o),(l=t[f+1])<i&&(i=l),o>s&&(s=o),l>a&&(a=l);u=0!==(u=Math.max(s-n,a-i))?1/u:0;}return kl(p,d,r,n,i,u),d}function _l(t,e,r,n,i){var s,a;if(i===Gl(t,e,r,n)>0)for(s=e;s<r;s+=n)a=ql(s,t[s],t[s+1],a);else for(s=r-n;s>=e;s-=n)a=ql(s,t[s],t[s+1],a);return a&&Ll(a,a.next)&&(Nl(a),a=a.next),a}function Al(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Ll(n,n.next)&&0!==Fl(n.prev,n,n.next))n=n.next;else {if(Nl(n),(n=e=n.prev)===n.next)break;r=!0;}}while(r||n!==e);return e}function kl(t,e,r,n,i,s,a){if(t){!a&&s&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=El(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,s,a,o,l,u=1;do{for(r=t,t=null,s=null,a=0;r;){for(a++,n=r,o=0,e=0;e<u&&(o++,n=n.nextZ);e++);for(l=u;o>0||l>0&&n;)0!==o&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,o--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n;}s.nextZ=null,u*=2;}while(a>1)}(i);}(t,n,i,s);for(var o,l,u=t;t.prev!==t.next;)if(o=t.prev,l=t.next,s?Il(t,n,i,s):Sl(t))e.push(o.i/r),e.push(t.i/r),e.push(l.i/r),Nl(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?kl(t=zl(Al(t),e,r),e,r,n,i,s,2):2===a&&Tl(t,e,r,n,i,s):kl(Al(t),e,r,n,i,s,1);break}}}function Sl(t){var e=t.prev,r=t,n=t.next;if(Fl(e,r,n)>=0)return !1;for(var i=t.next.next;i!==t.prev;){if(Pl(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Fl(i.prev,i,i.next)>=0)return !1;i=i.next;}return !0}function Il(t,e,r,n){var i=t.prev,s=t,a=t.next;if(Fl(i,s,a)>=0)return !1;for(var o=i.x>s.x?i.x>a.x?i.x:a.x:s.x>a.x?s.x:a.x,l=i.y>s.y?i.y>a.y?i.y:a.y:s.y>a.y?s.y:a.y,u=El(i.x<s.x?i.x<a.x?i.x:a.x:s.x<a.x?s.x:a.x,i.y<s.y?i.y<a.y?i.y:a.y:s.y<a.y?s.y:a.y,e,r,n),c=El(o,l,e,r,n),h=t.prevZ,p=t.nextZ;h&&h.z>=u&&p&&p.z<=c;){if(h!==t.prev&&h!==t.next&&Pl(i.x,i.y,s.x,s.y,a.x,a.y,h.x,h.y)&&Fl(h.prev,h,h.next)>=0)return !1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&Pl(i.x,i.y,s.x,s.y,a.x,a.y,p.x,p.y)&&Fl(p.prev,p,p.next)>=0)return !1;p=p.nextZ;}for(;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&Pl(i.x,i.y,s.x,s.y,a.x,a.y,h.x,h.y)&&Fl(h.prev,h,h.next)>=0)return !1;h=h.prevZ;}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&Pl(i.x,i.y,s.x,s.y,a.x,a.y,p.x,p.y)&&Fl(p.prev,p,p.next)>=0)return !1;p=p.nextZ;}return !0}function zl(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!Ll(i,s)&&Rl(i,n,n.next,s)&&Ol(i,s)&&Ol(s,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(s.i/r),Nl(n),Nl(n.next),n=t=s),n=n.next;}while(n!==t);return Al(n)}function Tl(t,e,r,n,i,s){var a=t;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&Vl(a,o)){var l=jl(a,o);return a=Al(a,a.next),l=Al(l,l.next),kl(a,e,r,n,i,s),void kl(l,e,r,n,i,s)}o=o.next;}a=a.next;}while(a!==t)}function Ml(t,e){return t.x-e.x}function Cl(t,e){var r=function(t,e){var r,n=e,i=t.x,s=t.y,a=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var o=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>a){if(a=o,o===i){if(s===n.y)return n;if(s===n.next.y)return n.next}r=n.x<n.next.x?n:n.next;}}n=n.next;}while(n!==e);if(!r)return null;if(i===a)return r;var l,u=r,c=r.x,h=r.y,p=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&Pl(s<h?i:a,s,c,h,s<h?a:i,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(i-n.x),Ol(n,t)&&(l<p||l===p&&(n.x>r.x||n.x===r.x&&Bl(r,n)))&&(r=n,p=l)),n=n.next;}while(n!==u);return r}(t,e);if(!r)return e;var n=jl(r,t),i=Al(r,r.next);return Al(n,n.next),e===r?i:e}function Bl(t,e){return Fl(t.prev,t,e.prev)<0&&Fl(e.next,t,t.next)<0}function El(t,e,r,n,i){return (t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Dl(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;}while(e!==t);return r}function Pl(t,e,r,n,i,s,a,o){return (i-a)*(e-o)-(t-a)*(s-o)>=0&&(t-a)*(n-o)-(r-a)*(e-o)>=0&&(r-a)*(s-o)-(i-a)*(n-o)>=0}function Vl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Rl(r,r.next,t,e))return !0;r=r.next;}while(r!==t);return !1}(t,e)&&(Ol(t,e)&&Ol(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;}while(r!==t);return n}(t,e)&&(Fl(t.prev,t,e.prev)||Fl(t,e.prev,e))||Ll(t,e)&&Fl(t.prev,t,t.next)>0&&Fl(e.prev,e,e.next)>0)}function Fl(t,e,r){return (e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Ll(t,e){return t.x===e.x&&t.y===e.y}function Rl(t,e,r,n){var i=Ul(Fl(t,e,r)),s=Ul(Fl(t,e,n)),a=Ul(Fl(r,n,t)),o=Ul(Fl(r,n,e));return i!==s&&a!==o||!(0!==i||!$l(t,r,e))||!(0!==s||!$l(t,n,e))||!(0!==a||!$l(r,t,n))||!(0!==o||!$l(r,e,n))}function $l(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ul(t){return t>0?1:t<0?-1:0}function Ol(t,e){return Fl(t.prev,t,t.next)<0?Fl(t,e,t.next)>=0&&Fl(t,t.prev,e)>=0:Fl(t,e,t.prev)<0||Fl(t,t.next,e)<0}function jl(t,e){var r=new Zl(t.i,t.x,t.y),n=new Zl(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function ql(t,e,r,n){var i=new Zl(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Nl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ);}function Zl(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}function Gl(t,e,r,n){for(var i=0,s=e,a=r-n;s<r;s+=n)i+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return i}function Xl(t,e,r,n,i){Kl(t,e,r||0,n||t.length-1,i||Hl);}function Kl(t,e,r,n,i){for(;n>r;){if(n-r>600){var s=n-r+1,a=e-r+1,o=Math.log(s),l=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*l*(s-l)/s)*(a-s/2<0?-1:1);Kl(t,e,Math.max(r,Math.floor(e-a*l/s+u)),Math.min(n,Math.floor(e+(s-a)*l/s+u)),i);}var c=t[e],h=r,p=n;for(Yl(t,r,e),i(t[n],c)>0&&Yl(t,r,n);h<p;){for(Yl(t,h,p),h++,p--;i(t[h],c)<0;)h++;for(;i(t[p],c)>0;)p--;}0===i(t[r],c)?Yl(t,r,p):Yl(t,++p,n),p<=e&&(r=p+1),e<=p&&(n=p-1);}}function Yl(t,e,r){var n=t[e];t[e]=t[r],t[r]=n;}function Hl(t,e){return t<e?-1:t>e?1:0}function Jl(t,e){const r=t.length;if(r<=1)return [t];const n=[];let i,s;for(let e=0;e<r;e++){const r=P(t[e]);0!==r&&(t[e].area=Math.abs(r),void 0===s&&(s=r<0),s===r<0?(i&&n.push(i),i=[t[e]]):i.push(t[e]));}if(i&&n.push(i),e>1)for(let t=0;t<n.length;t++)n[t].length<=e||(Xl(n[t],e,1,n[t].length-1,Wl),n[t]=n[t].slice(0,e));return n}function Wl(t,e){return e.area-t.area}function Ql(t,e,r){const n=r.patternDependencies;let i=!1;for(const r of e){const e=r.paint.get(`${t}-pattern`);e.isConstant()||(i=!0);const s=e.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0);}return i}function tu(t,e,r,n,i){const s=i.patternDependencies;for(const a of e){const e=a.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:n-1},r,{},i.availableImages),o=e.evaluate({zoom:n},r,{},i.availableImages),l=e.evaluate({zoom:n+1},r,{},i.availableImages);t=t&&t.name?t.name:t,o=o&&o.name?o.name:o,l=l&&l.name?l.name:l,s[t]=!0,s[o]=!0,s[l]=!0,r.patterns[a.id]={min:t,mid:o,max:l};}}return r}wl.deviation=function(t,e,r,n){var i=e&&e.length,s=Math.abs(Gl(t,0,i?e[0]*r:t.length,r));if(i)for(var a=0,o=e.length;a<o;a++)s-=Math.abs(Gl(t,e[a]*r,a<o-1?e[a+1]*r:t.length,r));var l=0;for(a=0;a<n.length;a+=3){var u=n[a]*r,c=n[a+1]*r,h=n[a+2]*r;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]));}return 0===s&&0===l?0:Math.abs((l-s)/s)},wl.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var a=0;a<e;a++)r.vertices.push(t[i][s][a]);i>0&&r.holes.push(n+=t[i-1].length);}return r},vl.default=bl;class eu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Es,this.indexArray=new Ns,this.indexArray2=new Hs,this.programConfigurations=new Fa(t.layers,t.zoom),this.segments=new Ga,this.segments2=new Ga,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id));}populate(t,e,r,n){this.hasPattern=Ql("fill",this.layers,e);const i=this.layers[0].layout.get("fill-sort-key"),s=[];for(const{feature:a,id:o,index:l,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,c=fo(a,t);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),c,r))continue;const h=i?i.evaluate(c,{},r,e.availableImages):void 0,p={id:o,properties:a.properties,type:a.type,sourceLayerIndex:u,index:l,geometry:t?c.geometry:po(a,r,n),patterns:{},sortKey:h};s.push(p);}i&&s.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of s){const{geometry:i,index:s,sourceLayerIndex:a}=n;if(this.hasPattern){const t=tu("fill",this.layers,n,this.zoom,e);this.patternFeatures.push(t);}else this.addFeature(n,i,s,r,{},e.availableImages);e.featureIndex.insert(t[s].feature,i,s,a,this.index);}}update(t,e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r,n);}addFeatures(t,e,r,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,r,n);}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return !this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xl),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0;}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy());}addFeature(t,e,r,n,i,s=[]){for(const t of Jl(e,500)){let e=0;for(const r of t)e+=r.length;const r=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=r.vertexLength,i=[],s=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&s.push(i.length/2);const r=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),n=r.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(n+e.length-1,n),i.push(e[0].x),i.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(n+t-1,n+t),i.push(e[t].x),i.push(e[t].y);r.vertexLength+=e.length,r.primitiveLength+=e.length;}const a=vl(i,s);for(let t=0;t<a.length;t+=3)this.indexArray.emplaceBack(n+a[t],n+a[t+1],n+a[t+2]);r.vertexLength+=e,r.primitiveLength+=a.length/3;}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,s,n);}}pi("FillBucket",eu,{omit:["layers","patternFeatures"]});const ru=new Ss({"fill-sort-key":new ws($t.layout_fill["fill-sort-key"])});var nu={paint:new Ss({"fill-antialias":new bs($t.paint_fill["fill-antialias"]),"fill-opacity":new ws($t.paint_fill["fill-opacity"]),"fill-color":new ws($t.paint_fill["fill-color"]),"fill-outline-color":new ws($t.paint_fill["fill-outline-color"]),"fill-translate":new bs($t.paint_fill["fill-translate"]),"fill-translate-anchor":new bs($t.paint_fill["fill-translate-anchor"]),"fill-pattern":new _s($t.paint_fill["fill-pattern"])}),layout:ru};const iu=Cs([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),su=Cs([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:au}=iu;var ou=lu;function lu(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(uu,this,e);}function uu(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i;}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos);}function cu(t){for(var e,r,n=0,i=0,s=t.length,a=s-1;i<s;a=i++)n+=((r=t[a]).x-(e=t[i]).x)*(e.y+r.y);return n}lu.types=["Unknown","Point","LineString","Polygon"],lu.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,s=0,a=0,o=0,l=[];t.pos<r;){if(s<=0){var u=t.readVarint();n=7&u,s=u>>3;}if(s--,1===n||2===n)a+=t.readSVarint(),o+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new i(a,o));else {if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone());}}return e&&l.push(e),l},lu.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,s=0,a=1/0,o=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=7&c,n=c>>3;}if(n--,1===r||2===r)(i+=t.readSVarint())<a&&(a=i),i>o&&(o=i),(s+=t.readSVarint())<l&&(l=s),s>u&&(u=s);else if(7!==r)throw new Error("unknown command "+r)}return [a,l,o,u]},lu.prototype.toGeoJSON=function(t,e,r){var n,i,s=this.extent*Math.pow(2,r),a=this.extent*t,o=this.extent*e,l=this.loadGeometry(),u=lu.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e];t[e]=[360*(r.x+a)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+o)/s)*Math.PI/180))-90];}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];c(l=h);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return [t];for(var r,n,i=[],s=0;s<e;s++){var a=cu(t[s]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[s]]):r.push(t[s]));}return r&&i.push(r),i}(l),n=0;n<l.length;n++)for(i=0;i<l[n].length;i++)c(l[n][i]);}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return "id"in this&&(p.id=this.id),p};var hu=pu;function pu(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(du,this,e),this.length=this._features.length;}function du(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null;}return e}(r));}function fu(t,e,r){if(3===t){var n=new hu(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n);}}pu.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ou(this._pbf,e,this.extent,this._keys,this._values)};var yu={VectorTile:function(t,e){this.layers=t.readFields(fu,{},e);},VectorTileFeature:ou,VectorTileLayer:hu};const mu=yu.VectorTileFeature.types,gu=Math.pow(2,13);function xu(t,e,r,n,i,s,a,o){t.emplaceBack((e<<1)+a,(r<<1)+s,(Math.floor(n*gu)<<1)+i,Math.round(o));}class vu{constructor(){this.acc=new i(0,0),this.polyCount=[];}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new i(t.x,t.y),this.max=new i(t.x,t.y));}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);let r=!!this.borders;const n=this.min,i=this.max;t.x<n.x?(n.x=t.x,r=!0):t.x>i.x&&(i.x=t.x,r=!0),t.y<n.y?(n.y=t.y,r=!0):t.y>i.y&&(i.y=t.y,r=!0),((0===t.x||t.x===Xa)&&t.x===e.x)!=((0===t.y||t.y===Xa)&&t.y===e.y)&&this.processBorderOverlap(t,e),r&&this.checkBorderIntersection(t,e);}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,nr(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Xa!=t.x>Xa&&this.addBorderIntersection(1,nr(e.y,t.y,(Xa-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,nr(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Xa!=t.y>Xa&&this.addBorderIntersection(3,nr(e.x,t.x,(Xa-e.y)/(t.y-e.y)));}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[t];e<r[0]&&(r[0]=e),e>r[1]&&(r[1]=e);}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const r=0===t.x?0:1;this.addBorderIntersection(r,e.y),this.addBorderIntersection(r,t.y);}else {const r=0===t.y?2:3;this.addBorderIntersection(r,e.x),this.addBorderIntersection(r,t.x);}}centroid(){const t=this.polyCount.reduce(((t,e)=>t+e.edges),0);return 0!==t?this.acc.div(t)._round():new i(0,0)}span(){return new i(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((t,e)=>t+ +(e[0]!==Number.MAX_VALUE)),0)}}class bu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ds,this.centroidVertexArray=new ha,this.indexArray=new Ns,this.programConfigurations=new Fa(t.layers,t.zoom),this.segments=new Ga,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.enableTerrain=t.enableTerrain;}populate(t,e,r,n){this.features=[],this.hasPattern=Ql("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Xa/(1<<t.z)}(r);for(const{feature:i,id:s,index:a,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,l=fo(i,t);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),l,r))continue;const u={id:s,sourceLayerIndex:o,index:a,geometry:t?l.geometry:po(i,r,n),properties:i.properties,type:i.type,patterns:{}},c=this.layoutVertexArray.length;this.hasPattern?this.features.push(tu("fill-extrusion",this.layers,u,this.zoom,e)):this.addFeature(u,u.geometry,a,r,{},e.availableImages),e.featureIndex.insert(i,u.geometry,a,o,this.index,c);}this.sortBorders();}addFeatures(t,e,r,n){for(const t of this.features){const{geometry:i}=t;this.addFeature(t,i,t.index,e,r,n);}this.sortBorders();}update(t,e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r,n);}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return !this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,au),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0;}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,su.members,!0),this.needsCentroidUpdate=!1);}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy());}addFeature(t,e,r,n,i,s){const a=this.enableTerrain?new vu:null;for(const r of Jl(e,500)){let e=0,n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===r.length||(o=r[0]).every((t=>t.x<=0))||o.every((t=>t.x>=Xa))||o.every((t=>t.y<=0))||o.every((t=>t.y>=Xa)))continue;for(let t=0;t<r.length;t++){const i=r[t];if(0===i.length)continue;e+=i.length;let s=0;a&&a.startRing(i[0]);for(let t=0;t<i.length;t++){const e=i[t];if(t>=1){const r=i[t-1];if(!wu(e,r)){a&&a.append(e,r),n.vertexLength+4>Ga.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=e.sub(r)._perp(),i=t.x/(Math.abs(t.x)+Math.abs(t.y)),o=t.y>0?1:0,l=r.dist(e);s+l>32768&&(s=0),xu(this.layoutVertexArray,e.x,e.y,i,o,0,0,s),xu(this.layoutVertexArray,e.x,e.y,i,o,0,1,s),s+=l,xu(this.layoutVertexArray,r.x,r.y,i,o,0,0,s),xu(this.layoutVertexArray,r.x,r.y,i,o,0,1,s);const u=n.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),n.vertexLength+=4,n.primitiveLength+=2;}}}}if(n.vertexLength+e>Ga.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==mu[t.type])continue;const i=[],s=[],l=n.vertexLength;for(let t=0;t<r.length;t++){const e=r[t];if(0!==e.length){e!==r[0]&&s.push(i.length/2);for(let t=0;t<e.length;t++){const r=e[t];xu(this.layoutVertexArray,r.x,r.y,0,0,1,1,0),i.push(r.x),i.push(r.y),a&&a.currentPolyCount.top++;}}}const u=vl(i,s);for(let t=0;t<u.length;t+=3)this.indexArray.emplaceBack(l+u[t],l+u[t+2],l+u[t+1]);n.primitiveLength+=u.length/3,n.vertexLength+=e;}var o;if(a&&a.polyCount.length>0){if(a.borders){a.vertexArrayOffset=this.centroidVertexArray.length;const t=a.borders,e=this.featuresOnBorder.push(a)-1;for(let r=0;r<4;r++)t[r][0]!==Number.MAX_VALUE&&this.borders[r].push(e);}this.encodeCentroid(a.borders?void 0:a.centroid(),a);}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,s,n);}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort(((e,r)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[r].borders[t][0]));}encodeCentroid(t,e,r=!0){let n,i;if(t)if(0!==t.y){const r=e.span()._mult(this.tileToMeter);n=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(r.x/10)),i=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(r.y/10));}else n=Math.ceil(7*(t.x+450)),i=0;else n=0,i=+r;let s=r?this.centroidVertexArray.length:e.vertexArrayOffset;for(const t of e.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*t.edges+t.top);for(let e=0;e<2*t.edges;e++)this.centroidVertexArray.emplace(s++,0,i),this.centroidVertexArray.emplace(s++,n,i);for(let e=0;e<t.top;e++)this.centroidVertexArray.emplace(s++,n,i);}}}function wu(t,e){return t.x===e.x&&(t.x<0||t.x>Xa)||t.y===e.y&&(t.y<0||t.y>Xa)}pi("FillExtrusionBucket",bu,{omit:["layers","features"]}),pi("PartMetadata",vu);var _u={paint:new Ss({"fill-extrusion-opacity":new bs($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ws($t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bs($t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bs($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _s($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ws($t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ws($t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bs($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Au(t,e){return t.x*e.x+t.y*e.y}function ku(t,e){if(1===t.length){let r=0;const n=e[r++];let i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){const s=e[r],a=t[0],o=i.sub(n),l=s.sub(n),u=a.sub(n),c=Au(o,o),h=Au(o,l),p=Au(l,l),d=Au(u,o),f=Au(u,l),y=c*p-h*h,m=(p*d-h*f)/y,g=(c*f-h*d)/y,x=n.z*(1-m-g)+i.z*m+s.z*g;if(isFinite(x))return x}return 1/0}{let t=1/0;for(const r of e)t=Math.min(t,r.z);return t}}function Su(t){const e=new i(t[0],t[1]);return e.z=t[2],e}function Iu(t,e,r,n,i,s,a,o){const l=a*i.getElevationAt(t,e,!0,!0),u=0!==s[0],c=u?0===s[1]?a*(s[0]/7-450):a*function(t,e,r){const n=Math.floor(e[0]/8),i=Math.floor(e[1]/8),s=10*(e[0]-8*n),a=10*(e[1]-8*i),o=t.getElevationAt(n,i,!0,!0),l=t.getMeterToDEM(r),u=Math.floor(.5*(s*l-1)),c=Math.floor(.5*(a*l-1)),h=t.tileCoordToPixel(n,i),p=2*u+1,d=2*c+1,f=function(t,e,r,n,i){return [t.getElevationAtPixel(e,r,!0),t.getElevationAtPixel(e+i,r,!0),t.getElevationAtPixel(e,r+i,!0),t.getElevationAtPixel(e+n,r+i,!0)]}(t,h.x-u,h.y-c,p,d),y=Math.abs(f[0]-f[1]),m=Math.abs(f[2]-f[3]),g=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),x=Math.min(.25,.5*l*(y+m)/p),v=Math.min(.25,.5*l*g/d);return o+Math.max(x*s,v*a)}(i,s,o):l;return {base:l+(0===r)?-1:r,top:u?Math.max(c+n,l+r+2):l+n}}const zu=Cs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Tu}=zu,Mu=Cs([{name:"a_packed",components:3,type:"Float32"}]),{members:Cu}=Mu,Bu=yu.VectorTileFeature.types,Eu=Math.cos(Math.PI/180*37.5);class Du{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={};})),this.layoutVertexArray=new Ps,this.layoutVertexArray2=new Vs,this.indexArray=new Ns,this.programConfigurations=new Fa(t.layers,t.zoom),this.segments=new Ga,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id));}populate(t,e,r,n){this.hasPattern=Ql("line",this.layers,e);const i=this.layers[0].layout.get("line-sort-key"),s=[];for(const{feature:e,id:a,index:o,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,u=fo(e,t);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),u,r))continue;const c=i?i.evaluate(u,{},r):void 0,h={id:a,properties:e.properties,type:e.type,sourceLayerIndex:l,index:o,geometry:t?u.geometry:po(e,r,n),patterns:{},sortKey:c};s.push(h);}i&&s.sort(((t,e)=>t.sortKey-e.sortKey));const{lineAtlas:a,featureIndex:o}=e,l=this.addConstantDashes(a);for(const n of s){const{geometry:i,index:s,sourceLayerIndex:u}=n;if(l&&this.addFeatureDashes(n,a),this.hasPattern){const t=tu("line",this.layers,n,this.zoom,e);this.patternFeatures.push(t);}else this.addFeature(n,i,s,r,a.positions,e.availableImages);o.insert(t[s].feature,i,s,u,this.index);}}addConstantDashes(t){let e=!1;for(const r of this.layers){const n=r.paint.get("line-dasharray").value,i=r.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==i.kind)e=!0;else {const e=i.value,r=n.value;if(!r)continue;t.addDash(r.from,e),t.addDash(r.to,e),r.other&&t.addDash(r.other,e);}}return e}addFeatureDashes(t,e){const r=this.zoom;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,s=n.layout.get("line-cap").value;if("constant"===i.kind&&"constant"===s.kind)continue;let a,o,l,u,c,h;if("constant"===i.kind){const t=i.value;if(!t)continue;a=t.other||t.to,o=t.to,l=t.from;}else a=i.evaluate({zoom:r-1},t),o=i.evaluate({zoom:r},t),l=i.evaluate({zoom:r+1},t);"constant"===s.kind?u=c=h=s.value:(u=s.evaluate({zoom:r-1},t),c=s.evaluate({zoom:r},t),h=s.evaluate({zoom:r+1},t)),e.addDash(a,u),e.addDash(o,c),e.addDash(l,h);const p=e.getKey(a,u),d=e.getKey(o,c),f=e.getKey(l,h);t.patterns[n.id]={min:p,mid:d,max:f};}}update(t,e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r,n);}addFeatures(t,e,r,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,r,n);}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return !this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Cu)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tu),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0;}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy());}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return {start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,r,n,i,s){const a=this.layers[0].layout,o=a.get("line-join").evaluate(t,{}),l=a.get("line-cap").evaluate(t,{}),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const r of e)this.addLine(r,t,o,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,s,n);}addLine(t,e,r,n,i,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance);}const a="Polygon"===Bu[e.type];let o=t.length;for(;o>=2&&t[o-1].equals(t[o-2]);)o--;let l=0;for(;l<o-1&&t[l].equals(t[l+1]);)l++;if(o<(a?3:2))return;"bevel"===r&&(i=1.05);const u=this.overscaling<=16?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*o,this.layoutVertexArray,this.indexArray);let h,p,d,f,y;this.e1=this.e2=-1,a&&(h=t[o-2],y=t[l].sub(h)._unit()._perp());for(let e=l;e<o;e++){if(d=e===o-1?a?t[l+1]:void 0:t[e+1],d&&t[e].equals(d))continue;y&&(f=y),h&&(p=h),h=t[e],y=d?d.sub(h)._unit()._perp():f,f=f||y;let m=f.add(y);0===m.x&&0===m.y||m._unit();const g=f.x*y.x+f.y*y.y,x=m.x*y.x+m.y*y.y,v=0!==x?1/x:1/0,b=2*Math.sqrt(2-2*x),w=x<Eu&&p&&d,_=f.x*y.y-f.y*y.x>0;if(w&&e>l){const t=h.dist(p);if(t>2*u){const e=h.sub(h.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,f,0,0,c),p=e;}}const A=p&&d;let k=A?r:a?"butt":n;if(A&&"round"===k&&(v<s?k="miter":v<=2&&(k="fakeround")),"miter"===k&&v>i&&(k="bevel"),"bevel"===k&&(v>2&&(k="flipbevel"),v<i&&(k="miter")),p&&this.updateDistance(p,h),"miter"===k)m._mult(v),this.addCurrentVertex(h,m,0,0,c);else if("flipbevel"===k){if(v>100)m=y.mult(-1);else {const t=v*f.add(y).mag()/f.sub(y).mag();m._perp()._mult(t*(_?-1:1));}this.addCurrentVertex(h,m,0,0,c),this.addCurrentVertex(h,m.mult(-1),0,0,c);}else if("bevel"===k||"fakeround"===k){const t=-Math.sqrt(v*v-1),e=_?t:0,r=_?0:t;if(p&&this.addCurrentVertex(h,f,e,r,c),"fakeround"===k){const t=Math.round(180*b/Math.PI/20);for(let e=1;e<t;e++){let r=e/t;if(.5!==r){const t=r-.5;r+=r*t*(r-1)*((1.0904+g*(g*(3.55645-1.43519*g)-3.2452))*t*t+(.848013+g*(.215638*g-1.06021)));}const n=y.sub(f)._mult(r)._add(f)._unit()._mult(_?-1:1);this.addHalfVertex(h,n.x,n.y,!1,_,0,c);}}d&&this.addCurrentVertex(h,y,-e,-r,c);}else if("butt"===k)this.addCurrentVertex(h,m,0,0,c);else if("square"===k){const t=p?1:-1;p||this.addCurrentVertex(h,m,t,t,c),this.addCurrentVertex(h,m,0,0,c),p&&this.addCurrentVertex(h,m,t,t,c);}else "round"===k&&(p&&(this.addCurrentVertex(h,f,0,0,c),this.addCurrentVertex(h,f,1,1,c,!0)),d&&(this.addCurrentVertex(h,y,-1,-1,c,!0),this.addCurrentVertex(h,y,0,0,c)));if(w&&e<o-1){const t=h.dist(d);if(t>2*u){const e=h.add(d.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,y,0,0,c),h=e;}}}}addCurrentVertex(t,e,r,n,i,s=!1){const a=e.y*n-e.x,o=-e.y-e.x*n;this.addHalfVertex(t,e.x+e.y*r,e.y-e.x*r,s,!1,r,i),this.addHalfVertex(t,a,o,s,!0,-n,i);}addHalfVertex({x:t,y:e},r,n,i,s,a,o){this.layoutVertexArray.emplaceBack((t<<1)+(i?1:0),(e<<1)+(s?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const l=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),o.primitiveLength++),s?this.e2=l:this.e1=l;}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance;}else this.lineSoFar=this.distance;}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance();}}pi("LineBucket",Du,{omit:["layers","patternFeatures"]});const Pu=new Ss({"line-cap":new ws($t.layout_line["line-cap"]),"line-join":new ws($t.layout_line["line-join"]),"line-miter-limit":new bs($t.layout_line["line-miter-limit"]),"line-round-limit":new bs($t.layout_line["line-round-limit"]),"line-sort-key":new ws($t.layout_line["line-sort-key"])});var Vu={paint:new Ss({"line-opacity":new ws($t.paint_line["line-opacity"]),"line-color":new ws($t.paint_line["line-color"]),"line-translate":new bs($t.paint_line["line-translate"]),"line-translate-anchor":new bs($t.paint_line["line-translate-anchor"]),"line-width":new ws($t.paint_line["line-width"]),"line-gap-width":new ws($t.paint_line["line-gap-width"]),"line-offset":new ws($t.paint_line["line-offset"]),"line-blur":new ws($t.paint_line["line-blur"]),"line-dasharray":new _s($t.paint_line["line-dasharray"]),"line-pattern":new _s($t.paint_line["line-pattern"]),"line-gradient":new ks($t.paint_line["line-gradient"])}),layout:Pu};const Fu=new class extends ws{possiblyEvaluate(t,e){return e=new hs(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,r,n){return e=b({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,r,n)}}(Vu.paint.properties["line-width"].specification);function Lu(t,e){return e>0?e+2*t:t}Fu.useIntegerZoom=!0;const Ru=Cs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),$u=Cs([{name:"a_projected_pos",components:3,type:"Float32"}],4);Cs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Uu=Cs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ou=Cs([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Cs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ju=Cs([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qu=Cs([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Cs([{name:"triangle",components:3,type:"Uint16"}]),Cs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Cs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Cs([{type:"Float32",name:"offsetX"}]),Cs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Nu=24;const Zu=128;function Gu(t,e){const{expression:r}=e;if("constant"===r.kind)return {kind:"constant",layoutSize:r.evaluate(new hs(t+1))};if("source"===r.kind)return {kind:"source"};{const{zoomStops:e,interpolationType:n}=r;let i=0;for(;i<e.length&&e[i]<=t;)i++;i=Math.max(0,i-1);let s=i;for(;s<e.length&&e[s]<t+1;)s++;s=Math.min(e.length-1,s);const a=e[i],o=e[s];return "composite"===r.kind?{kind:"composite",minZoom:a,maxZoom:o,interpolationType:n}:{kind:"camera",minZoom:a,maxZoom:o,minSize:r.evaluate(new hs(a)),maxSize:r.evaluate(new hs(o)),interpolationType:n}}}function Xu(t,{uSize:e,uSizeT:r},{lowerSize:n,upperSize:i}){return "source"===t.kind?n/Zu:"composite"===t.kind?nr(n/Zu,i/Zu,r):e}function Ku(t,e){let r=0,n=0;if("constant"===t.kind)n=t.layoutSize;else if("source"!==t.kind){const{interpolationType:i,minZoom:s,maxZoom:a}=t,o=i?m(_r.interpolationFactor(i,e,s,a),0,1):0;"camera"===t.kind?n=nr(t.minSize,t.maxSize,o):r=o;}return {uSizeT:r,uSize:n}}var Yu=Object.freeze({__proto__:null,getSizeData:Gu,evaluateSizeForFeature:Xu,evaluateSizeForZoom:Ku,SIZE_PACK_FACTOR:Zu});function Hu(t,e,r){return t.sections.forEach((t=>{t.text=function(t,e,r){const n=e.layout.get("text-transform").evaluate(r,{});return "uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),cs.applyArabicShaping&&(t=cs.applyArabicShaping(t)),t}(t.text,e,r);})),t}const Ju={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function Wu(t){return "︶"===t||"﹈"===t||"︸"===t||"﹄"===t||"﹂"===t||"︾"===t||"︼"===t||"︺"===t||"︘"===t||"﹀"===t||"︐"===t||"︓"===t||"︔"===t||"｀"===t||"￣"===t||"︑"===t||"︒"===t}function Qu(t){return "︵"===t||"﹇"===t||"︷"===t||"﹃"===t||"﹁"===t||"︽"===t||"︻"===t||"︹"===t||"︗"===t||"︿"===t}var tc=function(t,e,r,n,i){var s,a,o=8*i-n-1,l=(1<<o)-1,u=l>>1,c=-7,h=r?i-1:0,p=r?-1:1,d=t[e+h];for(h+=p,s=d&(1<<-c)-1,d>>=-c,c+=o;c>0;s=256*s+t[e+h],h+=p,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===s)s=1-u;else {if(s===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),s-=u;}return (d?-1:1)*a*Math.pow(2,s-n)},ec=function(t,e,r,n,i,s){var a,o,l,u=8*s-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,f=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(o=0,a=c):a+h>=1?(o=(e*l-1)*Math.pow(2,i),a+=h):(o=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&o,d+=f,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;t[r+d]=255&a,d+=f,a/=256,u-=8);t[r+d-f]|=128*y;},rc=nc;function nc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length;}nc.Varint=0,nc.Fixed64=1,nc.Bytes=2,nc.Fixed32=5;var ic=4294967296,sc=1/ic,ac="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function oc(t){return t.type===nc.Bytes?t.readVarint()+t.pos:t.pos+1}function lc(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function uc(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i];}function cc(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r]);}function hc(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r]);}function pc(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r]);}function dc(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r]);}function fc(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r]);}function yc(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r]);}function mc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r]);}function gc(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r]);}function xc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r]);}function vc(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function bc(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24;}function wc(t,e){return (t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function _c(t,e,r){e.glyphs=[],1===t&&r.readMessage(Ac,e);}function Ac(t,e,r){if(3===t){const{id:t,bitmap:n,width:i,height:s,left:a,top:o,advance:l}=r.readMessage(kc,{});e.glyphs.push({id:t,bitmap:new pl({width:i+6,height:s+6},n),metrics:{width:i,height:s,left:a,top:o,advance:l}});}else 4===t?e.ascender=r.readSVarint():5===t&&(e.descender=r.readSVarint());}function kc(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint());}function Sc(t){let e=0,r=0;for(const n of t)e+=n.w*n.h,r=Math.max(r,n.w);t.sort(((t,e)=>e.h-t.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let i=0,s=0;for(const e of t)for(let t=n.length-1;t>=0;t--){const r=n[t];if(!(e.w>r.w||e.h>r.h)){if(e.x=r.x,e.y=r.y,s=Math.max(s,e.y+e.h),i=Math.max(i,e.x+e.w),e.w===r.w&&e.h===r.h){const e=n.pop();t<n.length&&(n[t]=e);}else e.h===r.h?(r.x+=e.w,r.w-=e.w):e.w===r.w?(r.y+=e.h,r.h-=e.h):(n.push({x:r.x+e.w,y:r.y,w:r.w-e.w,h:e.h}),r.y+=e.h,r.h-=e.h);break}}return {w:i,h:s,fill:e/(i*s)||0}}nc.prototype={destroy:function(){this.buf=null;},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,s=this.pos;this.type=7&n,t(i,e,this),this.pos===s&&this.skip(n);}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=vc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=wc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=vc(this.buf,this.pos)+vc(this.buf,this.pos+4)*ic;return this.pos+=8,t},readSFixed64:function(){var t=vc(this.buf,this.pos)+wc(this.buf,this.pos+4)*ic;return this.pos+=8,t},readFloat:function(){var t=tc(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=tc(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,s=r.buf;if(n=(112&(i=s[r.pos++]))>>4,i<128)return lc(t,n,e);if(n|=(127&(i=s[r.pos++]))<<3,i<128)return lc(t,n,e);if(n|=(127&(i=s[r.pos++]))<<10,i<128)return lc(t,n,e);if(n|=(127&(i=s[r.pos++]))<<17,i<128)return lc(t,n,e);if(n|=(127&(i=s[r.pos++]))<<24,i<128)return lc(t,n,e);if(n|=(1&(i=s[r.pos++]))<<31,i<128)return lc(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ac?function(t,e,r){return ac.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){for(var n="",i=e;i<r;){var s,a,o,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(s=t[i+1]))&&(u=(31&l)<<6|63&s)<=127&&(u=null):3===c?(a=t[i+2],128==(192&(s=t[i+1]))&&128==(192&a)&&((u=(15&l)<<12|(63&s)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=t[i+2],o=t[i+3],128==(192&(s=t[i+1]))&&128==(192&a)&&128==(192&o)&&((u=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&o)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c;}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==nc.Bytes)return t.push(this.readVarint(e));var r=oc(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==nc.Bytes)return t.push(this.readSVarint());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==nc.Bytes)return t.push(this.readBoolean());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==nc.Bytes)return t.push(this.readFloat());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==nc.Bytes)return t.push(this.readDouble());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==nc.Bytes)return t.push(this.readFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==nc.Bytes)return t.push(this.readSFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==nc.Bytes)return t.push(this.readFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==nc.Bytes)return t.push(this.readSFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===nc.Varint)for(;this.buf[this.pos++]>127;);else if(e===nc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===nc.Fixed32)this.pos+=4;else {if(e!==nc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8;}},writeTag:function(t,e){this.writeVarint(t<<3|e);},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e;}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),bc(this.buf,t,this.pos),this.pos+=4;},writeSFixed32:function(t){this.realloc(4),bc(this.buf,t,this.pos),this.pos+=4;},writeFixed64:function(t){this.realloc(8),bc(this.buf,-1&t,this.pos),bc(this.buf,Math.floor(t*sc),this.pos+4),this.pos+=8;},writeSFixed64:function(t){this.realloc(8),bc(this.buf,-1&t,this.pos),bc(this.buf,Math.floor(t*sc),this.pos+4),this.pos+=8;},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,r.buf[r.pos]=127&(t>>>=7);}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))));}(n,e);}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))));},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t);},writeBoolean:function(t){this.writeVarint(Boolean(t));},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){n>56319||s+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null;}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128);}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&uc(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r;},writeFloat:function(t){this.realloc(4),ec(this.buf,t,this.pos,!0,23,4),this.pos+=4;},writeDouble:function(t){this.realloc(8),ec(this.buf,t,this.pos,!0,52,8),this.pos+=8;},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r];},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&uc(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n;},writeMessage:function(t,e,r){this.writeTag(t,nc.Bytes),this.writeRawMessage(e,r);},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,cc,e);},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,hc,e);},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,fc,e);},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,pc,e);},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,dc,e);},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,yc,e);},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,mc,e);},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,gc,e);},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,xc,e);},writeBytesField:function(t,e){this.writeTag(t,nc.Bytes),this.writeBytes(e);},writeFixed32Field:function(t,e){this.writeTag(t,nc.Fixed32),this.writeFixed32(e);},writeSFixed32Field:function(t,e){this.writeTag(t,nc.Fixed32),this.writeSFixed32(e);},writeFixed64Field:function(t,e){this.writeTag(t,nc.Fixed64),this.writeFixed64(e);},writeSFixed64Field:function(t,e){this.writeTag(t,nc.Fixed64),this.writeSFixed64(e);},writeVarintField:function(t,e){this.writeTag(t,nc.Varint),this.writeVarint(e);},writeSVarintField:function(t,e){this.writeTag(t,nc.Varint),this.writeSVarint(e);},writeStringField:function(t,e){this.writeTag(t,nc.Bytes),this.writeString(e);},writeFloatField:function(t,e){this.writeTag(t,nc.Fixed32),this.writeFloat(e);},writeDoubleField:function(t,e){this.writeTag(t,nc.Fixed64),this.writeDouble(e);},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e));}};class Ic{constructor(t,{pixelRatio:e,version:r,stretchX:n,stretchY:i,content:s}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=n,this.stretchY=i,this.content=s,this.version=r;}get tl(){return [this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return [this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return [(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class zc{constructor(t,e){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(t,r,i),this.addImages(e,n,i);const{w:s,h:a}=Sc(i),o=new dl({width:s||1,height:a||1});for(const e in t){const n=t[e],i=r[e].paddedRect;dl.copy(n.data,o,{x:0,y:0},{x:i.x+1,y:i.y+1},n.data);}for(const t in e){const r=e[t],i=n[t].paddedRect,s=i.x+1,a=i.y+1,l=r.data.width,u=r.data.height;dl.copy(r.data,o,{x:0,y:0},{x:s,y:a},r.data),dl.copy(r.data,o,{x:0,y:u-1},{x:s,y:a-1},{width:l,height:1}),dl.copy(r.data,o,{x:0,y:0},{x:s,y:a+u},{width:l,height:1}),dl.copy(r.data,o,{x:l-1,y:0},{x:s-1,y:a},{width:1,height:u}),dl.copy(r.data,o,{x:0,y:0},{x:s+l,y:a},{width:1,height:u});}this.image=o,this.iconPositions=r,this.patternPositions=n;}addImages(t,e,r){for(const n in t){const i=t[n],s={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(s),e[n]=new Ic(s,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n);}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e);}patchUpdatedImage(t,e,r){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[n,i]=t.tl;r.update(e.data,void 0,{x:n,y:i});}}pi("ImagePosition",Ic),pi("ImageAtlas",zc);const Tc={horizontal:1,vertical:2,horizontalOnly:3};class Mc{constructor(){this.scale=1,this.fontStack="",this.imageName=null;}static forText(t,e){const r=new Mc;return r.scale=t||1,r.fontStack=e,r}static forImage(t){const e=new Mc;return e.imageName=t,e}}class Cc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null;}static fromFeature(t,e){const r=new Cc;for(let n=0;n<t.sections.length;n++){const i=t.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,e);}return r}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n+1)||null,s=t.charCodeAt(n-1)||null;r+=!e&&(i&&Yi(i)&&!Ju[t[n+1]]||s&&Yi(s)&&!Ju[t[n-1]])||!Ju[t[n]]?t[n]:Ju[t[n]];}return r}(this.text,t);}trim(){let t=0;for(let e=0;e<this.text.length&&Ec[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let r=this.text.length-1;r>=0&&r>=t&&Ec[this.text.charCodeAt(r)];r--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e);}substring(t,e){const r=new Cc;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Mc.forText(t.scale,t.fontStack||e));const r=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(r);}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void E("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(Mc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):E("Reached maximum number of images 6401");}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Bc(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y){const m=Cc.fromFeature(t,i);let g;h===Tc.vertical&&m.verticalizePunctuation(p);const{processBidirectionalText:x,processStyledBidirectionalText:v}=cs;if(x&&1===m.sections.length){g=[];const t=x(m.toString(),$c(m,u,s,e,n,d,f));for(const e of t){const t=new Cc;t.text=e,t.sections=m.sections;for(let r=0;r<e.length;r++)t.sectionIndex.push(0);g.push(t);}}else if(v){g=[];const t=v(m.text,m.sectionIndex,$c(m,u,s,e,n,d,f));for(const e of t){const t=new Cc;t.text=e[0],t.sectionIndex=e[1],t.sections=m.sections,g.push(t);}}else g=function(t,e){const r=[],n=t.text;let i=0;for(const n of e)r.push(t.substring(i,n)),i=n;return i<n.length&&r.push(t.substring(i,n.length)),r}(m,$c(m,u,s,e,n,d,f));const b=[],w={positionedLines:b,text:m.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,r,n,i,s,a,o,l,u,c,h){let p=0,d=0,f=0;const y="right"===o?1:"left"===o?0:.5;let m=!1;for(const t of i){const r=t.getSections();for(const t of r){if(t.imageName)continue;const r=e[t.fontStack];if(r&&(m=void 0!==r.ascender&&void 0!==r.descender,!m))break}if(!m)break}let g=0;for(const a of i){a.trim();const i=a.getMaxScale(),o=(i-1)*Nu,v={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=v;const b=v.positionedGlyphs;let w=0;if(!a.length()){d+=s,++g;continue}let _=0,A=0;for(let s=0;s<a.length();s++){const o=a.getSection(s),f=a.getSectionIndex(s),y=a.getCharCode(s);let g=o.scale,v=null,k=null,S=null,I=Nu,z=0;const T=!(l===Tc.horizontal||!c&&!Ki(y)||c&&(Ec[y]||(x=y,xi(x)||vi(x)||bi(x)||$i(x)||qi(x))));if(o.imageName){const e=n[o.imageName];if(!e)continue;S=o.imageName,t.iconsInText=t.iconsInText||!0,k=e.paddedRect;const r=e.displaySize;g=g*Nu/h,v={width:r[0],height:r[1],left:1,top:-3,advance:T?r[1]:r[0],localGlyph:!1},z=m?-v.height*g:i*Nu-17-r[1]*g,I=v.advance;const s=(T?r[0]:r[1])*g-Nu*i;s>0&&s>w&&(w=s);}else {const t=r[o.fontStack];if(!t)continue;t[y]&&(k=t[y]);const n=e[o.fontStack];if(!n)continue;const s=n.glyphs[y];if(!s)continue;if(v=s.metrics,I=8203!==y?Nu:0,m){const t=void 0!==n.ascender?Math.abs(n.ascender):0,e=void 0!==n.descender?Math.abs(n.descender):0,r=(t+e)*g;_<r&&(_=r,A=(t-e)/2*g),z=-t*g;}else z=(i-g)*Nu-17;}T?(t.verticalizable=!0,b.push({glyph:y,imageName:S,x:p,y:d+z,vertical:T,scale:g,localGlyph:v.localGlyph,fontStack:o.fontStack,sectionIndex:f,metrics:v,rect:k}),p+=I*g+u):(b.push({glyph:y,imageName:S,x:p,y:d+z,vertical:T,scale:g,localGlyph:v.localGlyph,fontStack:o.fontStack,sectionIndex:f,metrics:v,rect:k}),p+=v.advance*g+u);}0!==b.length&&(f=Math.max(p-u,f),m?Oc(b,y,w,A,s*i/2):Oc(b,y,w,0,s/2)),p=0;const k=s*i+w;v.lineOffset=Math.max(w,o),d+=k,++g;}var x;const v=d,{horizontalAlign:b,verticalAlign:w}=Uc(a);(function(t,e,r,n,i,s){const a=(e-r)*i,o=-s*n;for(const e of t)for(const t of e.positionedGlyphs)t.x+=a,t.y+=o;})(t.positionedLines,y,b,w,f,v),t.top+=-w*v,t.bottom=t.top+v,t.left+=-b*f,t.right=t.left+f,t.hasBaseline=m;}(w,e,r,n,g,a,o,l,h,u,p,y),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return !1;return !0}(b)&&w}const Ec={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Dc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Pc(t,e,r,n,i,s){if(e.imageName){const t=n[e.imageName];return t?t.displaySize[0]*e.scale*Nu/s+i:0}{const n=r[e.fontStack],s=n&&n.glyphs[t];return s?s.metrics.advance*e.scale+i:0}}function Vc(t,e,r,n){const i=Math.pow(t-e,2);return n?t<e?i/2:2*i:i+Math.abs(r)*r}function Fc(t,e,r){let n=0;return 10===t&&(n-=1e4),r&&(n+=150),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function Lc(t,e,r,n,i,s){let a=null,o=Vc(e,r,i,s);for(const t of n){const n=Vc(e-t.x,r,i,s)+t.badness;n<=o&&(a=t,o=n);}return {index:t,x:e,priorBreak:a,badness:o}}function Rc(t){return t?Rc(t.priorBreak).concat(t.index):[]}function $c(t,e,r,n,i,s,a){if("point"!==s)return [];if(!t)return [];const o=[],l=function(t,e,r,n,i,s){let a=0;for(let r=0;r<t.length();r++){const o=t.getSection(r);a+=Pc(t.getCharCode(r),o,n,i,e,s);}return a/Math.max(1,Math.ceil(a/r))}(t,e,r,n,i,a),u=t.text.indexOf("​")>=0;let c=0;for(let r=0;r<t.length();r++){const s=t.getSection(r),p=t.getCharCode(r);if(Ec[p]||(c+=Pc(p,s,n,i,e,a)),r<t.length()-1){const e=!((h=p)<11904||!(Ti(h)||zi(h)||Oi(h)||Ri(h)||Ei(h)||wi(h)||Mi(h)||ki(h)||Di(h)||Pi(h)||Bi(h)||Ni(h)||Si(h)||Ai(h)||_i(h)||Ci(h)||Ii(h)||Ui(h)||Fi(h)||Vi(h)));(Dc[p]||e||s.imageName)&&o.push(Lc(r+1,c,l,o,Fc(p,t.getCharCode(r+1),e&&u),!1));}}var h;return Rc(Lc(t.length(),c,l,o,0,!0))}function Uc(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;}return {horizontalAlign:e,verticalAlign:r}}function Oc(t,e,r,n,i){if(!(e||r||n||i))return;const s=t.length-1,a=t[s],o=(a.x+a.metrics.advance*a.scale)*e;for(let e=0;e<=s;e++)t[e].x-=o,t[e].y+=r+n+i;}function jc(t,e,r){const{horizontalAlign:n,verticalAlign:i}=Uc(r),s=e[0]-t.displaySize[0]*n,a=e[1]-t.displaySize[1]*i;return {image:t,top:a,bottom:a+t.displaySize[1],left:s,right:s+t.displaySize[0]}}function qc(t,e,r,n,i,s){const a=t.image;let o;if(a.content){const t=a.content,e=a.pixelRatio||1;o=[t[0]/e,t[1]/e,a.displaySize[0]-t[2]/e,a.displaySize[1]-t[3]/e];}const l=e.left*s,u=e.right*s;let c,h,p,d;"width"===r||"both"===r?(d=i[0]+l-n[3],h=i[0]+u+n[1]):(d=i[0]+(l+u-a.displaySize[0])/2,h=d+a.displaySize[0]);const f=e.top*s,y=e.bottom*s;return "height"===r||"both"===r?(c=i[1]+f-n[0],p=i[1]+y+n[2]):(c=i[1]+(f+y-a.displaySize[1])/2,p=c+a.displaySize[1]),{image:a,top:c,right:h,bottom:p,left:d,collisionPadding:o}}class Nc extends i{constructor(t,e,r,n,i){super(t,e),this.angle=n,this.z=r,void 0!==i&&(this.segment=i);}clone(){return new Nc(this.x,this.y,this.z,this.angle,this.segment)}}function Zc(t,e,r,n,i){if(void 0===e.segment)return !0;let s=e,a=e.segment+1,o=0;for(;o>-r/2;){if(a--,a<0)return !1;o-=t[a].dist(s),s=t[a];}o+=t[a].dist(t[a+1]),a++;const l=[];let u=0;for(;o<r/2;){const e=t[a],r=t[a+1];if(!r)return !1;let s=t[a-1].angleTo(e)-e.angleTo(r);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:s}),u+=s;o-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return !1;a++,o+=e.dist(r);}return !0}function Gc(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Xc(t,e,r){return t?.6*e*r:0}function Kc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Yc(t,e,r,n,i,s){const a=Xc(r,i,s),o=Kc(r,n)*s;let l=0;const u=Gc(t)/2;for(let r=0;r<t.length-1;r++){const n=t[r],i=t[r+1],s=n.dist(i);if(l+s>u){const c=(u-l)/s,h=nr(n.x,i.x,c),p=nr(n.y,i.y,c),d=new Nc(h,p,0,i.angleTo(n),r);return !a||Zc(t,d,o,a,e)?d:void 0}l+=s;}}function Hc(t,e,r,n,i,s,a,o,l){const u=Xc(n,s,a),c=Kc(n,i),h=c*a,p=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Jc(t,p?e/2*o%e:(c/2+2*s)*a*o%e,e,u,r,h,p,!1,l)}function Jc(t,e,r,n,i,s,a,o,l){const u=s/2,c=Gc(t);let h=0,p=e-r,d=[];for(let e=0;e<t.length-1;e++){const a=t[e],o=t[e+1],f=a.dist(o),y=o.angleTo(a);for(;p+r<h+f;){p+=r;const m=(p-h)/f,g=nr(a.x,o.x,m),x=nr(a.y,o.y,m);if(g>=0&&g<l&&x>=0&&x<l&&p-u>=0&&p+u<=c){const r=new Nc(g,x,0,y,e);r._round(),n&&!Zc(t,r,s,n,i)||d.push(r);}}h+=f;}return o||d.length||a||(d=Jc(t,h/2,r,n,i,s,a,!0,l)),d}function Wc(t,e,r,n,s){const a=[];for(let o=0;o<t.length;o++){const l=t[o];let u;for(let t=0;t<l.length-1;t++){let o=l[t],c=l[t+1];o.x<e&&c.x<e||(o.x<e?o=new i(e,o.y+(e-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x<e&&(c=new i(e,o.y+(e-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y<r&&c.y<r||(o.y<r?o=new i(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round():c.y<r&&(c=new i(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round()),o.x>=n&&c.x>=n||(o.x>=n?o=new i(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x>=n&&(c=new i(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y>=s&&c.y>=s||(o.y>=s?o=new i(o.x+(s-o.y)/(c.y-o.y)*(c.x-o.x),s)._round():c.y>=s&&(c=new i(o.x+(s-o.y)/(c.y-o.y)*(c.x-o.x),s)._round()),u&&o.equals(u[u.length-1])||(u=[o],a.push(u)),u.push(c)))));}}return a}pi("Anchor",Nc);const Qc=1e20;function th(t,e,r,n,i,s,a,o,l){for(let u=e;u<e+n;u++)eh(t,r*s+u,s,i,a,o,l);for(let u=r;u<r+i;u++)eh(t,u*s+e,1,n,a,o,l);}function eh(t,e,r,n,i,s,a){s[0]=0,a[0]=-Qc,a[1]=Qc,i[0]=t[e];for(let o=1,l=0,u=0;o<n;o++){i[o]=t[e+o*r];const n=o*o;do{const t=s[l];u=(i[o]-i[t]+n-t*t)/(o-t)/2;}while(u<=a[l]&&--l>-1);l++,s[l]=o,a[l]=u,a[l+1]=Qc;}for(let o=0,l=0;o<n;o++){for(;a[l+1]<o;)l++;const n=s[l],u=o-n;t[e+o*r]=i[n]+u*u;}}const rh={none:0,ideographs:1,all:2};class nh{constructor(t,e,r){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=r,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}};}setURL(t){this.url=t;}getGlyphs(t,e){const r=[];for(const e in t)for(const n of t[e])r.push({stack:e,id:n});x(r,(({stack:t,id:e},r)=>{let n=this.entries[t];n||(n=this.entries[t]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let i=n.glyphs[e];if(void 0!==i)return void r(null,{stack:t,id:e,glyph:i});if(i=this._tinySDF(n,t,e),i)return n.glyphs[e]=i,void r(null,{stack:t,id:e,glyph:i});const s=Math.floor(e/256);if(256*s>65535)return void r(new Error("glyphs > 65535 not supported"));if(n.ranges[s])return void r(null,{stack:t,id:e,glyph:i});let a=n.requests[s];a||(a=n.requests[s]=[],nh.loadGlyphRange(t,s,this.url,this.requestManager,((t,e)=>{if(e){n.ascender=e.ascender,n.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(n.glyphs[+t]=e.glyphs[+t]);n.ranges[s]=!0;}for(const r of a)r(t,e);delete n.requests[s];}))),a.push(((n,i)=>{n?r(n):i&&r(null,{stack:t,id:e,glyph:i.glyphs[e]||null});}));}),((t,r)=>{if(t)e(t);else if(r){const t={};for(const{stack:e,id:n,glyph:i}of r)void 0===t[e]&&(t[e]={}),void 0===t[e].glyphs&&(t[e].glyphs={}),t[e].glyphs[n]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics},t[e].ascender=this.entries[e].ascender,t[e].descender=this.entries[e].descender;e(null,t);}}));}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==rh.none&&(this.localGlyphMode===rh.all?!!this.localFontFamily:!!this.localFontFamily&&(Pi(t)||Li(t)||Si(t)||Ii(t))||ki(t))}_tinySDF(t,e,r){const n=this.localFontFamily;if(!n||!this._doesCharSupportLocalGlyph(r))return;let i=t.tinySDF;if(!i){let r="400";/bold/i.test(e)?r="900":/medium/i.test(e)?r="500":/light/i.test(e)&&(r="200"),i=t.tinySDF=new nh.TinySDF({fontFamily:n,fontWeight:r,fontSize:48,buffer:6,radius:16}),i.fontWeight=r;}if(this.localGlyphs[i.fontWeight][r])return this.localGlyphs[i.fontWeight][r];const s=String.fromCharCode(r),{data:a,width:o,height:l,glyphWidth:u,glyphHeight:c,glyphLeft:h,glyphTop:p,glyphAdvance:d}=i.draw(s);return this.localGlyphs[i.fontWeight][r]={id:r,bitmap:new pl({width:o,height:l},a),metrics:{width:u/2,height:c/2,left:h/2,top:p/2-27,advance:d/2,localGlyph:!0}}}}function ih(t,e,r,n){const s=[],a=t.image,o=a.pixelRatio,l=a.paddedRect.w-2,u=a.paddedRect.h-2,c=t.right-t.left,h=t.bottom-t.top,p=a.stretchX||[[0,l]],d=a.stretchY||[[0,u]],f=(t,e)=>t+e[1]-e[0],y=p.reduce(f,0),m=d.reduce(f,0),g=l-y,x=u-m;let v=0,b=y,w=0,_=m,A=0,k=g,S=0,I=x;if(a.content&&n){const t=a.content;v=sh(p,0,t[0]),w=sh(d,0,t[1]),b=sh(p,t[0],t[2]),_=sh(d,t[1],t[3]),A=t[0]-v,S=t[1]-w,k=t[2]-t[0]-b,I=t[3]-t[1]-_;}const z=(n,s,l,u)=>{const p=oh(n.stretch-v,b,c,t.left),d=lh(n.fixed-A,k,n.stretch,y),f=oh(s.stretch-w,_,h,t.top),g=lh(s.fixed-S,I,s.stretch,m),x=oh(l.stretch-v,b,c,t.left),z=lh(l.fixed-A,k,l.stretch,y),T=oh(u.stretch-w,_,h,t.top),M=lh(u.fixed-S,I,u.stretch,m),C=new i(p,f),B=new i(x,f),E=new i(x,T),D=new i(p,T),P=new i(d/o,g/o),V=new i(z/o,M/o),F=e*Math.PI/180;if(F){const t=Math.sin(F),e=Math.cos(F),r=[e,-t,t,e];C._matMult(r),B._matMult(r),D._matMult(r),E._matMult(r);}const L=n.stretch+n.fixed,R=s.stretch+s.fixed;return {tl:C,tr:B,bl:D,br:E,tex:{x:a.paddedRect.x+1+L,y:a.paddedRect.y+1+R,w:l.stretch+l.fixed-L,h:u.stretch+u.fixed-R},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:P,pixelOffsetBR:V,minFontScaleX:k/o/c,minFontScaleY:I/o/h,isSDF:r}};if(n&&(a.stretchX||a.stretchY)){const t=ah(p,g,y),e=ah(d,x,m);for(let r=0;r<t.length-1;r++){const n=t[r],i=t[r+1];for(let t=0;t<e.length-1;t++)s.push(z(n,e[t],i,e[t+1]));}}else s.push(z({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return s}function sh(t,e,r){let n=0;for(const i of t)n+=Math.max(e,Math.min(r,i[1]))-Math.max(e,Math.min(r,i[0]));return n}function ah(t,e,r){const n=[{fixed:-1,stretch:0}];for(const[e,r]of t){const t=n[n.length-1];n.push({fixed:e-t.stretch,stretch:t.stretch}),n.push({fixed:e-t.stretch,stretch:t.stretch+(r-e)});}return n.push({fixed:e+1,stretch:r}),n}function oh(t,e,r,n){return t/e*r+n}function lh(t,e,r,n){return t-e*r/n}function uh(t,e,r,n){const i=e+t.positionedLines[n].lineOffset;return 0===n?r+i/2:r+(i+(e+t.positionedLines[n-1].lineOffset))/2}nh.loadGlyphRange=function(t,e,r,n,i){const s=256*e,a=s+255,o=n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",`${s}-${a}`),_t.Glyphs);It(o,((t,e)=>{if(t)i(t);else if(e){const t={},r=function(t){return new rc(t).readFields(_c,{})}(e);for(const e of r.glyphs)t[e.id]=e;i(null,{glyphs:t,ascender:r.ascender,descender:r.descender});}}));},nh.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:s="normal",fontStyle:a="normal"}){this.buffer=e,this.cutoff=n,this.radius=r;const o=this.size=t+4*e,l=this._createCanvas(o),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${s} ${t}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Uint16Array(o);}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:s}=this.ctx.measureText(t),a=Math.floor(r),o=Math.min(this.size-this.buffer,Math.ceil(s-i)),l=Math.min(this.size-this.buffer,Math.ceil(r)+Math.ceil(n)),u=o+2*this.buffer,c=l+2*this.buffer,h=u*c,p=new Uint8ClampedArray(h),d={data:p,width:u,height:c,glyphWidth:o,glyphHeight:l,glyphTop:a,glyphLeft:0,glyphAdvance:e};if(0===o||0===l)return d;const{ctx:f,buffer:y,gridInner:m,gridOuter:g}=this;f.clearRect(y,y,o,l),f.fillText(t,y,y+a+1);const x=f.getImageData(y,y,o,l);g.fill(Qc,0,h),m.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<o;e++){const r=x.data[4*(t*o+e)+3]/255;if(0===r)continue;const n=(t+y)*u+e+y;if(1===r)g[n]=0,m[n]=Qc;else {const t=.5-r;g[n]=t>0?t*t:0,m[n]=t<0?t*t:0;}}th(g,0,0,u,c,u,this.f,this.v,this.z),th(m,y,y,o,l,u,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(g[t])-Math.sqrt(m[t]);p[t]=Math.round(255-255*(e/this.radius+this.cutoff));}return d}};class ch{constructor(t=[],e=hh){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t);}push(t){this.data.push(t),this.length++,this._up(this.length-1);}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:r}=this,n=e[t];for(;t>0;){const i=t-1>>1,s=e[i];if(r(n,s)>=0)break;e[t]=s,t=i;}e[t]=n;}_down(t){const{data:e,compare:r}=this,n=this.length>>1,i=e[t];for(;t<n;){let n=1+(t<<1),s=e[n];const a=n+1;if(a<this.length&&r(e[a],s)<0&&(n=a,s=e[a]),r(s,i)>=0)break;e[t]=s,t=n;}e[t]=i;}}function hh(t,e){return t<e?-1:t>e?1:0}function ph(t,e=1,r=!1){let n=1/0,s=1/0,a=-1/0,o=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<n)&&(n=e.x),(!t||e.y<s)&&(s=e.y),(!t||e.x>a)&&(a=e.x),(!t||e.y>o)&&(o=e.y);}const u=Math.min(a-n,o-s);let c=u/2;const h=new ch([],dh);if(0===u)return new i(n,s);for(let e=n;e<a;e+=u)for(let r=s;r<o;r+=u)h.push(new fh(e+c,r+c,c,t));let p=function(t){let e=0,r=0,n=0;const i=t[0];for(let t=0,s=i.length,a=s-1;t<s;a=t++){const s=i[t],o=i[a],l=s.x*o.y-o.x*s.y;r+=(s.x+o.x)*l,n+=(s.y+o.y)*l,e+=3*l;}return new fh(r/e,n/e,0,t)}(t),d=h.length;for(;h.length;){const n=h.pop();(n.d>p.d||!p.d)&&(p=n,r&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,d)),n.max-p.d<=e||(c=n.h/2,h.push(new fh(n.p.x-c,n.p.y-c,c,t)),h.push(new fh(n.p.x+c,n.p.y-c,c,t)),h.push(new fh(n.p.x-c,n.p.y+c,c,t)),h.push(new fh(n.p.x+c,n.p.y+c,c,t)),d+=4);}return r&&(console.log(`num probes: ${d}`),console.log(`best distance: ${p.d}`)),p.p}function dh(t,e){return e.max-t.max}function fh(t,e,r,n){this.p=new i(t,e),this.h=r,this.d=function(t,e){let r=!1,n=1/0;for(let i=0;i<e.length;i++){const s=e[i];for(let e=0,i=s.length,a=i-1;e<i;a=e++){const i=s[e],o=s[a];i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(r=!r),n=Math.min(n,ko(t,i,o));}}return (r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2;}const yh=Number.POSITIVE_INFINITY,mh=Math.sqrt(2);function gh(t,e){return e[1]!==yh?function(t,e,r){let n=0,i=0;switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r;}switch(t){case"top-right":case"bottom-right":case"right":n=-e;break;case"top-left":case"bottom-left":case"left":n=e;}return [n,i]}(t,e[0],e[1]):function(t,e){let r=0,n=0;e<0&&(e=0);const i=e/mh;switch(t){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-e;break;case"top":n=e-7;}switch(t){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=e;break;case"right":r=-e;}return [r,n]}(t,e[0])}function xh(t,e,r,n,i,s,a,o,l){t.createArrays(),t.tilePixelRatio=Xa/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const u=t.layers[0].layout,c=t.layers[0]._unevaluatedLayout._values,h={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.textSizeData;h.compositeTextSizes=[c["text-size"].possiblyEvaluate(new hs(e),o),c["text-size"].possiblyEvaluate(new hs(r),o)];}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.iconSizeData;h.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new hs(e),o),c["icon-size"].possiblyEvaluate(new hs(r),o)];}h.layoutTextSize=c["text-size"].possiblyEvaluate(new hs(l+1),o),h.layoutIconSize=c["icon-size"].possiblyEvaluate(new hs(l+1),o),h.textMaxSize=c["text-size"].possiblyEvaluate(new hs(18),o);const p="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),d=u.get("text-size");for(const s of t.features){const l=u.get("text-font").evaluate(s,{},o).join(","),c=d.evaluate(s,{},o),f=h.layoutTextSize.evaluate(s,{},o),y=(h.layoutIconSize.evaluate(s,{},o),{horizontal:{},vertical:void 0}),m=s.text;let g,x=[0,0];if(m){const n=m.toString(),a=u.get("text-letter-spacing").evaluate(s,{},o)*Nu,h=u.get("text-line-height").evaluate(s,{},o)*Nu,d=Gi(n)?a:0,g=u.get("text-anchor").evaluate(s,{},o),v=u.get("text-variable-anchor");if(!v){const t=u.get("text-radial-offset").evaluate(s,{},o);x=t?gh(g,[t*Nu,yh]):u.get("text-offset").evaluate(s,{},o).map((t=>t*Nu));}let b=p?"center":u.get("text-justify").evaluate(s,{},o);const w=u.get("symbol-placement"),_="point"===w,A="point"===w?u.get("text-max-width").evaluate(s,{},o)*Nu:0,k=s=>{t.allowVerticalPlacement&&Zi(n)&&(y.vertical=Bc(m,e,r,i,l,A,h,g,s,d,x,Tc.vertical,!0,w,f,c));};if(!p&&v){const t="auto"===b?v.map((t=>vh(t))):[b];let n=!1;for(let s=0;s<t.length;s++){const a=t[s];if(!y.horizontal[a])if(n)y.horizontal[a]=y.horizontal[0];else {const t=Bc(m,e,r,i,l,A,h,"center",a,d,x,Tc.horizontal,!1,w,f,c);t&&(y.horizontal[a]=t,n=1===t.positionedLines.length);}}k("left");}else {if("auto"===b&&(b=vh(g)),_||u.get("text-writing-mode").indexOf("horizontal")>=0||!Zi(n)){const t=Bc(m,e,r,i,l,A,h,g,b,d,x,Tc.horizontal,!1,w,f,c);t&&(y.horizontal[b]=t);}k("point"===w?"left":b);}}let v=!1;if(s.icon&&s.icon.name){const e=n[s.icon.name];e&&(g=jc(i[s.icon.name],u.get("icon-offset").evaluate(s,{},o),u.get("icon-anchor").evaluate(s,{},o)),v=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&E("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==u.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0));}const b=Ah(y.horizontal)||y.vertical;t.iconsInText||(t.iconsInText=!!b&&b.iconsInText),(b||g)&&bh(t,s,y,g,n,h,f,0,x,v,a,o);}s&&t.generateCollisionDebugBuffers(l,t.collisionBoxArray);}function vh(t){switch(t){case"right":case"top-right":case"bottom-right":return "right";case"left":case"top-left":case"bottom-left":return "left"}return "center"}function bh(t,e,r,n,i,s,a,o,l,u,h,p){let d=s.textMaxSize.evaluate(e,{},p);void 0===d&&(d=a);const f=t.layers[0].layout,y=f.get("icon-offset").evaluate(e,{},p),m=Ah(r.horizontal)||r.vertical,g=a/24,x=t.tilePixelRatio*d/24,v=t.tilePixelRatio*f.get("symbol-spacing"),b=f.get("text-padding")*t.tilePixelRatio,w=f.get("icon-padding")*t.tilePixelRatio,_=c(f.get("text-max-angle")),A="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),k="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),S=f.get("symbol-placement"),I=v/2,z=f.get("icon-text-fit");let T;n&&"none"!==z&&(t.allowVerticalPlacement&&r.vertical&&(T=qc(n,r.vertical,z,f.get("icon-text-fit-padding"),y,g)),m&&(n=qc(n,m,z,f.get("icon-text-fit-padding"),y,g)));const M=(a,o)=>{o.x<0||o.x>=Xa||o.y<0||o.y>=Xa||function(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y,m,g,x,v,b,w,_,A,k){const S=t.addToLineVertexArray(e,n);let I,z,T,M,C,B,D,P=0,V=0,F=0,L=0,R=-1,$=-1;const U={};let O=ma(""),j=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[j,q]=l.layout.get("text-offset").evaluate(b,{},k).map((t=>t*Nu)):(j=l.layout.get("text-radial-offset").evaluate(b,{},k)*Nu,q=yh),t.allowVerticalPlacement&&i.vertical){const t=i.vertical;if(f)B=Sh(t),o&&(D=Sh(o));else {const n=l.layout.get("text-rotate").evaluate(b,{},k)+90;T=kh(u,r,e,c,h,p,t,d,n,y),o&&(M=kh(u,r,e,c,h,p,o,g,n));}}if(s){const n=l.layout.get("icon-rotate").evaluate(b,{},k),i="none"!==l.layout.get("icon-text-fit"),a=ih(s,n,_,i),d=o?ih(o,n,_,i):void 0;z=kh(u,r,e,c,h,p,s,g,n),P=4*a.length;const f=t.iconSizeData;let y=null;"source"===f.kind?(y=[Zu*l.layout.get("icon-size").evaluate(b,{},k)],y[0]>wh&&E(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===f.kind&&(y=[Zu*w.compositeIconSizes[0].evaluate(b,{},k),Zu*w.compositeIconSizes[1].evaluate(b,{},k)],(y[0]>wh||y[1]>wh)&&E(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,a,y,v,x,b,!1,r,e,S.lineStartIndex,S.lineLength,-1,A,k),R=t.icon.placedSymbolArray.length-1,d&&(V=4*d.length,t.addSymbols(t.icon,d,y,v,x,b,Tc.vertical,r,e,S.lineStartIndex,S.lineLength,-1,A,k),$=t.icon.placedSymbolArray.length-1);}for(const n in i.horizontal){const s=i.horizontal[n];I||(O=ma(s.text),f?C=Sh(s):I=kh(u,r,e,c,h,p,s,d,l.layout.get("text-rotate").evaluate(b,{},k),y));const o=1===s.positionedLines.length;if(F+=_h(t,r,e,s,a,l,f,b,y,S,i.vertical?Tc.horizontal:Tc.horizontalOnly,o?Object.keys(i.horizontal):[n],U,R,w,A,k),o)break}i.vertical&&(L+=_h(t,r,e,i.vertical,a,l,f,b,y,S,Tc.vertical,["vertical"],U,$,w,A,k));let N=-1;const Z=(t,e)=>t?Math.max(t,e):e;N=Z(C,N),N=Z(B,N),N=Z(D,N);const G=N>-1?1:0;t.glyphOffsetArray.length>=Ph.MAX_GLYPHS&&E("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(r.x,r.y,r.z,e.x,e.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical>=0?U.vertical:-1,R,$,O,void 0!==I?I:t.collisionBoxArray.length,void 0!==I?I+1:t.collisionBoxArray.length,void 0!==T?T:t.collisionBoxArray.length,void 0!==T?T+1:t.collisionBoxArray.length,void 0!==z?z:t.collisionBoxArray.length,void 0!==z?z+1:t.collisionBoxArray.length,M||t.collisionBoxArray.length,M?M+1:t.collisionBoxArray.length,c,F,L,P,V,G,0,j,q,N);}(t,o,o,a,r,n,i,T,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,b,A,l,0,w,k,y,e,s,u,h,p);};if("line"===S)for(const i of Wc(e.geometry,0,0,Xa,Xa)){const e=Hc(i,v,_,r.vertical||m,n,24,x,t.overscaling,Xa);for(const r of e){const e=m;e&&Ih(t,e.text,I,r)||M(i,r);}}else if("line-center"===S){for(const t of e.geometry)if(t.length>1){const e=Yc(t,_,r.vertical||m,n,24,x);e&&M(t,e);}}else if("Polygon"===e.type)for(const t of Jl(e.geometry,0)){const e=ph(t,16);M(t[0],new Nc(e.x,e.y,0,0,void 0));}else if("LineString"===e.type)for(const t of e.geometry)M(t,new Nc(t[0].x,t[0].y,0,0,void 0));else if("Point"===e.type)for(const t of e.geometry)for(const e of t)M([e],new Nc(e.x,e.y,0,0,void 0));}const wh=32640;function _h(t,e,r,n,s,a,o,l,u,c,h,p,d,f,y,m,g){const x=function(t,e,r,n,s,a,o,l){const u=[];if(0===e.positionedLines.length)return u;const c=n.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,h=function(t){const e=t[0],r=t[1],n=e*r;return n>0?[e,-r]:n<0?[-e,r]:0===e?[r,e]:[r,-e]}(r);let p=Math.abs(e.top-e.bottom);for(const t of e.positionedLines)p-=t.lineOffset;const d=e.positionedLines.length,f=p/d;let y=e.top-r[1];for(let t=0;t<d;++t){const n=e.positionedLines[t];y=uh(e,f,y,t);for(const t of n.positionedGlyphs){if(!t.rect)continue;const n=t.rect||{};let a=4,p=!0,d=1,f=0;if(t.imageName){const e=o[t.imageName];if(!e)continue;if(e.sdf){E("SDF images are not supported in formatted text and will be ignored.");continue}p=!1,d=e.pixelRatio,a=1/d;}const m=(s||l)&&t.vertical,g=t.metrics.advance*t.scale/2,x=t.metrics,v=t.rect;if(null===v)continue;l&&e.verticalizable&&(f=t.imageName?g-t.metrics.width*t.scale/2:0);const b=s?[t.x+g,t.y]:[0,0];let w=[0,0],_=[0,0],A=!1;s||(m?(_=[t.x+g+h[0],t.y+h[1]-f],A=!0):w=[t.x+g+r[0],t.y+r[1]-f]);const k=v.w*t.scale/(d*(t.localGlyph?2:1)),S=v.h*t.scale/(d*(t.localGlyph?2:1));let I,z,T,M;if(m){const e=t.y-y,r=new i(-g,g-e),n=-Math.PI/2,s=new i(..._);I=new i(-g+w[0],w[1]),I._rotateAround(n,r)._add(s),I.x+=-e+g,I.y-=(x.left-a)*t.scale;const o=t.imageName?x.advance*t.scale:Nu*t.scale,l=String.fromCharCode(t.glyph);Wu(l)?I.x+=(1-a)*t.scale:Qu(l)?I.x+=o-x.height*t.scale+(-a-1)*t.scale:I.x+=t.imageName||x.width+2*a===v.w&&x.height+2*a===v.h?(o-S)/2:(o-(x.height+2*a)*t.scale)/2,z=new i(I.x,I.y-k),T=new i(I.x+S,I.y),M=new i(I.x+S,I.y-k);}else {const e=(x.left-a)*t.scale-g+w[0],r=(-x.top-a)*t.scale+w[1],n=e+k,s=r+S;I=new i(e,r),z=new i(n,r),T=new i(e,s),M=new i(n,s);}if(c){let t;t=s?new i(0,0):A?new i(h[0],h[1]):new i(r[0],r[1]),I._rotateAround(c,t),z._rotateAround(c,t),T._rotateAround(c,t),M._rotateAround(c,t);}const C=new i(0,0),B=new i(0,0);u.push({tl:I,tr:z,bl:T,br:M,tex:n,writingMode:e.writingMode,glyphOffset:b,sectionIndex:t.sectionIndex,isSDF:p,pixelOffsetTL:C,pixelOffsetBR:B,minFontScaleX:0,minFontScaleY:0});}}return u}(0,n,u,a,o,l,s,t.allowVerticalPlacement),v=t.textSizeData;let b=null;"source"===v.kind?(b=[Zu*a.layout.get("text-size").evaluate(l,{},g)],b[0]>wh&&E(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===v.kind&&(b=[Zu*y.compositeTextSizes[0].evaluate(l,{},g),Zu*y.compositeTextSizes[1].evaluate(l,{},g)],(b[0]>wh||b[1]>wh)&&E(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,x,b,u,o,l,h,e,r,c.lineStartIndex,c.lineLength,f,m,g);for(const e of p)d[e]=t.text.placedSymbolArray.length-1;return 4*x.length}function Ah(t){for(const e in t)return t[e];return null}function kh(t,e,r,n,s,a,o,l,u,h){let p=o.top,d=o.bottom,f=o.left,y=o.right;const m=o.collisionPadding;if(m&&(f-=m[0],p-=m[1],y+=m[2],d+=m[3]),u){const t=new i(f,p),e=new i(y,p),r=new i(f,d),n=new i(y,d),s=c(u);let a=new i(0,0);h&&(a=new i(h[0],h[1])),t._rotateAround(s,a),e._rotateAround(s,a),r._rotateAround(s,a),n._rotateAround(s,a),f=Math.min(t.x,e.x,r.x,n.x),y=Math.max(t.x,e.x,r.x,n.x),p=Math.min(t.y,e.y,r.y,n.y),d=Math.max(t.y,e.y,r.y,n.y);}return t.emplaceBack(e.x,e.y,e.z,r.x,r.y,f,p,y,d,l,n,s,a),t.length-1}function Sh(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Ih(t,e,r,n){const i=t.compareText;if(e in i){const t=i[e];for(let e=t.length-1;e>=0;e--)if(n.dist(t[e])<r)return !0}else i[e]=[];return i[e].push(n),!1}const zh=yu.VectorTileFeature.types,Th=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Mh(t,e,r,n,i,s,a,o,l,u,c,h,p,d,f,y){const m=c?Math.min(wh,Math.round(c[0])):0,g=c?Math.min(wh,Math.round(c[1])):0;t.emplaceBack(e,r,Math.round(32*a),Math.round(32*o),l,u,(m<<1)+(h?1:0),g,16*p,16*d,256*f,256*y,n,i,s,0);}function Ch(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r);}function Bh(t){for(const e of t.sections)if(Wi(e.text))return !0;return !1}class Eh{constructor(t){this.layoutVertexArray=new Rs,this.indexArray=new Ns,this.programConfigurations=t,this.segments=new Ga,this.dynamicLayoutVertexArray=new Vs,this.opacityVertexArray=new $s,this.placedSymbolArray=new na;}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ru.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,$u.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Th,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(t));}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy());}}pi("SymbolBuffers",Eh);class Dh{constructor(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Ga,this.collisionVertexArray=new qs,this.collisionVertexArrayExt=new Vs;}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Uu.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,Ou.members,!0);}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy());}}pi("CollisionBuffers",Dh);class Ph{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Lo([]),this.placementViewportMatrix=Lo([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gu(this.zoom,e["text-size"]),this.iconSizeData=Gu(this.zoom,e["icon-size"]);const r=this.layers[0].layout,n=r.get("symbol-sort-key"),i=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=r.get("text-writing-mode").map((t=>Tc[t])),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=t.sourceID;}createArrays(){this.text=new Eh(new Fa(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Eh(new Fa(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new aa,this.lineVertexArray=new oa,this.symbolInstances=new sa;}calculateGlyphDependencies(t,e,r,n,i){for(let r=0;r<t.length;r++)if(e[t.charCodeAt(r)]=!0,n&&i){const n=Ju[t.charAt(r)];n&&(e[n.charCodeAt(0)]=!0);}}populate(t,e,r,n){const i=this.layers[0],s=i.layout,a=s.get("text-font"),o=s.get("text-field"),l=s.get("icon-image"),u=("constant"!==o.value.kind||o.value.value instanceof fe&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),c="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=s.get("symbol-sort-key");if(this.features=[],!u&&!c)return;const p=e.iconDependencies,d=e.glyphDependencies,f=e.availableImages,y=new hs(this.zoom);for(const{feature:e,id:o,index:l,sourceLayerIndex:m}of t){const t=i._featureFilter.needGeometry,g=fo(e,t);if(!i._featureFilter.filter(y,g,r))continue;let x,v;if(t||(g.geometry=po(e,r,n)),u){const t=i.getValueAndResolveTokens("text-field",g,r,f),e=fe.factory(t);Bh(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ls()||this.hasRTLText&&cs.isParsed())&&(x=Hu(e,i,g));}if(c){const t=i.getValueAndResolveTokens("icon-image",g,r,f);v=t instanceof ye?t:ye.fromString(t);}if(!x&&!v)continue;const b=this.sortFeaturesByKey?h.evaluate(g,{},r):void 0;if(this.features.push({id:o,text:x,icon:v,index:l,sourceLayerIndex:m,geometry:g.geometry,properties:e.properties,type:zh[e.type],sortKey:b}),v&&(p[v.name]=!0),x){const t=a.evaluate(g,{},r).join(","),e="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Tc.vertical)>=0;for(const r of x.sections)if(r.image)p[r.image.name]=!0;else {const n=Zi(x.toString()),i=r.fontStack||t,s=d[i]=d[i]||{};this.calculateGlyphDependencies(r.text,s,e,this.allowVerticalPlacement,n);}}}"line"===s.get("symbol-placement")&&(this.features=function(t){const e={},r={},n=[];let i=0;function s(e){n.push(t[e]),i++;}function a(t,e,i){const s=r[t];return delete r[t],r[e]=s,n[s].geometry[0].pop(),n[s].geometry[0]=n[s].geometry[0].concat(i[0]),s}function o(t,r,i){const s=e[r];return delete e[r],e[t]=s,n[s].geometry[0].shift(),n[s].geometry[0]=i[0].concat(n[s].geometry[0]),s}function l(t,e,r){const n=r?e[0][e[0].length-1]:e[0][0];return `${t}:${n.x}:${n.y}`}for(let u=0;u<t.length;u++){const c=t[u],h=c.geometry,p=c.text?c.text.toString():null;if(!p){s(u);continue}const d=l(p,h),f=l(p,h,!0);if(d in r&&f in e&&r[d]!==e[f]){const t=o(d,f,h),i=a(d,f,n[t].geometry);delete e[d],delete r[f],r[l(p,n[i].geometry,!0)]=i,n[t].geometry=null;}else d in r?a(d,f,h):f in e?o(d,f,h):(s(u),e[d]=i-1,r[f]=i-1);}return n.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey));}update(t,e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r,n));}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return !this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0;}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy();}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();}addToLineVertexArray(t,e){const r=this.lineVertexArray.length;if(void 0!==t.segment){let r=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]);const i={};for(let n=t.segment+1;n<e.length;n++)i[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:r},n<e.length-1&&(r+=e[n+1].dist(e[n]));for(let r=t.segment||0;r>=0;r--)i[r]={x:e[r].x,y:e[r].y,tileUnitDistanceFromAnchor:n},r>0&&(n+=e[r-1].dist(e[r]));for(let t=0;t<e.length;t++){const e=i[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor);}}return {lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,e,r,n,i,s,a,o,l,u,c,h,p,d){const f=t.indexArray,y=t.layoutVertexArray,m=t.segments.prepareSegment(4*e.length,y,f,this.canOverlap?s.sortKey:void 0),g=this.glyphOffsetArray.length,x=m.vertexLength,v=this.allowVerticalPlacement&&a===Tc.vertical?Math.PI/2:0,b=s.text&&s.text.sections;for(let n=0;n<e.length;n++){const{tl:i,tr:a,bl:u,br:c,tex:h,pixelOffsetTL:g,pixelOffsetBR:x,minFontScaleX:w,minFontScaleY:_,glyphOffset:A,isSDF:k,sectionIndex:S}=e[n],I=m.vertexLength,z=A[1];Mh(y,o.x,o.y,o.z,l.x,l.y,i.x,z+i.y,h.x,h.y,r,k,g.x,g.y,w,_),Mh(y,o.x,o.y,o.z,l.x,l.y,a.x,z+a.y,h.x+h.w,h.y,r,k,x.x,g.y,w,_),Mh(y,o.x,o.y,o.z,l.x,l.y,u.x,z+u.y,h.x,h.y+h.h,r,k,g.x,x.y,w,_),Mh(y,o.x,o.y,o.z,l.x,l.y,c.x,z+c.y,h.x+h.w,h.y+h.h,r,k,x.x,x.y,w,_),Ch(t.dynamicLayoutVertexArray,o,v),f.emplaceBack(I,I+1,I+2),f.emplaceBack(I+1,I+2,I+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),n!==e.length-1&&S===e[n+1].sectionIndex||t.programConfigurations.populatePaintArrays(y.length,s,s.index,{},p,d,b&&b[S]);}t.placedSymbolArray.emplaceBack(o.x,o.y,o.z,l.x,l.y,g,this.glyphOffsetArray.length-g,x,u,c,l.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,0,!1,0,h,0);}_commitLayoutVertex(t,e,r,n,i,s,a){t.emplaceBack(e,r,n,i,s,Math.round(a.x),Math.round(a.y));}_addCollisionDebugVertices(t,e,r,n,s,a,o){const l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),u=l.vertexLength,c=o.tileAnchorX,h=o.tileAnchorY;for(let t=0;t<4;t++)r.collisionVertexArray.emplaceBack(0,0,0,0);r.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),r.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),r.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),r.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(r.layoutVertexArray,n,s,a,c,h,new i(t.x1,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,s,a,c,h,new i(t.x2,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,s,a,c,h,new i(t.x2,t.y2)),this._commitLayoutVertex(r.layoutVertexArray,n,s,a,c,h,new i(t.x1,t.y2)),l.vertexLength+=4;const p=r.indexArray;p.emplaceBack(u,u+1),p.emplaceBack(u+1,u+2),p.emplaceBack(u+2,u+3),p.emplaceBack(u+3,u),l.primitiveLength+=4;}_addTextDebugCollisionBoxes(t,e,r,n,i,s){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceTextSize(t,s,e,a);this._addCollisionDebugVertices(n,i,this.textCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s);}}_addIconDebugCollisionBoxes(t,e,r,n,i,s){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceIconSize(t,e,a);this._addCollisionDebugVertices(n,i,this.iconCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s);}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dh(Os,ju.members,Hs),this.iconCollisionBox=new Dh(Os,ju.members,Hs);const r=Ku(this.iconSizeData,t),n=Ku(this.textSizeData,t);for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this._addTextDebugCollisionBoxes(n,t,e,s.textBoxStartIndex,s.textBoxEndIndex,s),this._addTextDebugCollisionBoxes(n,t,e,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._addIconDebugCollisionBoxes(r,t,e,s.iconBoxStartIndex,s.iconBoxEndIndex,s),this._addIconDebugCollisionBoxes(r,t,e,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s);}}getSymbolInstanceTextSize(t,e,r,n){const i=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:n),s=Xu(this.textSizeData,t,i)/Nu;return this.tilePixelRatio*s}getSymbolInstanceIconSize(t,e,r){const n=this.icon.placedSymbolArray.get(r),i=Xu(this.iconSizeData,t,n);return this.tilePixelRatio*i}_commitDebugCollisionVertexUpdate(t,e,r){t.emplaceBack(e,-r,-r),t.emplaceBack(e,r,-r),t.emplaceBack(e,r,r),t.emplaceBack(e,-r,r);}_updateTextDebugCollisionBoxes(t,e,r,n,i,s){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceTextSize(t,s,e,a);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,i,n.padding);}}_updateIconDebugCollisionBoxes(t,e,r,n,i){for(let s=n;s<i;s++){const n=r.get(s),i=this.getSymbolInstanceIconSize(t,e,s);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,i,n.padding);}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=Ku(this.iconSizeData,t),n=Ku(this.textSizeData,t);for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this._updateTextDebugCollisionBoxes(n,t,e,s.textBoxStartIndex,s.textBoxEndIndex,s),this._updateTextDebugCollisionBoxes(n,t,e,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._updateIconDebugCollisionBoxes(r,t,e,s.iconBoxStartIndex,s.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(r,t,e,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex);}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt);}_deserializeCollisionBoxesForSymbol(t,e,r,n,i,s,a,o,l){const u={};for(let n=e;n<r;n++){const e=t.get(n);u.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,projectedAnchorX:e.projectedAnchorX,projectedAnchorY:e.projectedAnchorY,projectedAnchorZ:e.projectedAnchorZ,tileAnchorX:e.tileAnchorX,tileAnchorY:e.tileAnchorY},u.textFeatureIndex=e.featureIndex;break}for(let e=n;e<i;e++){const r=t.get(e);u.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,padding:r.padding,projectedAnchorX:r.projectedAnchorX,projectedAnchorY:r.projectedAnchorY,projectedAnchorZ:r.projectedAnchorZ,tileAnchorX:r.tileAnchorX,tileAnchorY:r.tileAnchorY},u.verticalTextFeatureIndex=r.featureIndex;break}for(let e=s;e<a;e++){const r=t.get(e);u.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,padding:r.padding,projectedAnchorX:r.projectedAnchorX,projectedAnchorY:r.projectedAnchorY,projectedAnchorZ:r.projectedAnchorZ,tileAnchorX:r.tileAnchorX,tileAnchorY:r.tileAnchorY},u.iconFeatureIndex=r.featureIndex;break}for(let e=o;e<l;e++){const r=t.get(e);u.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,padding:r.padding,projectedAnchorX:r.projectedAnchorX,projectedAnchorY:r.projectedAnchorY,projectedAnchorZ:r.projectedAnchorZ,tileAnchorX:r.tileAnchorX,tileAnchorY:r.tileAnchorY},u.verticalIconFeatureIndex=r.featureIndex;break}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex));}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const r=t.placedSymbolArray.get(e),n=r.vertexStartIndex+4*r.numGlyphs;for(let e=r.vertexStartIndex;e<n;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3);}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),r=Math.cos(t),n=[],i=[],s=[];for(let t=0;t<this.symbolInstances.length;++t){s.push(t);const a=this.symbolInstances.get(t);n.push(0|Math.round(e*a.tileAnchorX+r*a.tileAnchorY)),i.push(a.featureIndex);}return s.sort(((t,e)=>n[t]-n[e]||i[e]-i[t])),s}addToSortKeyRanges(t,e){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1});}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,r)=>{t>=0&&r.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t);})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex);}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray);}}}pi("SymbolBucket",Ph,{omit:["layers","collisionBoxArray","features","compareText"]}),Ph.MAX_GLYPHS=65535,Ph.addDynamicAttributes=Ch;const Vh=new Ss({"symbol-placement":new bs($t.layout_symbol["symbol-placement"]),"symbol-spacing":new bs($t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bs($t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ws($t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bs($t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bs($t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new bs($t.layout_symbol["icon-ignore-placement"]),"icon-optional":new bs($t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bs($t.layout_symbol["icon-rotation-alignment"]),"icon-size":new ws($t.layout_symbol["icon-size"]),"icon-text-fit":new bs($t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bs($t.layout_symbol["icon-text-fit-padding"]),"icon-image":new ws($t.layout_symbol["icon-image"]),"icon-rotate":new ws($t.layout_symbol["icon-rotate"]),"icon-padding":new bs($t.layout_symbol["icon-padding"]),"icon-keep-upright":new bs($t.layout_symbol["icon-keep-upright"]),"icon-offset":new ws($t.layout_symbol["icon-offset"]),"icon-anchor":new ws($t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bs($t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bs($t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bs($t.layout_symbol["text-rotation-alignment"]),"text-field":new ws($t.layout_symbol["text-field"]),"text-font":new ws($t.layout_symbol["text-font"]),"text-size":new ws($t.layout_symbol["text-size"]),"text-max-width":new ws($t.layout_symbol["text-max-width"]),"text-line-height":new ws($t.layout_symbol["text-line-height"]),"text-letter-spacing":new ws($t.layout_symbol["text-letter-spacing"]),"text-justify":new ws($t.layout_symbol["text-justify"]),"text-radial-offset":new ws($t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bs($t.layout_symbol["text-variable-anchor"]),"text-anchor":new ws($t.layout_symbol["text-anchor"]),"text-max-angle":new bs($t.layout_symbol["text-max-angle"]),"text-writing-mode":new bs($t.layout_symbol["text-writing-mode"]),"text-rotate":new ws($t.layout_symbol["text-rotate"]),"text-padding":new bs($t.layout_symbol["text-padding"]),"text-keep-upright":new bs($t.layout_symbol["text-keep-upright"]),"text-transform":new ws($t.layout_symbol["text-transform"]),"text-offset":new ws($t.layout_symbol["text-offset"]),"text-allow-overlap":new bs($t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new bs($t.layout_symbol["text-ignore-placement"]),"text-optional":new bs($t.layout_symbol["text-optional"])});var Fh={paint:new Ss({"icon-opacity":new ws($t.paint_symbol["icon-opacity"]),"icon-color":new ws($t.paint_symbol["icon-color"]),"icon-halo-color":new ws($t.paint_symbol["icon-halo-color"]),"icon-halo-width":new ws($t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ws($t.paint_symbol["icon-halo-blur"]),"icon-translate":new bs($t.paint_symbol["icon-translate"]),"icon-translate-anchor":new bs($t.paint_symbol["icon-translate-anchor"]),"text-opacity":new ws($t.paint_symbol["text-opacity"]),"text-color":new ws($t.paint_symbol["text-color"],{runtimeType:Jt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new ws($t.paint_symbol["text-halo-color"]),"text-halo-width":new ws($t.paint_symbol["text-halo-width"]),"text-halo-blur":new ws($t.paint_symbol["text-halo-blur"]),"text-translate":new bs($t.paint_symbol["text-translate"]),"text-translate-anchor":new bs($t.paint_symbol["text-translate-anchor"])}),layout:Vh};class Lh{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Xt,this.defaultValue=t;}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression);}outputDefined(){return !1}serialize(){return null}}pi("FormatSectionOverride",Lh,{omit:["defaultValue"]});class Rh extends qa{constructor(t){super(t,Fh);}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const t=[];for(const e of r)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t;}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides();}getValueAndResolveTokens(t,e,r,n){const i=this.layout.get(t).evaluate(e,{},r,n),s=this._unevaluatedLayout._values[t];return s.isDataDriven()||cn(s.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,((e,r)=>r in t?String(t[r]):""))}(e.properties,i)}createBucket(t){return new Ph(t)}queryRadius(){return 0}queryIntersectsFeature(){return !1}_setPaintOverrides(){for(const t of Fh.paint.overridableProperties){if(!Rh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),r=new Lh(e),n=new un(r,e.property.specification);let i=null;i="constant"===e.value.kind||"source"===e.value.kind?new pn("source",n):new dn("composite",n,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new xs(e.property,i,e.parameters);}}_handleOverridablePaintPropertyUpdate(t,e,r){return !(!this.layout||e.isDataDriven()||r.isDataDriven())&&Rh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const r=t.get("text-field"),n=Fh.paint.properties[e];let i=!1;const s=t=>{for(const e of t)if(n.overrides&&n.overrides.hasOverride(e))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof fe)s(r.value.value.sections);else if("source"===r.value.kind){const t=e=>{i||(e instanceof be&&xe(e.value)===ee?s(e.value.sections):e instanceof ke?s(e.sections):e.eachChild(t));},e=r.value;e._styleExpression&&t(e._styleExpression.expression);}return i}getProgramConfiguration(t){return new Va(this,t)}}var $h={paint:new Ss({"background-color":new bs($t.paint_background["background-color"]),"background-pattern":new As($t.paint_background["background-pattern"]),"background-opacity":new bs($t.paint_background["background-opacity"])})},Uh={paint:new Ss({"raster-opacity":new bs($t.paint_raster["raster-opacity"]),"raster-hue-rotate":new bs($t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bs($t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bs($t.paint_raster["raster-brightness-max"]),"raster-saturation":new bs($t.paint_raster["raster-saturation"]),"raster-contrast":new bs($t.paint_raster["raster-contrast"]),"raster-resampling":new bs($t.paint_raster["raster-resampling"]),"raster-fade-duration":new bs($t.paint_raster["raster-fade-duration"])})};class Oh extends qa{constructor(t){super(t,{}),this.implementation=t;}is3D(){return "3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl);}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl);}}var jh={paint:new Ss({"sky-type":new bs($t.paint_sky["sky-type"]),"sky-atmosphere-sun":new bs($t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new bs($t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new bs($t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new bs($t.paint_sky["sky-gradient-radius"]),"sky-gradient":new ks($t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new bs($t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new bs($t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new bs($t.paint_sky["sky-opacity"])})};function qh(t,e,r){const n=jo(0,0,1),i=tl(Qo());return function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);t[0]=n*l-s*o,t[1]=i*l+a*o,t[2]=s*l+n*o,t[3]=a*l-i*o;}(i,i,r?-c(t)+Math.PI:c(t)),el(i,i,-c(e)),Xo(n,n,i),Go(n,n)}const Nh={circle:class extends qa{constructor(t){super(t,Po);}createBucket(t){return new mo(t)}queryRadius(t){const e=t;return Mo("circle-radius",this,e)+Mo("circle-stroke-width",this,e)+Co(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,r,n,i,s,a,o){const l=Eo(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return nl(t,n,s,a,o,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}getProgramIds(){return ["circle"]}getProgramConfiguration(t){return new Va(this,t)}},heatmap:class extends qa{createBucket(t){return new ll(t)}constructor(t){super(t,fl),this._updateColorRamp();}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp();}_updateColorRamp(){this.colorRamp=yl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null;}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null);}queryRadius(t){return Mo("heatmap-radius",this,t)}queryIntersectsFeature(t,e,r,n,s,a,o,l){const u=this.paint.get("heatmap-radius").evaluate(e,r);return nl(t,n,a,o,l,!0,!0,new i(0,0),u)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return ["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Va(this,t)}},hillshade:class extends qa{constructor(t){super(t,ml);}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return ["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new Va(this,t)}},fill:class extends qa{constructor(t){super(t,nu);}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(t){return new Va(this,t)}recalculate(t,e){super.recalculate(t,e);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"]);}createBucket(t){return new eu(t)}queryRadius(){return Co(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,r,n,i,s){return !t.queryGeometry.isAboveHorizon&&vo(Bo(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),n)}isTileClipped(){return !0}},"fill-extrusion":class extends qa{constructor(t){super(t,_u);}createBucket(t){return new bu(t)}queryRadius(){return Co(this.paint.get("fill-extrusion-translate"))}is3D(){return !0}getProgramIds(){return [this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Va(this,t)}queryIntersectsFeature(t,e,r,n,s,a,o,l,u){const c=Eo(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,t.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(e,r),p=this.paint.get("fill-extrusion-base").evaluate(e,r),d=[0,0],f=l&&a.elevation,y=a.elevation?a.elevation.exaggeration():1;if(f){const e=t.tile.getBucket(this).centroidVertexArray,r=u+1;if(r<e.length){const t=e.get(r);d[0]=t.a_centroid_pos0,d[1]=t.a_centroid_pos1;}}if(0===d[0]&&1===d[1])return !1;const m=function(t,e,r,n,s,a,o,l,u){return a?function(t,e,r,n,i,s,a,o,l){const u=[],c=[],h=[0,0,0,1];for(const p of t){const t=[],d=[];for(const u of p){const c=u.x+n.x,p=u.y+n.y,f=Iu(c,p,e,r,s,a,o,l);h[0]=c,h[1]=p,h[2]=f.base,h[3]=1,Wo(h,h,i),h[3]=Math.max(h[3],1e-5);const y=Su([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);h[0]=c,h[1]=p,h[2]=f.top,h[3]=1,Wo(h,h,i),h[3]=Math.max(h[3],1e-5);const m=Su([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);t.push(y),d.push(m);}u.push(t),c.push(d);}return [u,c]}(t,e,r,n,s,a,o,l,u):function(t,e,r,n,s){const a=[],o=[],l=s[8]*e,u=s[9]*e,c=s[10]*e,h=s[11]*e,p=s[8]*r,d=s[9]*r,f=s[10]*r,y=s[11]*r;for(const e of t){const t=[],r=[];for(const a of e){const e=a.x+n.x,o=a.y+n.y,m=s[0]*e+s[4]*o+s[12],g=s[1]*e+s[5]*o+s[13],x=s[2]*e+s[6]*o+s[14],v=s[3]*e+s[7]*o+s[15],b=m+l,w=g+u,_=x+c,A=Math.max(v+h,1e-5),k=m+p,S=g+d,I=x+f,z=Math.max(v+y,1e-5),T=new i(b/A,w/A);T.z=_/A,t.push(T);const M=new i(k/z,S/z);M.z=I/z,r.push(M);}a.push(t),o.push(r);}return [a,o]}(t,e,r,n,s)}(n,p,h,c,o,f?l:null,d,y,a.center.lat),g=t.queryGeometry;return function(t,e,r){let n=1/0;vo(r,e)&&(n=ku(r,e[0]));for(let i=0;i<e.length;i++){const s=e[i],a=t[i];for(let t=0;t<s.length-1;t++){const e=s[t],i=[e,s[t+1],a[t+1],a[t],e];go(r,i)&&(n=Math.min(n,ku(r,i)));}}return n!==1/0&&n}(m[0],m[1],g.isPointQuery()?g.screenBounds:g.screenGeometry)}},line:class extends qa{constructor(t){super(t,Vu),this.gradientVersion=0;}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof rr,this.gradientVersion=(this.gradientVersion+1)%o;}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Fu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t);}createBucket(t){return new Du(t)}getProgramIds(){return [this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Va(this,t)}queryRadius(t){const e=t,r=Lu(Mo("line-width",this,e),Mo("line-gap-width",this,e)),n=Mo("line-offset",this,e);return r/2+Math.abs(n)+Co(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,r,n,s,a){if(t.queryGeometry.isAboveHorizon)return !1;const o=Bo(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,t.pixelToTileUnitsFactor),l=t.pixelToTileUnitsFactor/2*Lu(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),u=this.paint.get("line-offset").evaluate(e,r);return u&&(n=function(t,e){const r=[],n=new i(0,0);for(let i=0;i<t.length;i++){const s=t[i],a=[];for(let t=0;t<s.length;t++){const r=s[t-1],i=s[t],o=s[t+1],l=0===t?n:i.sub(r)._unit()._perp(),u=t===s.length-1?n:o.sub(i)._unit()._perp(),c=l._add(u)._unit();c._mult(1/(c.x*u.x+c.y*u.y)),a.push(c._mult(e)._add(i));}r.push(a);}return r}(n,u*t.pixelToTileUnitsFactor)),function(t,e,r){for(let n=0;n<e.length;n++){const i=e[n];if(t.length>=3)for(let e=0;e<i.length;e++)if(Io(t,i[e]))return !0;if(bo(t,i,r))return !0}return !1}(o,n,l)}isTileClipped(){return !0}},symbol:Rh,background:class extends qa{constructor(t){super(t,$h);}getProgramIds(){return [this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends qa{constructor(t){super(t,Uh);}getProgramIds(){return ["raster"]}},sky:class extends qa{constructor(t){super(t,jh),this._updateColorRamp();}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0);}_updateColorRamp(){this.colorRamp=yl({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null);}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return !0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const r=this.paint.get("sky-type");if("atmosphere"===r){const r=this.paint.get("sky-atmosphere-sun"),n=!r,i=t.style.light,s=i.properties.get("position");return n&&"viewport"===i.properties.get("anchor")&&E("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?qh(s.azimuthal,90-s.polar,e):qh(r[0],90-r[1],e)}if("gradient"===r){const t=this.paint.get("sky-gradient-center");return qh(t[0],90-t[1],e)}}is3D(){return !1}isSky(){return !0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position");}hasOffscreenPass(){return !0}getProgramIds(){const t=this.paint.get("sky-type");return "atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:Zh,HTMLCanvasElement:Gh,HTMLVideoElement:Xh,ImageData:Kh,ImageBitmap:Yh}=a;class Hh{constructor(t,e,r,n){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,n);}update(t,e,r){const{width:n,height:i}=t,{context:s}=this,{gl:a}=s;if(a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),r||this.size&&this.size[0]===n&&this.size[1]===i){const{x:e,y:s}=r||{x:0,y:0};t instanceof Zh||t instanceof Gh||t instanceof Xh||t instanceof Kh||Yh&&t instanceof Yh?a.texSubImage2D(a.TEXTURE_2D,0,e,s,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,s,n,i,a.RGBA,a.UNSIGNED_BYTE,t.data);}else this.size=[n,i],t instanceof Zh||t instanceof Gh||t instanceof Xh||t instanceof Kh||Yh&&t instanceof Yh?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,i,0,this.format,a.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(e&&e.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D);}bind(t,e){const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap?t===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_NEAREST:t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e);}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null;}}class Jh{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new pl({width:t,height:e}),this.positions={},this.uploaded=!1;}getDash(t,e){const r=this.getKey(t,e);return this.positions[r]}trim(){const t=this.width,e=this.height=k(this.nextRow);this.image.resize({width:t,height:e});}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,r){const n=[];let i=t.length%2==1?-t[t.length-1]*r:0,s=t[0]*r,a=!0;n.push({left:i,right:s,isDash:a,zeroLength:0===t[0]});let o=t[0];for(let e=1;e<t.length;e++){a=!a;const l=t[e];i=o*r,o+=l,s=o*r,n.push({left:i,right:s,isDash:a,zeroLength:0===l});}return n}addRoundDash(t,e,r){const n=e/2;for(let e=-r;e<=r;e++){const i=this.width*(this.nextRow+r+e);let s=0,a=t[s];for(let o=0;o<this.width;o++){o/a.right>1&&(a=t[++s]);const l=Math.abs(o-a.left),u=Math.abs(o-a.right),c=Math.min(l,u);let h;const p=e/r*(n+1);if(a.isDash){const t=n-Math.abs(p);h=Math.sqrt(c*c+t*t);}else h=n-Math.sqrt(c*c+p*p);this.image.data[i+o]=Math.max(0,Math.min(255,h+128));}}}addRegularDash(t,e){for(let e=t.length-1;e>=0;--e){const r=t[e],n=t[e+1];r.zeroLength?t.splice(e,1):n&&n.isDash===r.isDash&&(n.left=r.left,t.splice(e,1));}const r=t[0],n=t[t.length-1];r.isDash===n.isDash&&(r.left=n.left-this.width,n.right=r.right+this.width);const i=this.width*this.nextRow;let s=0,a=t[s];for(let r=0;r<this.width;r++){r/a.right>1&&(a=t[++s]);const n=Math.abs(r-a.left),o=Math.abs(r-a.right),l=Math.min(n,o);this.image.data[i+r]=Math.max(0,Math.min(255,(a.isDash?l:-l)+e+128));}}addDash(t,e){const r=this.getKey(t,e);if(this.positions[r])return this.positions[r];const n="round"===e,i=n?7:0,s=2*i+1;if(this.nextRow+s>this.height)return E("LineAtlas out of space"),null;0===t.length&&t.push(1);let a=0;for(let e=0;e<t.length;e++)t[e]<0&&(E("Negative value is found in line dasharray, replacing values with 0"),t[e]=0),a+=t[e];if(0!==a){const r=this.width/a,s=this.getDashRanges(t,this.width,r);n?this.addRoundDash(s,r,i):this.addRegularDash(s,"square"===e?.5*r:0);}const o=this.nextRow+i;this.nextRow+=s;const l={tl:[o,i],br:[a,0]};return this.positions[r]=l,l}}pi("LineAtlas",Jh);class Wh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback();});}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback();}),0));}remove(){delete this._channel,this._callback=()=>{};}}const Qh=a.performance;function tp(t){const e=t?t.url.toString():void 0;return Qh.getEntriesByName(e)}class ep{constructor(){this.tasks={},this.taskQueue=[],I(["process"],this),this.invoker=new Wh(this.process),this.nextId=0;}add(t,e){const r=this.nextId++,n=function({type:t,isSymbolTile:e,zoom:r}){return r=r||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-r:"maybePrepare"===t&&e?400-r:500:200-r:100-r}(e);if(0===n){V();try{t();}finally{}return {cancel:()=>{}}}return this.tasks[r]={fn:t,metadata:e,priority:n,id:r},this.taskQueue.push(r),this.invoker.trigger(),{cancel:()=>{delete this.tasks[r];}}}process(){V();try{if(this.taskQueue=this.taskQueue.filter((t=>!!this.tasks[t])),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn();}finally{}}pick(){let t=null,e=1/0;for(let r=0;r<this.taskQueue.length;r++){const n=this.tasks[this.taskQueue[r]];n.priority<e&&(e=n.priority,t=r);}if(null===t)return null;const r=this.taskQueue[t];return this.taskQueue.splice(t,1),r}remove(){this.invoker.remove();}}function rp(t,e){const r=Math.pow(2,-t.z),n=t.x*r,i=(t.x+1)*r,s=t.y*r,a=(t.y+1)*r;if("mercator"===e.name)return {scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const o=ro(n),l=ro(i),u=no(s),c=no(a),h=e.project(o,u),p=e.project(l,u),d=e.project(l,c),f=e.project(o,c);let y=Math.min(h.x,p.x,d.x,f.x),m=Math.min(h.y,p.y,d.y,f.y),g=Math.max(h.x,p.x,d.x,f.x),x=Math.max(h.y,p.y,d.y,f.y);const v=r/16;function b(t,r,n,i,s,a){const o=(n+s)/2,l=(i+a)/2,u=e.project(ro(o),no(l)),c=Math.max(0,y-u.x,m-u.y,u.x-g,u.y-x);y=Math.min(y,u.x),g=Math.max(g,u.x),m=Math.min(m,u.y),x=Math.max(x,u.y),c>v&&(b(t,u,n,i,o,l),b(u,r,o,l,s,a));}b(h,p,n,s,i,s),b(p,d,i,s,i,a),b(d,f,i,a,n,a),b(f,h,n,a,n,s),y-=v,m-=v,g+=v,x+=v;const w=1/Math.max(g-y,x-m);return {scale:w,x:y*w,y:m*w,x2:g*w,y2:x*w,projection:e}}function np(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return [t*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}class ip{constructor(t,e,r){this.z=t,this.x=e,this.y=r,this.key=op(0,t,t,e,r);}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const r=(i=this.y,s=this.z,a=np(256*(n=this.x),256*(i=Math.pow(2,s)-i-1),s),o=np(256*(n+1),256*(i+1),s),a[0]+","+a[1]+","+o[0]+","+o[1]);var n,i,s,a,o;const l=function(t,e,r){let n,i="";for(let s=t;s>0;s--)n=1<<s-1,i+=(e&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",r)}toString(){return `${this.z}/${this.x}/${this.y}`}}class sp{constructor(t,e){this.wrap=t,this.canonical=e,this.key=op(t,e.z,e.z,e.x,e.y);}}class ap{constructor(t,e,r,n,i){this.overscaledZ=t,this.wrap=e,this.canonical=new ip(r,+n,+i),this.key=0===e&&t===r?this.canonical.key:op(e,t,r,n,i);}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new ap(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ap(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return op(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-t;return op(this.wrap*+e,t,t,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(t){if(t.wrap!==this.wrap)return !1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return [new ap(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return [new ap(e,this.wrap,e,r,n),new ap(e,this.wrap,e,r+1,n),new ap(e,this.wrap,e,r,n+1),new ap(e,this.wrap,e,r+1,n+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ap(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ap(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sp(this.wrap,this.canonical)}toString(){return `${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function op(t,e,r,n,i){const s=1<<Math.min(r,22);let a=s*(i%s)+n%s;return t&&r<22&&(a+=s*s*((t<0?-2*t-1:2*t)%(1<<2*(22-r)))),16*(32*a+r)+(e-r)}pi("CanonicalTileID",ip),pi("OverscaledTileID",ap,{omit:["projMatrix"]});class lp{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r;}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class up{constructor(t,e,r,n,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=n,this.properties=t.properties,this.id=i;}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t;}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}var cp=Cs([{name:"a_pos",type:"Int16",components:2}]);const hp=32,pp=33,dp=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,r=0,n=0,i=0,s=0,a=0,o=0;for(1&e?i=s=a=hp:r=n=o=hp;(e>>=1)>1;){const t=r+i>>1,l=n+s>>1;1&e?(i=r,s=n,r=a,n=o):(r=i,n=s,i=a,s=o),a=t,o=l;}const l=4*t;dp[l+0]=r,dp[l+1]=n,dp[l+2]=i,dp[l+3]=s;}const fp=new Uint16Array(2178),yp=new Uint8Array(1089),mp=new Uint16Array(1089);function gp(t){return 0===t?-.03125:32===t?.03125:0}var xp=Cs([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const vp={type:2,extent:Xa,loadGeometry:()=>[[new i(0,0),new i(8193,0),new i(8193,8193),new i(0,8193),new i(0,0)]]};class bp{constructor(t,e,r,n,i){this.tileID=t,this.uid=_(),this.uses=0,this.tileSize=e,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=i,this.expiredRequestCount=0,this.state="loading",n&&n.transform&&(this.projection=n.transform.projection);}registerFadeDuration(t){const e=t+this.timeAdded;e<q.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e);}wasRequested(){return "errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=rp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,e,r){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const r={};if(!e)return r;for(const n of t){const t=n.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){n.layers=t,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)r[e.id]=n;}}return r}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Ph){if(this.hasSymbolBuckets=!0,!r)break;e.justReloaded=!0;}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Ph&&e.hasRTLText){this.hasRTLText=!0,cs.isLoading()||cs.isLoaded()||"deferred"!==ls()||us();break}}this.queryPadding=0;for(const t in this.buckets){const r=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(r));}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas);}else this.collisionBoxArray=new ea;}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.latestFeatureIndex=null,this.state="unloaded";}}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const r=this.buckets[e];r.uploadPending()&&r.upload(t);}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Hh(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Hh(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Hh(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0);}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture);}queryRenderedFeatures(t,e,r,n,i,s,a,o){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:a,transform:s,params:i,tileTransform:this.tileTransform},t,e,r):{}}querySourceFeatures(t,e){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const n=r.loadVTLayers(),i=e?e.sourceLayer:"",s=n._geojsonTileLayer||n[i];if(!s)return;const a=Sn(e&&e.filter),{z:o,x:l,y:u}=this.tileID.canonical,c={z:o,x:l,y:u};for(let e=0;e<s.length;e++){const n=s.feature(e);if(a.needGeometry){const t=fo(n,!0);if(!a.filter(new hs(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!a.filter(new hs(this.tileID.overscaledZ),n))continue;const h=r.getId(n,i),p=new up(n,o,l,u,h);p.tile=c,t.push(p);}}hasData(){return "loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=F(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"]);}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let r=!1;if(this.expirationTime>t)r=!1;else if(e)if(this.expirationTime<e)r=!0;else {const n=this.expirationTime-e;n?this.expirationTime=t+Math.max(n,3e4):r=!0;}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0;}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length||!e)return;const r=this.latestFeatureIndex.loadVTLayers(),n=e.style.listImages();for(const i in this.buckets){if(!e.style.hasLayer(i))continue;const s=this.buckets[i],a=s.layers[0].sourceLayer||"_geojsonTileLayer",o=r[a],l=t[a];if(!o||!l||0===Object.keys(l).length)continue;if(s.update(l,o,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),s instanceof Du||s instanceof eu){const t=e.style._getSourceCache(s.layers[0].source);e._terrain&&e._terrain.enabled&&t&&s.programConfigurations.needsUpload&&e._terrain._clearRenderCacheForTile(t.id,this.tileID);}const u=e&&e.style&&e.style.getLayer(i);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(s)));}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return !this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0;}setHoldDuration(t){this.symbolFadeHoldUntil=q.now()+t;}setDependencies(t,e){const r={};for(const t of e)r[t]=!0;this.dependencies[t]=r;}hasDependency(t,e){for(const r of t){const t=this.dependencies[r];if(t)for(const r of e)if(t[r])return !0}return !1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,e){if(!e||"mercator"===e.name||this._tileDebugBuffer)return;const r=po(vp,this.tileID.canonical,this.tileTransform)[0],n=new Es,i=new Js;for(let t=0;t<r.length;t++){const{x:e,y:s}=r[t];n.emplaceBack(e,s),i.emplaceBack(t);}i.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(i),this._tileDebugBuffer=t.createVertexBuffer(n,xp.members),this._tileDebugSegments=Ga.simpleSegment(0,0,n.length,i.length);}_makeTileBoundsBuffers(t,e){if(this._tileBoundsBuffer||!e||"mercator"===e.name)return;const r=po(vp,this.tileID.canonical,this.tileTransform)[0];let n,i;if(this.isRaster){const t=function(t,e){const r=rp(t,e),n=Math.pow(2,t.z);for(let i=0;i<pp;i++)for(let s=0;s<pp;s++){const a=ro((t.x+(s+gp(s))/hp)/n),o=no((t.y+(i+gp(i))/hp)/n),l=e.project(a,o),u=i*pp+s;fp[2*u+0]=Math.round((l.x*r.scale-r.x)*Xa),fp[2*u+1]=Math.round((l.y*r.scale-r.y)*Xa);}yp.fill(0),mp.fill(0);for(let t=2045;t>=0;t--){const e=4*t,r=dp[e+0],n=dp[e+1],i=dp[e+2],s=dp[e+3],a=r+i>>1,o=n+s>>1,l=a+o-n,u=o+r-a,c=n*pp+r,h=s*pp+i,p=o*pp+a,d=Math.hypot((fp[2*c+0]+fp[2*h+0])/2-fp[2*p+0],(fp[2*c+1]+fp[2*h+1])/2-fp[2*p+1])>=16;if(yp[p]=yp[p]||(d?1:0),t<1022){const t=(n+u>>1)*pp+(r+l>>1),e=(s+u>>1)*pp+(i+l>>1);yp[p]=yp[p]||yp[t]||yp[e];}}const i=new Ds,s=new Ns;let a=0;function o(t,e){const r=e*pp+t;return 0===mp[r]&&(i.emplaceBack(fp[2*r+0],fp[2*r+1],t*Xa/hp,e*Xa/hp),mp[r]=++a),mp[r]-1}function l(t,e,r,n,i,a){const u=t+r>>1,c=e+n>>1;if(Math.abs(t-i)+Math.abs(e-a)>1&&yp[c*pp+u])l(i,a,t,e,u,c),l(r,n,i,a,u,c);else {const l=o(t,e),u=o(r,n),c=o(i,a);s.emplaceBack(l,u,c);}}return l(0,0,hp,hp,hp,0),l(hp,hp,0,0,0,hp),{vertices:i,indices:s}}(this.tileID.canonical,e);n=t.vertices,i=t.indices;}else {n=new Ds,i=new Ns;for(const{x:t,y:e}of r)n.emplaceBack(t,e,0,0);const t=vl(n.int16,void 0,4);for(let e=0;e<t.length;e+=3)i.emplaceBack(t[e],t[e+1],t[e+2]);}this._tileBoundsBuffer=t.createVertexBuffer(n,xp.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(i),this._tileBoundsSegments=Ga.simpleSegment(0,0,n.length,i.length);}}class wp{constructor(){this.state={},this.stateChanges={},this.deletedStates={};}updateState(t,e,r){const n=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},b(this.stateChanges[t][n],r),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==n&&(this.deletedStates[t][e]=null);}else if(this.deletedStates[t]&&null===this.deletedStates[t][n]){this.deletedStates[t][n]={};for(const e in this.state[t][n])r[e]||(this.deletedStates[t][n][e]=null);}else for(const e in r)this.deletedStates[t]&&this.deletedStates[t][n]&&null===this.deletedStates[t][n][e]&&delete this.deletedStates[t][n][e];}removeFeatureState(t,e,r){if(null===this.deletedStates[t])return;const n=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&void 0!==e)null!==this.deletedStates[t][n]&&(this.deletedStates[t][n]=this.deletedStates[t][n]||{},this.deletedStates[t][n][r]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][n])for(r in this.deletedStates[t][n]={},this.stateChanges[t][n])this.deletedStates[t][n][r]=null;else this.deletedStates[t][n]=null;else this.deletedStates[t]=null;}getState(t,e){const r=String(e),n=b({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(null===this.deletedStates[t])return {};if(this.deletedStates[t]){const r=this.deletedStates[t][e];if(null===r)return {};for(const t in r)delete n[t];}return n}initializeTileState(t,e){t.setFeatureState(this.state,e);}coalesceChanges(t,e){const r={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const r in this.stateChanges[t])this.state[t][r]||(this.state[t][r]={}),b(this.state[t][r],this.stateChanges[t][r]),e[r]=this.state[t][r];r[t]=e;}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const r in this.state[t])e[r]={},this.state[t][r]={};else for(const r in this.deletedStates[t]){if(null===this.deletedStates[t][r])this.state[t][r]={};else for(const e of Object.keys(this.deletedStates[t][r]))delete this.state[t][r][e];e[r]=this.state[t][r];}r[t]=r[t]||{},b(r[t],e);}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const n in t)t[n].setFeatureState(r,e);}}class _p{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[];}getElevation(t,e){const r=this.toIdx(t,e);return {min:this.minimums[r],max:this.maximums[r]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function Ap(t,e,r,n){let i=0,s=Number.MAX_VALUE;for(let a=0;a<3;a++)if(Math.abs(n[a])<1e-15){if(r[a]<t[a]||r[a]>e[a])return null}else {const o=1/n[a];let l=(t[a]-r[a])*o,u=(e[a]-r[a])*o;if(l>u){const t=l;l=u,u=t;}if(l>i&&(i=l),u<s&&(s=u),i>s)return null}return i}function kp(t,e,r,n,i,s,a,o,l,u,c){const h=n-t,p=i-e,d=s-r,f=a-t,y=o-e,m=l-r,g=c[1]*m-c[2]*y,x=c[2]*f-c[0]*m,v=c[0]*y-c[1]*f,b=h*g+p*x+d*v;if(Math.abs(b)<1e-15)return null;const w=1/b,_=u[0]-t,A=u[1]-e,k=u[2]-r,S=(_*g+A*x+k*v)*w;if(S<0||S>1)return null;const I=A*d-k*p,z=k*h-_*d,T=_*p-A*h,M=(c[0]*I+c[1]*z+c[2]*T)*w;return M<0||S+M>1?null:(f*I+y*z+m*T)*w}function Sp(t,e,r){return (t-e)/(r-e)}function Ip(t,e,r,n,i,s,a,o,l){const u=1<<r,c=s-n,h=a-i,p=(t+1)/u*c+n,d=(e+0)/u*h+i,f=(e+1)/u*h+i;o[0]=(t+0)/u*c+n,o[1]=d,l[0]=p,l[1]=f;}class zp{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),r=[];let n=Math.ceil(Math.pow(2,e));const i=1/n,s=(t,e,r,n,i)=>{const s=n?1:0,a=(t+1)*r-s,o=e*r,l=(e+1)*r-s;i[0]=t*r,i[1]=o,i[2]=a,i[3]=l;};let a=new _p(n);const o=[];for(let e=0;e<n*n;e++){s(e%n,Math.floor(e/n),i,!1,o);const r=Mp(o[0],o[1],t),l=Mp(o[2],o[1],t),u=Mp(o[2],o[3],t),c=Mp(o[0],o[3],t);a.minimums.push(Math.min(r,l,u,c)),a.maximums.push(Math.max(r,l,u,c)),a.leaves.push(1);}for(r.push(a),n/=2;n>=1;n/=2){const t=r[r.length-1];a=new _p(n);for(let e=0;e<n*n;e++){s(e%n,Math.floor(e/n),2,!0,o);const r=t.getElevation(o[0],o[1]),i=t.getElevation(o[2],o[1]),l=t.getElevation(o[2],o[3]),u=t.getElevation(o[0],o[3]),c=t.isLeaf(o[0],o[1]),h=t.isLeaf(o[2],o[1]),p=t.isLeaf(o[2],o[3]),d=t.isLeaf(o[0],o[3]),f=Math.min(r.min,i.min,l.min,u.min),y=Math.max(r.max,i.max,l.max,u.max),m=c&&h&&p&&d;a.maximums.push(y),a.minimums.push(f),a.leaves.push(y-f<=5&&m?1:0);}r.push(a);}return r}(this.dem),r=e.length-1,n=e[r];this._addNode(n.minimums[0],n.maximums[0],n.leaves[0]),this._construct(e,0,0,r,0);}raycastRoot(t,e,r,n,i,s,a=1){return Ap([t,e,-100],[r,n,this.maximums[0]*a],i,s)}raycast(t,e,r,n,i,s,a=1){if(!this.nodeCount)return null;const o=this.raycastRoot(t,e,r,n,i,s,a);if(null==o)return null;const l=[],u=[],c=[],h=[],p=[{idx:0,t:o,nodex:0,nodey:0,depth:0}];for(;p.length>0;){const{idx:o,t:d,nodex:f,nodey:y,depth:m}=p.pop();if(this.leaves[o]){Ip(f,y,m,t,e,r,n,c,h);const o=1<<m,l=(f+0)/o,u=(f+1)/o,p=(y+0)/o,g=(y+1)/o,x=Mp(l,p,this.dem)*a,v=Mp(u,p,this.dem)*a,b=Mp(u,g,this.dem)*a,w=Mp(l,g,this.dem)*a,_=kp(c[0],c[1],x,h[0],c[1],v,h[0],h[1],b,i,s),A=kp(h[0],h[1],b,c[0],h[1],w,c[0],c[1],x,i,s),k=Math.min(null!==_?_:Number.MAX_VALUE,null!==A?A:Number.MAX_VALUE);if(k!==Number.MAX_VALUE)return k;{const t=Zo([],i,s,d);if(Tp(x,v,w,b,Sp(t[0],c[0],h[0]),Sp(t[1],c[1],h[1]))>=t[2])return d}continue}let g=0;for(let p=0;p<this._siblingOffset.length;p++){Ip((f<<1)+this._siblingOffset[p][0],(y<<1)+this._siblingOffset[p][1],m+1,t,e,r,n,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[o]+p]*a;const d=Ap(c,h,i,s);if(null!=d){const t=d;l[p]=t;let e=!1;for(let r=0;r<g&&!e;r++)t>=l[u[r]]&&(u.splice(r,0,p),e=!0);e||(u[g]=p),g++;}}for(let t=0;t<g;t++){const e=u[t];p.push({idx:this.childOffsets[o]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(y<<1)+this._siblingOffset[e][1],depth:m+1});}}return null}_addNode(t,e,r){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,r,n,i){if(1===t[n].isLeaf(e,r))return;this.childOffsets[i]||(this.childOffsets[i]=this.nodeCount);const s=n-1,a=t[s];let o,l=0;for(let t=0;t<this._siblingOffset.length;t++){const n=2*e+this._siblingOffset[t][0],i=2*r+this._siblingOffset[t][1],s=a.getElevation(n,i),u=a.isLeaf(n,i),c=this._addNode(s.min,s.max,u);u&&(l|=1<<t),o||(o=c);}for(let n=0;n<this._siblingOffset.length;n++)l&1<<n||this._construct(t,2*e+this._siblingOffset[n][0],2*r+this._siblingOffset[n][1],s,o+n);}}function Tp(t,e,r,n,i,s){return nr(nr(t,r,s),nr(e,n,s),i)}function Mp(t,e,r){const n=r.dim,i=m(t*n-.5,0,n-1),s=m(e*n-.5,0,n-1),a=Math.floor(i),o=Math.floor(s),l=Math.min(a+1,n-1),u=Math.min(o+1,n-1);return Tp(r.get(a,o),r.get(l,o),r.get(a,u),r.get(l,u),i-a,s-o)}const Cp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Bp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,r,n=!1,i=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return E(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const s=this.dim=e.height-2;if(this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox",this.borderReady=n,!n){for(let t=0;t<s;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(s,t)]=this.data[this._idx(s-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,s)]=this.data[this._idx(t,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],i&&this._buildQuadTree();}}_buildQuadTree(){this._tree=new zp(this);}get(t,e,r=!1){const n=new Uint8Array(this.data.buffer);r&&(t=m(t,-1,this.dim),e=m(e,-1,this.dim));const i=4*this._idx(t,e);return ("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[i],n[i+1],n[i+2])}static getUnpackVector(t){return Cp[t]}get unpackVector(){return Cp[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return (e+1)*this.stride+(t+1)}_unpackMapbox(t,e,r){return (256*t*256+256*e+r)/10-1e4}_unpackTerrarium(t,e,r){return 256*t+e+r/256-32768}static pack(t,e){const r=[0,0,0,0],n=Bp.getUnpackVector(e);let i=Math.floor((t+n[3])/n[2]);return r[2]=i%256,i=Math.floor(i/256),r[1]=i%256,i=Math.floor(i/256),r[0]=i,r}getPixels(){return new dl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let n=e*this.dim,i=e*this.dim+this.dim,s=r*this.dim,a=r*this.dim+this.dim;switch(e){case-1:n=i-1;break;case 1:i=n+1;}switch(r){case-1:s=a-1;break;case 1:a=s+1;}const o=-e*this.dim,l=-r*this.dim;for(let e=s;e<a;e++)for(let r=n;r<i;r++)this.data[this._idx(r,e)]=t.data[this._idx(r+o,e+l)];}onDeserialize(){this._tree&&(this._tree.dem=this);}}pi("DEMData",Bp),pi("DemMinMaxQuadTree",zp,{omit:["dem"]});class Ep{constructor(t,e){this.max=t,this.onRemove=e,this.reset();}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,r){const n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:e,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(t,i);}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t);}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const r=t.wrapped().key,n=void 0===e?0:this.data[r].indexOf(e),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t);}return this}filter(t){const e=[];for(const r in this.data)for(const n of this.data[r])t(n.value)||e.push(n);for(const t of e)this.remove(t.value.tileID,t);}}class Dp{constructor(t,e,r){this.func=t,this.mask=e,this.range=r;}}Dp.ReadOnly=!1,Dp.ReadWrite=!0,Dp.disabled=new Dp(519,Dp.ReadOnly,[0,1]);const Pp=7680;class Vp{constructor(t,e,r,n,i,s){this.test=t,this.ref=e,this.mask=r,this.fail=n,this.depthFail=i,this.pass=s;}}Vp.disabled=new Vp({func:519,mask:0},0,0,Pp,Pp,Pp);class Fp{constructor(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r;}}Fp.Replace=[1,0],Fp.disabled=new Fp(Fp.Replace,he.transparent,[!1,!1,!1,!1]),Fp.unblended=new Fp(Fp.Replace,he.transparent,[!0,!0,!0,!0]),Fp.alphaBlended=new Fp([1,771],he.transparent,[!0,!0,!0,!0]);const Lp=1029,Rp=2305;class $p{constructor(t,e,r){this.enable=t,this.mode=e,this.frontFace=r;}}$p.disabled=new $p(!1,Lp,Rp),$p.backCCW=new $p(!0,Lp,Rp),$p.backCW=new $p(!0,Lp,2304),$p.frontCW=new $p(!0,1028,2304),$p.frontCCW=new $p(!0,1028,Rp);class Up extends Rt{constructor(t,e,r){super(),this.id=t,this._onlySymbols=r,e.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform));})),e.on("error",(()=>{this._sourceErrored=!0;})),this._source=e,this._tiles={},this._cache=new Ep(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wp;}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null;}loaded(){if(this._sourceErrored)return !0;if(!this._sourceLoaded)return !1;if(!this._source.loaded())return !1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return !1}return !0}getSource(){return this._source}pause(){this._paused=!0;}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform);}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,(()=>{}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const r=this._tiles[e];r.upload(t),r.prepare(this.map.style.imageManager);}}getIds(){return v(this._tiles).map((t=>t.tileID)).sort(Op).map((t=>t.key))}getRenderableIds(t){const e=[];for(const r in this._tiles)this._isIdRenderable(+r,t)&&e.push(this._tiles[r]);return t?e.sort(((t,e)=>{const r=t.tileID,n=e.tileID,s=new i(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),a=new i(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-n.overscaledZ||a.y-s.y||a.x-s.x})).map((t=>t.tileID.key)):e.map((t=>t.tileID)).sort(Op).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return !!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else {this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading");}}_reloadTile(t,e){const r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)));}_tileLoaded(t,e,r,n){if(n)return t.state="errored",void(404!==n.status?this._source.fire(new Lt(n,{tile:t})):this.update(this.transform));t.timeAdded=q.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Ft("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}));}_backfillDEM(t){const e=this.getRenderableIds();for(let n=0;n<e.length;n++){const i=e[n];if(t.neighboringTiles&&t.neighboringTiles[i]){const e=this.getTileByID(i);r(t,e),r(e,t);}}function r(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let r=e.tileID.canonical.x-t.tileID.canonical.x;const n=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),s=e.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,n),t.neighboringTiles&&t.neighboringTiles[s]&&(t.neighboringTiles[s].backfilled=!0)));}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,r,n){for(const i in this._tiles){let s=this._tiles[i];if(n[i]||!s.hasData()||s.tileID.overscaledZ<=e||s.tileID.overscaledZ>r)continue;let a=s.tileID;for(;s&&s.tileID.overscaledZ>e+1;){const t=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[t.key],s&&s.hasData()&&(a=t);}let o=a;for(;o.overscaledZ>e;)if(o=o.scaledTo(o.overscaledZ-1),t[o.key]){n[a.key]=a;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const r=this._loadedParentTiles[t.key];return r&&r.tileID.overscaledZ>=e?r:null}for(let r=t.overscaledZ-1;r>=e;r--){const e=t.scaledTo(r),n=this._getLoadedTile(e);if(n)return n}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const r=Math.ceil(t.width/e)+1,n=Math.ceil(t.height/e)+1,i=Math.floor(r*n*5),s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(s);}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),t[n.tileID.key]=n;}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t]);}}update(t,e,r){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!r)return;let n;this.updateCacheSize(t,e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new ap(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(n=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(n=n.filter((t=>this._source.hasTile(t))))):n=[];const i=this._updateRetainedTiles(n);if(jp(this._source.type)&&0!==n.length){const t={},e={},r=Object.keys(i);for(const n of r){const r=i[n],s=this._tiles[n];if(!s||s.fadeEndTime&&s.fadeEndTime<=q.now())continue;const a=this.findLoadedParent(r,Math.max(r.overscaledZ-Up.maxOverzooming,this._source.minzoom));a&&(this._addTile(a.tileID),t[a.tileID.key]=a.tileID),e[n]=r;}const s=n[n.length-1].overscaledZ;for(const t in this._tiles){const r=this._tiles[t];if(i[t]||!r.hasData())continue;let n=r.tileID;for(;n.overscaledZ>s;){n=n.scaledTo(n.overscaledZ-1);const s=this._tiles[n.key];if(s&&s.hasData()&&e[n.key]){i[t]=r.tileID;break}}}for(const e in t)i[e]||(this._coveredTiles[e]=!0,i[e]=t[e]);}for(const t in i)this._tiles[t].clearFadeHold();const s=function(t,e){const r=[];for(const n in t)n in e||r.push(n);return r}(this._tiles,i);for(const t of s){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+t);}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate();}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t);}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const r={},n=t.reduce(((t,e)=>Math.min(t,e.overscaledZ)),1/0),i=t[0].overscaledZ,s=Math.max(i-Up.maxOverzooming,this._source.minzoom),a=Math.max(i+Up.maxUnderzooming,this._source.minzoom),o={};for(const r of t){const t=this._addTile(r);e[r.key]=r,t.hasData()||n<this._source.maxzoom&&(o[r.key]=r);}this._retainLoadedChildren(o,n,a,e);for(const n of t){let t=this._tiles[n.key];if(t.hasData())continue;if(n.canonical.z>=this._source.maxzoom){const t=n.children(this._source.maxzoom)[0],r=this.getTile(t);if(r&&r.hasData()){e[t.key]=t;continue}}else {const t=n.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let i=t.wasRequested();for(let a=n.overscaledZ-1;a>=s;--a){const s=n.scaledTo(a);if(r[s.key])break;if(r[s.key]=!0,t=this.getTile(s),!t&&i&&(t=this._addTile(s)),t&&(e[s.key]=s,i=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let r,n=this._tiles[t].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}e.push(n.key);const t=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(t),r)break;n=t;}for(const t of e)this._loadedParentTiles[t]=r;}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const r=Boolean(e);if(!r){const r=this.map?this.map.painter:null;e=new bp(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,r,"raster"===this._source.type||"raster-dem"===this._source.type),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state));}return e?(e.uses++,this._tiles[t.key]=e,r||this._source.fire(new Ft("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t];}),r));}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))));}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset();}tilesIn(t,e,r){const n=[],i=this.transform;if(!i)return n;for(const s in this._tiles){const a=this._tiles[s];if(r&&a.clearQueryDebugViz(),a.holdingForFade())continue;const o=t.containsTile(a,i,e);o&&n.push(o);}return n}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.projMatrix=this.transform.calculateProjMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return !0;if(jp(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=q.now())return !0}return !1}setFeatureState(t,e,r){this._state.updateState(t=t||"_geojsonTileLayer",e,r);}removeFeatureState(t,e,r){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,r);}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,r){const n=this._tiles[t];n&&n.setDependencies(e,r);}reloadTilesForDependencies(t,e){for(const r in this._tiles)this._tiles[r].hasDependency(t,e)&&this._reloadTile(+r,"reloading");this._cache.filter((r=>!r.hasDependency(t,e)));}}function Op(t,e){const r=Math.abs(2*t.wrap)-+(t.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||n-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function jp(t){return "raster"===t||"image"===t||"video"===t}Up.maxOverzooming=10,Up.maxUnderzooming=3;class qp{constructor(t,e,r){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=r;}static create(t,e,r){const n=r||t.findDEMTileFor(e);if(!n||!n.dem)return;const i=n.dem,s=n.tileID,a=1<<e.canonical.z-s.canonical.z;return new qp(n,n.tileSize/Xa/a,[(e.canonical.x/a-s.canonical.x)*i.dim,(e.canonical.y/a-s.canonical.y)*i.dim])}tileCoordToPixel(t,e){const r=e*this._scale+this._offset[1],n=Math.floor(t*this._scale+this._offset[0]),s=Math.floor(r);return new i(n,s)}getElevationAt(t,e,r,n){const i=t*this._scale+this._offset[0],s=e*this._scale+this._offset[1],a=Math.floor(i),o=Math.floor(s),l=this._dem;return n=!!n,r?nr(nr(l.get(a,o,n),l.get(a,o+1,n),s-o),nr(l.get(a+1,o,n),l.get(a+1,o+1,n),s-o),i-a):l.get(a,o,n)}getElevationAtPixel(t,e,r){return this._dem.get(t,e,!!r)}getMeterToDEM(t){return (1<<this._demTile.tileID.canonical.z)*eo(1,t)*this._dem.stride}}class Np{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new oi(Xa,16,0),this.featureIndexArray=new ua,this.promoteId=e;}insert(t,e,r,n,i,s=0){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i,s);const o=this.grid;for(let t=0;t<e.length;t++){const r=e[t],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<r.length;t++){const e=r[t];n[0]=Math.min(n[0],e.x),n[1]=Math.min(n[1],e.y),n[2]=Math.max(n[2],e.x),n[3]=Math.max(n[3],e.y);}n[0]<Xa&&n[1]<Xa&&n[2]>=0&&n[3]>=0&&o.insert(a,n[0],n[1],n[2],n[3]);}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new yu.VectorTile(new rc(this.rawTileData)).layers,this.sourceLayerCoder=new lp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[];}return this.vtLayers}query(t,e,r,n){this.loadVTLayers();const i=t.params||{},s=Sn(i.filter),a=t.tileResult,o=t.transform,l=a.bufferedTilespaceBounds,u=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((t,e,r,n)=>zo(a.bufferedTilespaceGeometry,t,e,r,n)));u.sort(Gp);let c=null;o.elevation&&u.length>0&&(c=qp.create(o.elevation,this.tileID));const h={};let p;for(let o=0;o<u.length;o++){const l=u[o];if(l===p)continue;p=l;const d=this.featureIndexArray.get(l);let f=null;this.loadMatchingFeature(h,d,s,i.layers,i.availableImages,e,r,n,((e,r,n,i=0)=>(f||(f=po(e,this.tileID.canonical,t.tileTransform)),r.queryIntersectsFeature(a,e,n,f,this.z,t.transform,t.pixelPosMatrix,c,i))));}return h}loadMatchingFeature(t,e,r,n,i,s,a,o,l){const{featureIndex:u,bucketIndex:c,sourceLayerIndex:h,layoutVertexArrayOffset:p}=e,d=this.bucketLayerIDs[c];if(n&&!function(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return !0;return !1}(n,d))return;const f=this.sourceLayerCoder.decode(h),y=this.vtLayers[f].feature(u);if(r.needGeometry){const t=fo(y,!0);if(!r.filter(new hs(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!r.filter(new hs(this.tileID.overscaledZ),y))return;const m=this.getId(y,f);for(let e=0;e<d.length;e++){const r=d[e];if(n&&n.indexOf(r)<0)continue;const c=s[r];if(!c)continue;let h={};void 0!==m&&o&&(h=o.getState(c.sourceLayer||"_geojsonTileLayer",m));const f=b({},a[r]);f.paint=Zp(f.paint,c.paint,y,h,i),f.layout=Zp(f.layout,c.layout,y,h,i);const g=!l||l(y,c,h,p);if(!g)continue;const x=new up(y,this.z,this.x,this.y,m);x.layer=f;let v=t[r];void 0===v&&(v=t[r]=[]),v.push({featureIndex:u,feature:x,intersectionZ:g});}}lookupSymbolFeatures(t,e,r,n,i,s,a,o){const l={};this.loadVTLayers();const u=Sn(i);for(const i of t)this.loadMatchingFeature(l,{bucketIndex:r,sourceLayerIndex:n,featureIndex:i,layoutVertexArrayOffset:0},u,s,a,o,e);return l}loadFeature(t){const{featureIndex:e,sourceLayerIndex:r}=t;this.loadVTLayers();const n=this.sourceLayerCoder.decode(r),i=this.vtFeatures[n];if(i[e])return i[e];const s=this.vtLayers[n].feature(e);return i[e]=s,s}hasLayer(t){for(const e of this.bucketLayerIDs)for(const r of e)if(t===r)return !0;return !1}getId(t,e){let r=t.id;return this.promoteId&&(r=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof r&&(r=Number(r))),r}}function Zp(t,e,r,n,i){return T(t,((t,s)=>{const a=e instanceof vs?e.get(s):null;return a&&a.evaluate?a.evaluate(r,n,i):a}))}function Gp(t,e){return e-t}pi("FeatureIndex",Np,{omit:["rawTileData","sourceLayerCoder"]});class Xp{constructor(t){const e={},r=[];for(const n in t){const i=t[n],s=e[n]={};for(const t in i.glyphs){const e=i.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n=e.metrics.localGlyph?2:1,a={x:0,y:0,w:e.bitmap.width+2*n,h:e.bitmap.height+2*n};r.push(a),s[t]=a;}}const{w:n,h:i}=Sc(r),s=new pl({width:n||1,height:i||1});for(const r in t){const n=t[r];for(const t in n.glyphs){const i=n.glyphs[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const a=e[r][t],o=i.metrics.localGlyph?2:1;pl.copy(i.bitmap,s,{x:0,y:0},{x:a.x+o,y:a.y+o},i.bitmap);}}this.image=s,this.positions=e;}}pi("GlyphAtlas",Xp);class Kp{constructor(t){this.tileID=new ap(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,t.projection&&(this.tileTransform=rp(t.tileID.canonical,t.projection));}parse(t,e,r,n,i){this.status="parsing",this.data=t,this.collisionBoxArray=new ea;const s=new lp(Object.keys(t.layers).sort()),a=new Np(this.tileID,this.promoteId);a.bucketLayerIDs=[];const o={},l=new Jh(256,256),u={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:r},c=e.familiesBySource[this.source];for(const e in c){const n=t.layers[e];if(!n)continue;let i=!1,l=!1;for(const t of c[e])"symbol"===t[0].type?i=!0:l=!0;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!l)continue;1===n.version&&E(`Vector tile source "${this.source}" layer "${e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const h=s.encode(e),p=[];for(let t=0;t<n.length;t++){const r=n.feature(t),i=a.getId(r,e);p.push({feature:r,id:i,index:t,sourceLayerIndex:h});}for(const t of c[e]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(Yp(t,this.zoom,r),(o[e.id]=e.createBucket({index:a.bucketLayerIDs.length,layers:t,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:h,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:r})).populate(p,u,this.tileID.canonical,this.tileTransform),a.bucketLayerIDs.push(t.map((t=>t.id))));}}let h,p,d,f;l.trim();const y={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},m=T(u.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(m).length?n.send("getGlyphs",{uid:this.uid,stacks:m},((t,e)=>{h||(h=t,p=e,b.call(this));}),void 0,!1,y):p={};const g=Object.keys(u.iconDependencies);g.length?n.send("getImages",{icons:g,source:this.source,tileID:this.tileID,type:"icons"},((t,e)=>{h||(h=t,d=e,b.call(this));}),void 0,!1,y):d={};const x=Object.keys(u.patternDependencies);function b(){if(h)return i(h);if(p&&d&&f){const t=new Xp(p),e=new zc(d,f);for(const n in o){const i=o[n];i instanceof Ph?(Yp(i.layers,this.zoom,r),xh(i,p,t.positions,d,e.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom)):i.hasPattern&&(i instanceof Du||i instanceof eu||i instanceof bu)&&(Yp(i.layers,this.zoom,r),i.addFeatures(u,this.tileID.canonical,e.patternPositions,r));}this.status="done",i(null,{buckets:v(o).filter((t=>!t.isEmpty())),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null});}}x.length?n.send("getImages",{icons:x,source:this.source,tileID:this.tileID,type:"patterns"},((t,e)=>{h||(h=t,f=e,b.call(this));}),void 0,!1,y):f={},b.call(this);}}function Yp(t,e,r){const n=new hs(e);for(const e of t)e.recalculate(n,r);}class Hp{constructor(t){this.entries={},this.scheduler=t;}request(t,e,r,n){const i=this.entries[t]=this.entries[t]||{callbacks:[]};if(i.result){const[t,r]=i.result;return this.scheduler?this.scheduler.add((()=>{n(t,r);}),e):n(t,r),()=>{}}return i.callbacks.push(n),i.cancel||(i.cancel=r(((r,n)=>{i.result=[r,n];for(const t of i.callbacks)this.scheduler?this.scheduler.add((()=>{t(r,n);}),e):t(r,n);setTimeout((()=>delete this.entries[t]),3e3);}))),()=>{i.result||(i.callbacks=i.callbacks.filter((t=>t!==n)),i.callbacks.length||(i.cancel(),delete this.entries[t]));}}}function Jp(t,e,r){const n=JSON.stringify(t.request);return t.data&&(this.deduped.entries[n]={result:[null,t.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},(e=>{const n=It(t.request,((t,n,i,s)=>{t?e(t):n&&e(null,{vectorTile:r?void 0:new yu.VectorTile(new rc(n)),rawData:n,cacheControl:i,expires:s});}));return ()=>{n.cancel(),e();}}),e)}var Wp={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],conic:!0,initializeConstants(){if(this.constants&&rl(this.parallels,this.constants.parallels))return;const t=Math.sin(c(this.parallels[0])),e=(t+Math.sin(c(this.parallels[1])))/2,r=1+t*(2*e-t),n=Math.sqrt(r)/e;this.constants={n:e,c:r,r0:n,parallels:this.parallels};},project(t,e){this.initializeConstants();const r=c(t-this.center[0]),n=c(e),{n:i,c:s,r0:a}=this.constants,o=Math.sqrt(s-2*i*Math.sin(n))/i;return {x:o*Math.sin(r*i),y:o*Math.cos(r*i)-a}},unproject(t,e){this.initializeConstants();const{n:r,c:n,r0:i}=this.constants,s=i+e;let a=Math.atan2(t,Math.abs(s))*Math.sign(s);s*r<0&&(a-=Math.PI*Math.sign(t)*Math.sign(s));const o=c(this.center[0])*r;a=g(a,-Math.PI-o,Math.PI-o);const l=h(a/r)+this.center[0],u=Math.asin(m((n-(t*t+s*s)*r*r)/(2*r),-1,1)),p=m(h(u),-85.051129,so);return new Ha(l,p)}};const Qp=1.340264,td=-.081106,ed=893e-6,rd=.003796,nd=Math.sqrt(3)/2;var id={name:"equalEarth",center:[0,0],range:[3.5,7],project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const r=Math.asin(nd*Math.sin(e)),n=r*r,i=n*n*n;return {x:.5*(t*Math.cos(r)/(nd*(Qp+3*td*n+i*(7*ed+9*rd*n)))/Math.PI+.5),y:1-.5*(r*(Qp+td*n+i*(ed+rd*n))/Math.PI+1)}},unproject(t,e){t=(2*t-.5)*Math.PI;let r=e=(2*(1-e)-1)*Math.PI,n=r*r,i=n*n*n;for(let t,s,a,o=0;o<12&&(s=r*(Qp+td*n+i*(ed+rd*n))-e,a=Qp+3*td*n+i*(7*ed+9*rd*n),t=s/a,r=m(r-t,-Math.PI/3,Math.PI/3),n=r*r,i=n*n*n,!(Math.abs(t)<1e-12));++o);const s=nd*t*(Qp+3*td*n+i*(7*ed+9*rd*n))/Math.cos(r),a=Math.asin(Math.sin(r)/nd),o=m(180*s/Math.PI,-180,180),l=m(180*a/Math.PI,-85.051129,so);return new Ha(o,l)}},sd={name:"equirectangular",wrap:!0,center:[0,0],range:[3.5,7],project:(t,e)=>({x:.5+t/360,y:.5-e/360}),unproject(t,e){const r=360*(t-.5),n=m(360*(.5-e),-85.051129,so);return new Ha(r,n)}};const ad=Math.PI/2;function od(t){return Math.tan((ad+t)/2)}var ld={name:"lambertConformalConic",range:[3.5,7],center:[0,30],parallels:[30,30],conic:!0,initializeConstants(){if(this.constants&&rl(this.parallels,this.constants.parallels))return;const t=c(this.parallels[0]),e=c(this.parallels[1]),r=Math.cos(t),n=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(od(e)/od(t)),i=r*Math.pow(od(t),n)/n;this.constants={n:n,f:i,parallels:this.parallels};},project(t,e){this.initializeConstants(),e=c(e),t=c(t-this.center[0]);const r=1e-6,{n:n,f:i}=this.constants;i>0?e<-ad+r&&(e=-ad+r):e>ad-r&&(e=ad-r);const s=i/Math.pow(od(e),n),a=s*Math.sin(n*t),o=i-s*Math.cos(n*t);return {x:.5*(a/Math.PI+.5),y:1-.5*(o/Math.PI+.5)}},unproject(t,e){this.initializeConstants(),t=(2*t-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n:r,f:n}=this.constants,i=n-e,s=Math.sign(i),a=Math.sign(r)*Math.sqrt(t*t+i*i);let o=Math.atan2(t,Math.abs(i))*s;i*r<0&&(o-=Math.PI*Math.sign(t)*s);const l=m(h(o/r)+this.center[0],-180,180),u=m(h(2*Math.atan(Math.pow(n/a,1/r))-ad),-85.051129,so);return new Ha(l,u)}},ud={name:"mercator",wrap:!0,center:[0,0],project:(t,e)=>({x:Qa(t),y:to(e)}),unproject(t,e){const r=ro(t),n=no(e);return new Ha(r,n)}};const cd=c(so);var hd={name:"naturalEarth",center:[0,0],range:[3.5,7],project(t,e){const r=(e=c(e))*e,n=r*r;return {x:.5*((t=c(t))*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)))/Math.PI+1)}},unproject(t,e){t=(2*t-.5)*Math.PI;let r=e=(2*(1-e)-1)*Math.PI,n=25,i=0,s=r*r;do{s=r*r;const t=s*s;i=(r*(1.007226+s*(.015085+t*(.028874*s-.044475-.005916*t)))-e)/(1.007226+s*(.045255+t*(.259866*s-.311325-.005916*11*t))),r=m(r-i,-cd,cd);}while(Math.abs(i)>1e-6&&--n>0);s=r*r;const a=m(h(t/(.8707+s*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979))),-180,180),o=h(r);return new Ha(a,o)}};const pd=c(so),dd={albers:Wp,equalEarth:id,equirectangular:sd,lambertConformalConic:ld,mercator:ud,naturalEarth:hd,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],project(t,e){e=c(e),t=c(t);const r=Math.cos(e),n=2/Math.PI,i=Math.acos(r*Math.cos(t/2)),s=Math.sin(i)/i,a=.5*(t*n+2*r*Math.sin(t/2)/s)||0,o=.5*(e+Math.sin(e)/s)||0;return {x:.5*(a/Math.PI+.5),y:1-.5*(o/Math.PI+1)}},unproject(t,e){let r=t=(2*t-.5)*Math.PI,n=e=(2*(1-e)-1)*Math.PI,i=25;const s=1e-6;let a=0,o=0;do{const i=Math.cos(n),s=Math.sin(n),l=2*s*i,u=s*s,c=i*i,h=Math.cos(r/2),p=Math.sin(r/2),d=2*h*p,f=p*p,y=1-c*h*h,g=y?1/y:0,x=y?Math.acos(i*h)*Math.sqrt(1/y):0,v=.5*(2*x*i*p+2*r/Math.PI)-t,b=.5*(x*s+n)-e,w=.5*g*(c*f+x*i*h*u)+1/Math.PI,_=g*(d*l/4-x*s*p),A=.125*g*(l*p-x*s*c*d),k=.5*g*(u*h+x*f*i)+.5,S=_*A-k*w;a=(b*_-v*k)/S,o=(v*A-b*w)/S,r=m(r-a,-Math.PI,Math.PI),n=m(n-o,-pd,pd);}while((Math.abs(a)>s||Math.abs(o)>s)&&--i>0);return new Ha(h(r),h(n))}}};t.ARRAY_TYPE=Vo,t.AUTH_ERR_MSG=Q,t.Actor=class{constructor(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},I(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=V()?t:a,this.scheduler=new ep;}send(t,e,r,n,i=!1,s){const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=s,this.callbacks[a]=r);const o=O(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!r,targetMapId:n,mustQueue:i,sourceMapId:this.mapId,data:yi(e,o)},o),{cancel:()=>{r&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId});}}}receive(t){const e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[r];delete this.cancelCallbacks[r],t&&t.cancel();}else if(e.mustQueue||V()){const t=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add((()=>this.processTask(r,e)),t&&t.metadata||{type:"message"});}else this.processTask(r,e);}processTask(t,e){if("<response>"===e.type){const r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(mi(e.error)):r(null,mi(e.data)));}else {const r=O(this.globalScope)?void 0:[],n=e.hasCallback?(e,n)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?yi(e):null,data:yi(n,r)},r);}:t=>{},i=mi(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,i,n);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],i.source)[t[1]](i,n);}else n(new Error(`Could not find function ${e.type}`));}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1);}},t.CanonicalTileID=ip,t.Color=he,t.ColorMode=Fp,t.CullFaceMode=$p,t.DEMData=Bp,t.DataConstantProperty=bs,t.DedupedRequest=Hp,t.DepthMode=Dp,t.EXTENT=Xa,t.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,r=!0){null==e&&(e=null);const n=this._source();if(!n)return e;if(t.y<0||t.y>1)return e;const i=n.getSource().maxzoom,s=1<<i,a=Math.floor(t.x),o=t.x-a,l=new ap(i,a,i,Math.floor(o*s),Math.floor(t.y*s)),u=this.findDEMTileFor(l);if(!u||!u.dem)return e;const c=u.dem,h=1<<u.tileID.canonical.z,p=(o*h-u.tileID.canonical.x)*c.dim,d=(t.y*h-u.tileID.canonical.y)*c.dim,f=Math.floor(p),y=Math.floor(d);return (r?this.exaggeration():1)*nr(nr(c.get(f,y),c.get(f,y+1),d-y),nr(c.get(f+1,y),c.get(f+1,y+1),d-y),p-f)}getAtTileOffset(t,e,r){const n=1<<t.canonical.z;return this.getAtPointOrZero(new ao(t.wrap+(t.canonical.x+e/Xa)/n,(t.canonical.y+r/Xa)/n))}getForTilePoints(t,e,r,n){const i=qp.create(this,t,n);return !!i&&(e.forEach((t=>{t[2]=this.exaggeration()*i.getElevationAt(t[0],t[1],r);})),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const r=e.dem.tree,n=e.tileID,i=1<<t.canonical.z-n.canonical.z;let s=t.canonical.x/i-n.canonical.x,a=t.canonical.y/i-n.canonical.y,o=0;for(let e=0;e<t.canonical.z-n.canonical.z&&!r.leaves[o];e++){s*=2,a*=2;const t=2*Math.floor(a)+Math.floor(s);o=r.childOffsets[o]+t,s%=1,a%=1;}return {min:this.exaggeration()*r.minimums[o],max:this.exaggeration()*r.maximums[o]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Lt,t.EvaluationParameters=hs,t.Event=Ft,t.Evented=Rt,t.GlyphManager=nh,t.ImagePosition=Ic,t.LineAtlas=Jh,t.LngLat=Ha,t.LngLatBounds=Ka,t.LocalGlyphMode=rh,t.MAX_MERCATOR_LATITUDE=so,t.MAX_SAFE_INTEGER=o,t.MercatorCoordinate=ao,t.ONE_EM=Nu,t.OverscaledTileID=ap,t.Properties=Ss,t.RGBAImage=dl,t.RequestManager=class{constructor(t,e,r){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken();}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return {token:["1",W,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt;}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!tt(t))return t;const r=nt(t);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!tt(t))return t;const r=nt(t);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!tt(t))return t;const r=nt(t);return r.path=`/v4/${r.authority}.json`,r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)}normalizeSpriteURL(t,e,r,n){const i=nt(t);return tt(t)?(i.path=`/styles/v1${i.path}/sprite${e}${r}`,this._makeAPIURL(i,this._customAccessToken||n)):(i.path+=`${e}${r}`,it(i))}normalizeTileURL(t,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!tt(t))return t;const n=nt(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&"raster"!==n.authority&&512===r?"@2x":""}${G.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${Z.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${Z.TILE_URL_VERSION}${n.path}`);const i=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(n.params)||Z.ACCESS_TOKEN;return Z.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,i)}canonicalizeTileURL(t,e){const r=nt(t);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${Z.RASTER_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${Z.TILE_URL_VERSION}/`,"")}`;let i=r.params;return e&&(i=i.filter((t=>!t.match(/^access_token=/)))),i.length&&(n+=`?${i.join("&")}`),n}canonicalizeTileset(t,e){const r=!!e&&tt(e),n=[];for(const e of t.tiles||[])et(e)?n.push(this.canonicalizeTileURL(e,r)):n.push(e);return n}_makeAPIURL(t,e){const r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=nt(Z.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1);}if("/"!==n.path&&(t.path=`${n.path}${t.path}`),!Z.REQUIRE_ACCESS_TOKEN)return it(t);if(e=e||Z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return t.params=t.params.filter((t=>-1===t.indexOf("access_token"))),t.params.push(`access_token=${e||""}`),it(t)}},t.ResourceType=_t,t.SegmentVector=Ga,t.SourceCache=Up,t.StencilMode=Vp,t.StructArrayLayout1ui2=Js,t.StructArrayLayout2f1f2i16=js,t.StructArrayLayout2i4=Es,t.StructArrayLayout2ui4=Hs,t.StructArrayLayout3f12=Vs,t.StructArrayLayout3ui6=Ns,t.StructArrayLayout4i8=Ds,t.Texture=Hh,t.Tile=bp,t.Transitionable=fs,t.Uniform1f=Aa,t.Uniform1i=class extends _a{constructor(t,e){super(t,e),this.current=0;}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t));}},t.Uniform2f=class extends _a{constructor(t,e){super(t,e),this.current=[0,0];}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]));}},t.Uniform3f=class extends _a{constructor(t,e){super(t,e),this.current=[0,0,0];}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]));}},t.Uniform4f=ka,t.UniformColor=Sa,t.UniformMatrix2f=class extends _a{constructor(t,e){super(t,e),this.current=Ta;}set(t){for(let e=0;e<4;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix2fv(this.location,!1,t);break}}},t.UniformMatrix3f=class extends _a{constructor(t,e){super(t,e),this.current=za;}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},t.UniformMatrix4f=class extends _a{constructor(t,e){super(t,e),this.current=Ia;}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=sp,t.ValidationError=Ut,t.VectorTileWorkerSource=class extends Rt{constructor(t,e,r,n,i){super(),this.actor=t,this.layerIndex=e,this.availableImages=r,this.loadVectorData=i||Jp,this.loading={},this.loaded={},this.deduped=new Hp(t.scheduler),this.isSpriteLoaded=n,this.scheduler=t.scheduler;}loadTile(t,e){const r=t.uid,n=t&&t.request,i=n&&n.collectResourceTiming,s=this.loading[r]=new Kp(t);s.abort=this.loadVectorData(t,((a,o)=>{const l=!this.loading[r];if(delete this.loading[r],l||a||!o)return s.status="done",l||(this.loaded[r]=s),e(a);const u=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl),s.vectorTile=o.vectorTile||new yu.VectorTile(new rc(u));const h=()=>{s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,r)=>{if(t||!r)return e(t);const s={};if(i){const t=tp(n);t.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(t)));}e(null,b({rawTileData:u.slice(0)},r,c,s));}));};this.isSpriteLoaded?h():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):h();})),this.loaded=this.loaded||{},this.loaded[r]=s;}));}reloadTile(t,e){const r=this.loaded,n=t.uid,i=this;if(r&&r[n]){const s=r[n];s.showCollisionBoxes=t.showCollisionBoxes,s.enableTerrain=!!t.enableTerrain;const a=(t,r)=>{const n=s.reloadCallback;n&&(delete s.reloadCallback,s.parse(s.vectorTile,i.layerIndex,this.availableImages,i.actor,n)),e(t,r);};"parsing"===s.status?s.reloadCallback=a:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a());}}abortTile(t,e){const r=t.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),e();}removeTile(t,e){const r=this.loaded,n=t.uid;r&&r[n]&&delete r[n],e();}},t.WritingMode=Tc,t.ZoomHistory=gi,t.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},t.addDynamicAttributes=Ch,t.altitudeFromMercatorZ=io,t.asyncAll=x,t.bezier=f,t.bindAll=I,t.boundsAttributes=xp,t.bufferConvexPolygon=function(t,e){const r=[];for(let n=0;n<t.length;n++){const i=g(n-1,-1,t.length-1),s=g(n+1,-1,t.length-1),a=t[n],o=t[s],l=t[i].sub(a).unit(),u=o.sub(a).unit(),c=u.angleWithSep(l.x,l.y),h=l.add(u).unit().mult(-1*e/Math.sin(c/2));r.push(a.add(h));}return r},t.cacheEntryPossiblyAdded=function(t){wt++,wt>xt&&(t.getActor().send("enforceCacheSizeLimit",gt),wt=0);},t.clamp=m,t.clearTileCache=function(t){const e=a.caches.delete(ft);t&&e.catch(t).then((()=>t()));},t.clipLine=Wc,t.clone=function(t){var e=new Vo(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.clone$1=function(t){var e=new Vo(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$2=C,t.collisionCircleLayout=qu,t.config=Z,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=Uo,t.create$1=function(){var t=new Vo(16);return Vo!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$2=Fo,t.createExpression=hn,t.createLayout=Cs,t.createStyleLayer=function(t){return "custom"===t.type?new Oh(t):new Nh[t.type](t)},t.cross=function(t,e,r){var n=e[0],i=e[1],s=e[2],a=r[0],o=r[1],l=r[2];return t[0]=i*l-s*o,t[1]=s*a-n*l,t[2]=n*o-i*a,t},t.degToRad=c,t.div=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=y,t.easeCubicInOut=d,t.emitValidationErrors=ai,t.endsWith=z,t.enforceCacheSizeLimit=function(t){vt(),yt&&yt.then((e=>{e.keys().then((r=>{for(let n=0;n<r.length-t;n++)e.delete(r[n]);}));}));},t.evaluateSizeForFeature=Xu,t.evaluateSizeForZoom=Ku,t.evaluateVariableOffset=gh,t.evented=os,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=q,t.exported$1=G,t.extend=b,t.filterObject=M,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=r+r,o=n+n,l=i+i,u=r*a,c=n*a,h=n*o,p=i*a,d=i*o,f=i*l,y=s*a,m=s*o,g=s*l;return t[0]=1-h-f,t[1]=c+g,t[2]=p-m,t[3]=0,t[4]=c-g,t[5]=1-u-f,t[6]=d+y,t[7]=0,t[8]=p+m,t[9]=d-y,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return p[e]},t.getAABBPointSquareDist=function(t,e,r){let n=0;for(let i=0;i<2;++i){const s=r?r[i]:0;t[i]>s&&(n+=(t[i]-s)*(t[i]-s)),e[i]<s&&(n+=(s-e[i])*(s-e[i]));}return n},t.getAnchorAlignment=Uc,t.getAnchorJustification=vh,t.getBounds=function(t){let e=1/0,r=1/0,n=-1/0,s=-1/0;for(const i of t)e=Math.min(e,i.x),r=Math.min(r,i.y),n=Math.max(n,i.x),s=Math.max(s,i.y);return {min:new i(e,r),max:new i(n,s)}},t.getImage=Dt,t.getJSON=function(t,e){return St(b(t,{type:"json"}),e)},t.getMapSessionAPI=pt,t.getPerformanceMeasurement=tp,t.getProjection=function(t){const e=dd[t.name];if(!e)throw new Error(`Invalid projection name: ${t.name}`);return e.conic?function(t,e){if(e.parallels&&Math.abs(e.parallels[0]+e.parallels[1])<.01){let r=function(t){const e=Math.max(.01,Math.cos(c(t))),r=1/(2*Math.max(Math.PI*e,1/e));return {wrap:!0,project(t,n){const i=c(t)*e,s=Math.sin(c(n))/e;return {x:i*r+.5,y:-s*r+.5}},unproject(t,n){const i=-(n-.5)/r,s=m(h((t-.5)/r)/e,-180,180),a=Math.asin(m(i*e,-1,1)),o=m(h(a),-85.051129,so);return new Ha(s,o)}}}(e.parallels[0]);if("lambertConformalConic"===e.name){const{project:t,unproject:e}=dd.mercator;r={wrap:!0,project:t,unproject:e};}return b({},t,e,r)}return b({},t,e)}(e,t):e},t.getRTLTextPluginStatus=ls,t.getReferrer=kt,t.getTilePoint=function(t,{x:e,y:r},n=0){return new i(((e-n)*t.scale-t.x)*Xa,(r*t.scale-t.y)*Xa)},t.getTileVec3=function(t,e,r=0){return jo(((e.x-r)*t.scale-t.x)*Xa,(e.y*t.scale-t.y)*Xa,io(e.z,e.y))},t.getVideo=function(t,e){const r=a.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r);};for(let e=0;e<t.length;e++){const n=a.document.createElement("source");Mt(t[e])||(r.crossOrigin="Anonymous"),n.src=t[e],r.appendChild(n);}return {cancel:()=>{}}},t.identity=Lo,t.identity$1=tl,t.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12],y=e[13],m=e[14],g=e[15],x=r*o-n*a,v=r*l-i*a,b=r*u-s*a,w=n*l-i*o,_=n*u-s*o,A=i*u-s*l,k=c*y-h*f,S=c*m-p*f,I=c*g-d*f,z=h*m-p*y,T=h*g-d*y,M=p*g-d*m,C=x*M-v*T+b*z+w*I-_*S+A*k;return C?(t[0]=(o*M-l*T+u*z)*(C=1/C),t[1]=(i*T-n*M-s*z)*C,t[2]=(y*A-m*_+g*w)*C,t[3]=(p*_-h*A-d*w)*C,t[4]=(l*I-a*M-u*S)*C,t[5]=(r*M-i*I+s*S)*C,t[6]=(m*b-f*A-g*v)*C,t[7]=(c*A-p*b+d*v)*C,t[8]=(a*T-o*I+u*k)*C,t[9]=(n*I-r*T-s*k)*C,t[10]=(f*_-y*b+g*x)*C,t[11]=(h*b-c*_-d*x)*C,t[12]=(o*S-a*z-l*k)*C,t[13]=(r*z-n*S+i*k)*C,t[14]=(y*v-f*w-m*x)*C,t[15]=(c*w-h*v+p*x)*C,t):null},t.isMapAuthenticated=function(t){return dt.has(t)},t.isMapboxURL=tt,t.latFromMercatorY=no,t.len=Jo,t.length=Oo,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.loadVectorTile=Jp,t.makeRequest=St,t.mercatorXfromLng=Qa,t.mercatorYfromLat=to,t.mercatorZfromAltitude=eo,t.mul=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},t.mul$1=$o,t.mul$2=Ho,t.multiply=Ro,t.multiply$1=No,t.nextPowerOfTwo=k,t.normalize=Go,t.normalize$1=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=r*r+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=s*a,t},t.number=nr,t.ortho=function(t,e,r,n,i,s,a){var o=1/(e-r),l=1/(n-i),u=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*l,t[14]=(a+s)*u,t[15]=1,t},t.pbf=rc,t.perspective=function(t,e,r,n,i){var s,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+n)*(s=1/(n-i)),t[14]=2*i*n*s):(t[10]=-1,t[14]=-2*n),t},t.pick=function(t,e){const r={};for(let n=0;n<e.length;n++){const i=e[n];i in t&&(r[i]=t[i]);}return r},t.plugin=cs,t.pointGeometry=i,t.polygonIntersectsBox=zo,t.polygonIntersectsPolygon=go,t.polygonizeBounds=function(t,e,r=0,n=!0){const s=new i(r,r),a=t.sub(s),o=e.add(s),l=[a,new i(o.x,a.y),o,new i(a.x,o.y)];return n&&l.push(a),l},t.posAttributes=cp,t.postMapLoadEvent=ct,t.postTurnstileEvent=lt,t.potpack=Sc,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=h,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:ns,pluginURL:is}),os.on("pluginStateChange",t),t},t.removeAuthState=function(t){dt.delete(t);},t.renderColorRamp=yl,t.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*n,t[5]=a*i+c*n,t[6]=o*i+h*n,t[7]=l*i+p*n,t[8]=u*i-s*n,t[9]=c*i-a*n,t[10]=h*i-o*n,t[11]=p*i-l*n,t},t.rotateX$1=el,t.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],a=e[1],o=e[2],l=e[3],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*n,t[1]=a*i-c*n,t[2]=o*i-h*n,t[3]=l*i-p*n,t[8]=s*n+u*i,t[9]=a*n+c*i,t[10]=o*n+h*i,t[11]=l*n+p*i,t},t.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],a=e[1],o=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*n,t[1]=a*i+c*n,t[2]=o*i+h*n,t[3]=l*i+p*n,t[4]=u*i-s*n,t[5]=c*i-a*n,t[6]=h*i-o*n,t[7]=p*i-l*n,t},t.rotateZ$1=function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*o,t[1]=i*l-n*o,t[2]=s*l+a*o,t[3]=a*l-s*o,t},t.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},t.scale$1=function(t,e,r){var n=r[0],i=r[1],s=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$2=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},t.scaleAndAdd=Zo,t.setCacheLimits=function(t,e){gt=t,xt=e;},t.setRTLTextPlugin=function(t,e,r=!1){if(ns===Qi||ns===ts||ns===es)throw new Error("setRTLTextPlugin cannot be called multiple times.");is=q.resolveURL(t),ns=Qi,rs=e,as(),r||us();},t.smoothstep=function(t,e,r){return (r=m((r-t)/(e-t),0,1))*r*(3-2*r)},t.spec=$t,t.storeAuthState=function(t,e){e?dt.add(t):dt.delete(t);},t.sub=Yo,t.subtract=qo,t.symbolSize=Yu,t.tileTransform=rp,t.transformMat3=function(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=n*r[0]+i*r[3]+s*r[6],t[1]=n*r[1]+i*r[4]+s*r[7],t[2]=n*r[2]+i*r[5]+s*r[8],t},t.transformMat4=Wo,t.transformMat4$1=function(t,e,r){var n=e[0],i=e[1],s=e[2],a=r[3]*n+r[7]*i+r[11]*s+r[15];return t[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/(a=a||1),t[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/a,t},t.transformQuat=Xo,t.translate=function(t,e,r){var n,i,s,a,o,l,u,c,h,p,d,f,y=r[0],m=r[1],g=r[2];return e===t?(t[12]=e[0]*y+e[4]*m+e[8]*g+e[12],t[13]=e[1]*y+e[5]*m+e[9]*g+e[13],t[14]=e[2]*y+e[6]*m+e[10]*g+e[14],t[15]=e[3]*y+e[7]*m+e[11]*g+e[15]):(i=e[1],s=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=n=e[0],t[1]=i,t[2]=s,t[3]=a,t[4]=o,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=n*y+o*m+h*g+e[12],t[13]=i*y+l*m+p*g+e[13],t[14]=s*y+u*m+d*g+e[14],t[15]=a*y+c*m+f*g+e[15]),t},t.triggerPluginCompletionEvent=ss,t.uniqueId=_,t.validateCustomStyleLayer=function(t){const e=[],r=t.id;return void 0===r&&e.push({message:`layers.${r}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${r}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateFog=ni,t.validateLight=ri,t.validateStyle=ei,t.values=v,t.vectorTile=yu,t.version=e,t.warnOnce=E,t.window=a,t.wrap=g;}));

define(["./shared"],(function(e){"use strict";function t(e){const r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){let r="[";for(const o of e)r+=`${t(o)},`;return `${r}]`}const o=Object.keys(e).sort();let n="{";for(let r=0;r<o.length;r++)n+=`${JSON.stringify(o[r])}:${t(e[o[r]])},`;return `${n}}`}function r(r){let o="";for(const n of e.refProperties)o+=`/${t(r[n])}`;return o}class o{constructor(e){this.keyCache={},e&&this.replace(e);}replace(e){this._layerConfigs={},this._layers={},this.update(e,[]);}update(t,o){for(const r of t)this._layerConfigs[r.id]=r,(this._layers[r.id]=e.createStyleLayer(r)).compileFilter(),this.keyCache[r.id]&&delete this.keyCache[r.id];for(const e of o)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const n=function(e,t){const o={};for(let n=0;n<e.length;n++){const i=t&&t[e[n].id]||r(e[n]);t&&(t[e[n].id]=i);let s=o[i];s||(s=o[i]=[]),s.push(e[n]);}const n=[];for(const e in o)n.push(o[e]);return n}(e.values(this._layerConfigs),this.keyCache);for(const e of n){const t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;const o=r.source||"";let n=this.familiesBySource[o];n||(n=this.familiesBySource[o]={});const i=r.sourceLayer||"_geojsonTileLayer";let s=n[i];s||(s=n[i]=[]),s.push(t);}}}const{ImageBitmap:n}=e.window;class i{loadTile(t,r){const{uid:o,encoding:i,rawImageData:s,padding:a,buildQuadTree:l}=t,u=n&&s instanceof n?this.getImageData(s,a):s;r(null,new e.DEMData(o,u,i,a<1,l));}getImageData(t,r){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const o=this.offscreenCanvasContext.getImageData(-r,-r,t.width+2*r,t.height+2*r);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:o.width,height:o.height},o.data)}}var s=function e(t,r){var o,n=t&&t.type;if("FeatureCollection"===n)for(o=0;o<t.features.length;o++)e(t.features[o],r);else if("GeometryCollection"===n)for(o=0;o<t.geometries.length;o++)e(t.geometries[o],r);else if("Feature"===n)e(t.geometry,r);else if("Polygon"===n)a(t.coordinates,r);else if("MultiPolygon"===n)for(o=0;o<t.coordinates.length;o++)a(t.coordinates[o],r);return t};function a(e,t){if(0!==e.length){l(e[0],t);for(var r=1;r<e.length;r++)l(e[r],!t);}}function l(e,t){for(var r=0,o=0,n=0,i=e.length,s=i-1;n<i;s=n++){var a=(e[n][0]-e[s][0])*(e[s][1]+e[n][1]),l=r+a;o+=Math.abs(r)>=Math.abs(a)?r-l+a:a-l+r,r=l;}r+o>=0!=!!t&&e.reverse();}const u=e.vectorTile.VectorTileFeature.prototype.toGeoJSON;class h{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10));}loadGeometry(){if(1===this._feature.type){const t=[];for(const r of this._feature.geometry)t.push([new e.pointGeometry(r[0],r[1])]);return t}{const t=[];for(const r of this._feature.geometry){const o=[];for(const t of r)o.push(new e.pointGeometry(t[0],t[1]));t.push(o);}return t}}toGeoJSON(e,t,r){return u.call(this,e,t,r)}}class c{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t;}feature(e){return new h(this._features[e])}}var f=e.vectorTile.VectorTileFeature,p=g;function g(e,t){this.options=t||{},this.features=e,this.length=e.length;}function d(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096;}g.prototype.feature=function(e){return new d(this.features[e],this.options.extent)},d.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var o=t[r],n=[],i=0;i<o.length;i++)n.push(new e.pointGeometry(o[i][0],o[i][1]));this.geometry.push(n);}return this.geometry},d.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,o=1/0,n=-1/0,i=0;i<e.length;i++)for(var s=e[i],a=0;a<s.length;a++){var l=s[a];t=Math.min(t,l.x),r=Math.max(r,l.x),o=Math.min(o,l.y),n=Math.max(n,l.y);}return [t,o,r,n]},d.prototype.toGeoJSON=f.prototype.toGeoJSON;var m=v,y=p;function v(t){var r=new e.pbf;return function(e,t){for(var r in e.layers)t.writeMessage(3,x,e.layers[r]);}(t,r),r.finish()}function x(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var o={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)o.feature=e.feature(r),t.writeMessage(2,w,o);var n=o.keys;for(r=0;r<n.length;r++)t.writeStringField(3,n[r]);var i=o.values;for(r=0;r<i.length;r++)t.writeMessage(4,T,i[r]);}function w(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,S,e),t.writeVarintField(3,r.type),t.writeMessage(4,b,r);}function S(e,t){var r=e.feature,o=e.keys,n=e.values,i=e.keycache,s=e.valuecache;for(var a in r.properties){var l=r.properties[a],u=i[a];if(null!==l){void 0===u&&(o.push(a),i[a]=u=o.length-1),t.writeVarint(u);var h=typeof l;"string"!==h&&"boolean"!==h&&"number"!==h&&(l=JSON.stringify(l));var c=h+":"+l,f=s[c];void 0===f&&(n.push(l),s[c]=f=n.length-1),t.writeVarint(f);}}}function M(e,t){return (t<<3)+(7&e)}function P(e){return e<<1^e>>31}function b(e,t){for(var r=e.loadGeometry(),o=e.type,n=0,i=0,s=r.length,a=0;a<s;a++){var l=r[a],u=1;1===o&&(u=l.length),t.writeVarint(M(1,u));for(var h=3===o?l.length-1:l.length,c=0;c<h;c++){1===c&&1!==o&&t.writeVarint(M(2,h-1));var f=l[c].x-n,p=l[c].y-i;t.writeVarint(P(f)),t.writeVarint(P(p)),n+=f,i+=p;}3===o&&t.writeVarint(M(7,1));}}function T(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e));}function k(e,t,r,o,n,i){if(n-o<=r)return;const s=o+n>>1;I(e,t,s,o,n,i%2),k(e,t,r,o,s-1,i+1),k(e,t,r,s+1,n,i+1);}function I(e,t,r,o,n,i){for(;n>o;){if(n-o>600){const s=n-o+1,a=r-o+1,l=Math.log(s),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);I(e,t,r,Math.max(o,Math.floor(r-a*u/s+h)),Math.min(n,Math.floor(r+(s-a)*u/s+h)),i);}const s=t[2*r+i];let a=o,l=n;for(_(e,t,o,r),t[2*n+i]>s&&_(e,t,o,n);a<l;){for(_(e,t,a,l),a++,l--;t[2*a+i]<s;)a++;for(;t[2*l+i]>s;)l--;}t[2*o+i]===s?_(e,t,o,l):(l++,_(e,t,l,n)),l<=r&&(o=l+1),r<=l&&(n=l-1);}}function _(e,t,r,o){L(e,r,o),L(t,2*r,2*o),L(t,2*r+1,2*o+1);}function L(e,t,r){const o=e[t];e[t]=e[r],e[r]=o;}function C(e,t,r,o){const n=e-r,i=t-o;return n*n+i*i}m.fromVectorTileJs=v,m.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var o in e)r[o]=new p(e[o].features,t),r[o].name=o,r[o].version=t.version,r[o].extent=t.extent;return v({layers:r})},m.GeoJSONWrapper=y;const O=e=>e[0],z=e=>e[1];class E{constructor(e,t=O,r=z,o=64,n=Float64Array){this.nodeSize=o,this.points=e;const i=e.length<65536?Uint16Array:Uint32Array,s=this.ids=new i(e.length),a=this.coords=new n(2*e.length);for(let o=0;o<e.length;o++)s[o]=o,a[2*o]=t(e[o]),a[2*o+1]=r(e[o]);k(s,a,o,0,s.length-1,0);}range(e,t,r,o){return function(e,t,r,o,n,i,s){const a=[0,e.length-1,0],l=[];let u,h;for(;a.length;){const c=a.pop(),f=a.pop(),p=a.pop();if(f-p<=s){for(let s=p;s<=f;s++)u=t[2*s],h=t[2*s+1],u>=r&&u<=n&&h>=o&&h<=i&&l.push(e[s]);continue}const g=Math.floor((p+f)/2);u=t[2*g],h=t[2*g+1],u>=r&&u<=n&&h>=o&&h<=i&&l.push(e[g]);const d=(c+1)%2;(0===c?r<=u:o<=h)&&(a.push(p),a.push(g-1),a.push(d)),(0===c?n>=u:i>=h)&&(a.push(g+1),a.push(f),a.push(d));}return l}(this.ids,this.coords,e,t,r,o,this.nodeSize)}within(e,t,r){return function(e,t,r,o,n,i){const s=[0,e.length-1,0],a=[],l=n*n;for(;s.length;){const u=s.pop(),h=s.pop(),c=s.pop();if(h-c<=i){for(let n=c;n<=h;n++)C(t[2*n],t[2*n+1],r,o)<=l&&a.push(e[n]);continue}const f=Math.floor((c+h)/2),p=t[2*f],g=t[2*f+1];C(p,g,r,o)<=l&&a.push(e[f]);const d=(u+1)%2;(0===u?r-n<=p:o-n<=g)&&(s.push(c),s.push(f-1),s.push(d)),(0===u?r+n>=p:o+n>=g)&&(s.push(f+1),s.push(h),s.push(d));}return a}(this.ids,this.coords,e,t,r,this.nodeSize)}}const F={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},N=Math.fround||(j=new Float32Array(1),e=>(j[0]=+e,j[0]));var j;class Z{constructor(e){this.options=D(Object.create(F),e),this.trees=new Array(this.options.maxZoom+1);}load(e){const{log:t,minZoom:r,maxZoom:o,nodeSize:n}=this.options;t&&console.time("total time");const i=`prepare ${e.length} points`;t&&console.time(i),this.points=e;let s=[];for(let t=0;t<e.length;t++)e[t].geometry&&s.push(J(e[t],t));this.trees[o+1]=new E(s,$,B,n,Float32Array),t&&console.timeEnd(i);for(let e=o;e>=r;e--){const r=+Date.now();s=this._cluster(s,e),this.trees[e]=new E(s,$,B,n,Float32Array),t&&console.log("z%d: %d clusters in %dms",e,s.length,+Date.now()-r);}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[1]));let n=180===e[2]?180:((e[2]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,n=180;else if(r>n){const e=this.getClusters([r,o,180,i],t),s=this.getClusters([-180,o,n,i],t);return e.concat(s)}const s=this.trees[this._limitZoom(t)],a=s.range(X(r),V(i),X(n),V(o)),l=[];for(const e of a){const t=s.points[e];l.push(t.numPoints?W(t):this.points[t.index]);}return l}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),o="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(o);const i=n.points[t];if(!i)throw new Error(o);const s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=n.within(i.x,i.y,s),l=[];for(const t of a){const r=n.points[t];r.parentId===e&&l.push(r.numPoints?W(r):this.points[r.index]);}if(0===l.length)throw new Error(o);return l}getLeaves(e,t,r){const o=[];return this._appendLeaves(o,e,t=t||10,r=r||0,0),o}getTile(e,t,r){const o=this.trees[this._limitZoom(e)],n=Math.pow(2,e),{extent:i,radius:s}=this.options,a=s/i,l=(r-a)/n,u=(r+1+a)/n,h={features:[]};return this._addTileFeatures(o.range((t-a)/n,l,(t+1+a)/n,u),o.points,t,r,n,h),0===t&&this._addTileFeatures(o.range(1-a/n,l,1,u),o.points,n,r,n,h),t===n-1&&this._addTileFeatures(o.range(0,l,a/n,u),o.points,-1,r,n,h),h.features.length?h:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id;}return t}_appendLeaves(e,t,r,o,n){const i=this.getChildren(t);for(const t of i){const i=t.properties;if(i&&i.cluster?n+i.point_count<=o?n+=i.point_count:n=this._appendLeaves(e,i.cluster_id,r,o,n):n<o?n++:e.push(t),e.length===r)break}return n}_addTileFeatures(e,t,r,o,n,i){for(const s of e){const e=t[s],a=e.numPoints;let l,u,h;if(a)l=Y(e),u=e.x,h=e.y;else {const t=this.points[e.index];l=t.properties,u=X(t.geometry.coordinates[0]),h=V(t.geometry.coordinates[1]);}const c={type:1,geometry:[[Math.round(this.options.extent*(u*n-r)),Math.round(this.options.extent*(h*n-o))]],tags:l};let f;a?f=e.id:this.options.generateId?f=e.index:this.points[e.index].id&&(f=this.points[e.index].id),void 0!==f&&(c.id=f),i.features.push(c);}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))}_cluster(e,t){const r=[],{radius:o,extent:n,reduce:i,minPoints:s}=this.options,a=o/(n*Math.pow(2,t));for(let o=0;o<e.length;o++){const n=e[o];if(n.zoom<=t)continue;n.zoom=t;const l=this.trees[t+1],u=l.within(n.x,n.y,a),h=n.numPoints||1;let c=h;for(const e of u){const r=l.points[e];r.zoom>t&&(c+=r.numPoints||1);}if(c>h&&c>=s){let e=n.x*h,s=n.y*h,a=i&&h>1?this._map(n,!0):null;const f=(o<<5)+(t+1)+this.points.length;for(const r of u){const o=l.points[r];if(o.zoom<=t)continue;o.zoom=t;const u=o.numPoints||1;e+=o.x*u,s+=o.y*u,o.parentId=f,i&&(a||(a=this._map(n,!0)),i(a,this._map(o)));}n.parentId=f,r.push(G(e/c,s/c,f,c,a));}else if(r.push(n),c>1)for(const e of u){const o=l.points[e];o.zoom<=t||(o.zoom=t,r.push(o));}}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return (e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?D({},e.properties):e.properties;const r=this.points[e.index].properties,o=this.options.map(r);return t&&o===r?D({},o):o}}function G(e,t,r,o,n){return {x:N(e),y:N(t),zoom:1/0,id:r,parentId:-1,numPoints:o,properties:n}}function J(e,t){const[r,o]=e.geometry.coordinates;return {x:N(X(r)),y:N(V(o)),zoom:1/0,index:t,parentId:-1}}function W(e){return {type:"Feature",id:e.id,properties:Y(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),A(e.y)]}};var t;}function Y(e){const t=e.numPoints,r=t>=1e4?`${Math.round(t/1e3)}k`:t>=1e3?Math.round(t/100)/10+"k":t;return D(D({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function X(e){return e/360+.5}function V(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function A(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function D(e,t){for(const r in t)e[r]=t[r];return e}function $(e){return e.x}function B(e){return e.y}function R(e,t,r,o){for(var n,i=o,s=r-t>>1,a=r-t,l=e[t],u=e[t+1],h=e[r],c=e[r+1],f=t+3;f<r;f+=3){var p=q(e[f],e[f+1],l,u,h,c);if(p>i)n=f,i=p;else if(p===i){var g=Math.abs(f-s);g<a&&(n=f,a=g);}}i>o&&(n-t>3&&R(e,t,n,o),e[n+2]=i,r-n>3&&R(e,n,r,o));}function q(e,t,r,o,n,i){var s=n-r,a=i-o;if(0!==s||0!==a){var l=((e-r)*s+(t-o)*a)/(s*s+a*a);l>1?(r=n,o=i):l>0&&(r+=s*l,o+=a*l);}return (s=e-r)*s+(a=t-o)*a}function U(e,t,r,o){var n={id:void 0===e?null:e,type:t,geometry:r,tags:o,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)Q(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var o=0;o<t.length;o++)Q(e,t[o]);else if("MultiPolygon"===r)for(o=0;o<t.length;o++)for(var n=0;n<t[o].length;n++)Q(e,t[o][n]);}(n),n}function Q(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1]);}function H(e,t,r,o){if(t.geometry){var n=t.geometry.coordinates,i=t.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),a=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=o||0),"Point"===i)K(n,a);else if("MultiPoint"===i)for(var u=0;u<n.length;u++)K(n[u],a);else if("LineString"===i)ee(n,a,s,!1);else if("MultiLineString"===i){if(r.lineMetrics){for(u=0;u<n.length;u++)ee(n[u],a=[],s,!1),e.push(U(l,"LineString",a,t.properties));return}te(n,a,s,!1);}else if("Polygon"===i)te(n,a,s,!0);else {if("MultiPolygon"!==i){if("GeometryCollection"===i){for(u=0;u<t.geometry.geometries.length;u++)H(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,o);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<n.length;u++){var h=[];te(n[u],h,s,!0),a.push(h);}}e.push(U(l,i,a,t.properties));}}function K(e,t){t.push(re(e[0])),t.push(oe(e[1])),t.push(0);}function ee(e,t,r,o){for(var n,i,s=0,a=0;a<e.length;a++){var l=re(e[a][0]),u=oe(e[a][1]);t.push(l),t.push(u),t.push(0),a>0&&(s+=o?(n*u-l*i)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-i,2))),n=l,i=u;}var h=t.length-3;t[2]=1,R(t,0,h,r),t[h+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size;}function te(e,t,r,o){for(var n=0;n<e.length;n++){var i=[];ee(e[n],i,r,o),t.push(i);}}function re(e){return e/360+.5}function oe(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function ne(e,t,r,o,n,i,s,a){if(o/=t,i>=(r/=t)&&s<o)return e;if(s<r||i>=o)return null;for(var l=[],u=0;u<e.length;u++){var h=e[u],c=h.geometry,f=h.type,p=0===n?h.minX:h.minY,g=0===n?h.maxX:h.maxY;if(p>=r&&g<o)l.push(h);else if(!(g<r||p>=o)){var d=[];if("Point"===f||"MultiPoint"===f)ie(c,d,r,o,n);else if("LineString"===f)se(c,d,r,o,n,!1,a.lineMetrics);else if("MultiLineString"===f)le(c,d,r,o,n,!1);else if("Polygon"===f)le(c,d,r,o,n,!0);else if("MultiPolygon"===f)for(var m=0;m<c.length;m++){var y=[];le(c[m],y,r,o,n,!0),y.length&&d.push(y);}if(d.length){if(a.lineMetrics&&"LineString"===f){for(m=0;m<d.length;m++)l.push(U(h.id,f,d[m],h.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===d.length?(f="LineString",d=d[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===d.length?"Point":"MultiPoint"),l.push(U(h.id,f,d,h.tags));}}}return l.length?l:null}function ie(e,t,r,o,n){for(var i=0;i<e.length;i+=3){var s=e[i+n];s>=r&&s<=o&&(t.push(e[i]),t.push(e[i+1]),t.push(e[i+2]));}}function se(e,t,r,o,n,i,s){for(var a,l,u=ae(e),h=0===n?he:ce,c=e.start,f=0;f<e.length-3;f+=3){var p=e[f],g=e[f+1],d=e[f+2],m=e[f+3],y=e[f+4],v=0===n?p:g,x=0===n?m:y,w=!1;s&&(a=Math.sqrt(Math.pow(p-m,2)+Math.pow(g-y,2))),v<r?x>r&&(l=h(u,p,g,m,y,r),s&&(u.start=c+a*l)):v>o?x<o&&(l=h(u,p,g,m,y,o),s&&(u.start=c+a*l)):ue(u,p,g,d),x<r&&v>=r&&(l=h(u,p,g,m,y,r),w=!0),x>o&&v<=o&&(l=h(u,p,g,m,y,o),w=!0),!i&&w&&(s&&(u.end=c+a*l),t.push(u),u=ae(e)),s&&(c+=a);}var S=e.length-3;p=e[S],g=e[S+1],d=e[S+2],(v=0===n?p:g)>=r&&v<=o&&ue(u,p,g,d),S=u.length-3,i&&S>=3&&(u[S]!==u[0]||u[S+1]!==u[1])&&ue(u,u[0],u[1],u[2]),u.length&&t.push(u);}function ae(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function le(e,t,r,o,n,i){for(var s=0;s<e.length;s++)se(e[s],t,r,o,n,i,!1);}function ue(e,t,r,o){e.push(t),e.push(r),e.push(o);}function he(e,t,r,o,n,i){var s=(i-t)/(o-t);return e.push(i),e.push(r+(n-r)*s),e.push(1),s}function ce(e,t,r,o,n,i){var s=(i-r)/(n-r);return e.push(t+(o-t)*s),e.push(i),e.push(1),s}function fe(e,t){for(var r=[],o=0;o<e.length;o++){var n,i=e[o],s=i.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)n=pe(i.geometry,t);else if("MultiLineString"===s||"Polygon"===s){n=[];for(var a=0;a<i.geometry.length;a++)n.push(pe(i.geometry[a],t));}else if("MultiPolygon"===s)for(n=[],a=0;a<i.geometry.length;a++){for(var l=[],u=0;u<i.geometry[a].length;u++)l.push(pe(i.geometry[a][u],t));n.push(l);}r.push(U(i.id,s,n,i.tags));}return r}function pe(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var o=0;o<e.length;o+=3)r.push(e[o]+t,e[o+1],e[o+2]);return r}function ge(e,t){if(e.transformed)return e;var r,o,n,i=1<<e.z,s=e.x,a=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,h=l.type;if(l.geometry=[],1===h)for(o=0;o<u.length;o+=2)l.geometry.push(de(u[o],u[o+1],t,i,s,a));else for(o=0;o<u.length;o++){var c=[];for(n=0;n<u[o].length;n+=2)c.push(de(u[o][n],u[o][n+1],t,i,s,a));l.geometry.push(c);}}return e.transformed=!0,e}function de(e,t,r,o,n,i){return [Math.round(r*(e*o-n)),Math.round(r*(t*o-i))]}function me(e,t,r,o,n){for(var i=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:o,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){s.numFeatures++,ye(s,e[a],i,n);var l=e[a].minX,u=e[a].minY,h=e[a].maxX,c=e[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),h>s.maxX&&(s.maxX=h),c>s.maxY&&(s.maxY=c);}return s}function ye(e,t,r,o){var n=t.geometry,i=t.type,s=[];if("Point"===i||"MultiPoint"===i)for(var a=0;a<n.length;a+=3)s.push(n[a]),s.push(n[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===i)ve(s,n,e,r,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(a=0;a<n.length;a++)ve(s,n[a],e,r,"Polygon"===i,0===a);else if("MultiPolygon"===i)for(var l=0;l<n.length;l++){var u=n[l];for(a=0;a<u.length;a++)ve(s,u[a],e,r,!0,0===a);}if(s.length){var h=t.tags||null;if("LineString"===i&&o.lineMetrics){for(var c in h={},t.tags)h[c]=t.tags[c];h.mapbox_clip_start=n.start/n.size,h.mapbox_clip_end=n.end/n.size;}var f={geometry:s,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:h};null!==t.id&&(f.id=t.id),e.features.push(f);}}function ve(e,t,r,o,n,i){var s=o*o;if(o>0&&t.size<(n?s:o))r.numPoints+=t.length/3;else {for(var a=[],l=0;l<t.length;l+=3)(0===o||t[l+2]>s)&&(r.numSimplified++,a.push(t[l]),a.push(t[l+1])),r.numPoints++;n&&function(e,t){for(var r=0,o=0,n=e.length,i=n-2;o<n;i=o,o+=2)r+=(e[o]-e[i])*(e[o+1]+e[i+1]);if(r>0===t)for(o=0,n=e.length;o<n/2;o+=2){var s=e[o],a=e[o+1];e[o]=e[n-2-o],e[o+1]=e[n-1-o],e[n-2-o]=s,e[n-1-o]=a;}}(a,i),e.push(a);}}function xe(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var o=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var o=0;o<e.features.length;o++)H(r,e.features[o],t,o);else H(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(o=function(e,t){var r=t.buffer/t.extent,o=e,n=ne(e,1,-1-r,r,0,-1,2,t),i=ne(e,1,1-r,2+r,0,-1,2,t);return (n||i)&&(o=ne(e,1,-r,1+r,0,-1,2,t)||[],n&&(o=fe(n,1).concat(o)),i&&(o=o.concat(fe(i,-1)))),o}(o,t)).length&&this.splitTile(o,0,0,0),r&&(o.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)));}function we(e,t,r){return 32*((1<<e)*r+t)+e}function Se(e,t){const r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);const o=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!o)return t(null,null);const n=new c(o.features);let i=m(n);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),t(null,{vectorTile:n,rawData:i.buffer});}xe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xe.prototype.splitTile=function(e,t,r,o,n,i,s){for(var a=[e,t,r,o],l=this.options,u=l.debug;a.length;){o=a.pop(),r=a.pop(),t=a.pop(),e=a.pop();var h=1<<t,c=we(t,r,o),f=this.tiles[c];if(!f&&(u>1&&console.time("creation"),f=this.tiles[c]=me(e,t,r,o,l),this.tileCoords.push({z:t,x:r,y:o}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,o,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++;}if(f.source=e,n){if(t===l.maxZoom||t===n)continue;var g=1<<n-t;if(r!==Math.floor(i/g)||o!==Math.floor(s/g))continue}else if(t===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,0!==e.length){u>1&&console.time("clipping");var d,m,y,v,x,w,S=.5*l.buffer/l.extent,M=.5-S,P=.5+S,b=1+S;d=m=y=v=null,x=ne(e,h,r-S,r+P,0,f.minX,f.maxX,l),w=ne(e,h,r+M,r+b,0,f.minX,f.maxX,l),e=null,x&&(d=ne(x,h,o-S,o+P,1,f.minY,f.maxY,l),m=ne(x,h,o+M,o+b,1,f.minY,f.maxY,l),x=null),w&&(y=ne(w,h,o-S,o+P,1,f.minY,f.maxY,l),v=ne(w,h,o+M,o+b,1,f.minY,f.maxY,l),w=null),u>1&&console.timeEnd("clipping"),a.push(d||[],t+1,2*r,2*o),a.push(m||[],t+1,2*r,2*o+1),a.push(y||[],t+1,2*r+1,2*o),a.push(v||[],t+1,2*r+1,2*o+1);}}},xe.prototype.getTile=function(e,t,r){var o=this.options,n=o.extent,i=o.debug;if(e<0||e>24)return null;var s=1<<e,a=we(e,t=(t%s+s)%s,r);if(this.tiles[a])return ge(this.tiles[a],n);i>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,h=t,c=r;!l&&u>0;)u--,h=Math.floor(h/2),c=Math.floor(c/2),l=this.tiles[we(u,h,c)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",u,h,c),i>1&&console.time("drilling down"),this.splitTile(l.source,u,h,c,e,t,r),i>1&&console.timeEnd("drilling down"),this.tiles[a]?ge(this.tiles[a],n):null):null};class Me extends e.VectorTileWorkerSource{constructor(e,t,r,o,n){super(e,t,r,o,Se),n&&(this.loadGeoJSON=n);}loadData(t,r){const o=t&&t.request,n=o&&o.collectResourceTiming;this.loadGeoJSON(t,((i,a)=>{if(i||!a)return r(i);if("object"!=typeof a)return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{s(a,!0);try{if(t.filter){const r=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const o=a.features.filter((e=>r.value.evaluate({zoom:0},e)));a={type:"FeatureCollection",features:o};}this._geoJSONIndex=t.cluster?new Z(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const o={},n={},i={accumulated:null,zoom:0},s={properties:null},a=Object.keys(r);for(const t of a){const[i,s]=r[t],a=e.createExpression(s),l=e.createExpression("string"==typeof i?[i,["accumulated"],["get",t]]:i);o[t]=a.value,n[t]=l.value;}return t.map=e=>{s.properties=e;const t={};for(const e of a)t[e]=o[e].evaluate(i,s);return t},t.reduce=(e,t)=>{s.properties=t;for(const t of a)i.accumulated=e[t],e[t]=n[t].evaluate(i,s);},t}(t)).load(a.features):function(e,t){return new xe(e,t)}(a,t.geojsonVtOptions);}catch(i){return r(i)}this.loaded={};const l={};if(n){const r=e.getPerformanceMeasurement(o);r&&(l.resourceTiming={},l.resourceTiming[t.source]=JSON.parse(JSON.stringify(r)));}r(null,l);}}));}reloadTile(e,t){const r=this.loaded;return r&&r[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,r){if(t.request)e.getJSON(t.request,r);else {if("string"!=typeof t.data)return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId));}catch(e){t(e);}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId));}catch(e){t(e);}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset));}catch(e){t(e);}}}class Pe{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t;},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText;};}clearCaches(e,t,r){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],r();}checkIfReady(e,t,r){r();}setReferrer(e,t){this.referrer=t;}spriteLoaded(t,r){this.isSpriteLoaded[t]=r;for(const o in this.workerSources[t]){const n=this.workerSources[t][o];for(const t in n)n[t]instanceof e.VectorTileWorkerSource&&(n[t].isSpriteLoaded=r,n[t].fire(new e.Event("isSpriteLoaded")));}}setImages(e,t,r){this.availableImages[e]=t;for(const r in this.workerSources[e]){const o=this.workerSources[e][r];for(const e in o)o[e].availableImages=t;}r();}enableTerrain(e,t,r){this.terrain=t,r();}setProjection(t,r){this.projections[t]=e.getProjection(r);}setLayers(e,t,r){this.getLayerIndex(e).replace(t),r();}updateLayers(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r();}loadTile(t,r,o){const n=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;n.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,r.type,r.source).loadTile(n,o);}loadDEMTile(t,r,o){const n=this.enableTerrain?e.extend({buildQuadTree:this.terrain},r):r;this.getDEMWorkerSource(t,r.source).loadTile(n,o);}reloadTile(t,r,o){const n=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;n.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,r.type,r.source).reloadTile(n,o);}abortTile(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r);}removeTile(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r);}removeSource(e,t,r){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const o=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==o.removeSource?o.removeSource(t,r):r();}loadWorkerSource(e,t,r){try{this.self.importScripts(t.url),r();}catch(e){r(e.toString());}}syncRTLPluginState(t,r,o){try{e.plugin.setState(r);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const r=e.plugin.isParsed();o(r?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),r);}}catch(e){o(e.toString());}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new o),t}getWorkerSource(e,t,r){return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][r]||(this.workerSources[e][t][r]=new this.workerSourceTypes[t]({send:(t,r,o,n,i,s)=>{this.actor.send(t,r,o,e,i,s);},scheduler:this.actor.scheduler},this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])),this.workerSources[e][t][r]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new i),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,r){e.enforceCacheSizeLimit(r);}getWorkerPerformanceMetrics(e,t,r){r(void 0,void 0);}}return "undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Pe(self)),Pe}));

define(["./shared"],(function(t){"use strict";var e=i;function i(t){return !function(t){return "undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return !1;var t,e,i=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(i);try{e=new Worker(o),t=!0;}catch(e){t=!1;}return e&&e.terminate(),URL.revokeObjectURL(o),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return !1;var i=e.getImageData(0,0,1,1);return i&&i.width===t.width}()?(void 0===o[e=t&&t.failIfMajorPerformanceCaveat]&&(o[e]=function(t){var e,o=function(t){var e=document.createElement("canvas"),o=Object.create(i.webGLContextAttributes);return o.failIfMajorPerformanceCaveat=t,e.getContext("webgl",o)||e.getContext("experimental-webgl",o)}(t);if(!o)return !1;try{e=o.createShader(o.VERTEX_SHADER);}catch(t){return !1}return !(!e||o.isContextLost())&&(o.shaderSource(e,"void main() {}"),o.compileShader(e),!0===o.getShaderParameter(e,o.COMPILE_STATUS))}(e)),o[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e;}(t)}var o={};function r(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return !1;for(let i=0;i<t.length;i++)if(!r(t[i],e[i]))return !1;return !0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return !1;if(Object.keys(t).length!==Object.keys(e).length)return !1;for(const i in t)if(!r(t[i],e[i]))return !1;return !0}return t===e}i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const n={create:function(e,i,o){const r=t.window.document.createElement(e);return void 0!==i&&(r.className=i),o&&o.appendChild(r),r},createNS:function(e,i){return t.window.document.createElementNS(e,i)}},a=t.window.document&&t.window.document.documentElement.style,s=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let l;n.disableDrag=function(){a&&s&&(l=a[s],a[s]="none");},n.enableDrag=function(){a&&s&&(a[s]=l);},n.setTransform=function(t,e){t.style.transform=e;};let c=!1;try{const e=Object.defineProperty({},"passive",{get(){c=!0;}});t.window.addEventListener("test",e,e),t.window.removeEventListener("test",e,e);}catch(t){c=!1;}n.addEventListener=function(t,e,i,o={}){t.addEventListener(e,i,"passive"in o&&c?o:o.capture);},n.removeEventListener=function(t,e,i,o={}){t.removeEventListener(e,i,"passive"in o&&c?o:o.capture);};const h=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",h,!0);};function u(e,i,o){const r=e.offsetWidth===i.width?1:e.offsetWidth/i.width;return new t.pointGeometry((o.clientX-i.left)*r,(o.clientY-i.top)*r)}function d(t,e){var i=e[0],o=e[1],r=e[2],n=e[3],a=i*n-r*o;return a?(t[0]=n*(a=1/a),t[1]=-o*a,t[2]=-r*a,t[3]=i*a,t):null}n.suppressClick=function(){t.window.addEventListener("click",h,!0),t.window.setTimeout((()=>{t.window.removeEventListener("click",h,!0);}),0);},n.mousePos=function(t,e){const i=t.getBoundingClientRect();return u(t,i,e)},n.touchPos=function(t,e){const i=t.getBoundingClientRect(),o=[];for(let r=0;r<e.length;r++)o.push(u(t,i,e[r]));return o},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t);};class _{constructor(t,e){this.pos=t,this.dir=e;}intersectsPlane(e,i,o){const r=t.dot(i,this.dir);if(Math.abs(r)<1e-6)return !1;const n=t.dot(t.sub(t.create(),e,this.pos),i)/r,a=t.scaleAndAdd(t.create(),this.pos,this.dir,n);return t.copy(o,a),!0}}class m{constructor(t,e){this.points=t,this.planes=e;}static fromInvProjectionMatrix(e,i,o){const r=Math.pow(2,o),n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((o=>{const n=t.transformMat4([],o,e),a=1/n[3]/i*r;return t.mul(n,n,[a,a,1/n[3],a])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const i=t.sub([],n[e[0]],n[e[1]]),o=t.sub([],n[e[2]],n[e[1]]),r=t.normalize([],t.cross([],i,o)),a=-t.dot(r,n[e[1]]);return r.concat(a)}));return new m(n,a)}}class p{constructor(e,i){this.min=e,this.max=i,this.center=t.scale([],t.add([],this.min,this.max),.5);}quadrant(e){const i=[e%2==0,e<2],o=t.clone(this.min),r=t.clone(this.max);for(let t=0;t<i.length;t++)o[t]=i[t]?this.min[t]:this.center[t],r[t]=i[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new p(o,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}intersects(e){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let o=!0;for(let r=0;r<e.planes.length;r++){const n=e.planes[r];let a=0;for(let e=0;e<i.length;e++)a+=t.dot$1(n,i[e])>=0;if(0===a)return 0;a!==i.length&&(o=!1);}if(o)return 2;for(let t=0;t<3;t++){let i=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const n=e.points[r][t]-this.min[t];i=Math.min(i,n),o=Math.max(o,n);}if(o<0||i>this.max[t]-this.min[t])return 0}return 1}}function f(t){const{userImage:e}=t;return !!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class g extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0;}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[];}}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e);}_validate(e,i){let o=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),o=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),o=!1),this._validateContent(i.content,i)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),o=!1),o}_validateStretch(t,e){if(!t)return !0;let i=0;for(const o of t){if(o[0]<i||o[1]<o[0]||e<o[1])return !1;i=o[1];}return !0}_validateContent(t,e){return !(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0;}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove();}listImages(){return Object.keys(this.images)}getImages(t,e){let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e});}_notify(e,i){const o={};for(const i of e){this.images[i]||this.fire(new t.Event("styleimagemissing",{id:i}));const e=this.images[i];e?o[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);}i(null,o);}getPixelSize(){const{width:t,height:e}=this.atlasImage;return {width:t,height:e}}getPattern(e){const i=this.patterns[e],o=this.getImage(e);if(!o)return null;if(i&&i.position.version===o.version)return i.position;if(i)i.position.version=o.version;else {const i={w:o.data.width+2,h:o.data.height+2,x:0,y:0},r=new t.ImagePosition(i,o);this.patterns[e]={bin:i,position:r};}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE);}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:i,h:o}=t.potpack(e),r=this.atlasImage;r.resize({width:i||1,height:o||1});for(const e in this.patterns){const{bin:i}=this.patterns[e],o=i.x+1,n=i.y+1,a=this.images[e].data,s=a.width,l=a.height;t.RGBAImage.copy(a,r,{x:0,y:0},{x:o,y:n},{width:s,height:l}),t.RGBAImage.copy(a,r,{x:0,y:l-1},{x:o,y:n-1},{width:s,height:1}),t.RGBAImage.copy(a,r,{x:0,y:0},{x:o,y:n+l},{width:s,height:1}),t.RGBAImage.copy(a,r,{x:s-1,y:0},{x:o-1,y:n},{width:1,height:l}),t.RGBAImage.copy(a,r,{x:0,y:0},{x:o+s,y:n},{width:1,height:l});}this.dirty=!0;}beginFrame(){this.callbackDispatchedThisFrame={};}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];f(t)&&this.updateImage(e,t);}}}const v=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position;}possiblyEvaluate(e,i){return function([e,i,o]){const r=t.degToRad(i+90),n=t.degToRad(o);return {x:e*Math.cos(r)*Math.sin(n),y:e*Math.sin(r)*Math.sin(n),z:e*Math.cos(n),azimuthal:i,polar:o}}(e.expression.evaluate(i))}interpolate(e,i,o){return {x:t.number(e.x,i.x,o),y:t.number(e.y,i.y,o),z:t.number(e.z,i.z,o),azimuthal:t.number(e.azimuthal,i.azimuthal,o),polar:t.number(e.polar,i.polar,o)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),x="-transition";class y extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(v),this.setLight(e),this._transitioning=this._transitionable.untransitioned();}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(t.validateLight,e,i))for(const i in e){const o=e[i];t.endsWith(i,x)?this._transitionable.setTransition(i.slice(0,-x.length),o):this._transitionable.setValue(i,o);}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning);}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t);}_validate(e,i,o){return (!o||!1!==o.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const b=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)}),w="-transition";class T extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(b),this.set(e),this._transitioning=this._transitionable.untransitioned();}get(){return this._transitionable.serialize()}set(e){for(const i in e){const o=e[i];t.endsWith(i,w)?this._transitionable.setTransition(i.slice(0,-w.length),o):this._transitionable.setValue(i,o);}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning);}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t);}}function E(e,i,o,r){const n=t.smoothstep(45,65,o),[a,s]=C(e,r),l=t.length(i);let c=1-Math.min(1,Math.exp((l-a)/(s-a)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*n*e.alpha}function C(t,e){const i=.5/Math.tan(.5*e);return [t.range[0]+i,t.range[1]+i]}const S=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"])}),M="-transition";class I extends t.Evented{constructor(e,i){super(),this._transitionable=new t.Transitionable(S),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=i;}isSoftDisabled(){return "mercator"!==this._transform.projection.name}get state(){return {range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,i={}){if(!this._validate(t.validateFog,e,i))for(const i in e){const o=e[i];t.endsWith(i,M)?this._transitionable.setTransition(i.slice(0,-M.length),o):this._transitionable.setValue(i,o);}}getOpacity(e){if(this.isSoftDisabled())return 0;const i=this.properties&&this.properties.get("color")||1;return t.smoothstep(45,65,e)*i.a}getOpacityAtLatLng(e,i){return this.isSoftDisabled()?0:function(e,i,o){const r=t.MercatorCoordinate.fromLngLat(i),n=o.elevation?o.elevation.getAtPointOrZero(r):0,a=[r.x,r.y,n];return t.transformMat4$1(a,a,o.mercatorFogMatrix),E(e,a,o.pitch,o._fov)}(this.state,e,i)}getFovAdjustedRange(t){return this.isSoftDisabled()?[0,1]:C(this.state,t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning);}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t);}_validate(e,i,o){return (!o||!1!==o.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class z{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const o=this.workerPool.acquire(this.id);for(let t=0;t<o.length;t++){const e=new z.Actor(o[t],i,this.id);e.name=`Worker ${t}`,this.actors.push(e);}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0;}));}broadcast(e,i,o){t.asyncAll(this.actors,((t,o)=>{t.send(e,i,o);}),o=o||function(){});}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove();})),this.actors=[],this.workerPool.release(this.id);}}function A(e,i,o){return i*(t.EXTENT/(e.tileSize*Math.pow(2,o-e.tileID.overscaledZ)))}z.Actor=t.Actor;class D{constructor(t,e,i,o){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map((t=>o.pointCoordinate3D(t))),this.cameraGeometry=this.bufferedCameraGeometry(0);}static createFromScreenPoints(e,i){let o,r;if(e instanceof t.pointGeometry||"number"==typeof e[0]){const n=t.pointGeometry.convert(e);o=[t.pointGeometry.convert(e)],r=i.isPointAboveHorizon(n);}else {const n=t.pointGeometry.convert(e[0]),a=t.pointGeometry.convert(e[1]);o=[n,a],r=t.polygonizeBounds(n,a).every((t=>i.isPointAboveHorizon(t)));}return new D(o,i.getCameraPoint(),r,i)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const i=this.screenBounds[0],o=1===this.screenBounds.length?this.screenBounds[0].add(new t.pointGeometry(1,1)):this.screenBounds[1],r=t.polygonizeBounds(i,o,0,!1);return this.cameraPoint.y>o.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<o.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=o.x?r[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(r[3]=this.cameraPoint)),t.bufferConvexPolygon(r,e)}containsTile(e,i,o){const r=e.queryPadding+1,n=e.tileID.wrap,a=o?this._bufferedCameraMercator(r,i).map((i=>t.getTilePoint(e.tileTransform,i,n))):this._bufferedScreenMercator(r,i).map((i=>t.getTilePoint(e.tileTransform,i,n))),s=this.screenGeometryMercator.map((i=>t.getTileVec3(e.tileTransform,i,n))),l=s.map((e=>new t.pointGeometry(e[0],e[1]))),c=i.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),h=t.getTileVec3(e.tileTransform,c,n),u=s.map((e=>{const i=t.sub(e,e,h);return t.normalize(i,i),new _(h,i)})),d=A(e,1,i.zoom);if(t.polygonIntersectsBox(a,0,0,t.EXTENT,t.EXTENT))return {queryGeometry:this,tilespaceGeometry:l,tilespaceRays:u,bufferedTilespaceGeometry:a,bufferedTilespaceBounds:(m=t.getBounds(a),m.min.x=t.clamp(m.min.x,0,t.EXTENT),m.min.y=t.clamp(m.min.y,0,t.EXTENT),m.max.x=t.clamp(m.max.x,0,t.EXTENT),m.max.y=t.clamp(m.max.y,0,t.EXTENT),m),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:d};var m;}_bufferedScreenMercator(t,e){const i=P(t);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{const o=this.bufferedScreenGeometry(t).map((t=>e.pointCoordinate3D(t)));return this._screenRaycastCache[i]=o,o}}_bufferedCameraMercator(t,e){const i=P(t);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{const o=this.bufferedCameraGeometry(t).map((t=>e.pointCoordinate3D(t)));return this._cameraRaycastCache[i]=o,o}}}function P(t){return 100*t|0}function L(e,i,o){const r=function(r,n){if(r)return o(r);if(n){const r=t.pick(t.extend(n,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);n.vector_layers&&(r.vectorLayers=n.vector_layers,r.vectorLayerIds=r.vectorLayers.map((t=>t.id))),r.tiles=i.canonicalizeTileset(r,e.url),o(null,r);}};return e.url?t.getJSON(i.transformRequest(i.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.exported.frame((()=>r(null,e)))}class R{constructor(e,i,o){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=o||24;}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),o=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*i),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*i),n=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*i),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*i);return e.x>=o&&e.x<n&&e.y>=r&&e.y<a}}class k{constructor(t,e,i){this.context=t;const o=t.gl;this.buffer=o.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer;}bind(){this.context.bindElementBuffer.set(this.buffer);}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer);}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer);}}const F={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class B{constructor(t,e,i,o){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=o,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer;}bind(){this.context.bindVertexBuffer.set(this.buffer);}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer);}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const o=e.attributes[this.attributes[i].name];void 0!==o&&t.enableVertexAttribArray(o);}}setVertexAttribPointers(t,e,i){for(let o=0;o<this.attributes.length;o++){const r=this.attributes[o],n=e.attributes[r.name];void 0!==n&&t.vertexAttribPointer(n,r.components,t[F[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0));}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer);}}class O{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1;}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default);}}class U extends O{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1);}}class N extends O{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1);}}class G extends O{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1);}}class Z extends O{getDefault(){return [!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1);}}class j extends O{getDefault(){return !0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1);}}class V extends O{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1);}}class W extends O{getDefault(){return {func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1);}}class q extends O{getDefault(){const t=this.gl;return [t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1);}}class X extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1;}}class $ extends O{getDefault(){return [0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1);}}class H extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1;}}class K extends O{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1);}}class Y extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1;}}class J extends O{getDefault(){const t=this.gl;return [t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1);}}class Q extends O{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1);}}class tt extends O{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1);}}class et extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1;}}class it extends O{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1);}}class ot extends O{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1);}}class rt extends O{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1);}}class nt extends O{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1);}}class at extends O{getDefault(){const t=this.gl;return [0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1);}}class st extends O{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1;}}class lt extends O{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1;}}class ct extends O{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1;}}class ht extends O{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1;}}class ut extends O{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1;}}class dt extends O{constructor(t){super(t),this.vao=t.extVertexArrayObject;}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1);}}class _t extends O{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1;}}class mt extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1;}}class pt extends O{getDefault(){return !1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1;}}class ft extends O{constructor(t,e){super(t),this.context=t,this.parent=e;}getDefault(){return null}}class gt extends ft{setDirty(){this.dirty=!0;}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1;}}class vt extends ft{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1;}}class xt extends vt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class yt{constructor(t,e,i,o){this.context=t,this.width=e,this.height=i;const r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new gt(t,r),o&&(this.depthAttachment=new vt(t,r));}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e);}t.deleteFramebuffer(this.framebuffer);}}class bt{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new U(this),this.clearDepth=new N(this),this.clearStencil=new G(this),this.colorMask=new Z(this),this.depthMask=new j(this),this.stencilMask=new V(this),this.stencilFunc=new W(this),this.stencilOp=new q(this),this.stencilTest=new X(this),this.depthRange=new $(this),this.depthTest=new H(this),this.depthFunc=new K(this),this.blend=new Y(this),this.blendFunc=new J(this),this.blendColor=new Q(this),this.blendEquation=new tt(this),this.cullFace=new et(this),this.cullFaceSide=new it(this),this.frontFace=new ot(this),this.program=new rt(this),this.activeTexture=new nt(this),this.viewport=new at(this),this.bindFramebuffer=new st(this),this.bindRenderbuffer=new lt(this),this.bindTexture=new ct(this),this.bindVertexBuffer=new ht(this),this.bindElementBuffer=new ut(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new dt(this),this.pixelStoreUnpack=new _t(this),this.pixelStoreUnpackPremultiplyAlpha=new mt(this),this.pixelStoreUnpackFlipY=new pt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE);}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault();}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0;}createIndexBuffer(t,e){return new k(this,t,e)}createVertexBuffer(t,e,i){return new B(this,t,e,i)}createRenderbuffer(t,e,i){const o=this.gl,r=o.createRenderbuffer();return this.bindRenderbuffer.set(r),o.renderbufferStorage(o.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,i){return new yt(this,t,e,i)}clear({color:t,depth:e,stencil:i}){const o=this.gl;let r=0;t&&(r|=o.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(r|=o.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),o.clear(r);}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace));}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1);}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1);}setColorMode(e){r(e.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask);}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null);}}class wt extends t.Evented{constructor(e,i,o,r){super(),this.id=e,this.dispatcher=o,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]));}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=L(this._options,this.map._requestManager,((e,i)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new R(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})));}));}loaded(){return this._loaded}onAdd(t){this.map=t,this.load();}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null);}serialize(){return t.extend({},this._options)}hasTile(t){return !this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,i){const o=t.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),o,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),((o,r,n,a)=>{if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(o)e.state="errored",i(o);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:n,expires:a});const o=this.map.painter.context,s=o.gl;e.texture=this.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new t.Texture(o,r,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),o.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),i(null);}}));}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e();}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e();}hasTransition(){return !1}}let Tt;class Et extends t.Evented{constructor(t,e,i,o){super(),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=e;}load(e,i){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),((o,r)=>{this._loaded=!0,o?this.fire(new t.ErrorEvent(o)):r&&(this.image=t.exported.getImageData(r),e&&(this.coordinates=e),i&&i(),this._finishLoading());}));}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null;})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})));}onAdd(t){this.map=t,this.load();}setCoordinates(e){this.coordinates=e,delete this._boundsArray;const i=e.map(t.MercatorCoordinate.fromLngLat);return this.tileID=function(e){let i=1/0,o=1/0,r=-1/0,n=-1/0;for(const t of e)i=Math.min(i,t.x),o=Math.min(o,t.y),r=Math.max(r,t.x),n=Math.max(n,t.y);const a=Math.max(r-i,n-o),s=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),l=Math.pow(2,s);return new t.CanonicalTileID(s,Math.floor((i+r)/2*l),Math.floor((o+n)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray;}_makeBoundsArray(){const e=t.tileTransform(this.tileID,this.map.transform.projection),i=this.coordinates.map((i=>{const o=e.projection.project(i[0],i[1]);return t.getTilePoint(e,o)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,i=e.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture);}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null));}serialize(){return {type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return !1}}const Ct={vector:class extends t.Evented{constructor(e,i,o,r){if(super(),this.id=e,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(i,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new t.DedupedRequest;}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=L(this._options,this.map._requestManager,((e,i)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new R(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})));}));}loaded(){return this._loaded}hasTile(t){return !this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load();}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t();const e=this.map.style._getSourceCaches(this.id);for(const t of e)t.clearTiles();this.load();}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t;})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t;})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null);}serialize(){return t.extend({},this._options)}loadTile(e,i){const o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(o,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=i:e.request=e.actor.send("reloadTile",r,n.bind(this));else if(e.actor=this._tileWorkers[o]=this._tileWorkers[o]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",r,n.bind(this),void 0,!0);else {const i=t.loadVectorTile.call({deduped:this._deduped},r,((t,i)=>{t||!i?n.call(this,t):(r.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},e.actor&&e.actor.send("loadTile",r,n.bind(this),void 0,!0));}),!0);e.request={cancel:i};}function n(o,r){return delete e.request,e.aborted?i(null):o&&404!==o.status?i(o):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id});}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id});}hasTransition(){return !1}afterUpdate(){this._tileWorkers={};}},raster:wt,"raster-dem":class extends wt{constructor(e,i,o,r){super(e,i,o,r),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox";}loadTile(e,i){const o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(t,o){t&&(e.state="errored",i(t)),o&&(e.dem=o,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",i(null));}e.request=t.getImage(this.map._requestManager.transformRequest(o,t.ResourceType.Tile),function(o,n,a,s){if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(o)e.state="errored",i(o);else if(n){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:a,expires:s});const i=t.window.ImageBitmap&&n instanceof t.window.ImageBitmap&&(null==Tt&&(Tt=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),Tt),o=1-(n.width-t.prevPowerOfTwo(n.width))/2;o<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=i?n:t.exported.getImageData(n,o),c={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:o};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",c,r.bind(this),void 0,!0));}}.bind(this));}_getNeighboringTiles(e){const i=e.canonical,o=Math.pow(2,i.z),r=(i.x-1+o)%o,n=0===i.x?e.wrap-1:e.wrap,a=(i.x+1+o)%o,s=i.x+1===o?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,n,i.z,r,i.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y).key]={backfilled:!1},i.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,n,i.z,r,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y-1).key]={backfilled:!1}),i.y+1<o&&(l[new t.OverscaledTileID(e.overscaledZ,n,i.z,r,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded";}},geojson:class extends t.Evented{constructor(e,i,o,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(r),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const n=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*n,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*n,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*n,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions);}onAdd(t){this.map=t,this.setData(this._data);}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,i,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},o),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(i),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,((e,i)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else {const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(e.resourceTiming=i.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0;}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1);}));}loaded(){return this._loaded}loadTile(e,i){const o=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(o,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((t,r)=>(delete e.request,e.unloadVectorData(),e.aborted?i(null):t?i(t):(e.loadVectorData(r,this.map.painter,"reloadTile"===o),i(null)))),void 0,"loadTile"===o);}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0;}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id});}onRemove(){this._pendingLoad&&this._pendingLoad.cancel();}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return !1}},video:class extends Et{constructor(t,e,i,o){super(t,e,i,o),this.roundZoom=!0,this.type="video",this.options=e;}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,t.ResourceType.Source).url);t.getVideo(this.urls,((e,i)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint();})),this.map&&this.video.play(),this._finishLoading());}));}pause(){this.video&&this.video.pause();}play(){this.video&&this.video.play();}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e;}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)));}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture);}}serialize(){return {type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Et,canvas:class extends Et{constructor(e,i,o,r){super(e,i,o,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate;}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint();},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1);},this._finishLoading());}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play();}onRemove(){this.pause();}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,o=i.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,t.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(i,this.canvas,o.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture);}}serialize(){return {type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of [this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return !0;return !1}}},St=function(e,i,o,r){const n=new Ct[i.type](e,i,o,r);if(n.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${n.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],n),n};function Mt(e,i){const o=t.identity([]);return t.scale$1(o,o,[.5*e.width,.5*-e.height,1]),t.translate(o,o,[1,-1,0]),t.multiply(o,o,e.calculateProjMatrix(i.toUnwrapped()))}function It(t,e,i,o,r,n,a,s=!1){const l=t.tilesIn(o,a,s);l.sort(At);const c=[];for(const o of l)c.push({wrappedTileID:o.tile.tileID.wrapped().key,queryResults:o.tile.queryRenderedFeatures(e,i,t._state,o,r,n,Mt(t.transform,o.tile.tileID),s)});const h=function(t){const e={},i={};for(const o of t){const t=o.queryResults,r=o.wrappedTileID,n=i[r]=i[r]||{};for(const i in t){const o=t[i],r=n[i]=n[i]||{},a=e[i]=e[i]||[];for(const t of o)r[t.featureIndex]||(r[t.featureIndex]=!0,a.push(t));}}return e}(c);for(const e in h)h[e].forEach((e=>{const i=e.feature,o=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o;}));return h}function zt(t,e){const i=t.getRenderableIds().map((e=>t.getTileByID(e))),o=[],r={};for(let t=0;t<i.length;t++){const n=i[t],a=n.tileID.canonical.key;r[a]||(r[a]=!0,n.querySourceFeatures(o,e));}return o}function At(t,e){const i=t.tileID,o=e.tileID;return i.overscaledZ-o.overscaledZ||i.canonical.y-o.canonical.y||i.wrap-o.wrap||i.canonical.x-o.canonical.x}function Dt(){return null!=Qr.workerClass?new Qr.workerClass:new t.window.Worker(Qr.workerUrl)}const Pt="mapboxgl_preloaded_worker_pool";class Lt{constructor(){this.active={};}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Lt.workerCount;)this.workers.push(new Dt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate();})),this.workers=null);}isPreloaded(){return !!this.active[Pt]}numActive(){return Object.keys(this.active).length}}let Rt;function kt(){return Rt||(Rt=new Lt),Rt}function Ft(e,i){const o={};for(const t in e)"ref"!==t&&(o[t]=e[t]);return t.refProperties.forEach((t=>{t in i&&(o[t]=i[t]);})),o}function Bt(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=Ft(t[i],e[t[i].ref]));return t}Lt.workerCount=2;const Ot={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ut(t,e,i){i.push({command:Ot.addSource,args:[t,e[t]]});}function Nt(t,e,i){e.push({command:Ot.removeSource,args:[t]}),i[t]=!0;}function Gt(t,e,i,o){Nt(t,i,o),Ut(t,e,i);}function Zt(t,e,i){let o;for(o in t[i])if(t[i].hasOwnProperty(o)&&"data"!==o&&!r(t[i][o],e[i][o]))return !1;for(o in e[i])if(e[i].hasOwnProperty(o)&&"data"!==o&&!r(t[i][o],e[i][o]))return !1;return !0}function jt(t,e,i,o,n,a){let s;for(s in e=e||{},t=t||{})t.hasOwnProperty(s)&&(r(t[s],e[s])||i.push({command:a,args:[o,s,e[s],n]}));for(s in e)e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(r(t[s],e[s])||i.push({command:a,args:[o,s,e[s],n]}));}function Vt(t){return t.id}function Wt(t,e){return t[e.id]=e,t}class qt{constructor(t,e){this.reset(t,e);}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding;}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let i=1,o=this._distances[i];const r=e*this.paddedLength+this.padding;for(;o<r&&i<this._distances.length;)o=this._distances[++i];const n=i-1,a=this._distances[n],s=o-a,l=s>0?(r-a)/s:0;return this.points[n].mult(1-l).add(this.points[i].mult(l))}}class Xt{constructor(t,e,i){const o=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)o.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0;}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,o,r){this._forEachCell(e,i,o,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(r);}insertCircle(t,e,i,o){this._forEachCell(e-o,i-o,e+o,i+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(o);}_insertBoxCell(t,e,i,o,r,n){this.boxCells[r].push(n);}_insertCircleCell(t,e,i,o,r,n){this.circleCells[r].push(n);}_query(t,e,i,o,r,n){if(i<0||t>this.width||o<0||e>this.height)return !r&&[];const a=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=o){if(r)return !0;for(let t=0;t<this.boxKeys.length;t++)a.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],o=this.circles[3*t+2];a.push({key:this.circleKeys[t],x1:e-o,y1:i-o,x2:e+o,y2:i+o});}return n?a.filter(n):a}return this._forEachCell(t,e,i,o,this._queryCell,a,{hitTest:r,seenUids:{box:{},circle:{}}},n),r?a.length>0:a}_queryCircle(t,e,i,o,r){const n=t-i,a=t+i,s=e-i,l=e+i;if(a<0||n>this.width||l<0||s>this.height)return !o&&[];const c=[];return this._forEachCell(n,s,a,l,this._queryCellCircle,c,{hitTest:o,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},r),o?c.length>0:c}query(t,e,i,o,r){return this._query(t,e,i,o,!1,r)}hitTest(t,e,i,o,r){return this._query(t,e,i,o,!0,r)}hitTestCircle(t,e,i,o){return this._queryCircle(t,e,i,!0,o)}_queryCell(t,e,i,o,r,n,a,s){const l=a.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const h of c)if(!l.box[h]){l.box[h]=!0;const c=4*h;if(t<=r[c+2]&&e<=r[c+3]&&i>=r[c+0]&&o>=r[c+1]&&(!s||s(this.boxKeys[h]))){if(a.hitTest)return n.push(!0),!0;n.push({key:this.boxKeys[h],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]});}}}const h=this.circleCells[r];if(null!==h){const r=this.circles;for(const c of h)if(!l.circle[c]){l.circle[c]=!0;const h=3*c;if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],t,e,i,o)&&(!s||s(this.circleKeys[c]))){if(a.hitTest)return n.push(!0),!0;{const t=r[h],e=r[h+1],i=r[h+2];n.push({key:this.circleKeys[c],x1:t-i,y1:e-i,x2:t+i,y2:e+i});}}}}}_queryCellCircle(t,e,i,o,r,n,a,s){const l=a.circle,c=a.seenUids,h=this.boxCells[r];if(null!==h){const t=this.bboxes;for(const e of h)if(!c.box[e]){c.box[e]=!0;const i=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!s||s(this.boxKeys[e])))return n.push(!0),!0}}const u=this.circleCells[r];if(null!==u){const t=this.circles;for(const e of u)if(!c.circle[e]){c.circle[e]=!0;const i=3*e;if(this._circlesCollide(t[i],t[i+1],t[i+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[e])))return n.push(!0),!0}}}_forEachCell(t,e,i,o,r,n,a,s){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),h=this._convertToXCellCoord(i),u=this._convertToYCellCoord(o);for(let d=l;d<=h;d++)for(let l=c;l<=u;l++)if(r.call(this,t,e,i,o,this.xCellCount*l+d,n,a,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,o,r,n){const a=o-t,s=r-e,l=i+n;return l*l>a*a+s*s}_circleAndRectCollide(t,e,i,o,r,n,a){const s=(n-o)/2,l=Math.abs(t-(o+s));if(l>s+i)return !1;const c=(a-r)/2,h=Math.abs(e-(r+c));if(h>c+i)return !1;if(l<=s||h<=c)return !0;const u=l-s,d=h-c;return u*u+d*d<=i*i}}const $t=Math.tan(85*Math.PI/180);function Ht(e,i,o,r,n){const a=t.create$1();if(i){const e=d([],n);a[0]=e[0],a[1]=e[1],a[4]=e[2],a[5]=e[3],o||t.rotateZ(a,a,r.angle);}else t.multiply(a,r.labelPlaneMatrix,e);return a}function Kt(e,i,o,r,n){if(i){const i=t.clone$1(e),a=t.identity([]);return a[0]=n[0],a[1]=n[1],a[4]=n[2],a[5]=n[3],t.multiply(i,i,a),o||t.rotateZ(i,i,-r.angle),i}return r.glCoordMatrix}function Yt(e,i,o=0){const r=[e.x,e.y,o,1];o?t.transformMat4(r,r,i):ce(r,r,i);const n=r[3];return {point:new t.pointGeometry(r[0]/n,r[1]/n),signedDistanceFromCamera:n}}function Jt(t,e){return Math.min(.5+t/e*.5,1.5)}function Qt(t,e){const i=t[0]/t[3],o=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&o>=-e[1]&&o<=e[1]}function te(e,i,o,r,n,a,s,l,c){const h=r?e.textSizeData:e.iconSizeData,u=t.evaluateSizeForZoom(h,o.transform.zoom),d=[256/o.width*2+1,256/o.height*2+1],_=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;_.clear();const m=e.lineVertexArray,p=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,f=o.transform.width/o.transform.height;let g=!1;for(let r=0;r<p.length;r++){const v=p.get(r);if(v.writingMode!==t.WritingMode.vertical||g||0!==r&&p.get(r-1).writingMode===t.WritingMode.horizontal||(g=!0),v.hidden||v.writingMode===t.WritingMode.vertical&&!g){le(v.numGlyphs,_);continue}g=!1;const x=new t.pointGeometry(v.tileAnchorX,v.tileAnchorY),y=c?c(x):0,b=[x.x,x.y,y],w=[...b,1];if(t.transformMat4(w,w,i),!Qt(w,d)){le(v.numGlyphs,_);continue}const T=Jt(o.transform.cameraToCenterDistance,w[3]),E=t.evaluateSizeForFeature(h,u,v),C=s?E/T:E*T,S=Yt(new t.pointGeometry(b[0],b[1]),n,b[2]);if(S.signedDistanceFromCamera<=0){le(v.numGlyphs,_);continue}let M={};const I=s?null:c,z=oe(v,C,!1,l,i,n,a,e.glyphOffsetArray,m,_,S.point,x,M,f,I);g=z.useVertical,I&&z.needsFlipping&&(M={}),(z.notEnoughRoom||g||z.needsFlipping&&oe(v,C,!0,l,i,n,a,e.glyphOffsetArray,m,_,S.point,x,M,f,I).notEnoughRoom)&&le(v.numGlyphs,_);}r?e.text.dynamicLayoutVertexBuffer.updateData(_):e.icon.dynamicLayoutVertexBuffer.updateData(_);}function ee(t,e,i,o,r,n,a,s,l,c,h,u,d){const _=s.glyphStartIndex+s.numGlyphs,m=s.lineStartIndex,p=s.lineStartIndex+s.lineLength,f=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(_-1),v=ae(t*f,i,o,r,n,a,s.segment,m,p,l,c,h,u,d,!0);if(!v)return null;const x=ae(t*g,i,o,r,n,a,s.segment,m,p,l,c,h,u,d,!0);return x?{first:v,last:x}:null}function ie(e,i,o,r){return e.writingMode===t.WritingMode.horizontal&&Math.abs(o.y-i.y)>Math.abs(o.x-i.x)*r?{useVertical:!0}:e.writingMode===t.WritingMode.vertical?i.y<o.y?{needsFlipping:!0}:null:0!==e.flipState&&function(t,e,i){const o=(e.x-t.x)*i;return 0===o||Math.abs((e.y-t.y)/o)>$t}(i,o,r)?1===e.flipState?{needsFlipping:!0}:null:i.x>o.x?{needsFlipping:!0}:null}function oe(e,i,o,r,n,a,s,l,c,h,u,d,_,m,p){const f=i/24,g=e.lineOffsetX*f,v=e.lineOffsetY*f;let x;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,i=e.lineStartIndex,n=e.lineStartIndex+e.lineLength,h=ee(f,l,g,v,o,u,d,e,c,a,_,p,!1);if(!h)return {notEnoughRoom:!0};const y=Yt(h.first.point,s).point,b=Yt(h.last.point,s).point;if(r&&!o){const t=ie(e,y,b,m);if(e.flipState=t&&t.needsFlipping?1:2,t)return t}x=[h.first];for(let r=e.glyphStartIndex+1;r<t-1;r++)x.push(ae(f*l.getoffsetX(r),g,v,o,u,d,e.segment,i,n,c,a,_,p,!1,!1));x.push(h.last);}else {if(r&&!o){const i=Yt(d,n).point,o=e.lineStartIndex+e.segment+1,r=new t.pointGeometry(c.getx(o),c.gety(o)),a=Yt(r,n),s=ie(e,i,a.signedDistanceFromCamera>0?a.point:ne(d,r,i,1,n,void 0),m);if(e.flipState=s&&s.needsFlipping?1:2,s)return s}const i=ae(f*l.getoffsetX(e.glyphStartIndex),g,v,o,u,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,_,p,!1,!1);if(!i)return {notEnoughRoom:!0};x=[i];}for(const e of x)t.addDynamicAttributes(h,e.point,e.angle);return {}}function re(e,i,o){const r={x:e.x,y:e.y,z:0};if(!o)return Yt(r,i,r.z);const n=o(e);return Yt(new t.pointGeometry(r.x,r.y),i,r.z+n)}function ne(t,e,i,o,r,n){const a=re(t.add(t.sub(e)._unit()),r,n).point,s=i.sub(a);return i.add(s._mult(o/s.mag()))}function ae(e,i,o,r,n,a,s,l,c,h,u,d,_,m,p){const f=r?e-i:e+i;let g=f>0?1:-1,v=0;r&&(g*=-1,v=Math.PI),g<0&&(v+=Math.PI);let x=g>0?l+s:l+s+1,y=n,b=n,w=0,T=0;const E=Math.abs(f),C=[],S=[];let M=a;const I=()=>{const e=x-g;return 0===w?a:new t.pointGeometry(h.getx(e),h.gety(e))},z=()=>ne(I(),M,b,E-w+1,u,_);for(;w+T<=E;){if(x+=g,x<l||x>=c)return null;if(b=y,C.push(y),m&&S.push(M||I()),y=d[x],void 0===y){M=new t.pointGeometry(h.getx(x),h.gety(x));const e=re(M,u,_);y=e.signedDistanceFromCamera>0?d[x]=e.point:z();}else M=null;w+=T,T=b.dist(y);}p&&_&&(M=M||new t.pointGeometry(h.getx(x),h.gety(x)),d[x]=y=void 0===d[x]?y:z(),T=b.dist(y));const A=(E-w)/T,D=y.sub(b),P=D.mult(A)._add(b);o&&P._add(D._unit()._perp()._mult(o*g));const L=v+Math.atan2(y.y-b.y,y.x-b.x);return C.push(P),m&&(M=M||new t.pointGeometry(h.getx(x),h.gety(x)),S.push(function(e,i,o){const r=1-o;return new t.pointGeometry(e.x*r+i.x*o,e.y*r+i.y*o)}(S.length>0?S[S.length-1]:M,M,A))),{point:P,angle:L,path:C,tilePath:S}}const se=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function le(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(se,3*t);}}function ce(t,e,i){const o=e[0],r=e[1];return t[0]=i[0]*o+i[4]*r+i[12],t[1]=i[1]*o+i[5]*r+i[13],t[3]=i[3]*o+i[7]*r+i[15],t}const he=100;class ue{constructor(t,e,i=new Xt(t.width+200,t.height+200,25),o=new Xt(t.width+200,t.height+200,25)){this.transform=t,this.grid=i,this.ignoredGrid=o,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+he,this.screenBottomBoundary=t.height+he,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e;}placeCollisionBox(t,e,i,o,r,n,a){let s=e.projectedAnchorZ;e.elevation&&(s+=e.elevation);const l=this.projectAndGetPerspectiveRatio(n,e.projectedAnchorX,e.projectedAnchorY,s,e.tileID),c=r*l.perspectiveRatio,h=(e.x1*t+i.x-e.padding)*c+l.point.x,u=(e.y1*t+i.y-e.padding)*c+l.point.y,d=(e.x2*t+i.x+e.padding)*c+l.point.x,_=(e.y2*t+i.y+e.padding)*c+l.point.y,m=l.perspectiveRatio<=.55||l.aboveHorizon;return !this.isInsideGrid(h,u,d,_)||!o&&this.grid.hitTest(h,u,d,_,a)||m?{box:[],offscreen:!1}:{box:[h,u,d,_],offscreen:this.isOffscreen(h,u,d,_)}}placeCollisionCircles(e,i,o,r,n,a,s,l,c,h,u,d,_,m){const p=[],f=this.transform.elevation,g=f?t=>f.getAtTileOffset(m,t.x,t.y):t=>0,v=new t.pointGeometry(i.tileAnchorX,i.tileAnchorY),x=g(v),y=this.projectAndGetPerspectiveRatio(a,v.x,v.y,x,m),{perspectiveRatio:b}=y,w=(h?n/b:n*b)/t.ONE_EM,T=Yt(v,s,x).point,E=y.signedDistanceFromCamera>0?ee(w,r,i.lineOffsetX*w,i.lineOffsetY*w,!1,T,v,i,o,s,{},f&&!h?g:null,h&&!!f):null;let C=!1,S=!1,M=!0;if(E&&!y.aboveHorizon){const i=.5*d*b+_,o=new t.pointGeometry(-100,-100),r=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),n=new qt,a=E.first,s=E.last;let h=[];for(let t=a.path.length-1;t>=1;t--)h.push(a.path[t]);for(let t=1;t<s.path.length;t++)h.push(s.path[t]);const m=2.5*i;if(l){const t=h.map(f?(t,e)=>{const i=g(e<a.path.length-1?a.tilePath[a.path.length-1-e]:s.tilePath[e-a.path.length+2]);return Yt(t,l,i)}:t=>Yt(t,l));h=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point));}let v=[];if(h.length>0){const e=h[0].clone(),i=h[0].clone();for(let t=1;t<h.length;t++)e.x=Math.min(e.x,h[t].x),e.y=Math.min(e.y,h[t].y),i.x=Math.max(i.x,h[t].x),i.y=Math.max(i.y,h[t].y);v=e.x>=o.x&&i.x<=r.x&&e.y>=o.y&&i.y<=r.y?[h]:i.x<o.x||e.x>r.x||i.y<o.y||e.y>r.y?[]:t.clipLine([h],o.x,o.y,r.x,r.y);}for(const t of v){n.reset(t,.25*i);let o=0;o=n.length<=.5*i?1:Math.ceil(n.paddedLength/m)+1;for(let t=0;t<o;t++){const r=t/Math.max(o-1,1),a=n.lerp(r),s=a.x+he,l=a.y+he;p.push(s,l,i,0);const h=s-i,d=l-i,_=s+i,m=l+i;if(M=M&&this.isOffscreen(h,d,_,m),S=S||this.isInsideGrid(h,d,_,m),!e&&this.grid.hitTestCircle(s,l,i,u)&&(C=!0,!c))return {circles:[],offscreen:!1,collisionDetected:C}}}}return {circles:!c&&C||!S?[]:p,offscreen:M,collisionDetected:C}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return {};const i=[];let o=1/0,r=1/0,n=-1/0,a=-1/0;for(const s of e){const e=new t.pointGeometry(s.x+he,s.y+he);o=Math.min(o,e.x),r=Math.min(r,e.y),n=Math.max(n,e.x),a=Math.max(a,e.y),i.push(e);}const s=this.grid.query(o,r,n,a).concat(this.ignoredGrid.query(o,r,n,a)),l={},c={};for(const e of s){const o=e.key;if(void 0===l[o.bucketInstanceId]&&(l[o.bucketInstanceId]={}),l[o.bucketInstanceId][o.featureIndex])continue;const r=[new t.pointGeometry(e.x1,e.y1),new t.pointGeometry(e.x2,e.y1),new t.pointGeometry(e.x2,e.y2),new t.pointGeometry(e.x1,e.y2)];t.polygonIntersectsPolygon(i,r)&&(l[o.bucketInstanceId][o.featureIndex]=!0,void 0===c[o.bucketInstanceId]&&(c[o.bucketInstanceId]=[]),c[o.bucketInstanceId].push(o.featureIndex));}return c}insertCollisionBox(t,e,i,o,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:o,collisionGroupID:r},t[0],t[1],t[2],t[3]);}insertCollisionCircles(t,e,i,o,r){const n=e?this.ignoredGrid:this.grid,a={bucketInstanceId:i,featureIndex:o,collisionGroupID:r};for(let e=0;e<t.length;e+=4)n.insertCircle(a,t[e],t[e+1],t[e+2]);}projectAndGetPerspectiveRatio(e,i,o,r,n){const a=[i,o,r||0,1];let s=!1;if(r||this.transform.pitch>0){t.transformMat4(a,a,e);let l=!1;this.fogState&&n&&(l=function(e,i,o,r,n,a){const s=a.calculateFogTileMatrix(n),l=[i,o,r];return t.transformMat4$1(l,l,s),E(e,l,a.pitch,a._fov)}(this.fogState,i,o,r||0,n.toUnwrapped(),this.transform)>.9),s=a[2]>a[3]||l;}else ce(a,a,e);return {point:new t.pointGeometry((a[0]/a[3]+1)/2*this.transform.width+he,(-a[1]/a[3]+1)/2*this.transform.height+he),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/a[3]*.5,1.5),signedDistanceFromCamera:a[3],aboveHorizon:s}}isOffscreen(t,e,i,o){return i<he||t>=this.screenRightBoundary||o<he||e>this.screenBottomBoundary}isInsideGrid(t,e,i,o){return i>=0&&t<this.gridRightBoundary&&o>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}class de{constructor(t,e,i,o){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):o&&i?1:0,this.placed=i;}isHidden(){return 0===this.opacity&&!this.placed}}class _e{constructor(t,e,i,o,r,n=!1){this.text=new de(t?t.text:null,e,i,r),this.icon=new de(t?t.icon:null,e,o,r),this.clipped=n;}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class me{constructor(t,e,i,o=!1){this.text=t,this.icon=e,this.skipFade=i,this.clipped=o;}}class pe{constructor(){this.invProjMatrix=t.create$1(),this.viewportMatrix=t.create$1(),this.circles=[];}}class fe{constructor(t,e,i,o,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=o,this.tileID=r;}}class ge{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={};}get(t){if(this.crossSourceCollisions)return {ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e};}return this.collisionGroups[t]}}function ve(e,i,o,r,n){const{horizontalAlign:a,verticalAlign:s}=t.getAnchorAlignment(e),l=-(a-.5)*i,c=-(s-.5)*o,h=t.evaluateVariableOffset(e,r);return new t.pointGeometry(l+h[0]*n,c+h[1]*n)}function xe(e,i,o,r,n){const a=new t.pointGeometry(e,i);return o&&a._rotate(r?n:-n),a}class ye{constructor(t,e,i,o,r){this.transform=t.clone(),this.collisionIndex=new ue(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ge(i),this.collisionCircleArrays={},this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={};}getBucketParts(e,i,o,r){const n=o.getBucket(i),a=o.latestFeatureIndex;if(!n||!a||i.id!==n.layerIds[0])return;const s=n.layers[0].layout,l=o.collisionBoxArray,c=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),h=o.tileSize/t.EXTENT,u=o.tileID.toUnwrapped(),d=this.transform.calculateProjMatrix(u),_="map"===s.get("text-pitch-alignment"),m="map"===s.get("text-rotation-alignment");i.compileFilter();const p=i.dynamicFilter(),f=i.dynamicFilterNeedsFeature(),g=this.transform.calculatePixelsToTileUnitsMatrix(o),v=Ht(d,_,m,this.transform,g);let x=null;if(_){const e=Kt(d,_,m,this.transform,g);x=t.multiply([],this.transform.labelPlaneMatrix,e);}let y=null;p&&o.latestFeatureIndex&&(y={unwrappedTileID:u,dynamicFilter:p,dynamicFilterNeedsFeature:f,featureIndex:o.latestFeatureIndex}),this.retainedQueryData[n.bucketInstanceId]=new fe(n.bucketInstanceId,a,n.sourceLayerIndex,n.index,o.tileID);const b={bucket:n,layout:s,posMatrix:d,textLabelPlaneMatrix:v,labelToScreenMatrix:x,clippingData:y,scale:c,textPixelRatio:h,holdingForFade:o.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(n.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(n.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(n.sourceID)};if(r)for(const t of n.sortKeyRanges){const{sortKey:i,symbolInstanceStart:o,symbolInstanceEnd:r}=t;e.push({sortKey:i,symbolInstanceStart:o,symbolInstanceEnd:r,parameters:b});}else e.push({symbolInstanceStart:0,symbolInstanceEnd:n.symbolInstances.length,parameters:b});}attemptAnchorPlacement(t,e,i,o,r,n,a,s,l,c,h,u,d,_,m,p,f,g){const v=[u.textOffset0,u.textOffset1],x=ve(t,i,o,v,r),y=this.collisionIndex.placeCollisionBox(r,e,xe(x.x,x.y,n,a,this.transform.angle),h,s,l,c.predicate);if((!p||0!==this.collisionIndex.placeCollisionBox(_.getSymbolInstanceIconSize(g,this.transform.zoom,d),p,xe(x.x,x.y,n,a,this.transform.angle),h,s,l,c.predicate).box.length)&&y.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID].text&&(e=this.prevPlacement.variableOffsets[u.crossTileID].anchor),this.variableOffsets[u.crossTileID]={textOffset:v,width:i,height:o,anchor:t,textScale:r,prevAnchor:e},this.markUsedJustification(_,t,u,m),_.allowVerticalPlacement&&(this.markUsedOrientation(_,m,u),this.placedOrientations[u.crossTileID]=m),{shift:x,placedGlyphBoxes:y}}}placeLayerBucketPart(e,i,o,r){const{bucket:n,layout:a,posMatrix:s,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:h,textPixelRatio:u,holdingForFade:d,collisionBoxArray:_,partiallyEvaluatedTextSize:m,partiallyEvaluatedIconSize:p,collisionGroup:f}=e.parameters,g=a.get("text-optional"),v=a.get("icon-optional"),x=a.get("text-allow-overlap"),y=a.get("icon-allow-overlap"),b="map"===a.get("text-rotation-alignment"),w="map"===a.get("text-pitch-alignment"),T="none"!==a.get("icon-text-fit"),E="viewport-y"===a.get("symbol-z-order"),C=x&&(y||!n.hasIconData()||v),S=y&&(x||!n.hasTextData()||g);!n.collisionArrays&&_&&n.deserializeCollisionBoxes(_),o&&r&&n.updateCollisionDebugBuffers(this.transform.zoom,_);const M=(e,r,_)=>{if(h){const o={zoom:this.transform.zoom,pitch:this.transform.pitch};let r=null;if(h.dynamicFilterNeedsFeature){const t=this.retainedQueryData[n.bucketInstanceId];r=h.featureIndex.loadFeature({featureIndex:e.featureIndex,bucketIndex:t.bucketIndex,sourceLayerIndex:t.sourceLayerIndex,layoutVertexArrayOffset:0});}if(!(0,h.dynamicFilter)(o,r,this.retainedQueryData[n.bucketInstanceId].tileID.canonical,new t.pointGeometry(e.tileAnchorX,e.tileAnchorY),this.transform.calculateDistanceTileData(h.unwrappedTileID)))return this.placements[e.crossTileID]=new me(!1,!1,!1,!0),void(i[e.crossTileID]=!0)}if(i[e.crossTileID])return;if(d)return void(this.placements[e.crossTileID]=new me(!1,!1,!1));let E=!1,M=!1,I=!0,z=null,A={box:null,offscreen:null},D={box:null,offscreen:null},P=null,L=null,R=null,k=0,F=0,B=0;_.textFeatureIndex?k=_.textFeatureIndex:e.useRuntimeCollisionCircles&&(k=e.featureIndex),_.verticalTextFeatureIndex&&(F=_.verticalTextFeatureIndex);const O=t=>{t.tileID=this.retainedQueryData[n.bucketInstanceId].tileID,(this.transform.elevation||t.elevation)&&(t.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[n.bucketInstanceId].tileID,t.tileAnchorX,t.tileAnchorY):0);},U=_.textBox;if(U){O(U);const i=i=>{let o=t.WritingMode.horizontal;if(n.allowVerticalPlacement&&!i&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,o=t,this.markUsedOrientation(n,o,e));}return o},o=(i,o)=>{if(n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&_.verticalTextBox){for(const e of n.writingModes)if(e===t.WritingMode.vertical?(A=o(),D=A):A=i(),A&&A.box&&A.box.length)break}else A=i();};if(a.get("text-variable-anchor")){let l=a.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];l.indexOf(t.anchor)>0&&(l=l.filter((e=>e!==t.anchor)),l.unshift(t.anchor));}const c=(t,i,o)=>{const a=n.getSymbolInstanceTextSize(m,e,this.transform.zoom,r),c=(t.x2-t.x1)*a+2*t.padding,h=(t.y2-t.y1)*a+2*t.padding,d=T&&!y?i:null;d&&O(d);let _={box:[],offscreen:!1};const g=x?2*l.length:l.length;for(let i=0;i<g;++i){const g=this.attemptAnchorPlacement(l[i%l.length],t,c,h,a,b,w,u,s,f,i>=l.length,e,r,n,o,d,m,p);if(g&&(_=g.placedGlyphBoxes,_&&_.box&&_.box.length)){E=!0,z=g.shift;break}}return _};o((()=>c(U,_.iconBox,t.WritingMode.horizontal)),(()=>{const i=_.verticalTextBox;return i&&O(i),n.allowVerticalPlacement&&!(A&&A.box&&A.box.length)&&e.numVerticalGlyphVertices>0&&i?c(i,_.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),A&&(E=A.box,I=A.offscreen);const h=i(A&&A.box);if(!E&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(n,t.anchor,e,h));}}else {const a=(i,o)=>{const a=n.getSymbolInstanceTextSize(m,e,this.transform.zoom,r),l=this.collisionIndex.placeCollisionBox(a,i,new t.pointGeometry(0,0),x,u,s,f.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(n,o,e),this.placedOrientations[e.crossTileID]=o),l};o((()=>a(U,t.WritingMode.horizontal)),(()=>{const i=_.verticalTextBox;return n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&i?(O(i),a(i,t.WritingMode.vertical)):{box:null,offscreen:null}})),i(A&&A.box&&A.box.length);}}if(P=A,E=P&&P.box&&P.box.length>0,I=P&&P.offscreen,e.useRuntimeCollisionCircles){const i=n.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),r=t.evaluateSizeForFeature(n.textSizeData,m,i),h=a.get("text-padding");L=this.collisionIndex.placeCollisionCircles(x,i,n.lineVertexArray,n.glyphOffsetArray,r,s,l,c,o,w,f.predicate,e.collisionCircleDiameter*r/t.ONE_EM,h,this.retainedQueryData[n.bucketInstanceId].tileID),E=x||L.circles.length>0&&!L.collisionDetected,I=I&&L.offscreen;}if(_.iconFeatureIndex&&(B=_.iconFeatureIndex),_.iconBox){const e=e=>{O(e);const i=T&&z?xe(z.x,z.y,b,w,this.transform.angle):new t.pointGeometry(0,0),o=n.getSymbolInstanceIconSize(p,this.transform.zoom,r);return this.collisionIndex.placeCollisionBox(o,e,i,y,u,s,f.predicate)};D&&D.box&&D.box.length&&_.verticalIconBox?(R=e(_.verticalIconBox),M=R.box.length>0):(R=e(_.iconBox),M=R.box.length>0),I=I&&R.offscreen;}const N=g||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,G=v||0===e.numIconVertices;if(N||G?G?N||(M=M&&E):E=M&&E:M=E=M&&E,E&&P&&P.box&&this.collisionIndex.insertCollisionBox(P.box,a.get("text-ignore-placement"),n.bucketInstanceId,D&&D.box&&F?F:k,f.ID),M&&R&&this.collisionIndex.insertCollisionBox(R.box,a.get("icon-ignore-placement"),n.bucketInstanceId,B,f.ID),L&&(E&&this.collisionIndex.insertCollisionCircles(L.circles,a.get("text-ignore-placement"),n.bucketInstanceId,k,f.ID),o)){const t=n.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new pe);for(let t=0;t<L.circles.length;t+=4)e.circles.push(L.circles[t+0]),e.circles.push(L.circles[t+1]),e.circles.push(L.circles[t+2]),e.circles.push(L.collisionDetected?1:0);}this.placements[e.crossTileID]=new me(E||C,M||S,I||n.justReloaded),i[e.crossTileID]=!0;};if(E){const t=n.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const i=t[e];M(n.symbolInstances.get(i),i,n.collisionArrays[i]);}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)M(n.symbolInstances.get(t),t,n.collisionArrays[t]);if(o&&n.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[n.bucketInstanceId];t.invert(e.invProjMatrix,s),e.viewportMatrix=this.collisionIndex.getViewportMatrix();}n.justReloaded=!1;}markUsedJustification(e,i,o,r){let n;n=r===t.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(i)];const a=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];for(const t of a)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=n>=0&&t!==n?0:o.crossTileID);}markUsedOrientation(e,i,o){const r=i===t.WritingMode.horizontal||i===t.WritingMode.horizontalOnly?i:0,n=i===t.WritingMode.vertical?i:0,a=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];for(const t of a)e.text.placedSymbolArray.get(t).placedOrientation=r;o.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=n);}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const o=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},n=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],n=r[t];n?(this.opacities[t]=new _e(n,o,e.text,e.icon,null,e.clipped),i=i||e.text!==n.text.placed||e.icon!==n.icon.placed):(this.opacities[t]=new _e(null,o,e.text,e.icon,e.skipFade,e.clipped),i=i||e.text||e.icon);}for(const t in r){const e=r[t];if(!this.opacities[t]){const r=new _e(e,o,!1,!1);r.isHidden()||(this.opacities[t]=r,i=i||e.text.placed||e.icon.placed);}}for(const t in n)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=n[t]);for(const t in a)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=a[t]);i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t);}updateLayerOpacities(t,e){const i={};for(const o of e){const e=o.getBucket(t);e&&o.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i,o.collisionBoxArray);}}updateBucketOpacities(e,i,o){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const r=e.layers[0].layout,n=!!e.layers[0].dynamicFilter(),a=new _e(null,0,!1,!1,!0),s=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=r.get("text-variable-anchor"),h="map"===r.get("text-rotation-alignment"),u="map"===r.get("text-pitch-alignment"),d="none"!==r.get("icon-text-fit"),_=new _e(null,0,s&&(l||!e.hasIconData()||r.get("icon-optional")),l&&(s||!e.hasTextData()||r.get("text-optional")),!0);!e.collisionArrays&&o&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(o);const m=(t,e,i)=>{for(let o=0;o<e/4;o++)t.opacityVertexArray.emplaceBack(i);};for(let o=0;o<e.symbolInstances.length;o++){const r=e.symbolInstances.get(o),{numHorizontalGlyphVertices:s,numVerticalGlyphVertices:l,crossTileID:p}=r;let f=this.opacities[p];i[p]?f=a:f||(f=_,this.opacities[p]=f),i[p]=!0;const g=r.numIconVertices>0,v=this.placedOrientations[r.crossTileID],x=v===t.WritingMode.vertical,y=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(s>0||l>0){const t=ze(f.text);m(e.text,s,x?Ae:t),m(e.text,l,y?Ae:t);const i=f.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=i||x?1:0);})),r.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=i||y?1:0);const o=this.variableOffsets[r.crossTileID];o&&this.markUsedJustification(e,o.anchor,r,v);const n=this.placedOrientations[r.crossTileID];n&&(this.markUsedJustification(e,"left",r,n),this.markUsedOrientation(e,n,r));}if(g){const t=ze(f.icon);r.placedIconSymbolIndex>=0&&(m(e.icon,r.numIconVertices,x?Ae:t),e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=f.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,r.numVerticalIconVertices,y?Ae:t),e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=f.icon.isHidden());}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const i=e.collisionArrays[o];if(i){let o=new t.pointGeometry(0,0),r=!0;if(i.textBox||i.verticalTextBox){if(c){const t=this.variableOffsets[p];t?(o=ve(t.anchor,t.width,t.height,t.textOffset,t.textScale),h&&o._rotate(u?this.transform.angle:-this.transform.angle)):r=!1;}n&&(r=!f.clipped),i.textBox&&be(e.textCollisionBox.collisionVertexArray,f.text.placed,!r||x,o.x,o.y),i.verticalTextBox&&be(e.textCollisionBox.collisionVertexArray,f.text.placed,!r||y,o.x,o.y);}const a=r&&Boolean(!y&&i.verticalIconBox);i.iconBox&&be(e.iconCollisionBox.collisionVertexArray,f.icon.placed,a,d?o.x:0,d?o.y:0),i.verticalIconBox&&be(e.iconCollisionBox.collisionVertexArray,f.icon.placed,!a,d?o.x:0,d?o.y:0);}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId];}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0;}}function be(t,e,i,o,r){t.emplaceBack(e?1:0,i?1:0,o||0,r||0),t.emplaceBack(e?1:0,i?1:0,o||0,r||0),t.emplaceBack(e?1:0,i?1:0,o||0,r||0),t.emplaceBack(e?1:0,i?1:0,o||0,r||0);}const we=Math.pow(2,25),Te=Math.pow(2,24),Ee=Math.pow(2,17),Ce=Math.pow(2,16),Se=Math.pow(2,9),Me=Math.pow(2,8),Ie=Math.pow(2,1);function ze(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*we+e*Te+i*Ee+e*Ce+i*Se+e*Me+i*Ie+e}const Ae=0;class De{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[];}continuePlacement(t,e,i,o,r){const n=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(n,o,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return !0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,n.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<n.length;){const t=n[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,i,0===t.symbolInstanceStart),this._currentPartIndex++,r())return !0}return !1}}class Pe{constructor(t,e,i,o,r,n,a,s){this.placement=new ye(t,r,n,a,s),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=o,this._done=!1;}isDone(){return this._done}continuePlacement(e,i,o){const r=t.exported.now(),n=()=>{const e=t.exported.now()-r;return !this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=i[e[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=r)&&(!t.maxzoom||t.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new De(t)),this._inProgressLayer.continuePlacement(o[t.source],this.placement,this._showCollisionBoxes,t,n))return;delete this._inProgressLayer;}this._currentPlacementIndex--;}this._done=!0;}commit(t){return this.placement.commit(t),this.placement}}const Le=512/t.EXTENT/2;class Re{constructor(t,e,i){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(let i=0;i<e.length;i++){const o=e.get(i),r=o.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)});}}getScaledCoordinates(e,i){const o=Le/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return {x:Math.floor((i.canonical.x*t.EXTENT+e.tileAnchorX)*o),y:Math.floor((i.canonical.y*t.EXTENT+e.tileAnchorY)*o)}}findMatches(t,e,i){const o=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const n=t.get(r);if(n.crossTileID)continue;const a=this.indexedSymbolInstances[n.key];if(!a)continue;const s=this.getScaledCoordinates(n,e);for(const t of a)if(Math.abs(t.coord.x-s.x)<=o&&Math.abs(t.coord.y-s.y)<=o&&!i[t.crossTileID]){i[t.crossTileID]=!0,n.crossTileID=t.crossTileID;break}}}}class ke{constructor(){this.maxCrossTileID=0;}generate(){return ++this.maxCrossTileID}}class Fe{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0;}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],o={};for(const t in i){const r=i[t];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),o[r.tileID.key]=r;}this.indexes[t]=o;}this.lng=t;}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return !1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key]);}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const o=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const r=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in r){const n=r[i];n.tileID.isChildOf(t)&&n.findMatches(e.symbolInstances,t,o);}else {const n=r[t.scaledTo(Number(i)).key];n&&n.findMatches(e.symbolInstances,t,o);}}for(let t=0;t<e.symbolInstances.length;t++){const r=e.symbolInstances.get(t);r.crossTileID||(r.crossTileID=i.generate(),o[r.crossTileID]=!0);}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Re(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i in e.indexedSymbolInstances)for(const o of e.indexedSymbolInstances[i])delete this.usedCrossTileIDs[t][o.crossTileID];}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const o=this.indexes[i];for(const r in o)t[o[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,o[r]),delete o[r],e=!0);}return e}}class Be{constructor(){this.layerIndexes={},this.crossTileIDs=new ke,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={};}addLayer(t,e,i){let o=this.layerIndexes[t.id];void 0===o&&(o=this.layerIndexes[t.id]=new Fe);let r=!1;const n={};o.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),o.addBucket(i.tileID,e,this.crossTileIDs)&&(r=!0),n[e.bucketInstanceId]=!0);}return o.removeStaleBuckets(n)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0;}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t];}}const Oe=(e,i)=>t.emitValidationErrors(e,i&&i.filter((t=>"source.canvas"!==t.identifier))),Ue=t.pick(Ot,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ne=t.pick(Ot,["setCenter","setZoom","setBearing","setPitch"]),Ge=function(){const e={},i=t.spec.$version;for(const o in t.spec.$root){const r=t.spec.$root[o];if(r.required){let t=null;t="version"===o?i:"array"===r.type?[]:{},null!=t&&(e[o]=t);}}return e}(),Ze={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class je extends t.Evented{constructor(e,i={}){super(),this.map=e,this.dispatcher=new z(kt(),this),this.imageManager=new g,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,i.localFontFamily?t.LocalGlyphMode.all:i.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,i.localFontFamily||i.localIdeographFontFamily),this.lineAtlas=new t.LineAtlas(256,512),this.crossTileSymbolIndex=new Be,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const o=this;this._rtlTextPluginCallback=je.registerForPluginStateChange((e=>{o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,i)=>{if(t.triggerPluginCompletionEvent(e),i&&i.every((t=>t)))for(const t in o._sourceCaches){const e=o._sourceCaches[t],i=e.getSource().type;"vector"!==i&&"geojson"!==i||e.reload();}}));})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const t in this._layers){const i=this._layers[t];i.source===e.id&&this._validateLayer(i);}}));}loadURL(e,i={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const o="boolean"==typeof i.validate?i.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,i.accessToken);const r=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(r,((e,i)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):i&&this._load(i,o);}));}loadJSON(e,i={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame((()=>{this._request=null,this._load(e,!1!==i.validate);}));}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ge,!1);}_updateLayerCount(t,e){const i=e?1:-1;t.is3D()&&(this._num3DLayers+=i),"circle"===t.type&&(this._numCircleLayers+=i),"symbol"===t.type&&(this._numSymbolLayers+=i);}_load(e,i){if(i&&Oe(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e,this.updateProjection();for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const o=Bt(this.stylesheet.layers);this._order=o.map((t=>t.id)),this._layers={},this._serializedLayers={};for(let e of o)e=t.createStyleLayer(e),e.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=e,this._serializedLayers[e.id]=e.serialize(),this._updateLayerCount(e,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new y(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"));}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.updateProjection();}updateProjection(){const t=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0));if(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),t){this.map.painter.clearBackgroundTiles();for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles();this.map._update(!0);}}_loadSprite(e){this._spriteRequest=function(e,i,o){let r,n,a;const s=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(i.transformRequest(i.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),((t,e)=>{l=null,a||(a=t,r=e,h());})),c=t.getImage(i.transformRequest(i.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),((t,e)=>{c=null,a||(a=t,n=e,h());}));function h(){if(a)o(a);else if(r&&n){const e=t.exported.getImageData(n),i={};for(const o in r){const{width:n,height:a,x:s,y:l,sdf:c,pixelRatio:h,stretchX:u,stretchY:d,content:_}=r[o],m=new t.RGBAImage({width:n,height:a});t.RGBAImage.copy(e,m,{x:s,y:l},{x:0,y:0},{width:n,height:a}),i[o]={data:m,pixelRatio:h,sdf:c,stretchX:u,stretchY:d,content:_};}o(null,i);}}return {cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null);}}}(e,this.map._requestManager,((e,i)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(i)for(const t in i)this.imageManager.addImage(t,i[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}));}));}_validateLayer(e){const i=this.getSource(e.source);if(!i)return;const o=e.sourceLayer;o&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(o))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${o}" does not exist on source "${i.id}" as specified by style layer "${e.id}"`)));}loaded(){if(!this._loaded)return !1;if(Object.keys(this._updatedSources).length)return !1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return !1;return !!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const i of t){const t=this._layers[i];"custom"!==t.type&&e.push(t.serialize());}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return !0;if(this.fog&&this.fog.hasTransition())return !0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return !0;for(const t in this._layers)if(this._layers[t].hasTransition())return !0;return !1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return !!this.terrain&&Ze[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const i=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(t.length||i.length)&&this._updateWorkerLayers(t,i);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t);}this._updateTilesForChangedImages();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates();}const o={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];o[t]=e.used,e.used=!1;}for(const t of this._order){const i=this._layers[t];if(i.recalculate(e,this._availableImages),!i.isHidden(e.zoom)){const t=this._getLayerSourceCache(i);t&&(t.used=!0);}const o=this.map.painter;if(o){const t=i.getProgramIds();if(!t)continue;const r=i.getProgramConfiguration(e.zoom);for(const e of t)o.useProgram(e,r);}}for(const e in o){const i=this._sourceCaches[e];o[e]!==i.used&&i.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:i.getSource().id}));}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new t.Event("data",{dataType:"style"}));}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={};}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e});}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={};}setState(e){if(this._checkLoaded(),Oe(this,t.validateStyle(e)))return !1;(e=t.clone$2(e)).layers=Bt(e.layers);const i=function(t,e){if(!t)return [{command:Ot.setStyle,args:[e]}];let i=[];try{if(!r(t.version,e.version))return [{command:Ot.setStyle,args:[e]}];r(t.center,e.center)||i.push({command:Ot.setCenter,args:[e.center]}),r(t.zoom,e.zoom)||i.push({command:Ot.setZoom,args:[e.zoom]}),r(t.bearing,e.bearing)||i.push({command:Ot.setBearing,args:[e.bearing]}),r(t.pitch,e.pitch)||i.push({command:Ot.setPitch,args:[e.pitch]}),r(t.sprite,e.sprite)||i.push({command:Ot.setSprite,args:[e.sprite]}),r(t.glyphs,e.glyphs)||i.push({command:Ot.setGlyphs,args:[e.glyphs]}),r(t.transition,e.transition)||i.push({command:Ot.setTransition,args:[e.transition]}),r(t.light,e.light)||i.push({command:Ot.setLight,args:[e.light]}),r(t.fog,e.fog)||i.push({command:Ot.setFog,args:[e.fog]}),r(t.projection,e.projection)||i.push({command:Ot.setProjection,args:[e.projection]});const o={},n=[];!function(t,e,i,o){let n;for(n in e=e||{},t=t||{})t.hasOwnProperty(n)&&(e.hasOwnProperty(n)||Nt(n,i,o));for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)?r(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&Zt(t,e,n)?i.push({command:Ot.setGeoJSONSourceData,args:[n,e[n].data]}):Gt(n,e,i,o)):Ut(n,e,i));}(t.sources,e.sources,n,o);const a=[];t.layers&&t.layers.forEach((t=>{o[t.source]?i.push({command:Ot.removeLayer,args:[t.id]}):a.push(t);}));let s=t.terrain;s&&o[s.source]&&(i.push({command:Ot.setTerrain,args:[void 0]}),s=void 0),i=i.concat(n),r(s,e.terrain)||i.push({command:Ot.setTerrain,args:[e.terrain]}),function(t,e,i){e=e||[];const o=(t=t||[]).map(Vt),n=e.map(Vt),a=t.reduce(Wt,{}),s=e.reduce(Wt,{}),l=o.slice(),c=Object.create(null);let h,u,d,_,m,p,f;for(h=0,u=0;h<o.length;h++)d=o[h],s.hasOwnProperty(d)?u++:(i.push({command:Ot.removeLayer,args:[d]}),l.splice(l.indexOf(d,u),1));for(h=0,u=0;h<n.length;h++)d=n[n.length-1-h],l[l.length-1-h]!==d&&(a.hasOwnProperty(d)?(i.push({command:Ot.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-u),1)):u++,p=l[l.length-h],i.push({command:Ot.addLayer,args:[s[d],p]}),l.splice(l.length-h,0,d),c[d]=!0);for(h=0;h<n.length;h++)if(d=n[h],_=a[d],m=s[d],!c[d]&&!r(_,m))if(r(_.source,m.source)&&r(_["source-layer"],m["source-layer"])&&r(_.type,m.type)){for(f in jt(_.layout,m.layout,i,d,null,Ot.setLayoutProperty),jt(_.paint,m.paint,i,d,null,Ot.setPaintProperty),r(_.filter,m.filter)||i.push({command:Ot.setFilter,args:[d,m.filter]}),r(_.minzoom,m.minzoom)&&r(_.maxzoom,m.maxzoom)||i.push({command:Ot.setLayerZoomRange,args:[d,m.minzoom,m.maxzoom]}),_)_.hasOwnProperty(f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?jt(_[f],m[f],i,d,f.slice(6),Ot.setPaintProperty):r(_[f],m[f])||i.push({command:Ot.setLayerProperty,args:[d,f,m[f]]}));for(f in m)m.hasOwnProperty(f)&&!_.hasOwnProperty(f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?jt(_[f],m[f],i,d,f.slice(6),Ot.setPaintProperty):r(_[f],m[f])||i.push({command:Ot.setLayerProperty,args:[d,f,m[f]]}));}else i.push({command:Ot.removeLayer,args:[d]}),p=l[l.lastIndexOf(d)+1],i.push({command:Ot.addLayer,args:[m,p]});}(a,e.layers,i);}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Ot.setStyle,args:[e]}];}return i}(this.serialize(),e).filter((t=>!(t.command in Ne)));if(0===i.length)return !1;const o=i.filter((t=>!(t.command in Ue)));if(o.length>0)throw new Error(`Unimplemented: ${o.map((t=>t.command)).join(", ")}.`);return i.forEach((t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args);})),this.stylesheet=e,!0}addImage(e,i){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,i),this._afterImageUpdated(e);}updateImage(t,e){this.imageManager.updateImage(t,e);}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e);}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}));}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(e,i,o={}){if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(t.validateStyle.source,`sources.${e}`,i,null,o))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const r=St(e,i,this.dispatcher,this);r.setEventedParent(this,(()=>({isSourceLoaded:this.loaded(),source:r.serialize(),sourceId:e})));const n=i=>{const o=(i?"symbol:":"other:")+e,n=this._sourceCaches[o]=new t.SourceCache(o,r,i);(i?this._symbolSourceCaches:this._otherSourceCaches)[e]=n,n.style=this,n.onAdd(this.map);};n(!1),"vector"!==i.type&&"geojson"!==i.type||n(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0;}removeSource(e){this._checkLoaded();const i=this.getSource(e);if(void 0===i)throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${i}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const o=this._getSourceCaches(e);for(const e of o)delete this._sourceCaches[e.id],delete this._updatedSources[e.id],e.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e.getSource().id})),e.setEventedParent(null),e.clearTiles();delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changed=!0;}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0;}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}addLayer(e,i,o={}){this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${r}" already exists on this map`)));let n;if("custom"===e.type){if(Oe(this,t.validateCustomStyleLayer(e)))return;n=t.createStyleLayer(e);}else {if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$2(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,`layers.${r}`,e,{arrayIndex:-1},o))return;n=t.createStyleLayer(e),this._validateLayer(n),n.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[n.id]=n.serialize(),this._updateLayerCount(n,!0);}const a=i?this._order.indexOf(i):this._order.length;if(i&&-1===a)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${i}" does not exist on this map.`)));this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=n;const s=this._getLayerSourceCache(n);if(this._removedLayers[r]&&n.source&&s&&"custom"!==n.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==n.type?this._updatedSources[n.source]="clear":(this._updatedSources[n.source]="reload",s.pause());}this._updateLayer(n),n.onAdd&&n.onAdd(this.map),this._updateDrapeFirstLayers();}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const o=this._order.indexOf(e);this._order.splice(o,1);const r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new t.ErrorEvent(new Error(`Layer with id "${i}" does not exist on this map.`))):(this._order.splice(r,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers());}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));i.setEventedParent(null),this._updateLayerCount(i,!1);const o=this._order.indexOf(e);this._order.splice(o,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map),this._updateDrapeFirstLayers();}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return !0;return !1}setLayerZoomRange(e,i,o){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===i&&r.maxzoom===o||(null!=i&&(r.minzoom=i),null!=o&&(r.maxzoom=o),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)));}setFilter(e,i,o={}){this._checkLoaded();const n=this.getLayer(e);if(n){if(!r(n.filter,i))return null==i?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.validateStyle.filter,`layers.${n.id}.filter`,i,{layerType:n.type},o)||(n.filter=t.clone$2(i),this._updateLayer(n)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)));}getFilter(e){return t.clone$2(this.getLayer(e).filter)}setLayoutProperty(e,i,o,n={}){this._checkLoaded();const a=this.getLayer(e);a?r(a.getLayoutProperty(i),o)||(a.setLayoutProperty(i,o,n),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)));}getLayoutProperty(e,i){const o=this.getLayer(e);if(o)return o.getLayoutProperty(i);this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style.`)));}setPaintProperty(e,i,o,n={}){this._checkLoaded();const a=this.getLayer(e);a?r(a.getPaintProperty(i),o)||(a.setPaintProperty(i,o,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)));}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,i){this._checkLoaded();const o=e.source,r=e.sourceLayer,n=this.getSource(o);if(void 0===n)return void this.fire(new t.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)));const a=n.type;if("geojson"===a&&r)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===a&&!r)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const s=this._getSourceCaches(o);for(const t of s)t.setFeatureState(r,e.id,i);}removeFeatureState(e,i){this._checkLoaded();const o=e.source,r=this.getSource(o);if(void 0===r)return void this.fire(new t.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)));const n=r.type,a="vector"===n?e.sourceLayer:void 0;if("vector"===n&&!a)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const s=this._getSourceCaches(o);for(const t of s)t.removeFeatureState(a,e.id,i);}getFeatureState(e){this._checkLoaded();const i=e.source,o=e.sourceLayer,r=this.getSource(i);if(void 0!==r){if("vector"!==r.type||o)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(i)[0].getFeatureState(o,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));}else this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const i=this._sourceCaches[t].getSource();e[i.id]||(e[i.id]=i.serialize());}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:e,layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0,t.invalidateCompiledFilter();}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},o=[];for(let r=this._order.length-1;r>=0;r--){const n=this._order[r];if(e(n)){i[n]=r;for(const e of t){const t=e[n];if(t)for(const e of t)o.push(e);}}}o.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const r=[];for(let n=this._order.length-1;n>=0;n--){const a=this._order[n];if(e(a))for(let t=o.length-1;t>=0;t--){const e=o[t].feature;if(i[e.layer.id]<n)break;r.push(e),o.pop();}else for(const e of t){const t=e[a];if(t)for(const e of t)r.push(e.feature);}}return r}queryRenderedFeatures(e,i,o){i&&i.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",i.filter,null,i);const r={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of i.layers){const i=this._layers[e];if(!i)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];r[i.source]=!0;}}const n=[];i.availableImages=this._availableImages;const a=i&&i.layers?i.layers.some((t=>{const e=this.getLayer(t);return e&&e.is3D()})):this.has3DLayers(),s=D.createFromScreenPoints(e,o);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;i.layers&&!r[e]||n.push(It(this._sourceCaches[t],this._layers,this._serializedLayers,s,i,o,a,!!this.map._showQueryGeometry));}return this.placement&&n.push(function(t,e,i,o,r,n,a){const s={},l=n.queryRenderedSymbols(o),c=[];for(const t of Object.keys(l).map(Number))c.push(a[t]);c.sort(At);for(const i of c){const o=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in o){const e=s[t]=s[t]||[],r=o[t];r.sort(((t,e)=>{const o=i.featureSortOrder;if(o){const i=o.indexOf(t.featureIndex);return o.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(const t of r)e.push(t);}}for(const e in s)s[e].forEach((o=>{const r=o.feature,n=i(t[e]).getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n;}));return s}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),s.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(n)}querySourceFeatures(e,i){i&&i.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",i.filter,null,i);const o=this._getSourceCaches(e);let r=[];for(const t of o)r=r.concat(zt(t,i));return r}addSourceType(t,e,i){return je.getSourceType(t)?i(new Error(`A source type called "${t}" already exists.`)):(je.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const o=this.light.getLight();let n=!1;for(const t in e)if(!r(e[t],o[t])){n=!0;break}if(!n)return;const a={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(a);}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(e){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof e.source){const i="terrain-dem-src";this.addSource(i,e.source),e=t.clone$2(e),e=t.extend(e,{source:i});}if(!this._validate(t.validateStyle.terrain,"terrain",e)){if(this.terrain){const i=this.terrain,o=i.get();for(const n in e)if(!r(e[n],o[n])){i.set(e),this.stylesheet.terrain=e;const o={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(o);break}}else this._createTerrain(e);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0;}}_createFog(e){const i=this.fog=new I(e,this.map.transform);this.stylesheet.fog=e;const o={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(o);}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const t of this.map._markers)t._evaluateOpacity();}));}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog,o=i.get();for(const n in e)if(!r(e[n],o[n])){i.set(e),this.stylesheet.fog=e;const o={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(o);break}}else this._createFog(e);this._markersNeedUpdate=!0;}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter((t=>this.isLayerDraped(this._layers[t]))),e=this._order.filter((t=>!this.isLayerDraped(this._layers[t])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e);}_createTerrain(e){const i=this.terrain=new T(e);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const o={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(o);}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e);}}_validate(e,i,o,r,n={}){return (!n||!1!==n.validate)&&Oe(this,e.call(t.validateStyle,t.extend({key:i,style:this.serialize(),value:o,styleSpec:t.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove();}_clearSource(t){const e=this._getSourceCaches(t);for(const t of e)t.clearTiles();}_reloadSource(t){const e=this._getSourceCaches(t);for(const t of e)t.resume(),t.reload();}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t);}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload();}}_updatePlacement(e,i,o,r,n=!1){let a=!1,s=!1;const l={};for(const t of this._order){const i=this._layers[t];if("symbol"!==i.type)continue;if(!l[i.source]){const t=this._getLayerSourceCache(i);if(!t)continue;l[i.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)));}const o=this.crossTileSymbolIndex.addLayer(i,l[i.source],e.center.lng);a=a||o;}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),n=n||this._layerOrderChanged||0===o,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(n||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Pe(e,this._order,n,i,o,r,this.placement,this.fog&&!this.fog.isSoftDisabled()?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source]);}return !this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles();}getImages(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();const o=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons);};o(this._otherSourceCaches[e.source]),o(this._symbolSourceCaches[e.source]);}getGlyphs(t,e,i){this.glyphManager.getGlyphs(e.stacks,i);}getResource(e,i,o){return t.makeRequest(i,o)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return "symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}clearWorkerCaches(){this.dispatcher.broadcast("clearCaches");}}je.getSourceType=function(t){return Ct[t]},je.setSourceType=function(t,e){Ct[t]=e;},je.registerForPluginStateChange=t.registerForPluginStateChange;var Ve="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",We="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let qe={},Xe={};qe=Ye("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else \nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),Xe=Ye("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const $e=Ye("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nreturn mix(globe,mercator,t);\n#else\nreturn globe;\n#endif\n}vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),He=Ve;var Ke={background:Ye("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Ye("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Ye("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Ye("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ye("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nextrude*=a_scale;vec3 normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));vec3 globePos=a_pos_3+xAxis*extrude.x+yAxis*extrude.y+elevationVector(tilePos)*elevation(tilePos);vec3 mercPos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+xAxis*extrude.x+yAxis*extrude.y;vec3 pos=mix_globe_mercator(globePos,mercPos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Ye("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ye("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ye("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ye("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Ye("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Ye("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Ye("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Ye("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Ye("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ye("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Ye("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Ye("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Ye("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Ye("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Ye("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Ye("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Ye("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ye("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",We),skyboxGradient:Ye("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",We),skyboxCapture:Ye("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ye("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),globeAtmosphere:Ye("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Ye("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying float v_depth;void main() {vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Ye(t,e,i){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,n=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),a=t.match(r),s=e.match(r),l=Ve.match(r);let c=s?s.concat(a):a;i||(qe.staticUniforms&&(c=qe.staticUniforms.concat(c)),Xe.staticUniforms&&(c=Xe.staticUniforms.concat(c))),c&&(c=c.concat(l));const h={};return {fragmentSource:t=t.replace(o,((t,e,i,o,r)=>(h[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${i} ${o} ${r};\n#else\nuniform ${i} ${o} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${i} ${o} ${r} = u_${r};\n#endif\n`))),vertexSource:e=e.replace(o,((t,e,i,o,r)=>{const n="float"===o?"vec2":"vec4",a=r.match(/color/)?"color":n;return h[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${n} a_${r};\nvarying ${i} ${o} ${r};\n#else\nuniform ${i} ${o} u_${r};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${i} ${o} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${a}(a_${r}, u_${r}_t);\n#else\n    ${i} ${o} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${n} a_${r};\n#else\nuniform ${i} ${o} u_${r};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${o} ${r} = a_${r};\n#else\n    ${i} ${o} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${o} ${r} = unpack_mix_${a}(a_${r}, u_${r}_t);\n#else\n    ${i} ${o} ${r} = u_${r};\n#endif\n`})),staticAttributes:n,staticUniforms:c}}class Je{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null;}bind(t,e,i,o,r,n,a,s){this.context=t;let l=this.boundPaintVertexBuffers.length!==o.length;for(let t=0;!l&&t<o.length;t++)this.boundPaintVertexBuffers[t]!==o[t]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===i&&!l&&this.boundIndexBuffer===r&&this.boundVertexOffset===n&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind()):this.freshBind(e,i,o,r,n,a,s);}freshBind(t,e,i,o,r,n,a){let s;const l=t.numAttributes,c=this.context,h=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=o,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=n,this.boundDynamicVertexBuffer2=a;else {s=c.currentNumAttributes||0;for(let t=l;t<s;t++)h.disableVertexAttribArray(t);}e.enableAttributes(h,t);for(const e of i)e.enableAttributes(h,t);n&&n.enableAttributes(h,t),a&&a.enableAttributes(h,t),e.bind(),e.setVertexAttribPointers(h,t,r);for(const e of i)e.bind(),e.setVertexAttribPointers(h,t,r);n&&(n.bind(),n.setVertexAttribPointers(h,t,r)),o&&o.bind(),a&&(a.bind(),a.setVertexAttribPointers(h,t,r)),c.currentNumAttributes=l;}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null);}}function Qe(e,i){const o=Math.pow(2,i.canonical.z),r=i.canonical.y;return [new t.MercatorCoordinate(0,r/o).toLngLat().lat,new t.MercatorCoordinate(0,(r+1)/o).toLngLat().lat]}function ti(e,i,o,r,n,a,s){const l=e.context,c=l.gl,h=o.fbo;if(!h)return;e.prepareDrawTile(i);const u=e.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,h.colorAttachment.get());const d=((t,e,i,o)=>{const r=i.paint.get("hillshade-shadow-color"),n=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color");let s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);const l=!t.options.moving;return {u_matrix:o||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Qe(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:n,u_accent:a}})(e,o,r,e.terrain?i.projMatrix:null);e.prepareDrawProgram(l,u,i.toUnwrapped());const{tileBoundsBuffer:_,tileBoundsIndexBuffer:m,tileBoundsSegments:p}=e.getTileBoundsBuffers(o);u.draw(l,c.TRIANGLES,n,a,s,t.CullFaceMode.disabled,d,r.id,_,m,p);}function ei(e,i,o){if(!i.needsDEMTextureUpload)return;const r=e.context,n=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(o.stride);const a=o.getPixels();i.demTexture?i.demTexture.update(a,{premultiply:!1}):i.demTexture=new t.Texture(r,a,n.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1;}function ii(e,i,o,r,n,a){const s=e.context,l=s.gl;if(!i.dem)return;const c=i.dem;if(s.activeTexture.set(l.TEXTURE1),ei(e,i,c),!i.demTexture)return;i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const h=c.dim;s.activeTexture.set(l.TEXTURE0);let u=i.fbo;if(!u){const e=new t.Texture(s,{width:h,height:h,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),u=i.fbo=s.createFramebuffer(h,h,!0),u.colorAttachment.set(e.texture);}s.bindFramebuffer.set(u.framebuffer),s.viewport.set([0,0,h,h]);const{tileBoundsBuffer:d,tileBoundsIndexBuffer:_,tileBoundsSegments:m}=e.getMercatorTileBoundsBuffers();e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,n,a,t.CullFaceMode.disabled,((e,i)=>{const o=i.stride,r=t.create$1();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[o,o],u_zoom:e.overscaledZ,u_unpack:i.unpackVector}})(i.tileID,c),o.id,d,_,m),i.needsHillshadePrepare=!1;}const oi=(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image0:new t.Uniform1i(e,i.u_image0),u_skirt_height:new t.Uniform1f(e,i.u_skirt_height)}),ri=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),ni=new class{constructor(){this.operations={};}newMorphing(t,e,i,o,r){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==i.tileID.key&&(e.queued=i);}else this.operations[t]={startTime:o,phase:0,duration:r,from:e,to:i,queued:null};}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return {from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const i=this.operations[e];for(i.phase=(t-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,t)){delete this.operations[e];break}}}_nextOp(t,e){return !!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},ai={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function si(t,e){const i=1<<t.z;return !e&&(0===t.x||t.x===i-1)||0===t.y||t.y===i-1}const li=t=>({u_matrix:t});function ci(e,i,o,r,n){if(n>0){const a=t.exported.now(),s=(a-e.timeAdded)/n,l=i?(a-i.timeAdded)/n:-1,c=o.getSource(),h=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),u=!i||Math.abs(i.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=u&&e.refreshedUponExpiration?1:t.clamp(u?s:1-l,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return {opacity:1,mix:0}}class hi extends t.SourceCache{constructor(t){const e=St("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new z(kt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={};}update(e,i,o){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((i,o)=>{if(i[o.key]="",!this._tiles[o.key]){const i=new t.Tile(o,this._source.tileSize*o.overscaleFactor(),e.tileZoom);i.state="loaded",this._tiles[o.key]=i;}return i}),{});for(const t in this._tiles)t in r||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t]);}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const i=Object.values(e);this.renderCachePool.push(...i),delete this.proxyCachedFBO[t];}}deallocRenderCache(){this.renderCache.forEach((t=>t.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={};}}class ui extends t.OverscaledTileID{constructor(t,e,i){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=i;}}class di extends t.Elevation{constructor(e,i){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[o,r,n]=function(e){const i=new t.StructArrayLayout4i8,o=new t.StructArrayLayout3ui6,r=131;i.reserve(17161),o.reserve(33800);const n=t.EXTENT/128,a=t.EXTENT+n/2,s=a+n;for(let e=-n;e<s;e+=n)for(let o=-n;o<s;o+=n){const r=o<0||o>a||e<0||e>a?24575:0,n=t.clamp(Math.round(o),0,t.EXTENT),s=t.clamp(Math.round(e),0,t.EXTENT);i.emplaceBack(n+r,s,n,s);}const l=(t,e)=>{const i=e*r+t;o.emplaceBack(i+1,i,i+r),o.emplaceBack(i+r,i+r+1,i+1);};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return [0,129].forEach((t=>{for(let e=0;e<130;e++)l(e,t),l(t,e);})),[i,o,32768]}(),a=e.context;this.gridBuffer=a.createVertexBuffer(o,t.boundsAttributes.members),this.gridIndexBuffer=a.createIndexBuffer(r),this.gridSegments=t.SegmentVector.simpleSegment(0,0,o.length,r.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,o.length,n),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hi(i.map),this.orthoMatrix=t.create$1(),t.ortho(this.orthoMatrix,0,t.EXTENT,0,t.EXTENT,0,1);const s=a.gl;this._overlapStencilMode=new t.StencilMode({func:s.GEQUAL,mask:255},0,255,s.KEEP,s.KEEP,s.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1;}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency();}update(e,i,o){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const r=e.terrain.properties;this.sourceCache=e._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const n=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.sourceCache.getSource().tileSize/128,o=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(i,e*o,!0),this._findCoveringTileCache[this.sourceCache.id]={};};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,n(),this._initializing=!0),n(),i.updateElevation(!o),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0;}else this._disable();}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`);}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0);}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1;}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((t=>t.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture);}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return [t,t]}set useVertexMorphing(t){this._useVertexMorphing=t;}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,o=this.painter.transform;this._initializing&&(this._initializing=0===o._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(o.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=i.getIds().map((t=>{const e=i.getTileByID(t).tileID;return e.projMatrix=o.calculateProjMatrix(e.toUnwrapped()),e}));!function(e,i){const o=i.transform.pointCoordinate(i.transform.getCameraPoint()),r=new t.pointGeometry(o.x,o.y);e.sort(((e,i)=>{if(i.overscaledZ-e.overscaledZ)return i.overscaledZ-e.overscaledZ;const o=new t.pointGeometry(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),n=new t.pointGeometry(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),a=r.mult(1<<e.canonical.z);return a.x-=.5,a.y-=.5,a.distSqr(o)-a.distSqr(n)}));}(r,this.painter),this._previousZoom=o.zoom;const n=this.proxyToSource||{};this.proxyToSource={},r.forEach((t=>{this.proxyToSource[t.key]={};})),this.terrainTileForTile={};const a=this._style._sourceCaches;for(const t in a){const i=a[t];if(!i.used)continue;if(i!==this.sourceCache&&(this._findCoveringTileCache[i.id]={}),this._setupProxiedCoordsForOrtho(i,e[t],n),i.usedForTerrain)continue;const o=e[t];i.getSource().reparseOverscaled&&this._assignTerrainTiles(o);}this.proxiedCoords[i.id]=r.map((t=>new ui(t,t.key,this.orthoMatrix))),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(n),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const s={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const i=e.tileID.key;i in s||(this._visibleDemTiles.push(e),s[i]=i);}}_assignTerrainTiles(t){this._initializing||t.forEach((t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e);}));}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const i in this.terrainTileForTile){const o=this.terrainTileForTile[i],r=o.dem;!r||o.demTexture&&!o.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),ei(this.painter,o,r));}}_prepareDemTileUniforms(t,e,i,o){if(!e||null==e.demTexture)return !1;const r=t.tileID.canonical,n=Math.pow(2,e.tileID.canonical.z-r.z),a=o||"";return i[`u_dem_tl${a}`]=[r.x*n%1,r.y*n%1],i[`u_dem_scale${a}`]=n,!0}get emptyDEMTexture(){return !this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce(((e,i)=>{if(!i.dem)return e;const o=i.dem.tree.minimums[0];return o>0&&t++,e+o}),0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,i=e.gl;e.activeTexture.set(i.TEXTURE2);const o=this._getLoadedAreaMinimum(),r={width:1,height:1,data:new Uint8Array(t.DEMData.pack(o,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let n=this._emptyDEMTexture;return n?n.update(r,{premultiply:!1}):n=this._emptyDEMTexture=new t.Texture(e,r,i.RGBA,{premultiply:!1}),n}setupElevationDraw(e,i,o){const r=this.painter.context,n=r.gl,a=(s=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(s),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var s;a.u_dem_size=this.sourceCache.getSource().tileSize,a.u_exaggeration=this.exaggeration();let l=null,c=null,h=1;if(o&&o.morphing&&this._useVertexMorphing){const t=o.morphing.srcDemTile,i=o.morphing.dstDemTile;h=o.morphing.phase,t&&i&&(this._prepareDemTileUniforms(e,t,a,"_prev")&&(c=t),this._prepareDemTileUniforms(e,i,a)&&(l=i));}if(c&&l?(r.activeTexture.set(n.TEXTURE2),l.demTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE,n.NEAREST),r.activeTexture.set(n.TEXTURE4),c.demTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE,n.NEAREST),a.u_dem_lerp=h):(l=this.terrainTileForTile[e.tileID.key],r.activeTexture.set(n.TEXTURE2),(this._prepareDemTileUniforms(e,l,a)?l.demTexture:this.emptyDEMTexture).bind(n.NEAREST,n.CLAMP_TO_EDGE)),o&&o.useDepthForOcclusion&&(r.activeTexture.set(n.TEXTURE3),this._depthTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE),a.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),o&&o.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;a.u_meter_to_dem=e;}o&&o.labelPlaneMatrixInv&&(a.u_label_plane_matrix_inv=o.labelPlaneMatrixInv),i.setTerrainUniformValues(r,a);}renderToBackBuffer(e){const i=this.painter,o=this.painter.context;0!==e.length&&(o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),this.renderingToTexture=!1,function(e,i,o,r,n){const a=e.context,s=a.gl;let l,c;const h=e.options.showTerrainWireframe?2:0,u=(t,i)=>{if(c===t)return;const o=[ai[t]];i&&o.push(ai[h]),l=e.useProgram("terrainRaster",null,o),c=t;},d=e.colorModeForRenderPass(),_=new t.DepthMode(s.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);ni.update(n);const m=e.transform,p=6*Math.pow(1.5,22-m.zoom)*i.exaggeration();(h?[!1,!0]:[!1]).forEach((h=>{c=-1;const f=h?s.LINES:s.TRIANGLES,[g,v]=h?i.getWirefameBuffer():[i.gridIndexBuffer,i.gridSegments];for(const c of r){const r=o.getTile(c),b=t.StencilMode.disabled,w=i.prevTerrainTileForTile[c.key],T=i.terrainTileForTile[c.key];y=T,null!=(x=w)&&null!=y&&x.hasData()&&y.hasData()&&null!=x.demTexture&&null!=y.demTexture&&x.tileID.key!==y.tileID.key&&ni.newMorphing(c.key,w,T,n,250),a.activeTexture.set(s.TEXTURE0),r.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const E=ni.getMorphValuesForProxy(c.key),C=E?1:0;let S;E&&(S={morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:t.easeCubicInOut(E.phase)}});const M=ri(c.projMatrix,si(c.canonical,m.renderWorldCopies)?p/10:p);u(C,h),i.setupElevationDraw(r,l,S),e.prepareDrawProgram(a,l,c.toUnwrapped()),l.draw(a,f,_,b,d,t.CullFaceMode.backCCW,M,"terrain_raster",i.gridBuffer,g,v);}var x,y;}));}(i,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,e.splice(0,e.length));}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const i=this.painter,o=this.painter.context,r=this.proxySourceCache,n=this.proxiedCoords[r.id],a=this._drapedRenderBatches.shift(),s=[],l=i.style.order;let c=0;for(const h of n){const n=r.getTileByID(h.proxyTileKey),u=r.proxyCachedFBO[h.key]?r.proxyCachedFBO[h.key][e]:void 0,d=void 0!==u?r.renderCache[u]:this.pool[c++],_=void 0!==u;if(n.texture=d.tex,_&&!d.dirty){s.push(n.tileID);continue}let m;o.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(o.clear({color:t.Color.transparent}),d.dirty=!1);for(let t=a.start;t<=a.end;++t){const e=i.style._layers[l[t]];if(e.isHidden(i.transform.zoom))continue;const r=i.style._getLayerSourceCache(e),n=r?this.proxyToSource[h.key][r.id]:[h];if(!n)continue;const a=n;o.viewport.set([0,0,d.fb.width,d.fb.height]),m!==(r?r.id:null)&&(this._setupStencil(d,n,e,r),m=r?r.id:null),i.renderLayer(i,r,e,a);}this.renderedToTile?(d.dirty=!0,s.push(n.tileID)):_||--c,5===c&&(c=0,this.renderToBackBuffer(s));}return this.renderToBackBuffer(s),this.renderingToTexture=!1,o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),a.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return {efficiency:100};let i,o=0,r=0,n=!1;for(let a=0;a<e;++a){const e=t._layers[t.order[a]];this._style.isLayerDraped(e)?(n&&++o,++r):n||(n=!0,i=e.id);}return 0===r?{efficiency:100}:{efficiency:100*(1-o/r),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter((t=>t.dem)).forEach((e=>{t=Math.min(t,e.dem.tree.minimums[0]);})),0===t?t:(t-30)*this._exaggeration}raycast(t,e,i){if(!this._visibleDemTiles)return null;const o=this._visibleDemTiles.filter((t=>t.dem)).map((o=>{const r=o.tileID,n=Math.pow(2,r.overscaledZ),{x:a,y:s}=r.canonical,l=a/n,c=(a+1)/n,h=s/n,u=(s+1)/n;return {minx:l,miny:h,maxx:c,maxy:u,t:o.dem.tree.raycastRoot(l,h,c,u,t,e,i),tile:o}}));o.sort(((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE)));for(const r of o){if(null==r.t)return null;const o=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,t,e,i);if(null!=o)return o}return null}_createFBO(){const e=this.painter.context,i=e.gl,o=this.drapeBufferSize;e.activeTexture.set(i.TEXTURE0);const r=new t.Texture(e,{width:o[0],height:o[1],data:null},i.RGBA);r.bind(i.LINEAR,i.CLAMP_TO_EDGE);const n=e.createFramebuffer(o[0],o[1],!1);return n.colorAttachment.set(r.texture),n.depthAttachment=new xt(e,n.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,o[0],o[1]),this._stencilRef=0,n.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):n.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:n,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO());}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return !0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return !0;return this._style.order.some((t=>{const e=this._style._layers[t],i=e.isHidden(this.painter.transform.zoom),o=e.getCrossfadeParameters(),r=!!o&&1!==o.t,n=e.hasTransition();return "custom"!==e.type&&!i&&(r||n)}))}_clearRasterFadeFromRenderCache(){let t=!1;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e]._source instanceof wt){t=!0;break}if(t)for(let t=0;t<this._style.order.length;++t){const e=this._style._layers[this._style.order[t]],i=e.isHidden(this.painter.transform.zoom),o=this._style._getLayerSourceCache(e);if("raster"!==e.type||i||!o)continue;const r=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][o.id];if(e)for(const t of e){const e=ci(o.getTile(t),o.findLoadedParent(t,0),o,this.painter.transform,r);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(o.id,t);}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const i=[];let o,r=0,n=this._style._layers[t[r]];for(;!this._style.isLayerDraped(n)&&n.isHidden(this.painter.transform.zoom)&&++r<e;)n=this._style._layers[t[r]];for(;r<e;++r){const e=this._style._layers[t[r]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===o&&(o=r):void 0!==o&&(i.push({start:o,end:r-1}),o=void 0));}void 0!==o&&i.push({start:o,end:r-1}),this._drapedRenderBatches=i;}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let i=0;i<t.length;++i){const o=Object.values(t[i]);e.renderCachePool.push(...o);}}return}this._clearRasterFadeFromRenderCache();const i=this.proxyCoords,o=this._tilesDirty;for(let r=i.length-1;r>=0;r--){const n=i[r];if(e.getTileByID(n.key),void 0!==e.proxyCachedFBO[n.key]){const i=t[n.key],r=this.proxyToSource[n.key];let a=0;for(const t in r){const e=r[t],n=i[t];if(!n||n.length!==e.length||e.some(((e,i)=>e!==n[i]||o[t]&&o[t].hasOwnProperty(e.key)))){a=-1;break}++a;}for(const t in e.proxyCachedFBO[n.key])e.renderCache[e.proxyCachedFBO[n.key][t]].dirty=a<0||a!==Object.values(i).length;}}const r=[...this._drapedRenderBatches];r.sort(((t,e)=>e.end-e.start-(t.end-t.start)));for(const t of r)for(const o of i){if(e.proxyCachedFBO[o.key])continue;let i=e.renderCachePool.pop();void 0===i&&e.renderCache.length<50&&(i=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==i&&(e.proxyCachedFBO[o.key]={},e.proxyCachedFBO[o.key][t.start]=i,e.renderCache[i].dirty=!0);}this._tilesDirty={};}_setupStencil(t,e,i,o){if(!o||!this._sourceTilesOverlap[o.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const r=this.painter.context,n=r.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let a;if(i.isTileClipped())a=e.length,this._overlapStencilMode.test={func:n.EQUAL,mask:255},this._overlapStencilType="Clip";else {if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);a=1,this._overlapStencilMode.test={func:n.GREATER,mask:255},this._overlapStencilType="Mask";}this._stencilRef+a>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=a,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref);}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,i){const o=this.painter,r=this.painter.context,n=r.gl;o._tileClippingMaskIDs={},r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const a=o.useProgram("clippingMask");for(const s of e){const e=o._tileClippingMaskIDs[s.key]=--i;a.draw(r,n.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:n.ALWAYS,mask:0},e,255,n.KEEP,n.KEEP,n.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,li(s.projMatrix),"$clipping",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments);}}pointCoordinate(e){const i=this.painter.transform;if(e.x<0||e.x>i.width||e.y<0||e.y>i.height)return null;const o=[e.x,e.y,1,1];t.transformMat4(o,o,i.pixelMatrixInverse),t.scale$2(o,o,1/o[3]),o[0]/=i.worldSize,o[1]/=i.worldSize;const r=i._camera.position,n=t.mercatorZfromAltitude(1,i.center.lat),a=[r[0],r[1],r[2]/n,0],s=t.subtract([],o.slice(0,3),a);t.normalize(s,s);const l=this.raycast(a,s,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(a,a,s,l),a[3]=a[2],a[2]*=n,a):null}drawDepth(){const e=this.painter,i=e.context,o=this.proxySourceCache,r=Math.ceil(e.width),n=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===n||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const e=i.gl,o=i.createFramebuffer(r,n,!0);i.activeTexture.set(e.TEXTURE0);const a=new t.Texture(i,{width:r,height:n,data:null},e.RGBA);a.bind(e.NEAREST,e.CLAMP_TO_EDGE),o.colorAttachment.set(a.texture);const s=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,r,n);o.depthAttachment.set(s),this._depthFBO=o,this._depthTexture=a;}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,r,n]),function(e,i,o,r){const n=e.context,a=n.gl;n.clear({depth:1});const s=e.useProgram("terrainDepth"),l=new t.DepthMode(a.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const e of r){const r=o.getTile(e),c=ri(e.projMatrix,0);i.setupElevationDraw(r,s),s.draw(n,a.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,c,"terrain_depth",i.gridBuffer,i.gridIndexBuffer,i.gridNoSkirtSegments);}}(e,this,o,this.proxyCoords);}_setupProxiedCoordsForOrtho(t,e,i){if(t.getSource()instanceof Et)return this._setupProxiedCoordsForImageSource(t,e,i);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const o=this.proxiedCoords[t.id]=[],r=this.proxyCoords;for(let e=0;e<r.length;e++){const n=r[e],a=this._findTileCoveringTileID(n,t);if(a){const e=this._createProxiedId(n,a,i[n.key]&&i[n.key][t.id]);o.push(e),this.proxyToSource[n.key][t.id]=[e];}}let n=!1;for(let r=0;r<e.length;r++){const a=t.getTile(e[r]);if(!a||!a.hasData())continue;const s=this._findTileCoveringTileID(a.tileID,this.proxySourceCache);if(s&&s.tileID.canonical.z!==a.tileID.canonical.z){const e=this.proxyToSource[s.tileID.key][t.id],r=this._createProxiedId(s.tileID,a,i[s.tileID.key]&&i[s.tileID.key][t.id]);e?e.splice(e.length-1,0,r):this.proxyToSource[s.tileID.key][t.id]=[r],o.push(r),n=!0;}}this._sourceTilesOverlap[t.id]=n;}_setupProxiedCoordsForImageSource(e,i,o){if(!e.getSource().loaded())return;const r=this.proxiedCoords[e.id]=[],n=this.proxyCoords,a=e.getSource(),s=new t.pointGeometry(a.tileID.x,a.tileID.y)._div(1<<a.tileID.z),l=a.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce(((t,e)=>(t.min.x=Math.min(t.min.x,e.x-s.x),t.min.y=Math.min(t.min.y,e.y-s.y),t.max.x=Math.max(t.max.x,e.x-s.x),t.max.y=Math.max(t.max.y,e.y-s.y),t)),{min:new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(e,i)=>{const o=e.wrap+e.canonical.x/(1<<e.canonical.z),r=e.canonical.y/(1<<e.canonical.z),n=t.EXTENT/(1<<e.canonical.z),a=i.wrap+i.canonical.x/(1<<i.canonical.z),s=i.canonical.y/(1<<i.canonical.z);return o+n<a+l.min.x||o>a+l.max.x||r+n<s+l.min.y||r>s+l.max.y};for(let t=0;t<n.length;t++){const a=n[t];for(let t=0;t<i.length;t++){const n=e.getTile(i[t]);if(!n||!n.hasData())continue;if(c(a,n.tileID))continue;const s=this._createProxiedId(a,n,o[a.key]&&o[a.key][e.id]),l=this.proxyToSource[a.key][e.id];l?l.push(s):this.proxyToSource[a.key][e.id]=[s],r.push(s);}}}_createProxiedId(e,i,o){let r=this.orthoMatrix;if(o){const t=o.find((t=>t.key===i.tileID.key));if(t)return t}if(i.tileID.key!==e.key){const o=e.canonical.z-i.tileID.canonical.z;let n,a,s;r=t.create$1();const l=i.tileID.wrap-e.wrap<<e.overscaledZ;o>0?(n=t.EXTENT>>o,a=n*((i.tileID.canonical.x<<o)-e.canonical.x+l),s=n*((i.tileID.canonical.y<<o)-e.canonical.y)):(n=t.EXTENT<<-o,a=t.EXTENT*(i.tileID.canonical.x-(e.canonical.x+l<<-o)),s=t.EXTENT*(i.tileID.canonical.y-(e.canonical.y<<-o))),t.ortho(r,0,n,0,n,0,1),t.translate(r,r,[a,s,0]);}return new ui(i.tileID,e.key,r)}_findTileCoveringTileID(e,i){let o=i.getTile(e);if(o&&o.hasData())return o;const r=this._findCoveringTileCache[i.id],n=r[e.key];if(o=n?i.getTileByID(n):null,o&&o.hasData()||null===n)return o;let a=o?o.tileID:e,s=a.overscaledZ;const l=i.getSource().minzoom,c=[];if(!n){const r=i.getSource().maxzoom;if(e.canonical.z>=r){const o=e.canonical.z-r;i.getSource().reparseOverscaled?(s=Math.max(e.canonical.z+2,i.transform.tileZoom),a=new t.OverscaledTileID(s,e.wrap,r,e.canonical.x>>o,e.canonical.y>>o)):0!==o&&(s=r,a=new t.OverscaledTileID(s,e.wrap,r,e.canonical.x>>o,e.canonical.y>>o));}a.key!==e.key&&(c.push(a.key),o=i.getTile(a));}const h=t=>{c.forEach((e=>{r[e]=t;})),c.length=0;};for(s-=1;s>=l&&(!o||!o.hasData());s--){o&&h(o.tileID.key);const t=a.calculateScaledKey(s);if(o=i.getTileByID(t),o&&o.hasData())break;const e=r[t];if(null===e)break;void 0===e?c.push(t):o=i.getTileByID(e);}return h(o?o.tileID.key:null),o&&o.hasData()?o:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(t){this.renderedToTile=!0;}_clearRenderCacheForTile(t,e){let i=this._tilesDirty[t];i||(i=this._tilesDirty[t]={}),i[e.key]=!0;}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let i,o,r;const n=new t.StructArrayLayout2ui4,a=131;for(o=1;o<129;o++){for(i=1;i<129;i++)r=o*a+i,n.emplaceBack(r,r+1),n.emplaceBack(r,r+a),n.emplaceBack(r+1,r+a),128===o&&n.emplaceBack(r+a,r+a+1);n.emplaceBack(r+1,r+1+a);}return n}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length);}return [this.wireframeIndexBuffer,this.wireframeSegments]}}function _i(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const o=t[i].split(" ");e.push(o.pop());}return e}class mi{static cacheKey(t,e,i){let o=`${t}${i?i.cacheKey:""}`;for(const t of e)o+=`/${t}`;return o}constructor(e,i,o,r,n,a){const s=e.gl;this.program=s.createProgram();const l=_i(o.staticAttributes),c=r?r.getBinderAttributes():[],h=l.concat(c),u=o.staticUniforms?_i(o.staticUniforms):[],d=r?r.getBinderUniforms():[],_=u.concat(d),m=[];for(const t of _)m.indexOf(t)<0&&m.push(t);let p=r?r.defines():[];p=p.concat(a.map((t=>`#define ${t}`)));const f=p.concat("\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",He,$e.fragmentSource,Xe.fragmentSource,o.fragmentSource).join("\n"),g=p.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",He,$e.vertexSource,Xe.vertexSource,qe.vertexSource,o.vertexSource).join("\n"),v=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(v,f),s.compileShader(v),s.attachShader(this.program,v);const x=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(x,g),s.compileShader(x),s.attachShader(this.program,x),this.attributes={};const y={};this.numAttributes=h.length;for(let t=0;t<this.numAttributes;t++)h[t]&&(s.bindAttribLocation(this.program,t,h[t]),this.attributes[h[t]]=t);s.linkProgram(this.program),s.deleteShader(x),s.deleteShader(v);for(let t=0;t<m.length;t++){const e=m[t];if(e&&!y[e]){const t=s.getUniformLocation(this.program,e);t&&(y[e]=t);}}this.fixedUniforms=n(e,y),this.binderUniforms=r?r.getUniforms(e,y):[],-1!==a.indexOf("TERRAIN")&&(this.terrainUniforms=((e,i)=>({u_dem:new t.Uniform1i(e,i.u_dem),u_dem_prev:new t.Uniform1i(e,i.u_dem_prev),u_dem_unpack:new t.Uniform4f(e,i.u_dem_unpack),u_dem_tl:new t.Uniform2f(e,i.u_dem_tl),u_dem_scale:new t.Uniform1f(e,i.u_dem_scale),u_dem_tl_prev:new t.Uniform2f(e,i.u_dem_tl_prev),u_dem_scale_prev:new t.Uniform1f(e,i.u_dem_scale_prev),u_dem_size:new t.Uniform1f(e,i.u_dem_size),u_dem_lerp:new t.Uniform1f(e,i.u_dem_lerp),u_exaggeration:new t.Uniform1f(e,i.u_exaggeration),u_depth:new t.Uniform1i(e,i.u_depth),u_depth_size_inv:new t.Uniform2f(e,i.u_depth_size_inv),u_meter_to_dem:new t.Uniform1f(e,i.u_meter_to_dem),u_label_plane_matrix_inv:new t.UniformMatrix4f(e,i.u_label_plane_matrix_inv),u_tile_tl_up:new t.Uniform3f(e,i.u_tile_tl_up),u_tile_tr_up:new t.Uniform3f(e,i.u_tile_tr_up),u_tile_br_up:new t.Uniform3f(e,i.u_tile_br_up),u_tile_bl_up:new t.Uniform3f(e,i.u_tile_bl_up),u_tile_up_scale:new t.Uniform1f(e,i.u_tile_up_scale)}))(e,y)),-1!==a.indexOf("FOG")&&(this.fogUniforms=((e,i)=>({u_fog_matrix:new t.UniformMatrix4f(e,i.u_fog_matrix),u_fog_range:new t.Uniform2f(e,i.u_fog_range),u_fog_color:new t.Uniform4f(e,i.u_fog_color),u_fog_horizon_blend:new t.Uniform1f(e,i.u_fog_horizon_blend),u_fog_temporal_offset:new t.Uniform1f(e,i.u_fog_temporal_offset)}))(e,y));}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)i[t].set(e[t]);}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)i[t].location&&i[t].set(e[t]);}}draw(t,e,i,o,r,n,a,s,l,c,h,u,d,_,m,p){const f=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(o),t.setColorMode(r),t.setCullFace(n);for(const t in this.fixedUniforms)this.fixedUniforms[t].set(a[t]);_&&_.setUniforms(t,this.binderUniforms,u,{zoom:d});const g={[f.LINES]:2,[f.TRIANGLES]:3,[f.LINE_STRIP]:1}[e];for(const i of h.get()){const o=i.vaos||(i.vaos={});(o[s]||(o[s]=new Je)).bind(t,this,l,_?_.getPaintVertexBuffers():[],c,i.vertexOffset,m,p),f.drawElements(e,i.primitiveLength*g,f.UNSIGNED_SHORT,i.primitiveOffset*g*2);}}}function pi(t,e,i){const o=1/A(i,1,e.transform.tileZoom),r=Math.pow(2,i.tileID.overscaledZ),n=i.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=n*(i.tileID.canonical.x+i.tileID.wrap*r),s=n*i.tileID.canonical.y;return {u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[o,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}const fi=(e,i,o,r)=>{const n=i.style.light,a=n.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$2();"viewport"===n.properties.get("anchor")&&(t.fromRotation(l,-i.transform.angle),t.transformMat3(s,s,l));const c=n.properties.get("color");return {u_matrix:e,u_lightpos:s,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+o,u_opacity:r}},gi=(e,i,o,r,n,a,s)=>t.extend(fi(e,i,o,r),pi(a,i,s),{u_height_factor:-Math.pow(2,n.overscaledZ)/s.tileSize/8}),vi=t=>({u_matrix:t}),xi=(e,i,o,r)=>t.extend(vi(e),pi(o,i,r)),yi=(t,e)=>({u_matrix:t,u_world:e}),bi=(e,i,o,r,n)=>t.extend(xi(e,i,o,r),{u_world:n}),wi=(e,i,o,r)=>{const n=e.transform;let a;return a="map"===r.paint.get("circle-pitch-alignment")?n.calculatePixelsToTileUnitsMatrix(o):new Float32Array([n.pixelsToGLUnits[0],0,0,n.pixelsToGLUnits[1]]),{u_camera_to_center_distance:n.cameraToCenterDistance,u_matrix:e.translatePosMatrix(i.projMatrix,o,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:a}},Ti=t=>{const e=[];return "map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},Ei=(e,i,o)=>{const r=t.EXTENT/o.tileSize;return {u_matrix:e,u_camera_to_center_distance:i.cameraToCenterDistance,u_extrude_scale:[i.pixelsToGLUnits[0]/r,i.pixelsToGLUnits[1]/r]}},Ci=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),Si=(t,e,i,o)=>({u_matrix:t,u_extrude_scale:A(e,1,i),u_intensity:o}),Mi=(e,i,o,r,n,a)=>{const s=e.transform,l=s.calculatePixelsToTileUnitsMatrix(i),c={u_matrix:Ai(e,i,o,n),u_pixels_to_tile_units:l,u_device_pixel_ratio:t.exported.devicePixelRatio,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:a,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Pi(o)){const t=zi(i,e.transform);c.u_texsize=i.lineAtlasTexture.size,c.u_scale=[t,r.fromScale,r.toScale],c.u_mix=r.t;}return c},Ii=(e,i,o,r,n)=>{const a=e.transform,s=zi(i,a);return {u_matrix:Ai(e,i,o,n),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:a.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:t.exported.devicePixelRatio,u_image:0,u_scale:[s,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}};function zi(t,e){return 1/A(t,1,e.tileZoom)}function Ai(t,e,i,o){return t.translatePosMatrix(o||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Di=t=>{const e=[];return Pi(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT"),e};function Pi(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}const Li=(t,e,i,o,r)=>{return {u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(n=r.paint.get("raster-contrast"),n>0?1/(1-n):1+n),u_spin_weights:Ri(r.paint.get("raster-hue-rotate"))};var n,a;};function Ri(t){t*=Math.PI/180;const e=Math.sin(t),i=Math.cos(t);return [(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const ki=(t,e,i,o,r,n,a,s,l,c,h,u,d,_)=>{const m=r.transform;return {u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:m.cameraToCenterDistance,u_pitch:m.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:m.width/m.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:n,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+o,u_texsize:c,u_tile_id:h,u_zoom_transition:u,u_inv_rot_matrix:d,u_merc_center:_,u_texture:0}},Fi=(e,i,o,r,n,a,s,l,c,h,u,d,_,m,p)=>{const{cameraToCenterDistance:f,_pitch:g}=n.transform;return t.extend(ki(e,i,o,r,n,a,s,l,c,h,d,_,m,p),{u_gamma_scale:r?f*Math.cos(n.terrain?0:g):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+u})},Bi=(e,i,o,r,n,a,s,l,c,h,u,d,_,m)=>t.extend(Fi(e,i,o,r,n,a,s,l,!0,c,!0,u,d,_,m),{u_texsize_icon:h,u_texture_icon:1}),Oi=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),Ui=(e,i,o,r,n,a)=>t.extend(function(t,e,i,o){const r=i.imageManager.getPattern(t.from.toString()),n=i.imageManager.getPattern(t.to.toString()),{width:a,height:s}=i.imageManager.getPixelSize(),l=Math.pow(2,o.tileID.overscaledZ),c=o.tileSize*Math.pow(2,i.transform.tileZoom)/l,h=c*(o.tileID.canonical.x+o.tileID.wrap*l),u=c*o.tileID.canonical.y;return {u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:n.tl,u_pattern_br_b:n.br,u_texsize:[a,s],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:n.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/A(o,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,u>>16],u_pixel_coord_lower:[65535&h,65535&u]}}(r,a,o,n),{u_matrix:e,u_opacity:i}),Ni={fillExtrusion:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_opacity:new t.Uniform1f(e,i.u_opacity)}),fillExtrusionPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,i.u_height_factor),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade),u_opacity:new t.Uniform1f(e,i.u_opacity)}),fill:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),fillPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),fillOutline:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world)}),fillOutlinePattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),circle:(e,i)=>({u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_extrude_scale:new t.UniformMatrix2f(e,i.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),collisionBox:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,i.u_extrude_scale)}),collisionCircle:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,i.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,i.u_viewport_size)}),debug:(e,i)=>({u_color:new t.UniformColor(e,i.u_color),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_overlay:new t.Uniform1i(e,i.u_overlay),u_overlay_scale:new t.Uniform1f(e,i.u_overlay_scale)}),clippingMask:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),heatmap:(e,i)=>({u_extrude_scale:new t.Uniform1f(e,i.u_extrude_scale),u_intensity:new t.Uniform1f(e,i.u_intensity),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),heatmapTexture:(e,i)=>({u_image:new t.Uniform1i(e,i.u_image),u_color_ramp:new t.Uniform1i(e,i.u_color_ramp),u_opacity:new t.Uniform1f(e,i.u_opacity)}),hillshade:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_latrange:new t.Uniform2f(e,i.u_latrange),u_light:new t.Uniform2f(e,i.u_light),u_shadow:new t.UniformColor(e,i.u_shadow),u_highlight:new t.UniformColor(e,i.u_highlight),u_accent:new t.UniformColor(e,i.u_accent)}),hillshadePrepare:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_dimension:new t.Uniform2f(e,i.u_dimension),u_zoom:new t.Uniform1f(e,i.u_zoom),u_unpack:new t.Uniform4f(e,i.u_unpack)}),line:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_pixels_to_tile_units:new t.UniformMatrix2f(e,i.u_pixels_to_tile_units),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_dash_image:new t.Uniform1i(e,i.u_dash_image),u_gradient_image:new t.Uniform1i(e,i.u_gradient_image),u_image_height:new t.Uniform1f(e,i.u_image_height),u_texsize:new t.Uniform2f(e,i.u_texsize),u_scale:new t.Uniform3f(e,i.u_scale),u_mix:new t.Uniform1f(e,i.u_mix)}),linePattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixels_to_tile_units:new t.UniformMatrix2f(e,i.u_pixels_to_tile_units),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_image:new t.Uniform1i(e,i.u_image),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),raster:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_tl_parent:new t.Uniform2f(e,i.u_tl_parent),u_scale_parent:new t.Uniform1f(e,i.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,i.u_buffer_scale),u_fade_t:new t.Uniform1f(e,i.u_fade_t),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image0:new t.Uniform1i(e,i.u_image0),u_image1:new t.Uniform1i(e,i.u_image1),u_brightness_low:new t.Uniform1f(e,i.u_brightness_low),u_brightness_high:new t.Uniform1f(e,i.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,i.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,i.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,i.u_spin_weights)}),symbolIcon:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_tile_id:new t.Uniform3f(e,i.u_tile_id),u_zoom_transition:new t.Uniform1f(e,i.u_zoom_transition),u_inv_rot_matrix:new t.UniformMatrix4f(e,i.u_inv_rot_matrix),u_merc_center:new t.Uniform2f(e,i.u_merc_center),u_texture:new t.Uniform1i(e,i.u_texture)}),symbolSDF:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texture:new t.Uniform1i(e,i.u_texture),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_tile_id:new t.Uniform3f(e,i.u_tile_id),u_zoom_transition:new t.Uniform1f(e,i.u_zoom_transition),u_inv_rot_matrix:new t.UniformMatrix4f(e,i.u_inv_rot_matrix),u_merc_center:new t.Uniform2f(e,i.u_merc_center),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}),symbolTextAndIcon:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texsize_icon:new t.Uniform2f(e,i.u_texsize_icon),u_texture:new t.Uniform1i(e,i.u_texture),u_texture_icon:new t.Uniform1i(e,i.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}),background:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_color:new t.UniformColor(e,i.u_color)}),backgroundPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image:new t.Uniform1i(e,i.u_image),u_pattern_tl_a:new t.Uniform2f(e,i.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,i.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,i.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,i.u_pattern_br_b),u_texsize:new t.Uniform2f(e,i.u_texsize),u_mix:new t.Uniform1f(e,i.u_mix),u_pattern_size_a:new t.Uniform2f(e,i.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,i.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,i.u_scale_a),u_scale_b:new t.Uniform1f(e,i.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,i.u_tile_units_to_pixels)}),terrainRaster:oi,terrainDepth:oi,skybox:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_sun_direction:new t.Uniform3f(e,i.u_sun_direction),u_cubemap:new t.Uniform1i(e,i.u_cubemap),u_opacity:new t.Uniform1f(e,i.u_opacity),u_temporal_offset:new t.Uniform1f(e,i.u_temporal_offset)}),skyboxGradient:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_color_ramp:new t.Uniform1i(e,i.u_color_ramp),u_center_direction:new t.Uniform3f(e,i.u_center_direction),u_radius:new t.Uniform1f(e,i.u_radius),u_opacity:new t.Uniform1f(e,i.u_opacity),u_temporal_offset:new t.Uniform1f(e,i.u_temporal_offset)}),skyboxCapture:(e,i)=>({u_matrix_3f:new t.UniformMatrix3f(e,i.u_matrix_3f),u_sun_direction:new t.Uniform3f(e,i.u_sun_direction),u_sun_intensity:new t.Uniform1f(e,i.u_sun_intensity),u_color_tint_r:new t.Uniform4f(e,i.u_color_tint_r),u_color_tint_m:new t.Uniform4f(e,i.u_color_tint_m),u_luminance:new t.Uniform1f(e,i.u_luminance)})};let Gi;function Zi(e,i,o,r,n,a,s){const l=e.context,c=l.gl,h=e.useProgram("collisionBox"),u=[];let d=0,_=0;for(let m=0;m<r.length;m++){const p=r[m],f=i.getTile(p),g=f.getBucket(o);if(!g)continue;let v=p.projMatrix;0===n[0]&&0===n[1]||(v=e.translatePosMatrix(p.projMatrix,f,n,a));const x=s?g.textCollisionBox:g.iconCollisionBox,y=g.collisionCircleArray;if(y.length>0){const i=t.create$1(),o=v;t.mul$1(i,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul$1(i,i,g.placementViewportMatrix),u.push({circleArray:y,circleOffset:_,transform:o,invTransform:i}),d+=y.length/4,_=d;}x&&(e.terrain&&e.terrain.setupElevationDraw(f,h),h.draw(l,c.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,Ei(v,e.transform,f),o.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,e.transform.zoom,null,x.collisionVertexBuffer,x.collisionVertexBufferExt));}if(!s||!u.length)return;const m=e.useProgram("collisionCircle"),p=new t.StructArrayLayout2f1f2i16;p.resize(4*d),p._trim();let f=0;for(const t of u)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,o=t.circleArray[i+0],r=t.circleArray[i+1],n=t.circleArray[i+2],a=t.circleArray[i+3];p.emplace(f++,o,r,n,a,0),p.emplace(f++,o,r,n,a,1),p.emplace(f++,o,r,n,a,2),p.emplace(f++,o,r,n,a,3);}(!Gi||Gi.length<2*d)&&(Gi=function(e){const i=2*e,o=new t.StructArrayLayout3ui6;o.resize(i),o._trim();for(let t=0;t<i;t++){const e=6*t;o.uint16[e+0]=4*t+0,o.uint16[e+1]=4*t+1,o.uint16[e+2]=4*t+2,o.uint16[e+3]=4*t+2,o.uint16[e+4]=4*t+3,o.uint16[e+5]=4*t+0;}return o}(d));const g=l.createIndexBuffer(Gi,!0),v=l.createVertexBuffer(p,t.collisionCircleLayout.members,!0);for(const i of u){const r={u_matrix:i.transform,u_inv_matrix:i.invTransform,u_camera_to_center_distance:(x=e.transform).cameraToCenterDistance,u_viewport_size:[x.width,x.height]};m.draw(l,c.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,r,o.id,v,g,t.SegmentVector.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,e.transform.zoom,null,null,null);}var x;v.destroy(),g.destroy();}const ji=t.identity(new Float32Array(16));function Vi(e,i,o,r,n,a){const{horizontalAlign:s,verticalAlign:l}=t.getAnchorAlignment(e),c=-(s-.5)*i,h=-(l-.5)*o,u=t.evaluateVariableOffset(e,r);return new t.pointGeometry((c/n+u[0])*a,(h/n+u[1])*a)}function Wi(e,i,o,r,n,a,s,l,c,h,u,d){const _=e.text.placedSymbolArray,m=e.text.dynamicLayoutVertexArray,p=e.icon.dynamicLayoutVertexArray,f={};m.clear();for(let p=0;p<_.length;p++){const g=_.get(p),v=e.allowVerticalPlacement&&!g.placedOrientation,x=g.hidden||!g.crossTileID||v?null:r[g.crossTileID];if(x){const r=new t.pointGeometry(g.tileAnchorX,g.tileAnchorY),_=d(r),p=Yt(r,o?l:s,_),v=Jt(a.cameraToCenterDistance,p.signedDistanceFromCamera);let y=n.evaluateSizeForFeature(e.textSizeData,h,g)*v/t.ONE_EM;o&&(y*=e.tilePixelRatio/c);const{width:b,height:w,anchor:T,textOffset:E,textScale:C}=x,S=Vi(T,b,w,E,C,y),M=o?Yt(r.add(S),s,_).point:p.point.add(i?S.rotate(-a.angle):S),I=e.allowVerticalPlacement&&g.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<g.numGlyphs;e++)t.addDynamicAttributes(m,M,I);u&&g.associatedIconIndex>=0&&(f[g.associatedIconIndex]={shiftedAnchor:M,angle:I});}else le(g.numGlyphs,m);}if(u){p.clear();const i=e.icon.placedSymbolArray;for(let e=0;e<i.length;e++){const o=i.get(e);if(o.hidden)le(o.numGlyphs,p);else {const i=f[e];if(i)for(let e=0;e<o.numGlyphs;e++)t.addDynamicAttributes(p,i.shiftedAnchor,i.angle);else le(o.numGlyphs,p);}}e.icon.dynamicLayoutVertexBuffer.updateData(p);}e.text.dynamicLayoutVertexBuffer.updateData(m);}function qi(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Xi(e,i,o,r,n,a,s,l,c,h,u,d){const _=e.context,m=_.gl,p=e.transform,f="map"===l,g="map"===c,v=f&&"point"!==o.layout.get("symbol-placement"),x=f&&!g&&!v,y=void 0!==o.layout.get("symbol-sort-key").constantOr(1);let b=!1;const w=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),T=[0,0],E=o.layout.get("text-variable-anchor"),C=[],S=[];e.terrain&&g&&S.push("PITCH_WITH_MAP_TERRAIN"),v&&S.push("PROJECTED_POS_ON_VIEWPORT");for(const l of r){const r=i.getTile(l),c=r.getBucket(o);if(!c)continue;const u=n?c.text:c.icon;if(!u||!u.segments.get().length)continue;const d=u.programConfigurations.get(o.id),_=n||c.sdfIcons,w=n?c.textSizeData:c.iconSizeData,M=g||0!==p.pitch,I=e.useProgram(qi(_,n,c),d,S),z=t.evaluateSizeForZoom(w,p.zoom),A=[l.canonical.x,l.canonical.y,1<<l.canonical.z];let D,P,L,R,k=[0,0],F=null;if(n){if(P=r.glyphAtlasTexture,L=m.LINEAR,D=r.glyphAtlasTexture.size,c.iconsInText){k=r.imageAtlasTexture.size,F=r.imageAtlasTexture;const t="composite"===w.kind||"camera"===w.kind;R=M||e.options.rotating||e.options.zooming||t?m.LINEAR:m.NEAREST;}}else {const t=1!==o.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;P=r.imageAtlasTexture,L=_||e.options.rotating||e.options.zooming||t||M?m.LINEAR:m.NEAREST,D=r.imageAtlasTexture.size;}const B=e.transform.calculatePixelsToTileUnitsMatrix(r),O=Ht(l.projMatrix,g,f,e.transform,B),U=e.terrain&&g&&v?t.invert(new Float32Array(16),O):ji,N=Kt(l.projMatrix,g,f,e.transform,B),G=E&&c.hasTextData(),Z="none"!==o.layout.get("icon-text-fit")&&G&&c.hasIconData();if(v){const t=p.elevation;te(c,l.projMatrix,e,n,O,N,g,h,t?e=>t.getAtTileOffset(l,e.x,e.y):null);}const j=e.translatePosMatrix(l.projMatrix,r,a,s),V=v||n&&E||Z?ji:O,W=e.translatePosMatrix(N,r,a,s,!0),q=_&&0!==o.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1);let X;X=_?c.iconsInText?Bi(w.kind,z,x,g,e,j,V,W,D,k,A,0,e.identityMat,T):Fi(w.kind,z,x,g,e,j,V,W,n,D,!0,A,0,e.identityMat,T):ki(w.kind,z,x,g,e,j,V,W,n,D,A,0,e.identityMat,T);const $={program:I,buffers:u,uniformValues:X,atlasTexture:P,atlasTextureIcon:F,atlasInterpolation:L,atlasInterpolationIcon:R,isSDF:_,hasHalo:q,tile:r,labelPlaneMatrixInv:U};if(y&&c.canOverlap){b=!0;const e=u.segments.get();for(const i of e)C.push({segments:new t.SegmentVector([i]),sortKey:i.sortKey,state:$});}else C.push({segments:u.segments,sortKey:0,state:$});}b&&C.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of C){const i=t.state;if(e.terrain&&e.terrain.setupElevationDraw(i.tile,i.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:i.labelPlaneMatrixInv}),_.activeTexture.set(m.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,m.CLAMP_TO_EDGE),i.atlasTextureIcon&&(_.activeTexture.set(m.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),i.isSDF){const r=i.uniformValues;i.hasHalo&&(r.u_is_halo=1,$i(i.buffers,t.segments,o,e,i.program,w,u,d,r)),r.u_is_halo=0;}$i(i.buffers,t.segments,o,e,i.program,w,u,d,i.uniformValues);}}function $i(e,i,o,r,n,a,s,l,c){const h=r.context;n.draw(h,h.gl.TRIANGLES,a,s,l,t.CullFaceMode.disabled,c,o.id,e.layoutVertexBuffer,e.indexBuffer,i,o.paint,r.transform.zoom,e.programConfigurations.get(o.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer);}function Hi(e,i,o,r,n,a,s){const l=e.context.gl,c=o.paint.get("fill-pattern"),h=c&&c.constantOr(1),u=o.getCrossfadeParameters();let d,_,m,p,f;s?(_=h&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=l.LINES):(_=h?"fillPattern":"fill",d=l.TRIANGLES);for(const g of r){const r=i.getTile(g);if(h&&!r.patternsLoaded())continue;const v=r.getBucket(o);if(!v)continue;e.prepareDrawTile(g);const x=v.programConfigurations.get(o.id),y=e.useProgram(_,x);h&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),x.updatePaintBuffers(u));const b=c.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],i=t.patternPositions[b.from.toString()];e&&i&&x.setConstantPatternPositions(e,i);}const w=e.translatePosMatrix(g.projMatrix,r,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(s){p=v.indexBuffer2,f=v.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];m="fillOutlinePattern"===_&&h?bi(w,e,u,r,t):yi(w,t);}else p=v.indexBuffer,f=v.segments,m=h?xi(w,e,u,r):vi(w);e.prepareDrawProgram(e.context,y,g.toUnwrapped()),y.draw(e.context,d,n,e.stencilModeForClipping(g),a,t.CullFaceMode.disabled,m,o.id,v.layoutVertexBuffer,p,f,o.paint,e.transform.zoom,x);}}function Ki(e,i,o,r,n,a,s){const l=e.context,c=l.gl,h=o.paint.get("fill-extrusion-pattern"),u=h.constantOr(1),d=o.getCrossfadeParameters(),_=o.paint.get("fill-extrusion-opacity");for(const m of r){const r=i.getTile(m),p=r.getBucket(o);if(!p)continue;const f=p.programConfigurations.get(o.id),g=e.useProgram(u?"fillExtrusionPattern":"fillExtrusion",f);if(e.terrain){const t=e.terrain;if(!p.enableTerrain)continue;if(t.setupElevationDraw(r,g,{useMeterToDem:!0}),Yi(l,i,m,p,o,t),!p.centroidVertexBuffer){const t=g.attributes.a_centroid_pos;void 0!==t&&c.vertexAttrib2f(t,0,0);}}u&&(e.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),f.updatePaintBuffers(d));const v=h.constantOr(null);if(v&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[v.to.toString()],i=t.patternPositions[v.from.toString()];e&&i&&f.setConstantPatternPositions(e,i);}const x=e.translatePosMatrix(m.projMatrix,r,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),y=o.paint.get("fill-extrusion-vertical-gradient"),b=u?gi(x,e,y,_,m,d,r):fi(x,e,y,_);e.prepareDrawProgram(l,g,m.toUnwrapped()),g.draw(l,l.gl.TRIANGLES,n,a,s,t.CullFaceMode.backCCW,b,o.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,o.paint,e.transform.zoom,f,e.terrain?p.centroidVertexBuffer:null);}}function Yi(e,i,o,r,n,a){const s=[e=>{let i=e.canonical.x-1,o=e.wrap;return i<0&&(i=(1<<e.canonical.z)-1,o--),new t.OverscaledTileID(e.overscaledZ,o,e.canonical.z,i,e.canonical.y)},e=>{let i=e.canonical.x+1,o=e.wrap;return i===1<<e.canonical.z&&(i=0,o++),new t.OverscaledTileID(e.overscaledZ,o,e.canonical.z,i,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=i.getSource().maxzoom,o=t=>{const e=i.getTileByID(t);if(e&&e.hasData())return e.getBucket(n)};let r,a,s;return (t.overscaledZ===t.canonical.z||t.overscaledZ>=e)&&(r=o(t.key)),t.overscaledZ>=e&&(a=o(t.calculateScaledKey(t.overscaledZ+1))),t.overscaledZ>e&&(s=o(t.calculateScaledKey(t.overscaledZ-1))),r||a||s},c=[0,0,0],h=(e,i)=>(c[0]=Math.min(e.min.y,i.min.y),c[1]=Math.max(e.max.y,i.max.y),c[2]=t.EXTENT-i.min.x>e.max.x?i.min.x-t.EXTENT:e.max.x,c),u=(e,i)=>(c[0]=Math.min(e.min.x,i.min.x),c[1]=Math.max(e.max.x,i.max.x),c[2]=t.EXTENT-i.min.y>e.max.y?i.min.y-t.EXTENT:e.max.y,c),d=[(t,e)=>h(t,e),(t,e)=>h(e,t),(t,e)=>u(t,e),(t,e)=>u(e,t)],_=new t.pointGeometry(0,0);let m,p,f;const g=(e,i,r,n,s)=>{const l=[[n?r:e,n?e:r,0],[n?r:i,n?i:r,0]],c=s<0?t.EXTENT+s:s,h=[n?c:(e+i)/2,n?(e+i)/2:c,0];return 0===r&&s<0||0!==r&&s>0?a.getForTilePoints(f,[h],!0,p):l.push(h),a.getForTilePoints(o,l,!0,m),Math.max(l[0][2],l[1][2],h[2])/a.exaggeration()};for(let e=0;e<4;e++){const i=r.borders[e];if(0===i.length&&(r.borderDone[e]=!0),r.borderDone[e])continue;const n=f=s[e](o),c=l(n);if(!c||!c.enableTerrain)continue;if(p=a.findDEMTileFor(n),!p||!p.dem)continue;if(!m){const t=a.findDEMTileFor(o);if(!t||!t.dem)return;m=t;}const h=(e<2?1:5)-e,u=c.borders[h];let v=0;for(let o=0;o<i.length;o++){const n=r.featuresOnBorder[i[o]],a=n.borders[e];let s;for(;v<u.length&&(s=c.featuresOnBorder[u[v]],!(s.borders[h][1]>a[0]+3));)c.borderDone[h]||c.encodeCentroid(void 0,s,!1),v++;if(s&&v<u.length){const i=v;let o=0;for(;!(s.borders[h][0]>a[1]-3)&&(o++,++v!==u.length);)s=c.featuresOnBorder[u[v]];if(s=c.featuresOnBorder[u[i]],n.intersectsCount()>1||s.intersectsCount()>1||1!==o){1!==o&&(v=i),r.encodeCentroid(void 0,n,!1),c.borderDone[h]||c.encodeCentroid(void 0,s,!1);continue}const l=d[e](n,s),m=e%2?t.EXTENT-1:0;_.x=g(l[0],Math.min(t.EXTENT-1,l[1]),m,e<2,l[2]),_.y=0,r.encodeCentroid(_,n,!1),c.borderDone[h]||c.encodeCentroid(_,s,!1);}else r.encodeCentroid(void 0,n,!1);}r.borderDone[e]=r.needsCentroidUpdate=!0,c.borderDone[h]||(c.borderDone[h]=c.needsCentroidUpdate=!0);}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(e);}const Ji=new t.Color(1,0,0,1),Qi=new t.Color(0,1,0,1),to=new t.Color(0,0,1,1),eo=new t.Color(1,0,1,1),io=new t.Color(0,1,1,1);function oo(t,e,i,o){no(t,0,e+i/2,t.transform.width,i,o);}function ro(t,e,i,o){no(t,e-i/2,0,i,t.transform.height,o);}function no(e,i,o,r,n,a){const s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,n*t.exported.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST);}function ao(e,i,o){const r=e.context,n=r.gl,a=o.projMatrix,s=e.useProgram("debug"),l=i.getTileByID(o.key);e.terrain&&e.terrain.setupElevationDraw(l,s);const c=t.DepthMode.disabled,h=t.StencilMode.disabled,u=e.colorModeForRenderPass(),d="$debug";r.activeTexture.set(n.TEXTURE0),e.emptyTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),l._makeDebugTileBoundsBuffers(e.context,e.transform.projection);const _=l._tileDebugBuffer||e.debugBuffer,m=l._tileDebugIndexBuffer||e.debugIndexBuffer,p=l._tileDebugSegments||e.debugSegments;s.draw(r,n.LINE_STRIP,c,h,u,t.CullFaceMode.disabled,Ci(a,t.Color.red),d,_,m,p);const f=l.latestRawTileData,g=Math.floor((f&&f.byteLength||0)/1024),v=i.getTile(o).tileSize,x=512/Math.min(v,512)*(o.overscaledZ/e.transform.zoom)*.5;let y=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(y+=` => ${o.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,o=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE);}(e,`${y} ${g}kb`),s.draw(r,n.TRIANGLES,c,h,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Ci(a,t.Color.transparent,x),d,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments);}const so=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:lo}=so;function co(t,e,i,o){t.emplaceBack(e,i,o);}class ho{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,co(this.vertexArray,-1,-1,1),co(this.vertexArray,1,-1,1),co(this.vertexArray,-1,1,1),co(this.vertexArray,1,1,1),co(this.vertexArray,-1,-1,-1),co(this.vertexArray,1,-1,-1),co(this.vertexArray,-1,1,-1),co(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,lo),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12);}}function uo(e,i,o,r,n,a){const s=e.gl,l=i.paint.get("sky-atmosphere-color"),c=i.paint.get("sky-atmosphere-halo-color"),h=i.paint.get("sky-atmosphere-sun-intensity"),u=((t,e,i,o,r)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:i,u_color_tint_r:[o.r,o.g,o.b,o.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(t.fromMat4([],r),n,h,l,c);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+a,i.skyboxTexture,0),o.draw(e,s.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,u,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment);}const _o={symbol:function(e,i,o,r,n){if("translucent"!==e.renderPass)return;const a=t.StencilMode.disabled,s=e.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(e,i,o,r,n,a,s){const l=i.transform,c="map"===n,h="map"===a;for(const n of e){const e=r.getTile(n),a=e.getBucket(o);if(!a||!a.text||!a.text.segments.get().length)continue;const u=t.evaluateSizeForZoom(a.textSizeData,l.zoom),d=i.transform.calculatePixelsToTileUnitsMatrix(e),_=Ht(n.projMatrix,h,c,i.transform,d),m="none"!==o.layout.get("icon-text-fit")&&a.hasIconData();if(u){const i=Math.pow(2,l.zoom-e.tileID.overscaledZ),o=l.elevation;Wi(a,c,h,s,t.symbolSize,l,_,n.projMatrix,i,u,m,o?t=>o.getAtTileOffset(n,t.x,t.y):t=>0);}}}(r,e,o,i,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),n),0!==o.paint.get("icon-opacity").constantOr(1)&&Xi(e,i,o,r,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),a,s),0!==o.paint.get("text-opacity").constantOr(1)&&Xi(e,i,o,r,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),a,s),i.map.showCollisionBoxes&&(Zi(e,i,o,r,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Zi(e,i,o,r,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1));},circle:function(e,i,o,r){if("translucent"!==e.renderPass)return;const n=o.paint.get("circle-opacity"),a=o.paint.get("circle-stroke-width"),s=o.paint.get("circle-stroke-opacity"),l=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0===n.constantOr(1)&&(0===a.constantOr(1)||0===s.constantOr(1)))return;const c=e.context,h=c.gl,u=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),d=t.StencilMode.disabled,_=e.colorModeForRenderPass(),m=[];for(let n=0;n<r.length;n++){const a=r[n],s=i.getTile(a),c=s.getBucket(o);if(!c)continue;const h=c.programConfigurations.get(o.id),u=Ti(o),d={programConfiguration:h,program:e.useProgram("circle",h,u),layoutVertexBuffer:c.layoutVertexBuffer,indexBuffer:c.indexBuffer,uniformValues:wi(e,a,s,o),tile:s};if(l){const e=c.segments.get();for(const i of e)m.push({segments:new t.SegmentVector([i]),sortKey:i.sortKey,state:d});}else m.push({segments:c.segments,sortKey:0,state:d});}l&&m.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of m){const{programConfiguration:r,program:n,layoutVertexBuffer:a,indexBuffer:s,uniformValues:l,tile:m}=i.state,p=i.segments;e.terrain&&e.terrain.setupElevationDraw(m,n,{useDepthForOcclusion:!0}),e.prepareDrawProgram(c,n,m.tileID.toUnwrapped()),n.draw(c,h.TRIANGLES,u,d,_,t.CullFaceMode.disabled,l,o.id,a,s,p,o.paint,e.transform.zoom,r);}},heatmap:function(e,i,o,r){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const n=e.context,a=n.gl,s=t.StencilMode.disabled,l=new t.ColorMode([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,i){const o=t.gl;t.activeTexture.set(o.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=i.heatmapFbo;if(r)o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else {const n=o.createTexture();o.bindTexture(o.TEXTURE_2D,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),r=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,i,o){const r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),o.colorAttachment.set(i);}(t,e,n,r);}}(n,e,o),n.clear({color:t.Color.transparent});for(let c=0;c<r.length;c++){const h=r[c];if(i.hasRenderableParent(h))continue;const u=i.getTile(h),d=u.getBucket(o);if(!d)continue;const _=d.programConfigurations.get(o.id),m=e.useProgram("heatmap",_),{zoom:p}=e.transform;e.terrain&&e.terrain.setupElevationDraw(u,m),e.prepareDrawProgram(n,m,h.toUnwrapped()),m.draw(n,a.TRIANGLES,t.DepthMode.disabled,s,l,t.CullFaceMode.disabled,Si(h.projMatrix,u,p,o.paint.get("heatmap-intensity")),o.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,o.paint,e.transform.zoom,_);}n.viewport.set([0,0,e.width,e.height]);}else "translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,i){const o=e.context,r=o.gl,n=i.heatmapFbo;if(!n)return;o.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),o.activeTexture.set(r.TEXTURE1);let a=i.colorRampTexture;a||(a=i.colorRampTexture=new t.Texture(o,i.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(o,r.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((t,e,i,o)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,i),i.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,i.paint,e.transform.zoom);}(e,o));},line:function(e,i,o,r){if("translucent"!==e.renderPass)return;const n=o.paint.get("line-opacity"),a=o.paint.get("line-width");if(0===n.constantOr(1)||0===a.constantOr(1))return;const s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),c=o.paint.get("line-dasharray"),h=c.constantOr(1),u=o.layout.get("line-cap"),d=o.paint.get("line-pattern"),_=d.constantOr(1),m=o.paint.get("line-gradient"),p=o.getCrossfadeParameters(),f=_?"linePattern":"line",g=e.context,v=g.gl;for(const n of r){const r=i.getTile(n);if(_&&!r.patternsLoaded())continue;const a=r.getBucket(o);if(!a)continue;e.prepareDrawTile(n);const x=a.programConfigurations.get(o.id),y=Di(o),b=e.useProgram(f,x,y),w=d.constantOr(null);if(w&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[w.to.toString()],i=t.patternPositions[w.from.toString()];e&&i&&x.setConstantPatternPositions(e,i);}const T=c.constantOr(null),E=u.constantOr(null);if(!_&&T&&E&&r.lineAtlas){const t=r.lineAtlas,e=t.getDash(T.to,E),i=t.getDash(T.from,E);e&&i&&x.setConstantPatternPositions(e,i);}const C=e.terrain?n.projMatrix:null,S=_?Ii(e,r,o,p,C):Mi(e,r,o,p,C,a.lineClipsArray.length);if(m){const r=a.gradients[o.id];let s=r.texture;if(o.gradientVersion!==r.version){let l=256;if(o.stepInterpolant){const o=i.getSource().maxzoom,r=n.canonical.z===o?Math.ceil(1<<e.transform.maxZoom-n.canonical.z):1;l=t.clamp(t.nextPowerOfTwo(a.maxLineLength/t.EXTENT*1024*r),256,g.maxTextureSize);}r.gradient=t.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new t.Texture(g,r.gradient,v.RGBA),r.version=o.gradientVersion,s=r.texture;}g.activeTexture.set(v.TEXTURE1),s.bind(o.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE);}h&&(g.activeTexture.set(v.TEXTURE0),r.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),x.updatePaintBuffers(p)),_&&(g.activeTexture.set(v.TEXTURE0),r.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),x.updatePaintBuffers(p)),e.prepareDrawProgram(g,b,n.toUnwrapped()),b.draw(g,v.TRIANGLES,s,e.stencilModeForClipping(n),l,t.CullFaceMode.disabled,S,o.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,o.paint,e.transform.zoom,x,a.layoutVertexBuffer2);}},fill:function(e,i,o,r){const n=o.paint.get("fill-color"),a=o.paint.get("fill-opacity");if(0===a.constantOr(1))return;const s=e.colorModeForRenderPass(),l=o.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===n.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){const n=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);Hi(e,i,o,r,n,s,!1);}if("translucent"===e.renderPass&&o.paint.get("fill-antialias")){const n=e.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);Hi(e,i,o,r,n,s,!0);}},"fill-extrusion":function(e,i,o,r){const n=o.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===e.renderPass){const a=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==n||o.paint.get("fill-extrusion-pattern").constantOr(1))Ki(e,i,o,r,a,t.StencilMode.disabled,t.ColorMode.disabled),Ki(e,i,o,r,a,e.stencilModeFor3D(),e.colorModeForRenderPass());else {const n=e.colorModeForRenderPass();Ki(e,i,o,r,a,t.StencilMode.disabled,n);}}},hillshade:function(e,i,o,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const n=e.context,a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),s=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[c,h]="translucent"!==e.renderPass||l?[{},r]:e.stencilConfigForOverlap(r);for(const r of h){const n=i.getTile(r);if(n.needsHillshadePrepare&&"offscreen"===e.renderPass)ii(e,n,o,a,t.StencilMode.disabled,s);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(r):c[r.overscaledZ];ti(e,r,n,o,a,t,s);}}n.viewport.set([0,0,e.width,e.height]);},raster:function(e,i,o,r,n,a){if("translucent"!==e.renderPass)return;if(0===o.paint.get("raster-opacity"))return;if(!r.length)return;const s=e.context,l=s.gl,c=i.getSource(),h=e.useProgram("raster"),u=e.colorModeForRenderPass(),d=e.terrain&&e.terrain.renderingToTexture,[_,m]=c instanceof Et||d?[{},r]:e.stencilConfigForOverlap(r),p=m[m.length-1].overscaledZ,f=!e.options.moving;for(const r of m){const n=d?t.DepthMode.disabled:e.depthModeForSublayer(r.overscaledZ-p,1===o.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),m=r.toUnwrapped(),g=i.getTile(r);if(d&&(!g||!g.hasData()))continue;const v=d?r.projMatrix:e.transform.calculateProjMatrix(m,f),x=e.terrain&&d?e.terrain.stencilModeForRTTOverlap(r):_[r.overscaledZ],y=a?0:o.paint.get("raster-fade-duration");g.registerFadeDuration(y);const b=i.findLoadedParent(r,0),w=ci(g,b,i,e.transform,y);let T,E;e.terrain&&e.terrain.prepareDrawTile(r);const C="nearest"===o.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;s.activeTexture.set(l.TEXTURE0),g.texture.bind(C,l.CLAMP_TO_EDGE),s.activeTexture.set(l.TEXTURE1),b?(b.texture.bind(C,l.CLAMP_TO_EDGE),T=Math.pow(2,b.tileID.overscaledZ-g.tileID.overscaledZ),E=[g.tileID.canonical.x*T%1,g.tileID.canonical.y*T%1]):g.texture.bind(C,l.CLAMP_TO_EDGE);const S=Li(v,E||[0,0],T||1,w,o);if(e.prepareDrawProgram(s,h,m),c instanceof Et)h.draw(s,l.TRIANGLES,n,t.StencilMode.disabled,u,t.CullFaceMode.disabled,S,o.id,c.boundsBuffer,e.quadTriangleIndexBuffer,c.boundsSegments);else {const{tileBoundsBuffer:i,tileBoundsIndexBuffer:r,tileBoundsSegments:a}=e.getTileBoundsBuffers(g);h.draw(s,l.TRIANGLES,n,x,u,t.CullFaceMode.disabled,S,o.id,i,r,a);}}},background:function(e,i,o,r){const n=o.paint.get("background-color"),a=o.paint.get("background-opacity");if(0===a)return;const s=e.context,l=s.gl,c=e.transform,h=c.tileSize,u=o.paint.get("background-pattern");if(e.isPatternMissing(u))return;const d=!u&&1===n.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==d)return;const _=t.StencilMode.disabled,m=e.depthModeForSublayer(0,"opaque"===d?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),p=e.colorModeForRenderPass(),f=e.useProgram(u?"backgroundPattern":"background");let g,v=r;v||(g=e.getBackgroundTiles(),v=Object.values(g).map((t=>t.tileID))),u&&(s.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));const x=o.getCrossfadeParameters();for(const d of v){const v=d.toUnwrapped(),y=r?d.projMatrix:e.transform.calculateProjMatrix(v);e.prepareDrawTile(d);const b=i?i.getTile(d):g?g[d.key]:new t.Tile(d,h,c.zoom,e),w=u?Ui(y,a,e,u,{tileID:d,tileSize:h},x):Oi(y,a,n);e.prepareDrawProgram(s,f,v);const{tileBoundsBuffer:T,tileBoundsIndexBuffer:E,tileBoundsSegments:C}=e.getTileBoundsBuffers(b);f.draw(s,l.TRIANGLES,m,_,p,t.CullFaceMode.disabled,w,o.id,T,E,C);}},sky:function(e,i,o){const r=e.transform,n="mercator"===r.projection.name?1:t.smoothstep(7,8,r.zoom),a=o.paint.get("sky-opacity")*n;if(0===a)return;const s=e.context,l=o.paint.get("sky-type"),c=new t.DepthMode(s.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),h=e.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===e.renderPass?o.needsSkyboxCapture(e)&&(function(e,i,o,r){const n=e.context,a=n.gl;let s=i.skyboxFbo;if(!s){s=i.skyboxFbo=n.createFramebuffer(32,32,!1),i.skyboxGeometry=new ho(n),i.skyboxTexture=n.gl.createTexture(),a.bindTexture(a.TEXTURE_CUBE_MAP,i.skyboxTexture),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR);for(let t=0;t<6;++t)a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,a.RGBA,32,32,0,a.RGBA,a.UNSIGNED_BYTE,null);}n.bindFramebuffer.set(s.framebuffer),n.viewport.set([0,0,32,32]);const l=i.getCenter(e,!0),c=e.useProgram("skyboxCapture"),h=new Float64Array(16);t.identity(h),t.rotateY(h,h,.5*-Math.PI),uo(n,i,c,h,l,0),t.identity(h),t.rotateY(h,h,.5*Math.PI),uo(n,i,c,h,l,1),t.identity(h),t.rotateX(h,h,.5*-Math.PI),uo(n,i,c,h,l,2),t.identity(h),t.rotateX(h,h,.5*Math.PI),uo(n,i,c,h,l,3),t.identity(h),uo(n,i,c,h,l,4),t.identity(h),t.rotateY(h,h,Math.PI),uo(n,i,c,h,l,5),n.viewport.set([0,0,e.width,e.height]);}(e,o),o.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,i,o,r,n){const a=e.context,s=a.gl,l=e.transform,c=e.useProgram("skybox");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,i.skyboxTexture);const h=((t,e,i,o,r)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:o,u_temporal_offset:r}))(l.skyboxMatrix,i.getCenter(e,!1),0,r,n);e.prepareDrawProgram(a,c),c.draw(a,s.TRIANGLES,o,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,h,"skybox",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment);}(e,o,c,a,h):"gradient"===l&&"sky"===e.renderPass&&function(e,i,o,r,n){const a=e.context,s=a.gl,l=e.transform,c=e.useProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new ho(a)),a.activeTexture.set(s.TEXTURE0);let h=i.colorRampTexture;h||(h=i.colorRampTexture=new t.Texture(a,i.colorRamp,s.RGBA)),h.bind(s.LINEAR,s.CLAMP_TO_EDGE);const u=((e,i,o,r,n)=>({u_matrix:e,u_color_ramp:0,u_center_direction:i,u_radius:t.degToRad(o),u_opacity:r,u_temporal_offset:n}))(l.skyboxMatrix,i.getCenter(e,!1),i.paint.get("sky-gradient-radius"),r,n);e.prepareDrawProgram(a,c),c.draw(a,s.TRIANGLES,o,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,u,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment);}(e,o,c,a,h);},debug:function(t,e,i){for(let o=0;o<i.length;o++)ao(t,e,i[o]);},custom:function(e,i,o){const r=e.context,n=o.implementation;if("mercator"===e.transform.projection.name){if("offscreen"===e.renderPass){const t=n.prerender;t&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),t.call(n,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState());}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(t.StencilMode.disabled);const i="3d"===n.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);r.setDepthMode(i),n.render(r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null);}}else t.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");}};class mo{constructor(e,i){this.context=new bt(e),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Be,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={};}updateTerrain(t,e){const i=!!t&&!!t.terrain&&"mercator"===this.transform.projection.name;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new di(this,t));const o=this._terrain;this.transform.elevation=i?o:null,o.update(t,this.transform,e);}_updateFog(t){const e=t.fog;if(!e||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,o]=e.getFovAdjustedRange(this.transform._fov);if(i>o)return void(this.transform.fogCullDistSq=null);const r=i+.78*(o-i);this.transform.fogCullDistSq=r*r;}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,i){if(this.width=e*t.exported.devicePixelRatio,this.height=i*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize();}setup(){const e=this.context,i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(i,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(t.EXTENT,0),o.emplaceBack(0,t.EXTENT),o.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const r=new t.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(r,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const n=new t.StructArrayLayout4i8;n.emplaceBack(0,0,0,0),n.emplaceBack(t.EXTENT,0,t.EXTENT,0),n.emplaceBack(0,t.EXTENT,0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.mercatorBoundsBuffer=e.createVertexBuffer(n,t.boundsAttributes.members),this.mercatorBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const a=new t.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(a);const s=new t.StructArrayLayout1ui2;for(const t of [0,1,3,2,0])s.emplaceBack(t);this.debugIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA),this.identityMat=t.create$1();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now());}getMercatorTileBoundsBuffers(){return {tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(e,i.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,li(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments);}_renderTileClippingMasks(e,i,o){if(!(i&&this.currentStencilSource!==i.id&&e.isTileClipped()&&o&&o.length))return;this.currentStencilSource=i.id;const r=this.context,n=r.gl;this.nextStencilID+o.length>256&&this.clearStencil(),r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of o){const o=i.getTile(e),s=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:c,tileBoundsSegments:h}=this.getTileBoundsBuffers(o);a.draw(r,n.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:n.ALWAYS,mask:0},s,255,n.KEEP,n.KEEP,n.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,li(e.projMatrix),"$clipping",l,c,h);}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new t.StencilMode({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const i=this.context.gl;return new t.StencilMode({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(e){const i=this.context.gl,o=e.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=o[o.length-1].overscaledZ,n=o[0].overscaledZ-r+1;if(n>1){this.currentStencilSource=void 0,this.nextStencilID+n>256&&this.clearStencil();const e={};for(let o=0;o<n;o++)e[o+r]=new t.StencilMode({func:i.GEQUAL,mask:255},o+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=n,[e,o]}return [{[r]:t.StencilMode.disabled},o]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(i,i,i,0),[!0,!0,!0,!0])}return "opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,i,o){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(o||this.context.gl.LEQUAL,i,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const o=this.style.order,r=this.style._sourceCaches;for(const t in r){const e=r[t];e.used&&e.prepare(this.context);}const n={},a={},s={};for(const t in r){const e=r[t];n[t]=e.getVisibleCoordinates(),a[t]=n[t].slice().reverse(),s[t]=e.getVisibleCoordinates(!0).reverse();}this.opaquePassCutoff=1/0;for(let t=0;t<o.length;t++)if(this.style._layers[o[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(s),this.opaquePassCutoff=0),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of o){const i=this.style._layers[t],o=e._getLayerSourceCache(i);if(!i.hasOffscreenPass()||i.isHidden(this.transform.zoom))continue;const r=o?a[o.id]:void 0;("custom"===i.type||i.isSky()||r&&r.length)&&this.renderLayer(this,o,i,r);}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let l=t.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(l=this.style.fog.properties.get("color")),this.context.clear({color:i.showOverdrawInspector?t.Color.black:l,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[o[this.currentLayer]],i=e._getLayerSourceCache(t);if(t.isSky())continue;const r=i?a[i.id]:void 0;this._renderTileClippingMasks(t,i,r),this.renderLayer(this,i,t,r);}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const t=this.style._layers[o[this.currentLayer]],i=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,i,t,i?a[i.id]:void 0);}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;){const t=this.style._layers[o[this.currentLayer]],i=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=i?("symbol"===t.type?s:a)[i.id]:void 0;this._renderTileClippingMasks(t,i,i?n[i.id]:void 0),this.renderLayer(this,i,t,r),++this.currentLayer;}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let i=null;t.values(this.style._layers).forEach((t=>{const o=e._getLayerSourceCache(t);o&&!t.isHidden(this.transform.zoom)&&(!i||i.getSource().maxzoom<o.getSource().maxzoom)&&(i=o);})),i&&this.options.showTileBoundaries&&_o.debug(this,i,i.getVisibleCoordinates());}this.options.showPadding&&function(t){const e=t.transform.padding;oo(t,t.transform.height-(e.top||0),3,Ji),oo(t,e.bottom||0,3,Qi),ro(t,e.left||0,3,to),ro(t,t.transform.width-(e.right||0),3,eo);const i=t.transform.centerPoint;!function(t,e,i,o){no(t,e-1,i-10,2,20,o),no(t,e-10,i-1,20,2,o);}(t,i.x,t.transform.height-i.y,io);}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%t.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy());}renderLayer(t,e,i,o){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||o&&o.length)&&(this.id=i.id,this.gpuTimingStart(i),_o[i.type](t,e,i,o,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd());}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let i=this.gpuTimers[t.id];i||(i=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),i.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,i.query);}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT);}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const i in t){const o=t[i],r=this.context.extTimerQuery,n=r.getQueryObjectEXT(o.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(o.query),e[i]=n;}return e}translatePosMatrix(e,i,o,r,n){if(!o[0]&&!o[1])return e;const a=n?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);o=[o[0]*e-o[1]*t,o[0]*t+o[1]*e];}const s=[n?o[0]:A(i,o[0],this.transform.zoom),n?o[1]:A(i,o[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,s),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t];}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return !1;if(!t.from||!t.to)return !0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return !e||!i}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.style&&this.style.fog,i=[];return this.terrain&&!this.terrain.renderingToTexture&&i.push("TERRAIN"),e&&!t&&0!==e.getOpacity(this.transform.pitch)&&i.push("FOG"),t&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}useProgram(t,e,i){this.cache=this.cache||{};const o=i||[],r=this.currentGlobalDefines().concat(o),n=mi.cacheKey(t,r,e);return this.cache[n]||(this.cache[n]=new mi(this.context,t,Ke[t],e,Ni[t],r)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault();}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD);}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA));}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy();}prepareDrawTile(t){this.terrain&&this.terrain.prepareDrawTile(t);}prepareDrawProgram(t,e,i){if(this.terrain&&this.terrain.renderingToTexture)return;const o=this.style.fog;if(o){const r=o.getOpacity(this.transform.pitch);0!==r&&e.setFogUniformValues(t,((t,e,i,o)=>{const r=e.properties.get("color"),n=t.frameCounter/1e3%1,a=[r.r/r.a,r.g/r.a,r.b/r.a,o];return {u_fog_matrix:i?t.transform.calculateFogTileMatrix(i):t.identityMat,u_fog_range:e.getFovAdjustedRange(t.transform._fov),u_fog_color:a,u_fog_horizon_blend:e.properties.get("horizon-blend"),u_fog_temporal_offset:n}})(this,o,i,r));}}setTileLoadedFlag(t){this.tileLoaded=t;}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1;}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return {canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return !1;const t=this.style&&this.style.fog;return !!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,i=this._backgroundTiles={},o=this.transform.coveringTiles({tileSize:512});for(const r of o)i[r.key]=e[r.key]||new t.Tile(r,512,this.transform.tileZoom,this);return i}clearBackgroundTiles(){this._backgroundTiles={};}}class po{constructor(t=0,e=0,i=0,o=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(o)||o<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=o;}interpolate(e,i,o){return null!=i.top&&null!=e.top&&(this.top=t.number(e.top,i.top,o)),null!=i.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,i.bottom,o)),null!=i.left&&null!=e.left&&(this.left=t.number(e.left,i.left,o)),null!=i.right&&null!=e.right&&(this.right=t.number(e.right,i.right,o)),this}getCenter(e,i){const o=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+i-this.bottom)/2,0,i);return new t.pointGeometry(o,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new po(this.top,this.bottom,this.left,this.right)}toJSON(){return {top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function fo(t,e){return [t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function go(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3];}function vo(e,i){const o=fo(e,3);t.fromQuat(e,i),go(e,3,o);}function xo(t,e){go(t,3,[e[0],e[1],e[2],1]);}function yo(e,i){const o=t.identity$1([]);return t.rotateZ$1(o,o,-i),t.rotateX$1(o,o,-e),o}function bo(e,i){const o=[e[0],e[1],0],r=[i[0],i[1],0];if(t.length(o)>=1e-15){const e=t.normalize([],o);t.scale(r,e,t.dot(r,e)),i[0]=r[0],i[1]=r[1];}const n=t.cross([],i,e);if(t.len(n)<1e-15)return null;const a=Math.atan2(-n[1],n[0]);return yo(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),a)}class wo{constructor(t,e){this.position=t,this.orientation=e;}get position(){return this._position}set position(e){this._position=this._renderWorldCopies?function(e){if(!e)return;const i=Array.isArray(e)?new t.MercatorCoordinate(e[0],e[1],e[2]):e;return i.x=t.wrap(i.x,0,1),i}(e):e;}lookAtPoint(e,i){if(this.orientation=null,!this.position)return;const o=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,r=this.position,n=t.MercatorCoordinate.fromLngLat(e,o),a=[n.x-r.x,n.y-r.y,n.z-r.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=bo(a,i);}setPitchBearing(e,i){this.orientation=yo(t.degToRad(e),t.degToRad(-i));}}class To{constructor(e,i){this._transform=t.identity([]),this._orientation=t.identity$1([]),i&&(this._orientation=i,vo(this._transform,this._orientation)),e&&xo(this._transform,e);}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const t=fo(this._transform,3);return [t[0],t[1],t[2]]}set position(t){xo(this._transform,t);}get orientation(){return this._orientation}set orientation(t){this._orientation=t,vo(this._transform,this._orientation);}getPitchBearing(){const t=this.forward(),e=this.right();return {bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=yo(t,e),vo(this._transform,this._orientation);}forward(){const t=fo(this._transform,2);return [-t[0],-t[1],-t[2]]}up(){const t=fo(this._transform,1);return [-t[0],-t[1],-t[2]]}right(){const t=fo(this._transform,0);return [t[0],t[1],t[2]]}getCameraToWorld(e,i){const o=new Float64Array(16);return t.invert(o,this.getWorldToCamera(e,i)),o}getWorldToCameraPosition(e,i,o){const r=this.position;t.scale(r,r,-e);const n=new Float64Array(16);return t.fromScaling(n,[o,o,o]),t.translate(n,n,r),n[10]*=i,n}getWorldToCamera(e,i){const o=new Float64Array(16),r=new Float64Array(4),n=this.position;return t.conjugate(r,this._orientation),t.scale(n,n,-e),t.fromQuat(o,r),t.translate(o,o,n),o[1]*=-1,o[5]*=-1,o[9]*=-1,o[13]*=-1,o[8]*=i,o[9]*=i,o[10]*=i,o[11]*=i,o}getCameraToClipPerspective(e,i,o,r){const n=new Float64Array(16);return t.perspective(n,e,i,o,r),n}getDistanceToElevation(e){const i=0===e?0:t.mercatorZfromAltitude(e,this.position[1]),o=this.forward();return (i-this.position[2])/o[2]}clone(){return new To([...this.position],[...this.orientation])}}function Eo(e,i){const o=So(e),r=function(e,i,o,r,n){const a=new t.LngLat(o.lng-180*Mo,o.lat),s=new t.LngLat(o.lng+180*Mo,o.lat),l=e.project(a.lng,a.lat),c=e.project(s.lng,s.lat),h=-Math.atan2(c.y-l.y,c.x-l.x),u=t.MercatorCoordinate.fromLngLat(o);u.y=t.clamp(u.y,-.999975,.999975);const d=u.toLngLat(),_=e.project(d.lng,d.lat),m=t.MercatorCoordinate.fromLngLat(d);m.x+=Mo;const p=m.toLngLat(),f=e.project(p.lng,p.lat),g=zo(f.x-_.x,f.y-_.y,h),v=t.MercatorCoordinate.fromLngLat(d);v.y+=Mo;const x=v.toLngLat(),y=e.project(x.lng,x.lat),b=zo(y.x-_.x,y.y-_.y,h),w=Math.abs(g.x)/Math.abs(b.y),T=t.identity([]);t.rotateZ(T,T,-h*(1-(n?0:r)));const E=t.identity([]);return t.scale$1(E,E,[1,1-(1-w)*r,1]),E[4]=-b.x/b.y*r,t.rotateZ(E,E,h),t.multiply(E,T,E),E}(e.projection,0,e.center,o,i),n=Co(e);return t.scale$1(r,r,[n,n,1]),r}function Co(e){const i=e.projection,o=So(e),r=Io(i,e.center),n=Io(i,t.LngLat.convert(i.center));return Math.pow(2,r*o+(1-o)*n)}function So(e){const i=e.projection.range;if(!i)return 0;const o=Math.max(e.width,e.height),r=Math.log(o/1024)/Math.LN2;return t.smoothstep(i[0]+r,i[1]+r,e.zoom)}const Mo=1/4e4;function Io(e,i){const o=t.clamp(i.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),r=new t.LngLat(i.lng-180*Mo,o),n=new t.LngLat(i.lng+180*Mo,o),a=e.project(r.lng,o),s=e.project(n.lng,o),l=t.MercatorCoordinate.fromLngLat(r),c=t.MercatorCoordinate.fromLngLat(n),h=s.x-a.x,u=s.y-a.y,d=c.x-l.x,_=c.y-l.y,m=Math.sqrt((d*d+_*_)/(h*h+u*u));return Math.log(m)/Math.LN2}function zo(t,e,i){const o=Math.cos(i),r=Math.sin(i);return {x:t*o-e*r,y:t*r+e*o}}class Ao{constructor(e,i,o,r,n){this.tileSize=512,this._renderWorldCopies=void 0===n||n,this._minZoom=e||0,this._maxZoom=i||22,this._minPitch=null==o?0:o,this._maxPitch=null==r?60:r,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new po,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new To,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1;}clone(){const t=new Ao(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t.tileSize=this.tileSize,t.setMaxBounds(this.getMaxBounds()),t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._cameraZoom=this._cameraZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.setProjection(this.getProjection()),t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,t?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices());}updateElevation(t){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),t&&this._constrainCameraAltitude(),this._calcMatrices();}getProjection(){return t.pick(this.projection,["name","center","parallels"])}setProjection(e){null==e&&(e={name:"mercator"}),this.projectionOptions=e;const i=this.projection?this.getProjection():void 0;return this.projection=t.getProjection(e),!r(i,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t));}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t));}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t));}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t));}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.wrap}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t;}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return t.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t;}get rotation(){return -this.angle/Math.PI*180}set rotation(e){const i=-e*Math.PI/180;var o;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=(o=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o),function(t,e,i){var o=e[0],r=e[1],n=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);t[0]=o*l+n*s,t[1]=r*l+a*s,t[2]=o*-s+n*l,t[3]=r*-s+a*l;}(this.rotationMatrix,this.rotationMatrix,this.angle));}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const i=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices());}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices());}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices();}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices());}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom;}_updateCenterElevation(){if(!this._elevation)return !1;const t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return -1===t?(this._cameraZoom=null,!1):(this._centerAltitude=t,!0)}_updateCameraOnTerrain(){const e=this.cameraToCenterDistance/this.worldSize,i=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(i+e);}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],o=this.horizonLineFromTop();let r=0,n=0;for(let a=0;a<i.length;a++){const s=new t.pointGeometry(i[a][0]*this.width,o+i[a][1]*(this.height-o)),l=e.pointCoordinate(s);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*c,n+=c;}return 0===n?NaN:r/n}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices());}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const e=this._cameraZoom,i=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),o=t.mercatorZfromAltitude(i,this.center.lat),r=this._mercatorZfromZoom(e),n=this._mercatorZfromZoom(this._maxZoom),a=Math.max(r-o,n);this._setZoom(this._zoomFromMercatorZ(a));}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices());}computeZoomRelativeTo(e){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let o;o=e.z<this._camera.position[2]?[i.x,i.y,i.z]:[e.x,e.y,e.z];const r=t.length(t.sub([],this._camera.position,o));return t.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let i=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(e.orientation)),e.position){const o=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(o,this._camera.position)||(this._setCameraPosition(o),i=!0);}i&&(this._updateStateFromCamera(),this.recenterOnTerrain());}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,i=new wo;return i.position=new t.MercatorCoordinate(e[0],e[1],e[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(e){if(!t.length$1(e))return !1;t.normalize$1(e,e);const i=t.transformQuat([],[0,0,-1],e),o=t.transformQuat([],[0,-1,0],e);if(o[2]<0)return !1;const r=bo(i,o);return !!r&&(this._camera.orientation=r,!0)}_setCameraPosition(e){const i=this.zoomScale(this.minZoom)*this.tileSize,o=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;e[2]=t.clamp(e[2],r/o,r/i),this._camera.position=e;}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices();}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const i=[new t.UnwrappedTileID(0,e)];if(this.renderWorldCopies){const o=this.pointCoordinate(new t.pointGeometry(0,0)),r=this.pointCoordinate(new t.pointGeometry(this.width,0)),n=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),a=this.pointCoordinate(new t.pointGeometry(0,this.height)),s=Math.floor(Math.min(o.x,r.x,n.x,a.x)),l=Math.floor(Math.max(o.x,r.x,n.x,a.x)),c=1;for(let o=s-c;o<=l+c;o++)0!==o&&i.push(new t.UnwrappedTileID(o,e));}return i}coveringTiles(e){let i=this.coveringZoomLevel(e);const o=i,r=this.elevation&&!e.isTerrainDEM,n="mercator"===this.projection.name;if(void 0!==e.minzoom&&i<e.minzoom)return [];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);const a=this.locationCoordinate(this.center),s=1<<i,l=[s*a.x,s*a.y,0],c=m.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),h=this.pointCoordinate(this.getCameraPoint()),u=s*t.mercatorZfromAltitude(1,this.center.lat),d=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),_=[s*h.x,s*h.y,d],f=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),g=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&n?i:0,v=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,x=e.isTerrainDEM?-v:this._elevation?this._elevation.getMinElevationBelowMSL():0,y=Co(this),b=e=>{const i=1/4e4,o=new t.MercatorCoordinate(e.x+i,e.y,e.z),r=new t.MercatorCoordinate(e.x,e.y+i,e.z),n=e.toLngLat(),a=o.toLngLat(),s=r.toLngLat(),l=this.locationCoordinate(n),c=this.locationCoordinate(a),h=this.locationCoordinate(s),u=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(h.x-l.x,h.y-l.y);return Math.sqrt(u*d)*y/i},w=(e,i,o,r,n,a)=>{const l=t.tileTransform({z:e,x:i,y:o},this.projection);return new p([(r+l.x/l.scale)*s,s*(l.y/l.scale),n],[(r+l.x2/l.scale)*s,s*(l.y2/l.scale),a])},T=t=>({aabb:w(0,0,0,t,x,v),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),E=[];let C=[];const S=i,M=e.reparseOverscaled?o:i,I=t=>{if(!this._elevation||!t.tileID)return;const e=this._elevation.getMinMaxForTile(t.tileID),i=t.aabb;e?(i.min[2]=e.min,i.max[2]=e.max,i.center[2]=(i.min[2]+i.max[2])/2):(t.shouldSplit=D(t),t.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=this._centerAltitude));},z=t=>t*t,A=z((d-this._centerAltitude)*u),D=e=>{if(e.zoom<g)return !0;if(e.zoom===S)return !1;if(null!=e.shouldSplit)return e.shouldSplit;const i=e.aabb.distanceX(_),a=e.aabb.distanceY(_);let s=A;r&&(s=z(e.aabb.distanceZ(_)*u));let l=1;if(!n&&o<=5){const i=Math.pow(2,e.zoom),o=b(new t.MercatorCoordinate((e.x+.5)/i,(e.y+.5)/i));l=o>.85?1:o;}const c=i*i+a*a+s;return c<z((1<<S-e.zoom)*f*l*((t,e)=>{if(e*z(.707)<t)return 1;const i=Math.sqrt(e/t);return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(s,A),c))};if(this.renderWorldCopies)for(let t=1;t<=3;t++)E.push(T(-t)),E.push(T(t));for(E.push(T(0));E.length>0;){const o=E.pop(),n=o.x,a=o.y;let s=o.fullyVisible;if(!s){const t=o.aabb.intersects(c);if(0===t)continue;s=2===t;}if(o.zoom!==S&&D(o))for(let e=0;e<4;e++){const i=(n<<1)+e%2,l=(a<<1)+(e>>1),c={aabb:"mercator"===this.projection.name?o.aabb.quadrant(e):w(o.zoom+1,i,l,o.wrap,0,0),zoom:o.zoom+1,x:i,y:l,wrap:o.wrap,fullyVisible:s,tileID:void 0,shouldSplit:void 0};r&&(c.tileID=new t.OverscaledTileID(o.zoom+1===S?M:o.zoom+1,o.wrap,o.zoom+1,i,l),I(c)),E.push(c);}else {const r=o.zoom===S?M:o.zoom;if(e.minzoom&&e.minzoom>r)continue;const s=l[0]-(.5+n+(o.wrap<<o.zoom))*(1<<i-o.zoom),c=l[1]-.5-a,h=o.tileID?o.tileID:new t.OverscaledTileID(r,o.wrap,o.zoom,n,a);C.push({tileID:h,distanceSq:s*s+c*c});}}if(this.fogCullDistSq){const i=this.fogCullDistSq,o=this.horizonLineFromTop();C=C.filter((r=>{const n=[0,0,0,1],a=[t.EXTENT,t.EXTENT,0,1],s=this.calculateFogTileMatrix(r.tileID.toUnwrapped());t.transformMat4(n,n,s),t.transformMat4(a,a,s);const l=t.getAABBPointSquareDist(n,a);if(0===l)return !0;let c=!1;const h=this._elevation;if(h&&l>i&&0!==o){const i=this.calculateProjMatrix(r.tileID.toUnwrapped());let n;e.isTerrainDEM||(n=h.getMinMaxForTile(r.tileID)),n||(n={min:x,max:v});const a=t.furthestTileCorner(this.rotation),s=[a[0]*t.EXTENT,a[1]*t.EXTENT,n.max];t.transformMat4$1(s,s,i),c=(1-s[1])*this.height*.5<o;}return l<i||c}));}return C.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices();}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const i=t.clamp(e.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),o=this.projection.project(e.lng,i);return new t.pointGeometry(o.x*this.worldSize,o.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(e,i){const o=this.pointCoordinate(i),r=this.pointCoordinate(this.centerPoint),n=this.locationCoordinate(e);this.setLocation(new t.MercatorCoordinate(n.x-(o.x-r.x),n.y-(o.y-r.y)));}setLocation(t){this.center=this.coordinateLocation(t),this.renderWorldCopies&&(this.center=this.center.wrap());}locationPoint(t){return this._coordinatePoint(this.locationCoordinate(t),!1)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e,i){const o=i?t.mercatorZfromAltitude(i,e.lat):void 0,r=this.projection.project(e.lng,e.lat);return new t.MercatorCoordinate(r.x,r.y,o)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(e,i){const o=null!=i?i:this._centerAltitude,r=[e.x,e.y,0,1],n=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(n,n,this.pixelMatrixInverse);const a=n[3];t.scale$2(r,r,1/r[3]),t.scale$2(n,n,1/a);const s=r[2],l=n[2];return {p0:r,p1:n,t:s===l?0:(o-s)/(l-s)}}screenPointToMercatorRay(e){const i=[e.x,e.y,0,1],o=[e.x,e.y,1,1];return t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(o,o,this.pixelMatrixInverse),t.scale$2(i,i,1/i[3]),t.scale$2(o,o,1/o[3]),i[2]=t.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,o[2]=t.mercatorZfromAltitude(o[2],this._center.lat)*this.worldSize,t.scale$2(i,i,1/this.worldSize),t.scale$2(o,o,1/this.worldSize),new _([i[0],i[1],i[2]],t.normalize([],t.sub([],o,i)))}rayIntersectionCoordinate(e){const{p0:i,p1:o,t:r}=e,n=t.mercatorZfromAltitude(i[2],this._center.lat),a=t.mercatorZfromAltitude(o[2],this._center.lat);return new t.MercatorCoordinate(t.number(i[0],o[0],r)/this.worldSize,t.number(i[1],o[1],r)/this.worldSize,t.number(n,a,r))}pointCoordinate(e,i=this._centerAltitude){const o=this.horizonLineFromTop(!1),r=new t.pointGeometry(e.x,Math.max(o,e.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(r,i))}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);const i=this.elevation;let o=this.elevation.pointCoordinate(e);if(o)return new t.MercatorCoordinate(o[0],o[1],o[2]);let r=0,n=this.horizonLineFromTop();if(e.y>n)return this.pointCoordinate(e);const a=.02*n,s=e.clone();for(let e=0;e<10&&n-r>a;e++){s.y=t.number(r,n,.66);const e=i.pointCoordinate(s);e?(n=s.y,o=e):r=s.y;}return o?new t.MercatorCoordinate(o[0],o[1],o[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){if(this.elevation)return !this.elevation.pointCoordinate(t);{const e=this.horizonLineFromTop();return t.y<e}}_coordinatePoint(e,i){const o=i&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,r=[e.x*this.worldSize,e.y*this.worldSize,o+e.toAltitude(),1];return t.transformMat4(r,r,this.pixelMatrix),r[3]>0?new t.pointGeometry(r[0]/r[3],r[1]/r[3]):new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(e,i){const o=new t.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),r=new t.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),n=new t.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),a=new t.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let s=this.pointCoordinate(o,e),l=this.pointCoordinate(r,e);const c=this.pointCoordinate(n,i),h=this.pointCoordinate(a,i),u=(t,e)=>(e.y-t.y)/(e.x-t.x);return s.y>1&&l.y>=0?s=new t.MercatorCoordinate((1-h.y)/u(h,s)+h.x,1):s.y<0&&l.y<=1&&(s=new t.MercatorCoordinate(-h.y/u(h,s)+h.x,0)),l.y>1&&s.y>=0?l=new t.MercatorCoordinate((1-c.y)/u(c,l)+c.x,1):l.y<0&&s.y<=1&&(l=new t.MercatorCoordinate(-c.y/u(c,l)+c.x,0)),(new t.LngLatBounds).extend(this.coordinateLocation(s)).extend(this.coordinateLocation(l)).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(c))}_getBounds3D(){const t=this.elevation,e=t.visibleDemTiles.reduce(((t,e)=>{if(e.dem){const i=e.dem.tree;t.min=Math.min(t.min,i.minimums[0]),t.max=Math.max(t.max,i.maximums[0]);}return t}),{min:Number.MAX_VALUE,max:0});return this._getBounds(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-t.MAX_MERCATOR_LATITUDE,this.maxLat=t.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=t.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=t.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=t.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain();}calculatePosMatrix(e,i){let o,r,n;const a=e.canonical,s=t.identity(new Float64Array(16));if("mercator"===this.projection.name)o=i/this.zoomScale(a.z),r=(a.x+Math.pow(2,a.z)*e.wrap)*o,n=a.y*o;else {const i=t.tileTransform(a,this.projection);o=1,r=i.x+e.wrap*i.scale,n=i.y,t.scale$1(s,s,[o/i.scale,o/i.scale,this.pixelsPerMeter/this.worldSize]);}return t.translate(s,s,[r,n,0]),t.scale$1(s,s,[o/t.EXTENT,o/t.EXTENT,1]),s}calculateDistanceTileData(e){const i=e.key,o=this._distanceTileDataCache;if(o[i])return o[i];const r=e.canonical,n=1/this.height,a=this.cameraWorldSize/this.zoomScale(r.z),s=(r.x+Math.pow(2,r.z)*e.wrap)*a,l=r.y*a,c=this.point,h=this.angle,u=Math.sin(-h),d=-Math.cos(-h);return o[i]={bearing:[u,d],center:[(c.x-s)*n,(c.y-l)*n],scale:a/t.EXTENT*n},o[i]}calculateFogTileMatrix(e){const i=e.key,o=this._fogTileMatrixCache;if(o[i])return o[i];const r=this.calculatePosMatrix(e,this.cameraWorldSize);return t.multiply(r,this.worldToFogMatrix,r),o[i]=new Float32Array(r),o[i]}calculateProjMatrix(e,i=!1){const o=e.key,r=i?this._alignedProjMatrixCache:this._projMatrixCache;if(r[o])return r[o];const n=this.calculatePosMatrix(e,this.worldSize);return t.multiply(n,"mercator"===this.projection.name?i?this.alignedProjMatrix:this.projMatrix:this.mercatorMatrix,n),r[o]=new Float32Array(n),r[o]}calculatePixelsToTileUnitsMatrix(e){const i=e.tileID.key,o=this._pixelsToTileUnitsCache;if(o[i])return o[i];const r=function(e,i){const{scale:o}=e.tileTransform,r=o*t.EXTENT/(e.tileSize*Math.pow(2,i.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return n=new Float32Array(4),l=(a=i.inverseAdjustmentMatrix)[1],c=a[2],h=a[3],d=(s=[r,r])[1],n[0]=a[0]*(u=s[0]),n[1]=l*u,n[2]=c*d,n[3]=h*d,n;var n,a,s,l,c,h,u,d;}(e,this);return o[i]=r,o[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const i=this._camera.position,o=this._camera.forward();if(i[2]<=0||o[2]>=0)return;const r=t.mercatorZfromAltitude(1,this._center.lat);i[2]/=r,o[2]/=r,t.normalize(o,o);const n=e.raycast(i,o,e.exaggeration());if(n){const e=t.scaleAndAdd([],i,o,n),r=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),a=this._camera.position,s=r.z+t.length([r.x-a[0],r.y-a[1],r.z-a[2]]);this._cameraZoom=this._zoomFromMercatorZ(s),this._centerAltitude=r.toAltitude(),this._center=this.coordinateLocation(r),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices();}}_constrainCameraAltitude(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const i=e.getAtPointOrZero(this._camera.mercatorPosition),o=this._minimumHeightOverTerrain()*Math.cos(t.degToRad(this._maxPitch)),r=t.mercatorZfromAltitude(i,this._center.lat),n=this._camera.position[2]-r;if(n<o){const e=this.locationCoordinate(this._center,this._centerAltitude),i=this._camera.mercatorPosition,r=[e.x-i.x,e.y-i.y,e.z-i.z],a=t.length(r);r[2]-=o-n;const s=t.length(r);if(0===s)return;t.scale(r,r,a/s),this._camera.position=[e.x-r[0],e.y-r[1],e.z-r[2]],this._camera.orientation=bo(r,this._camera.up()),this._updateStateFromCamera();}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,"mercator"!==this.projection.name){const e=this.center;return e.lat=t.clamp(e.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(e.lng=t.clamp(e.lng,this.minLng,this.maxLng)),this.center=e,void(this._constraining=!1)}const e=this._unmodified,{x:i,y:o}=this.point;let r=0,n=i,a=o;const s=this.width/2,l=this.height/2,c=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(o-l<c&&(a=c+l),o+l>h&&(a=h-l),h-c<this.height&&(r=Math.max(r,this.height/(h-c)),a=(h+c)/2),this.maxBounds||!this.renderWorldCopies){const t=this.worldMinX*this.scale,e=this.worldMaxX*this.scale,o=this.worldSize/2-(t+e)/2;n=(i+o+this.worldSize)%this.worldSize-o,n-s<t&&(n=t+s),n+s>e&&(n=e-s),e-t<this.width&&(r=Math.max(r,this.width/(e-t)),n=(e+t)/2);}n===i&&a===o||(this.center=this.unproject(new t.pointGeometry(n,a))),r&&(this.zoom+=this.scaleZoom(r)),this._constrainCameraAltitude(),this._unmodified=e,this._constraining=!1;}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const i=this.pixelsPerMeter;this._updateCameraState();const o=Math.PI/2+this._pitch,r=this.fovAboveCenter,n=this.elevation?this.elevation.getMinElevationBelowMSL()*i:0,a=(this._camera.position[2]*this.worldSize-n)/Math.cos(this._pitch),s=Math.sin(r)*a/Math.sin(t.clamp(Math.PI-o-r,.01,Math.PI-.01)),l=this.point,c=l.x,h=l.y,u=Math.cos(Math.PI/2-this._pitch)*s+a,_=Math.min(1.01*u,a*(1/this._horizonShift)),m=this.height/50,p=this._camera.getWorldToCamera(this.worldSize,i),f=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,m,_);f[8]=2*-e.x/this.width,f[9]=2*e.y/this.height;let g=t.mul$1([],f,p);if("mercator"!==this.projection.name){const e=this.locationCoordinate(this.center),i=t.identity([]);t.translate(i,i,[e.x*this.worldSize,e.y*this.worldSize,0]),t.multiply(i,i,Eo(this)),t.translate(i,i,[-e.x*this.worldSize,-e.y*this.worldSize,0]),t.multiply(g,g,i),this.inverseAdjustmentMatrix=function(t){const e=Eo(t,!0);return d([],[e[0],e[1],e[4],e[5]])}(this);}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=t.scale$1([],g,[this.worldSize,this.worldSize,this.worldSize/i]),this.projMatrix=g,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const v=new Float32Array(16);t.identity(v),t.scale$1(v,v,[1,-1,1]),t.rotateX(v,v,this._pitch),t.rotateZ(v,v,this.angle);const x=t.perspective(new Float32Array(16),this._fov,this.width/this.height,m,_),y=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;x[8]=2*-e.x/this.width,x[9]=2*(e.y+y)/this.height,this.skyboxMatrix=t.multiply(v,x,v);const b=this.width%2/2,w=this.height%2/2,T=Math.cos(this.angle),E=Math.sin(this.angle),C=c-Math.round(c)+T*b+E*w,S=h-Math.round(h)+T*w+E*b,M=new Float64Array(g);if(t.translate(M,M,[C>.5?C-1:C,S>.5?S-1:S,0]),this.alignedProjMatrix=M,g=t.create$1(),t.scale$1(g,g,[this.width/2,-this.height/2,1]),t.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=t.create$1(),t.scale$1(g,g,[1,-1,1]),t.translate(g,g,[-1,-1,0]),t.scale$1(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},g=t.invert(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={};}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSize,i=this.cameraPixelsPerMeter,o=this._camera.position,r=1/this.height,n=[e,e,i];t.scale(n,n,r),t.scale(o,o,-1),t.multiply$1(o,o,n);const a=t.create$1();t.translate(a,a,o),t.scale$1(a,a,n),this.mercatorFogMatrix=a,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,i,r);}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const e=this._camera.forward(),i=this.cameraToCenterDistance,o=this.point,r=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),n=this.cameraToCenterDistance/r;this._camera.position=[o.x/this.worldSize-e[0]*i/n,o.y/this.worldSize-e[1]*i/n,t.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-e[2]*i/n];}_translateCameraConstrained(e){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),o=e[2];let r=1;o>0&&(r=Math.min((i-this._camera.position[2])/o,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,r),this._updateStateFromCamera();}_updateStateFromCamera(){const e=this._camera.position,i=this._camera.forward(),{pitch:o,bearing:r}=this._camera.getPitchBearing(),n=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),a=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),s=Math.max((e[2]-n)/Math.cos(o),a),l=this._zoomFromMercatorZ(s);t.scaleAndAdd(e,e,i,s),this._pitch=t.clamp(o,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(r,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new t.MercatorCoordinate(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices();}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return !(!this._elevation||"mercator"!==this.projection.name&&(t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(e,i){const o=Math.min(e.x,i.x),r=Math.max(e.x,i.x),n=Math.min(e.y,i.y),a=Math.max(e.y,i.y);if(n<this.horizonLineFromTop(!1))return !0;if("mercator"!==this.projection.name)return !1;const s=[new t.pointGeometry(o,n),new t.pointGeometry(r,a),new t.pointGeometry(o,a),new t.pointGeometry(r,n)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const t of s){const e=this.pointRayIntersection(t);if(e.t<0)return !0;const i=this.rayIntersectionCoordinate(e);if(i.x<l||i.y<0||i.x>c||i.y>1)return !0}return !1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.pointGeometry(0,0),new t.pointGeometry(this.width,this.height))}zoomDeltaToMovement(e,i){const o=t.length(t.sub([],this._camera.position,e)),r=this._zoomFromMercatorZ(o)+i;return o-this._mercatorZfromZoom(r)}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}}function Do(t,e){let i=!1,o=null;const r=()=>{o=null,i&&(t(),o=setTimeout(r,e),i=!1);};return ()=>(i=!0,o||r(),o)}class Po{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Do(this._updateHashUnthrottled.bind(this),300);}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const i=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,r=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,r),a=Math.round(i.lng*n)/n,s=Math.round(i.lat*n)/n,l=this._map.getBearing(),c=this._map.getPitch();let h="";if(h+=e?`/${a}/${s}/${o}`:`${o}/${s}/${a}`,(l||c)&&(h+="/"+Math.round(10*l)/10),c&&(h+=`/${Math.round(c)}`),this._hashName){const e=this._hashName;let i=!1;const o=t.window.location.hash.slice(1).split("&").map((t=>{const o=t.split("=")[0];return o===e?(i=!0,`${o}=${h}`):t})).filter((t=>t));return i||o.push(`${e}=${h}`),`#${o.join("&")}`}return `#${h}`}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((t=>t.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e);})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return !1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e);}}const Lo={linearity:.3,easing:t.bezier(0,0,.3,1)},Ro=t.extend({deceleration:2500,maxSpeed:1400},Lo),ko=t.extend({deceleration:20,maxSpeed:1400},Lo),Fo=t.extend({deceleration:1e3,maxSpeed:360},Lo),Bo=t.extend({deceleration:1e3,maxSpeed:90},Lo);class Oo{constructor(t){this._map=t,this.clear();}clear(){this._inertiaBuffer=[];}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e});}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=t.exported.now();for(;e.length>0&&i-e[0].time>160;)e.shift();}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)i.zoom+=t.zoomDelta||0,i.bearing+=t.bearingDelta||0,i.pitch+=t.pitchDelta||0,t.panDelta&&i.pan._add(t.panDelta),t.around&&(i.around=t.around),t.pinchAround&&(i.pinchAround=t.pinchAround);const o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(i.pan.mag()){const n=No(i.pan.mag(),o,t.extend({},Ro,e||{}));r.offset=i.pan.mult(n.amount/i.pan.mag()),r.center=this._map.transform.center,Uo(r,n);}if(i.zoom){const t=No(i.zoom,o,ko);r.zoom=this._map.transform.zoom+t.amount,Uo(r,t);}if(i.bearing){const e=No(i.bearing,o,Fo);r.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),Uo(r,e);}if(i.pitch){const t=No(i.pitch,o,Bo);r.pitch=this._map.transform.pitch+t.amount,Uo(r,t);}if(r.zoom||r.bearing){const t=void 0===i.pinchAround?i.around:i.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter();}return this.clear(),t.extend(r,{noMoveStart:!0})}}function Uo(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing);}function No(e,i,o){const{maxSpeed:r,linearity:n,deceleration:a}=o,s=t.clamp(e*n/(i/1e3),-r,r),l=Math.abs(s)/(a*n);return {easing:o.easing,duration:1e3*l,amount:s*(l/2)}}class Go extends t.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,o,r={}){const a=n.mousePos(i.getCanvasContainer(),o),s=i.unproject(a);super(e,t.extend({point:a,lngLat:s,originalEvent:o},r)),this._defaultPrevented=!1,this.target=i;}}class Zo extends t.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,o){const r="touchend"===e?o.changedTouches:o.touches,a=n.touchPos(i.getCanvasContainer(),r),s=a.map((t=>i.unproject(t))),l=a.reduce(((t,e,i,o)=>t.add(e.div(o.length))),new t.pointGeometry(0,0));super(e,{points:a,point:l,lngLats:s,lngLat:i.unproject(l),originalEvent:o}),this._defaultPrevented=!1;}}class jo extends t.Event{preventDefault(){this._defaultPrevented=!0;}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1;}}class Vo{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance;}reset(){delete this._mousedownPos;}wheel(t){return this._firePreventable(new jo(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Go(t.type,this._map,t))}mouseup(t){this._map.fire(new Go(t.type,this._map,t));}preclick(e){const i=t.extend({},e);i.type="preclick",this._map.fire(new Go(i.type,this._map,i));}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Go(t.type,this._map,t)));}dblclick(t){return this._firePreventable(new Go(t.type,this._map,t))}mouseover(t){this._map.fire(new Go(t.type,this._map,t));}mouseout(t){this._map.fire(new Go(t.type,this._map,t));}touchstart(t){return this._firePreventable(new Zo(t.type,this._map,t))}touchmove(t){this._map.fire(new Zo(t.type,this._map,t));}touchend(t){this._map.fire(new Zo(t.type,this._map,t));}touchcancel(t){this._map.fire(new Zo(t.type,this._map,t));}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return {}}isEnabled(){return !0}isActive(){return !1}enable(){}disable(){}}class Wo{constructor(t){this._map=t;}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent;}mousemove(t){this._map.fire(new Go(t.type,this._map,t));}mousedown(){this._delayContextMenu=!0;}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Go("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent);}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Go(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault();}isEnabled(){return !0}isActive(){return !1}enable(){}disable(){}}class qo{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1;}isEnabled(){return !!this._enabled}isActive(){return !!this._active}enable(){this.isEnabled()||(this._enabled=!0);}disable(){this.isEnabled()&&(this._enabled=!1);}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(n.disableDrag(),this._startPos=this._lastPos=e,this._active=!0);}mousemoveWindow(t,e){if(!this._active)return;const i=e;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;const o=this._startPos;this._lastPos=i,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(o.x,i.x),a=Math.max(o.x,i.x),s=Math.min(o.y,i.y),l=Math.max(o.y,i.y);this._map._requestDomTask((()=>{this._box&&(n.setTransform(this._box,`translate(${r}px,${s}px)`),this._box.style.width=a-r+"px",this._box.style.height=l-s+"px");}));}mouseupWindow(e,i){if(!this._active)return;if(0!==e.button)return;const o=this._startPos,r=i;if(this.reset(),n.suppressClick(),o.x!==r.x||o.y!==r.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(o,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e);}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t));}blur(){this.reset();}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos;}_fireEvent(e,i){return this._map.fire(new t.Event(e,{originalEvent:i}))}}function Xo(t,e){const i={};for(let o=0;o<t.length;o++)i[t[o].identifier]=e[o];return i}class $o{constructor(t){this.reset(),this.numTouches=t.numTouches;}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1;}touchstart(e,i,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),o.length===this.numTouches&&(this.centroid=function(e){const i=new t.pointGeometry(0,0);for(const t of e)i._add(t);return i.div(e.length)}(i),this.touches=Xo(o,i)));}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const o=Xo(i,e);for(const t in this.touches){const e=this.touches[t],i=o[t];(!i||i.dist(e)>30)&&(this.aborted=!0);}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Ho{constructor(t){this.singleTap=new $o(t),this.numTaps=t.numTaps,this.reset();}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset();}touchstart(t,e,i){this.singleTap.touchstart(t,e,i);}touchmove(t,e,i){this.singleTap.touchmove(t,e,i);}touchend(t,e,i){const o=this.singleTap.touchend(t,e,i);if(o){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(o)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=o,this.count===this.numTaps)return this.reset(),o}}}class Ko{constructor(){this._zoomIn=new Ho({numTouches:1,numTaps:2}),this._zoomOut=new Ho({numTouches:2,numTaps:1}),this.reset();}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset();}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i);}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i);}touchend(t,e,i){const o=this._zoomIn.touchend(t,e,i),r=this._zoomOut.touchend(t,e,i);return o?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(o)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset();}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}}const Yo={0:1,2:2};class Jo{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1;}blur(){this.reset();}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton;}_correctButton(t,e){return !1}_move(t,e){return {}}mousedown(t,e){if(this._lastPoint)return;const i=n.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i);}mousemoveWindow(t,e){const i=this._lastPoint;if(i)if(t.preventDefault(),function(t,e){const i=Yo[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(i,e)}mouseupWindow(t){this._lastPoint&&n.mouseButton(t)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset());}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}}class Qo extends Jo{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0);}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return {around:e,panDelta:e.sub(t)}}}class tr extends Jo{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const i=.8*(e.x-t.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(t){t.preventDefault();}}class er extends Jo{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const i=-.5*(e.y-t.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(t){t.preventDefault();}}class ir{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),t.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this);}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0);}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length)return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer));}return t.preventDefault(),this._calculateTransform(t,e,i)}}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset();}touchcancel(){this.reset();}_calculateTransform(e,i,o){o.length>0&&(this._active=!0);const r=Xo(o,i),n=new t.pointGeometry(0,0),a=new t.pointGeometry(0,0);let s=0;for(const t in r){const e=r[t],i=this._touches[t];i&&(n._add(e),a._add(e.sub(i)),s++,r[t]=e);}if(this._touches=r,s<this._minTouches||!a.mag())return;const l=a.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:n.div(s),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"));}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=n.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`);}_showTouchPanBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show");}),500);}}class or{constructor(){this.reset();}reset(){this._active=!1,delete this._firstTwoTouches;}_start(t){}_move(t,e,i){return {}}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]));}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[o,r]=this._firstTwoTouches,n=rr(i,e,o),a=rr(i,e,r);if(!n||!a)return;const s=this._aroundCenter?null:n.add(a).div(2);return this._move([n,a],s,t)}touchend(t,e,i){if(!this._firstTwoTouches)return;const[o,r]=this._firstTwoTouches,a=rr(i,e,o),s=rr(i,e,r);a&&s||(this._active&&n.suppressClick(),this.reset());}touchcancel(){this.reset();}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}}function rr(t,e,i){for(let o=0;o<t.length;o++)if(t[o].identifier===i)return e[o]}function nr(t,e){return Math.log(t/e)/Math.LN2}class ar extends or{reset(){super.reset(),delete this._distance,delete this._startDistance;}_start(t){this._startDistance=this._distance=t[0].dist(t[1]);}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(nr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nr(this._distance,i),pinchAround:e}}}function sr(t,e){return 180*t.angleWith(e)/Math.PI}class lr extends or{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector;}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1]);}_move(t,e){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sr(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=sr(t,this._startVector);return Math.abs(i)<e}}function cr(t){return Math.abs(t.y)>Math.abs(t.x)}class hr extends or{constructor(t){super(),this._map=t;}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints;}_start(t){this._lastPoints=t,cr(t[0].sub(t[1]))&&(this._valid=!1);}_move(t,e,i){const o=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&i.touches.length<3)&&(this._valid=this.gestureBeginsVertically(o,r,i.timeStamp),this._valid))return this._lastPoints=t,this._active=!0,{pitchDelta:(o.y+r.y)/2*-.5}}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const o=t.mag()>=2,r=e.mag()>=2;if(!o&&!r)return;if(!o||!r)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const n=t.y>0==e.y>0;return cr(t)&&cr(e)&&n}}const ur={panStep:100,bearingStep:15,pitchStep:10};class dr{constructor(){const t=ur;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1;}blur(){this.reset();}reset(){this._active=!1;}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,o=0,r=0,n=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),n=-1);break;case 40:t.shiftKey?o=-1:(t.preventDefault(),n=1);break;default:return}return this._rotationDisabled&&(i=0,o=0),{cameraAnimation:a=>{const s=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:_r,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+i*this._bearingStep,pitch:a.getPitch()+o*this._pitchStep,offset:[-r*this._panStep,-n*this._panStep],center:a.getCenter()},{originalEvent:t});}}}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0;}enableRotation(){this._rotationDisabled=!1;}}function _r(t){return t*(2-t)}const mr=4.000244140625;class pr{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this);}setZoomRate(t){this._defaultZoomRate=t;}setWheelZoomRate(t){this._wheelZoomRate=t;}isEnabled(){return !!this._enabled}isActive(){return !!this._active||void 0!==this._finishTimeout}isZooming(){return !!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker());}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()));}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer));}let i=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const o=t.exported.now(),r=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==i&&i%mr==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault();}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t);}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=n.mousePos(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame());}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform,i=()=>e._terrainEnabled()?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>mr?this._wheelZoomRate:this._defaultZoomRate;let o=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==o&&(o=1/o);const r=i(),n=Math.pow(2,r),a="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):n;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(a*o))),"wheel"===this._type&&(this._startZoom=i(),this._easing=this._smoothOutEasing(200)),this._delta=0;}const o="number"==typeof this._targetZoom?this._targetZoom:i(),r=this._startZoom,n=this._easing;let a,s=!1;if("wheel"===this._type&&r&&n){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),i=n(e);a=t.number(r,o,i),e<1?this._frameId||(this._frameId=!0):s=!0;}else a=o,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout;}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:a-i(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=t.ease;if(this._prevEase){const e=this._prevEase,o=(t.exported.now()-e.start)/e.duration,r=e.easing(o+.01)-e.easing(o),n=.27/Math.sqrt(r*r+1e-4)*.01,a=Math.sqrt(.0729-n*n);i=t.bezier(n,a,.25,1);}return this._prevEase={start:t.exported.now(),duration:e,easing:i},i}blur(){this.reset();}reset(){this._active=!1;}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=n.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(t.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`);}_isFullscreen(){return !!t.window.document.fullscreenElement}_showBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show");}),200);}}class fr{constructor(t,e){this._clickZoom=t,this._tapZoom=e;}enable(){this._clickZoom.enable(),this._tapZoom.enable();}disable(){this._clickZoom.disable(),this._tapZoom.disable();}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gr{constructor(){this.reset();}reset(){this._active=!1;}blur(){this.reset();}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(t.shiftKey?-1:1),around:i.unproject(e)},{originalEvent:t});}}}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}}class vr{constructor(){this._tap=new Ho({numTouches:1,numTaps:1}),this.reset();}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset();}touchstart(t,e,i){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=e[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(t,e,i));}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const o=e[0],r=o.y-this._swipePoint.y;return this._swipePoint=o,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,i);}touchend(t,e,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(t,e,i)&&(this._tapTime=t.timeStamp);}touchcancel(){this.reset();}enable(){this._enabled=!0;}disable(){this._enabled=!1,this.reset();}isEnabled(){return this._enabled}isActive(){return this._active}}class xr{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i;}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan");}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan");}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yr{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i;}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable();}disable(){this._mouseRotate.disable(),this._mousePitch.disable();}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class br{constructor(t,e,i,o){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=o,this._rotationDisabled=!1,this._enabled=!0;}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate");}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate");}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable();}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable();}}const wr=t=>t.zoom||t.drag||t.pitch||t.rotate;class Tr extends t.Event{}class Er{constructor(){this.constants=[1,1,.01],this.radius=0;}setup(e,i){const o=t.sub([],i,e);this.radius=t.length(o[2]<0?t.div([],o,this.constants):[o[0],o[1],0]);}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$2(e,e,this.constants);const i=t.scale([],e,this.radius);if(i[2]>0){const e=t.scale([],[0,0,1],t.dot(i,[0,0,1])),o=t.scale([],t.normalize([],[i[0],i[1],0]),this.radius),r=t.add([],i,t.scale([],t.sub([],t.add([],o,e),i),2));i[0]=r[0],i[1]=r[1];}return i}}function Cr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Sr{constructor(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Oo(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Er,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),t.bindAll(["handleEvent","handleWindowEvent"],this);const o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[e,i,o]of this._listeners)n.addEventListener(e,i,e===t.window.document?this.handleWindowEvent:this.handleEvent,o);}destroy(){for(const[e,i,o]of this._listeners)n.removeEventListener(e,i,e===t.window.document?this.handleWindowEvent:this.handleEvent,o);}_addDefaultHandlers(t){const e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new Vo(e,t));const o=e.boxZoom=new qo(e,t);this._add("boxZoom",o);const r=new Ko,n=new gr;e.doubleClickZoom=new fr(n,r),this._add("tapZoom",r),this._add("clickZoom",n);const a=new vr;this._add("tapDragZoom",a);const s=e.touchPitch=new hr(e);this._add("touchPitch",s);const l=new tr(t),c=new er(t);e.dragRotate=new yr(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const h=new Qo(t),u=new ir(e,t);e.dragPan=new xr(i,h,u),this._add("mousePan",h),this._add("touchPan",u,["touchZoom","touchRotate"]);const d=new lr,_=new ar;e.touchZoomRotate=new br(i,_,d,a),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",_,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Wo(e));const m=e.scrollZoom=new pr(e,this);this._add("scrollZoom",m,["mousePan"]);const p=e.keyboard=new dr;this._add("keyboard",p);for(const i of ["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[i]&&e[i].enable(t[i]);}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e;}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[];}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return !0;return !1}isZooming(){return !!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return !!this._eventsInProgress.rotate}isMoving(){return Boolean(wr(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,i){for(const o in t)if(o!==i&&(!e||e.indexOf(o)<0))return !0;return !1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`);}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}handleEvent(t,e){this._updatingCamera=!0;const i="renderFrame"===t.type,o=i?void 0:t,r={needsRenderFrame:!1},a={},s={},l=t.touches?this._getMapTouches(t.touches):void 0,c=l?n.touchPos(this._el,l):i?void 0:n.mousePos(this._el,t);for(const{handlerName:i,handler:n,allowed:h}of this._handlers){if(!n.isEnabled())continue;let u;this._blockedByActive(s,h,i)?n.reset():n[e||t.type]&&(u=n[e||t.type](t,c,l),this.mergeHandlerResult(r,a,u,i,o),u&&u.needsRenderFrame&&this._triggerRenderFrame()),(u||n.isActive())&&(s[i]=n);}const h={};for(const t in this._previousActiveHandlers)s[t]||(h[t]=o);this._previousActiveHandlers=s,(Object.keys(h).length||Cr(r))&&(this._changes.push([r,a,h]),this._triggerRenderFrame()),(Object.keys(s).length||Cr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=r;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map));}mergeHandlerResult(e,i,o,r,n){if(!o)return;t.extend(e,o);const a={handlerName:r,originalEvent:o.originalEvent||n};void 0!==o.zoomDelta&&(i.zoom=a),void 0!==o.panDelta&&(i.drag=a),void 0!==o.pitchDelta&&(i.pitch=a),void 0!==o.bearingDelta&&(i.rotate=a);}_applyChanges(){const e={},i={},o={};for(const[r,n,a]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.aroundCoord&&(e.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.extend(i,n),t.extend(o,a);this._updateMapTransform(e,i,o),this._changes=[];}_updateMapTransform(e,i,o){const r=this._map,n=r.transform,a=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Cr(e)){const t=n.zoom;n.cameraElevationReference="sea",n.recenterOnTerrain(),n.cameraElevationReference="ground",t!==n.zoom&&this._map._update(!0);}if(!Cr(e))return this._fireEvents(i,o,!0);let{panDelta:s,zoomDelta:l,bearingDelta:c,pitchDelta:h,around:u,aroundCoord:d,pinchAround:_}=e;void 0!==_&&(u=_),(t=>i.drag&&!this._eventsInProgress.drag)()&&u&&(this._dragOrigin=a(n.pointCoordinate3D(u)),this._trackingEllipsoid.setup(n._camera.position,this._dragOrigin)),n.cameraElevationReference="sea",r._stop(!0),u=u||r.transform.centerPoint,c&&(n.bearing+=c),h&&(n.pitch+=h),n._updateCameraState();const m=[0,0,0];if(s){const t=n.screenPointToMercatorRay(u),e=n.screenPointToMercatorRay(u.sub(s)),i=this._trackingEllipsoid.projectRay(t.dir),o=this._trackingEllipsoid.projectRay(e.dir);m[0]=o[0]-i[0],m[1]=o[1]-i[1];}const p=n.zoom,f=[0,0,0];if(l){const e=a(d||n.pointCoordinate3D(u)),i={dir:t.normalize([],t.sub([],e,n._camera.position))},o=n.screenPointToMercatorRay(n.centerPoint);if(i.dir[2]<0){const r=t.altitudeFromMercatorZ(e[2],e[1]),s=n.rayIntersectionCoordinate(n.pointRayIntersection(n.centerPoint,r)),c=n.zoomDeltaToMovement(a(s),l)*(o.dir[2]/i.dir[2]);t.scale(f,i.dir,c);}else if(n._terrainEnabled()){const o=n.zoomDeltaToMovement(e,l);t.scale(f,i.dir,o);}}const g=t.add(m,m,f);n._translateCameraConstrained(g),l&&Math.abs(n.zoom-p)>1e-4&&n.recenterOnTerrain(),n.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,o,!0);}_fireEvents(e,i,o){const r=wr(this._eventsInProgress),n=wr(e),a={};for(const t in e){const{originalEvent:i}=e[t];this._eventsInProgress[t]||(a[`${t}start`]=i),this._eventsInProgress[t]=e[t];}!r&&n&&this._fireEvent("movestart",n.originalEvent);for(const t in a)this._fireEvent(t,a[t]);n&&this._fireEvent("move",n.originalEvent);for(const t in e){const{originalEvent:i}=e[t];this._fireEvent(t,i);}const s={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:o}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=i[e]||o,s[`${t}end`]=l);}for(const t in s)this._fireEvent(t,s[t]);const c=wr(this._eventsInProgress);if(o&&(r||n)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(i(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1;}}_fireEvent(e,i){this._map.fire(new t.Event(e,i?{originalEvent:i}:{}));}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Tr("renderFrame",{timeStamp:t})),this._applyChanges();}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame());}}const Mr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ir extends t.Evented{constructor(e,i){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this);}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,i,o){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},i),o)}panTo(e,i,o){return this.easeTo(t.extend({center:e},i),o)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,i,o){return this.easeTo(t.extend({zoom:e},i),o)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,i,o){return this.easeTo(t.extend({bearing:e},i),o)}resetNorth(e,i){return this.rotateTo(0,t.extend({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),i),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,i){e=t.LngLatBounds.convert(e);const o=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),o,i)}_extendCameraOptions(e){const i={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t};}return e.padding=t.extend(i,e.padding),e}_cameraForBoxAndBearing(e,i,o,r){const n=this._extendCameraOptions(r),a=this.transform,s=a.padding,l=a.project(t.LngLat.convert(e)),c=a.project(t.LngLat.convert(i)),h=l.rotate(-t.degToRad(o)),u=c.rotate(-t.degToRad(o)),d=new t.pointGeometry(Math.max(h.x,u.x),Math.max(h.y,u.y)),_=new t.pointGeometry(Math.min(h.x,u.x),Math.min(h.y,u.y)),m=d.sub(_),p=(a.width-(s.left+s.right+n.padding.left+n.padding.right))/m.x,f=(a.height-(s.top+s.bottom+n.padding.top+n.padding.bottom))/m.y;if(f<0||p<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const g=Math.min(a.scaleZoom(a.scale*Math.min(p,f)),n.maxZoom),v="number"==typeof n.offset.x?new t.pointGeometry(n.offset.x,n.offset.y):t.pointGeometry.convert(n.offset),x=new t.pointGeometry((n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2).rotate(o*Math.PI/180),y=v.add(x).mult(a.scale/a.zoomScale(g));return {center:a.unproject(l.add(c).div(2).sub(y)),zoom:g,bearing:o}}_cameraForBox(e,i,o,r,n){const a=this._extendCameraOptions(n);o=o||0,r=r||0,e=t.LngLat.convert(e),i=t.LngLat.convert(i);const s=this.transform.clone();s.padding=a.padding;const l=this.getFreeCameraOptions(),c=new t.LngLat(.5*(e.lng+i.lng),.5*(e.lat+i.lat)),h=.5*(o+r);if(s._camera.position[2]<t.mercatorZfromAltitude(h,c.lat))return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");l.lookAtPoint(c),s.setFreeCameraOptions(l);const u=t.MercatorCoordinate.fromLngLat(e),d=t.MercatorCoordinate.fromLngLat(i),_=s.pointRayIntersection(s.centerPoint,h),f=[(g=s.rayIntersectionCoordinate(_)).x,g.y,g.z];var g;const v=s.screenPointToMercatorRay(s.centerPoint);let x,y=0;do{const e=Math.floor(s.zoom),i=1<<e,n=Math.min(i*u.x,i*d.x),a=Math.min(i*u.y,i*d.y),l=Math.max(i*u.x,i*d.x),c=Math.max(i*u.y,i*d.y),h=new p([n,a,o],[l,c,r]),_=m.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,e);if(2!==h.intersects(_)){x&&(s._camera.position=t.scaleAndAdd([],s._camera.position,v.dir,-x),s._updateStateFromCamera());break}const g=t.sub([],s._camera.position,f);x=.5*t.length(g),s._camera.position=t.scaleAndAdd([],s._camera.position,v.dir,x);try{s._updateStateFromCamera();}catch(e){return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++y<10);return {center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}_raycastElevationBox(e,i){const o=this.transform.elevation;if(!o)return;const r=new t.pointGeometry(e.x,i.y),n=new t.pointGeometry(i.x,e.y),a=o.pointCoordinate(e);if(!a)return;const s=o.pointCoordinate(i);if(!s)return;const l=o.pointCoordinate(r);if(!l)return;const c=o.pointCoordinate(n);if(!c)return;const h=new t.MercatorCoordinate(a[0],a[1]).toLngLat(),u=new t.MercatorCoordinate(s[0],s[1]).toLngLat(),d=new t.MercatorCoordinate(l[0],l[1]).toLngLat(),_=new t.MercatorCoordinate(c[0],c[1]).toLngLat(),m=Math.min(h.lng,Math.min(u.lng,Math.min(d.lng,_.lng))),p=Math.min(h.lat,Math.min(u.lat,Math.min(d.lat,_.lat))),f=Math.max(h.lng,Math.max(u.lng,Math.max(d.lng,_.lng))),g=Math.max(h.lat,Math.max(u.lat,Math.max(d.lat,_.lat))),v=Math.min(a[3],Math.min(s[3],Math.min(l[3],c[3]))),x=Math.max(a[3],Math.max(s[3],Math.max(l[3],c[3])));return {minLngLat:new t.LngLat(m,p),maxLngLat:new t.LngLat(f,g),minAltitude:v,maxAltitude:x}}fitScreenCoordinates(e,i,o,r,n){let a,s,l,c;const h=t.pointGeometry.convert(e),u=t.pointGeometry.convert(i),d=this._raycastElevationBox(h,u);if(d)a=d.minLngLat,s=d.maxLngLat,l=d.minAltitude,c=d.maxAltitude;else {if(this.transform.anyCornerOffEdge(h,u))return this;a=this.transform.pointLocation(h),s=this.transform.pointLocation(u);}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(i)),o,r):this._cameraForBox(a,s,l,c,r),r,n)}_fitInternal(e,i,o){return e?(delete(i=t.extend(e,i)).padding,i.linear?this.easeTo(i,o):this.flyTo(i,o)):this}jumpTo(e,i){this.stop();const o=this.transform;let r=!1,n=!1,a=!1;return "zoom"in e&&o.zoom!==+e.zoom&&(r=!0,o.zoom=+e.zoom),void 0!==e.center&&(o.center=t.LngLat.convert(e.center)),"bearing"in e&&o.bearing!==+e.bearing&&(n=!0,o.bearing=+e.bearing),"pitch"in e&&o.pitch!==+e.pitch&&(a=!0,o.pitch=+e.pitch),null==e.padding||o.isPaddingEqual(e.padding)||(o.padding=e.padding),this.fire(new t.Event("movestart",i)).fire(new t.Event("move",i)),r&&this.fire(new t.Event("zoomstart",i)).fire(new t.Event("zoom",i)).fire(new t.Event("zoomend",i)),n&&this.fire(new t.Event("rotatestart",i)).fire(new t.Event("rotate",i)).fire(new t.Event("rotateend",i)),a&&this.fire(new t.Event("pitchstart",i)).fire(new t.Event("pitch",i)).fire(new t.Event("pitchend",i)),this.fire(new t.Event("moveend",i))}getFreeCameraOptions(){return "mercator"!==this.transform.projection.name&&t.warnOnce(Mr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,i){const o=this.transform;if("mercator"!==o.projection.name)return void t.warnOnce(Mr);this.stop();const r=o.zoom,n=o.pitch,a=o.bearing;o.setFreeCameraOptions(e);const s=r!==o.zoom,l=n!==o.pitch,c=a!==o.bearing;return this.fire(new t.Event("movestart",i)).fire(new t.Event("move",i)),s&&this.fire(new t.Event("zoomstart",i)).fire(new t.Event("zoom",i)).fire(new t.Event("zoomend",i)),c&&this.fire(new t.Event("rotatestart",i)).fire(new t.Event("rotate",i)).fire(new t.Event("rotateend",i)),l&&this.fire(new t.Event("pitchstart",i)).fire(new t.Event("pitch",i)).fire(new t.Event("pitchend",i)),this.fire(new t.Event("moveend",i)),this}easeTo(e,i){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const o=this.transform,r=this.getZoom(),n=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?+e.zoom:r,c="bearing"in e?this._normalizeBearing(e.bearing,n):n,h="pitch"in e?+e.pitch:a,u="padding"in e?e.padding:o.padding,d=t.pointGeometry.convert(e.offset);let _=o.centerPoint.add(d);const m=o.pointLocation(_),p=t.LngLat.convert(e.center||m);this._normalizeCenter(p);const f=o.project(m),g=o.project(p).sub(f),v=o.zoomScale(l-r);let x,y;e.around&&(x=t.LngLat.convert(e.around),y=o.locationPoint(x));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||n!==c,this._pitching=this._pitching||h!==a,this._padding=!o.isPaddingEqual(u),this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,b),this._ease((e=>{if(this._zooming&&(o.zoom=t.number(r,l,e)),this._rotating&&(o.bearing=t.number(n,c,e)),this._pitching&&(o.pitch=t.number(a,h,e)),this._padding&&(o.interpolatePadding(s,u,e),_=o.centerPoint.add(d)),x)o.setLocationAtPoint(x,y);else {const t=o.zoomScale(o.zoom-r),i=l>r?Math.min(2,v):Math.max(.5,v),n=Math.pow(i,1-e),a=o.unproject(f.add(g.mult(e*n)).mult(t));o.setLocationAtPoint(o.renderWorldCopies?a.wrap():a,_);}this._fireMoveEvents(i);}),(t=>{o.recenterOnTerrain(),this._afterEase(i,t);}),e),this}_prepareEase(e,i,o={}){this._moving=!0,this.transform.cameraElevationReference="sea",i||o.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!o.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!o.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!o.pitching&&this.fire(new t.Event("pitchstart",e));}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e));}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId,this.transform.cameraElevationReference="ground";const o=this._zooming,r=this._rotating,n=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,o&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),n&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e));}flyTo(e,i){if(!e.essential&&t.exported.prefersReducedMotion){const o=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,i)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const o=this.transform,r=this.getZoom(),n=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):r,c="bearing"in e?this._normalizeBearing(e.bearing,n):n,h="pitch"in e?+e.pitch:a,u="padding"in e?e.padding:o.padding,d=o.zoomScale(l-r),_=t.pointGeometry.convert(e.offset);let m=o.centerPoint.add(_);const p=o.pointLocation(m),f=t.LngLat.convert(e.center||p);this._normalizeCenter(f);const g=o.project(p),v=o.project(f).sub(g);let x=e.curve;const y=Math.max(o.width,o.height),b=y/d,w=v.mag();if("minZoom"in e){const i=t.clamp(Math.min(e.minZoom,r,l),o.minZoom,o.maxZoom),n=y/o.zoomScale(i-r);x=Math.sqrt(n/w*2);}const T=x*x;function E(t){const e=(b*b-y*y+(t?-1:1)*T*T*w*w)/(2*(t?b:y)*T*w);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return (Math.exp(t)-Math.exp(-t))/2}function S(t){return (Math.exp(t)+Math.exp(-t))/2}const M=E(0);let I=function(t){return S(M)/S(M+x*t)},z=function(t){return y*((S(M)*(C(e=M+x*t)/S(e))-C(M))/T)/w;var e;},A=(E(1)-M)/x;if(Math.abs(w)<1e-6||!isFinite(A)){if(Math.abs(y-b)<1e-6)return this.easeTo(e,i);const t=b<y?-1:1;A=Math.abs(Math.log(b/y))/x,z=function(){return 0},I=function(e){return Math.exp(t*x*e)};}return e.duration="duration"in e?+e.duration:1e3*A/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=n!==c,this._pitching=h!==a,this._padding=!o.isPaddingEqual(u),this._prepareEase(i,!1),this._ease((e=>{const d=e*A,p=1/I(d);o.zoom=1===e?l:r+o.scaleZoom(p),this._rotating&&(o.bearing=t.number(n,c,e)),this._pitching&&(o.pitch=t.number(a,h,e)),this._padding&&(o.interpolatePadding(s,u,e),m=o.centerPoint.add(_));const x=1===e?f:o.unproject(g.add(v.mult(z(d))).mult(p));o.setLocationAtPoint(o.renderWorldCopies?x.wrap():x,m),o._updateCenterElevation(),this._fireMoveEvents(i);}),(()=>this._afterEase(i)),e),this}isEasing(){return !!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e);}if(!t){const t=this.handlers;t&&t.stop(!1);}return this}_ease(e,i,o){!1===o.animate||0===o.duration?(e(1),i()):(this._easeStart=t.exported.now(),this._easeOptions=o,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback));}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop();}_normalizeBearing(e,i){e=t.wrap(e,-180,180);const o=Math.abs(e-i);return Math.abs(e-360-i)<o&&(e-=360),Math.abs(e+360-i)<o&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.maxBounds)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0;}}class zr{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this);}getDefaultPosition(){return "bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=n.create("button","mapboxgl-ctrl-attrib-button",this._container),n.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0;}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.setAttribute("aria-label",i),t.firstElementChild&&t.firstElementChild.setAttribute("title",i);}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"));}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const o=i.reduce(((t,e,o)=>(e.value&&(t+=`${e.key}=${e.value}${o<i.length-1?"&":""}`),t)),"?");e.href=`${t.config.FEEDBACK_URL}/${o}${this._map._hash?this._map._hash.getHashString(!0):""}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback");}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink());}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id;}const e=this._map.style._sourceCaches;for(const i in e){const o=e[i];if(o.used){const e=o.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution);}}t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,i)=>{for(let o=i+1;o<t.length;o++)if(t[o].indexOf(e)>=0)return !1;return !0}));const i=t.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null);}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show");}}class Ar{constructor(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this);}onAdd(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");const e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact);}getDefaultPosition(){return "bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none");}_logoRequired(){if(!this._map.style)return !0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return !0;for(const e in t){const i=t[e].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return !1}return !0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact");}}}class Dr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1;}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1;}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[];}}function Pr(e,i,o){if(e=new t.LngLat(e.lng,e.lat),i){const r=new t.LngLat(e.lng-360,e.lat),n=new t.LngLat(e.lng+360,e.lat),a=360*Math.ceil(Math.abs(e.lng-o.center.lng)/360),s=o.locationPoint(e).distSqr(i),l=i.x<0||i.y<0||i.x>o.width||i.y>o.height;o.locationPoint(r).distSqr(i)<s&&(l||Math.abs(r.lng-o.center.lng)<a)?e=r:o.locationPoint(n).distSqr(i)<s&&(l||Math.abs(n.lng-o.center.lng)<a)&&(e=n);}for(;Math.abs(e.lng-o.center.lng)>180;){const t=o.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=o.width&&t.y<=o.height)break;e.lng>o.center.lng?e.lng-=360:e.lng+=360;}return e}const Lr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Rr extends t.Evented{constructor(e,i){if(super(),(e instanceof t.window.HTMLElement||i)&&(e=t.extend({element:e},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else {this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");const i=n.createNS("http://www.w3.org/2000/svg","svg"),o=41,r=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${o}px`),i.setAttributeNS(null,"width",`${r}px`),i.setAttributeNS(null,"viewBox",`0 0 ${r} ${o}`);const a=n.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=n.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=n.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e);}const h=n.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);const u=n.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(u);const d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const _=n.createNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(_);const m=n.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");const p=n.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(8.0, 8.0)");const f=n.createNS("http://www.w3.org/2000/svg","circle");f.setAttributeNS(null,"fill","#000000"),f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"cx","5.5"),f.setAttributeNS(null,"cy","5.5"),f.setAttributeNS(null,"r","5.4999962");const g=n.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#FFFFFF"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962"),p.appendChild(f),p.appendChild(g),s.appendChild(l),s.appendChild(h),s.appendChild(d),s.appendChild(m),s.appendChild(p),i.appendChild(s),i.setAttributeNS(null,"height",o*this._scale+"px"),i.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(i),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14]);}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault();})),this._element.addEventListener("mousedown",(t=>{t.preventDefault();}));const o=this._element.classList;for(const t in Lr)o.remove(`mapboxgl-marker-anchor-${t}`);o.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null;}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),n.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,o=Math.sqrt(Math.pow(i,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[o,-1*(e-i+o)],"bottom-right":[-o,-1*(e-i+o)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset;}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false");}return this}_onKeyPress(t){const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup();}_onMapClick(t){const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup();}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const t=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(t))return void this._clearFadeTimer();const e=this._map.unproject(t);let i=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const t=this._map.getFreeCameraOptions();if(t.position){const o=t.position.toLngLat();i=o.distanceTo(e)<.9*o.distanceTo(this._lngLat);}}const o=(1-this._map._queryFogOpacity(e))*(i?.2:1);this._element.style.opacity=`${o}`,this._popup&&this._popup._setOpacity(`${o}`),this._fadeTimer=null;}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null);}_withinScreenBounds(t){const e=this._map.transform;return !!t&&t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Pr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),this._map._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&n.setTransform(this._element,`${Lr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${i} ${e}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)));}));}_transformedOffset(){if(!this._defaultMarker)return this._offset;const t=this._map.transform,e=this._offset.mult(this._scale);return "map"===this._rotationAlignment&&e._rotate(t.angle),"map"===this._pitchAlignment&&(e.y*=Math.cos(t._pitch)),e}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t;}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")));}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive";}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp));}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class kr{constructor(t){this.jumpTo(t);}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const i=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t;}easeTo(t,e,i){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+i;}}const Fr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:Br,HTMLElement:Or,ImageBitmap:Ur}=t.window,Nr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Gr(t){t.parentNode&&t.parentNode.removeChild(t);}const Zr={showCompass:!0,showZoom:!0,visualizePitch:!1};class jr{constructor(e,i,o=!1){this._clickTolerance=10,this.element=i,this.mouseRotate=new tr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,o&&(this.mousePitch=new er({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(i,"mousedown",this.mousedown),n.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(i,"touchmove",this.touchmove),n.addEventListener(i,"touchend",this.touchend),n.addEventListener(i,"touchcancel",this.reset);}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),n.disableDrag();}move(t,e){const i=this.map,o=this.mouseRotate.mousemoveWindow(t,e);if(o&&o.bearingDelta&&i.setBearing(i.getBearing()+o.bearingDelta),this.mousePitch){const o=this.mousePitch.mousemoveWindow(t,e);o&&o.pitchDelta&&i.setPitch(i.getPitch()+o.pitchDelta);}}off(){const t=this.element;n.removeEventListener(t,"mousedown",this.mousedown),n.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(t,"touchmove",this.touchmove),n.removeEventListener(t,"touchend",this.touchend),n.removeEventListener(t,"touchcancel",this.reset),this.offTemp();}offTemp(){n.enableDrag(),n.removeEventListener(t.window,"mousemove",this.mousemove),n.removeEventListener(t.window,"mouseup",this.mouseup);}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),n.mousePos(this.element,e)),n.addEventListener(t.window,"mousemove",this.mousemove),n.addEventListener(t.window,"mouseup",this.mouseup);}mousemove(t){this.move(t,n.mousePos(this.element,t));}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp();}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos));}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos));}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset();}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp();}}const Vr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Wr,qr=0,Xr=!1;const $r={maxWidth:100,unit:"metric"};function Hr(t,e,i){const o=i&&i.maxWidth||100,r=t._container.getBoundingClientRect().height/2,n=t.unproject([0,r]),a=t.unproject([o,r]),s=n.distanceTo(a);if(i&&"imperial"===i.unit){const i=3.2808*s;i>5280?Kr(e,o,i/5280,t._getUIString("ScaleControl.Miles"),t):Kr(e,o,i,t._getUIString("ScaleControl.Feet"),t);}else i&&"nautical"===i.unit?Kr(e,o,s/1852,t._getUIString("ScaleControl.NauticalMiles"),t):s>=1e3?Kr(e,o,s/1e3,t._getUIString("ScaleControl.Kilometers"),t):Kr(e,o,s,t._getUIString("ScaleControl.Meters"),t);}function Kr(t,e,i,o,r){const n=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i),e*i}(i),a=n/i;r._requestDomTask((()=>{t.style.width=e*a+"px",t.innerHTML=`${n}&nbsp;${o}`;}));}const Yr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Jr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Qr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Ir{constructor(e){if(null!=(e=t.extend({},Nr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ao(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._renderTaskQueue=new Dr,this._domRenderTaskQueue=new Dr,this._controls=[],this._markers=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Fr,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new kr(0),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else {if(!(e.container instanceof Or))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container;}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Sr(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),this._hash=e.hash&&new Po("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),e.attributionControl&&this.addControl(new zr({customAttribution:e.customAttribution})),this._logoControl=new Ar,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet);})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.Event(`${e.dataType}data`,e));})),this.on("dataloading",(e=>{this.fire(new t.Event(`${e.dataType}dataloading`,e));}));}_getMapId(){return this._mapId}addControl(e,i){if(void 0===i&&(i=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[i];return -1!==i.indexOf("bottom")?r.insertBefore(o,r.firstChild):r.appendChild(o),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(e);return i>-1&&this._controls.splice(i,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){const[i,o]=this._containerDimensions();if(i===this.transform.width&&o===this.transform.height)return this;this._resizeCanvas(i,o),this.transform.resize(i,o),this.painter.resize(Math.ceil(i),Math.ceil(o));const r=!this._moving;return r&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),r&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?85:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}getProjection(){return this.transform.getProjection()}setProjection(t){this._lazyInitEmptyStyle(),"string"==typeof t&&(t={name:t}),this._runtimeProjection=t,this.style.updateProjection();}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.pointGeometry.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let o=!1;const r=r=>{const n=e.filter((t=>this.getLayer(t))),a=n.length?this.queryRenderedFeatures(r.point,{layers:n}):[];a.length?o||(o=!0,i.call(this,new Go(t,this,r.originalEvent,{features:a}))):o=!1;},n=()=>{o=!1;};return {layers:new Set(e),listener:i,delegates:{mousemove:r,mouseout:n}}}if("mouseleave"===t||"mouseout"===t){let o=!1;const r=r=>{const n=e.filter((t=>this.getLayer(t)));(n.length?this.queryRenderedFeatures(r.point,{layers:n}):[]).length?o=!0:o&&(o=!1,i.call(this,new Go(t,this,r.originalEvent)));},n=e=>{o&&(o=!1,i.call(this,new Go(t,this,e.originalEvent)));};return {layers:new Set(e),listener:i,delegates:{mousemove:r,mouseout:n}}}{const o=t=>{const o=e.filter((t=>this.getLayer(t))),r=o.length?this.queryRenderedFeatures(t.point,{layers:o}):[];r.length&&(t.features=r,i.call(this,t),delete t.features);};return {layers:new Set(e),listener:i,delegates:{[t]:o}}}}on(t,e,i){if(void 0===i)return super.on(t,e);Array.isArray(e)||(e=[e]);const o=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(o);for(const t in o.delegates)this.on(t,o.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);Array.isArray(e)||(e=[e]);const o=this._createDelegatedListener(t,e,i);for(const t in o.delegates)this.once(t,o.delegates[t]);return this}off(t,e,i){if(void 0===i)return super.off(t,e);e=new Set(Array.isArray(e)?e:[e]);const o=(t,e)=>{if(t.size!==e.size)return !1;for(const i of t)if(!e.has(i))return !1;return !0},r=this._delegatedListeners?this._delegatedListeners[t]:void 0;return r&&(t=>{for(let r=0;r<t.length;r++){const n=t[r];if(n.listener===i&&o(n.layers,e)){for(const t in n.delegates)this.off(t,n.delegates[t]);return t.splice(r,1),this}}})(r),this}queryRenderedFeatures(e,i){return this.style?(void 0!==i||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(i=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}queryTerrainElevation(e,i){const o=this.transform.elevation;return o?(i=t.extend({},{exaggerated:!0},i),o.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,i.exaggerated)):null}setStyle(e,i){return !1!==(i=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(e,i))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),t&&(this.style=new je(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new je(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty());}_diffStyle(e,i){if("string"==typeof e){const o=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(o,t.ResourceType.Style);t.getJSON(r,((e,o)=>{e?this.fire(new t.ErrorEvent(e)):o&&this._updateDiff(o,i);}));}else "object"==typeof e&&this._updateDiff(e,i);}_updateDiff(e,i){try{this.style.setState(e)&&this._update(!0);}catch(o){t.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(e,i);}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const i=this.style&&this.style._getSourceCaches(e);if(0!==i.length)return i.every((t=>t.loaded()));this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)));}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return !1}}return !0}addSourceType(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,i,{pixelRatio:o=1,sdf:r=!1,stretchX:n,stretchY:a,content:s}={}){if(this._lazyInitEmptyStyle(),i instanceof Br||Ur&&i instanceof Ur){const{width:l,height:c,data:h}=t.exported.getImageData(i);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},h),pixelRatio:o,stretchX:n,stretchY:a,content:s,sdf:r,version:0});}else {if(void 0===i.width||void 0===i.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:c,data:h}=i,u=i;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},new Uint8Array(h)),pixelRatio:o,stretchX:n,stretchY:a,content:s,sdf:r,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e);}}}updateImage(e,i){const o=this.style.getImage(e);if(!o)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=i instanceof Br||Ur&&i instanceof Ur?t.exported.getImageData(i):i,{width:n,height:a,data:s}=r;return void 0===n||void 0===a?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):n!==o.data.width||a!==o.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(o.data.replace(s,!(i instanceof Br||Ur&&i instanceof Ur)),void this.style.updateImage(e,o))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t);}loadImage(e,i){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),((e,o)=>{i(e,o instanceof Br?t.exported.getImageData(o):o);}));}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,o={}){return this.style.setPaintProperty(t,e,i,o),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,o={}){return this.style.setLayoutProperty(t,e,i,o),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300),[t,e]}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.");}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);const o=this._controlContainer=n.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{r[t]=n.create("div",`mapboxgl-ctrl-${t}`,o);})),this._container.addEventListener("scroll",this._onMapScroll,!1);}_resizeCanvas(e,i){const o=t.exported.devicePixelRatio||1;this._canvas.width=o*Math.ceil(e),this._canvas.height=o*Math.ceil(i),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${i}px`;}_addMarker(t){this._markers.push(t);}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1);}_setupPainter(){const i=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);o?(t.storeAuthState(o,!0),this.painter=new mo(o,this.transform),this.on("data",(t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0);})),t.exported$1.testSupport(o)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")));}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}));}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}));}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return !this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t);}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t);}_render(e){let i;const o=this.painter.context.extTimerQuery,r=t.exported.now();this.listens("gpu-timing-frame")&&(i=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,i));let n=this._updateAverageElevation(r);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;let a=!1;const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,i=this.transform.pitch,o=t.exported.now();this.style.zoomHistory.update(e,o);const r=new t.EvaluationParameters(e,{now:o,fadeDuration:s,pitch:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),n=r.crossFadingFactor();1===n&&n===this._crossFadingFactor||(a=!0,this._crossFadingFactor=n),this.style.update(r);}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-r;o.endQueryEXT(o.TIME_ELAPSED_EXT,i),setTimeout((()=>{const r=o.getQueryObjectEXT(i,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(i),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:r}));}),50);}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const i=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:i}));}),50);}const l=this._sourcesDirty||this._styleDirty||this._placementDirty||n;if(l||this._repaint)this.triggerRepaint();else {const e=!this.isMoving()&&this.loaded();if(e&&(n=this._updateAverageElevation(r,!0)),n)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1;}}return !this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const t of this._markers)t._update();}_updateAverageElevation(t,e=!1){const i=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let o=this.transform.sampleAverageElevation();isNaN(o)?o=0:this._averageElevationLastSampledAt=t;const r=Math.abs(e-o);if(r>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(o),i(o);this._averageElevation.easeTo(o,t,300);}else if(r>1e-4)return this._averageElevation.jumpTo(o),i(o)}return !!this._averageElevation.isEasing(t)&&i(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof Ar&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")));}})),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}));}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming());}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const i=this.painter.context.gl,o=i.createFramebuffer();function r(t){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0);const e=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,e),e}return i.bindFramebuffer(i.FRAMEBUFFER,o),this._canvasPixelComparison(r(t),e.canvasCopies.map(r),e.timeStamps)}_canvasPixelComparison(t,e,i){let o=i[1]-i[0];const r=t.length/4;for(let n=0;n<e.length;n++){const a=e[n];let s=0;for(let e=0;e<a.length;e+=4)a[e]===t[e]&&a[e+1]===t[e+1]&&a[e+2]===t[e+2]&&a[e+3]===t[e+3]&&(s+=1);o+=(i[n+2]-i[n+1])*(1-s/r);}return o}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.clearWorkerCaches(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),Gr(this._canvasContainer),Gr(this._controlContainer),Gr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"));}triggerRepaint(){this._triggerFrame(!0);}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame((t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t);})));}_onWindowOnline(){this._update();}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update();}get showTileBoundaries(){return !!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update());}get showTerrainWireframe(){return !!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update());}get speedIndexTiming(){return !!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update());}get showPadding(){return !!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update());}get showCollisionBoxes(){return !!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update());}get showOverdrawInspector(){return !!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update());}get repaint(){return !!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint());}get vertices(){return !!this._vertices}set vertices(t){this._vertices=t,this._update();}_setCacheLimits(e,i){t.setCacheLimits(e,i);}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},Zr,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t});})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0));}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString());}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t);}));}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map;}_createButton(t,e){const i=n.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i}_setButtonTitle(t,e){const i=this._map._getUIString(`NavigationControl.${e}`);t.setAttribute("aria-label",i),t.firstElementChild&&t.firstElementChild.setAttribute("title",i);}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},Vr,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Do(this._updateMarkerRotation,20);}onAdd(e){var i;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==Wr?i(Wr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((t=>{Wr="denied"!==t.state,i(Wr);})):(Wr=!!t.window.navigator.geolocation,i(Wr)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qr=0,Xr=!1;}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish();}}_updateCamera(e){const i=new t.LngLat(e.coords.longitude,e.coords.latitude),o=e.coords.accuracy,r=this._map.getBearing(),n=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(o),n,{geolocateSource:!0});}_updateMarker(e){if(e){const i=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius();}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove();}_updateCircleRadius(){const t=this._map._container.getBoundingClientRect().height/2,e=this._map.unproject([0,t]),i=this._map.unproject([100,t]),o=e.distanceTo(i)/100,r=Math.ceil(2*this._accuracy/o);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`;}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius();}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0));}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch();}else {if(3===e.code&&Xr)return;this._setErrorState();}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish();}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0;}_setupUI(e){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e);}else {const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t);}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location"),this._dotElement.appendChild(n.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(n.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")));}));}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled());}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qr--,Xr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"));}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qr++,qr>1?(e={maximumAge:6e5,timeout:0},Xr=!0):(e=this.options.positionOptions,Xr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener();}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return !0}_addDeviceOrientationListener(){const e=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener);};void 0!==t.window.DeviceMotionEvent&&"function"==typeof t.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&e();})).catch(console.error):e();}_clearWatch(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null);}},AttributionControl:zr,ScaleControl:class{constructor(e){this.options=t.extend({},$r,e),t.bindAll(["_onMove","setUnit"],this);}getDefaultPosition(){return "bottom-left"}_onMove(){Hr(this._map,this._container,this.options);}onAdd(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0;}setUnit(t){this.options.unit=t,Hr(this._map,this._container,this.options);}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange");}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon);}_checkFullscreenSupport(){return !(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon);}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t);}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle());}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen();}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(Yr),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[]);}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return !!this._map}remove(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const i=t.window.document.createDocumentFragment(),o=t.window.document.createElement("body");let r;for(o.innerHTML=e;r=o.firstChild,r;)i.appendChild(r);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=n.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._container&&this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._container&&this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._container&&this._updateClassList(),e}_createCloseButton(){this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose));}_onMouseUp(t){this._update(t.point);}_onMouseMove(t){this._update(t.point);}_onDrag(t){this._update(t.point);}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._pos,i=this._container.offsetWidth,o=this._container.offsetHeight;let r;return r=e.y+t.bottom.y<o?["top"]:e.y>this._map.transform.height-o?["bottom"]:[],e.x<i/2?r.push("left"):e.x>this._map.transform.width-i/2&&r.push("right"),0===r.length?"bottom":r.join("-")}_updateClassList(){const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),this._container.className=t.join(" ");}_update(e){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Pr(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e){const i=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),o=function(e){if(e||(e=new t.pointGeometry(0,0)),"number"==typeof e){const i=Math.round(Math.sqrt(.5*Math.pow(e,2)));return {center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(i,i),"top-right":new t.pointGeometry(-i,i),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(i,-i),"bottom-right":new t.pointGeometry(-i,-i),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const i=t.pointGeometry.convert(e);return {center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return {center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}(this.options.offset),r=this._anchor=this._getAnchor(o),a=i.add(o[r]).round();this._map._requestDomTask((()=>{this._container&&r&&n.setTransform(this._container,`${Lr[r]} translate(${a.x}px,${a.y}px)`);}));}this._updateClassList();}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Jr);t&&t.focus();}_onClose(){this.remove();}_setOpacity(t){this._content&&(this._content.style.opacity=t),this._tip&&(this._tip.style.opacity=t);}},Marker:Rr,Style:je,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:wo,Evented:t.Evented,config:t.config,prewarm:function(){kt().acquire(Pt);},clearPrewarmedResources:function(){const t=Rt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Pt),Rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e;},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e;},get workerCount(){return Lt.workerCount},set workerCount(t){Lt.workerCount=t;},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e;},clearStorage(e){t.clearTileCache(e);},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Qr}));

//

var mapboxgl$1 = mapboxgl;

return mapboxgl$1;

})));
//# sourceMappingURL=mapbox-gl.js.map


/***/ }),

/***/ "./resources/css/shopper.css":
/*!***********************************!*\
  !*** ./resources/css/shopper.css ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/***/ ((module) => {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),

/***/ "./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/***/ ((module) => {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var runtime = (function (exports) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  function define(obj, key, value) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
    return obj[key];
  }
  try {
    // IE 8 has a broken Object.defineProperty that only works on DOM objects.
    define({}, "");
  } catch (err) {
    define = function(obj, key, value) {
      return obj[key] = value;
    };
  }

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  exports.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  define(IteratorPrototype, iteratorSymbol, function () {
    return this;
  });

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = GeneratorFunctionPrototype;
  define(Gp, "constructor", GeneratorFunctionPrototype);
  define(GeneratorFunctionPrototype, "constructor", GeneratorFunction);
  GeneratorFunction.displayName = define(
    GeneratorFunctionPrototype,
    toStringTagSymbol,
    "GeneratorFunction"
  );

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      define(prototype, method, function(arg) {
        return this._invoke(method, arg);
      });
    });
  }

  exports.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  exports.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      define(genFun, toStringTagSymbol, "GeneratorFunction");
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  exports.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator, PromiseImpl) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return PromiseImpl.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return PromiseImpl.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration.
          result.value = unwrapped;
          resolve(result);
        }, function(error) {
          // If a rejected Promise was yielded, throw the rejection back
          // into the async generator function so it can be handled there.
          return invoke("throw", error, resolve, reject);
        });
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new PromiseImpl(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {
    return this;
  });
  exports.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {
    if (PromiseImpl === void 0) PromiseImpl = Promise;

    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList),
      PromiseImpl
    );

    return exports.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        // Note: ["return"] must be used for ES3 parsing compatibility.
        if (delegate.iterator["return"]) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  define(Gp, toStringTagSymbol, "Generator");

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  define(Gp, iteratorSymbol, function() {
    return this;
  });

  define(Gp, "toString", function() {
    return "[object Generator]";
  });

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  exports.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  exports.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };

  // Regardless of whether this script is executing as a CommonJS module
  // or not, return the runtime object so that we can declare the variable
  // regeneratorRuntime in the outer scope, which allows this module to be
  // injected easily by `bin/regenerator --include-runtime script.js`.
  return exports;

}(
  // If this script is executing as a CommonJS module, use module.exports
  // as the regeneratorRuntime namespace. Otherwise create a new empty
  // object. Either way, the resulting object will be used to initialize
  // the regeneratorRuntime variable at the top of this file.
   true ? module.exports : 0
));

try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  // This module should not be running in strict mode, so the above
  // assignment should always work unless something is misconfigured. Just
  // in case runtime.js accidentally runs in strict mode, in modern engines
  // we can explicitly access globalThis. In older engines we can escape
  // strict mode using a global Function call. This could conceivably fail
  // if a Content Security Policy forbids using Function, but in that case
  // the proper solution is to fix the accidental strict mode problem. If
  // you've misconfigured your bundler to force strict mode and applied a
  // CSP to forbid Function, and you're not willing to fix either of those
  // problems, please detail your unique predicament in a GitHub issue.
  if (typeof globalThis === "object") {
    globalThis.regeneratorRuntime = runtime;
  } else {
    Function("r", "regeneratorRuntime = r")(runtime);
  }
}


/***/ }),

/***/ "./node_modules/sortablejs/modular/sortable.esm.js":
/*!*********************************************************!*\
  !*** ./node_modules/sortablejs/modular/sortable.esm.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   "MultiDrag": () => (/* binding */ MultiDragPlugin),
/* harmony export */   "Sortable": () => (/* binding */ Sortable),
/* harmony export */   "Swap": () => (/* binding */ SwapPlugin)
/* harmony export */ });
/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);

    if (enumerableOnly) {
      symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    }

    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _typeof(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof = function (obj) {
      return typeof obj;
    };
  } else {
    _typeof = function (obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof(obj);
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

function _objectWithoutProperties(source, excluded) {
  if (source == null) return {};

  var target = _objectWithoutPropertiesLoose(source, excluded);

  var key, i;

  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }

  return target;
}

function _toConsumableArray(arr) {
  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}

function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}

function _iterableToArray(iter) {
  if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}

function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}

function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

  return arr2;
}

function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}

var version = "1.15.0";

function userAgent(pattern) {
  if (typeof window !== 'undefined' && window.navigator) {
    return !! /*@__PURE__*/navigator.userAgent.match(pattern);
  }
}

var IE11OrLess = userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i);
var Edge = userAgent(/Edge/i);
var FireFox = userAgent(/firefox/i);
var Safari = userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);
var IOS = userAgent(/iP(ad|od|hone)/i);
var ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);

var captureMode = {
  capture: false,
  passive: false
};

function on(el, event, fn) {
  el.addEventListener(event, fn, !IE11OrLess && captureMode);
}

function off(el, event, fn) {
  el.removeEventListener(event, fn, !IE11OrLess && captureMode);
}

function matches(
/**HTMLElement*/
el,
/**String*/
selector) {
  if (!selector) return;
  selector[0] === '>' && (selector = selector.substring(1));

  if (el) {
    try {
      if (el.matches) {
        return el.matches(selector);
      } else if (el.msMatchesSelector) {
        return el.msMatchesSelector(selector);
      } else if (el.webkitMatchesSelector) {
        return el.webkitMatchesSelector(selector);
      }
    } catch (_) {
      return false;
    }
  }

  return false;
}

function getParentOrHost(el) {
  return el.host && el !== document && el.host.nodeType ? el.host : el.parentNode;
}

function closest(
/**HTMLElement*/
el,
/**String*/
selector,
/**HTMLElement*/
ctx, includeCTX) {
  if (el) {
    ctx = ctx || document;

    do {
      if (selector != null && (selector[0] === '>' ? el.parentNode === ctx && matches(el, selector) : matches(el, selector)) || includeCTX && el === ctx) {
        return el;
      }

      if (el === ctx) break;
      /* jshint boss:true */
    } while (el = getParentOrHost(el));
  }

  return null;
}

var R_SPACE = /\s+/g;

function toggleClass(el, name, state) {
  if (el && name) {
    if (el.classList) {
      el.classList[state ? 'add' : 'remove'](name);
    } else {
      var className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');
      el.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');
    }
  }
}

function css(el, prop, val) {
  var style = el && el.style;

  if (style) {
    if (val === void 0) {
      if (document.defaultView && document.defaultView.getComputedStyle) {
        val = document.defaultView.getComputedStyle(el, '');
      } else if (el.currentStyle) {
        val = el.currentStyle;
      }

      return prop === void 0 ? val : val[prop];
    } else {
      if (!(prop in style) && prop.indexOf('webkit') === -1) {
        prop = '-webkit-' + prop;
      }

      style[prop] = val + (typeof val === 'string' ? '' : 'px');
    }
  }
}

function matrix(el, selfOnly) {
  var appliedTransforms = '';

  if (typeof el === 'string') {
    appliedTransforms = el;
  } else {
    do {
      var transform = css(el, 'transform');

      if (transform && transform !== 'none') {
        appliedTransforms = transform + ' ' + appliedTransforms;
      }
      /* jshint boss:true */

    } while (!selfOnly && (el = el.parentNode));
  }

  var matrixFn = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;
  /*jshint -W056 */

  return matrixFn && new matrixFn(appliedTransforms);
}

function find(ctx, tagName, iterator) {
  if (ctx) {
    var list = ctx.getElementsByTagName(tagName),
        i = 0,
        n = list.length;

    if (iterator) {
      for (; i < n; i++) {
        iterator(list[i], i);
      }
    }

    return list;
  }

  return [];
}

function getWindowScrollingElement() {
  var scrollingElement = document.scrollingElement;

  if (scrollingElement) {
    return scrollingElement;
  } else {
    return document.documentElement;
  }
}
/**
 * Returns the "bounding client rect" of given element
 * @param  {HTMLElement} el                       The element whose boundingClientRect is wanted
 * @param  {[Boolean]} relativeToContainingBlock  Whether the rect should be relative to the containing block of (including) the container
 * @param  {[Boolean]} relativeToNonStaticParent  Whether the rect should be relative to the relative parent of (including) the contaienr
 * @param  {[Boolean]} undoScale                  Whether the container's scale() should be undone
 * @param  {[HTMLElement]} container              The parent the element will be placed in
 * @return {Object}                               The boundingClientRect of el, with specified adjustments
 */


function getRect(el, relativeToContainingBlock, relativeToNonStaticParent, undoScale, container) {
  if (!el.getBoundingClientRect && el !== window) return;
  var elRect, top, left, bottom, right, height, width;

  if (el !== window && el.parentNode && el !== getWindowScrollingElement()) {
    elRect = el.getBoundingClientRect();
    top = elRect.top;
    left = elRect.left;
    bottom = elRect.bottom;
    right = elRect.right;
    height = elRect.height;
    width = elRect.width;
  } else {
    top = 0;
    left = 0;
    bottom = window.innerHeight;
    right = window.innerWidth;
    height = window.innerHeight;
    width = window.innerWidth;
  }

  if ((relativeToContainingBlock || relativeToNonStaticParent) && el !== window) {
    // Adjust for translate()
    container = container || el.parentNode; // solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)
    // Not needed on <= IE11

    if (!IE11OrLess) {
      do {
        if (container && container.getBoundingClientRect && (css(container, 'transform') !== 'none' || relativeToNonStaticParent && css(container, 'position') !== 'static')) {
          var containerRect = container.getBoundingClientRect(); // Set relative to edges of padding box of container

          top -= containerRect.top + parseInt(css(container, 'border-top-width'));
          left -= containerRect.left + parseInt(css(container, 'border-left-width'));
          bottom = top + elRect.height;
          right = left + elRect.width;
          break;
        }
        /* jshint boss:true */

      } while (container = container.parentNode);
    }
  }

  if (undoScale && el !== window) {
    // Adjust for scale()
    var elMatrix = matrix(container || el),
        scaleX = elMatrix && elMatrix.a,
        scaleY = elMatrix && elMatrix.d;

    if (elMatrix) {
      top /= scaleY;
      left /= scaleX;
      width /= scaleX;
      height /= scaleY;
      bottom = top + height;
      right = left + width;
    }
  }

  return {
    top: top,
    left: left,
    bottom: bottom,
    right: right,
    width: width,
    height: height
  };
}
/**
 * Checks if a side of an element is scrolled past a side of its parents
 * @param  {HTMLElement}  el           The element who's side being scrolled out of view is in question
 * @param  {String}       elSide       Side of the element in question ('top', 'left', 'right', 'bottom')
 * @param  {String}       parentSide   Side of the parent in question ('top', 'left', 'right', 'bottom')
 * @return {HTMLElement}               The parent scroll element that the el's side is scrolled past, or null if there is no such element
 */


function isScrolledPast(el, elSide, parentSide) {
  var parent = getParentAutoScrollElement(el, true),
      elSideVal = getRect(el)[elSide];
  /* jshint boss:true */

  while (parent) {
    var parentSideVal = getRect(parent)[parentSide],
        visible = void 0;

    if (parentSide === 'top' || parentSide === 'left') {
      visible = elSideVal >= parentSideVal;
    } else {
      visible = elSideVal <= parentSideVal;
    }

    if (!visible) return parent;
    if (parent === getWindowScrollingElement()) break;
    parent = getParentAutoScrollElement(parent, false);
  }

  return false;
}
/**
 * Gets nth child of el, ignoring hidden children, sortable's elements (does not ignore clone if it's visible)
 * and non-draggable elements
 * @param  {HTMLElement} el       The parent element
 * @param  {Number} childNum      The index of the child
 * @param  {Object} options       Parent Sortable's options
 * @return {HTMLElement}          The child at index childNum, or null if not found
 */


function getChild(el, childNum, options, includeDragEl) {
  var currentChild = 0,
      i = 0,
      children = el.children;

  while (i < children.length) {
    if (children[i].style.display !== 'none' && children[i] !== Sortable.ghost && (includeDragEl || children[i] !== Sortable.dragged) && closest(children[i], options.draggable, el, false)) {
      if (currentChild === childNum) {
        return children[i];
      }

      currentChild++;
    }

    i++;
  }

  return null;
}
/**
 * Gets the last child in the el, ignoring ghostEl or invisible elements (clones)
 * @param  {HTMLElement} el       Parent element
 * @param  {selector} selector    Any other elements that should be ignored
 * @return {HTMLElement}          The last child, ignoring ghostEl
 */


function lastChild(el, selector) {
  var last = el.lastElementChild;

  while (last && (last === Sortable.ghost || css(last, 'display') === 'none' || selector && !matches(last, selector))) {
    last = last.previousElementSibling;
  }

  return last || null;
}
/**
 * Returns the index of an element within its parent for a selected set of
 * elements
 * @param  {HTMLElement} el
 * @param  {selector} selector
 * @return {number}
 */


function index(el, selector) {
  var index = 0;

  if (!el || !el.parentNode) {
    return -1;
  }
  /* jshint boss:true */


  while (el = el.previousElementSibling) {
    if (el.nodeName.toUpperCase() !== 'TEMPLATE' && el !== Sortable.clone && (!selector || matches(el, selector))) {
      index++;
    }
  }

  return index;
}
/**
 * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.
 * The value is returned in real pixels.
 * @param  {HTMLElement} el
 * @return {Array}             Offsets in the format of [left, top]
 */


function getRelativeScrollOffset(el) {
  var offsetLeft = 0,
      offsetTop = 0,
      winScroller = getWindowScrollingElement();

  if (el) {
    do {
      var elMatrix = matrix(el),
          scaleX = elMatrix.a,
          scaleY = elMatrix.d;
      offsetLeft += el.scrollLeft * scaleX;
      offsetTop += el.scrollTop * scaleY;
    } while (el !== winScroller && (el = el.parentNode));
  }

  return [offsetLeft, offsetTop];
}
/**
 * Returns the index of the object within the given array
 * @param  {Array} arr   Array that may or may not hold the object
 * @param  {Object} obj  An object that has a key-value pair unique to and identical to a key-value pair in the object you want to find
 * @return {Number}      The index of the object in the array, or -1
 */


function indexOfObject(arr, obj) {
  for (var i in arr) {
    if (!arr.hasOwnProperty(i)) continue;

    for (var key in obj) {
      if (obj.hasOwnProperty(key) && obj[key] === arr[i][key]) return Number(i);
    }
  }

  return -1;
}

function getParentAutoScrollElement(el, includeSelf) {
  // skip to window
  if (!el || !el.getBoundingClientRect) return getWindowScrollingElement();
  var elem = el;
  var gotSelf = false;

  do {
    // we don't need to get elem css if it isn't even overflowing in the first place (performance)
    if (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {
      var elemCSS = css(elem);

      if (elem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') || elem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')) {
        if (!elem.getBoundingClientRect || elem === document.body) return getWindowScrollingElement();
        if (gotSelf || includeSelf) return elem;
        gotSelf = true;
      }
    }
    /* jshint boss:true */

  } while (elem = elem.parentNode);

  return getWindowScrollingElement();
}

function extend(dst, src) {
  if (dst && src) {
    for (var key in src) {
      if (src.hasOwnProperty(key)) {
        dst[key] = src[key];
      }
    }
  }

  return dst;
}

function isRectEqual(rect1, rect2) {
  return Math.round(rect1.top) === Math.round(rect2.top) && Math.round(rect1.left) === Math.round(rect2.left) && Math.round(rect1.height) === Math.round(rect2.height) && Math.round(rect1.width) === Math.round(rect2.width);
}

var _throttleTimeout;

function throttle(callback, ms) {
  return function () {
    if (!_throttleTimeout) {
      var args = arguments,
          _this = this;

      if (args.length === 1) {
        callback.call(_this, args[0]);
      } else {
        callback.apply(_this, args);
      }

      _throttleTimeout = setTimeout(function () {
        _throttleTimeout = void 0;
      }, ms);
    }
  };
}

function cancelThrottle() {
  clearTimeout(_throttleTimeout);
  _throttleTimeout = void 0;
}

function scrollBy(el, x, y) {
  el.scrollLeft += x;
  el.scrollTop += y;
}

function clone(el) {
  var Polymer = window.Polymer;
  var $ = window.jQuery || window.Zepto;

  if (Polymer && Polymer.dom) {
    return Polymer.dom(el).cloneNode(true);
  } else if ($) {
    return $(el).clone(true)[0];
  } else {
    return el.cloneNode(true);
  }
}

function setRect(el, rect) {
  css(el, 'position', 'absolute');
  css(el, 'top', rect.top);
  css(el, 'left', rect.left);
  css(el, 'width', rect.width);
  css(el, 'height', rect.height);
}

function unsetRect(el) {
  css(el, 'position', '');
  css(el, 'top', '');
  css(el, 'left', '');
  css(el, 'width', '');
  css(el, 'height', '');
}

var expando = 'Sortable' + new Date().getTime();

function AnimationStateManager() {
  var animationStates = [],
      animationCallbackId;
  return {
    captureAnimationState: function captureAnimationState() {
      animationStates = [];
      if (!this.options.animation) return;
      var children = [].slice.call(this.el.children);
      children.forEach(function (child) {
        if (css(child, 'display') === 'none' || child === Sortable.ghost) return;
        animationStates.push({
          target: child,
          rect: getRect(child)
        });

        var fromRect = _objectSpread2({}, animationStates[animationStates.length - 1].rect); // If animating: compensate for current animation


        if (child.thisAnimationDuration) {
          var childMatrix = matrix(child, true);

          if (childMatrix) {
            fromRect.top -= childMatrix.f;
            fromRect.left -= childMatrix.e;
          }
        }

        child.fromRect = fromRect;
      });
    },
    addAnimationState: function addAnimationState(state) {
      animationStates.push(state);
    },
    removeAnimationState: function removeAnimationState(target) {
      animationStates.splice(indexOfObject(animationStates, {
        target: target
      }), 1);
    },
    animateAll: function animateAll(callback) {
      var _this = this;

      if (!this.options.animation) {
        clearTimeout(animationCallbackId);
        if (typeof callback === 'function') callback();
        return;
      }

      var animating = false,
          animationTime = 0;
      animationStates.forEach(function (state) {
        var time = 0,
            target = state.target,
            fromRect = target.fromRect,
            toRect = getRect(target),
            prevFromRect = target.prevFromRect,
            prevToRect = target.prevToRect,
            animatingRect = state.rect,
            targetMatrix = matrix(target, true);

        if (targetMatrix) {
          // Compensate for current animation
          toRect.top -= targetMatrix.f;
          toRect.left -= targetMatrix.e;
        }

        target.toRect = toRect;

        if (target.thisAnimationDuration) {
          // Could also check if animatingRect is between fromRect and toRect
          if (isRectEqual(prevFromRect, toRect) && !isRectEqual(fromRect, toRect) && // Make sure animatingRect is on line between toRect & fromRect
          (animatingRect.top - toRect.top) / (animatingRect.left - toRect.left) === (fromRect.top - toRect.top) / (fromRect.left - toRect.left)) {
            // If returning to same place as started from animation and on same axis
            time = calculateRealTime(animatingRect, prevFromRect, prevToRect, _this.options);
          }
        } // if fromRect != toRect: animate


        if (!isRectEqual(toRect, fromRect)) {
          target.prevFromRect = fromRect;
          target.prevToRect = toRect;

          if (!time) {
            time = _this.options.animation;
          }

          _this.animate(target, animatingRect, toRect, time);
        }

        if (time) {
          animating = true;
          animationTime = Math.max(animationTime, time);
          clearTimeout(target.animationResetTimer);
          target.animationResetTimer = setTimeout(function () {
            target.animationTime = 0;
            target.prevFromRect = null;
            target.fromRect = null;
            target.prevToRect = null;
            target.thisAnimationDuration = null;
          }, time);
          target.thisAnimationDuration = time;
        }
      });
      clearTimeout(animationCallbackId);

      if (!animating) {
        if (typeof callback === 'function') callback();
      } else {
        animationCallbackId = setTimeout(function () {
          if (typeof callback === 'function') callback();
        }, animationTime);
      }

      animationStates = [];
    },
    animate: function animate(target, currentRect, toRect, duration) {
      if (duration) {
        css(target, 'transition', '');
        css(target, 'transform', '');
        var elMatrix = matrix(this.el),
            scaleX = elMatrix && elMatrix.a,
            scaleY = elMatrix && elMatrix.d,
            translateX = (currentRect.left - toRect.left) / (scaleX || 1),
            translateY = (currentRect.top - toRect.top) / (scaleY || 1);
        target.animatingX = !!translateX;
        target.animatingY = !!translateY;
        css(target, 'transform', 'translate3d(' + translateX + 'px,' + translateY + 'px,0)');
        this.forRepaintDummy = repaint(target); // repaint

        css(target, 'transition', 'transform ' + duration + 'ms' + (this.options.easing ? ' ' + this.options.easing : ''));
        css(target, 'transform', 'translate3d(0,0,0)');
        typeof target.animated === 'number' && clearTimeout(target.animated);
        target.animated = setTimeout(function () {
          css(target, 'transition', '');
          css(target, 'transform', '');
          target.animated = false;
          target.animatingX = false;
          target.animatingY = false;
        }, duration);
      }
    }
  };
}

function repaint(target) {
  return target.offsetWidth;
}

function calculateRealTime(animatingRect, fromRect, toRect, options) {
  return Math.sqrt(Math.pow(fromRect.top - animatingRect.top, 2) + Math.pow(fromRect.left - animatingRect.left, 2)) / Math.sqrt(Math.pow(fromRect.top - toRect.top, 2) + Math.pow(fromRect.left - toRect.left, 2)) * options.animation;
}

var plugins = [];
var defaults = {
  initializeByDefault: true
};
var PluginManager = {
  mount: function mount(plugin) {
    // Set default static properties
    for (var option in defaults) {
      if (defaults.hasOwnProperty(option) && !(option in plugin)) {
        plugin[option] = defaults[option];
      }
    }

    plugins.forEach(function (p) {
      if (p.pluginName === plugin.pluginName) {
        throw "Sortable: Cannot mount plugin ".concat(plugin.pluginName, " more than once");
      }
    });
    plugins.push(plugin);
  },
  pluginEvent: function pluginEvent(eventName, sortable, evt) {
    var _this = this;

    this.eventCanceled = false;

    evt.cancel = function () {
      _this.eventCanceled = true;
    };

    var eventNameGlobal = eventName + 'Global';
    plugins.forEach(function (plugin) {
      if (!sortable[plugin.pluginName]) return; // Fire global events if it exists in this sortable

      if (sortable[plugin.pluginName][eventNameGlobal]) {
        sortable[plugin.pluginName][eventNameGlobal](_objectSpread2({
          sortable: sortable
        }, evt));
      } // Only fire plugin event if plugin is enabled in this sortable,
      // and plugin has event defined


      if (sortable.options[plugin.pluginName] && sortable[plugin.pluginName][eventName]) {
        sortable[plugin.pluginName][eventName](_objectSpread2({
          sortable: sortable
        }, evt));
      }
    });
  },
  initializePlugins: function initializePlugins(sortable, el, defaults, options) {
    plugins.forEach(function (plugin) {
      var pluginName = plugin.pluginName;
      if (!sortable.options[pluginName] && !plugin.initializeByDefault) return;
      var initialized = new plugin(sortable, el, sortable.options);
      initialized.sortable = sortable;
      initialized.options = sortable.options;
      sortable[pluginName] = initialized; // Add default options from plugin

      _extends(defaults, initialized.defaults);
    });

    for (var option in sortable.options) {
      if (!sortable.options.hasOwnProperty(option)) continue;
      var modified = this.modifyOption(sortable, option, sortable.options[option]);

      if (typeof modified !== 'undefined') {
        sortable.options[option] = modified;
      }
    }
  },
  getEventProperties: function getEventProperties(name, sortable) {
    var eventProperties = {};
    plugins.forEach(function (plugin) {
      if (typeof plugin.eventProperties !== 'function') return;

      _extends(eventProperties, plugin.eventProperties.call(sortable[plugin.pluginName], name));
    });
    return eventProperties;
  },
  modifyOption: function modifyOption(sortable, name, value) {
    var modifiedValue;
    plugins.forEach(function (plugin) {
      // Plugin must exist on the Sortable
      if (!sortable[plugin.pluginName]) return; // If static option listener exists for this option, call in the context of the Sortable's instance of this plugin

      if (plugin.optionListeners && typeof plugin.optionListeners[name] === 'function') {
        modifiedValue = plugin.optionListeners[name].call(sortable[plugin.pluginName], value);
      }
    });
    return modifiedValue;
  }
};

function dispatchEvent(_ref) {
  var sortable = _ref.sortable,
      rootEl = _ref.rootEl,
      name = _ref.name,
      targetEl = _ref.targetEl,
      cloneEl = _ref.cloneEl,
      toEl = _ref.toEl,
      fromEl = _ref.fromEl,
      oldIndex = _ref.oldIndex,
      newIndex = _ref.newIndex,
      oldDraggableIndex = _ref.oldDraggableIndex,
      newDraggableIndex = _ref.newDraggableIndex,
      originalEvent = _ref.originalEvent,
      putSortable = _ref.putSortable,
      extraEventProperties = _ref.extraEventProperties;
  sortable = sortable || rootEl && rootEl[expando];
  if (!sortable) return;
  var evt,
      options = sortable.options,
      onName = 'on' + name.charAt(0).toUpperCase() + name.substr(1); // Support for new CustomEvent feature

  if (window.CustomEvent && !IE11OrLess && !Edge) {
    evt = new CustomEvent(name, {
      bubbles: true,
      cancelable: true
    });
  } else {
    evt = document.createEvent('Event');
    evt.initEvent(name, true, true);
  }

  evt.to = toEl || rootEl;
  evt.from = fromEl || rootEl;
  evt.item = targetEl || rootEl;
  evt.clone = cloneEl;
  evt.oldIndex = oldIndex;
  evt.newIndex = newIndex;
  evt.oldDraggableIndex = oldDraggableIndex;
  evt.newDraggableIndex = newDraggableIndex;
  evt.originalEvent = originalEvent;
  evt.pullMode = putSortable ? putSortable.lastPutMode : undefined;

  var allEventProperties = _objectSpread2(_objectSpread2({}, extraEventProperties), PluginManager.getEventProperties(name, sortable));

  for (var option in allEventProperties) {
    evt[option] = allEventProperties[option];
  }

  if (rootEl) {
    rootEl.dispatchEvent(evt);
  }

  if (options[onName]) {
    options[onName].call(sortable, evt);
  }
}

var _excluded = ["evt"];

var pluginEvent = function pluginEvent(eventName, sortable) {
  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
      originalEvent = _ref.evt,
      data = _objectWithoutProperties(_ref, _excluded);

  PluginManager.pluginEvent.bind(Sortable)(eventName, sortable, _objectSpread2({
    dragEl: dragEl,
    parentEl: parentEl,
    ghostEl: ghostEl,
    rootEl: rootEl,
    nextEl: nextEl,
    lastDownEl: lastDownEl,
    cloneEl: cloneEl,
    cloneHidden: cloneHidden,
    dragStarted: moved,
    putSortable: putSortable,
    activeSortable: Sortable.active,
    originalEvent: originalEvent,
    oldIndex: oldIndex,
    oldDraggableIndex: oldDraggableIndex,
    newIndex: newIndex,
    newDraggableIndex: newDraggableIndex,
    hideGhostForTarget: _hideGhostForTarget,
    unhideGhostForTarget: _unhideGhostForTarget,
    cloneNowHidden: function cloneNowHidden() {
      cloneHidden = true;
    },
    cloneNowShown: function cloneNowShown() {
      cloneHidden = false;
    },
    dispatchSortableEvent: function dispatchSortableEvent(name) {
      _dispatchEvent({
        sortable: sortable,
        name: name,
        originalEvent: originalEvent
      });
    }
  }, data));
};

function _dispatchEvent(info) {
  dispatchEvent(_objectSpread2({
    putSortable: putSortable,
    cloneEl: cloneEl,
    targetEl: dragEl,
    rootEl: rootEl,
    oldIndex: oldIndex,
    oldDraggableIndex: oldDraggableIndex,
    newIndex: newIndex,
    newDraggableIndex: newDraggableIndex
  }, info));
}

var dragEl,
    parentEl,
    ghostEl,
    rootEl,
    nextEl,
    lastDownEl,
    cloneEl,
    cloneHidden,
    oldIndex,
    newIndex,
    oldDraggableIndex,
    newDraggableIndex,
    activeGroup,
    putSortable,
    awaitingDragStarted = false,
    ignoreNextClick = false,
    sortables = [],
    tapEvt,
    touchEvt,
    lastDx,
    lastDy,
    tapDistanceLeft,
    tapDistanceTop,
    moved,
    lastTarget,
    lastDirection,
    pastFirstInvertThresh = false,
    isCircumstantialInvert = false,
    targetMoveDistance,
    // For positioning ghost absolutely
ghostRelativeParent,
    ghostRelativeParentInitialScroll = [],
    // (left, top)
_silent = false,
    savedInputChecked = [];
/** @const */

var documentExists = typeof document !== 'undefined',
    PositionGhostAbsolutely = IOS,
    CSSFloatProperty = Edge || IE11OrLess ? 'cssFloat' : 'float',
    // This will not pass for IE9, because IE9 DnD only works on anchors
supportDraggable = documentExists && !ChromeForAndroid && !IOS && 'draggable' in document.createElement('div'),
    supportCssPointerEvents = function () {
  if (!documentExists) return; // false when <= IE11

  if (IE11OrLess) {
    return false;
  }

  var el = document.createElement('x');
  el.style.cssText = 'pointer-events:auto';
  return el.style.pointerEvents === 'auto';
}(),
    _detectDirection = function _detectDirection(el, options) {
  var elCSS = css(el),
      elWidth = parseInt(elCSS.width) - parseInt(elCSS.paddingLeft) - parseInt(elCSS.paddingRight) - parseInt(elCSS.borderLeftWidth) - parseInt(elCSS.borderRightWidth),
      child1 = getChild(el, 0, options),
      child2 = getChild(el, 1, options),
      firstChildCSS = child1 && css(child1),
      secondChildCSS = child2 && css(child2),
      firstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + getRect(child1).width,
      secondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + getRect(child2).width;

  if (elCSS.display === 'flex') {
    return elCSS.flexDirection === 'column' || elCSS.flexDirection === 'column-reverse' ? 'vertical' : 'horizontal';
  }

  if (elCSS.display === 'grid') {
    return elCSS.gridTemplateColumns.split(' ').length <= 1 ? 'vertical' : 'horizontal';
  }

  if (child1 && firstChildCSS["float"] && firstChildCSS["float"] !== 'none') {
    var touchingSideChild2 = firstChildCSS["float"] === 'left' ? 'left' : 'right';
    return child2 && (secondChildCSS.clear === 'both' || secondChildCSS.clear === touchingSideChild2) ? 'vertical' : 'horizontal';
  }

  return child1 && (firstChildCSS.display === 'block' || firstChildCSS.display === 'flex' || firstChildCSS.display === 'table' || firstChildCSS.display === 'grid' || firstChildWidth >= elWidth && elCSS[CSSFloatProperty] === 'none' || child2 && elCSS[CSSFloatProperty] === 'none' && firstChildWidth + secondChildWidth > elWidth) ? 'vertical' : 'horizontal';
},
    _dragElInRowColumn = function _dragElInRowColumn(dragRect, targetRect, vertical) {
  var dragElS1Opp = vertical ? dragRect.left : dragRect.top,
      dragElS2Opp = vertical ? dragRect.right : dragRect.bottom,
      dragElOppLength = vertical ? dragRect.width : dragRect.height,
      targetS1Opp = vertical ? targetRect.left : targetRect.top,
      targetS2Opp = vertical ? targetRect.right : targetRect.bottom,
      targetOppLength = vertical ? targetRect.width : targetRect.height;
  return dragElS1Opp === targetS1Opp || dragElS2Opp === targetS2Opp || dragElS1Opp + dragElOppLength / 2 === targetS1Opp + targetOppLength / 2;
},

/**
 * Detects first nearest empty sortable to X and Y position using emptyInsertThreshold.
 * @param  {Number} x      X position
 * @param  {Number} y      Y position
 * @return {HTMLElement}   Element of the first found nearest Sortable
 */
_detectNearestEmptySortable = function _detectNearestEmptySortable(x, y) {
  var ret;
  sortables.some(function (sortable) {
    var threshold = sortable[expando].options.emptyInsertThreshold;
    if (!threshold || lastChild(sortable)) return;
    var rect = getRect(sortable),
        insideHorizontally = x >= rect.left - threshold && x <= rect.right + threshold,
        insideVertically = y >= rect.top - threshold && y <= rect.bottom + threshold;

    if (insideHorizontally && insideVertically) {
      return ret = sortable;
    }
  });
  return ret;
},
    _prepareGroup = function _prepareGroup(options) {
  function toFn(value, pull) {
    return function (to, from, dragEl, evt) {
      var sameGroup = to.options.group.name && from.options.group.name && to.options.group.name === from.options.group.name;

      if (value == null && (pull || sameGroup)) {
        // Default pull value
        // Default pull and put value if same group
        return true;
      } else if (value == null || value === false) {
        return false;
      } else if (pull && value === 'clone') {
        return value;
      } else if (typeof value === 'function') {
        return toFn(value(to, from, dragEl, evt), pull)(to, from, dragEl, evt);
      } else {
        var otherGroup = (pull ? to : from).options.group.name;
        return value === true || typeof value === 'string' && value === otherGroup || value.join && value.indexOf(otherGroup) > -1;
      }
    };
  }

  var group = {};
  var originalGroup = options.group;

  if (!originalGroup || _typeof(originalGroup) != 'object') {
    originalGroup = {
      name: originalGroup
    };
  }

  group.name = originalGroup.name;
  group.checkPull = toFn(originalGroup.pull, true);
  group.checkPut = toFn(originalGroup.put);
  group.revertClone = originalGroup.revertClone;
  options.group = group;
},
    _hideGhostForTarget = function _hideGhostForTarget() {
  if (!supportCssPointerEvents && ghostEl) {
    css(ghostEl, 'display', 'none');
  }
},
    _unhideGhostForTarget = function _unhideGhostForTarget() {
  if (!supportCssPointerEvents && ghostEl) {
    css(ghostEl, 'display', '');
  }
}; // #1184 fix - Prevent click event on fallback if dragged but item not changed position


if (documentExists && !ChromeForAndroid) {
  document.addEventListener('click', function (evt) {
    if (ignoreNextClick) {
      evt.preventDefault();
      evt.stopPropagation && evt.stopPropagation();
      evt.stopImmediatePropagation && evt.stopImmediatePropagation();
      ignoreNextClick = false;
      return false;
    }
  }, true);
}

var nearestEmptyInsertDetectEvent = function nearestEmptyInsertDetectEvent(evt) {
  if (dragEl) {
    evt = evt.touches ? evt.touches[0] : evt;

    var nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);

    if (nearest) {
      // Create imitation event
      var event = {};

      for (var i in evt) {
        if (evt.hasOwnProperty(i)) {
          event[i] = evt[i];
        }
      }

      event.target = event.rootEl = nearest;
      event.preventDefault = void 0;
      event.stopPropagation = void 0;

      nearest[expando]._onDragOver(event);
    }
  }
};

var _checkOutsideTargetEl = function _checkOutsideTargetEl(evt) {
  if (dragEl) {
    dragEl.parentNode[expando]._isOutsideThisEl(evt.target);
  }
};
/**
 * @class  Sortable
 * @param  {HTMLElement}  el
 * @param  {Object}       [options]
 */


function Sortable(el, options) {
  if (!(el && el.nodeType && el.nodeType === 1)) {
    throw "Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(el));
  }

  this.el = el; // root element

  this.options = options = _extends({}, options); // Export instance

  el[expando] = this;
  var defaults = {
    group: null,
    sort: true,
    disabled: false,
    store: null,
    handle: null,
    draggable: /^[uo]l$/i.test(el.nodeName) ? '>li' : '>*',
    swapThreshold: 1,
    // percentage; 0 <= x <= 1
    invertSwap: false,
    // invert always
    invertedSwapThreshold: null,
    // will be set to same as swapThreshold if default
    removeCloneOnHide: true,
    direction: function direction() {
      return _detectDirection(el, this.options);
    },
    ghostClass: 'sortable-ghost',
    chosenClass: 'sortable-chosen',
    dragClass: 'sortable-drag',
    ignore: 'a, img',
    filter: null,
    preventOnFilter: true,
    animation: 0,
    easing: null,
    setData: function setData(dataTransfer, dragEl) {
      dataTransfer.setData('Text', dragEl.textContent);
    },
    dropBubble: false,
    dragoverBubble: false,
    dataIdAttr: 'data-id',
    delay: 0,
    delayOnTouchOnly: false,
    touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1,
    forceFallback: false,
    fallbackClass: 'sortable-fallback',
    fallbackOnBody: false,
    fallbackTolerance: 0,
    fallbackOffset: {
      x: 0,
      y: 0
    },
    supportPointer: Sortable.supportPointer !== false && 'PointerEvent' in window && !Safari,
    emptyInsertThreshold: 5
  };
  PluginManager.initializePlugins(this, el, defaults); // Set default options

  for (var name in defaults) {
    !(name in options) && (options[name] = defaults[name]);
  }

  _prepareGroup(options); // Bind all private methods


  for (var fn in this) {
    if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {
      this[fn] = this[fn].bind(this);
    }
  } // Setup drag mode


  this.nativeDraggable = options.forceFallback ? false : supportDraggable;

  if (this.nativeDraggable) {
    // Touch start threshold cannot be greater than the native dragstart threshold
    this.options.touchStartThreshold = 1;
  } // Bind events


  if (options.supportPointer) {
    on(el, 'pointerdown', this._onTapStart);
  } else {
    on(el, 'mousedown', this._onTapStart);
    on(el, 'touchstart', this._onTapStart);
  }

  if (this.nativeDraggable) {
    on(el, 'dragover', this);
    on(el, 'dragenter', this);
  }

  sortables.push(this.el); // Restore sorting

  options.store && options.store.get && this.sort(options.store.get(this) || []); // Add animation state manager

  _extends(this, AnimationStateManager());
}

Sortable.prototype =
/** @lends Sortable.prototype */
{
  constructor: Sortable,
  _isOutsideThisEl: function _isOutsideThisEl(target) {
    if (!this.el.contains(target) && target !== this.el) {
      lastTarget = null;
    }
  },
  _getDirection: function _getDirection(evt, target) {
    return typeof this.options.direction === 'function' ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;
  },
  _onTapStart: function _onTapStart(
  /** Event|TouchEvent */
  evt) {
    if (!evt.cancelable) return;

    var _this = this,
        el = this.el,
        options = this.options,
        preventOnFilter = options.preventOnFilter,
        type = evt.type,
        touch = evt.touches && evt.touches[0] || evt.pointerType && evt.pointerType === 'touch' && evt,
        target = (touch || evt).target,
        originalTarget = evt.target.shadowRoot && (evt.path && evt.path[0] || evt.composedPath && evt.composedPath()[0]) || target,
        filter = options.filter;

    _saveInputCheckedState(el); // Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.


    if (dragEl) {
      return;
    }

    if (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {
      return; // only left button and enabled
    } // cancel dnd if original target is content editable


    if (originalTarget.isContentEditable) {
      return;
    } // Safari ignores further event handling after mousedown


    if (!this.nativeDraggable && Safari && target && target.tagName.toUpperCase() === 'SELECT') {
      return;
    }

    target = closest(target, options.draggable, el, false);

    if (target && target.animated) {
      return;
    }

    if (lastDownEl === target) {
      // Ignoring duplicate `down`
      return;
    } // Get the index of the dragged element within its parent


    oldIndex = index(target);
    oldDraggableIndex = index(target, options.draggable); // Check filter

    if (typeof filter === 'function') {
      if (filter.call(this, evt, target, this)) {
        _dispatchEvent({
          sortable: _this,
          rootEl: originalTarget,
          name: 'filter',
          targetEl: target,
          toEl: el,
          fromEl: el
        });

        pluginEvent('filter', _this, {
          evt: evt
        });
        preventOnFilter && evt.cancelable && evt.preventDefault();
        return; // cancel dnd
      }
    } else if (filter) {
      filter = filter.split(',').some(function (criteria) {
        criteria = closest(originalTarget, criteria.trim(), el, false);

        if (criteria) {
          _dispatchEvent({
            sortable: _this,
            rootEl: criteria,
            name: 'filter',
            targetEl: target,
            fromEl: el,
            toEl: el
          });

          pluginEvent('filter', _this, {
            evt: evt
          });
          return true;
        }
      });

      if (filter) {
        preventOnFilter && evt.cancelable && evt.preventDefault();
        return; // cancel dnd
      }
    }

    if (options.handle && !closest(originalTarget, options.handle, el, false)) {
      return;
    } // Prepare `dragstart`


    this._prepareDragStart(evt, touch, target);
  },
  _prepareDragStart: function _prepareDragStart(
  /** Event */
  evt,
  /** Touch */
  touch,
  /** HTMLElement */
  target) {
    var _this = this,
        el = _this.el,
        options = _this.options,
        ownerDocument = el.ownerDocument,
        dragStartFn;

    if (target && !dragEl && target.parentNode === el) {
      var dragRect = getRect(target);
      rootEl = el;
      dragEl = target;
      parentEl = dragEl.parentNode;
      nextEl = dragEl.nextSibling;
      lastDownEl = target;
      activeGroup = options.group;
      Sortable.dragged = dragEl;
      tapEvt = {
        target: dragEl,
        clientX: (touch || evt).clientX,
        clientY: (touch || evt).clientY
      };
      tapDistanceLeft = tapEvt.clientX - dragRect.left;
      tapDistanceTop = tapEvt.clientY - dragRect.top;
      this._lastX = (touch || evt).clientX;
      this._lastY = (touch || evt).clientY;
      dragEl.style['will-change'] = 'all';

      dragStartFn = function dragStartFn() {
        pluginEvent('delayEnded', _this, {
          evt: evt
        });

        if (Sortable.eventCanceled) {
          _this._onDrop();

          return;
        } // Delayed drag has been triggered
        // we can re-enable the events: touchmove/mousemove


        _this._disableDelayedDragEvents();

        if (!FireFox && _this.nativeDraggable) {
          dragEl.draggable = true;
        } // Bind the events: dragstart/dragend


        _this._triggerDragStart(evt, touch); // Drag start event


        _dispatchEvent({
          sortable: _this,
          name: 'choose',
          originalEvent: evt
        }); // Chosen item


        toggleClass(dragEl, options.chosenClass, true);
      }; // Disable "draggable"


      options.ignore.split(',').forEach(function (criteria) {
        find(dragEl, criteria.trim(), _disableDraggable);
      });
      on(ownerDocument, 'dragover', nearestEmptyInsertDetectEvent);
      on(ownerDocument, 'mousemove', nearestEmptyInsertDetectEvent);
      on(ownerDocument, 'touchmove', nearestEmptyInsertDetectEvent);
      on(ownerDocument, 'mouseup', _this._onDrop);
      on(ownerDocument, 'touchend', _this._onDrop);
      on(ownerDocument, 'touchcancel', _this._onDrop); // Make dragEl draggable (must be before delay for FireFox)

      if (FireFox && this.nativeDraggable) {
        this.options.touchStartThreshold = 4;
        dragEl.draggable = true;
      }

      pluginEvent('delayStart', this, {
        evt: evt
      }); // Delay is impossible for native DnD in Edge or IE

      if (options.delay && (!options.delayOnTouchOnly || touch) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {
        if (Sortable.eventCanceled) {
          this._onDrop();

          return;
        } // If the user moves the pointer or let go the click or touch
        // before the delay has been reached:
        // disable the delayed drag


        on(ownerDocument, 'mouseup', _this._disableDelayedDrag);
        on(ownerDocument, 'touchend', _this._disableDelayedDrag);
        on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);
        on(ownerDocument, 'mousemove', _this._delayedDragTouchMoveHandler);
        on(ownerDocument, 'touchmove', _this._delayedDragTouchMoveHandler);
        options.supportPointer && on(ownerDocument, 'pointermove', _this._delayedDragTouchMoveHandler);
        _this._dragStartTimer = setTimeout(dragStartFn, options.delay);
      } else {
        dragStartFn();
      }
    }
  },
  _delayedDragTouchMoveHandler: function _delayedDragTouchMoveHandler(
  /** TouchEvent|PointerEvent **/
  e) {
    var touch = e.touches ? e.touches[0] : e;

    if (Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))) {
      this._disableDelayedDrag();
    }
  },
  _disableDelayedDrag: function _disableDelayedDrag() {
    dragEl && _disableDraggable(dragEl);
    clearTimeout(this._dragStartTimer);

    this._disableDelayedDragEvents();
  },
  _disableDelayedDragEvents: function _disableDelayedDragEvents() {
    var ownerDocument = this.el.ownerDocument;
    off(ownerDocument, 'mouseup', this._disableDelayedDrag);
    off(ownerDocument, 'touchend', this._disableDelayedDrag);
    off(ownerDocument, 'touchcancel', this._disableDelayedDrag);
    off(ownerDocument, 'mousemove', this._delayedDragTouchMoveHandler);
    off(ownerDocument, 'touchmove', this._delayedDragTouchMoveHandler);
    off(ownerDocument, 'pointermove', this._delayedDragTouchMoveHandler);
  },
  _triggerDragStart: function _triggerDragStart(
  /** Event */
  evt,
  /** Touch */
  touch) {
    touch = touch || evt.pointerType == 'touch' && evt;

    if (!this.nativeDraggable || touch) {
      if (this.options.supportPointer) {
        on(document, 'pointermove', this._onTouchMove);
      } else if (touch) {
        on(document, 'touchmove', this._onTouchMove);
      } else {
        on(document, 'mousemove', this._onTouchMove);
      }
    } else {
      on(dragEl, 'dragend', this);
      on(rootEl, 'dragstart', this._onDragStart);
    }

    try {
      if (document.selection) {
        // Timeout neccessary for IE9
        _nextTick(function () {
          document.selection.empty();
        });
      } else {
        window.getSelection().removeAllRanges();
      }
    } catch (err) {}
  },
  _dragStarted: function _dragStarted(fallback, evt) {

    awaitingDragStarted = false;

    if (rootEl && dragEl) {
      pluginEvent('dragStarted', this, {
        evt: evt
      });

      if (this.nativeDraggable) {
        on(document, 'dragover', _checkOutsideTargetEl);
      }

      var options = this.options; // Apply effect

      !fallback && toggleClass(dragEl, options.dragClass, false);
      toggleClass(dragEl, options.ghostClass, true);
      Sortable.active = this;
      fallback && this._appendGhost(); // Drag start event

      _dispatchEvent({
        sortable: this,
        name: 'start',
        originalEvent: evt
      });
    } else {
      this._nulling();
    }
  },
  _emulateDragOver: function _emulateDragOver() {
    if (touchEvt) {
      this._lastX = touchEvt.clientX;
      this._lastY = touchEvt.clientY;

      _hideGhostForTarget();

      var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
      var parent = target;

      while (target && target.shadowRoot) {
        target = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);
        if (target === parent) break;
        parent = target;
      }

      dragEl.parentNode[expando]._isOutsideThisEl(target);

      if (parent) {
        do {
          if (parent[expando]) {
            var inserted = void 0;
            inserted = parent[expando]._onDragOver({
              clientX: touchEvt.clientX,
              clientY: touchEvt.clientY,
              target: target,
              rootEl: parent
            });

            if (inserted && !this.options.dragoverBubble) {
              break;
            }
          }

          target = parent; // store last element
        }
        /* jshint boss:true */
        while (parent = parent.parentNode);
      }

      _unhideGhostForTarget();
    }
  },
  _onTouchMove: function _onTouchMove(
  /**TouchEvent*/
  evt) {
    if (tapEvt) {
      var options = this.options,
          fallbackTolerance = options.fallbackTolerance,
          fallbackOffset = options.fallbackOffset,
          touch = evt.touches ? evt.touches[0] : evt,
          ghostMatrix = ghostEl && matrix(ghostEl, true),
          scaleX = ghostEl && ghostMatrix && ghostMatrix.a,
          scaleY = ghostEl && ghostMatrix && ghostMatrix.d,
          relativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && getRelativeScrollOffset(ghostRelativeParent),
          dx = (touch.clientX - tapEvt.clientX + fallbackOffset.x) / (scaleX || 1) + (relativeScrollOffset ? relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0] : 0) / (scaleX || 1),
          dy = (touch.clientY - tapEvt.clientY + fallbackOffset.y) / (scaleY || 1) + (relativeScrollOffset ? relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1] : 0) / (scaleY || 1); // only set the status to dragging, when we are actually dragging

      if (!Sortable.active && !awaitingDragStarted) {
        if (fallbackTolerance && Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) < fallbackTolerance) {
          return;
        }

        this._onDragStart(evt, true);
      }

      if (ghostEl) {
        if (ghostMatrix) {
          ghostMatrix.e += dx - (lastDx || 0);
          ghostMatrix.f += dy - (lastDy || 0);
        } else {
          ghostMatrix = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            e: dx,
            f: dy
          };
        }

        var cssMatrix = "matrix(".concat(ghostMatrix.a, ",").concat(ghostMatrix.b, ",").concat(ghostMatrix.c, ",").concat(ghostMatrix.d, ",").concat(ghostMatrix.e, ",").concat(ghostMatrix.f, ")");
        css(ghostEl, 'webkitTransform', cssMatrix);
        css(ghostEl, 'mozTransform', cssMatrix);
        css(ghostEl, 'msTransform', cssMatrix);
        css(ghostEl, 'transform', cssMatrix);
        lastDx = dx;
        lastDy = dy;
        touchEvt = touch;
      }

      evt.cancelable && evt.preventDefault();
    }
  },
  _appendGhost: function _appendGhost() {
    // Bug if using scale(): https://stackoverflow.com/questions/2637058
    // Not being adjusted for
    if (!ghostEl) {
      var container = this.options.fallbackOnBody ? document.body : rootEl,
          rect = getRect(dragEl, true, PositionGhostAbsolutely, true, container),
          options = this.options; // Position absolutely

      if (PositionGhostAbsolutely) {
        // Get relatively positioned parent
        ghostRelativeParent = container;

        while (css(ghostRelativeParent, 'position') === 'static' && css(ghostRelativeParent, 'transform') === 'none' && ghostRelativeParent !== document) {
          ghostRelativeParent = ghostRelativeParent.parentNode;
        }

        if (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {
          if (ghostRelativeParent === document) ghostRelativeParent = getWindowScrollingElement();
          rect.top += ghostRelativeParent.scrollTop;
          rect.left += ghostRelativeParent.scrollLeft;
        } else {
          ghostRelativeParent = getWindowScrollingElement();
        }

        ghostRelativeParentInitialScroll = getRelativeScrollOffset(ghostRelativeParent);
      }

      ghostEl = dragEl.cloneNode(true);
      toggleClass(ghostEl, options.ghostClass, false);
      toggleClass(ghostEl, options.fallbackClass, true);
      toggleClass(ghostEl, options.dragClass, true);
      css(ghostEl, 'transition', '');
      css(ghostEl, 'transform', '');
      css(ghostEl, 'box-sizing', 'border-box');
      css(ghostEl, 'margin', 0);
      css(ghostEl, 'top', rect.top);
      css(ghostEl, 'left', rect.left);
      css(ghostEl, 'width', rect.width);
      css(ghostEl, 'height', rect.height);
      css(ghostEl, 'opacity', '0.8');
      css(ghostEl, 'position', PositionGhostAbsolutely ? 'absolute' : 'fixed');
      css(ghostEl, 'zIndex', '100000');
      css(ghostEl, 'pointerEvents', 'none');
      Sortable.ghost = ghostEl;
      container.appendChild(ghostEl); // Set transform-origin

      css(ghostEl, 'transform-origin', tapDistanceLeft / parseInt(ghostEl.style.width) * 100 + '% ' + tapDistanceTop / parseInt(ghostEl.style.height) * 100 + '%');
    }
  },
  _onDragStart: function _onDragStart(
  /**Event*/
  evt,
  /**boolean*/
  fallback) {
    var _this = this;

    var dataTransfer = evt.dataTransfer;
    var options = _this.options;
    pluginEvent('dragStart', this, {
      evt: evt
    });

    if (Sortable.eventCanceled) {
      this._onDrop();

      return;
    }

    pluginEvent('setupClone', this);

    if (!Sortable.eventCanceled) {
      cloneEl = clone(dragEl);
      cloneEl.removeAttribute("id");
      cloneEl.draggable = false;
      cloneEl.style['will-change'] = '';

      this._hideClone();

      toggleClass(cloneEl, this.options.chosenClass, false);
      Sortable.clone = cloneEl;
    } // #1143: IFrame support workaround


    _this.cloneId = _nextTick(function () {
      pluginEvent('clone', _this);
      if (Sortable.eventCanceled) return;

      if (!_this.options.removeCloneOnHide) {
        rootEl.insertBefore(cloneEl, dragEl);
      }

      _this._hideClone();

      _dispatchEvent({
        sortable: _this,
        name: 'clone'
      });
    });
    !fallback && toggleClass(dragEl, options.dragClass, true); // Set proper drop events

    if (fallback) {
      ignoreNextClick = true;
      _this._loopId = setInterval(_this._emulateDragOver, 50);
    } else {
      // Undo what was set in _prepareDragStart before drag started
      off(document, 'mouseup', _this._onDrop);
      off(document, 'touchend', _this._onDrop);
      off(document, 'touchcancel', _this._onDrop);

      if (dataTransfer) {
        dataTransfer.effectAllowed = 'move';
        options.setData && options.setData.call(_this, dataTransfer, dragEl);
      }

      on(document, 'drop', _this); // #1276 fix:

      css(dragEl, 'transform', 'translateZ(0)');
    }

    awaitingDragStarted = true;
    _this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));
    on(document, 'selectstart', _this);
    moved = true;

    if (Safari) {
      css(document.body, 'user-select', 'none');
    }
  },
  // Returns true - if no further action is needed (either inserted or another condition)
  _onDragOver: function _onDragOver(
  /**Event*/
  evt) {
    var el = this.el,
        target = evt.target,
        dragRect,
        targetRect,
        revert,
        options = this.options,
        group = options.group,
        activeSortable = Sortable.active,
        isOwner = activeGroup === group,
        canSort = options.sort,
        fromSortable = putSortable || activeSortable,
        vertical,
        _this = this,
        completedFired = false;

    if (_silent) return;

    function dragOverEvent(name, extra) {
      pluginEvent(name, _this, _objectSpread2({
        evt: evt,
        isOwner: isOwner,
        axis: vertical ? 'vertical' : 'horizontal',
        revert: revert,
        dragRect: dragRect,
        targetRect: targetRect,
        canSort: canSort,
        fromSortable: fromSortable,
        target: target,
        completed: completed,
        onMove: function onMove(target, after) {
          return _onMove(rootEl, el, dragEl, dragRect, target, getRect(target), evt, after);
        },
        changed: changed
      }, extra));
    } // Capture animation state


    function capture() {
      dragOverEvent('dragOverAnimationCapture');

      _this.captureAnimationState();

      if (_this !== fromSortable) {
        fromSortable.captureAnimationState();
      }
    } // Return invocation when dragEl is inserted (or completed)


    function completed(insertion) {
      dragOverEvent('dragOverCompleted', {
        insertion: insertion
      });

      if (insertion) {
        // Clones must be hidden before folding animation to capture dragRectAbsolute properly
        if (isOwner) {
          activeSortable._hideClone();
        } else {
          activeSortable._showClone(_this);
        }

        if (_this !== fromSortable) {
          // Set ghost class to new sortable's ghost class
          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);
          toggleClass(dragEl, options.ghostClass, true);
        }

        if (putSortable !== _this && _this !== Sortable.active) {
          putSortable = _this;
        } else if (_this === Sortable.active && putSortable) {
          putSortable = null;
        } // Animation


        if (fromSortable === _this) {
          _this._ignoreWhileAnimating = target;
        }

        _this.animateAll(function () {
          dragOverEvent('dragOverAnimationComplete');
          _this._ignoreWhileAnimating = null;
        });

        if (_this !== fromSortable) {
          fromSortable.animateAll();
          fromSortable._ignoreWhileAnimating = null;
        }
      } // Null lastTarget if it is not inside a previously swapped element


      if (target === dragEl && !dragEl.animated || target === el && !target.animated) {
        lastTarget = null;
      } // no bubbling and not fallback


      if (!options.dragoverBubble && !evt.rootEl && target !== document) {
        dragEl.parentNode[expando]._isOutsideThisEl(evt.target); // Do not detect for empty insert if already inserted


        !insertion && nearestEmptyInsertDetectEvent(evt);
      }

      !options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();
      return completedFired = true;
    } // Call when dragEl has been inserted


    function changed() {
      newIndex = index(dragEl);
      newDraggableIndex = index(dragEl, options.draggable);

      _dispatchEvent({
        sortable: _this,
        name: 'change',
        toEl: el,
        newIndex: newIndex,
        newDraggableIndex: newDraggableIndex,
        originalEvent: evt
      });
    }

    if (evt.preventDefault !== void 0) {
      evt.cancelable && evt.preventDefault();
    }

    target = closest(target, options.draggable, el, true);
    dragOverEvent('dragOver');
    if (Sortable.eventCanceled) return completedFired;

    if (dragEl.contains(evt.target) || target.animated && target.animatingX && target.animatingY || _this._ignoreWhileAnimating === target) {
      return completed(false);
    }

    ignoreNextClick = false;

    if (activeSortable && !options.disabled && (isOwner ? canSort || (revert = parentEl !== rootEl) // Reverting item into the original list
    : putSortable === this || (this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) && group.checkPut(this, activeSortable, dragEl, evt))) {
      vertical = this._getDirection(evt, target) === 'vertical';
      dragRect = getRect(dragEl);
      dragOverEvent('dragOverValid');
      if (Sortable.eventCanceled) return completedFired;

      if (revert) {
        parentEl = rootEl; // actualization

        capture();

        this._hideClone();

        dragOverEvent('revert');

        if (!Sortable.eventCanceled) {
          if (nextEl) {
            rootEl.insertBefore(dragEl, nextEl);
          } else {
            rootEl.appendChild(dragEl);
          }
        }

        return completed(true);
      }

      var elLastChild = lastChild(el, options.draggable);

      if (!elLastChild || _ghostIsLast(evt, vertical, this) && !elLastChild.animated) {
        // Insert to end of list
        // If already at end of list: Do not insert
        if (elLastChild === dragEl) {
          return completed(false);
        } // if there is a last element, it is the target


        if (elLastChild && el === evt.target) {
          target = elLastChild;
        }

        if (target) {
          targetRect = getRect(target);
        }

        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {
          capture();

          if (elLastChild && elLastChild.nextSibling) {
            // the last draggable element is not the last node
            el.insertBefore(dragEl, elLastChild.nextSibling);
          } else {
            el.appendChild(dragEl);
          }

          parentEl = el; // actualization

          changed();
          return completed(true);
        }
      } else if (elLastChild && _ghostIsFirst(evt, vertical, this)) {
        // Insert to start of list
        var firstChild = getChild(el, 0, options, true);

        if (firstChild === dragEl) {
          return completed(false);
        }

        target = firstChild;
        targetRect = getRect(target);

        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, false) !== false) {
          capture();
          el.insertBefore(dragEl, firstChild);
          parentEl = el; // actualization

          changed();
          return completed(true);
        }
      } else if (target.parentNode === el) {
        targetRect = getRect(target);
        var direction = 0,
            targetBeforeFirstSwap,
            differentLevel = dragEl.parentNode !== el,
            differentRowCol = !_dragElInRowColumn(dragEl.animated && dragEl.toRect || dragRect, target.animated && target.toRect || targetRect, vertical),
            side1 = vertical ? 'top' : 'left',
            scrolledPastTop = isScrolledPast(target, 'top', 'top') || isScrolledPast(dragEl, 'top', 'top'),
            scrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;

        if (lastTarget !== target) {
          targetBeforeFirstSwap = targetRect[side1];
          pastFirstInvertThresh = false;
          isCircumstantialInvert = !differentRowCol && options.invertSwap || differentLevel;
        }

        direction = _getSwapDirection(evt, target, targetRect, vertical, differentRowCol ? 1 : options.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold, isCircumstantialInvert, lastTarget === target);
        var sibling;

        if (direction !== 0) {
          // Check if target is beside dragEl in respective direction (ignoring hidden elements)
          var dragIndex = index(dragEl);

          do {
            dragIndex -= direction;
            sibling = parentEl.children[dragIndex];
          } while (sibling && (css(sibling, 'display') === 'none' || sibling === ghostEl));
        } // If dragEl is already beside target: Do not insert


        if (direction === 0 || sibling === target) {
          return completed(false);
        }

        lastTarget = target;
        lastDirection = direction;
        var nextSibling = target.nextElementSibling,
            after = false;
        after = direction === 1;

        var moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);

        if (moveVector !== false) {
          if (moveVector === 1 || moveVector === -1) {
            after = moveVector === 1;
          }

          _silent = true;
          setTimeout(_unsilent, 30);
          capture();

          if (after && !nextSibling) {
            el.appendChild(dragEl);
          } else {
            target.parentNode.insertBefore(dragEl, after ? nextSibling : target);
          } // Undo chrome's scroll adjustment (has no effect on other browsers)


          if (scrolledPastTop) {
            scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);
          }

          parentEl = dragEl.parentNode; // actualization
          // must be done before animation

          if (targetBeforeFirstSwap !== undefined && !isCircumstantialInvert) {
            targetMoveDistance = Math.abs(targetBeforeFirstSwap - getRect(target)[side1]);
          }

          changed();
          return completed(true);
        }
      }

      if (el.contains(dragEl)) {
        return completed(false);
      }
    }

    return false;
  },
  _ignoreWhileAnimating: null,
  _offMoveEvents: function _offMoveEvents() {
    off(document, 'mousemove', this._onTouchMove);
    off(document, 'touchmove', this._onTouchMove);
    off(document, 'pointermove', this._onTouchMove);
    off(document, 'dragover', nearestEmptyInsertDetectEvent);
    off(document, 'mousemove', nearestEmptyInsertDetectEvent);
    off(document, 'touchmove', nearestEmptyInsertDetectEvent);
  },
  _offUpEvents: function _offUpEvents() {
    var ownerDocument = this.el.ownerDocument;
    off(ownerDocument, 'mouseup', this._onDrop);
    off(ownerDocument, 'touchend', this._onDrop);
    off(ownerDocument, 'pointerup', this._onDrop);
    off(ownerDocument, 'touchcancel', this._onDrop);
    off(document, 'selectstart', this);
  },
  _onDrop: function _onDrop(
  /**Event*/
  evt) {
    var el = this.el,
        options = this.options; // Get the index of the dragged element within its parent

    newIndex = index(dragEl);
    newDraggableIndex = index(dragEl, options.draggable);
    pluginEvent('drop', this, {
      evt: evt
    });
    parentEl = dragEl && dragEl.parentNode; // Get again after plugin event

    newIndex = index(dragEl);
    newDraggableIndex = index(dragEl, options.draggable);

    if (Sortable.eventCanceled) {
      this._nulling();

      return;
    }

    awaitingDragStarted = false;
    isCircumstantialInvert = false;
    pastFirstInvertThresh = false;
    clearInterval(this._loopId);
    clearTimeout(this._dragStartTimer);

    _cancelNextTick(this.cloneId);

    _cancelNextTick(this._dragStartId); // Unbind events


    if (this.nativeDraggable) {
      off(document, 'drop', this);
      off(el, 'dragstart', this._onDragStart);
    }

    this._offMoveEvents();

    this._offUpEvents();

    if (Safari) {
      css(document.body, 'user-select', '');
    }

    css(dragEl, 'transform', '');

    if (evt) {
      if (moved) {
        evt.cancelable && evt.preventDefault();
        !options.dropBubble && evt.stopPropagation();
      }

      ghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);

      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {
        // Remove clone(s)
        cloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);
      }

      if (dragEl) {
        if (this.nativeDraggable) {
          off(dragEl, 'dragend', this);
        }

        _disableDraggable(dragEl);

        dragEl.style['will-change'] = ''; // Remove classes
        // ghostClass is added in dragStarted

        if (moved && !awaitingDragStarted) {
          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);
        }

        toggleClass(dragEl, this.options.chosenClass, false); // Drag stop event

        _dispatchEvent({
          sortable: this,
          name: 'unchoose',
          toEl: parentEl,
          newIndex: null,
          newDraggableIndex: null,
          originalEvent: evt
        });

        if (rootEl !== parentEl) {
          if (newIndex >= 0) {
            // Add event
            _dispatchEvent({
              rootEl: parentEl,
              name: 'add',
              toEl: parentEl,
              fromEl: rootEl,
              originalEvent: evt
            }); // Remove event


            _dispatchEvent({
              sortable: this,
              name: 'remove',
              toEl: parentEl,
              originalEvent: evt
            }); // drag from one list and drop into another


            _dispatchEvent({
              rootEl: parentEl,
              name: 'sort',
              toEl: parentEl,
              fromEl: rootEl,
              originalEvent: evt
            });

            _dispatchEvent({
              sortable: this,
              name: 'sort',
              toEl: parentEl,
              originalEvent: evt
            });
          }

          putSortable && putSortable.save();
        } else {
          if (newIndex !== oldIndex) {
            if (newIndex >= 0) {
              // drag & drop within the same list
              _dispatchEvent({
                sortable: this,
                name: 'update',
                toEl: parentEl,
                originalEvent: evt
              });

              _dispatchEvent({
                sortable: this,
                name: 'sort',
                toEl: parentEl,
                originalEvent: evt
              });
            }
          }
        }

        if (Sortable.active) {
          /* jshint eqnull:true */
          if (newIndex == null || newIndex === -1) {
            newIndex = oldIndex;
            newDraggableIndex = oldDraggableIndex;
          }

          _dispatchEvent({
            sortable: this,
            name: 'end',
            toEl: parentEl,
            originalEvent: evt
          }); // Save sorting


          this.save();
        }
      }
    }

    this._nulling();
  },
  _nulling: function _nulling() {
    pluginEvent('nulling', this);
    rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = lastDownEl = cloneHidden = tapEvt = touchEvt = moved = newIndex = newDraggableIndex = oldIndex = oldDraggableIndex = lastTarget = lastDirection = putSortable = activeGroup = Sortable.dragged = Sortable.ghost = Sortable.clone = Sortable.active = null;
    savedInputChecked.forEach(function (el) {
      el.checked = true;
    });
    savedInputChecked.length = lastDx = lastDy = 0;
  },
  handleEvent: function handleEvent(
  /**Event*/
  evt) {
    switch (evt.type) {
      case 'drop':
      case 'dragend':
        this._onDrop(evt);

        break;

      case 'dragenter':
      case 'dragover':
        if (dragEl) {
          this._onDragOver(evt);

          _globalDragOver(evt);
        }

        break;

      case 'selectstart':
        evt.preventDefault();
        break;
    }
  },

  /**
   * Serializes the item into an array of string.
   * @returns {String[]}
   */
  toArray: function toArray() {
    var order = [],
        el,
        children = this.el.children,
        i = 0,
        n = children.length,
        options = this.options;

    for (; i < n; i++) {
      el = children[i];

      if (closest(el, options.draggable, this.el, false)) {
        order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));
      }
    }

    return order;
  },

  /**
   * Sorts the elements according to the array.
   * @param  {String[]}  order  order of the items
   */
  sort: function sort(order, useAnimation) {
    var items = {},
        rootEl = this.el;
    this.toArray().forEach(function (id, i) {
      var el = rootEl.children[i];

      if (closest(el, this.options.draggable, rootEl, false)) {
        items[id] = el;
      }
    }, this);
    useAnimation && this.captureAnimationState();
    order.forEach(function (id) {
      if (items[id]) {
        rootEl.removeChild(items[id]);
        rootEl.appendChild(items[id]);
      }
    });
    useAnimation && this.animateAll();
  },

  /**
   * Save the current sorting
   */
  save: function save() {
    var store = this.options.store;
    store && store.set && store.set(this);
  },

  /**
   * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.
   * @param   {HTMLElement}  el
   * @param   {String}       [selector]  default: `options.draggable`
   * @returns {HTMLElement|null}
   */
  closest: function closest$1(el, selector) {
    return closest(el, selector || this.options.draggable, this.el, false);
  },

  /**
   * Set/get option
   * @param   {string} name
   * @param   {*}      [value]
   * @returns {*}
   */
  option: function option(name, value) {
    var options = this.options;

    if (value === void 0) {
      return options[name];
    } else {
      var modifiedValue = PluginManager.modifyOption(this, name, value);

      if (typeof modifiedValue !== 'undefined') {
        options[name] = modifiedValue;
      } else {
        options[name] = value;
      }

      if (name === 'group') {
        _prepareGroup(options);
      }
    }
  },

  /**
   * Destroy
   */
  destroy: function destroy() {
    pluginEvent('destroy', this);
    var el = this.el;
    el[expando] = null;
    off(el, 'mousedown', this._onTapStart);
    off(el, 'touchstart', this._onTapStart);
    off(el, 'pointerdown', this._onTapStart);

    if (this.nativeDraggable) {
      off(el, 'dragover', this);
      off(el, 'dragenter', this);
    } // Remove draggable attributes


    Array.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {
      el.removeAttribute('draggable');
    });

    this._onDrop();

    this._disableDelayedDragEvents();

    sortables.splice(sortables.indexOf(this.el), 1);
    this.el = el = null;
  },
  _hideClone: function _hideClone() {
    if (!cloneHidden) {
      pluginEvent('hideClone', this);
      if (Sortable.eventCanceled) return;
      css(cloneEl, 'display', 'none');

      if (this.options.removeCloneOnHide && cloneEl.parentNode) {
        cloneEl.parentNode.removeChild(cloneEl);
      }

      cloneHidden = true;
    }
  },
  _showClone: function _showClone(putSortable) {
    if (putSortable.lastPutMode !== 'clone') {
      this._hideClone();

      return;
    }

    if (cloneHidden) {
      pluginEvent('showClone', this);
      if (Sortable.eventCanceled) return; // show clone at dragEl or original position

      if (dragEl.parentNode == rootEl && !this.options.group.revertClone) {
        rootEl.insertBefore(cloneEl, dragEl);
      } else if (nextEl) {
        rootEl.insertBefore(cloneEl, nextEl);
      } else {
        rootEl.appendChild(cloneEl);
      }

      if (this.options.group.revertClone) {
        this.animate(dragEl, cloneEl);
      }

      css(cloneEl, 'display', '');
      cloneHidden = false;
    }
  }
};

function _globalDragOver(
/**Event*/
evt) {
  if (evt.dataTransfer) {
    evt.dataTransfer.dropEffect = 'move';
  }

  evt.cancelable && evt.preventDefault();
}

function _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvent, willInsertAfter) {
  var evt,
      sortable = fromEl[expando],
      onMoveFn = sortable.options.onMove,
      retVal; // Support for new CustomEvent feature

  if (window.CustomEvent && !IE11OrLess && !Edge) {
    evt = new CustomEvent('move', {
      bubbles: true,
      cancelable: true
    });
  } else {
    evt = document.createEvent('Event');
    evt.initEvent('move', true, true);
  }

  evt.to = toEl;
  evt.from = fromEl;
  evt.dragged = dragEl;
  evt.draggedRect = dragRect;
  evt.related = targetEl || toEl;
  evt.relatedRect = targetRect || getRect(toEl);
  evt.willInsertAfter = willInsertAfter;
  evt.originalEvent = originalEvent;
  fromEl.dispatchEvent(evt);

  if (onMoveFn) {
    retVal = onMoveFn.call(sortable, evt, originalEvent);
  }

  return retVal;
}

function _disableDraggable(el) {
  el.draggable = false;
}

function _unsilent() {
  _silent = false;
}

function _ghostIsFirst(evt, vertical, sortable) {
  var rect = getRect(getChild(sortable.el, 0, sortable.options, true));
  var spacer = 10;
  return vertical ? evt.clientX < rect.left - spacer || evt.clientY < rect.top && evt.clientX < rect.right : evt.clientY < rect.top - spacer || evt.clientY < rect.bottom && evt.clientX < rect.left;
}

function _ghostIsLast(evt, vertical, sortable) {
  var rect = getRect(lastChild(sortable.el, sortable.options.draggable));
  var spacer = 10;
  return vertical ? evt.clientX > rect.right + spacer || evt.clientX <= rect.right && evt.clientY > rect.bottom && evt.clientX >= rect.left : evt.clientX > rect.right && evt.clientY > rect.top || evt.clientX <= rect.right && evt.clientY > rect.bottom + spacer;
}

function _getSwapDirection(evt, target, targetRect, vertical, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {
  var mouseOnAxis = vertical ? evt.clientY : evt.clientX,
      targetLength = vertical ? targetRect.height : targetRect.width,
      targetS1 = vertical ? targetRect.top : targetRect.left,
      targetS2 = vertical ? targetRect.bottom : targetRect.right,
      invert = false;

  if (!invertSwap) {
    // Never invert or create dragEl shadow when target movemenet causes mouse to move past the end of regular swapThreshold
    if (isLastTarget && targetMoveDistance < targetLength * swapThreshold) {
      // multiplied only by swapThreshold because mouse will already be inside target by (1 - threshold) * targetLength / 2
      // check if past first invert threshold on side opposite of lastDirection
      if (!pastFirstInvertThresh && (lastDirection === 1 ? mouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2 : mouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2)) {
        // past first invert threshold, do not restrict inverted threshold to dragEl shadow
        pastFirstInvertThresh = true;
      }

      if (!pastFirstInvertThresh) {
        // dragEl shadow (target move distance shadow)
        if (lastDirection === 1 ? mouseOnAxis < targetS1 + targetMoveDistance // over dragEl shadow
        : mouseOnAxis > targetS2 - targetMoveDistance) {
          return -lastDirection;
        }
      } else {
        invert = true;
      }
    } else {
      // Regular
      if (mouseOnAxis > targetS1 + targetLength * (1 - swapThreshold) / 2 && mouseOnAxis < targetS2 - targetLength * (1 - swapThreshold) / 2) {
        return _getInsertDirection(target);
      }
    }
  }

  invert = invert || invertSwap;

  if (invert) {
    // Invert of regular
    if (mouseOnAxis < targetS1 + targetLength * invertedSwapThreshold / 2 || mouseOnAxis > targetS2 - targetLength * invertedSwapThreshold / 2) {
      return mouseOnAxis > targetS1 + targetLength / 2 ? 1 : -1;
    }
  }

  return 0;
}
/**
 * Gets the direction dragEl must be swapped relative to target in order to make it
 * seem that dragEl has been "inserted" into that element's position
 * @param  {HTMLElement} target       The target whose position dragEl is being inserted at
 * @return {Number}                   Direction dragEl must be swapped
 */


function _getInsertDirection(target) {
  if (index(dragEl) < index(target)) {
    return 1;
  } else {
    return -1;
  }
}
/**
 * Generate id
 * @param   {HTMLElement} el
 * @returns {String}
 * @private
 */


function _generateId(el) {
  var str = el.tagName + el.className + el.src + el.href + el.textContent,
      i = str.length,
      sum = 0;

  while (i--) {
    sum += str.charCodeAt(i);
  }

  return sum.toString(36);
}

function _saveInputCheckedState(root) {
  savedInputChecked.length = 0;
  var inputs = root.getElementsByTagName('input');
  var idx = inputs.length;

  while (idx--) {
    var el = inputs[idx];
    el.checked && savedInputChecked.push(el);
  }
}

function _nextTick(fn) {
  return setTimeout(fn, 0);
}

function _cancelNextTick(id) {
  return clearTimeout(id);
} // Fixed #973:


if (documentExists) {
  on(document, 'touchmove', function (evt) {
    if ((Sortable.active || awaitingDragStarted) && evt.cancelable) {
      evt.preventDefault();
    }
  });
} // Export utils


Sortable.utils = {
  on: on,
  off: off,
  css: css,
  find: find,
  is: function is(el, selector) {
    return !!closest(el, selector, el, false);
  },
  extend: extend,
  throttle: throttle,
  closest: closest,
  toggleClass: toggleClass,
  clone: clone,
  index: index,
  nextTick: _nextTick,
  cancelNextTick: _cancelNextTick,
  detectDirection: _detectDirection,
  getChild: getChild
};
/**
 * Get the Sortable instance of an element
 * @param  {HTMLElement} element The element
 * @return {Sortable|undefined}         The instance of Sortable
 */

Sortable.get = function (element) {
  return element[expando];
};
/**
 * Mount a plugin to Sortable
 * @param  {...SortablePlugin|SortablePlugin[]} plugins       Plugins being mounted
 */


Sortable.mount = function () {
  for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {
    plugins[_key] = arguments[_key];
  }

  if (plugins[0].constructor === Array) plugins = plugins[0];
  plugins.forEach(function (plugin) {
    if (!plugin.prototype || !plugin.prototype.constructor) {
      throw "Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(plugin));
    }

    if (plugin.utils) Sortable.utils = _objectSpread2(_objectSpread2({}, Sortable.utils), plugin.utils);
    PluginManager.mount(plugin);
  });
};
/**
 * Create sortable instance
 * @param {HTMLElement}  el
 * @param {Object}      [options]
 */


Sortable.create = function (el, options) {
  return new Sortable(el, options);
}; // Export


Sortable.version = version;

var autoScrolls = [],
    scrollEl,
    scrollRootEl,
    scrolling = false,
    lastAutoScrollX,
    lastAutoScrollY,
    touchEvt$1,
    pointerElemChangedInterval;

function AutoScrollPlugin() {
  function AutoScroll() {
    this.defaults = {
      scroll: true,
      forceAutoScrollFallback: false,
      scrollSensitivity: 30,
      scrollSpeed: 10,
      bubbleScroll: true
    }; // Bind all private methods

    for (var fn in this) {
      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {
        this[fn] = this[fn].bind(this);
      }
    }
  }

  AutoScroll.prototype = {
    dragStarted: function dragStarted(_ref) {
      var originalEvent = _ref.originalEvent;

      if (this.sortable.nativeDraggable) {
        on(document, 'dragover', this._handleAutoScroll);
      } else {
        if (this.options.supportPointer) {
          on(document, 'pointermove', this._handleFallbackAutoScroll);
        } else if (originalEvent.touches) {
          on(document, 'touchmove', this._handleFallbackAutoScroll);
        } else {
          on(document, 'mousemove', this._handleFallbackAutoScroll);
        }
      }
    },
    dragOverCompleted: function dragOverCompleted(_ref2) {
      var originalEvent = _ref2.originalEvent;

      // For when bubbling is canceled and using fallback (fallback 'touchmove' always reached)
      if (!this.options.dragOverBubble && !originalEvent.rootEl) {
        this._handleAutoScroll(originalEvent);
      }
    },
    drop: function drop() {
      if (this.sortable.nativeDraggable) {
        off(document, 'dragover', this._handleAutoScroll);
      } else {
        off(document, 'pointermove', this._handleFallbackAutoScroll);
        off(document, 'touchmove', this._handleFallbackAutoScroll);
        off(document, 'mousemove', this._handleFallbackAutoScroll);
      }

      clearPointerElemChangedInterval();
      clearAutoScrolls();
      cancelThrottle();
    },
    nulling: function nulling() {
      touchEvt$1 = scrollRootEl = scrollEl = scrolling = pointerElemChangedInterval = lastAutoScrollX = lastAutoScrollY = null;
      autoScrolls.length = 0;
    },
    _handleFallbackAutoScroll: function _handleFallbackAutoScroll(evt) {
      this._handleAutoScroll(evt, true);
    },
    _handleAutoScroll: function _handleAutoScroll(evt, fallback) {
      var _this = this;

      var x = (evt.touches ? evt.touches[0] : evt).clientX,
          y = (evt.touches ? evt.touches[0] : evt).clientY,
          elem = document.elementFromPoint(x, y);
      touchEvt$1 = evt; // IE does not seem to have native autoscroll,
      // Edge's autoscroll seems too conditional,
      // MACOS Safari does not have autoscroll,
      // Firefox and Chrome are good

      if (fallback || this.options.forceAutoScrollFallback || Edge || IE11OrLess || Safari) {
        autoScroll(evt, this.options, elem, fallback); // Listener for pointer element change

        var ogElemScroller = getParentAutoScrollElement(elem, true);

        if (scrolling && (!pointerElemChangedInterval || x !== lastAutoScrollX || y !== lastAutoScrollY)) {
          pointerElemChangedInterval && clearPointerElemChangedInterval(); // Detect for pointer elem change, emulating native DnD behaviour

          pointerElemChangedInterval = setInterval(function () {
            var newElem = getParentAutoScrollElement(document.elementFromPoint(x, y), true);

            if (newElem !== ogElemScroller) {
              ogElemScroller = newElem;
              clearAutoScrolls();
            }

            autoScroll(evt, _this.options, newElem, fallback);
          }, 10);
          lastAutoScrollX = x;
          lastAutoScrollY = y;
        }
      } else {
        // if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll
        if (!this.options.bubbleScroll || getParentAutoScrollElement(elem, true) === getWindowScrollingElement()) {
          clearAutoScrolls();
          return;
        }

        autoScroll(evt, this.options, getParentAutoScrollElement(elem, false), false);
      }
    }
  };
  return _extends(AutoScroll, {
    pluginName: 'scroll',
    initializeByDefault: true
  });
}

function clearAutoScrolls() {
  autoScrolls.forEach(function (autoScroll) {
    clearInterval(autoScroll.pid);
  });
  autoScrolls = [];
}

function clearPointerElemChangedInterval() {
  clearInterval(pointerElemChangedInterval);
}

var autoScroll = throttle(function (evt, options, rootEl, isFallback) {
  // Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521
  if (!options.scroll) return;
  var x = (evt.touches ? evt.touches[0] : evt).clientX,
      y = (evt.touches ? evt.touches[0] : evt).clientY,
      sens = options.scrollSensitivity,
      speed = options.scrollSpeed,
      winScroller = getWindowScrollingElement();
  var scrollThisInstance = false,
      scrollCustomFn; // New scroll root, set scrollEl

  if (scrollRootEl !== rootEl) {
    scrollRootEl = rootEl;
    clearAutoScrolls();
    scrollEl = options.scroll;
    scrollCustomFn = options.scrollFn;

    if (scrollEl === true) {
      scrollEl = getParentAutoScrollElement(rootEl, true);
    }
  }

  var layersOut = 0;
  var currentParent = scrollEl;

  do {
    var el = currentParent,
        rect = getRect(el),
        top = rect.top,
        bottom = rect.bottom,
        left = rect.left,
        right = rect.right,
        width = rect.width,
        height = rect.height,
        canScrollX = void 0,
        canScrollY = void 0,
        scrollWidth = el.scrollWidth,
        scrollHeight = el.scrollHeight,
        elCSS = css(el),
        scrollPosX = el.scrollLeft,
        scrollPosY = el.scrollTop;

    if (el === winScroller) {
      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll' || elCSS.overflowX === 'visible');
      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll' || elCSS.overflowY === 'visible');
    } else {
      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll');
      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll');
    }

    var vx = canScrollX && (Math.abs(right - x) <= sens && scrollPosX + width < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);
    var vy = canScrollY && (Math.abs(bottom - y) <= sens && scrollPosY + height < scrollHeight) - (Math.abs(top - y) <= sens && !!scrollPosY);

    if (!autoScrolls[layersOut]) {
      for (var i = 0; i <= layersOut; i++) {
        if (!autoScrolls[i]) {
          autoScrolls[i] = {};
        }
      }
    }

    if (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {
      autoScrolls[layersOut].el = el;
      autoScrolls[layersOut].vx = vx;
      autoScrolls[layersOut].vy = vy;
      clearInterval(autoScrolls[layersOut].pid);

      if (vx != 0 || vy != 0) {
        scrollThisInstance = true;
        /* jshint loopfunc:true */

        autoScrolls[layersOut].pid = setInterval(function () {
          // emulate drag over during autoscroll (fallback), emulating native DnD behaviour
          if (isFallback && this.layer === 0) {
            Sortable.active._onTouchMove(touchEvt$1); // To move ghost if it is positioned absolutely

          }

          var scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;
          var scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;

          if (typeof scrollCustomFn === 'function') {
            if (scrollCustomFn.call(Sortable.dragged.parentNode[expando], scrollOffsetX, scrollOffsetY, evt, touchEvt$1, autoScrolls[this.layer].el) !== 'continue') {
              return;
            }
          }

          scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);
        }.bind({
          layer: layersOut
        }), 24);
      }
    }

    layersOut++;
  } while (options.bubbleScroll && currentParent !== winScroller && (currentParent = getParentAutoScrollElement(currentParent, false)));

  scrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not
}, 30);

var drop = function drop(_ref) {
  var originalEvent = _ref.originalEvent,
      putSortable = _ref.putSortable,
      dragEl = _ref.dragEl,
      activeSortable = _ref.activeSortable,
      dispatchSortableEvent = _ref.dispatchSortableEvent,
      hideGhostForTarget = _ref.hideGhostForTarget,
      unhideGhostForTarget = _ref.unhideGhostForTarget;
  if (!originalEvent) return;
  var toSortable = putSortable || activeSortable;
  hideGhostForTarget();
  var touch = originalEvent.changedTouches && originalEvent.changedTouches.length ? originalEvent.changedTouches[0] : originalEvent;
  var target = document.elementFromPoint(touch.clientX, touch.clientY);
  unhideGhostForTarget();

  if (toSortable && !toSortable.el.contains(target)) {
    dispatchSortableEvent('spill');
    this.onSpill({
      dragEl: dragEl,
      putSortable: putSortable
    });
  }
};

function Revert() {}

Revert.prototype = {
  startIndex: null,
  dragStart: function dragStart(_ref2) {
    var oldDraggableIndex = _ref2.oldDraggableIndex;
    this.startIndex = oldDraggableIndex;
  },
  onSpill: function onSpill(_ref3) {
    var dragEl = _ref3.dragEl,
        putSortable = _ref3.putSortable;
    this.sortable.captureAnimationState();

    if (putSortable) {
      putSortable.captureAnimationState();
    }

    var nextSibling = getChild(this.sortable.el, this.startIndex, this.options);

    if (nextSibling) {
      this.sortable.el.insertBefore(dragEl, nextSibling);
    } else {
      this.sortable.el.appendChild(dragEl);
    }

    this.sortable.animateAll();

    if (putSortable) {
      putSortable.animateAll();
    }
  },
  drop: drop
};

_extends(Revert, {
  pluginName: 'revertOnSpill'
});

function Remove() {}

Remove.prototype = {
  onSpill: function onSpill(_ref4) {
    var dragEl = _ref4.dragEl,
        putSortable = _ref4.putSortable;
    var parentSortable = putSortable || this.sortable;
    parentSortable.captureAnimationState();
    dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);
    parentSortable.animateAll();
  },
  drop: drop
};

_extends(Remove, {
  pluginName: 'removeOnSpill'
});

var lastSwapEl;

function SwapPlugin() {
  function Swap() {
    this.defaults = {
      swapClass: 'sortable-swap-highlight'
    };
  }

  Swap.prototype = {
    dragStart: function dragStart(_ref) {
      var dragEl = _ref.dragEl;
      lastSwapEl = dragEl;
    },
    dragOverValid: function dragOverValid(_ref2) {
      var completed = _ref2.completed,
          target = _ref2.target,
          onMove = _ref2.onMove,
          activeSortable = _ref2.activeSortable,
          changed = _ref2.changed,
          cancel = _ref2.cancel;
      if (!activeSortable.options.swap) return;
      var el = this.sortable.el,
          options = this.options;

      if (target && target !== el) {
        var prevSwapEl = lastSwapEl;

        if (onMove(target) !== false) {
          toggleClass(target, options.swapClass, true);
          lastSwapEl = target;
        } else {
          lastSwapEl = null;
        }

        if (prevSwapEl && prevSwapEl !== lastSwapEl) {
          toggleClass(prevSwapEl, options.swapClass, false);
        }
      }

      changed();
      completed(true);
      cancel();
    },
    drop: function drop(_ref3) {
      var activeSortable = _ref3.activeSortable,
          putSortable = _ref3.putSortable,
          dragEl = _ref3.dragEl;
      var toSortable = putSortable || this.sortable;
      var options = this.options;
      lastSwapEl && toggleClass(lastSwapEl, options.swapClass, false);

      if (lastSwapEl && (options.swap || putSortable && putSortable.options.swap)) {
        if (dragEl !== lastSwapEl) {
          toSortable.captureAnimationState();
          if (toSortable !== activeSortable) activeSortable.captureAnimationState();
          swapNodes(dragEl, lastSwapEl);
          toSortable.animateAll();
          if (toSortable !== activeSortable) activeSortable.animateAll();
        }
      }
    },
    nulling: function nulling() {
      lastSwapEl = null;
    }
  };
  return _extends(Swap, {
    pluginName: 'swap',
    eventProperties: function eventProperties() {
      return {
        swapItem: lastSwapEl
      };
    }
  });
}

function swapNodes(n1, n2) {
  var p1 = n1.parentNode,
      p2 = n2.parentNode,
      i1,
      i2;
  if (!p1 || !p2 || p1.isEqualNode(n2) || p2.isEqualNode(n1)) return;
  i1 = index(n1);
  i2 = index(n2);

  if (p1.isEqualNode(p2) && i1 < i2) {
    i2++;
  }

  p1.insertBefore(n2, p1.children[i1]);
  p2.insertBefore(n1, p2.children[i2]);
}

var multiDragElements = [],
    multiDragClones = [],
    lastMultiDragSelect,
    // for selection with modifier key down (SHIFT)
multiDragSortable,
    initialFolding = false,
    // Initial multi-drag fold when drag started
folding = false,
    // Folding any other time
dragStarted = false,
    dragEl$1,
    clonesFromRect,
    clonesHidden;

function MultiDragPlugin() {
  function MultiDrag(sortable) {
    // Bind all private methods
    for (var fn in this) {
      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {
        this[fn] = this[fn].bind(this);
      }
    }

    if (!sortable.options.avoidImplicitDeselect) {
      if (sortable.options.supportPointer) {
        on(document, 'pointerup', this._deselectMultiDrag);
      } else {
        on(document, 'mouseup', this._deselectMultiDrag);
        on(document, 'touchend', this._deselectMultiDrag);
      }
    }

    on(document, 'keydown', this._checkKeyDown);
    on(document, 'keyup', this._checkKeyUp);
    this.defaults = {
      selectedClass: 'sortable-selected',
      multiDragKey: null,
      avoidImplicitDeselect: false,
      setData: function setData(dataTransfer, dragEl) {
        var data = '';

        if (multiDragElements.length && multiDragSortable === sortable) {
          multiDragElements.forEach(function (multiDragElement, i) {
            data += (!i ? '' : ', ') + multiDragElement.textContent;
          });
        } else {
          data = dragEl.textContent;
        }

        dataTransfer.setData('Text', data);
      }
    };
  }

  MultiDrag.prototype = {
    multiDragKeyDown: false,
    isMultiDrag: false,
    delayStartGlobal: function delayStartGlobal(_ref) {
      var dragged = _ref.dragEl;
      dragEl$1 = dragged;
    },
    delayEnded: function delayEnded() {
      this.isMultiDrag = ~multiDragElements.indexOf(dragEl$1);
    },
    setupClone: function setupClone(_ref2) {
      var sortable = _ref2.sortable,
          cancel = _ref2.cancel;
      if (!this.isMultiDrag) return;

      for (var i = 0; i < multiDragElements.length; i++) {
        multiDragClones.push(clone(multiDragElements[i]));
        multiDragClones[i].sortableIndex = multiDragElements[i].sortableIndex;
        multiDragClones[i].draggable = false;
        multiDragClones[i].style['will-change'] = '';
        toggleClass(multiDragClones[i], this.options.selectedClass, false);
        multiDragElements[i] === dragEl$1 && toggleClass(multiDragClones[i], this.options.chosenClass, false);
      }

      sortable._hideClone();

      cancel();
    },
    clone: function clone(_ref3) {
      var sortable = _ref3.sortable,
          rootEl = _ref3.rootEl,
          dispatchSortableEvent = _ref3.dispatchSortableEvent,
          cancel = _ref3.cancel;
      if (!this.isMultiDrag) return;

      if (!this.options.removeCloneOnHide) {
        if (multiDragElements.length && multiDragSortable === sortable) {
          insertMultiDragClones(true, rootEl);
          dispatchSortableEvent('clone');
          cancel();
        }
      }
    },
    showClone: function showClone(_ref4) {
      var cloneNowShown = _ref4.cloneNowShown,
          rootEl = _ref4.rootEl,
          cancel = _ref4.cancel;
      if (!this.isMultiDrag) return;
      insertMultiDragClones(false, rootEl);
      multiDragClones.forEach(function (clone) {
        css(clone, 'display', '');
      });
      cloneNowShown();
      clonesHidden = false;
      cancel();
    },
    hideClone: function hideClone(_ref5) {
      var _this = this;

      var sortable = _ref5.sortable,
          cloneNowHidden = _ref5.cloneNowHidden,
          cancel = _ref5.cancel;
      if (!this.isMultiDrag) return;
      multiDragClones.forEach(function (clone) {
        css(clone, 'display', 'none');

        if (_this.options.removeCloneOnHide && clone.parentNode) {
          clone.parentNode.removeChild(clone);
        }
      });
      cloneNowHidden();
      clonesHidden = true;
      cancel();
    },
    dragStartGlobal: function dragStartGlobal(_ref6) {
      var sortable = _ref6.sortable;

      if (!this.isMultiDrag && multiDragSortable) {
        multiDragSortable.multiDrag._deselectMultiDrag();
      }

      multiDragElements.forEach(function (multiDragElement) {
        multiDragElement.sortableIndex = index(multiDragElement);
      }); // Sort multi-drag elements

      multiDragElements = multiDragElements.sort(function (a, b) {
        return a.sortableIndex - b.sortableIndex;
      });
      dragStarted = true;
    },
    dragStarted: function dragStarted(_ref7) {
      var _this2 = this;

      var sortable = _ref7.sortable;
      if (!this.isMultiDrag) return;

      if (this.options.sort) {
        // Capture rects,
        // hide multi drag elements (by positioning them absolute),
        // set multi drag elements rects to dragRect,
        // show multi drag elements,
        // animate to rects,
        // unset rects & remove from DOM
        sortable.captureAnimationState();

        if (this.options.animation) {
          multiDragElements.forEach(function (multiDragElement) {
            if (multiDragElement === dragEl$1) return;
            css(multiDragElement, 'position', 'absolute');
          });
          var dragRect = getRect(dragEl$1, false, true, true);
          multiDragElements.forEach(function (multiDragElement) {
            if (multiDragElement === dragEl$1) return;
            setRect(multiDragElement, dragRect);
          });
          folding = true;
          initialFolding = true;
        }
      }

      sortable.animateAll(function () {
        folding = false;
        initialFolding = false;

        if (_this2.options.animation) {
          multiDragElements.forEach(function (multiDragElement) {
            unsetRect(multiDragElement);
          });
        } // Remove all auxiliary multidrag items from el, if sorting enabled


        if (_this2.options.sort) {
          removeMultiDragElements();
        }
      });
    },
    dragOver: function dragOver(_ref8) {
      var target = _ref8.target,
          completed = _ref8.completed,
          cancel = _ref8.cancel;

      if (folding && ~multiDragElements.indexOf(target)) {
        completed(false);
        cancel();
      }
    },
    revert: function revert(_ref9) {
      var fromSortable = _ref9.fromSortable,
          rootEl = _ref9.rootEl,
          sortable = _ref9.sortable,
          dragRect = _ref9.dragRect;

      if (multiDragElements.length > 1) {
        // Setup unfold animation
        multiDragElements.forEach(function (multiDragElement) {
          sortable.addAnimationState({
            target: multiDragElement,
            rect: folding ? getRect(multiDragElement) : dragRect
          });
          unsetRect(multiDragElement);
          multiDragElement.fromRect = dragRect;
          fromSortable.removeAnimationState(multiDragElement);
        });
        folding = false;
        insertMultiDragElements(!this.options.removeCloneOnHide, rootEl);
      }
    },
    dragOverCompleted: function dragOverCompleted(_ref10) {
      var sortable = _ref10.sortable,
          isOwner = _ref10.isOwner,
          insertion = _ref10.insertion,
          activeSortable = _ref10.activeSortable,
          parentEl = _ref10.parentEl,
          putSortable = _ref10.putSortable;
      var options = this.options;

      if (insertion) {
        // Clones must be hidden before folding animation to capture dragRectAbsolute properly
        if (isOwner) {
          activeSortable._hideClone();
        }

        initialFolding = false; // If leaving sort:false root, or already folding - Fold to new location

        if (options.animation && multiDragElements.length > 1 && (folding || !isOwner && !activeSortable.options.sort && !putSortable)) {
          // Fold: Set all multi drag elements's rects to dragEl's rect when multi-drag elements are invisible
          var dragRectAbsolute = getRect(dragEl$1, false, true, true);
          multiDragElements.forEach(function (multiDragElement) {
            if (multiDragElement === dragEl$1) return;
            setRect(multiDragElement, dragRectAbsolute); // Move element(s) to end of parentEl so that it does not interfere with multi-drag clones insertion if they are inserted
            // while folding, and so that we can capture them again because old sortable will no longer be fromSortable

            parentEl.appendChild(multiDragElement);
          });
          folding = true;
        } // Clones must be shown (and check to remove multi drags) after folding when interfering multiDragElements are moved out


        if (!isOwner) {
          // Only remove if not folding (folding will remove them anyways)
          if (!folding) {
            removeMultiDragElements();
          }

          if (multiDragElements.length > 1) {
            var clonesHiddenBefore = clonesHidden;

            activeSortable._showClone(sortable); // Unfold animation for clones if showing from hidden


            if (activeSortable.options.animation && !clonesHidden && clonesHiddenBefore) {
              multiDragClones.forEach(function (clone) {
                activeSortable.addAnimationState({
                  target: clone,
                  rect: clonesFromRect
                });
                clone.fromRect = clonesFromRect;
                clone.thisAnimationDuration = null;
              });
            }
          } else {
            activeSortable._showClone(sortable);
          }
        }
      }
    },
    dragOverAnimationCapture: function dragOverAnimationCapture(_ref11) {
      var dragRect = _ref11.dragRect,
          isOwner = _ref11.isOwner,
          activeSortable = _ref11.activeSortable;
      multiDragElements.forEach(function (multiDragElement) {
        multiDragElement.thisAnimationDuration = null;
      });

      if (activeSortable.options.animation && !isOwner && activeSortable.multiDrag.isMultiDrag) {
        clonesFromRect = _extends({}, dragRect);
        var dragMatrix = matrix(dragEl$1, true);
        clonesFromRect.top -= dragMatrix.f;
        clonesFromRect.left -= dragMatrix.e;
      }
    },
    dragOverAnimationComplete: function dragOverAnimationComplete() {
      if (folding) {
        folding = false;
        removeMultiDragElements();
      }
    },
    drop: function drop(_ref12) {
      var evt = _ref12.originalEvent,
          rootEl = _ref12.rootEl,
          parentEl = _ref12.parentEl,
          sortable = _ref12.sortable,
          dispatchSortableEvent = _ref12.dispatchSortableEvent,
          oldIndex = _ref12.oldIndex,
          putSortable = _ref12.putSortable;
      var toSortable = putSortable || this.sortable;
      if (!evt) return;
      var options = this.options,
          children = parentEl.children; // Multi-drag selection

      if (!dragStarted) {
        if (options.multiDragKey && !this.multiDragKeyDown) {
          this._deselectMultiDrag();
        }

        toggleClass(dragEl$1, options.selectedClass, !~multiDragElements.indexOf(dragEl$1));

        if (!~multiDragElements.indexOf(dragEl$1)) {
          multiDragElements.push(dragEl$1);
          dispatchEvent({
            sortable: sortable,
            rootEl: rootEl,
            name: 'select',
            targetEl: dragEl$1,
            originalEvent: evt
          }); // Modifier activated, select from last to dragEl

          if (evt.shiftKey && lastMultiDragSelect && sortable.el.contains(lastMultiDragSelect)) {
            var lastIndex = index(lastMultiDragSelect),
                currentIndex = index(dragEl$1);

            if (~lastIndex && ~currentIndex && lastIndex !== currentIndex) {
              // Must include lastMultiDragSelect (select it), in case modified selection from no selection
              // (but previous selection existed)
              var n, i;

              if (currentIndex > lastIndex) {
                i = lastIndex;
                n = currentIndex;
              } else {
                i = currentIndex;
                n = lastIndex + 1;
              }

              for (; i < n; i++) {
                if (~multiDragElements.indexOf(children[i])) continue;
                toggleClass(children[i], options.selectedClass, true);
                multiDragElements.push(children[i]);
                dispatchEvent({
                  sortable: sortable,
                  rootEl: rootEl,
                  name: 'select',
                  targetEl: children[i],
                  originalEvent: evt
                });
              }
            }
          } else {
            lastMultiDragSelect = dragEl$1;
          }

          multiDragSortable = toSortable;
        } else {
          multiDragElements.splice(multiDragElements.indexOf(dragEl$1), 1);
          lastMultiDragSelect = null;
          dispatchEvent({
            sortable: sortable,
            rootEl: rootEl,
            name: 'deselect',
            targetEl: dragEl$1,
            originalEvent: evt
          });
        }
      } // Multi-drag drop


      if (dragStarted && this.isMultiDrag) {
        folding = false; // Do not "unfold" after around dragEl if reverted

        if ((parentEl[expando].options.sort || parentEl !== rootEl) && multiDragElements.length > 1) {
          var dragRect = getRect(dragEl$1),
              multiDragIndex = index(dragEl$1, ':not(.' + this.options.selectedClass + ')');
          if (!initialFolding && options.animation) dragEl$1.thisAnimationDuration = null;
          toSortable.captureAnimationState();

          if (!initialFolding) {
            if (options.animation) {
              dragEl$1.fromRect = dragRect;
              multiDragElements.forEach(function (multiDragElement) {
                multiDragElement.thisAnimationDuration = null;

                if (multiDragElement !== dragEl$1) {
                  var rect = folding ? getRect(multiDragElement) : dragRect;
                  multiDragElement.fromRect = rect; // Prepare unfold animation

                  toSortable.addAnimationState({
                    target: multiDragElement,
                    rect: rect
                  });
                }
              });
            } // Multi drag elements are not necessarily removed from the DOM on drop, so to reinsert
            // properly they must all be removed


            removeMultiDragElements();
            multiDragElements.forEach(function (multiDragElement) {
              if (children[multiDragIndex]) {
                parentEl.insertBefore(multiDragElement, children[multiDragIndex]);
              } else {
                parentEl.appendChild(multiDragElement);
              }

              multiDragIndex++;
            }); // If initial folding is done, the elements may have changed position because they are now
            // unfolding around dragEl, even though dragEl may not have his index changed, so update event
            // must be fired here as Sortable will not.

            if (oldIndex === index(dragEl$1)) {
              var update = false;
              multiDragElements.forEach(function (multiDragElement) {
                if (multiDragElement.sortableIndex !== index(multiDragElement)) {
                  update = true;
                  return;
                }
              });

              if (update) {
                dispatchSortableEvent('update');
              }
            }
          } // Must be done after capturing individual rects (scroll bar)


          multiDragElements.forEach(function (multiDragElement) {
            unsetRect(multiDragElement);
          });
          toSortable.animateAll();
        }

        multiDragSortable = toSortable;
      } // Remove clones if necessary


      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {
        multiDragClones.forEach(function (clone) {
          clone.parentNode && clone.parentNode.removeChild(clone);
        });
      }
    },
    nullingGlobal: function nullingGlobal() {
      this.isMultiDrag = dragStarted = false;
      multiDragClones.length = 0;
    },
    destroyGlobal: function destroyGlobal() {
      this._deselectMultiDrag();

      off(document, 'pointerup', this._deselectMultiDrag);
      off(document, 'mouseup', this._deselectMultiDrag);
      off(document, 'touchend', this._deselectMultiDrag);
      off(document, 'keydown', this._checkKeyDown);
      off(document, 'keyup', this._checkKeyUp);
    },
    _deselectMultiDrag: function _deselectMultiDrag(evt) {
      if (typeof dragStarted !== "undefined" && dragStarted) return; // Only deselect if selection is in this sortable

      if (multiDragSortable !== this.sortable) return; // Only deselect if target is not item in this sortable

      if (evt && closest(evt.target, this.options.draggable, this.sortable.el, false)) return; // Only deselect if left click

      if (evt && evt.button !== 0) return;

      while (multiDragElements.length) {
        var el = multiDragElements[0];
        toggleClass(el, this.options.selectedClass, false);
        multiDragElements.shift();
        dispatchEvent({
          sortable: this.sortable,
          rootEl: this.sortable.el,
          name: 'deselect',
          targetEl: el,
          originalEvent: evt
        });
      }
    },
    _checkKeyDown: function _checkKeyDown(evt) {
      if (evt.key === this.options.multiDragKey) {
        this.multiDragKeyDown = true;
      }
    },
    _checkKeyUp: function _checkKeyUp(evt) {
      if (evt.key === this.options.multiDragKey) {
        this.multiDragKeyDown = false;
      }
    }
  };
  return _extends(MultiDrag, {
    // Static methods & properties
    pluginName: 'multiDrag',
    utils: {
      /**
       * Selects the provided multi-drag item
       * @param  {HTMLElement} el    The element to be selected
       */
      select: function select(el) {
        var sortable = el.parentNode[expando];
        if (!sortable || !sortable.options.multiDrag || ~multiDragElements.indexOf(el)) return;

        if (multiDragSortable && multiDragSortable !== sortable) {
          multiDragSortable.multiDrag._deselectMultiDrag();

          multiDragSortable = sortable;
        }

        toggleClass(el, sortable.options.selectedClass, true);
        multiDragElements.push(el);
      },

      /**
       * Deselects the provided multi-drag item
       * @param  {HTMLElement} el    The element to be deselected
       */
      deselect: function deselect(el) {
        var sortable = el.parentNode[expando],
            index = multiDragElements.indexOf(el);
        if (!sortable || !sortable.options.multiDrag || !~index) return;
        toggleClass(el, sortable.options.selectedClass, false);
        multiDragElements.splice(index, 1);
      }
    },
    eventProperties: function eventProperties() {
      var _this3 = this;

      var oldIndicies = [],
          newIndicies = [];
      multiDragElements.forEach(function (multiDragElement) {
        oldIndicies.push({
          multiDragElement: multiDragElement,
          index: multiDragElement.sortableIndex
        }); // multiDragElements will already be sorted if folding

        var newIndex;

        if (folding && multiDragElement !== dragEl$1) {
          newIndex = -1;
        } else if (folding) {
          newIndex = index(multiDragElement, ':not(.' + _this3.options.selectedClass + ')');
        } else {
          newIndex = index(multiDragElement);
        }

        newIndicies.push({
          multiDragElement: multiDragElement,
          index: newIndex
        });
      });
      return {
        items: _toConsumableArray(multiDragElements),
        clones: [].concat(multiDragClones),
        oldIndicies: oldIndicies,
        newIndicies: newIndicies
      };
    },
    optionListeners: {
      multiDragKey: function multiDragKey(key) {
        key = key.toLowerCase();

        if (key === 'ctrl') {
          key = 'Control';
        } else if (key.length > 1) {
          key = key.charAt(0).toUpperCase() + key.substr(1);
        }

        return key;
      }
    }
  });
}

function insertMultiDragElements(clonesInserted, rootEl) {
  multiDragElements.forEach(function (multiDragElement, i) {
    var target = rootEl.children[multiDragElement.sortableIndex + (clonesInserted ? Number(i) : 0)];

    if (target) {
      rootEl.insertBefore(multiDragElement, target);
    } else {
      rootEl.appendChild(multiDragElement);
    }
  });
}
/**
 * Insert multi-drag clones
 * @param  {[Boolean]} elementsInserted  Whether the multi-drag elements are inserted
 * @param  {HTMLElement} rootEl
 */


function insertMultiDragClones(elementsInserted, rootEl) {
  multiDragClones.forEach(function (clone, i) {
    var target = rootEl.children[clone.sortableIndex + (elementsInserted ? Number(i) : 0)];

    if (target) {
      rootEl.insertBefore(clone, target);
    } else {
      rootEl.appendChild(clone);
    }
  });
}

function removeMultiDragElements() {
  multiDragElements.forEach(function (multiDragElement) {
    if (multiDragElement === dragEl$1) return;
    multiDragElement.parentNode && multiDragElement.parentNode.removeChild(multiDragElement);
  });
}

Sortable.mount(new AutoScrollPlugin());
Sortable.mount(Remove, Revert);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Sortable);



/***/ }),

/***/ "./node_modules/tom-select/dist/js/tom-select.complete.js":
/*!****************************************************************!*\
  !*** ./node_modules/tom-select/dist/js/tom-select.complete.js ***!
  \****************************************************************/
/***/ (function(module) {

/**
* Tom Select v2.2.2
* Licensed under the Apache License, Version 2.0 (the "License");
*/

(function (global, factory) {
	 true ? module.exports = factory() :
	0;
})(this, (function () { 'use strict';

	/**
	 * MicroEvent - to make any js object an event emitter
	 *
	 * - pure javascript - server compatible, browser compatible
	 * - dont rely on the browser doms
	 * - super simple - you get it immediatly, no mistery, no magic involved
	 *
	 * @author Jerome Etienne (https://github.com/jeromeetienne)
	 */

	/**
	 * Execute callback for each event in space separated list of event names
	 *
	 */
	function forEvents(events, callback) {
	  events.split(/\s+/).forEach(event => {
	    callback(event);
	  });
	}

	class MicroEvent {
	  constructor() {
	    this._events = void 0;
	    this._events = {};
	  }

	  on(events, fct) {
	    forEvents(events, event => {
	      const event_array = this._events[event] || [];
	      event_array.push(fct);
	      this._events[event] = event_array;
	    });
	  }

	  off(events, fct) {
	    var n = arguments.length;

	    if (n === 0) {
	      this._events = {};
	      return;
	    }

	    forEvents(events, event => {
	      if (n === 1) {
	        delete this._events[event];
	        return;
	      }

	      const event_array = this._events[event];
	      if (event_array === undefined) return;
	      event_array.splice(event_array.indexOf(fct), 1);
	      this._events[event] = event_array;
	    });
	  }

	  trigger(events, ...args) {
	    var self = this;
	    forEvents(events, event => {
	      const event_array = self._events[event];
	      if (event_array === undefined) return;
	      event_array.forEach(fct => {
	        fct.apply(self, args);
	      });
	    });
	  }

	}

	/**
	 * microplugin.js
	 * Copyright (c) 2013 Brian Reavis & contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 * @author Brian Reavis <brian@thirdroute.com>
	 */
	function MicroPlugin(Interface) {
	  Interface.plugins = {};
	  return class extends Interface {
	    constructor(...args) {
	      super(...args);
	      this.plugins = {
	        names: [],
	        settings: {},
	        requested: {},
	        loaded: {}
	      };
	    }

	    /**
	     * Registers a plugin.
	     *
	     * @param {function} fn
	     */
	    static define(name, fn) {
	      Interface.plugins[name] = {
	        'name': name,
	        'fn': fn
	      };
	    }
	    /**
	     * Initializes the listed plugins (with options).
	     * Acceptable formats:
	     *
	     * List (without options):
	     *   ['a', 'b', 'c']
	     *
	     * List (with options):
	     *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]
	     *
	     * Hash (with options):
	     *   {'a': { ... }, 'b': { ... }, 'c': { ... }}
	     *
	     * @param {array|object} plugins
	     */


	    initializePlugins(plugins) {
	      var key, name;
	      const self = this;
	      const queue = [];

	      if (Array.isArray(plugins)) {
	        plugins.forEach(plugin => {
	          if (typeof plugin === 'string') {
	            queue.push(plugin);
	          } else {
	            self.plugins.settings[plugin.name] = plugin.options;
	            queue.push(plugin.name);
	          }
	        });
	      } else if (plugins) {
	        for (key in plugins) {
	          if (plugins.hasOwnProperty(key)) {
	            self.plugins.settings[key] = plugins[key];
	            queue.push(key);
	          }
	        }
	      }

	      while (name = queue.shift()) {
	        self.require(name);
	      }
	    }

	    loadPlugin(name) {
	      var self = this;
	      var plugins = self.plugins;
	      var plugin = Interface.plugins[name];

	      if (!Interface.plugins.hasOwnProperty(name)) {
	        throw new Error('Unable to find "' + name + '" plugin');
	      }

	      plugins.requested[name] = true;
	      plugins.loaded[name] = plugin.fn.apply(self, [self.plugins.settings[name] || {}]);
	      plugins.names.push(name);
	    }
	    /**
	     * Initializes a plugin.
	     *
	     */


	    require(name) {
	      var self = this;
	      var plugins = self.plugins;

	      if (!self.plugins.loaded.hasOwnProperty(name)) {
	        if (plugins.requested[name]) {
	          throw new Error('Plugin has circular dependency ("' + name + '")');
	        }

	        self.loadPlugin(name);
	      }

	      return plugins.loaded[name];
	    }

	  };
	}

	/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */
	/**
	 * Convert array of strings to a regular expression
	 *	ex ['ab','a'] => (?:ab|a)
	 * 	ex ['a','b'] => [ab]
	 * @param {string[]} chars
	 * @return {string}
	 */
	const arrayToPattern = chars => {
	  chars = chars.filter(Boolean);

	  if (chars.length < 2) {
	    return chars[0] || '';
	  }

	  return maxValueLength(chars) == 1 ? '[' + chars.join('') + ']' : '(?:' + chars.join('|') + ')';
	};
	/**
	 * @param {string[]} array
	 * @return {string}
	 */

	const sequencePattern = array => {
	  if (!hasDuplicates(array)) {
	    return array.join('');
	  }

	  let pattern = '';
	  let prev_char_count = 0;

	  const prev_pattern = () => {
	    if (prev_char_count > 1) {
	      pattern += '{' + prev_char_count + '}';
	    }
	  };

	  array.forEach((char, i) => {
	    if (char === array[i - 1]) {
	      prev_char_count++;
	      return;
	    }

	    prev_pattern();
	    pattern += char;
	    prev_char_count = 1;
	  });
	  prev_pattern();
	  return pattern;
	};
	/**
	 * Convert array of strings to a regular expression
	 *	ex ['ab','a'] => (?:ab|a)
	 * 	ex ['a','b'] => [ab]
	 * @param {Set<string>} chars
	 * @return {string}
	 */

	const setToPattern = chars => {
	  let array = toArray(chars);
	  return arrayToPattern(array);
	};
	/**
	 *
	 * https://stackoverflow.com/questions/7376598/in-javascript-how-do-i-check-if-an-array-has-duplicate-values
	 * @param {any[]} array
	 */

	const hasDuplicates = array => {
	  return new Set(array).size !== array.length;
	};
	/**
	 * https://stackoverflow.com/questions/63006601/why-does-u-throw-an-invalid-escape-error
	 * @param {string} str
	 * @return {string}
	 */

	const escape_regex = str => {
	  return (str + '').replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu, '\\$1');
	};
	/**
	 * Return the max length of array values
	 * @param {string[]} array
	 *
	 */

	const maxValueLength = array => {
	  return array.reduce((longest, value) => Math.max(longest, unicodeLength(value)), 0);
	};
	/**
	 * @param {string} str
	 */

	const unicodeLength = str => {
	  return toArray(str).length;
	};
	/**
	 * @param {any} p
	 * @return {any[]}
	 */

	const toArray = p => Array.from(p);

	/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */
	/**
	 * Get all possible combinations of substrings that add up to the given string
	 * https://stackoverflow.com/questions/30169587/find-all-the-combination-of-substrings-that-add-up-to-the-given-string
	 * @param {string} input
	 * @return {string[][]}
	 */
	const allSubstrings = input => {
	  if (input.length === 1) return [[input]];
	  /** @type {string[][]} */

	  let result = [];
	  const start = input.substring(1);
	  const suba = allSubstrings(start);
	  suba.forEach(function (subresult) {
	    let tmp = subresult.slice(0);
	    tmp[0] = input.charAt(0) + tmp[0];
	    result.push(tmp);
	    tmp = subresult.slice(0);
	    tmp.unshift(input.charAt(0));
	    result.push(tmp);
	  });
	  return result;
	};

	/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */

	/**
	 * @typedef {{[key:string]:string}} TUnicodeMap
	 * @typedef {{[key:string]:Set<string>}} TUnicodeSets
	 * @typedef {[[number,number]]} TCodePoints
	 * @typedef {{folded:string,composed:string,code_point:number}} TCodePointObj
	 * @typedef {{start:number,end:number,length:number,substr:string}} TSequencePart
	 */
	/** @type {TCodePoints} */

	const code_points = [[0, 65535]];
	const accent_pat = '[\u0300-\u036F\u{b7}\u{2be}\u{2bc}]';
	/** @type {TUnicodeMap} */

	let unicode_map;
	/** @type {RegExp} */

	let multi_char_reg;
	const max_char_length = 3;
	/** @type {TUnicodeMap} */

	const latin_convert = {};
	/** @type {TUnicodeMap} */

	const latin_condensed = {
	  '/': '⁄∕',
	  '0': '߀',
	  "a": "ⱥɐɑ",
	  "aa": "ꜳ",
	  "ae": "æǽǣ",
	  "ao": "ꜵ",
	  "au": "ꜷ",
	  "av": "ꜹꜻ",
	  "ay": "ꜽ",
	  "b": "ƀɓƃ",
	  "c": "ꜿƈȼↄ",
	  "d": "đɗɖᴅƌꮷԁɦ",
	  "e": "ɛǝᴇɇ",
	  "f": "ꝼƒ",
	  "g": "ǥɠꞡᵹꝿɢ",
	  "h": "ħⱨⱶɥ",
	  "i": "ɨı",
	  "j": "ɉȷ",
	  "k": "ƙⱪꝁꝃꝅꞣ",
	  "l": "łƚɫⱡꝉꝇꞁɭ",
	  "m": "ɱɯϻ",
	  "n": "ꞥƞɲꞑᴎлԉ",
	  "o": "øǿɔɵꝋꝍᴑ",
	  "oe": "œ",
	  "oi": "ƣ",
	  "oo": "ꝏ",
	  "ou": "ȣ",
	  "p": "ƥᵽꝑꝓꝕρ",
	  "q": "ꝗꝙɋ",
	  "r": "ɍɽꝛꞧꞃ",
	  "s": "ßȿꞩꞅʂ",
	  "t": "ŧƭʈⱦꞇ",
	  "th": "þ",
	  "tz": "ꜩ",
	  "u": "ʉ",
	  "v": "ʋꝟʌ",
	  "vy": "ꝡ",
	  "w": "ⱳ",
	  "y": "ƴɏỿ",
	  "z": "ƶȥɀⱬꝣ",
	  "hv": "ƕ"
	};

	for (let latin in latin_condensed) {
	  let unicode = latin_condensed[latin] || '';

	  for (let i = 0; i < unicode.length; i++) {
	    let char = unicode.substring(i, i + 1);
	    latin_convert[char] = latin;
	  }
	}

	const convert_pat = new RegExp(Object.keys(latin_convert).join('|') + '|' + accent_pat, 'gu');
	/**
	 * Initialize the unicode_map from the give code point ranges
	 *
	 * @param {TCodePoints=} _code_points
	 */

	const initialize = _code_points => {
	  if (unicode_map !== undefined) return;
	  unicode_map = generateMap(_code_points || code_points);
	};
	/**
	 * Helper method for normalize a string
	 * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize
	 * @param {string} str
	 * @param {string} form
	 */

	const normalize = (str, form = 'NFKD') => str.normalize(form);
	/**
	 * Remove accents without reordering string
	 * calling str.normalize('NFKD') on \u{594}\u{595}\u{596} becomes \u{596}\u{594}\u{595}
	 * via https://github.com/krisk/Fuse/issues/133#issuecomment-318692703
	 * @param {string} str
	 * @return {string}
	 */

	const asciifold = str => {
	  return toArray(str).reduce(
	  /**
	   * @param {string} result
	   * @param {string} char
	   */
	  (result, char) => {
	    return result + _asciifold(char);
	  }, '');
	};
	/**
	 * @param {string} str
	 * @return {string}
	 */

	const _asciifold = str => {
	  str = normalize(str).toLowerCase().replace(convert_pat, (
	  /** @type {string} */
	  char) => {
	    return latin_convert[char] || '';
	  }); //return str;

	  return normalize(str, 'NFC');
	};
	/**
	 * Generate a list of unicode variants from the list of code points
	 * @param {TCodePoints} code_points
	 * @yield {TCodePointObj}
	 */

	function* generator(code_points) {
	  for (const [code_point_min, code_point_max] of code_points) {
	    for (let i = code_point_min; i <= code_point_max; i++) {
	      let composed = String.fromCharCode(i);
	      let folded = asciifold(composed);

	      if (folded == composed.toLowerCase()) {
	        continue;
	      } // skip when folded is a string longer than 3 characters long
	      // bc the resulting regex patterns will be long
	      // eg:
	      // folded صلى الله عليه وسلم length 18 code point 65018
	      // folded جل جلاله length 8 code point 65019


	      if (folded.length > max_char_length) {
	        continue;
	      }

	      if (folded.length == 0) {
	        continue;
	      }

	      yield {
	        folded: folded,
	        composed: composed,
	        code_point: i
	      };
	    }
	  }
	}
	/**
	 * Generate a unicode map from the list of code points
	 * @param {TCodePoints} code_points
	 * @return {TUnicodeSets}
	 */

	const generateSets = code_points => {
	  /** @type {{[key:string]:Set<string>}} */
	  const unicode_sets = {};
	  /**
	   * @param {string} folded
	   * @param {string} to_add
	   */

	  const addMatching = (folded, to_add) => {
	    /** @type {Set<string>} */
	    const folded_set = unicode_sets[folded] || new Set();
	    const patt = new RegExp('^' + setToPattern(folded_set) + '$', 'iu');

	    if (to_add.match(patt)) {
	      return;
	    }

	    folded_set.add(escape_regex(to_add));
	    unicode_sets[folded] = folded_set;
	  };

	  for (let value of generator(code_points)) {
	    addMatching(value.folded, value.folded);
	    addMatching(value.folded, value.composed);
	  }

	  return unicode_sets;
	};
	/**
	 * Generate a unicode map from the list of code points
	 * ae => (?:(?:ae|Æ|Ǽ|Ǣ)|(?:A|Ⓐ|Ａ...)(?:E|ɛ|Ⓔ...))
	 *
	 * @param {TCodePoints} code_points
	 * @return {TUnicodeMap}
	 */

	const generateMap = code_points => {
	  /** @type {TUnicodeSets} */
	  const unicode_sets = generateSets(code_points);
	  /** @type {TUnicodeMap} */

	  const unicode_map = {};
	  /** @type {string[]} */

	  let multi_char = [];

	  for (let folded in unicode_sets) {
	    let set = unicode_sets[folded];

	    if (set) {
	      unicode_map[folded] = setToPattern(set);
	    }

	    if (folded.length > 1) {
	      multi_char.push(escape_regex(folded));
	    }
	  }

	  multi_char.sort((a, b) => b.length - a.length);
	  const multi_char_patt = arrayToPattern(multi_char);
	  multi_char_reg = new RegExp('^' + multi_char_patt, 'u');
	  return unicode_map;
	};
	/**
	 * Map each element of an array from it's folded value to all possible unicode matches
	 * @param {string[]} strings
	 * @param {number} min_replacement
	 * @return {string}
	 */

	const mapSequence = (strings, min_replacement = 1) => {
	  let chars_replaced = 0;
	  strings = strings.map(str => {
	    if (unicode_map[str]) {
	      chars_replaced += str.length;
	    }

	    return unicode_map[str] || str;
	  });

	  if (chars_replaced >= min_replacement) {
	    return sequencePattern(strings);
	  }

	  return '';
	};
	/**
	 * Convert a short string and split it into all possible patterns
	 * Keep a pattern only if min_replacement is met
	 *
	 * 'abc'
	 * 		=> [['abc'],['ab','c'],['a','bc'],['a','b','c']]
	 *		=> ['abc-pattern','ab-c-pattern'...]
	 *
	 *
	 * @param {string} str
	 * @param {number} min_replacement
	 * @return {string}
	 */

	const substringsToPattern = (str, min_replacement = 1) => {
	  min_replacement = Math.max(min_replacement, str.length - 1);
	  return arrayToPattern(allSubstrings(str).map(sub_pat => {
	    return mapSequence(sub_pat, min_replacement);
	  }));
	};
	/**
	 * Convert an array of sequences into a pattern
	 * [{start:0,end:3,length:3,substr:'iii'}...] => (?:iii...)
	 *
	 * @param {Sequence[]} sequences
	 * @param {boolean} all
	 */

	const sequencesToPattern = (sequences, all = true) => {
	  let min_replacement = sequences.length > 1 ? 1 : 0;
	  return arrayToPattern(sequences.map(sequence => {
	    let seq = [];
	    const len = all ? sequence.length() : sequence.length() - 1;

	    for (let j = 0; j < len; j++) {
	      seq.push(substringsToPattern(sequence.substrs[j] || '', min_replacement));
	    }

	    return sequencePattern(seq);
	  }));
	};
	/**
	 * Return true if the sequence is already in the sequences
	 * @param {Sequence} needle_seq
	 * @param {Sequence[]} sequences
	 */


	const inSequences = (needle_seq, sequences) => {
	  for (const seq of sequences) {
	    if (seq.start != needle_seq.start || seq.end != needle_seq.end) {
	      continue;
	    }

	    if (seq.substrs.join('') !== needle_seq.substrs.join('')) {
	      continue;
	    }

	    let needle_parts = needle_seq.parts;
	    /**
	     * @param {TSequencePart} part
	     */

	    const filter = part => {
	      for (const needle_part of needle_parts) {
	        if (needle_part.start === part.start && needle_part.substr === part.substr) {
	          return false;
	        }

	        if (part.length == 1 || needle_part.length == 1) {
	          continue;
	        } // check for overlapping parts
	        // a = ['::=','==']
	        // b = ['::','===']
	        // a = ['r','sm']
	        // b = ['rs','m']


	        if (part.start < needle_part.start && part.end > needle_part.start) {
	          return true;
	        }

	        if (needle_part.start < part.start && needle_part.end > part.start) {
	          return true;
	        }
	      }

	      return false;
	    };

	    let filtered = seq.parts.filter(filter);

	    if (filtered.length > 0) {
	      continue;
	    }

	    return true;
	  }

	  return false;
	};

	class Sequence {
	  constructor() {
	    /** @type {TSequencePart[]} */
	    this.parts = [];
	    /** @type {string[]} */

	    this.substrs = [];
	    this.start = 0;
	    this.end = 0;
	  }
	  /**
	   * @param {TSequencePart|undefined} part
	   */


	  add(part) {
	    if (part) {
	      this.parts.push(part);
	      this.substrs.push(part.substr);
	      this.start = Math.min(part.start, this.start);
	      this.end = Math.max(part.end, this.end);
	    }
	  }

	  last() {
	    return this.parts[this.parts.length - 1];
	  }

	  length() {
	    return this.parts.length;
	  }
	  /**
	   * @param {number} position
	   * @param {TSequencePart} last_piece
	   */


	  clone(position, last_piece) {
	    let clone = new Sequence();
	    let parts = JSON.parse(JSON.stringify(this.parts));
	    let last_part = parts.pop();

	    for (const part of parts) {
	      clone.add(part);
	    }

	    let last_substr = last_piece.substr.substring(0, position - last_part.start);
	    let clone_last_len = last_substr.length;
	    clone.add({
	      start: last_part.start,
	      end: last_part.start + clone_last_len,
	      length: clone_last_len,
	      substr: last_substr
	    });
	    return clone;
	  }

	}
	/**
	 * Expand a regular expression pattern to include unicode variants
	 * 	eg /a/ becomes /aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑAⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ/
	 *
	 * Issue:
	 *  ﺊﺋ [ 'ﺊ = \\u{fe8a}', 'ﺋ = \\u{fe8b}' ]
	 *	becomes:	ئئ [ 'ي = \\u{64a}', 'ٔ = \\u{654}', 'ي = \\u{64a}', 'ٔ = \\u{654}' ]
	 *
	 *	İĲ = IIJ = ⅡJ
	 *
	 * 	1/2/4
	 *
	 * @param {string} str
	 * @return {string|undefined}
	 */


	const getPattern = str => {
	  initialize();
	  str = asciifold(str);
	  let pattern = '';
	  let sequences = [new Sequence()];

	  for (let i = 0; i < str.length; i++) {
	    let substr = str.substring(i);
	    let match = substr.match(multi_char_reg);
	    const char = str.substring(i, i + 1);
	    const match_str = match ? match[0] : null; // loop through sequences
	    // add either the char or multi_match

	    let overlapping = [];
	    let added_types = new Set();

	    for (const sequence of sequences) {
	      const last_piece = sequence.last();

	      if (!last_piece || last_piece.length == 1 || last_piece.end <= i) {
	        // if we have a multi match
	        if (match_str) {
	          const len = match_str.length;
	          sequence.add({
	            start: i,
	            end: i + len,
	            length: len,
	            substr: match_str
	          });
	          added_types.add('1');
	        } else {
	          sequence.add({
	            start: i,
	            end: i + 1,
	            length: 1,
	            substr: char
	          });
	          added_types.add('2');
	        }
	      } else if (match_str) {
	        let clone = sequence.clone(i, last_piece);
	        const len = match_str.length;
	        clone.add({
	          start: i,
	          end: i + len,
	          length: len,
	          substr: match_str
	        });
	        overlapping.push(clone);
	      } else {
	        // don't add char
	        // adding would create invalid patterns: 234 => [2,34,4]
	        added_types.add('3');
	      }
	    } // if we have overlapping


	    if (overlapping.length > 0) {
	      // ['ii','iii'] before ['i','i','iii']
	      overlapping = overlapping.sort((a, b) => {
	        return a.length() - b.length();
	      });

	      for (let clone of overlapping) {
	        // don't add if we already have an equivalent sequence
	        if (inSequences(clone, sequences)) {
	          continue;
	        }

	        sequences.push(clone);
	      }

	      continue;
	    } // if we haven't done anything unique
	    // clean up the patterns
	    // helps keep patterns smaller
	    // if str = 'r₨㎧aarss', pattern will be 446 instead of 655


	    if (i > 0 && added_types.size == 1 && !added_types.has('3')) {
	      pattern += sequencesToPattern(sequences, false);
	      let new_seq = new Sequence();
	      const old_seq = sequences[0];

	      if (old_seq) {
	        new_seq.add(old_seq.last());
	      }

	      sequences = [new_seq];
	    }
	  }

	  pattern += sequencesToPattern(sequences, true);
	  return pattern;
	};

	/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */

	/**
	 * A property getter resolving dot-notation
	 * @param  {Object}  obj     The root object to fetch property on
	 * @param  {String}  name    The optionally dotted property name to fetch
	 * @return {Object}          The resolved property value
	 */
	const getAttr = (obj, name) => {
	  if (!obj) return;
	  return obj[name];
	};
	/**
	 * A property getter resolving dot-notation
	 * @param  {Object}  obj     The root object to fetch property on
	 * @param  {String}  name    The optionally dotted property name to fetch
	 * @return {Object}          The resolved property value
	 */

	const getAttrNesting = (obj, name) => {
	  if (!obj) return;
	  var part,
	      names = name.split(".");

	  while ((part = names.shift()) && (obj = obj[part]));

	  return obj;
	};
	/**
	 * Calculates how close of a match the
	 * given value is against a search token.
	 *
	 */

	const scoreValue = (value, token, weight) => {
	  var score, pos;
	  if (!value) return 0;
	  value = value + '';
	  if (token.regex == null) return 0;
	  pos = value.search(token.regex);
	  if (pos === -1) return 0;
	  score = token.string.length / value.length;
	  if (pos === 0) score += 0.5;
	  return score * weight;
	};
	/**
	 * Cast object property to an array if it exists and has a value
	 *
	 */

	const propToArray = (obj, key) => {
	  var value = obj[key];
	  if (typeof value == 'function') return value;

	  if (value && !Array.isArray(value)) {
	    obj[key] = [value];
	  }
	};
	/**
	 * Iterates over arrays and hashes.
	 *
	 * ```
	 * iterate(this.items, function(item, id) {
	 *    // invoked for each item
	 * });
	 * ```
	 *
	 */

	const iterate$1 = (object, callback) => {
	  if (Array.isArray(object)) {
	    object.forEach(callback);
	  } else {
	    for (var key in object) {
	      if (object.hasOwnProperty(key)) {
	        callback(object[key], key);
	      }
	    }
	  }
	};
	const cmp = (a, b) => {
	  if (typeof a === 'number' && typeof b === 'number') {
	    return a > b ? 1 : a < b ? -1 : 0;
	  }

	  a = asciifold(a + '').toLowerCase();
	  b = asciifold(b + '').toLowerCase();
	  if (a > b) return 1;
	  if (b > a) return -1;
	  return 0;
	};

	/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */

	/**
	 * sifter.js
	 * Copyright (c) 2013–2020 Brian Reavis & contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 * @author Brian Reavis <brian@thirdroute.com>
	 */

	class Sifter {
	  // []|{};

	  /**
	   * Textually searches arrays and hashes of objects
	   * by property (or multiple properties). Designed
	   * specifically for autocomplete.
	   *
	   */
	  constructor(items, settings) {
	    this.items = void 0;
	    this.settings = void 0;
	    this.items = items;
	    this.settings = settings || {
	      diacritics: true
	    };
	  }

	  /**
	   * Splits a search string into an array of individual
	   * regexps to be used to match results.
	   *
	   */
	  tokenize(query, respect_word_boundaries, weights) {
	    if (!query || !query.length) return [];
	    const tokens = [];
	    const words = query.split(/\s+/);
	    var field_regex;

	    if (weights) {
	      field_regex = new RegExp('^(' + Object.keys(weights).map(escape_regex).join('|') + ')\:(.*)$');
	    }

	    words.forEach(word => {
	      let field_match;
	      let field = null;
	      let regex = null; // look for "field:query" tokens

	      if (field_regex && (field_match = word.match(field_regex))) {
	        field = field_match[1];
	        word = field_match[2];
	      }

	      if (word.length > 0) {
	        if (this.settings.diacritics) {
	          regex = getPattern(word) || null;
	        } else {
	          regex = escape_regex(word);
	        }

	        if (regex && respect_word_boundaries) regex = "\\b" + regex;
	      }

	      tokens.push({
	        string: word,
	        regex: regex ? new RegExp(regex, 'iu') : null,
	        field: field
	      });
	    });
	    return tokens;
	  }

	  /**
	   * Returns a function to be used to score individual results.
	   *
	   * Good matches will have a higher score than poor matches.
	   * If an item is not a match, 0 will be returned by the function.
	   *
	   * @returns {T.ScoreFn}
	   */
	  getScoreFunction(query, options) {
	    var search = this.prepareSearch(query, options);
	    return this._getScoreFunction(search);
	  }
	  /**
	   * @returns {T.ScoreFn}
	   *
	   */


	  _getScoreFunction(search) {
	    const tokens = search.tokens,
	          token_count = tokens.length;

	    if (!token_count) {
	      return function () {
	        return 0;
	      };
	    }

	    const fields = search.options.fields,
	          weights = search.weights,
	          field_count = fields.length,
	          getAttrFn = search.getAttrFn;

	    if (!field_count) {
	      return function () {
	        return 1;
	      };
	    }
	    /**
	     * Calculates the score of an object
	     * against the search query.
	     *
	     */


	    const scoreObject = function () {
	      if (field_count === 1) {
	        return function (token, data) {
	          const field = fields[0].field;
	          return scoreValue(getAttrFn(data, field), token, weights[field] || 1);
	        };
	      }

	      return function (token, data) {
	        var sum = 0; // is the token specific to a field?

	        if (token.field) {
	          const value = getAttrFn(data, token.field);

	          if (!token.regex && value) {
	            sum += 1 / field_count;
	          } else {
	            sum += scoreValue(value, token, 1);
	          }
	        } else {
	          iterate$1(weights, (weight, field) => {
	            sum += scoreValue(getAttrFn(data, field), token, weight);
	          });
	        }

	        return sum / field_count;
	      };
	    }();

	    if (token_count === 1) {
	      return function (data) {
	        return scoreObject(tokens[0], data);
	      };
	    }

	    if (search.options.conjunction === 'and') {
	      return function (data) {
	        var score,
	            sum = 0;

	        for (let token of tokens) {
	          score = scoreObject(token, data);
	          if (score <= 0) return 0;
	          sum += score;
	        }

	        return sum / token_count;
	      };
	    } else {
	      return function (data) {
	        var sum = 0;
	        iterate$1(tokens, token => {
	          sum += scoreObject(token, data);
	        });
	        return sum / token_count;
	      };
	    }
	  }

	  /**
	   * Returns a function that can be used to compare two
	   * results, for sorting purposes. If no sorting should
	   * be performed, `null` will be returned.
	   *
	   * @return function(a,b)
	   */
	  getSortFunction(query, options) {
	    var search = this.prepareSearch(query, options);
	    return this._getSortFunction(search);
	  }

	  _getSortFunction(search) {
	    var implicit_score,
	        sort_flds = [];
	    const self = this,
	          options = search.options,
	          sort = !search.query && options.sort_empty ? options.sort_empty : options.sort;

	    if (typeof sort == 'function') {
	      return sort.bind(this);
	    }
	    /**
	     * Fetches the specified sort field value
	     * from a search result item.
	     *
	     */


	    const get_field = function get_field(name, result) {
	      if (name === '$score') return result.score;
	      return search.getAttrFn(self.items[result.id], name);
	    }; // parse options


	    if (sort) {
	      for (let s of sort) {
	        if (search.query || s.field !== '$score') {
	          sort_flds.push(s);
	        }
	      }
	    } // the "$score" field is implied to be the primary
	    // sort field, unless it's manually specified


	    if (search.query) {
	      implicit_score = true;

	      for (let fld of sort_flds) {
	        if (fld.field === '$score') {
	          implicit_score = false;
	          break;
	        }
	      }

	      if (implicit_score) {
	        sort_flds.unshift({
	          field: '$score',
	          direction: 'desc'
	        });
	      } // without a search.query, all items will have the same score

	    } else {
	      sort_flds = sort_flds.filter(fld => fld.field !== '$score');
	    } // build function


	    const sort_flds_count = sort_flds.length;

	    if (!sort_flds_count) {
	      return null;
	    }

	    return function (a, b) {
	      var result, field;

	      for (let sort_fld of sort_flds) {
	        field = sort_fld.field;
	        let multiplier = sort_fld.direction === 'desc' ? -1 : 1;
	        result = multiplier * cmp(get_field(field, a), get_field(field, b));
	        if (result) return result;
	      }

	      return 0;
	    };
	  }

	  /**
	   * Parses a search query and returns an object
	   * with tokens and fields ready to be populated
	   * with results.
	   *
	   */
	  prepareSearch(query, optsUser) {
	    const weights = {};
	    var options = Object.assign({}, optsUser);
	    propToArray(options, 'sort');
	    propToArray(options, 'sort_empty'); // convert fields to new format

	    if (options.fields) {
	      propToArray(options, 'fields');
	      const fields = [];
	      options.fields.forEach(field => {
	        if (typeof field == 'string') {
	          field = {
	            field: field,
	            weight: 1
	          };
	        }

	        fields.push(field);
	        weights[field.field] = 'weight' in field ? field.weight : 1;
	      });
	      options.fields = fields;
	    }

	    return {
	      options: options,
	      query: query.toLowerCase().trim(),
	      tokens: this.tokenize(query, options.respect_word_boundaries, weights),
	      total: 0,
	      items: [],
	      weights: weights,
	      getAttrFn: options.nesting ? getAttrNesting : getAttr
	    };
	  }

	  /**
	   * Searches through all items and returns a sorted array of matches.
	   *
	   */
	  search(query, options) {
	    var self = this,
	        score,
	        search;
	    search = this.prepareSearch(query, options);
	    options = search.options;
	    query = search.query; // generate result scoring function

	    const fn_score = options.score || self._getScoreFunction(search); // perform search and sort


	    if (query.length) {
	      iterate$1(self.items, (item, id) => {
	        score = fn_score(item);

	        if (options.filter === false || score > 0) {
	          search.items.push({
	            'score': score,
	            'id': id
	          });
	        }
	      });
	    } else {
	      iterate$1(self.items, (_, id) => {
	        search.items.push({
	          'score': 1,
	          'id': id
	        });
	      });
	    }

	    const fn_sort = self._getSortFunction(search);

	    if (fn_sort) search.items.sort(fn_sort); // apply limits

	    search.total = search.items.length;

	    if (typeof options.limit === 'number') {
	      search.items = search.items.slice(0, options.limit);
	    }

	    return search;
	  }

	}

	/**
	 * Iterates over arrays and hashes.
	 *
	 * ```
	 * iterate(this.items, function(item, id) {
	 *    // invoked for each item
	 * });
	 * ```
	 *
	 */

	const iterate = (object, callback) => {
	  if (Array.isArray(object)) {
	    object.forEach(callback);
	  } else {
	    for (var key in object) {
	      if (object.hasOwnProperty(key)) {
	        callback(object[key], key);
	      }
	    }
	  }
	};

	/**
	 * Return a dom element from either a dom query string, jQuery object, a dom element or html string
	 * https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518
	 *
	 * param query should be {}
	 */

	const getDom = query => {
	  if (query.jquery) {
	    return query[0];
	  }

	  if (query instanceof HTMLElement) {
	    return query;
	  }

	  if (isHtmlString(query)) {
	    var tpl = document.createElement('template');
	    tpl.innerHTML = query.trim(); // Never return a text node of whitespace as the result

	    return tpl.content.firstChild;
	  }

	  return document.querySelector(query);
	};
	const isHtmlString = arg => {
	  if (typeof arg === 'string' && arg.indexOf('<') > -1) {
	    return true;
	  }

	  return false;
	};
	const escapeQuery = query => {
	  return query.replace(/['"\\]/g, '\\$&');
	};
	/**
	 * Dispatch an event
	 *
	 */

	const triggerEvent = (dom_el, event_name) => {
	  var event = document.createEvent('HTMLEvents');
	  event.initEvent(event_name, true, false);
	  dom_el.dispatchEvent(event);
	};
	/**
	 * Apply CSS rules to a dom element
	 *
	 */

	const applyCSS = (dom_el, css) => {
	  Object.assign(dom_el.style, css);
	};
	/**
	 * Add css classes
	 *
	 */

	const addClasses = (elmts, ...classes) => {
	  var norm_classes = classesArray(classes);
	  elmts = castAsArray(elmts);
	  elmts.map(el => {
	    norm_classes.map(cls => {
	      el.classList.add(cls);
	    });
	  });
	};
	/**
	 * Remove css classes
	 *
	 */

	const removeClasses = (elmts, ...classes) => {
	  var norm_classes = classesArray(classes);
	  elmts = castAsArray(elmts);
	  elmts.map(el => {
	    norm_classes.map(cls => {
	      el.classList.remove(cls);
	    });
	  });
	};
	/**
	 * Return arguments
	 *
	 */

	const classesArray = args => {
	  var classes = [];
	  iterate(args, _classes => {
	    if (typeof _classes === 'string') {
	      _classes = _classes.trim().split(/[\11\12\14\15\40]/);
	    }

	    if (Array.isArray(_classes)) {
	      classes = classes.concat(_classes);
	    }
	  });
	  return classes.filter(Boolean);
	};
	/**
	 * Create an array from arg if it's not already an array
	 *
	 */

	const castAsArray = arg => {
	  if (!Array.isArray(arg)) {
	    arg = [arg];
	  }

	  return arg;
	};
	/**
	 * Get the closest node to the evt.target matching the selector
	 * Stops at wrapper
	 *
	 */

	const parentMatch = (target, selector, wrapper) => {
	  if (wrapper && !wrapper.contains(target)) {
	    return;
	  }

	  while (target && target.matches) {
	    if (target.matches(selector)) {
	      return target;
	    }

	    target = target.parentNode;
	  }
	};
	/**
	 * Get the first or last item from an array
	 *
	 * > 0 - right (last)
	 * <= 0 - left (first)
	 *
	 */

	const getTail = (list, direction = 0) => {
	  if (direction > 0) {
	    return list[list.length - 1];
	  }

	  return list[0];
	};
	/**
	 * Return true if an object is empty
	 *
	 */

	const isEmptyObject = obj => {
	  return Object.keys(obj).length === 0;
	};
	/**
	 * Get the index of an element amongst sibling nodes of the same type
	 *
	 */

	const nodeIndex = (el, amongst) => {
	  if (!el) return -1;
	  amongst = amongst || el.nodeName;
	  var i = 0;

	  while (el = el.previousElementSibling) {
	    if (el.matches(amongst)) {
	      i++;
	    }
	  }

	  return i;
	};
	/**
	 * Set attributes of an element
	 *
	 */

	const setAttr = (el, attrs) => {
	  iterate(attrs, (val, attr) => {
	    if (val == null) {
	      el.removeAttribute(attr);
	    } else {
	      el.setAttribute(attr, '' + val);
	    }
	  });
	};
	/**
	 * Replace a node
	 */

	const replaceNode = (existing, replacement) => {
	  if (existing.parentNode) existing.parentNode.replaceChild(replacement, existing);
	};

	/**
	 * highlight v3 | MIT license | Johann Burkard <jb@eaio.com>
	 * Highlights arbitrary terms in a node.
	 *
	 * - Modified by Marshal <beatgates@gmail.com> 2011-6-24 (added regex)
	 * - Modified by Brian Reavis <brian@thirdroute.com> 2012-8-27 (cleanup)
	 */
	const highlight = (element, regex) => {
	  if (regex === null) return; // convet string to regex

	  if (typeof regex === 'string') {
	    if (!regex.length) return;
	    regex = new RegExp(regex, 'i');
	  } // Wrap matching part of text node with highlighting <span>, e.g.
	  // Soccer  ->  <span class="highlight">Soc</span>cer  for regex = /soc/i


	  const highlightText = node => {
	    var match = node.data.match(regex);

	    if (match && node.data.length > 0) {
	      var spannode = document.createElement('span');
	      spannode.className = 'highlight';
	      var middlebit = node.splitText(match.index);
	      middlebit.splitText(match[0].length);
	      var middleclone = middlebit.cloneNode(true);
	      spannode.appendChild(middleclone);
	      replaceNode(middlebit, spannode);
	      return 1;
	    }

	    return 0;
	  }; // Recurse element node, looking for child text nodes to highlight, unless element
	  // is childless, <script>, <style>, or already highlighted: <span class="hightlight">


	  const highlightChildren = node => {
	    if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName) && (node.className !== 'highlight' || node.tagName !== 'SPAN')) {
	      Array.from(node.childNodes).forEach(element => {
	        highlightRecursive(element);
	      });
	    }
	  };

	  const highlightRecursive = node => {
	    if (node.nodeType === 3) {
	      return highlightText(node);
	    }

	    highlightChildren(node);
	    return 0;
	  };

	  highlightRecursive(element);
	};
	/**
	 * removeHighlight fn copied from highlight v5 and
	 * edited to remove with(), pass js strict mode, and use without jquery
	 */

	const removeHighlight = el => {
	  var elements = el.querySelectorAll("span.highlight");
	  Array.prototype.forEach.call(elements, function (el) {
	    var parent = el.parentNode;
	    parent.replaceChild(el.firstChild, el);
	    parent.normalize();
	  });
	};

	const KEY_A = 65;
	const KEY_RETURN = 13;
	const KEY_ESC = 27;
	const KEY_LEFT = 37;
	const KEY_UP = 38;
	const KEY_RIGHT = 39;
	const KEY_DOWN = 40;
	const KEY_BACKSPACE = 8;
	const KEY_DELETE = 46;
	const KEY_TAB = 9;
	const IS_MAC = typeof navigator === 'undefined' ? false : /Mac/.test(navigator.userAgent);
	const KEY_SHORTCUT = IS_MAC ? 'metaKey' : 'ctrlKey'; // ctrl key or apple key for ma

	var defaults = {
	  options: [],
	  optgroups: [],
	  plugins: [],
	  delimiter: ',',
	  splitOn: null,
	  // regexp or string for splitting up values from a paste command
	  persist: true,
	  diacritics: true,
	  create: null,
	  createOnBlur: false,
	  createFilter: null,
	  highlight: true,
	  openOnFocus: true,
	  shouldOpen: null,
	  maxOptions: 50,
	  maxItems: null,
	  hideSelected: null,
	  duplicates: false,
	  addPrecedence: false,
	  selectOnTab: false,
	  preload: null,
	  allowEmptyOption: false,
	  //closeAfterSelect: false,
	  loadThrottle: 300,
	  loadingClass: 'loading',
	  dataAttr: null,
	  //'data-data',
	  optgroupField: 'optgroup',
	  valueField: 'value',
	  labelField: 'text',
	  disabledField: 'disabled',
	  optgroupLabelField: 'label',
	  optgroupValueField: 'value',
	  lockOptgroupOrder: false,
	  sortField: '$order',
	  searchField: ['text'],
	  searchConjunction: 'and',
	  mode: null,
	  wrapperClass: 'ts-wrapper',
	  controlClass: 'ts-control',
	  dropdownClass: 'ts-dropdown',
	  dropdownContentClass: 'ts-dropdown-content',
	  itemClass: 'item',
	  optionClass: 'option',
	  dropdownParent: null,
	  controlInput: '<input type="text" autocomplete="off" size="1" />',
	  copyClassesToDropdown: false,
	  placeholder: null,
	  hidePlaceholder: null,
	  shouldLoad: function (query) {
	    return query.length > 0;
	  },

	  /*
	  load                 : null, // function(query, callback) { ... }
	  score                : null, // function(search) { ... }
	  onInitialize         : null, // function() { ... }
	  onChange             : null, // function(value) { ... }
	  onItemAdd            : null, // function(value, $item) { ... }
	  onItemRemove         : null, // function(value) { ... }
	  onClear              : null, // function() { ... }
	  onOptionAdd          : null, // function(value, data) { ... }
	  onOptionRemove       : null, // function(value) { ... }
	  onOptionClear        : null, // function() { ... }
	  onOptionGroupAdd     : null, // function(id, data) { ... }
	  onOptionGroupRemove  : null, // function(id) { ... }
	  onOptionGroupClear   : null, // function() { ... }
	  onDropdownOpen       : null, // function(dropdown) { ... }
	  onDropdownClose      : null, // function(dropdown) { ... }
	  onType               : null, // function(str) { ... }
	  onDelete             : null, // function(values) { ... }
	  */
	  render: {
	    /*
	    item: null,
	    optgroup: null,
	    optgroup_header: null,
	    option: null,
	    option_create: null
	    */
	  }
	};

	/**
	 * Converts a scalar to its best string representation
	 * for hash keys and HTML attribute values.
	 *
	 * Transformations:
	 *   'str'     -> 'str'
	 *   null      -> ''
	 *   undefined -> ''
	 *   true      -> '1'
	 *   false     -> '0'
	 *   0         -> '0'
	 *   1         -> '1'
	 *
	 */
	const hash_key = value => {
	  if (typeof value === 'undefined' || value === null) return null;
	  return get_hash(value);
	};
	const get_hash = value => {
	  if (typeof value === 'boolean') return value ? '1' : '0';
	  return value + '';
	};
	/**
	 * Escapes a string for use within HTML.
	 *
	 */

	const escape_html = str => {
	  return (str + '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
	};
	/**
	 * Debounce the user provided load function
	 *
	 */

	const loadDebounce = (fn, delay) => {
	  var timeout;
	  return function (value, callback) {
	    var self = this;

	    if (timeout) {
	      self.loading = Math.max(self.loading - 1, 0);
	      clearTimeout(timeout);
	    }

	    timeout = setTimeout(function () {
	      timeout = null;
	      self.loadedSearches[value] = true;
	      fn.call(self, value, callback);
	    }, delay);
	  };
	};
	/**
	 * Debounce all fired events types listed in `types`
	 * while executing the provided `fn`.
	 *
	 */

	const debounce_events = (self, types, fn) => {
	  var type;
	  var trigger = self.trigger;
	  var event_args = {}; // override trigger method

	  self.trigger = function () {
	    var type = arguments[0];

	    if (types.indexOf(type) !== -1) {
	      event_args[type] = arguments;
	    } else {
	      return trigger.apply(self, arguments);
	    }
	  }; // invoke provided function


	  fn.apply(self, []);
	  self.trigger = trigger; // trigger queued events

	  for (type of types) {
	    if (type in event_args) {
	      trigger.apply(self, event_args[type]);
	    }
	  }
	};
	/**
	 * Determines the current selection within a text input control.
	 * Returns an object containing:
	 *   - start
	 *   - length
	 *
	 */

	const getSelection = input => {
	  return {
	    start: input.selectionStart || 0,
	    length: (input.selectionEnd || 0) - (input.selectionStart || 0)
	  };
	};
	/**
	 * Prevent default
	 *
	 */

	const preventDefault = (evt, stop = false) => {
	  if (evt) {
	    evt.preventDefault();

	    if (stop) {
	      evt.stopPropagation();
	    }
	  }
	};
	/**
	 * Add event helper
	 *
	 */

	const addEvent = (target, type, callback, options) => {
	  target.addEventListener(type, callback, options);
	};
	/**
	 * Return true if the requested key is down
	 * Will return false if more than one control character is pressed ( when [ctrl+shift+a] != [ctrl+a] )
	 * The current evt may not always set ( eg calling advanceSelection() )
	 *
	 */

	const isKeyDown = (key_name, evt) => {
	  if (!evt) {
	    return false;
	  }

	  if (!evt[key_name]) {
	    return false;
	  }

	  var count = (evt.altKey ? 1 : 0) + (evt.ctrlKey ? 1 : 0) + (evt.shiftKey ? 1 : 0) + (evt.metaKey ? 1 : 0);

	  if (count === 1) {
	    return true;
	  }

	  return false;
	};
	/**
	 * Get the id of an element
	 * If the id attribute is not set, set the attribute with the given id
	 *
	 */

	const getId = (el, id) => {
	  const existing_id = el.getAttribute('id');

	  if (existing_id) {
	    return existing_id;
	  }

	  el.setAttribute('id', id);
	  return id;
	};
	/**
	 * Returns a string with backslashes added before characters that need to be escaped.
	 */

	const addSlashes = str => {
	  return str.replace(/[\\"']/g, '\\$&');
	};
	/**
	 *
	 */

	const append = (parent, node) => {
	  if (node) parent.append(node);
	};

	function getSettings(input, settings_user) {
	  var settings = Object.assign({}, defaults, settings_user);
	  var attr_data = settings.dataAttr;
	  var field_label = settings.labelField;
	  var field_value = settings.valueField;
	  var field_disabled = settings.disabledField;
	  var field_optgroup = settings.optgroupField;
	  var field_optgroup_label = settings.optgroupLabelField;
	  var field_optgroup_value = settings.optgroupValueField;
	  var tag_name = input.tagName.toLowerCase();
	  var placeholder = input.getAttribute('placeholder') || input.getAttribute('data-placeholder');

	  if (!placeholder && !settings.allowEmptyOption) {
	    let option = input.querySelector('option[value=""]');

	    if (option) {
	      placeholder = option.textContent;
	    }
	  }

	  var settings_element = {
	    placeholder: placeholder,
	    options: [],
	    optgroups: [],
	    items: [],
	    maxItems: null
	  };
	  /**
	   * Initialize from a <select> element.
	   *
	   */

	  var init_select = () => {
	    var tagName;
	    var options = settings_element.options;
	    var optionsMap = {};
	    var group_count = 1;

	    var readData = el => {
	      var data = Object.assign({}, el.dataset); // get plain object from DOMStringMap

	      var json = attr_data && data[attr_data];

	      if (typeof json === 'string' && json.length) {
	        data = Object.assign(data, JSON.parse(json));
	      }

	      return data;
	    };

	    var addOption = (option, group) => {
	      var value = hash_key(option.value);
	      if (value == null) return;
	      if (!value && !settings.allowEmptyOption) return; // if the option already exists, it's probably been
	      // duplicated in another optgroup. in this case, push
	      // the current group to the "optgroup" property on the
	      // existing option so that it's rendered in both places.

	      if (optionsMap.hasOwnProperty(value)) {
	        if (group) {
	          var arr = optionsMap[value][field_optgroup];

	          if (!arr) {
	            optionsMap[value][field_optgroup] = group;
	          } else if (!Array.isArray(arr)) {
	            optionsMap[value][field_optgroup] = [arr, group];
	          } else {
	            arr.push(group);
	          }
	        }
	      } else {
	        var option_data = readData(option);
	        option_data[field_label] = option_data[field_label] || option.textContent;
	        option_data[field_value] = option_data[field_value] || value;
	        option_data[field_disabled] = option_data[field_disabled] || option.disabled;
	        option_data[field_optgroup] = option_data[field_optgroup] || group;
	        option_data.$option = option;
	        optionsMap[value] = option_data;
	        options.push(option_data);
	      }

	      if (option.selected) {
	        settings_element.items.push(value);
	      }
	    };

	    var addGroup = optgroup => {
	      var id, optgroup_data;
	      optgroup_data = readData(optgroup);
	      optgroup_data[field_optgroup_label] = optgroup_data[field_optgroup_label] || optgroup.getAttribute('label') || '';
	      optgroup_data[field_optgroup_value] = optgroup_data[field_optgroup_value] || group_count++;
	      optgroup_data[field_disabled] = optgroup_data[field_disabled] || optgroup.disabled;
	      settings_element.optgroups.push(optgroup_data);
	      id = optgroup_data[field_optgroup_value];
	      iterate(optgroup.children, option => {
	        addOption(option, id);
	      });
	    };

	    settings_element.maxItems = input.hasAttribute('multiple') ? null : 1;
	    iterate(input.children, child => {
	      tagName = child.tagName.toLowerCase();

	      if (tagName === 'optgroup') {
	        addGroup(child);
	      } else if (tagName === 'option') {
	        addOption(child);
	      }
	    });
	  };
	  /**
	   * Initialize from a <input type="text"> element.
	   *
	   */


	  var init_textbox = () => {
	    const data_raw = input.getAttribute(attr_data);

	    if (!data_raw) {
	      var value = input.value.trim() || '';
	      if (!settings.allowEmptyOption && !value.length) return;
	      const values = value.split(settings.delimiter);
	      iterate(values, value => {
	        const option = {};
	        option[field_label] = value;
	        option[field_value] = value;
	        settings_element.options.push(option);
	      });
	      settings_element.items = values;
	    } else {
	      settings_element.options = JSON.parse(data_raw);
	      iterate(settings_element.options, opt => {
	        settings_element.items.push(opt[field_value]);
	      });
	    }
	  };

	  if (tag_name === 'select') {
	    init_select();
	  } else {
	    init_textbox();
	  }

	  return Object.assign({}, defaults, settings_element, settings_user);
	}

	var instance_i = 0;
	class TomSelect extends MicroPlugin(MicroEvent) {
	  // @deprecated 1.8
	  constructor(input_arg, user_settings) {
	    super();
	    this.control_input = void 0;
	    this.wrapper = void 0;
	    this.dropdown = void 0;
	    this.control = void 0;
	    this.dropdown_content = void 0;
	    this.focus_node = void 0;
	    this.order = 0;
	    this.settings = void 0;
	    this.input = void 0;
	    this.tabIndex = void 0;
	    this.is_select_tag = void 0;
	    this.rtl = void 0;
	    this.inputId = void 0;
	    this._destroy = void 0;
	    this.sifter = void 0;
	    this.isOpen = false;
	    this.isDisabled = false;
	    this.isRequired = void 0;
	    this.isInvalid = false;
	    this.isValid = true;
	    this.isLocked = false;
	    this.isFocused = false;
	    this.isInputHidden = false;
	    this.isSetup = false;
	    this.ignoreFocus = false;
	    this.ignoreHover = false;
	    this.hasOptions = false;
	    this.currentResults = void 0;
	    this.lastValue = '';
	    this.caretPos = 0;
	    this.loading = 0;
	    this.loadedSearches = {};
	    this.activeOption = null;
	    this.activeItems = [];
	    this.optgroups = {};
	    this.options = {};
	    this.userOptions = {};
	    this.items = [];
	    instance_i++;
	    var dir;
	    var input = getDom(input_arg);

	    if (input.tomselect) {
	      throw new Error('Tom Select already initialized on this element');
	    }

	    input.tomselect = this; // detect rtl environment

	    var computedStyle = window.getComputedStyle && window.getComputedStyle(input, null);
	    dir = computedStyle.getPropertyValue('direction'); // setup default state

	    const settings = getSettings(input, user_settings);
	    this.settings = settings;
	    this.input = input;
	    this.tabIndex = input.tabIndex || 0;
	    this.is_select_tag = input.tagName.toLowerCase() === 'select';
	    this.rtl = /rtl/i.test(dir);
	    this.inputId = getId(input, 'tomselect-' + instance_i);
	    this.isRequired = input.required; // search system

	    this.sifter = new Sifter(this.options, {
	      diacritics: settings.diacritics
	    }); // option-dependent defaults

	    settings.mode = settings.mode || (settings.maxItems === 1 ? 'single' : 'multi');

	    if (typeof settings.hideSelected !== 'boolean') {
	      settings.hideSelected = settings.mode === 'multi';
	    }

	    if (typeof settings.hidePlaceholder !== 'boolean') {
	      settings.hidePlaceholder = settings.mode !== 'multi';
	    } // set up createFilter callback


	    var filter = settings.createFilter;

	    if (typeof filter !== 'function') {
	      if (typeof filter === 'string') {
	        filter = new RegExp(filter);
	      }

	      if (filter instanceof RegExp) {
	        settings.createFilter = input => filter.test(input);
	      } else {
	        settings.createFilter = value => {
	          return this.settings.duplicates || !this.options[value];
	        };
	      }
	    }

	    this.initializePlugins(settings.plugins);
	    this.setupCallbacks();
	    this.setupTemplates(); // Create all elements

	    const wrapper = getDom('<div>');
	    const control = getDom('<div>');

	    const dropdown = this._render('dropdown');

	    const dropdown_content = getDom(`<div role="listbox" tabindex="-1">`);
	    const classes = this.input.getAttribute('class') || '';
	    const inputMode = settings.mode;
	    var control_input;
	    addClasses(wrapper, settings.wrapperClass, classes, inputMode);
	    addClasses(control, settings.controlClass);
	    append(wrapper, control);
	    addClasses(dropdown, settings.dropdownClass, inputMode);

	    if (settings.copyClassesToDropdown) {
	      addClasses(dropdown, classes);
	    }

	    addClasses(dropdown_content, settings.dropdownContentClass);
	    append(dropdown, dropdown_content);
	    getDom(settings.dropdownParent || wrapper).appendChild(dropdown); // default controlInput

	    if (isHtmlString(settings.controlInput)) {
	      control_input = getDom(settings.controlInput); // set attributes

	      var attrs = ['autocorrect', 'autocapitalize', 'autocomplete'];
	      iterate$1(attrs, attr => {
	        if (input.getAttribute(attr)) {
	          setAttr(control_input, {
	            [attr]: input.getAttribute(attr)
	          });
	        }
	      });
	      control_input.tabIndex = -1;
	      control.appendChild(control_input);
	      this.focus_node = control_input; // dom element
	    } else if (settings.controlInput) {
	      control_input = getDom(settings.controlInput);
	      this.focus_node = control_input;
	    } else {
	      control_input = getDom('<input/>');
	      this.focus_node = control;
	    }

	    this.wrapper = wrapper;
	    this.dropdown = dropdown;
	    this.dropdown_content = dropdown_content;
	    this.control = control;
	    this.control_input = control_input;
	    this.setup();
	  }
	  /**
	   * set up event bindings.
	   *
	   */


	  setup() {
	    const self = this;
	    const settings = self.settings;
	    const control_input = self.control_input;
	    const dropdown = self.dropdown;
	    const dropdown_content = self.dropdown_content;
	    const wrapper = self.wrapper;
	    const control = self.control;
	    const input = self.input;
	    const focus_node = self.focus_node;
	    const passive_event = {
	      passive: true
	    };
	    const listboxId = self.inputId + '-ts-dropdown';
	    setAttr(dropdown_content, {
	      id: listboxId
	    });
	    setAttr(focus_node, {
	      role: 'combobox',
	      'aria-haspopup': 'listbox',
	      'aria-expanded': 'false',
	      'aria-controls': listboxId
	    });
	    const control_id = getId(focus_node, self.inputId + '-ts-control');
	    const query = "label[for='" + escapeQuery(self.inputId) + "']";
	    const label = document.querySelector(query);
	    const label_click = self.focus.bind(self);

	    if (label) {
	      addEvent(label, 'click', label_click);
	      setAttr(label, {
	        for: control_id
	      });
	      const label_id = getId(label, self.inputId + '-ts-label');
	      setAttr(focus_node, {
	        'aria-labelledby': label_id
	      });
	      setAttr(dropdown_content, {
	        'aria-labelledby': label_id
	      });
	    }

	    wrapper.style.width = input.style.width;

	    if (self.plugins.names.length) {
	      const classes_plugins = 'plugin-' + self.plugins.names.join(' plugin-');
	      addClasses([wrapper, dropdown], classes_plugins);
	    }

	    if ((settings.maxItems === null || settings.maxItems > 1) && self.is_select_tag) {
	      setAttr(input, {
	        multiple: 'multiple'
	      });
	    }

	    if (settings.placeholder) {
	      setAttr(control_input, {
	        placeholder: settings.placeholder
	      });
	    } // if splitOn was not passed in, construct it from the delimiter to allow pasting universally


	    if (!settings.splitOn && settings.delimiter) {
	      settings.splitOn = new RegExp('\\s*' + escape_regex(settings.delimiter) + '+\\s*');
	    } // debounce user defined load() if loadThrottle > 0
	    // after initializePlugins() so plugins can create/modify user defined loaders


	    if (settings.load && settings.loadThrottle) {
	      settings.load = loadDebounce(settings.load, settings.loadThrottle);
	    }

	    self.control_input.type = input.type;
	    addEvent(dropdown, 'mousemove', () => {
	      self.ignoreHover = false;
	    });
	    addEvent(dropdown, 'mouseenter', e => {
	      var target_match = parentMatch(e.target, '[data-selectable]', dropdown);
	      if (target_match) self.onOptionHover(e, target_match);
	    }, {
	      capture: true
	    }); // clicking on an option should select it

	    addEvent(dropdown, 'click', evt => {
	      const option = parentMatch(evt.target, '[data-selectable]');

	      if (option) {
	        self.onOptionSelect(evt, option);
	        preventDefault(evt, true);
	      }
	    });
	    addEvent(control, 'click', evt => {
	      var target_match = parentMatch(evt.target, '[data-ts-item]', control);

	      if (target_match && self.onItemSelect(evt, target_match)) {
	        preventDefault(evt, true);
	        return;
	      } // retain focus (see control_input mousedown)


	      if (control_input.value != '') {
	        return;
	      }

	      self.onClick();
	      preventDefault(evt, true);
	    }); // keydown on focus_node for arrow_down/arrow_up

	    addEvent(focus_node, 'keydown', e => self.onKeyDown(e)); // keypress and input/keyup

	    addEvent(control_input, 'keypress', e => self.onKeyPress(e));
	    addEvent(control_input, 'input', e => self.onInput(e));
	    addEvent(focus_node, 'blur', e => self.onBlur(e));
	    addEvent(focus_node, 'focus', e => self.onFocus(e));
	    addEvent(control_input, 'paste', e => self.onPaste(e));

	    const doc_mousedown = evt => {
	      // blur if target is outside of this instance
	      // dropdown is not always inside wrapper
	      const target = evt.composedPath()[0];

	      if (!wrapper.contains(target) && !dropdown.contains(target)) {
	        if (self.isFocused) {
	          self.blur();
	        }

	        self.inputState();
	        return;
	      } // retain focus by preventing native handling. if the
	      // event target is the input it should not be modified.
	      // otherwise, text selection within the input won't work.
	      // Fixes bug #212 which is no covered by tests


	      if (target == control_input && self.isOpen) {
	        evt.stopPropagation(); // clicking anywhere in the control should not blur the control_input (which would close the dropdown)
	      } else {
	        preventDefault(evt, true);
	      }
	    };

	    const win_scroll = () => {
	      if (self.isOpen) {
	        self.positionDropdown();
	      }
	    };

	    addEvent(document, 'mousedown', doc_mousedown);
	    addEvent(window, 'scroll', win_scroll, passive_event);
	    addEvent(window, 'resize', win_scroll, passive_event);

	    this._destroy = () => {
	      document.removeEventListener('mousedown', doc_mousedown);
	      window.removeEventListener('scroll', win_scroll);
	      window.removeEventListener('resize', win_scroll);
	      if (label) label.removeEventListener('click', label_click);
	    }; // store original html and tab index so that they can be
	    // restored when the destroy() method is called.


	    this.revertSettings = {
	      innerHTML: input.innerHTML,
	      tabIndex: input.tabIndex
	    };
	    input.tabIndex = -1;
	    input.insertAdjacentElement('afterend', self.wrapper);
	    self.sync(false);
	    settings.items = [];
	    delete settings.optgroups;
	    delete settings.options;
	    addEvent(input, 'invalid', () => {
	      if (self.isValid) {
	        self.isValid = false;
	        self.isInvalid = true;
	        self.refreshState();
	      }
	    });
	    self.updateOriginalInput();
	    self.refreshItems();
	    self.close(false);
	    self.inputState();
	    self.isSetup = true;

	    if (input.disabled) {
	      self.disable();
	    } else {
	      self.enable(); //sets tabIndex
	    }

	    self.on('change', this.onChange);
	    addClasses(input, 'tomselected', 'ts-hidden-accessible');
	    self.trigger('initialize'); // preload options

	    if (settings.preload === true) {
	      self.preload();
	    }
	  }
	  /**
	   * Register options and optgroups
	   *
	   */


	  setupOptions(options = [], optgroups = []) {
	    // build options table
	    this.addOptions(options); // build optgroup table

	    iterate$1(optgroups, optgroup => {
	      this.registerOptionGroup(optgroup);
	    });
	  }
	  /**
	   * Sets up default rendering functions.
	   */


	  setupTemplates() {
	    var self = this;
	    var field_label = self.settings.labelField;
	    var field_optgroup = self.settings.optgroupLabelField;
	    var templates = {
	      'optgroup': data => {
	        let optgroup = document.createElement('div');
	        optgroup.className = 'optgroup';
	        optgroup.appendChild(data.options);
	        return optgroup;
	      },
	      'optgroup_header': (data, escape) => {
	        return '<div class="optgroup-header">' + escape(data[field_optgroup]) + '</div>';
	      },
	      'option': (data, escape) => {
	        return '<div>' + escape(data[field_label]) + '</div>';
	      },
	      'item': (data, escape) => {
	        return '<div>' + escape(data[field_label]) + '</div>';
	      },
	      'option_create': (data, escape) => {
	        return '<div class="create">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';
	      },
	      'no_results': () => {
	        return '<div class="no-results">No results found</div>';
	      },
	      'loading': () => {
	        return '<div class="spinner"></div>';
	      },
	      'not_loading': () => {},
	      'dropdown': () => {
	        return '<div></div>';
	      }
	    };
	    self.settings.render = Object.assign({}, templates, self.settings.render);
	  }
	  /**
	   * Maps fired events to callbacks provided
	   * in the settings used when creating the control.
	   */


	  setupCallbacks() {
	    var key, fn;
	    var callbacks = {
	      'initialize': 'onInitialize',
	      'change': 'onChange',
	      'item_add': 'onItemAdd',
	      'item_remove': 'onItemRemove',
	      'item_select': 'onItemSelect',
	      'clear': 'onClear',
	      'option_add': 'onOptionAdd',
	      'option_remove': 'onOptionRemove',
	      'option_clear': 'onOptionClear',
	      'optgroup_add': 'onOptionGroupAdd',
	      'optgroup_remove': 'onOptionGroupRemove',
	      'optgroup_clear': 'onOptionGroupClear',
	      'dropdown_open': 'onDropdownOpen',
	      'dropdown_close': 'onDropdownClose',
	      'type': 'onType',
	      'load': 'onLoad',
	      'focus': 'onFocus',
	      'blur': 'onBlur'
	    };

	    for (key in callbacks) {
	      fn = this.settings[callbacks[key]];
	      if (fn) this.on(key, fn);
	    }
	  }
	  /**
	   * Sync the Tom Select instance with the original input or select
	   *
	   */


	  sync(get_settings = true) {
	    const self = this;
	    const settings = get_settings ? getSettings(self.input, {
	      delimiter: self.settings.delimiter
	    }) : self.settings;
	    self.setupOptions(settings.options, settings.optgroups);
	    self.setValue(settings.items || [], true); // silent prevents recursion

	    self.lastQuery = null; // so updated options will be displayed in dropdown
	  }
	  /**
	   * Triggered when the main control element
	   * has a click event.
	   *
	   */


	  onClick() {
	    var self = this;

	    if (self.activeItems.length > 0) {
	      self.clearActiveItems();
	      self.focus();
	      return;
	    }

	    if (self.isFocused && self.isOpen) {
	      self.blur();
	    } else {
	      self.focus();
	    }
	  }
	  /**
	   * @deprecated v1.7
	   *
	   */


	  onMouseDown() {}
	  /**
	   * Triggered when the value of the control has been changed.
	   * This should propagate the event to the original DOM
	   * input / select element.
	   */


	  onChange() {
	    triggerEvent(this.input, 'input');
	    triggerEvent(this.input, 'change');
	  }
	  /**
	   * Triggered on <input> paste.
	   *
	   */


	  onPaste(e) {
	    var self = this;

	    if (self.isInputHidden || self.isLocked) {
	      preventDefault(e);
	      return;
	    } // If a regex or string is included, this will split the pasted
	    // input and create Items for each separate value


	    if (!self.settings.splitOn) {
	      return;
	    } // Wait for pasted text to be recognized in value


	    setTimeout(() => {
	      var pastedText = self.inputValue();

	      if (!pastedText.match(self.settings.splitOn)) {
	        return;
	      }

	      var splitInput = pastedText.trim().split(self.settings.splitOn);
	      iterate$1(splitInput, piece => {
	        const hash = hash_key(piece);

	        if (hash) {
	          if (this.options[piece]) {
	            self.addItem(piece);
	          } else {
	            self.createItem(piece);
	          }
	        }
	      });
	    }, 0);
	  }
	  /**
	   * Triggered on <input> keypress.
	   *
	   */


	  onKeyPress(e) {
	    var self = this;

	    if (self.isLocked) {
	      preventDefault(e);
	      return;
	    }

	    var character = String.fromCharCode(e.keyCode || e.which);

	    if (self.settings.create && self.settings.mode === 'multi' && character === self.settings.delimiter) {
	      self.createItem();
	      preventDefault(e);
	      return;
	    }
	  }
	  /**
	   * Triggered on <input> keydown.
	   *
	   */


	  onKeyDown(e) {
	    var self = this;
	    self.ignoreHover = true;

	    if (self.isLocked) {
	      if (e.keyCode !== KEY_TAB) {
	        preventDefault(e);
	      }

	      return;
	    }

	    switch (e.keyCode) {
	      // ctrl+A: select all
	      case KEY_A:
	        if (isKeyDown(KEY_SHORTCUT, e)) {
	          if (self.control_input.value == '') {
	            preventDefault(e);
	            self.selectAll();
	            return;
	          }
	        }

	        break;
	      // esc: close dropdown

	      case KEY_ESC:
	        if (self.isOpen) {
	          preventDefault(e, true);
	          self.close();
	        }

	        self.clearActiveItems();
	        return;
	      // down: open dropdown or move selection down

	      case KEY_DOWN:
	        if (!self.isOpen && self.hasOptions) {
	          self.open();
	        } else if (self.activeOption) {
	          let next = self.getAdjacent(self.activeOption, 1);
	          if (next) self.setActiveOption(next);
	        }

	        preventDefault(e);
	        return;
	      // up: move selection up

	      case KEY_UP:
	        if (self.activeOption) {
	          let prev = self.getAdjacent(self.activeOption, -1);
	          if (prev) self.setActiveOption(prev);
	        }

	        preventDefault(e);
	        return;
	      // return: select active option

	      case KEY_RETURN:
	        if (self.canSelect(self.activeOption)) {
	          self.onOptionSelect(e, self.activeOption);
	          preventDefault(e); // if the option_create=null, the dropdown might be closed
	        } else if (self.settings.create && self.createItem()) {
	          preventDefault(e); // don't submit form when searching for a value
	        } else if (document.activeElement == self.control_input && self.isOpen) {
	          preventDefault(e);
	        }

	        return;
	      // left: modifiy item selection to the left

	      case KEY_LEFT:
	        self.advanceSelection(-1, e);
	        return;
	      // right: modifiy item selection to the right

	      case KEY_RIGHT:
	        self.advanceSelection(1, e);
	        return;
	      // tab: select active option and/or create item

	      case KEY_TAB:
	        if (self.settings.selectOnTab) {
	          if (self.canSelect(self.activeOption)) {
	            self.onOptionSelect(e, self.activeOption); // prevent default [tab] behaviour of jump to the next field
	            // if select isFull, then the dropdown won't be open and [tab] will work normally

	            preventDefault(e);
	          }

	          if (self.settings.create && self.createItem()) {
	            preventDefault(e);
	          }
	        }

	        return;
	      // delete|backspace: delete items

	      case KEY_BACKSPACE:
	      case KEY_DELETE:
	        self.deleteSelection(e);
	        return;
	    } // don't enter text in the control_input when active items are selected


	    if (self.isInputHidden && !isKeyDown(KEY_SHORTCUT, e)) {
	      preventDefault(e);
	    }
	  }
	  /**
	   * Triggered on <input> keyup.
	   *
	   */


	  onInput(e) {
	    var self = this;

	    if (self.isLocked) {
	      return;
	    }

	    var value = self.inputValue();

	    if (self.lastValue !== value) {
	      self.lastValue = value;

	      if (self.settings.shouldLoad.call(self, value)) {
	        self.load(value);
	      }

	      self.refreshOptions();
	      self.trigger('type', value);
	    }
	  }
	  /**
	   * Triggered when the user rolls over
	   * an option in the autocomplete dropdown menu.
	   *
	   */


	  onOptionHover(evt, option) {
	    if (this.ignoreHover) return;
	    this.setActiveOption(option, false);
	  }
	  /**
	   * Triggered on <input> focus.
	   *
	   */


	  onFocus(e) {
	    var self = this;
	    var wasFocused = self.isFocused;

	    if (self.isDisabled) {
	      self.blur();
	      preventDefault(e);
	      return;
	    }

	    if (self.ignoreFocus) return;
	    self.isFocused = true;
	    if (self.settings.preload === 'focus') self.preload();
	    if (!wasFocused) self.trigger('focus');

	    if (!self.activeItems.length) {
	      self.showInput();
	      self.refreshOptions(!!self.settings.openOnFocus);
	    }

	    self.refreshState();
	  }
	  /**
	   * Triggered on <input> blur.
	   *
	   */


	  onBlur(e) {
	    if (document.hasFocus() === false) return;
	    var self = this;
	    if (!self.isFocused) return;
	    self.isFocused = false;
	    self.ignoreFocus = false;

	    var deactivate = () => {
	      self.close();
	      self.setActiveItem();
	      self.setCaret(self.items.length);
	      self.trigger('blur');
	    };

	    if (self.settings.create && self.settings.createOnBlur) {
	      self.createItem(null, deactivate);
	    } else {
	      deactivate();
	    }
	  }
	  /**
	   * Triggered when the user clicks on an option
	   * in the autocomplete dropdown menu.
	   *
	   */


	  onOptionSelect(evt, option) {
	    var value,
	        self = this; // should not be possible to trigger a option under a disabled optgroup

	    if (option.parentElement && option.parentElement.matches('[data-disabled]')) {
	      return;
	    }

	    if (option.classList.contains('create')) {
	      self.createItem(null, () => {
	        if (self.settings.closeAfterSelect) {
	          self.close();
	        }
	      });
	    } else {
	      value = option.dataset.value;

	      if (typeof value !== 'undefined') {
	        self.lastQuery = null;
	        self.addItem(value);

	        if (self.settings.closeAfterSelect) {
	          self.close();
	        }

	        if (!self.settings.hideSelected && evt.type && /click/.test(evt.type)) {
	          self.setActiveOption(option);
	        }
	      }
	    }
	  }
	  /**
	   * Return true if the given option can be selected
	   *
	   */


	  canSelect(option) {
	    if (this.isOpen && option && this.dropdown_content.contains(option)) {
	      return true;
	    }

	    return false;
	  }
	  /**
	   * Triggered when the user clicks on an item
	   * that has been selected.
	   *
	   */


	  onItemSelect(evt, item) {
	    var self = this;

	    if (!self.isLocked && self.settings.mode === 'multi') {
	      preventDefault(evt);
	      self.setActiveItem(item, evt);
	      return true;
	    }

	    return false;
	  }
	  /**
	   * Determines whether or not to invoke
	   * the user-provided option provider / loader
	   *
	   * Note, there is a subtle difference between
	   * this.canLoad() and this.settings.shouldLoad();
	   *
	   *	- settings.shouldLoad() is a user-input validator.
	   *	When false is returned, the not_loading template
	   *	will be added to the dropdown
	   *
	   *	- canLoad() is lower level validator that checks
	   * 	the Tom Select instance. There is no inherent user
	   *	feedback when canLoad returns false
	   *
	   */


	  canLoad(value) {
	    if (!this.settings.load) return false;
	    if (this.loadedSearches.hasOwnProperty(value)) return false;
	    return true;
	  }
	  /**
	   * Invokes the user-provided option provider / loader.
	   *
	   */


	  load(value) {
	    const self = this;
	    if (!self.canLoad(value)) return;
	    addClasses(self.wrapper, self.settings.loadingClass);
	    self.loading++;
	    const callback = self.loadCallback.bind(self);
	    self.settings.load.call(self, value, callback);
	  }
	  /**
	   * Invoked by the user-provided option provider
	   *
	   */


	  loadCallback(options, optgroups) {
	    const self = this;
	    self.loading = Math.max(self.loading - 1, 0);
	    self.lastQuery = null;
	    self.clearActiveOption(); // when new results load, focus should be on first option

	    self.setupOptions(options, optgroups);
	    self.refreshOptions(self.isFocused && !self.isInputHidden);

	    if (!self.loading) {
	      removeClasses(self.wrapper, self.settings.loadingClass);
	    }

	    self.trigger('load', options, optgroups);
	  }

	  preload() {
	    var classList = this.wrapper.classList;
	    if (classList.contains('preloaded')) return;
	    classList.add('preloaded');
	    this.load('');
	  }
	  /**
	   * Sets the input field of the control to the specified value.
	   *
	   */


	  setTextboxValue(value = '') {
	    var input = this.control_input;
	    var changed = input.value !== value;

	    if (changed) {
	      input.value = value;
	      triggerEvent(input, 'update');
	      this.lastValue = value;
	    }
	  }
	  /**
	   * Returns the value of the control. If multiple items
	   * can be selected (e.g. <select multiple>), this returns
	   * an array. If only one item can be selected, this
	   * returns a string.
	   *
	   */


	  getValue() {
	    if (this.is_select_tag && this.input.hasAttribute('multiple')) {
	      return this.items;
	    }

	    return this.items.join(this.settings.delimiter);
	  }
	  /**
	   * Resets the selected items to the given value.
	   *
	   */


	  setValue(value, silent) {
	    var events = silent ? [] : ['change'];
	    debounce_events(this, events, () => {
	      this.clear(silent);
	      this.addItems(value, silent);
	    });
	  }
	  /**
	   * Resets the number of max items to the given value
	   *
	   */


	  setMaxItems(value) {
	    if (value === 0) value = null; //reset to unlimited items.

	    this.settings.maxItems = value;
	    this.refreshState();
	  }
	  /**
	   * Sets the selected item.
	   *
	   */


	  setActiveItem(item, e) {
	    var self = this;
	    var eventName;
	    var i, begin, end, swap;
	    var last;
	    if (self.settings.mode === 'single') return; // clear the active selection

	    if (!item) {
	      self.clearActiveItems();

	      if (self.isFocused) {
	        self.showInput();
	      }

	      return;
	    } // modify selection


	    eventName = e && e.type.toLowerCase();

	    if (eventName === 'click' && isKeyDown('shiftKey', e) && self.activeItems.length) {
	      last = self.getLastActive();
	      begin = Array.prototype.indexOf.call(self.control.children, last);
	      end = Array.prototype.indexOf.call(self.control.children, item);

	      if (begin > end) {
	        swap = begin;
	        begin = end;
	        end = swap;
	      }

	      for (i = begin; i <= end; i++) {
	        item = self.control.children[i];

	        if (self.activeItems.indexOf(item) === -1) {
	          self.setActiveItemClass(item);
	        }
	      }

	      preventDefault(e);
	    } else if (eventName === 'click' && isKeyDown(KEY_SHORTCUT, e) || eventName === 'keydown' && isKeyDown('shiftKey', e)) {
	      if (item.classList.contains('active')) {
	        self.removeActiveItem(item);
	      } else {
	        self.setActiveItemClass(item);
	      }
	    } else {
	      self.clearActiveItems();
	      self.setActiveItemClass(item);
	    } // ensure control has focus


	    self.hideInput();

	    if (!self.isFocused) {
	      self.focus();
	    }
	  }
	  /**
	   * Set the active and last-active classes
	   *
	   */


	  setActiveItemClass(item) {
	    const self = this;
	    const last_active = self.control.querySelector('.last-active');
	    if (last_active) removeClasses(last_active, 'last-active');
	    addClasses(item, 'active last-active');
	    self.trigger('item_select', item);

	    if (self.activeItems.indexOf(item) == -1) {
	      self.activeItems.push(item);
	    }
	  }
	  /**
	   * Remove active item
	   *
	   */


	  removeActiveItem(item) {
	    var idx = this.activeItems.indexOf(item);
	    this.activeItems.splice(idx, 1);
	    removeClasses(item, 'active');
	  }
	  /**
	   * Clears all the active items
	   *
	   */


	  clearActiveItems() {
	    removeClasses(this.activeItems, 'active');
	    this.activeItems = [];
	  }
	  /**
	   * Sets the selected item in the dropdown menu
	   * of available options.
	   *
	   */


	  setActiveOption(option, scroll = true) {
	    if (option === this.activeOption) {
	      return;
	    }

	    this.clearActiveOption();
	    if (!option) return;
	    this.activeOption = option;
	    setAttr(this.focus_node, {
	      'aria-activedescendant': option.getAttribute('id')
	    });
	    setAttr(option, {
	      'aria-selected': 'true'
	    });
	    addClasses(option, 'active');
	    if (scroll) this.scrollToOption(option);
	  }
	  /**
	   * Sets the dropdown_content scrollTop to display the option
	   *
	   */


	  scrollToOption(option, behavior) {
	    if (!option) return;
	    const content = this.dropdown_content;
	    const height_menu = content.clientHeight;
	    const scrollTop = content.scrollTop || 0;
	    const height_item = option.offsetHeight;
	    const y = option.getBoundingClientRect().top - content.getBoundingClientRect().top + scrollTop;

	    if (y + height_item > height_menu + scrollTop) {
	      this.scroll(y - height_menu + height_item, behavior);
	    } else if (y < scrollTop) {
	      this.scroll(y, behavior);
	    }
	  }
	  /**
	   * Scroll the dropdown to the given position
	   *
	   */


	  scroll(scrollTop, behavior) {
	    const content = this.dropdown_content;

	    if (behavior) {
	      content.style.scrollBehavior = behavior;
	    }

	    content.scrollTop = scrollTop;
	    content.style.scrollBehavior = '';
	  }
	  /**
	   * Clears the active option
	   *
	   */


	  clearActiveOption() {
	    if (this.activeOption) {
	      removeClasses(this.activeOption, 'active');
	      setAttr(this.activeOption, {
	        'aria-selected': null
	      });
	    }

	    this.activeOption = null;
	    setAttr(this.focus_node, {
	      'aria-activedescendant': null
	    });
	  }
	  /**
	   * Selects all items (CTRL + A).
	   */


	  selectAll() {
	    const self = this;
	    if (self.settings.mode === 'single') return;
	    const activeItems = self.controlChildren();
	    if (!activeItems.length) return;
	    self.hideInput();
	    self.close();
	    self.activeItems = activeItems;
	    iterate$1(activeItems, item => {
	      self.setActiveItemClass(item);
	    });
	  }
	  /**
	   * Determines if the control_input should be in a hidden or visible state
	   *
	   */


	  inputState() {
	    var self = this;
	    if (!self.control.contains(self.control_input)) return;
	    setAttr(self.control_input, {
	      placeholder: self.settings.placeholder
	    });

	    if (self.activeItems.length > 0 || !self.isFocused && self.settings.hidePlaceholder && self.items.length > 0) {
	      self.setTextboxValue();
	      self.isInputHidden = true;
	    } else {
	      if (self.settings.hidePlaceholder && self.items.length > 0) {
	        setAttr(self.control_input, {
	          placeholder: ''
	        });
	      }

	      self.isInputHidden = false;
	    }

	    self.wrapper.classList.toggle('input-hidden', self.isInputHidden);
	  }
	  /**
	   * Hides the input element out of view, while
	   * retaining its focus.
	   * @deprecated 1.3
	   */


	  hideInput() {
	    this.inputState();
	  }
	  /**
	   * Restores input visibility.
	   * @deprecated 1.3
	   */


	  showInput() {
	    this.inputState();
	  }
	  /**
	   * Get the input value
	   */


	  inputValue() {
	    return this.control_input.value.trim();
	  }
	  /**
	   * Gives the control focus.
	   */


	  focus() {
	    var self = this;
	    if (self.isDisabled) return;
	    self.ignoreFocus = true;

	    if (self.control_input.offsetWidth) {
	      self.control_input.focus();
	    } else {
	      self.focus_node.focus();
	    }

	    setTimeout(() => {
	      self.ignoreFocus = false;
	      self.onFocus();
	    }, 0);
	  }
	  /**
	   * Forces the control out of focus.
	   *
	   */


	  blur() {
	    this.focus_node.blur();
	    this.onBlur();
	  }
	  /**
	   * Returns a function that scores an object
	   * to show how good of a match it is to the
	   * provided query.
	   *
	   * @return {function}
	   */


	  getScoreFunction(query) {
	    return this.sifter.getScoreFunction(query, this.getSearchOptions());
	  }
	  /**
	   * Returns search options for sifter (the system
	   * for scoring and sorting results).
	   *
	   * @see https://github.com/orchidjs/sifter.js
	   * @return {object}
	   */


	  getSearchOptions() {
	    var settings = this.settings;
	    var sort = settings.sortField;

	    if (typeof settings.sortField === 'string') {
	      sort = [{
	        field: settings.sortField
	      }];
	    }

	    return {
	      fields: settings.searchField,
	      conjunction: settings.searchConjunction,
	      sort: sort,
	      nesting: settings.nesting
	    };
	  }
	  /**
	   * Searches through available options and returns
	   * a sorted array of matches.
	   *
	   */


	  search(query) {
	    var result, calculateScore;
	    var self = this;
	    var options = this.getSearchOptions(); // validate user-provided result scoring function

	    if (self.settings.score) {
	      calculateScore = self.settings.score.call(self, query);

	      if (typeof calculateScore !== 'function') {
	        throw new Error('Tom Select "score" setting must be a function that returns a function');
	      }
	    } // perform search


	    if (query !== self.lastQuery) {
	      self.lastQuery = query;
	      result = self.sifter.search(query, Object.assign(options, {
	        score: calculateScore
	      }));
	      self.currentResults = result;
	    } else {
	      result = Object.assign({}, self.currentResults);
	    } // filter out selected items


	    if (self.settings.hideSelected) {
	      result.items = result.items.filter(item => {
	        let hashed = hash_key(item.id);
	        return !(hashed && self.items.indexOf(hashed) !== -1);
	      });
	    }

	    return result;
	  }
	  /**
	   * Refreshes the list of available options shown
	   * in the autocomplete dropdown menu.
	   *
	   */


	  refreshOptions(triggerDropdown = true) {
	    var i, j, k, n, optgroup, optgroups, html, has_create_option, active_group;
	    var create;
	    const groups = {};
	    const groups_order = [];
	    var self = this;
	    var query = self.inputValue();
	    const same_query = query === self.lastQuery || query == '' && self.lastQuery == null;
	    var results = self.search(query);
	    var active_option = null;
	    var show_dropdown = self.settings.shouldOpen || false;
	    var dropdown_content = self.dropdown_content;

	    if (same_query) {
	      active_option = self.activeOption;

	      if (active_option) {
	        active_group = active_option.closest('[data-group]');
	      }
	    } // build markup


	    n = results.items.length;

	    if (typeof self.settings.maxOptions === 'number') {
	      n = Math.min(n, self.settings.maxOptions);
	    }

	    if (n > 0) {
	      show_dropdown = true;
	    } // render and group available options individually


	    for (i = 0; i < n; i++) {
	      // get option dom element
	      let item = results.items[i];
	      if (!item) continue;
	      let opt_value = item.id;
	      let option = self.options[opt_value];
	      if (option === undefined) continue;
	      let opt_hash = get_hash(opt_value);
	      let option_el = self.getOption(opt_hash, true); // toggle 'selected' class

	      if (!self.settings.hideSelected) {
	        option_el.classList.toggle('selected', self.items.includes(opt_hash));
	      }

	      optgroup = option[self.settings.optgroupField] || '';
	      optgroups = Array.isArray(optgroup) ? optgroup : [optgroup];

	      for (j = 0, k = optgroups && optgroups.length; j < k; j++) {
	        optgroup = optgroups[j];

	        if (!self.optgroups.hasOwnProperty(optgroup)) {
	          optgroup = '';
	        }

	        let group_fragment = groups[optgroup];

	        if (group_fragment === undefined) {
	          group_fragment = document.createDocumentFragment();
	          groups_order.push(optgroup);
	        } // nodes can only have one parent, so if the option is in mutple groups, we need a clone


	        if (j > 0) {
	          option_el = option_el.cloneNode(true);
	          setAttr(option_el, {
	            id: option.$id + '-clone-' + j,
	            'aria-selected': null
	          });
	          option_el.classList.add('ts-cloned');
	          removeClasses(option_el, 'active'); // make sure we keep the activeOption in the same group

	          if (self.activeOption && self.activeOption.dataset.value == opt_value) {
	            if (active_group && active_group.dataset.group === optgroup.toString()) {
	              active_option = option_el;
	            }
	          }
	        }

	        group_fragment.appendChild(option_el);
	        groups[optgroup] = group_fragment;
	      }
	    } // sort optgroups


	    if (self.settings.lockOptgroupOrder) {
	      groups_order.sort((a, b) => {
	        const grp_a = self.optgroups[a];
	        const grp_b = self.optgroups[b];
	        const a_order = grp_a && grp_a.$order || 0;
	        const b_order = grp_b && grp_b.$order || 0;
	        return a_order - b_order;
	      });
	    } // render optgroup headers & join groups


	    html = document.createDocumentFragment();
	    iterate$1(groups_order, optgroup => {
	      let group_fragment = groups[optgroup];
	      if (!group_fragment || !group_fragment.children.length) return;
	      let group_heading = self.optgroups[optgroup];

	      if (group_heading !== undefined) {
	        let group_options = document.createDocumentFragment();
	        let header = self.render('optgroup_header', group_heading);
	        append(group_options, header);
	        append(group_options, group_fragment);
	        let group_html = self.render('optgroup', {
	          group: group_heading,
	          options: group_options
	        });
	        append(html, group_html);
	      } else {
	        append(html, group_fragment);
	      }
	    });
	    dropdown_content.innerHTML = '';
	    append(dropdown_content, html); // highlight matching terms inline

	    if (self.settings.highlight) {
	      removeHighlight(dropdown_content);

	      if (results.query.length && results.tokens.length) {
	        iterate$1(results.tokens, tok => {
	          highlight(dropdown_content, tok.regex);
	        });
	      }
	    } // helper method for adding templates to dropdown


	    var add_template = template => {
	      let content = self.render(template, {
	        input: query
	      });

	      if (content) {
	        show_dropdown = true;
	        dropdown_content.insertBefore(content, dropdown_content.firstChild);
	      }

	      return content;
	    }; // add loading message


	    if (self.loading) {
	      add_template('loading'); // invalid query
	    } else if (!self.settings.shouldLoad.call(self, query)) {
	      add_template('not_loading'); // add no_results message
	    } else if (results.items.length === 0) {
	      add_template('no_results');
	    } // add create option


	    has_create_option = self.canCreate(query);

	    if (has_create_option) {
	      create = add_template('option_create');
	    } // activate


	    self.hasOptions = results.items.length > 0 || has_create_option;

	    if (show_dropdown) {
	      if (results.items.length > 0) {
	        if (!active_option && self.settings.mode === 'single' && self.items[0] != undefined) {
	          active_option = self.getOption(self.items[0]);
	        }

	        if (!dropdown_content.contains(active_option)) {
	          let active_index = 0;

	          if (create && !self.settings.addPrecedence) {
	            active_index = 1;
	          }

	          active_option = self.selectable()[active_index];
	        }
	      } else if (create) {
	        active_option = create;
	      }

	      if (triggerDropdown && !self.isOpen) {
	        self.open();
	        self.scrollToOption(active_option, 'auto');
	      }

	      self.setActiveOption(active_option);
	    } else {
	      self.clearActiveOption();

	      if (triggerDropdown && self.isOpen) {
	        self.close(false); // if create_option=null, we want the dropdown to close but not reset the textbox value
	      }
	    }
	  }
	  /**
	   * Return list of selectable options
	   *
	   */


	  selectable() {
	    return this.dropdown_content.querySelectorAll('[data-selectable]');
	  }
	  /**
	   * Adds an available option. If it already exists,
	   * nothing will happen. Note: this does not refresh
	   * the options list dropdown (use `refreshOptions`
	   * for that).
	   *
	   * Usage:
	   *
	   *   this.addOption(data)
	   *
	   */


	  addOption(data, user_created = false) {
	    const self = this; // @deprecated 1.7.7
	    // use addOptions( array, user_created ) for adding multiple options

	    if (Array.isArray(data)) {
	      self.addOptions(data, user_created);
	      return false;
	    }

	    const key = hash_key(data[self.settings.valueField]);

	    if (key === null || self.options.hasOwnProperty(key)) {
	      return false;
	    }

	    data.$order = data.$order || ++self.order;
	    data.$id = self.inputId + '-opt-' + data.$order;
	    self.options[key] = data;
	    self.lastQuery = null;

	    if (user_created) {
	      self.userOptions[key] = user_created;
	      self.trigger('option_add', key, data);
	    }

	    return key;
	  }
	  /**
	   * Add multiple options
	   *
	   */


	  addOptions(data, user_created = false) {
	    iterate$1(data, dat => {
	      this.addOption(dat, user_created);
	    });
	  }
	  /**
	   * @deprecated 1.7.7
	   */


	  registerOption(data) {
	    return this.addOption(data);
	  }
	  /**
	   * Registers an option group to the pool of option groups.
	   *
	   * @return {boolean|string}
	   */


	  registerOptionGroup(data) {
	    var key = hash_key(data[this.settings.optgroupValueField]);
	    if (key === null) return false;
	    data.$order = data.$order || ++this.order;
	    this.optgroups[key] = data;
	    return key;
	  }
	  /**
	   * Registers a new optgroup for options
	   * to be bucketed into.
	   *
	   */


	  addOptionGroup(id, data) {
	    var hashed_id;
	    data[this.settings.optgroupValueField] = id;

	    if (hashed_id = this.registerOptionGroup(data)) {
	      this.trigger('optgroup_add', hashed_id, data);
	    }
	  }
	  /**
	   * Removes an existing option group.
	   *
	   */


	  removeOptionGroup(id) {
	    if (this.optgroups.hasOwnProperty(id)) {
	      delete this.optgroups[id];
	      this.clearCache();
	      this.trigger('optgroup_remove', id);
	    }
	  }
	  /**
	   * Clears all existing option groups.
	   */


	  clearOptionGroups() {
	    this.optgroups = {};
	    this.clearCache();
	    this.trigger('optgroup_clear');
	  }
	  /**
	   * Updates an option available for selection. If
	   * it is visible in the selected items or options
	   * dropdown, it will be re-rendered automatically.
	   *
	   */


	  updateOption(value, data) {
	    const self = this;
	    var item_new;
	    var index_item;
	    const value_old = hash_key(value);
	    const value_new = hash_key(data[self.settings.valueField]); // sanity checks

	    if (value_old === null) return;
	    const data_old = self.options[value_old];
	    if (data_old == undefined) return;
	    if (typeof value_new !== 'string') throw new Error('Value must be set in option data');
	    const option = self.getOption(value_old);
	    const item = self.getItem(value_old);
	    data.$order = data.$order || data_old.$order;
	    delete self.options[value_old]; // invalidate render cache
	    // don't remove existing node yet, we'll remove it after replacing it

	    self.uncacheValue(value_new);
	    self.options[value_new] = data; // update the option if it's in the dropdown

	    if (option) {
	      if (self.dropdown_content.contains(option)) {
	        const option_new = self._render('option', data);

	        replaceNode(option, option_new);

	        if (self.activeOption === option) {
	          self.setActiveOption(option_new);
	        }
	      }

	      option.remove();
	    } // update the item if we have one


	    if (item) {
	      index_item = self.items.indexOf(value_old);

	      if (index_item !== -1) {
	        self.items.splice(index_item, 1, value_new);
	      }

	      item_new = self._render('item', data);
	      if (item.classList.contains('active')) addClasses(item_new, 'active');
	      replaceNode(item, item_new);
	    } // invalidate last query because we might have updated the sortField


	    self.lastQuery = null;
	  }
	  /**
	   * Removes a single option.
	   *
	   */


	  removeOption(value, silent) {
	    const self = this;
	    value = get_hash(value);
	    self.uncacheValue(value);
	    delete self.userOptions[value];
	    delete self.options[value];
	    self.lastQuery = null;
	    self.trigger('option_remove', value);
	    self.removeItem(value, silent);
	  }
	  /**
	   * Clears all options.
	   */


	  clearOptions(filter) {
	    const boundFilter = (filter || this.clearFilter).bind(this);
	    this.loadedSearches = {};
	    this.userOptions = {};
	    this.clearCache();
	    const selected = {};
	    iterate$1(this.options, (option, key) => {
	      if (boundFilter(option, key)) {
	        selected[key] = option;
	      }
	    });
	    this.options = this.sifter.items = selected;
	    this.lastQuery = null;
	    this.trigger('option_clear');
	  }
	  /**
	   * Used by clearOptions() to decide whether or not an option should be removed
	   * Return true to keep an option, false to remove
	   *
	   */


	  clearFilter(option, value) {
	    if (this.items.indexOf(value) >= 0) {
	      return true;
	    }

	    return false;
	  }
	  /**
	   * Returns the dom element of the option
	   * matching the given value.
	   *
	   */


	  getOption(value, create = false) {
	    const hashed = hash_key(value);
	    if (hashed === null) return null;
	    const option = this.options[hashed];

	    if (option != undefined) {
	      if (option.$div) {
	        return option.$div;
	      }

	      if (create) {
	        return this._render('option', option);
	      }
	    }

	    return null;
	  }
	  /**
	   * Returns the dom element of the next or previous dom element of the same type
	   * Note: adjacent options may not be adjacent DOM elements (optgroups)
	   *
	   */


	  getAdjacent(option, direction, type = 'option') {
	    var self = this,
	        all;

	    if (!option) {
	      return null;
	    }

	    if (type == 'item') {
	      all = self.controlChildren();
	    } else {
	      all = self.dropdown_content.querySelectorAll('[data-selectable]');
	    }

	    for (let i = 0; i < all.length; i++) {
	      if (all[i] != option) {
	        continue;
	      }

	      if (direction > 0) {
	        return all[i + 1];
	      }

	      return all[i - 1];
	    }

	    return null;
	  }
	  /**
	   * Returns the dom element of the item
	   * matching the given value.
	   *
	   */


	  getItem(item) {
	    if (typeof item == 'object') {
	      return item;
	    }

	    var value = hash_key(item);
	    return value !== null ? this.control.querySelector(`[data-value="${addSlashes(value)}"]`) : null;
	  }
	  /**
	   * "Selects" multiple items at once. Adds them to the list
	   * at the current caret position.
	   *
	   */


	  addItems(values, silent) {
	    var self = this;
	    var items = Array.isArray(values) ? values : [values];
	    items = items.filter(x => self.items.indexOf(x) === -1);
	    const last_item = items[items.length - 1];
	    items.forEach(item => {
	      self.isPending = item !== last_item;
	      self.addItem(item, silent);
	    });
	  }
	  /**
	   * "Selects" an item. Adds it to the list
	   * at the current caret position.
	   *
	   */


	  addItem(value, silent) {
	    var events = silent ? [] : ['change', 'dropdown_close'];
	    debounce_events(this, events, () => {
	      var item, wasFull;
	      const self = this;
	      const inputMode = self.settings.mode;
	      const hashed = hash_key(value);

	      if (hashed && self.items.indexOf(hashed) !== -1) {
	        if (inputMode === 'single') {
	          self.close();
	        }

	        if (inputMode === 'single' || !self.settings.duplicates) {
	          return;
	        }
	      }

	      if (hashed === null || !self.options.hasOwnProperty(hashed)) return;
	      if (inputMode === 'single') self.clear(silent);
	      if (inputMode === 'multi' && self.isFull()) return;
	      item = self._render('item', self.options[hashed]);

	      if (self.control.contains(item)) {
	        // duplicates
	        item = item.cloneNode(true);
	      }

	      wasFull = self.isFull();
	      self.items.splice(self.caretPos, 0, hashed);
	      self.insertAtCaret(item);

	      if (self.isSetup) {
	        // update menu / remove the option (if this is not one item being added as part of series)
	        if (!self.isPending && self.settings.hideSelected) {
	          let option = self.getOption(hashed);
	          let next = self.getAdjacent(option, 1);

	          if (next) {
	            self.setActiveOption(next);
	          }
	        } // refreshOptions after setActiveOption(),
	        // otherwise setActiveOption() will be called by refreshOptions() with the wrong value


	        if (!self.isPending && !self.settings.closeAfterSelect) {
	          self.refreshOptions(self.isFocused && inputMode !== 'single');
	        } // hide the menu if the maximum number of items have been selected or no options are left


	        if (self.settings.closeAfterSelect != false && self.isFull()) {
	          self.close();
	        } else if (!self.isPending) {
	          self.positionDropdown();
	        }

	        self.trigger('item_add', hashed, item);

	        if (!self.isPending) {
	          self.updateOriginalInput({
	            silent: silent
	          });
	        }
	      }

	      if (!self.isPending || !wasFull && self.isFull()) {
	        self.inputState();
	        self.refreshState();
	      }
	    });
	  }
	  /**
	   * Removes the selected item matching
	   * the provided value.
	   *
	   */


	  removeItem(item = null, silent) {
	    const self = this;
	    item = self.getItem(item);
	    if (!item) return;
	    var i, idx;
	    const value = item.dataset.value;
	    i = nodeIndex(item);
	    item.remove();

	    if (item.classList.contains('active')) {
	      idx = self.activeItems.indexOf(item);
	      self.activeItems.splice(idx, 1);
	      removeClasses(item, 'active');
	    }

	    self.items.splice(i, 1);
	    self.lastQuery = null;

	    if (!self.settings.persist && self.userOptions.hasOwnProperty(value)) {
	      self.removeOption(value, silent);
	    }

	    if (i < self.caretPos) {
	      self.setCaret(self.caretPos - 1);
	    }

	    self.updateOriginalInput({
	      silent: silent
	    });
	    self.refreshState();
	    self.positionDropdown();
	    self.trigger('item_remove', value, item);
	  }
	  /**
	   * Invokes the `create` method provided in the
	   * TomSelect options that should provide the data
	   * for the new item, given the user input.
	   *
	   * Once this completes, it will be added
	   * to the item list.
	   *
	   */


	  createItem(input = null, callback = () => {}) {
	    // triggerDropdown parameter @deprecated 2.1.1
	    if (arguments.length === 3) {
	      callback = arguments[2];
	    }

	    if (typeof callback != 'function') {
	      callback = () => {};
	    }

	    var self = this;
	    var caret = self.caretPos;
	    var output;
	    input = input || self.inputValue();

	    if (!self.canCreate(input)) {
	      callback();
	      return false;
	    }

	    self.lock();
	    var created = false;

	    var create = data => {
	      self.unlock();
	      if (!data || typeof data !== 'object') return callback();
	      var value = hash_key(data[self.settings.valueField]);

	      if (typeof value !== 'string') {
	        return callback();
	      }

	      self.setTextboxValue();
	      self.addOption(data, true);
	      self.setCaret(caret);
	      self.addItem(value);
	      callback(data);
	      created = true;
	    };

	    if (typeof self.settings.create === 'function') {
	      output = self.settings.create.call(this, input, create);
	    } else {
	      output = {
	        [self.settings.labelField]: input,
	        [self.settings.valueField]: input
	      };
	    }

	    if (!created) {
	      create(output);
	    }

	    return true;
	  }
	  /**
	   * Re-renders the selected item lists.
	   */


	  refreshItems() {
	    var self = this;
	    self.lastQuery = null;

	    if (self.isSetup) {
	      self.addItems(self.items);
	    }

	    self.updateOriginalInput();
	    self.refreshState();
	  }
	  /**
	   * Updates all state-dependent attributes
	   * and CSS classes.
	   */


	  refreshState() {
	    const self = this;
	    self.refreshValidityState();
	    const isFull = self.isFull();
	    const isLocked = self.isLocked;
	    self.wrapper.classList.toggle('rtl', self.rtl);
	    const wrap_classList = self.wrapper.classList;
	    wrap_classList.toggle('focus', self.isFocused);
	    wrap_classList.toggle('disabled', self.isDisabled);
	    wrap_classList.toggle('required', self.isRequired);
	    wrap_classList.toggle('invalid', !self.isValid);
	    wrap_classList.toggle('locked', isLocked);
	    wrap_classList.toggle('full', isFull);
	    wrap_classList.toggle('input-active', self.isFocused && !self.isInputHidden);
	    wrap_classList.toggle('dropdown-active', self.isOpen);
	    wrap_classList.toggle('has-options', isEmptyObject(self.options));
	    wrap_classList.toggle('has-items', self.items.length > 0);
	  }
	  /**
	   * Update the `required` attribute of both input and control input.
	   *
	   * The `required` property needs to be activated on the control input
	   * for the error to be displayed at the right place. `required` also
	   * needs to be temporarily deactivated on the input since the input is
	   * hidden and can't show errors.
	   */


	  refreshValidityState() {
	    var self = this;

	    if (!self.input.validity) {
	      return;
	    }

	    self.isValid = self.input.validity.valid;
	    self.isInvalid = !self.isValid;
	  }
	  /**
	   * Determines whether or not more items can be added
	   * to the control without exceeding the user-defined maximum.
	   *
	   * @returns {boolean}
	   */


	  isFull() {
	    return this.settings.maxItems !== null && this.items.length >= this.settings.maxItems;
	  }
	  /**
	   * Refreshes the original <select> or <input>
	   * element to reflect the current state.
	   *
	   */


	  updateOriginalInput(opts = {}) {
	    const self = this;
	    var option, label;
	    const empty_option = self.input.querySelector('option[value=""]');

	    if (self.is_select_tag) {
	      const selected = [];
	      const has_selected = self.input.querySelectorAll('option:checked').length;

	      function AddSelected(option_el, value, label) {
	        if (!option_el) {
	          option_el = getDom('<option value="' + escape_html(value) + '">' + escape_html(label) + '</option>');
	        } // don't move empty option from top of list
	        // fixes bug in firefox https://bugzilla.mozilla.org/show_bug.cgi?id=1725293


	        if (option_el != empty_option) {
	          self.input.append(option_el);
	        }

	        selected.push(option_el); // marking empty option as selected can break validation
	        // fixes https://github.com/orchidjs/tom-select/issues/303

	        if (option_el != empty_option || has_selected > 0) {
	          option_el.selected = true;
	        }

	        return option_el;
	      } // unselect all selected options


	      self.input.querySelectorAll('option:checked').forEach(option_el => {
	        option_el.selected = false;
	      }); // nothing selected?

	      if (self.items.length == 0 && self.settings.mode == 'single') {
	        AddSelected(empty_option, "", ""); // order selected <option> tags for values in self.items
	      } else {
	        self.items.forEach(value => {
	          option = self.options[value];
	          label = option[self.settings.labelField] || '';

	          if (selected.includes(option.$option)) {
	            const reuse_opt = self.input.querySelector(`option[value="${addSlashes(value)}"]:not(:checked)`);
	            AddSelected(reuse_opt, value, label);
	          } else {
	            option.$option = AddSelected(option.$option, value, label);
	          }
	        });
	      }
	    } else {
	      self.input.value = self.getValue();
	    }

	    if (self.isSetup) {
	      if (!opts.silent) {
	        self.trigger('change', self.getValue());
	      }
	    }
	  }
	  /**
	   * Shows the autocomplete dropdown containing
	   * the available options.
	   */


	  open() {
	    var self = this;
	    if (self.isLocked || self.isOpen || self.settings.mode === 'multi' && self.isFull()) return;
	    self.isOpen = true;
	    setAttr(self.focus_node, {
	      'aria-expanded': 'true'
	    });
	    self.refreshState();
	    applyCSS(self.dropdown, {
	      visibility: 'hidden',
	      display: 'block'
	    });
	    self.positionDropdown();
	    applyCSS(self.dropdown, {
	      visibility: 'visible',
	      display: 'block'
	    });
	    self.focus();
	    self.trigger('dropdown_open', self.dropdown);
	  }
	  /**
	   * Closes the autocomplete dropdown menu.
	   */


	  close(setTextboxValue = true) {
	    var self = this;
	    var trigger = self.isOpen;

	    if (setTextboxValue) {
	      // before blur() to prevent form onchange event
	      self.setTextboxValue();

	      if (self.settings.mode === 'single' && self.items.length) {
	        self.hideInput();
	      }
	    }

	    self.isOpen = false;
	    setAttr(self.focus_node, {
	      'aria-expanded': 'false'
	    });
	    applyCSS(self.dropdown, {
	      display: 'none'
	    });

	    if (self.settings.hideSelected) {
	      self.clearActiveOption();
	    }

	    self.refreshState();
	    if (trigger) self.trigger('dropdown_close', self.dropdown);
	  }
	  /**
	   * Calculates and applies the appropriate
	   * position of the dropdown if dropdownParent = 'body'.
	   * Otherwise, position is determined by css
	   */


	  positionDropdown() {
	    if (this.settings.dropdownParent !== 'body') {
	      return;
	    }

	    var context = this.control;
	    var rect = context.getBoundingClientRect();
	    var top = context.offsetHeight + rect.top + window.scrollY;
	    var left = rect.left + window.scrollX;
	    applyCSS(this.dropdown, {
	      width: rect.width + 'px',
	      top: top + 'px',
	      left: left + 'px'
	    });
	  }
	  /**
	   * Resets / clears all selected items
	   * from the control.
	   *
	   */


	  clear(silent) {
	    var self = this;
	    if (!self.items.length) return;
	    var items = self.controlChildren();
	    iterate$1(items, item => {
	      self.removeItem(item, true);
	    });
	    self.showInput();
	    if (!silent) self.updateOriginalInput();
	    self.trigger('clear');
	  }
	  /**
	   * A helper method for inserting an element
	   * at the current caret position.
	   *
	   */


	  insertAtCaret(el) {
	    const self = this;
	    const caret = self.caretPos;
	    const target = self.control;
	    target.insertBefore(el, target.children[caret] || null);
	    self.setCaret(caret + 1);
	  }
	  /**
	   * Removes the current selected item(s).
	   *
	   */


	  deleteSelection(e) {
	    var direction, selection, caret, tail;
	    var self = this;
	    direction = e && e.keyCode === KEY_BACKSPACE ? -1 : 1;
	    selection = getSelection(self.control_input); // determine items that will be removed

	    const rm_items = [];

	    if (self.activeItems.length) {
	      tail = getTail(self.activeItems, direction);
	      caret = nodeIndex(tail);

	      if (direction > 0) {
	        caret++;
	      }

	      iterate$1(self.activeItems, item => rm_items.push(item));
	    } else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) {
	      const items = self.controlChildren();
	      let rm_item;

	      if (direction < 0 && selection.start === 0 && selection.length === 0) {
	        rm_item = items[self.caretPos - 1];
	      } else if (direction > 0 && selection.start === self.inputValue().length) {
	        rm_item = items[self.caretPos];
	      }

	      if (rm_item !== undefined) {
	        rm_items.push(rm_item);
	      }
	    }

	    if (!self.shouldDelete(rm_items, e)) {
	      return false;
	    }

	    preventDefault(e, true); // perform removal

	    if (typeof caret !== 'undefined') {
	      self.setCaret(caret);
	    }

	    while (rm_items.length) {
	      self.removeItem(rm_items.pop());
	    }

	    self.showInput();
	    self.positionDropdown();
	    self.refreshOptions(false);
	    return true;
	  }
	  /**
	   * Return true if the items should be deleted
	   */


	  shouldDelete(items, evt) {
	    const values = items.map(item => item.dataset.value); // allow the callback to abort

	    if (!values.length || typeof this.settings.onDelete === 'function' && this.settings.onDelete(values, evt) === false) {
	      return false;
	    }

	    return true;
	  }
	  /**
	   * Selects the previous / next item (depending on the `direction` argument).
	   *
	   * > 0 - right
	   * < 0 - left
	   *
	   */


	  advanceSelection(direction, e) {
	    var last_active,
	        adjacent,
	        self = this;
	    if (self.rtl) direction *= -1;
	    if (self.inputValue().length) return; // add or remove to active items

	    if (isKeyDown(KEY_SHORTCUT, e) || isKeyDown('shiftKey', e)) {
	      last_active = self.getLastActive(direction);

	      if (last_active) {
	        if (!last_active.classList.contains('active')) {
	          adjacent = last_active;
	        } else {
	          adjacent = self.getAdjacent(last_active, direction, 'item');
	        } // if no active item, get items adjacent to the control input

	      } else if (direction > 0) {
	        adjacent = self.control_input.nextElementSibling;
	      } else {
	        adjacent = self.control_input.previousElementSibling;
	      }

	      if (adjacent) {
	        if (adjacent.classList.contains('active')) {
	          self.removeActiveItem(last_active);
	        }

	        self.setActiveItemClass(adjacent); // mark as last_active !! after removeActiveItem() on last_active
	      } // move caret to the left or right

	    } else {
	      self.moveCaret(direction);
	    }
	  }

	  moveCaret(direction) {}
	  /**
	   * Get the last active item
	   *
	   */


	  getLastActive(direction) {
	    let last_active = this.control.querySelector('.last-active');

	    if (last_active) {
	      return last_active;
	    }

	    var result = this.control.querySelectorAll('.active');

	    if (result) {
	      return getTail(result, direction);
	    }
	  }
	  /**
	   * Moves the caret to the specified index.
	   *
	   * The input must be moved by leaving it in place and moving the
	   * siblings, due to the fact that focus cannot be restored once lost
	   * on mobile webkit devices
	   *
	   */


	  setCaret(new_pos) {
	    this.caretPos = this.items.length;
	  }
	  /**
	   * Return list of item dom elements
	   *
	   */


	  controlChildren() {
	    return Array.from(this.control.querySelectorAll('[data-ts-item]'));
	  }
	  /**
	   * Disables user input on the control. Used while
	   * items are being asynchronously created.
	   */


	  lock() {
	    this.isLocked = true;
	    this.refreshState();
	  }
	  /**
	   * Re-enables user input on the control.
	   */


	  unlock() {
	    this.isLocked = false;
	    this.refreshState();
	  }
	  /**
	   * Disables user input on the control completely.
	   * While disabled, it cannot receive focus.
	   */


	  disable() {
	    var self = this;
	    self.input.disabled = true;
	    self.control_input.disabled = true;
	    self.focus_node.tabIndex = -1;
	    self.isDisabled = true;
	    this.close();
	    self.lock();
	  }
	  /**
	   * Enables the control so that it can respond
	   * to focus and user input.
	   */


	  enable() {
	    var self = this;
	    self.input.disabled = false;
	    self.control_input.disabled = false;
	    self.focus_node.tabIndex = self.tabIndex;
	    self.isDisabled = false;
	    self.unlock();
	  }
	  /**
	   * Completely destroys the control and
	   * unbinds all event listeners so that it can
	   * be garbage collected.
	   */


	  destroy() {
	    var self = this;
	    var revertSettings = self.revertSettings;
	    self.trigger('destroy');
	    self.off();
	    self.wrapper.remove();
	    self.dropdown.remove();
	    self.input.innerHTML = revertSettings.innerHTML;
	    self.input.tabIndex = revertSettings.tabIndex;
	    removeClasses(self.input, 'tomselected', 'ts-hidden-accessible');

	    self._destroy();

	    delete self.input.tomselect;
	  }
	  /**
	   * A helper method for rendering "item" and
	   * "option" templates, given the data.
	   *
	   */


	  render(templateName, data) {
	    var id, html;
	    const self = this;

	    if (typeof this.settings.render[templateName] !== 'function') {
	      return null;
	    } // render markup


	    html = self.settings.render[templateName].call(this, data, escape_html);

	    if (!html) {
	      return null;
	    }

	    html = getDom(html); // add mandatory attributes

	    if (templateName === 'option' || templateName === 'option_create') {
	      if (data[self.settings.disabledField]) {
	        setAttr(html, {
	          'aria-disabled': 'true'
	        });
	      } else {
	        setAttr(html, {
	          'data-selectable': ''
	        });
	      }
	    } else if (templateName === 'optgroup') {
	      id = data.group[self.settings.optgroupValueField];
	      setAttr(html, {
	        'data-group': id
	      });

	      if (data.group[self.settings.disabledField]) {
	        setAttr(html, {
	          'data-disabled': ''
	        });
	      }
	    }

	    if (templateName === 'option' || templateName === 'item') {
	      const value = get_hash(data[self.settings.valueField]);
	      setAttr(html, {
	        'data-value': value
	      }); // make sure we have some classes if a template is overwritten

	      if (templateName === 'item') {
	        addClasses(html, self.settings.itemClass);
	        setAttr(html, {
	          'data-ts-item': ''
	        });
	      } else {
	        addClasses(html, self.settings.optionClass);
	        setAttr(html, {
	          role: 'option',
	          id: data.$id
	        }); // update cache

	        data.$div = html;
	        self.options[value] = data;
	      }
	    }

	    return html;
	  }
	  /**
	   * Type guarded rendering
	   *
	   */


	  _render(templateName, data) {
	    const html = this.render(templateName, data);

	    if (html == null) {
	      throw 'HTMLElement expected';
	    }

	    return html;
	  }
	  /**
	   * Clears the render cache for a template. If
	   * no template is given, clears all render
	   * caches.
	   *
	   */


	  clearCache() {
	    iterate$1(this.options, option => {
	      if (option.$div) {
	        option.$div.remove();
	        delete option.$div;
	      }
	    });
	  }
	  /**
	   * Removes a value from item and option caches
	   *
	   */


	  uncacheValue(value) {
	    const option_el = this.getOption(value);
	    if (option_el) option_el.remove();
	  }
	  /**
	   * Determines whether or not to display the
	   * create item prompt, given a user input.
	   *
	   */


	  canCreate(input) {
	    return this.settings.create && input.length > 0 && this.settings.createFilter.call(this, input);
	  }
	  /**
	   * Wraps this.`method` so that `new_fn` can be invoked 'before', 'after', or 'instead' of the original method
	   *
	   * this.hook('instead','onKeyDown',function( arg1, arg2 ...){
	   *
	   * });
	   */


	  hook(when, method, new_fn) {
	    var self = this;
	    var orig_method = self[method];

	    self[method] = function () {
	      var result, result_new;

	      if (when === 'after') {
	        result = orig_method.apply(self, arguments);
	      }

	      result_new = new_fn.apply(self, arguments);

	      if (when === 'instead') {
	        return result_new;
	      }

	      if (when === 'before') {
	        result = orig_method.apply(self, arguments);
	      }

	      return result;
	    };
	  }

	}

	/**
	 * Plugin: "change_listener" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function change_listener () {
	  addEvent(this.input, 'change', () => {
	    this.sync();
	  });
	}

	/**
	 * Plugin: "restore_on_backspace" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function checkbox_options () {
	  var self = this;
	  var orig_onOptionSelect = self.onOptionSelect;
	  self.settings.hideSelected = false; // update the checkbox for an option

	  var UpdateCheckbox = function UpdateCheckbox(option) {
	    setTimeout(() => {
	      var checkbox = option.querySelector('input');

	      if (checkbox instanceof HTMLInputElement) {
	        if (option.classList.contains('selected')) {
	          checkbox.checked = true;
	        } else {
	          checkbox.checked = false;
	        }
	      }
	    }, 1);
	  }; // add checkbox to option template


	  self.hook('after', 'setupTemplates', () => {
	    var orig_render_option = self.settings.render.option;

	    self.settings.render.option = (data, escape_html) => {
	      var rendered = getDom(orig_render_option.call(self, data, escape_html));
	      var checkbox = document.createElement('input');
	      checkbox.addEventListener('click', function (evt) {
	        preventDefault(evt);
	      });
	      checkbox.type = 'checkbox';
	      const hashed = hash_key(data[self.settings.valueField]);

	      if (hashed && self.items.indexOf(hashed) > -1) {
	        checkbox.checked = true;
	      }

	      rendered.prepend(checkbox);
	      return rendered;
	    };
	  }); // uncheck when item removed

	  self.on('item_remove', value => {
	    var option = self.getOption(value);

	    if (option) {
	      // if dropdown hasn't been opened yet, the option won't exist
	      option.classList.remove('selected'); // selected class won't be removed yet

	      UpdateCheckbox(option);
	    }
	  }); // check when item added

	  self.on('item_add', value => {
	    var option = self.getOption(value);

	    if (option) {
	      // if dropdown hasn't been opened yet, the option won't exist
	      UpdateCheckbox(option);
	    }
	  }); // remove items when selected option is clicked

	  self.hook('instead', 'onOptionSelect', (evt, option) => {
	    if (option.classList.contains('selected')) {
	      option.classList.remove('selected');
	      self.removeItem(option.dataset.value);
	      self.refreshOptions();
	      preventDefault(evt, true);
	      return;
	    }

	    orig_onOptionSelect.call(self, evt, option);
	    UpdateCheckbox(option);
	  });
	}

	/**
	 * Plugin: "dropdown_header" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function clear_button (userOptions) {
	  const self = this;
	  const options = Object.assign({
	    className: 'clear-button',
	    title: 'Clear All',
	    html: data => {
	      return `<div class="${data.className}" title="${data.title}">&#10799;</div>`;
	    }
	  }, userOptions);
	  self.on('initialize', () => {
	    var button = getDom(options.html(options));
	    button.addEventListener('click', evt => {
	      if (self.isDisabled) {
	        return;
	      }

	      self.clear();

	      if (self.settings.mode === 'single' && self.settings.allowEmptyOption) {
	        self.addItem('');
	      }

	      evt.preventDefault();
	      evt.stopPropagation();
	    });
	    self.control.appendChild(button);
	  });
	}

	/**
	 * Plugin: "drag_drop" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function drag_drop () {
	  var self = this;
	  if (!$.fn.sortable) throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');
	  if (self.settings.mode !== 'multi') return;
	  var orig_lock = self.lock;
	  var orig_unlock = self.unlock;
	  self.hook('instead', 'lock', () => {
	    var sortable = $(self.control).data('sortable');
	    if (sortable) sortable.disable();
	    return orig_lock.call(self);
	  });
	  self.hook('instead', 'unlock', () => {
	    var sortable = $(self.control).data('sortable');
	    if (sortable) sortable.enable();
	    return orig_unlock.call(self);
	  });
	  self.on('initialize', () => {
	    var $control = $(self.control).sortable({
	      items: '[data-value]',
	      forcePlaceholderSize: true,
	      disabled: self.isLocked,
	      start: (e, ui) => {
	        ui.placeholder.css('width', ui.helper.css('width'));
	        $control.css({
	          overflow: 'visible'
	        });
	      },
	      stop: () => {
	        $control.css({
	          overflow: 'hidden'
	        });
	        var values = [];
	        $control.children('[data-value]').each(function () {
	          if (this.dataset.value) values.push(this.dataset.value);
	        });
	        self.setValue(values);
	      }
	    });
	  });
	}

	/**
	 * Plugin: "dropdown_header" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function dropdown_header (userOptions) {
	  const self = this;
	  const options = Object.assign({
	    title: 'Untitled',
	    headerClass: 'dropdown-header',
	    titleRowClass: 'dropdown-header-title',
	    labelClass: 'dropdown-header-label',
	    closeClass: 'dropdown-header-close',
	    html: data => {
	      return '<div class="' + data.headerClass + '">' + '<div class="' + data.titleRowClass + '">' + '<span class="' + data.labelClass + '">' + data.title + '</span>' + '<a class="' + data.closeClass + '">&times;</a>' + '</div>' + '</div>';
	    }
	  }, userOptions);
	  self.on('initialize', () => {
	    var header = getDom(options.html(options));
	    var close_link = header.querySelector('.' + options.closeClass);

	    if (close_link) {
	      close_link.addEventListener('click', evt => {
	        preventDefault(evt, true);
	        self.close();
	      });
	    }

	    self.dropdown.insertBefore(header, self.dropdown.firstChild);
	  });
	}

	/**
	 * Plugin: "dropdown_input" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function caret_position () {
	  var self = this;
	  /**
	   * Moves the caret to the specified index.
	   *
	   * The input must be moved by leaving it in place and moving the
	   * siblings, due to the fact that focus cannot be restored once lost
	   * on mobile webkit devices
	   *
	   */

	  self.hook('instead', 'setCaret', new_pos => {
	    if (self.settings.mode === 'single' || !self.control.contains(self.control_input)) {
	      new_pos = self.items.length;
	    } else {
	      new_pos = Math.max(0, Math.min(self.items.length, new_pos));

	      if (new_pos != self.caretPos && !self.isPending) {
	        self.controlChildren().forEach((child, j) => {
	          if (j < new_pos) {
	            self.control_input.insertAdjacentElement('beforebegin', child);
	          } else {
	            self.control.appendChild(child);
	          }
	        });
	      }
	    }

	    self.caretPos = new_pos;
	  });
	  self.hook('instead', 'moveCaret', direction => {
	    if (!self.isFocused) return; // move caret before or after selected items

	    const last_active = self.getLastActive(direction);

	    if (last_active) {
	      const idx = nodeIndex(last_active);
	      self.setCaret(direction > 0 ? idx + 1 : idx);
	      self.setActiveItem();
	      removeClasses(last_active, 'last-active'); // move caret left or right of current position
	    } else {
	      self.setCaret(self.caretPos + direction);
	    }
	  });
	}

	/**
	 * Plugin: "dropdown_input" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function dropdown_input () {
	  const self = this;
	  self.settings.shouldOpen = true; // make sure the input is shown even if there are no options to display in the dropdown

	  self.hook('before', 'setup', () => {
	    self.focus_node = self.control;
	    addClasses(self.control_input, 'dropdown-input');
	    const div = getDom('<div class="dropdown-input-wrap">');
	    div.append(self.control_input);
	    self.dropdown.insertBefore(div, self.dropdown.firstChild); // set a placeholder in the select control

	    const placeholder = getDom('<input class="items-placeholder" tabindex="-1" />');
	    placeholder.placeholder = self.settings.placeholder || '';
	    self.control.append(placeholder);
	  });
	  self.on('initialize', () => {
	    // set tabIndex on control to -1, otherwise [shift+tab] will put focus right back on control_input
	    self.control_input.addEventListener('keydown', evt => {
	      //addEvent(self.control_input,'keydown' as const,(evt:KeyboardEvent) =>{
	      switch (evt.keyCode) {
	        case KEY_ESC:
	          if (self.isOpen) {
	            preventDefault(evt, true);
	            self.close();
	          }

	          self.clearActiveItems();
	          return;

	        case KEY_TAB:
	          self.focus_node.tabIndex = -1;
	          break;
	      }

	      return self.onKeyDown.call(self, evt);
	    });
	    self.on('blur', () => {
	      self.focus_node.tabIndex = self.isDisabled ? -1 : self.tabIndex;
	    }); // give the control_input focus when the dropdown is open

	    self.on('dropdown_open', () => {
	      self.control_input.focus();
	    }); // prevent onBlur from closing when focus is on the control_input

	    const orig_onBlur = self.onBlur;
	    self.hook('instead', 'onBlur', evt => {
	      if (evt && evt.relatedTarget == self.control_input) return;
	      return orig_onBlur.call(self);
	    });
	    addEvent(self.control_input, 'blur', () => self.onBlur()); // return focus to control to allow further keyboard input

	    self.hook('before', 'close', () => {
	      if (!self.isOpen) return;
	      self.focus_node.focus({
	        preventScroll: true
	      });
	    });
	  });
	}

	/**
	 * Plugin: "input_autogrow" (Tom Select)
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function input_autogrow () {
	  var self = this;
	  self.on('initialize', () => {
	    var test_input = document.createElement('span');
	    var control = self.control_input;
	    test_input.style.cssText = 'position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ';
	    self.wrapper.appendChild(test_input);
	    var transfer_styles = ['letterSpacing', 'fontSize', 'fontFamily', 'fontWeight', 'textTransform'];

	    for (const style_name of transfer_styles) {
	      // @ts-ignore TS7015 https://stackoverflow.com/a/50506154/697576
	      test_input.style[style_name] = control.style[style_name];
	    }
	    /**
	     * Set the control width
	     *
	     */


	    var resize = () => {
	      test_input.textContent = control.value;
	      control.style.width = test_input.clientWidth + 'px';
	    };

	    resize();
	    self.on('update item_add item_remove', resize);
	    addEvent(control, 'input', resize);
	    addEvent(control, 'keyup', resize);
	    addEvent(control, 'blur', resize);
	    addEvent(control, 'update', resize);
	  });
	}

	/**
	 * Plugin: "input_autogrow" (Tom Select)
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function no_backspace_delete () {
	  var self = this;
	  var orig_deleteSelection = self.deleteSelection;
	  this.hook('instead', 'deleteSelection', evt => {
	    if (self.activeItems.length) {
	      return orig_deleteSelection.call(self, evt);
	    }

	    return false;
	  });
	}

	/**
	 * Plugin: "no_active_items" (Tom Select)
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function no_active_items () {
	  this.hook('instead', 'setActiveItem', () => {});
	  this.hook('instead', 'selectAll', () => {});
	}

	/**
	 * Plugin: "optgroup_columns" (Tom Select.js)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function optgroup_columns () {
	  var self = this;
	  var orig_keydown = self.onKeyDown;
	  self.hook('instead', 'onKeyDown', evt => {
	    var index, option, options, optgroup;

	    if (!self.isOpen || !(evt.keyCode === KEY_LEFT || evt.keyCode === KEY_RIGHT)) {
	      return orig_keydown.call(self, evt);
	    }

	    self.ignoreHover = true;
	    optgroup = parentMatch(self.activeOption, '[data-group]');
	    index = nodeIndex(self.activeOption, '[data-selectable]');

	    if (!optgroup) {
	      return;
	    }

	    if (evt.keyCode === KEY_LEFT) {
	      optgroup = optgroup.previousSibling;
	    } else {
	      optgroup = optgroup.nextSibling;
	    }

	    if (!optgroup) {
	      return;
	    }

	    options = optgroup.querySelectorAll('[data-selectable]');
	    option = options[Math.min(options.length - 1, index)];

	    if (option) {
	      self.setActiveOption(option);
	    }
	  });
	}

	/**
	 * Plugin: "remove_button" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function remove_button (userOptions) {
	  const options = Object.assign({
	    label: '&times;',
	    title: 'Remove',
	    className: 'remove',
	    append: true
	  }, userOptions); //options.className = 'remove-single';

	  var self = this; // override the render method to add remove button to each item

	  if (!options.append) {
	    return;
	  }

	  var html = '<a href="javascript:void(0)" class="' + options.className + '" tabindex="-1" title="' + escape_html(options.title) + '">' + options.label + '</a>';
	  self.hook('after', 'setupTemplates', () => {
	    var orig_render_item = self.settings.render.item;

	    self.settings.render.item = (data, escape) => {
	      var item = getDom(orig_render_item.call(self, data, escape));
	      var close_button = getDom(html);
	      item.appendChild(close_button);
	      addEvent(close_button, 'mousedown', evt => {
	        preventDefault(evt, true);
	      });
	      addEvent(close_button, 'click', evt => {
	        // propagating will trigger the dropdown to show for single mode
	        preventDefault(evt, true);
	        if (self.isLocked) return;
	        if (!self.shouldDelete([item], evt)) return;
	        self.removeItem(item);
	        self.refreshOptions(false);
	        self.inputState();
	      });
	      return item;
	    };
	  });
	}

	/**
	 * Plugin: "restore_on_backspace" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function restore_on_backspace (userOptions) {
	  const self = this;
	  const options = Object.assign({
	    text: option => {
	      return option[self.settings.labelField];
	    }
	  }, userOptions);
	  self.on('item_remove', function (value) {
	    if (!self.isFocused) {
	      return;
	    }

	    if (self.control_input.value.trim() === '') {
	      var option = self.options[value];

	      if (option) {
	        self.setTextboxValue(options.text.call(self, option));
	      }
	    }
	  });
	}

	/**
	 * Plugin: "restore_on_backspace" (Tom Select)
	 * Copyright (c) contributors
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
	 * file except in compliance with the License. You may obtain a copy of the License at:
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
	 * ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 *
	 */
	function virtual_scroll () {
	  const self = this;
	  const orig_canLoad = self.canLoad;
	  const orig_clearActiveOption = self.clearActiveOption;
	  const orig_loadCallback = self.loadCallback;
	  var pagination = {};
	  var dropdown_content;
	  var loading_more = false;
	  var load_more_opt;
	  var default_values = [];

	  if (!self.settings.shouldLoadMore) {
	    // return true if additional results should be loaded
	    self.settings.shouldLoadMore = () => {
	      const scroll_percent = dropdown_content.clientHeight / (dropdown_content.scrollHeight - dropdown_content.scrollTop);

	      if (scroll_percent > 0.9) {
	        return true;
	      }

	      if (self.activeOption) {
	        var selectable = self.selectable();
	        var index = Array.from(selectable).indexOf(self.activeOption);

	        if (index >= selectable.length - 2) {
	          return true;
	        }
	      }

	      return false;
	    };
	  }

	  if (!self.settings.firstUrl) {
	    throw 'virtual_scroll plugin requires a firstUrl() method';
	  } // in order for virtual scrolling to work,
	  // options need to be ordered the same way they're returned from the remote data source


	  self.settings.sortField = [{
	    field: '$order'
	  }, {
	    field: '$score'
	  }]; // can we load more results for given query?

	  const canLoadMore = query => {
	    if (typeof self.settings.maxOptions === 'number' && dropdown_content.children.length >= self.settings.maxOptions) {
	      return false;
	    }

	    if (query in pagination && pagination[query]) {
	      return true;
	    }

	    return false;
	  };

	  const clearFilter = (option, value) => {
	    if (self.items.indexOf(value) >= 0 || default_values.indexOf(value) >= 0) {
	      return true;
	    }

	    return false;
	  }; // set the next url that will be


	  self.setNextUrl = (value, next_url) => {
	    pagination[value] = next_url;
	  }; // getUrl() to be used in settings.load()


	  self.getUrl = query => {
	    if (query in pagination) {
	      const next_url = pagination[query];
	      pagination[query] = false;
	      return next_url;
	    } // if the user goes back to a previous query
	    // we need to load the first page again


	    pagination = {};
	    return self.settings.firstUrl.call(self, query);
	  }; // don't clear the active option (and cause unwanted dropdown scroll)
	  // while loading more results


	  self.hook('instead', 'clearActiveOption', () => {
	    if (loading_more) {
	      return;
	    }

	    return orig_clearActiveOption.call(self);
	  }); // override the canLoad method

	  self.hook('instead', 'canLoad', query => {
	    // first time the query has been seen
	    if (!(query in pagination)) {
	      return orig_canLoad.call(self, query);
	    }

	    return canLoadMore(query);
	  }); // wrap the load

	  self.hook('instead', 'loadCallback', (options, optgroups) => {
	    if (!loading_more) {
	      self.clearOptions(clearFilter);
	    } else if (load_more_opt) {
	      const first_option = options[0];

	      if (first_option !== undefined) {
	        load_more_opt.dataset.value = first_option[self.settings.valueField];
	      }
	    }

	    orig_loadCallback.call(self, options, optgroups);
	    loading_more = false;
	  }); // add templates to dropdown
	  //	loading_more if we have another url in the queue
	  //	no_more_results if we don't have another url in the queue

	  self.hook('after', 'refreshOptions', () => {
	    const query = self.lastValue;
	    var option;

	    if (canLoadMore(query)) {
	      option = self.render('loading_more', {
	        query: query
	      });

	      if (option) {
	        option.setAttribute('data-selectable', ''); // so that navigating dropdown with [down] keypresses can navigate to this node

	        load_more_opt = option;
	      }
	    } else if (query in pagination && !dropdown_content.querySelector('.no-results')) {
	      option = self.render('no_more_results', {
	        query: query
	      });
	    }

	    if (option) {
	      addClasses(option, self.settings.optionClass);
	      dropdown_content.append(option);
	    }
	  }); // add scroll listener and default templates

	  self.on('initialize', () => {
	    default_values = Object.keys(self.options);
	    dropdown_content = self.dropdown_content; // default templates

	    self.settings.render = Object.assign({}, {
	      loading_more: () => {
	        return `<div class="loading-more-results">Loading more results ... </div>`;
	      },
	      no_more_results: () => {
	        return `<div class="no-more-results">No more results</div>`;
	      }
	    }, self.settings.render); // watch dropdown content scroll position

	    dropdown_content.addEventListener('scroll', () => {
	      if (!self.settings.shouldLoadMore.call(self)) {
	        return;
	      } // !important: this will get checked again in load() but we still need to check here otherwise loading_more will be set to true


	      if (!canLoadMore(self.lastValue)) {
	        return;
	      } // don't call load() too much


	      if (loading_more) return;
	      loading_more = true;
	      self.load.call(self, self.lastValue);
	    });
	  });
	}

	TomSelect.define('change_listener', change_listener);
	TomSelect.define('checkbox_options', checkbox_options);
	TomSelect.define('clear_button', clear_button);
	TomSelect.define('drag_drop', drag_drop);
	TomSelect.define('dropdown_header', dropdown_header);
	TomSelect.define('caret_position', caret_position);
	TomSelect.define('dropdown_input', dropdown_input);
	TomSelect.define('input_autogrow', input_autogrow);
	TomSelect.define('no_backspace_delete', no_backspace_delete);
	TomSelect.define('no_active_items', no_active_items);
	TomSelect.define('optgroup_columns', optgroup_columns);
	TomSelect.define('remove_button', remove_button);
	TomSelect.define('restore_on_backspace', restore_on_backspace);
	TomSelect.define('virtual_scroll', virtual_scroll);

	return TomSelect;

}));
var tomSelect=function(el,opts){return new TomSelect(el,opts);} 
//# sourceMappingURL=tom-select.complete.js.map


/***/ }),

/***/ "./node_modules/@ryangjchandler/alpine-tooltip/dist/module.esm.js":
/*!************************************************************************!*\
  !*** ./node_modules/@ryangjchandler/alpine-tooltip/dist/module.esm.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ module_default)
/* harmony export */ });
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __markAsModule = (target) => __defProp(target, "__esModule", {value: true});
var __commonJS = (callback, module) => () => {
  if (!module) {
    module = {exports: {}};
    callback(module.exports, module);
  }
  return module.exports;
};
var __exportStar = (target, module, desc) => {
  if (module && typeof module === "object" || typeof module === "function") {
    for (let key of __getOwnPropNames(module))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, {get: () => module[key], enumerable: !(desc = __getOwnPropDesc(module, key)) || desc.enumerable});
  }
  return target;
};
var __toModule = (module) => {
  return __exportStar(__markAsModule(__defProp(module != null ? __create(__getProtoOf(module)) : {}, "default", module && module.__esModule && "default" in module ? {get: () => module.default, enumerable: true} : {value: module, enumerable: true})), module);
};

// node_modules/@popperjs/core/dist/cjs/popper.js
var require_popper = __commonJS((exports) => {
  "use strict";
  Object.defineProperty(exports, "__esModule", {value: true});
  function getBoundingClientRect(element) {
    var rect = element.getBoundingClientRect();
    return {
      width: rect.width,
      height: rect.height,
      top: rect.top,
      right: rect.right,
      bottom: rect.bottom,
      left: rect.left,
      x: rect.left,
      y: rect.top
    };
  }
  function getWindow(node) {
    if (node == null) {
      return window;
    }
    if (node.toString() !== "[object Window]") {
      var ownerDocument = node.ownerDocument;
      return ownerDocument ? ownerDocument.defaultView || window : window;
    }
    return node;
  }
  function getWindowScroll(node) {
    var win = getWindow(node);
    var scrollLeft = win.pageXOffset;
    var scrollTop = win.pageYOffset;
    return {
      scrollLeft,
      scrollTop
    };
  }
  function isElement(node) {
    var OwnElement = getWindow(node).Element;
    return node instanceof OwnElement || node instanceof Element;
  }
  function isHTMLElement(node) {
    var OwnElement = getWindow(node).HTMLElement;
    return node instanceof OwnElement || node instanceof HTMLElement;
  }
  function isShadowRoot(node) {
    if (typeof ShadowRoot === "undefined") {
      return false;
    }
    var OwnElement = getWindow(node).ShadowRoot;
    return node instanceof OwnElement || node instanceof ShadowRoot;
  }
  function getHTMLElementScroll(element) {
    return {
      scrollLeft: element.scrollLeft,
      scrollTop: element.scrollTop
    };
  }
  function getNodeScroll(node) {
    if (node === getWindow(node) || !isHTMLElement(node)) {
      return getWindowScroll(node);
    } else {
      return getHTMLElementScroll(node);
    }
  }
  function getNodeName(element) {
    return element ? (element.nodeName || "").toLowerCase() : null;
  }
  function getDocumentElement(element) {
    return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
  }
  function getWindowScrollBarX(element) {
    return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
  }
  function getComputedStyle(element) {
    return getWindow(element).getComputedStyle(element);
  }
  function isScrollParent(element) {
    var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
    return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
  }
  function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
    if (isFixed === void 0) {
      isFixed = false;
    }
    var documentElement = getDocumentElement(offsetParent);
    var rect = getBoundingClientRect(elementOrVirtualElement);
    var isOffsetParentAnElement = isHTMLElement(offsetParent);
    var scroll = {
      scrollLeft: 0,
      scrollTop: 0
    };
    var offsets = {
      x: 0,
      y: 0
    };
    if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
      if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
        scroll = getNodeScroll(offsetParent);
      }
      if (isHTMLElement(offsetParent)) {
        offsets = getBoundingClientRect(offsetParent);
        offsets.x += offsetParent.clientLeft;
        offsets.y += offsetParent.clientTop;
      } else if (documentElement) {
        offsets.x = getWindowScrollBarX(documentElement);
      }
    }
    return {
      x: rect.left + scroll.scrollLeft - offsets.x,
      y: rect.top + scroll.scrollTop - offsets.y,
      width: rect.width,
      height: rect.height
    };
  }
  function getLayoutRect(element) {
    var clientRect = getBoundingClientRect(element);
    var width = element.offsetWidth;
    var height = element.offsetHeight;
    if (Math.abs(clientRect.width - width) <= 1) {
      width = clientRect.width;
    }
    if (Math.abs(clientRect.height - height) <= 1) {
      height = clientRect.height;
    }
    return {
      x: element.offsetLeft,
      y: element.offsetTop,
      width,
      height
    };
  }
  function getParentNode(element) {
    if (getNodeName(element) === "html") {
      return element;
    }
    return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
  }
  function getScrollParent(node) {
    if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
      return node.ownerDocument.body;
    }
    if (isHTMLElement(node) && isScrollParent(node)) {
      return node;
    }
    return getScrollParent(getParentNode(node));
  }
  function listScrollParents(element, list) {
    var _element$ownerDocumen;
    if (list === void 0) {
      list = [];
    }
    var scrollParent = getScrollParent(element);
    var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
    var win = getWindow(scrollParent);
    var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
    var updatedList = list.concat(target);
    return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
  }
  function isTableElement(element) {
    return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
  }
  function getTrueOffsetParent(element) {
    if (!isHTMLElement(element) || getComputedStyle(element).position === "fixed") {
      return null;
    }
    return element.offsetParent;
  }
  function getContainingBlock(element) {
    var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") !== -1;
    var isIE = navigator.userAgent.indexOf("Trident") !== -1;
    if (isIE && isHTMLElement(element)) {
      var elementCss = getComputedStyle(element);
      if (elementCss.position === "fixed") {
        return null;
      }
    }
    var currentNode = getParentNode(element);
    while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
      var css = getComputedStyle(currentNode);
      if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
        return currentNode;
      } else {
        currentNode = currentNode.parentNode;
      }
    }
    return null;
  }
  function getOffsetParent(element) {
    var window2 = getWindow(element);
    var offsetParent = getTrueOffsetParent(element);
    while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
      offsetParent = getTrueOffsetParent(offsetParent);
    }
    if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
      return window2;
    }
    return offsetParent || getContainingBlock(element) || window2;
  }
  var top = "top";
  var bottom = "bottom";
  var right = "right";
  var left = "left";
  var auto = "auto";
  var basePlacements = [top, bottom, right, left];
  var start = "start";
  var end = "end";
  var clippingParents = "clippingParents";
  var viewport = "viewport";
  var popper = "popper";
  var reference = "reference";
  var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
    return acc.concat([placement + "-" + start, placement + "-" + end]);
  }, []);
  var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
    return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
  }, []);
  var beforeRead = "beforeRead";
  var read = "read";
  var afterRead = "afterRead";
  var beforeMain = "beforeMain";
  var main = "main";
  var afterMain = "afterMain";
  var beforeWrite = "beforeWrite";
  var write = "write";
  var afterWrite = "afterWrite";
  var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];
  function order(modifiers) {
    var map = new Map();
    var visited = new Set();
    var result = [];
    modifiers.forEach(function(modifier) {
      map.set(modifier.name, modifier);
    });
    function sort(modifier) {
      visited.add(modifier.name);
      var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
      requires.forEach(function(dep) {
        if (!visited.has(dep)) {
          var depModifier = map.get(dep);
          if (depModifier) {
            sort(depModifier);
          }
        }
      });
      result.push(modifier);
    }
    modifiers.forEach(function(modifier) {
      if (!visited.has(modifier.name)) {
        sort(modifier);
      }
    });
    return result;
  }
  function orderModifiers(modifiers) {
    var orderedModifiers = order(modifiers);
    return modifierPhases.reduce(function(acc, phase) {
      return acc.concat(orderedModifiers.filter(function(modifier) {
        return modifier.phase === phase;
      }));
    }, []);
  }
  function debounce(fn) {
    var pending;
    return function() {
      if (!pending) {
        pending = new Promise(function(resolve) {
          Promise.resolve().then(function() {
            pending = void 0;
            resolve(fn());
          });
        });
      }
      return pending;
    };
  }
  function format(str) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }
    return [].concat(args).reduce(function(p, c) {
      return p.replace(/%s/, c);
    }, str);
  }
  var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
  var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
  var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
  function validateModifiers(modifiers) {
    modifiers.forEach(function(modifier) {
      Object.keys(modifier).forEach(function(key) {
        switch (key) {
          case "name":
            if (typeof modifier.name !== "string") {
              console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
            }
            break;
          case "enabled":
            if (typeof modifier.enabled !== "boolean") {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
            }
          case "phase":
            if (modifierPhases.indexOf(modifier.phase) < 0) {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
            }
            break;
          case "fn":
            if (typeof modifier.fn !== "function") {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
            }
            break;
          case "effect":
            if (typeof modifier.effect !== "function") {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
            }
            break;
          case "requires":
            if (!Array.isArray(modifier.requires)) {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
            }
            break;
          case "requiresIfExists":
            if (!Array.isArray(modifier.requiresIfExists)) {
              console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
            }
            break;
          case "options":
          case "data":
            break;
          default:
            console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
              return '"' + s + '"';
            }).join(", ") + '; but "' + key + '" was provided.');
        }
        modifier.requires && modifier.requires.forEach(function(requirement) {
          if (modifiers.find(function(mod) {
            return mod.name === requirement;
          }) == null) {
            console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
          }
        });
      });
    });
  }
  function uniqueBy(arr, fn) {
    var identifiers = new Set();
    return arr.filter(function(item) {
      var identifier = fn(item);
      if (!identifiers.has(identifier)) {
        identifiers.add(identifier);
        return true;
      }
    });
  }
  function getBasePlacement(placement) {
    return placement.split("-")[0];
  }
  function mergeByName(modifiers) {
    var merged = modifiers.reduce(function(merged2, current) {
      var existing = merged2[current.name];
      merged2[current.name] = existing ? Object.assign({}, existing, current, {
        options: Object.assign({}, existing.options, current.options),
        data: Object.assign({}, existing.data, current.data)
      }) : current;
      return merged2;
    }, {});
    return Object.keys(merged).map(function(key) {
      return merged[key];
    });
  }
  function getViewportRect(element) {
    var win = getWindow(element);
    var html = getDocumentElement(element);
    var visualViewport = win.visualViewport;
    var width = html.clientWidth;
    var height = html.clientHeight;
    var x = 0;
    var y = 0;
    if (visualViewport) {
      width = visualViewport.width;
      height = visualViewport.height;
      if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {
        x = visualViewport.offsetLeft;
        y = visualViewport.offsetTop;
      }
    }
    return {
      width,
      height,
      x: x + getWindowScrollBarX(element),
      y
    };
  }
  var max = Math.max;
  var min = Math.min;
  var round = Math.round;
  function getDocumentRect(element) {
    var _element$ownerDocumen;
    var html = getDocumentElement(element);
    var winScroll = getWindowScroll(element);
    var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
    var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
    var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
    var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
    var y = -winScroll.scrollTop;
    if (getComputedStyle(body || html).direction === "rtl") {
      x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
    }
    return {
      width,
      height,
      x,
      y
    };
  }
  function contains(parent, child) {
    var rootNode = child.getRootNode && child.getRootNode();
    if (parent.contains(child)) {
      return true;
    } else if (rootNode && isShadowRoot(rootNode)) {
      var next = child;
      do {
        if (next && parent.isSameNode(next)) {
          return true;
        }
        next = next.parentNode || next.host;
      } while (next);
    }
    return false;
  }
  function rectToClientRect(rect) {
    return Object.assign({}, rect, {
      left: rect.x,
      top: rect.y,
      right: rect.x + rect.width,
      bottom: rect.y + rect.height
    });
  }
  function getInnerBoundingClientRect(element) {
    var rect = getBoundingClientRect(element);
    rect.top = rect.top + element.clientTop;
    rect.left = rect.left + element.clientLeft;
    rect.bottom = rect.top + element.clientHeight;
    rect.right = rect.left + element.clientWidth;
    rect.width = element.clientWidth;
    rect.height = element.clientHeight;
    rect.x = rect.left;
    rect.y = rect.top;
    return rect;
  }
  function getClientRectFromMixedType(element, clippingParent) {
    return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isHTMLElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
  }
  function getClippingParents(element) {
    var clippingParents2 = listScrollParents(getParentNode(element));
    var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
    var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
    if (!isElement(clipperElement)) {
      return [];
    }
    return clippingParents2.filter(function(clippingParent) {
      return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
    });
  }
  function getClippingRect(element, boundary, rootBoundary) {
    var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
    var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
    var firstClippingParent = clippingParents2[0];
    var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
      var rect = getClientRectFromMixedType(element, clippingParent);
      accRect.top = max(rect.top, accRect.top);
      accRect.right = min(rect.right, accRect.right);
      accRect.bottom = min(rect.bottom, accRect.bottom);
      accRect.left = max(rect.left, accRect.left);
      return accRect;
    }, getClientRectFromMixedType(element, firstClippingParent));
    clippingRect.width = clippingRect.right - clippingRect.left;
    clippingRect.height = clippingRect.bottom - clippingRect.top;
    clippingRect.x = clippingRect.left;
    clippingRect.y = clippingRect.top;
    return clippingRect;
  }
  function getVariation(placement) {
    return placement.split("-")[1];
  }
  function getMainAxisFromPlacement(placement) {
    return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
  }
  function computeOffsets(_ref) {
    var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
    var basePlacement = placement ? getBasePlacement(placement) : null;
    var variation = placement ? getVariation(placement) : null;
    var commonX = reference2.x + reference2.width / 2 - element.width / 2;
    var commonY = reference2.y + reference2.height / 2 - element.height / 2;
    var offsets;
    switch (basePlacement) {
      case top:
        offsets = {
          x: commonX,
          y: reference2.y - element.height
        };
        break;
      case bottom:
        offsets = {
          x: commonX,
          y: reference2.y + reference2.height
        };
        break;
      case right:
        offsets = {
          x: reference2.x + reference2.width,
          y: commonY
        };
        break;
      case left:
        offsets = {
          x: reference2.x - element.width,
          y: commonY
        };
        break;
      default:
        offsets = {
          x: reference2.x,
          y: reference2.y
        };
    }
    var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
    if (mainAxis != null) {
      var len = mainAxis === "y" ? "height" : "width";
      switch (variation) {
        case start:
          offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
          break;
        case end:
          offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
          break;
      }
    }
    return offsets;
  }
  function getFreshSideObject() {
    return {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
  }
  function mergePaddingObject(paddingObject) {
    return Object.assign({}, getFreshSideObject(), paddingObject);
  }
  function expandToHashMap(value, keys) {
    return keys.reduce(function(hashMap, key) {
      hashMap[key] = value;
      return hashMap;
    }, {});
  }
  function detectOverflow(state, options) {
    if (options === void 0) {
      options = {};
    }
    var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
    var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
    var altContext = elementContext === popper ? reference : popper;
    var referenceElement = state.elements.reference;
    var popperRect = state.rects.popper;
    var element = state.elements[altBoundary ? altContext : elementContext];
    var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);
    var referenceClientRect = getBoundingClientRect(referenceElement);
    var popperOffsets2 = computeOffsets({
      reference: referenceClientRect,
      element: popperRect,
      strategy: "absolute",
      placement
    });
    var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
    var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
    var overflowOffsets = {
      top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
      bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
      left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
      right: elementClientRect.right - clippingClientRect.right + paddingObject.right
    };
    var offsetData = state.modifiersData.offset;
    if (elementContext === popper && offsetData) {
      var offset2 = offsetData[placement];
      Object.keys(overflowOffsets).forEach(function(key) {
        var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
        var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
        overflowOffsets[key] += offset2[axis] * multiply;
      });
    }
    return overflowOffsets;
  }
  var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
  var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
  var DEFAULT_OPTIONS = {
    placement: "bottom",
    modifiers: [],
    strategy: "absolute"
  };
  function areValidElements() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    return !args.some(function(element) {
      return !(element && typeof element.getBoundingClientRect === "function");
    });
  }
  function popperGenerator(generatorOptions) {
    if (generatorOptions === void 0) {
      generatorOptions = {};
    }
    var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
    return function createPopper2(reference2, popper2, options) {
      if (options === void 0) {
        options = defaultOptions;
      }
      var state = {
        placement: "bottom",
        orderedModifiers: [],
        options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
        modifiersData: {},
        elements: {
          reference: reference2,
          popper: popper2
        },
        attributes: {},
        styles: {}
      };
      var effectCleanupFns = [];
      var isDestroyed = false;
      var instance = {
        state,
        setOptions: function setOptions(options2) {
          cleanupModifierEffects();
          state.options = Object.assign({}, defaultOptions, state.options, options2);
          state.scrollParents = {
            reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
            popper: listScrollParents(popper2)
          };
          var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
          state.orderedModifiers = orderedModifiers.filter(function(m) {
            return m.enabled;
          });
          if (true) {
            var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
              var name = _ref.name;
              return name;
            });
            validateModifiers(modifiers);
            if (getBasePlacement(state.options.placement) === auto) {
              var flipModifier = state.orderedModifiers.find(function(_ref2) {
                var name = _ref2.name;
                return name === "flip";
              });
              if (!flipModifier) {
                console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
              }
            }
            var _getComputedStyle = getComputedStyle(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
            if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
              return parseFloat(margin);
            })) {
              console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
            }
          }
          runModifierEffects();
          return instance.update();
        },
        forceUpdate: function forceUpdate() {
          if (isDestroyed) {
            return;
          }
          var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
          if (!areValidElements(reference3, popper3)) {
            if (true) {
              console.error(INVALID_ELEMENT_ERROR);
            }
            return;
          }
          state.rects = {
            reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
            popper: getLayoutRect(popper3)
          };
          state.reset = false;
          state.placement = state.options.placement;
          state.orderedModifiers.forEach(function(modifier) {
            return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
          });
          var __debug_loops__ = 0;
          for (var index = 0; index < state.orderedModifiers.length; index++) {
            if (true) {
              __debug_loops__ += 1;
              if (__debug_loops__ > 100) {
                console.error(INFINITE_LOOP_ERROR);
                break;
              }
            }
            if (state.reset === true) {
              state.reset = false;
              index = -1;
              continue;
            }
            var _state$orderedModifie = state.orderedModifiers[index], fn = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
            if (typeof fn === "function") {
              state = fn({
                state,
                options: _options,
                name,
                instance
              }) || state;
            }
          }
        },
        update: debounce(function() {
          return new Promise(function(resolve) {
            instance.forceUpdate();
            resolve(state);
          });
        }),
        destroy: function destroy() {
          cleanupModifierEffects();
          isDestroyed = true;
        }
      };
      if (!areValidElements(reference2, popper2)) {
        if (true) {
          console.error(INVALID_ELEMENT_ERROR);
        }
        return instance;
      }
      instance.setOptions(options).then(function(state2) {
        if (!isDestroyed && options.onFirstUpdate) {
          options.onFirstUpdate(state2);
        }
      });
      function runModifierEffects() {
        state.orderedModifiers.forEach(function(_ref3) {
          var name = _ref3.name, _ref3$options = _ref3.options, options2 = _ref3$options === void 0 ? {} : _ref3$options, effect2 = _ref3.effect;
          if (typeof effect2 === "function") {
            var cleanupFn = effect2({
              state,
              name,
              instance,
              options: options2
            });
            var noopFn = function noopFn2() {
            };
            effectCleanupFns.push(cleanupFn || noopFn);
          }
        });
      }
      function cleanupModifierEffects() {
        effectCleanupFns.forEach(function(fn) {
          return fn();
        });
        effectCleanupFns = [];
      }
      return instance;
    };
  }
  var passive = {
    passive: true
  };
  function effect$2(_ref) {
    var state = _ref.state, instance = _ref.instance, options = _ref.options;
    var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
    var window2 = getWindow(state.elements.popper);
    var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.addEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.addEventListener("resize", instance.update, passive);
    }
    return function() {
      if (scroll) {
        scrollParents.forEach(function(scrollParent) {
          scrollParent.removeEventListener("scroll", instance.update, passive);
        });
      }
      if (resize) {
        window2.removeEventListener("resize", instance.update, passive);
      }
    };
  }
  var eventListeners = {
    name: "eventListeners",
    enabled: true,
    phase: "write",
    fn: function fn() {
    },
    effect: effect$2,
    data: {}
  };
  function popperOffsets(_ref) {
    var state = _ref.state, name = _ref.name;
    state.modifiersData[name] = computeOffsets({
      reference: state.rects.reference,
      element: state.rects.popper,
      strategy: "absolute",
      placement: state.placement
    });
  }
  var popperOffsets$1 = {
    name: "popperOffsets",
    enabled: true,
    phase: "read",
    fn: popperOffsets,
    data: {}
  };
  var unsetSides = {
    top: "auto",
    right: "auto",
    bottom: "auto",
    left: "auto"
  };
  function roundOffsetsByDPR(_ref) {
    var x = _ref.x, y = _ref.y;
    var win = window;
    var dpr = win.devicePixelRatio || 1;
    return {
      x: round(round(x * dpr) / dpr) || 0,
      y: round(round(y * dpr) / dpr) || 0
    };
  }
  function mapToStyles(_ref2) {
    var _Object$assign2;
    var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets;
    var _ref3 = roundOffsets === true ? roundOffsetsByDPR(offsets) : typeof roundOffsets === "function" ? roundOffsets(offsets) : offsets, _ref3$x = _ref3.x, x = _ref3$x === void 0 ? 0 : _ref3$x, _ref3$y = _ref3.y, y = _ref3$y === void 0 ? 0 : _ref3$y;
    var hasX = offsets.hasOwnProperty("x");
    var hasY = offsets.hasOwnProperty("y");
    var sideX = left;
    var sideY = top;
    var win = window;
    if (adaptive) {
      var offsetParent = getOffsetParent(popper2);
      var heightProp = "clientHeight";
      var widthProp = "clientWidth";
      if (offsetParent === getWindow(popper2)) {
        offsetParent = getDocumentElement(popper2);
        if (getComputedStyle(offsetParent).position !== "static") {
          heightProp = "scrollHeight";
          widthProp = "scrollWidth";
        }
      }
      offsetParent = offsetParent;
      if (placement === top) {
        sideY = bottom;
        y -= offsetParent[heightProp] - popperRect.height;
        y *= gpuAcceleration ? 1 : -1;
      }
      if (placement === left) {
        sideX = right;
        x -= offsetParent[widthProp] - popperRect.width;
        x *= gpuAcceleration ? 1 : -1;
      }
    }
    var commonStyles = Object.assign({
      position
    }, adaptive && unsetSides);
    if (gpuAcceleration) {
      var _Object$assign;
      return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) < 2 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
    }
    return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
  }
  function computeStyles(_ref4) {
    var state = _ref4.state, options = _ref4.options;
    var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
    if (true) {
      var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || "";
      if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
        return transitionProperty.indexOf(property) >= 0;
      })) {
        console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
      }
    }
    var commonStyles = {
      placement: getBasePlacement(state.placement),
      popper: state.elements.popper,
      popperRect: state.rects.popper,
      gpuAcceleration
    };
    if (state.modifiersData.popperOffsets != null) {
      state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
        offsets: state.modifiersData.popperOffsets,
        position: state.options.strategy,
        adaptive,
        roundOffsets
      })));
    }
    if (state.modifiersData.arrow != null) {
      state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
        offsets: state.modifiersData.arrow,
        position: "absolute",
        adaptive: false,
        roundOffsets
      })));
    }
    state.attributes.popper = Object.assign({}, state.attributes.popper, {
      "data-popper-placement": state.placement
    });
  }
  var computeStyles$1 = {
    name: "computeStyles",
    enabled: true,
    phase: "beforeWrite",
    fn: computeStyles,
    data: {}
  };
  function applyStyles(_ref) {
    var state = _ref.state;
    Object.keys(state.elements).forEach(function(name) {
      var style = state.styles[name] || {};
      var attributes = state.attributes[name] || {};
      var element = state.elements[name];
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(name2) {
        var value = attributes[name2];
        if (value === false) {
          element.removeAttribute(name2);
        } else {
          element.setAttribute(name2, value === true ? "" : value);
        }
      });
    });
  }
  function effect$1(_ref2) {
    var state = _ref2.state;
    var initialStyles = {
      popper: {
        position: state.options.strategy,
        left: "0",
        top: "0",
        margin: "0"
      },
      arrow: {
        position: "absolute"
      },
      reference: {}
    };
    Object.assign(state.elements.popper.style, initialStyles.popper);
    state.styles = initialStyles;
    if (state.elements.arrow) {
      Object.assign(state.elements.arrow.style, initialStyles.arrow);
    }
    return function() {
      Object.keys(state.elements).forEach(function(name) {
        var element = state.elements[name];
        var attributes = state.attributes[name] || {};
        var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
        var style = styleProperties.reduce(function(style2, property) {
          style2[property] = "";
          return style2;
        }, {});
        if (!isHTMLElement(element) || !getNodeName(element)) {
          return;
        }
        Object.assign(element.style, style);
        Object.keys(attributes).forEach(function(attribute) {
          element.removeAttribute(attribute);
        });
      });
    };
  }
  var applyStyles$1 = {
    name: "applyStyles",
    enabled: true,
    phase: "write",
    fn: applyStyles,
    effect: effect$1,
    requires: ["computeStyles"]
  };
  function distanceAndSkiddingToXY(placement, rects, offset2) {
    var basePlacement = getBasePlacement(placement);
    var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
    var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
      placement
    })) : offset2, skidding = _ref[0], distance = _ref[1];
    skidding = skidding || 0;
    distance = (distance || 0) * invertDistance;
    return [left, right].indexOf(basePlacement) >= 0 ? {
      x: distance,
      y: skidding
    } : {
      x: skidding,
      y: distance
    };
  }
  function offset(_ref2) {
    var state = _ref2.state, options = _ref2.options, name = _ref2.name;
    var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
    var data = placements.reduce(function(acc, placement) {
      acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
      return acc;
    }, {});
    var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
    if (state.modifiersData.popperOffsets != null) {
      state.modifiersData.popperOffsets.x += x;
      state.modifiersData.popperOffsets.y += y;
    }
    state.modifiersData[name] = data;
  }
  var offset$1 = {
    name: "offset",
    enabled: true,
    phase: "main",
    requires: ["popperOffsets"],
    fn: offset
  };
  var hash$1 = {
    left: "right",
    right: "left",
    bottom: "top",
    top: "bottom"
  };
  function getOppositePlacement(placement) {
    return placement.replace(/left|right|bottom|top/g, function(matched) {
      return hash$1[matched];
    });
  }
  var hash = {
    start: "end",
    end: "start"
  };
  function getOppositeVariationPlacement(placement) {
    return placement.replace(/start|end/g, function(matched) {
      return hash[matched];
    });
  }
  function computeAutoPlacement(state, options) {
    if (options === void 0) {
      options = {};
    }
    var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
    var variation = getVariation(placement);
    var placements$1 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
      return getVariation(placement2) === variation;
    }) : basePlacements;
    var allowedPlacements = placements$1.filter(function(placement2) {
      return allowedAutoPlacements.indexOf(placement2) >= 0;
    });
    if (allowedPlacements.length === 0) {
      allowedPlacements = placements$1;
      if (true) {
        console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
      }
    }
    var overflows = allowedPlacements.reduce(function(acc, placement2) {
      acc[placement2] = detectOverflow(state, {
        placement: placement2,
        boundary,
        rootBoundary,
        padding
      })[getBasePlacement(placement2)];
      return acc;
    }, {});
    return Object.keys(overflows).sort(function(a, b) {
      return overflows[a] - overflows[b];
    });
  }
  function getExpandedFallbackPlacements(placement) {
    if (getBasePlacement(placement) === auto) {
      return [];
    }
    var oppositePlacement = getOppositePlacement(placement);
    return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
  }
  function flip(_ref) {
    var state = _ref.state, options = _ref.options, name = _ref.name;
    if (state.modifiersData[name]._skip) {
      return;
    }
    var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
    var preferredPlacement = state.options.placement;
    var basePlacement = getBasePlacement(preferredPlacement);
    var isBasePlacement = basePlacement === preferredPlacement;
    var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
    var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
      return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
        placement: placement2,
        boundary,
        rootBoundary,
        padding,
        flipVariations,
        allowedAutoPlacements
      }) : placement2);
    }, []);
    var referenceRect = state.rects.reference;
    var popperRect = state.rects.popper;
    var checksMap = new Map();
    var makeFallbackChecks = true;
    var firstFittingPlacement = placements2[0];
    for (var i = 0; i < placements2.length; i++) {
      var placement = placements2[i];
      var _basePlacement = getBasePlacement(placement);
      var isStartVariation = getVariation(placement) === start;
      var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
      var len = isVertical ? "width" : "height";
      var overflow = detectOverflow(state, {
        placement,
        boundary,
        rootBoundary,
        altBoundary,
        padding
      });
      var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
      if (referenceRect[len] > popperRect[len]) {
        mainVariationSide = getOppositePlacement(mainVariationSide);
      }
      var altVariationSide = getOppositePlacement(mainVariationSide);
      var checks = [];
      if (checkMainAxis) {
        checks.push(overflow[_basePlacement] <= 0);
      }
      if (checkAltAxis) {
        checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
      }
      if (checks.every(function(check) {
        return check;
      })) {
        firstFittingPlacement = placement;
        makeFallbackChecks = false;
        break;
      }
      checksMap.set(placement, checks);
    }
    if (makeFallbackChecks) {
      var numberOfChecks = flipVariations ? 3 : 1;
      var _loop = function _loop2(_i2) {
        var fittingPlacement = placements2.find(function(placement2) {
          var checks2 = checksMap.get(placement2);
          if (checks2) {
            return checks2.slice(0, _i2).every(function(check) {
              return check;
            });
          }
        });
        if (fittingPlacement) {
          firstFittingPlacement = fittingPlacement;
          return "break";
        }
      };
      for (var _i = numberOfChecks; _i > 0; _i--) {
        var _ret = _loop(_i);
        if (_ret === "break")
          break;
      }
    }
    if (state.placement !== firstFittingPlacement) {
      state.modifiersData[name]._skip = true;
      state.placement = firstFittingPlacement;
      state.reset = true;
    }
  }
  var flip$1 = {
    name: "flip",
    enabled: true,
    phase: "main",
    fn: flip,
    requiresIfExists: ["offset"],
    data: {
      _skip: false
    }
  };
  function getAltAxis(axis) {
    return axis === "x" ? "y" : "x";
  }
  function within(min$1, value, max$1) {
    return max(min$1, min(value, max$1));
  }
  function preventOverflow(_ref) {
    var state = _ref.state, options = _ref.options, name = _ref.name;
    var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
    var overflow = detectOverflow(state, {
      boundary,
      rootBoundary,
      padding,
      altBoundary
    });
    var basePlacement = getBasePlacement(state.placement);
    var variation = getVariation(state.placement);
    var isBasePlacement = !variation;
    var mainAxis = getMainAxisFromPlacement(basePlacement);
    var altAxis = getAltAxis(mainAxis);
    var popperOffsets2 = state.modifiersData.popperOffsets;
    var referenceRect = state.rects.reference;
    var popperRect = state.rects.popper;
    var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
      placement: state.placement
    })) : tetherOffset;
    var data = {
      x: 0,
      y: 0
    };
    if (!popperOffsets2) {
      return;
    }
    if (checkMainAxis || checkAltAxis) {
      var mainSide = mainAxis === "y" ? top : left;
      var altSide = mainAxis === "y" ? bottom : right;
      var len = mainAxis === "y" ? "height" : "width";
      var offset2 = popperOffsets2[mainAxis];
      var min$1 = popperOffsets2[mainAxis] + overflow[mainSide];
      var max$1 = popperOffsets2[mainAxis] - overflow[altSide];
      var additive = tether ? -popperRect[len] / 2 : 0;
      var minLen = variation === start ? referenceRect[len] : popperRect[len];
      var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
      var arrowElement = state.elements.arrow;
      var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
        width: 0,
        height: 0
      };
      var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
      var arrowPaddingMin = arrowPaddingObject[mainSide];
      var arrowPaddingMax = arrowPaddingObject[altSide];
      var arrowLen = within(0, referenceRect[len], arrowRect[len]);
      var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - tetherOffsetValue : minLen - arrowLen - arrowPaddingMin - tetherOffsetValue;
      var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + tetherOffsetValue : maxLen + arrowLen + arrowPaddingMax + tetherOffsetValue;
      var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
      var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
      var offsetModifierValue = state.modifiersData.offset ? state.modifiersData.offset[state.placement][mainAxis] : 0;
      var tetherMin = popperOffsets2[mainAxis] + minOffset - offsetModifierValue - clientOffset;
      var tetherMax = popperOffsets2[mainAxis] + maxOffset - offsetModifierValue;
      if (checkMainAxis) {
        var preventedOffset = within(tether ? min(min$1, tetherMin) : min$1, offset2, tether ? max(max$1, tetherMax) : max$1);
        popperOffsets2[mainAxis] = preventedOffset;
        data[mainAxis] = preventedOffset - offset2;
      }
      if (checkAltAxis) {
        var _mainSide = mainAxis === "x" ? top : left;
        var _altSide = mainAxis === "x" ? bottom : right;
        var _offset = popperOffsets2[altAxis];
        var _min = _offset + overflow[_mainSide];
        var _max = _offset - overflow[_altSide];
        var _preventedOffset = within(tether ? min(_min, tetherMin) : _min, _offset, tether ? max(_max, tetherMax) : _max);
        popperOffsets2[altAxis] = _preventedOffset;
        data[altAxis] = _preventedOffset - _offset;
      }
    }
    state.modifiersData[name] = data;
  }
  var preventOverflow$1 = {
    name: "preventOverflow",
    enabled: true,
    phase: "main",
    fn: preventOverflow,
    requiresIfExists: ["offset"]
  };
  var toPaddingObject = function toPaddingObject2(padding, state) {
    padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
      placement: state.placement
    })) : padding;
    return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  };
  function arrow(_ref) {
    var _state$modifiersData$;
    var state = _ref.state, name = _ref.name, options = _ref.options;
    var arrowElement = state.elements.arrow;
    var popperOffsets2 = state.modifiersData.popperOffsets;
    var basePlacement = getBasePlacement(state.placement);
    var axis = getMainAxisFromPlacement(basePlacement);
    var isVertical = [left, right].indexOf(basePlacement) >= 0;
    var len = isVertical ? "height" : "width";
    if (!arrowElement || !popperOffsets2) {
      return;
    }
    var paddingObject = toPaddingObject(options.padding, state);
    var arrowRect = getLayoutRect(arrowElement);
    var minProp = axis === "y" ? top : left;
    var maxProp = axis === "y" ? bottom : right;
    var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
    var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
    var arrowOffsetParent = getOffsetParent(arrowElement);
    var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
    var centerToReference = endDiff / 2 - startDiff / 2;
    var min2 = paddingObject[minProp];
    var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
    var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
    var offset2 = within(min2, center, max2);
    var axisProp = axis;
    state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
  }
  function effect(_ref2) {
    var state = _ref2.state, options = _ref2.options;
    var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
    if (arrowElement == null) {
      return;
    }
    if (typeof arrowElement === "string") {
      arrowElement = state.elements.popper.querySelector(arrowElement);
      if (!arrowElement) {
        return;
      }
    }
    if (true) {
      if (!isHTMLElement(arrowElement)) {
        console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
      }
    }
    if (!contains(state.elements.popper, arrowElement)) {
      if (true) {
        console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
      }
      return;
    }
    state.elements.arrow = arrowElement;
  }
  var arrow$1 = {
    name: "arrow",
    enabled: true,
    phase: "main",
    fn: arrow,
    effect,
    requires: ["popperOffsets"],
    requiresIfExists: ["preventOverflow"]
  };
  function getSideOffsets(overflow, rect, preventedOffsets) {
    if (preventedOffsets === void 0) {
      preventedOffsets = {
        x: 0,
        y: 0
      };
    }
    return {
      top: overflow.top - rect.height - preventedOffsets.y,
      right: overflow.right - rect.width + preventedOffsets.x,
      bottom: overflow.bottom - rect.height + preventedOffsets.y,
      left: overflow.left - rect.width - preventedOffsets.x
    };
  }
  function isAnySideFullyClipped(overflow) {
    return [top, right, bottom, left].some(function(side) {
      return overflow[side] >= 0;
    });
  }
  function hide(_ref) {
    var state = _ref.state, name = _ref.name;
    var referenceRect = state.rects.reference;
    var popperRect = state.rects.popper;
    var preventedOffsets = state.modifiersData.preventOverflow;
    var referenceOverflow = detectOverflow(state, {
      elementContext: "reference"
    });
    var popperAltOverflow = detectOverflow(state, {
      altBoundary: true
    });
    var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
    var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
    var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
    var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
    state.modifiersData[name] = {
      referenceClippingOffsets,
      popperEscapeOffsets,
      isReferenceHidden,
      hasPopperEscaped
    };
    state.attributes.popper = Object.assign({}, state.attributes.popper, {
      "data-popper-reference-hidden": isReferenceHidden,
      "data-popper-escaped": hasPopperEscaped
    });
  }
  var hide$1 = {
    name: "hide",
    enabled: true,
    phase: "main",
    requiresIfExists: ["preventOverflow"],
    fn: hide
  };
  var defaultModifiers$1 = [eventListeners, popperOffsets$1, computeStyles$1, applyStyles$1];
  var createPopper$1 = /* @__PURE__ */ popperGenerator({
    defaultModifiers: defaultModifiers$1
  });
  var defaultModifiers = [eventListeners, popperOffsets$1, computeStyles$1, applyStyles$1, offset$1, flip$1, preventOverflow$1, arrow$1, hide$1];
  var createPopper = /* @__PURE__ */ popperGenerator({
    defaultModifiers
  });
  exports.applyStyles = applyStyles$1;
  exports.arrow = arrow$1;
  exports.computeStyles = computeStyles$1;
  exports.createPopper = createPopper;
  exports.createPopperLite = createPopper$1;
  exports.defaultModifiers = defaultModifiers;
  exports.detectOverflow = detectOverflow;
  exports.eventListeners = eventListeners;
  exports.flip = flip$1;
  exports.hide = hide$1;
  exports.offset = offset$1;
  exports.popperGenerator = popperGenerator;
  exports.popperOffsets = popperOffsets$1;
  exports.preventOverflow = preventOverflow$1;
});

// node_modules/tippy.js/dist/tippy.cjs.js
var require_tippy_cjs = __commonJS((exports) => {
  "use strict";
  Object.defineProperty(exports, "__esModule", {value: true});
  var core = require_popper();
  var ROUND_ARROW = '<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>';
  var BOX_CLASS = "tippy-box";
  var CONTENT_CLASS = "tippy-content";
  var BACKDROP_CLASS = "tippy-backdrop";
  var ARROW_CLASS = "tippy-arrow";
  var SVG_ARROW_CLASS = "tippy-svg-arrow";
  var TOUCH_OPTIONS = {
    passive: true,
    capture: true
  };
  function hasOwnProperty(obj, key) {
    return {}.hasOwnProperty.call(obj, key);
  }
  function getValueAtIndexOrReturn(value, index, defaultValue) {
    if (Array.isArray(value)) {
      var v = value[index];
      return v == null ? Array.isArray(defaultValue) ? defaultValue[index] : defaultValue : v;
    }
    return value;
  }
  function isType(value, type) {
    var str = {}.toString.call(value);
    return str.indexOf("[object") === 0 && str.indexOf(type + "]") > -1;
  }
  function invokeWithArgsOrReturn(value, args) {
    return typeof value === "function" ? value.apply(void 0, args) : value;
  }
  function debounce(fn, ms) {
    if (ms === 0) {
      return fn;
    }
    var timeout;
    return function(arg) {
      clearTimeout(timeout);
      timeout = setTimeout(function() {
        fn(arg);
      }, ms);
    };
  }
  function removeProperties(obj, keys) {
    var clone = Object.assign({}, obj);
    keys.forEach(function(key) {
      delete clone[key];
    });
    return clone;
  }
  function splitBySpaces(value) {
    return value.split(/\s+/).filter(Boolean);
  }
  function normalizeToArray(value) {
    return [].concat(value);
  }
  function pushIfUnique(arr, value) {
    if (arr.indexOf(value) === -1) {
      arr.push(value);
    }
  }
  function unique(arr) {
    return arr.filter(function(item, index) {
      return arr.indexOf(item) === index;
    });
  }
  function getBasePlacement(placement) {
    return placement.split("-")[0];
  }
  function arrayFrom(value) {
    return [].slice.call(value);
  }
  function removeUndefinedProps(obj) {
    return Object.keys(obj).reduce(function(acc, key) {
      if (obj[key] !== void 0) {
        acc[key] = obj[key];
      }
      return acc;
    }, {});
  }
  function div() {
    return document.createElement("div");
  }
  function isElement(value) {
    return ["Element", "Fragment"].some(function(type) {
      return isType(value, type);
    });
  }
  function isNodeList(value) {
    return isType(value, "NodeList");
  }
  function isMouseEvent(value) {
    return isType(value, "MouseEvent");
  }
  function isReferenceElement(value) {
    return !!(value && value._tippy && value._tippy.reference === value);
  }
  function getArrayOfElements(value) {
    if (isElement(value)) {
      return [value];
    }
    if (isNodeList(value)) {
      return arrayFrom(value);
    }
    if (Array.isArray(value)) {
      return value;
    }
    return arrayFrom(document.querySelectorAll(value));
  }
  function setTransitionDuration(els, value) {
    els.forEach(function(el) {
      if (el) {
        el.style.transitionDuration = value + "ms";
      }
    });
  }
  function setVisibilityState(els, state) {
    els.forEach(function(el) {
      if (el) {
        el.setAttribute("data-state", state);
      }
    });
  }
  function getOwnerDocument(elementOrElements) {
    var _element$ownerDocumen;
    var _normalizeToArray = normalizeToArray(elementOrElements), element = _normalizeToArray[0];
    return (element == null ? void 0 : (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body) ? element.ownerDocument : document;
  }
  function isCursorOutsideInteractiveBorder(popperTreeData, event) {
    var clientX = event.clientX, clientY = event.clientY;
    return popperTreeData.every(function(_ref) {
      var popperRect = _ref.popperRect, popperState = _ref.popperState, props = _ref.props;
      var interactiveBorder = props.interactiveBorder;
      var basePlacement = getBasePlacement(popperState.placement);
      var offsetData = popperState.modifiersData.offset;
      if (!offsetData) {
        return true;
      }
      var topDistance = basePlacement === "bottom" ? offsetData.top.y : 0;
      var bottomDistance = basePlacement === "top" ? offsetData.bottom.y : 0;
      var leftDistance = basePlacement === "right" ? offsetData.left.x : 0;
      var rightDistance = basePlacement === "left" ? offsetData.right.x : 0;
      var exceedsTop = popperRect.top - clientY + topDistance > interactiveBorder;
      var exceedsBottom = clientY - popperRect.bottom - bottomDistance > interactiveBorder;
      var exceedsLeft = popperRect.left - clientX + leftDistance > interactiveBorder;
      var exceedsRight = clientX - popperRect.right - rightDistance > interactiveBorder;
      return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;
    });
  }
  function updateTransitionEndListener(box, action, listener) {
    var method = action + "EventListener";
    ["transitionend", "webkitTransitionEnd"].forEach(function(event) {
      box[method](event, listener);
    });
  }
  var currentInput = {
    isTouch: false
  };
  var lastMouseMoveTime = 0;
  function onDocumentTouchStart() {
    if (currentInput.isTouch) {
      return;
    }
    currentInput.isTouch = true;
    if (window.performance) {
      document.addEventListener("mousemove", onDocumentMouseMove);
    }
  }
  function onDocumentMouseMove() {
    var now = performance.now();
    if (now - lastMouseMoveTime < 20) {
      currentInput.isTouch = false;
      document.removeEventListener("mousemove", onDocumentMouseMove);
    }
    lastMouseMoveTime = now;
  }
  function onWindowBlur() {
    var activeElement = document.activeElement;
    if (isReferenceElement(activeElement)) {
      var instance = activeElement._tippy;
      if (activeElement.blur && !instance.state.isVisible) {
        activeElement.blur();
      }
    }
  }
  function bindGlobalEventListeners() {
    document.addEventListener("touchstart", onDocumentTouchStart, TOUCH_OPTIONS);
    window.addEventListener("blur", onWindowBlur);
  }
  var isBrowser = typeof window !== "undefined" && typeof document !== "undefined";
  var ua = isBrowser ? navigator.userAgent : "";
  var isIE = /MSIE |Trident\//.test(ua);
  function createMemoryLeakWarning(method) {
    var txt = method === "destroy" ? "n already-" : " ";
    return [method + "() was called on a" + txt + "destroyed instance. This is a no-op but", "indicates a potential memory leak."].join(" ");
  }
  function clean(value) {
    var spacesAndTabs = /[ \t]{2,}/g;
    var lineStartWithSpaces = /^[ \t]*/gm;
    return value.replace(spacesAndTabs, " ").replace(lineStartWithSpaces, "").trim();
  }
  function getDevMessage(message) {
    return clean("\n  %ctippy.js\n\n  %c" + clean(message) + "\n\n  %c\u{1F477}\u200D This is a development-only message. It will be removed in production.\n  ");
  }
  function getFormattedMessage(message) {
    return [
      getDevMessage(message),
      "color: #00C584; font-size: 1.3em; font-weight: bold;",
      "line-height: 1.5",
      "color: #a6a095;"
    ];
  }
  var visitedMessages;
  if (true) {
    resetVisitedMessages();
  }
  function resetVisitedMessages() {
    visitedMessages = new Set();
  }
  function warnWhen(condition, message) {
    if (condition && !visitedMessages.has(message)) {
      var _console;
      visitedMessages.add(message);
      (_console = console).warn.apply(_console, getFormattedMessage(message));
    }
  }
  function errorWhen(condition, message) {
    if (condition && !visitedMessages.has(message)) {
      var _console2;
      visitedMessages.add(message);
      (_console2 = console).error.apply(_console2, getFormattedMessage(message));
    }
  }
  function validateTargets(targets) {
    var didPassFalsyValue = !targets;
    var didPassPlainObject = Object.prototype.toString.call(targets) === "[object Object]" && !targets.addEventListener;
    errorWhen(didPassFalsyValue, ["tippy() was passed", "`" + String(targets) + "`", "as its targets (first) argument. Valid types are: String, Element,", "Element[], or NodeList."].join(" "));
    errorWhen(didPassPlainObject, ["tippy() was passed a plain object which is not supported as an argument", "for virtual positioning. Use props.getReferenceClientRect instead."].join(" "));
  }
  var pluginProps = {
    animateFill: false,
    followCursor: false,
    inlinePositioning: false,
    sticky: false
  };
  var renderProps = {
    allowHTML: false,
    animation: "fade",
    arrow: true,
    content: "",
    inertia: false,
    maxWidth: 350,
    role: "tooltip",
    theme: "",
    zIndex: 9999
  };
  var defaultProps = Object.assign({
    appendTo: function appendTo() {
      return document.body;
    },
    aria: {
      content: "auto",
      expanded: "auto"
    },
    delay: 0,
    duration: [300, 250],
    getReferenceClientRect: null,
    hideOnClick: true,
    ignoreAttributes: false,
    interactive: false,
    interactiveBorder: 2,
    interactiveDebounce: 0,
    moveTransition: "",
    offset: [0, 10],
    onAfterUpdate: function onAfterUpdate() {
    },
    onBeforeUpdate: function onBeforeUpdate() {
    },
    onCreate: function onCreate() {
    },
    onDestroy: function onDestroy() {
    },
    onHidden: function onHidden() {
    },
    onHide: function onHide() {
    },
    onMount: function onMount() {
    },
    onShow: function onShow() {
    },
    onShown: function onShown() {
    },
    onTrigger: function onTrigger() {
    },
    onUntrigger: function onUntrigger() {
    },
    onClickOutside: function onClickOutside() {
    },
    placement: "top",
    plugins: [],
    popperOptions: {},
    render: null,
    showOnCreate: false,
    touch: true,
    trigger: "mouseenter focus",
    triggerTarget: null
  }, pluginProps, {}, renderProps);
  var defaultKeys = Object.keys(defaultProps);
  var setDefaultProps = function setDefaultProps2(partialProps) {
    if (true) {
      validateProps(partialProps, []);
    }
    var keys = Object.keys(partialProps);
    keys.forEach(function(key) {
      defaultProps[key] = partialProps[key];
    });
  };
  function getExtendedPassedProps(passedProps) {
    var plugins = passedProps.plugins || [];
    var pluginProps2 = plugins.reduce(function(acc, plugin) {
      var name = plugin.name, defaultValue = plugin.defaultValue;
      if (name) {
        acc[name] = passedProps[name] !== void 0 ? passedProps[name] : defaultValue;
      }
      return acc;
    }, {});
    return Object.assign({}, passedProps, {}, pluginProps2);
  }
  function getDataAttributeProps(reference, plugins) {
    var propKeys = plugins ? Object.keys(getExtendedPassedProps(Object.assign({}, defaultProps, {
      plugins
    }))) : defaultKeys;
    var props = propKeys.reduce(function(acc, key) {
      var valueAsString = (reference.getAttribute("data-tippy-" + key) || "").trim();
      if (!valueAsString) {
        return acc;
      }
      if (key === "content") {
        acc[key] = valueAsString;
      } else {
        try {
          acc[key] = JSON.parse(valueAsString);
        } catch (e) {
          acc[key] = valueAsString;
        }
      }
      return acc;
    }, {});
    return props;
  }
  function evaluateProps(reference, props) {
    var out = Object.assign({}, props, {
      content: invokeWithArgsOrReturn(props.content, [reference])
    }, props.ignoreAttributes ? {} : getDataAttributeProps(reference, props.plugins));
    out.aria = Object.assign({}, defaultProps.aria, {}, out.aria);
    out.aria = {
      expanded: out.aria.expanded === "auto" ? props.interactive : out.aria.expanded,
      content: out.aria.content === "auto" ? props.interactive ? null : "describedby" : out.aria.content
    };
    return out;
  }
  function validateProps(partialProps, plugins) {
    if (partialProps === void 0) {
      partialProps = {};
    }
    if (plugins === void 0) {
      plugins = [];
    }
    var keys = Object.keys(partialProps);
    keys.forEach(function(prop) {
      var nonPluginProps = removeProperties(defaultProps, Object.keys(pluginProps));
      var didPassUnknownProp = !hasOwnProperty(nonPluginProps, prop);
      if (didPassUnknownProp) {
        didPassUnknownProp = plugins.filter(function(plugin) {
          return plugin.name === prop;
        }).length === 0;
      }
      warnWhen(didPassUnknownProp, ["`" + prop + "`", "is not a valid prop. You may have spelled it incorrectly, or if it's", "a plugin, forgot to pass it in an array as props.plugins.", "\n\n", "All props: https://atomiks.github.io/tippyjs/v6/all-props/\n", "Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "));
    });
  }
  var innerHTML = function innerHTML2() {
    return "innerHTML";
  };
  function dangerouslySetInnerHTML(element, html) {
    element[innerHTML()] = html;
  }
  function createArrowElement(value) {
    var arrow = div();
    if (value === true) {
      arrow.className = ARROW_CLASS;
    } else {
      arrow.className = SVG_ARROW_CLASS;
      if (isElement(value)) {
        arrow.appendChild(value);
      } else {
        dangerouslySetInnerHTML(arrow, value);
      }
    }
    return arrow;
  }
  function setContent(content, props) {
    if (isElement(props.content)) {
      dangerouslySetInnerHTML(content, "");
      content.appendChild(props.content);
    } else if (typeof props.content !== "function") {
      if (props.allowHTML) {
        dangerouslySetInnerHTML(content, props.content);
      } else {
        content.textContent = props.content;
      }
    }
  }
  function getChildren(popper) {
    var box = popper.firstElementChild;
    var boxChildren = arrayFrom(box.children);
    return {
      box,
      content: boxChildren.find(function(node) {
        return node.classList.contains(CONTENT_CLASS);
      }),
      arrow: boxChildren.find(function(node) {
        return node.classList.contains(ARROW_CLASS) || node.classList.contains(SVG_ARROW_CLASS);
      }),
      backdrop: boxChildren.find(function(node) {
        return node.classList.contains(BACKDROP_CLASS);
      })
    };
  }
  function render(instance) {
    var popper = div();
    var box = div();
    box.className = BOX_CLASS;
    box.setAttribute("data-state", "hidden");
    box.setAttribute("tabindex", "-1");
    var content = div();
    content.className = CONTENT_CLASS;
    content.setAttribute("data-state", "hidden");
    setContent(content, instance.props);
    popper.appendChild(box);
    box.appendChild(content);
    onUpdate(instance.props, instance.props);
    function onUpdate(prevProps, nextProps) {
      var _getChildren = getChildren(popper), box2 = _getChildren.box, content2 = _getChildren.content, arrow = _getChildren.arrow;
      if (nextProps.theme) {
        box2.setAttribute("data-theme", nextProps.theme);
      } else {
        box2.removeAttribute("data-theme");
      }
      if (typeof nextProps.animation === "string") {
        box2.setAttribute("data-animation", nextProps.animation);
      } else {
        box2.removeAttribute("data-animation");
      }
      if (nextProps.inertia) {
        box2.setAttribute("data-inertia", "");
      } else {
        box2.removeAttribute("data-inertia");
      }
      box2.style.maxWidth = typeof nextProps.maxWidth === "number" ? nextProps.maxWidth + "px" : nextProps.maxWidth;
      if (nextProps.role) {
        box2.setAttribute("role", nextProps.role);
      } else {
        box2.removeAttribute("role");
      }
      if (prevProps.content !== nextProps.content || prevProps.allowHTML !== nextProps.allowHTML) {
        setContent(content2, instance.props);
      }
      if (nextProps.arrow) {
        if (!arrow) {
          box2.appendChild(createArrowElement(nextProps.arrow));
        } else if (prevProps.arrow !== nextProps.arrow) {
          box2.removeChild(arrow);
          box2.appendChild(createArrowElement(nextProps.arrow));
        }
      } else if (arrow) {
        box2.removeChild(arrow);
      }
    }
    return {
      popper,
      onUpdate
    };
  }
  render.$$tippy = true;
  var idCounter = 1;
  var mouseMoveListeners = [];
  var mountedInstances = [];
  function createTippy(reference, passedProps) {
    var props = evaluateProps(reference, Object.assign({}, defaultProps, {}, getExtendedPassedProps(removeUndefinedProps(passedProps))));
    var showTimeout;
    var hideTimeout;
    var scheduleHideAnimationFrame;
    var isVisibleFromClick = false;
    var didHideDueToDocumentMouseDown = false;
    var didTouchMove = false;
    var ignoreOnFirstUpdate = false;
    var lastTriggerEvent;
    var currentTransitionEndListener;
    var onFirstUpdate;
    var listeners = [];
    var debouncedOnMouseMove = debounce(onMouseMove, props.interactiveDebounce);
    var currentTarget;
    var id = idCounter++;
    var popperInstance = null;
    var plugins = unique(props.plugins);
    var state = {
      isEnabled: true,
      isVisible: false,
      isDestroyed: false,
      isMounted: false,
      isShown: false
    };
    var instance = {
      id,
      reference,
      popper: div(),
      popperInstance,
      props,
      state,
      plugins,
      clearDelayTimeouts,
      setProps,
      setContent: setContent2,
      show,
      hide,
      hideWithInteractivity,
      enable,
      disable,
      unmount,
      destroy
    };
    if (!props.render) {
      if (true) {
        errorWhen(true, "render() function has not been supplied.");
      }
      return instance;
    }
    var _props$render = props.render(instance), popper = _props$render.popper, onUpdate = _props$render.onUpdate;
    popper.setAttribute("data-tippy-root", "");
    popper.id = "tippy-" + instance.id;
    instance.popper = popper;
    reference._tippy = instance;
    popper._tippy = instance;
    var pluginsHooks = plugins.map(function(plugin) {
      return plugin.fn(instance);
    });
    var hasAriaExpanded = reference.hasAttribute("aria-expanded");
    addListeners();
    handleAriaExpandedAttribute();
    handleStyles();
    invokeHook("onCreate", [instance]);
    if (props.showOnCreate) {
      scheduleShow();
    }
    popper.addEventListener("mouseenter", function() {
      if (instance.props.interactive && instance.state.isVisible) {
        instance.clearDelayTimeouts();
      }
    });
    popper.addEventListener("mouseleave", function(event) {
      if (instance.props.interactive && instance.props.trigger.indexOf("mouseenter") >= 0) {
        getDocument().addEventListener("mousemove", debouncedOnMouseMove);
        debouncedOnMouseMove(event);
      }
    });
    return instance;
    function getNormalizedTouchSettings() {
      var touch = instance.props.touch;
      return Array.isArray(touch) ? touch : [touch, 0];
    }
    function getIsCustomTouchBehavior() {
      return getNormalizedTouchSettings()[0] === "hold";
    }
    function getIsDefaultRenderFn() {
      var _instance$props$rende;
      return !!((_instance$props$rende = instance.props.render) == null ? void 0 : _instance$props$rende.$$tippy);
    }
    function getCurrentTarget() {
      return currentTarget || reference;
    }
    function getDocument() {
      var parent = getCurrentTarget().parentNode;
      return parent ? getOwnerDocument(parent) : document;
    }
    function getDefaultTemplateChildren() {
      return getChildren(popper);
    }
    function getDelay(isShow) {
      if (instance.state.isMounted && !instance.state.isVisible || currentInput.isTouch || lastTriggerEvent && lastTriggerEvent.type === "focus") {
        return 0;
      }
      return getValueAtIndexOrReturn(instance.props.delay, isShow ? 0 : 1, defaultProps.delay);
    }
    function handleStyles() {
      popper.style.pointerEvents = instance.props.interactive && instance.state.isVisible ? "" : "none";
      popper.style.zIndex = "" + instance.props.zIndex;
    }
    function invokeHook(hook, args, shouldInvokePropsHook) {
      if (shouldInvokePropsHook === void 0) {
        shouldInvokePropsHook = true;
      }
      pluginsHooks.forEach(function(pluginHooks) {
        if (pluginHooks[hook]) {
          pluginHooks[hook].apply(void 0, args);
        }
      });
      if (shouldInvokePropsHook) {
        var _instance$props;
        (_instance$props = instance.props)[hook].apply(_instance$props, args);
      }
    }
    function handleAriaContentAttribute() {
      var aria = instance.props.aria;
      if (!aria.content) {
        return;
      }
      var attr = "aria-" + aria.content;
      var id2 = popper.id;
      var nodes = normalizeToArray(instance.props.triggerTarget || reference);
      nodes.forEach(function(node) {
        var currentValue = node.getAttribute(attr);
        if (instance.state.isVisible) {
          node.setAttribute(attr, currentValue ? currentValue + " " + id2 : id2);
        } else {
          var nextValue = currentValue && currentValue.replace(id2, "").trim();
          if (nextValue) {
            node.setAttribute(attr, nextValue);
          } else {
            node.removeAttribute(attr);
          }
        }
      });
    }
    function handleAriaExpandedAttribute() {
      if (hasAriaExpanded || !instance.props.aria.expanded) {
        return;
      }
      var nodes = normalizeToArray(instance.props.triggerTarget || reference);
      nodes.forEach(function(node) {
        if (instance.props.interactive) {
          node.setAttribute("aria-expanded", instance.state.isVisible && node === getCurrentTarget() ? "true" : "false");
        } else {
          node.removeAttribute("aria-expanded");
        }
      });
    }
    function cleanupInteractiveMouseListeners() {
      getDocument().removeEventListener("mousemove", debouncedOnMouseMove);
      mouseMoveListeners = mouseMoveListeners.filter(function(listener) {
        return listener !== debouncedOnMouseMove;
      });
    }
    function onDocumentPress(event) {
      if (currentInput.isTouch) {
        if (didTouchMove || event.type === "mousedown") {
          return;
        }
      }
      if (instance.props.interactive && popper.contains(event.target)) {
        return;
      }
      if (getCurrentTarget().contains(event.target)) {
        if (currentInput.isTouch) {
          return;
        }
        if (instance.state.isVisible && instance.props.trigger.indexOf("click") >= 0) {
          return;
        }
      } else {
        invokeHook("onClickOutside", [instance, event]);
      }
      if (instance.props.hideOnClick === true) {
        instance.clearDelayTimeouts();
        instance.hide();
        didHideDueToDocumentMouseDown = true;
        setTimeout(function() {
          didHideDueToDocumentMouseDown = false;
        });
        if (!instance.state.isMounted) {
          removeDocumentPress();
        }
      }
    }
    function onTouchMove() {
      didTouchMove = true;
    }
    function onTouchStart() {
      didTouchMove = false;
    }
    function addDocumentPress() {
      var doc = getDocument();
      doc.addEventListener("mousedown", onDocumentPress, true);
      doc.addEventListener("touchend", onDocumentPress, TOUCH_OPTIONS);
      doc.addEventListener("touchstart", onTouchStart, TOUCH_OPTIONS);
      doc.addEventListener("touchmove", onTouchMove, TOUCH_OPTIONS);
    }
    function removeDocumentPress() {
      var doc = getDocument();
      doc.removeEventListener("mousedown", onDocumentPress, true);
      doc.removeEventListener("touchend", onDocumentPress, TOUCH_OPTIONS);
      doc.removeEventListener("touchstart", onTouchStart, TOUCH_OPTIONS);
      doc.removeEventListener("touchmove", onTouchMove, TOUCH_OPTIONS);
    }
    function onTransitionedOut(duration, callback) {
      onTransitionEnd(duration, function() {
        if (!instance.state.isVisible && popper.parentNode && popper.parentNode.contains(popper)) {
          callback();
        }
      });
    }
    function onTransitionedIn(duration, callback) {
      onTransitionEnd(duration, callback);
    }
    function onTransitionEnd(duration, callback) {
      var box = getDefaultTemplateChildren().box;
      function listener(event) {
        if (event.target === box) {
          updateTransitionEndListener(box, "remove", listener);
          callback();
        }
      }
      if (duration === 0) {
        return callback();
      }
      updateTransitionEndListener(box, "remove", currentTransitionEndListener);
      updateTransitionEndListener(box, "add", listener);
      currentTransitionEndListener = listener;
    }
    function on(eventType, handler, options) {
      if (options === void 0) {
        options = false;
      }
      var nodes = normalizeToArray(instance.props.triggerTarget || reference);
      nodes.forEach(function(node) {
        node.addEventListener(eventType, handler, options);
        listeners.push({
          node,
          eventType,
          handler,
          options
        });
      });
    }
    function addListeners() {
      if (getIsCustomTouchBehavior()) {
        on("touchstart", onTrigger, {
          passive: true
        });
        on("touchend", onMouseLeave, {
          passive: true
        });
      }
      splitBySpaces(instance.props.trigger).forEach(function(eventType) {
        if (eventType === "manual") {
          return;
        }
        on(eventType, onTrigger);
        switch (eventType) {
          case "mouseenter":
            on("mouseleave", onMouseLeave);
            break;
          case "focus":
            on(isIE ? "focusout" : "blur", onBlurOrFocusOut);
            break;
          case "focusin":
            on("focusout", onBlurOrFocusOut);
            break;
        }
      });
    }
    function removeListeners() {
      listeners.forEach(function(_ref) {
        var node = _ref.node, eventType = _ref.eventType, handler = _ref.handler, options = _ref.options;
        node.removeEventListener(eventType, handler, options);
      });
      listeners = [];
    }
    function onTrigger(event) {
      var _lastTriggerEvent;
      var shouldScheduleClickHide = false;
      if (!instance.state.isEnabled || isEventListenerStopped(event) || didHideDueToDocumentMouseDown) {
        return;
      }
      var wasFocused = ((_lastTriggerEvent = lastTriggerEvent) == null ? void 0 : _lastTriggerEvent.type) === "focus";
      lastTriggerEvent = event;
      currentTarget = event.currentTarget;
      handleAriaExpandedAttribute();
      if (!instance.state.isVisible && isMouseEvent(event)) {
        mouseMoveListeners.forEach(function(listener) {
          return listener(event);
        });
      }
      if (event.type === "click" && (instance.props.trigger.indexOf("mouseenter") < 0 || isVisibleFromClick) && instance.props.hideOnClick !== false && instance.state.isVisible) {
        shouldScheduleClickHide = true;
      } else {
        scheduleShow(event);
      }
      if (event.type === "click") {
        isVisibleFromClick = !shouldScheduleClickHide;
      }
      if (shouldScheduleClickHide && !wasFocused) {
        scheduleHide(event);
      }
    }
    function onMouseMove(event) {
      var target = event.target;
      var isCursorOverReferenceOrPopper = getCurrentTarget().contains(target) || popper.contains(target);
      if (event.type === "mousemove" && isCursorOverReferenceOrPopper) {
        return;
      }
      var popperTreeData = getNestedPopperTree().concat(popper).map(function(popper2) {
        var _instance$popperInsta;
        var instance2 = popper2._tippy;
        var state2 = (_instance$popperInsta = instance2.popperInstance) == null ? void 0 : _instance$popperInsta.state;
        if (state2) {
          return {
            popperRect: popper2.getBoundingClientRect(),
            popperState: state2,
            props
          };
        }
        return null;
      }).filter(Boolean);
      if (isCursorOutsideInteractiveBorder(popperTreeData, event)) {
        cleanupInteractiveMouseListeners();
        scheduleHide(event);
      }
    }
    function onMouseLeave(event) {
      var shouldBail = isEventListenerStopped(event) || instance.props.trigger.indexOf("click") >= 0 && isVisibleFromClick;
      if (shouldBail) {
        return;
      }
      if (instance.props.interactive) {
        instance.hideWithInteractivity(event);
        return;
      }
      scheduleHide(event);
    }
    function onBlurOrFocusOut(event) {
      if (instance.props.trigger.indexOf("focusin") < 0 && event.target !== getCurrentTarget()) {
        return;
      }
      if (instance.props.interactive && event.relatedTarget && popper.contains(event.relatedTarget)) {
        return;
      }
      scheduleHide(event);
    }
    function isEventListenerStopped(event) {
      return currentInput.isTouch ? getIsCustomTouchBehavior() !== event.type.indexOf("touch") >= 0 : false;
    }
    function createPopperInstance() {
      destroyPopperInstance();
      var _instance$props2 = instance.props, popperOptions = _instance$props2.popperOptions, placement = _instance$props2.placement, offset = _instance$props2.offset, getReferenceClientRect = _instance$props2.getReferenceClientRect, moveTransition = _instance$props2.moveTransition;
      var arrow = getIsDefaultRenderFn() ? getChildren(popper).arrow : null;
      var computedReference = getReferenceClientRect ? {
        getBoundingClientRect: getReferenceClientRect,
        contextElement: getReferenceClientRect.contextElement || getCurrentTarget()
      } : reference;
      var tippyModifier = {
        name: "$$tippy",
        enabled: true,
        phase: "beforeWrite",
        requires: ["computeStyles"],
        fn: function fn(_ref2) {
          var state2 = _ref2.state;
          if (getIsDefaultRenderFn()) {
            var _getDefaultTemplateCh = getDefaultTemplateChildren(), box = _getDefaultTemplateCh.box;
            ["placement", "reference-hidden", "escaped"].forEach(function(attr) {
              if (attr === "placement") {
                box.setAttribute("data-placement", state2.placement);
              } else {
                if (state2.attributes.popper["data-popper-" + attr]) {
                  box.setAttribute("data-" + attr, "");
                } else {
                  box.removeAttribute("data-" + attr);
                }
              }
            });
            state2.attributes.popper = {};
          }
        }
      };
      var modifiers = [{
        name: "offset",
        options: {
          offset
        }
      }, {
        name: "preventOverflow",
        options: {
          padding: {
            top: 2,
            bottom: 2,
            left: 5,
            right: 5
          }
        }
      }, {
        name: "flip",
        options: {
          padding: 5
        }
      }, {
        name: "computeStyles",
        options: {
          adaptive: !moveTransition
        }
      }, tippyModifier];
      if (getIsDefaultRenderFn() && arrow) {
        modifiers.push({
          name: "arrow",
          options: {
            element: arrow,
            padding: 3
          }
        });
      }
      modifiers.push.apply(modifiers, (popperOptions == null ? void 0 : popperOptions.modifiers) || []);
      instance.popperInstance = core.createPopper(computedReference, popper, Object.assign({}, popperOptions, {
        placement,
        onFirstUpdate,
        modifiers
      }));
    }
    function destroyPopperInstance() {
      if (instance.popperInstance) {
        instance.popperInstance.destroy();
        instance.popperInstance = null;
      }
    }
    function mount() {
      var appendTo = instance.props.appendTo;
      var parentNode;
      var node = getCurrentTarget();
      if (instance.props.interactive && appendTo === defaultProps.appendTo || appendTo === "parent") {
        parentNode = node.parentNode;
      } else {
        parentNode = invokeWithArgsOrReturn(appendTo, [node]);
      }
      if (!parentNode.contains(popper)) {
        parentNode.appendChild(popper);
      }
      createPopperInstance();
      if (true) {
        warnWhen(instance.props.interactive && appendTo === defaultProps.appendTo && node.nextElementSibling !== popper, ["Interactive tippy element may not be accessible via keyboard", "navigation because it is not directly after the reference element", "in the DOM source order.", "\n\n", "Using a wrapper <div> or <span> tag around the reference element", "solves this by creating a new parentNode context.", "\n\n", "Specifying `appendTo: document.body` silences this warning, but it", "assumes you are using a focus management solution to handle", "keyboard navigation.", "\n\n", "See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "));
      }
    }
    function getNestedPopperTree() {
      return arrayFrom(popper.querySelectorAll("[data-tippy-root]"));
    }
    function scheduleShow(event) {
      instance.clearDelayTimeouts();
      if (event) {
        invokeHook("onTrigger", [instance, event]);
      }
      addDocumentPress();
      var delay = getDelay(true);
      var _getNormalizedTouchSe = getNormalizedTouchSettings(), touchValue = _getNormalizedTouchSe[0], touchDelay = _getNormalizedTouchSe[1];
      if (currentInput.isTouch && touchValue === "hold" && touchDelay) {
        delay = touchDelay;
      }
      if (delay) {
        showTimeout = setTimeout(function() {
          instance.show();
        }, delay);
      } else {
        instance.show();
      }
    }
    function scheduleHide(event) {
      instance.clearDelayTimeouts();
      invokeHook("onUntrigger", [instance, event]);
      if (!instance.state.isVisible) {
        removeDocumentPress();
        return;
      }
      if (instance.props.trigger.indexOf("mouseenter") >= 0 && instance.props.trigger.indexOf("click") >= 0 && ["mouseleave", "mousemove"].indexOf(event.type) >= 0 && isVisibleFromClick) {
        return;
      }
      var delay = getDelay(false);
      if (delay) {
        hideTimeout = setTimeout(function() {
          if (instance.state.isVisible) {
            instance.hide();
          }
        }, delay);
      } else {
        scheduleHideAnimationFrame = requestAnimationFrame(function() {
          instance.hide();
        });
      }
    }
    function enable() {
      instance.state.isEnabled = true;
    }
    function disable() {
      instance.hide();
      instance.state.isEnabled = false;
    }
    function clearDelayTimeouts() {
      clearTimeout(showTimeout);
      clearTimeout(hideTimeout);
      cancelAnimationFrame(scheduleHideAnimationFrame);
    }
    function setProps(partialProps) {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("setProps"));
      }
      if (instance.state.isDestroyed) {
        return;
      }
      invokeHook("onBeforeUpdate", [instance, partialProps]);
      removeListeners();
      var prevProps = instance.props;
      var nextProps = evaluateProps(reference, Object.assign({}, instance.props, {}, partialProps, {
        ignoreAttributes: true
      }));
      instance.props = nextProps;
      addListeners();
      if (prevProps.interactiveDebounce !== nextProps.interactiveDebounce) {
        cleanupInteractiveMouseListeners();
        debouncedOnMouseMove = debounce(onMouseMove, nextProps.interactiveDebounce);
      }
      if (prevProps.triggerTarget && !nextProps.triggerTarget) {
        normalizeToArray(prevProps.triggerTarget).forEach(function(node) {
          node.removeAttribute("aria-expanded");
        });
      } else if (nextProps.triggerTarget) {
        reference.removeAttribute("aria-expanded");
      }
      handleAriaExpandedAttribute();
      handleStyles();
      if (onUpdate) {
        onUpdate(prevProps, nextProps);
      }
      if (instance.popperInstance) {
        createPopperInstance();
        getNestedPopperTree().forEach(function(nestedPopper) {
          requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate);
        });
      }
      invokeHook("onAfterUpdate", [instance, partialProps]);
    }
    function setContent2(content) {
      instance.setProps({
        content
      });
    }
    function show() {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("show"));
      }
      var isAlreadyVisible = instance.state.isVisible;
      var isDestroyed = instance.state.isDestroyed;
      var isDisabled = !instance.state.isEnabled;
      var isTouchAndTouchDisabled = currentInput.isTouch && !instance.props.touch;
      var duration = getValueAtIndexOrReturn(instance.props.duration, 0, defaultProps.duration);
      if (isAlreadyVisible || isDestroyed || isDisabled || isTouchAndTouchDisabled) {
        return;
      }
      if (getCurrentTarget().hasAttribute("disabled")) {
        return;
      }
      invokeHook("onShow", [instance], false);
      if (instance.props.onShow(instance) === false) {
        return;
      }
      instance.state.isVisible = true;
      if (getIsDefaultRenderFn()) {
        popper.style.visibility = "visible";
      }
      handleStyles();
      addDocumentPress();
      if (!instance.state.isMounted) {
        popper.style.transition = "none";
      }
      if (getIsDefaultRenderFn()) {
        var _getDefaultTemplateCh2 = getDefaultTemplateChildren(), box = _getDefaultTemplateCh2.box, content = _getDefaultTemplateCh2.content;
        setTransitionDuration([box, content], 0);
      }
      onFirstUpdate = function onFirstUpdate2() {
        var _instance$popperInsta2;
        if (!instance.state.isVisible || ignoreOnFirstUpdate) {
          return;
        }
        ignoreOnFirstUpdate = true;
        void popper.offsetHeight;
        popper.style.transition = instance.props.moveTransition;
        if (getIsDefaultRenderFn() && instance.props.animation) {
          var _getDefaultTemplateCh3 = getDefaultTemplateChildren(), _box = _getDefaultTemplateCh3.box, _content = _getDefaultTemplateCh3.content;
          setTransitionDuration([_box, _content], duration);
          setVisibilityState([_box, _content], "visible");
        }
        handleAriaContentAttribute();
        handleAriaExpandedAttribute();
        pushIfUnique(mountedInstances, instance);
        (_instance$popperInsta2 = instance.popperInstance) == null ? void 0 : _instance$popperInsta2.forceUpdate();
        instance.state.isMounted = true;
        invokeHook("onMount", [instance]);
        if (instance.props.animation && getIsDefaultRenderFn()) {
          onTransitionedIn(duration, function() {
            instance.state.isShown = true;
            invokeHook("onShown", [instance]);
          });
        }
      };
      mount();
    }
    function hide() {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("hide"));
      }
      var isAlreadyHidden = !instance.state.isVisible;
      var isDestroyed = instance.state.isDestroyed;
      var isDisabled = !instance.state.isEnabled;
      var duration = getValueAtIndexOrReturn(instance.props.duration, 1, defaultProps.duration);
      if (isAlreadyHidden || isDestroyed || isDisabled) {
        return;
      }
      invokeHook("onHide", [instance], false);
      if (instance.props.onHide(instance) === false) {
        return;
      }
      instance.state.isVisible = false;
      instance.state.isShown = false;
      ignoreOnFirstUpdate = false;
      isVisibleFromClick = false;
      if (getIsDefaultRenderFn()) {
        popper.style.visibility = "hidden";
      }
      cleanupInteractiveMouseListeners();
      removeDocumentPress();
      handleStyles();
      if (getIsDefaultRenderFn()) {
        var _getDefaultTemplateCh4 = getDefaultTemplateChildren(), box = _getDefaultTemplateCh4.box, content = _getDefaultTemplateCh4.content;
        if (instance.props.animation) {
          setTransitionDuration([box, content], duration);
          setVisibilityState([box, content], "hidden");
        }
      }
      handleAriaContentAttribute();
      handleAriaExpandedAttribute();
      if (instance.props.animation) {
        if (getIsDefaultRenderFn()) {
          onTransitionedOut(duration, instance.unmount);
        }
      } else {
        instance.unmount();
      }
    }
    function hideWithInteractivity(event) {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("hideWithInteractivity"));
      }
      getDocument().addEventListener("mousemove", debouncedOnMouseMove);
      pushIfUnique(mouseMoveListeners, debouncedOnMouseMove);
      debouncedOnMouseMove(event);
    }
    function unmount() {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("unmount"));
      }
      if (instance.state.isVisible) {
        instance.hide();
      }
      if (!instance.state.isMounted) {
        return;
      }
      destroyPopperInstance();
      getNestedPopperTree().forEach(function(nestedPopper) {
        nestedPopper._tippy.unmount();
      });
      if (popper.parentNode) {
        popper.parentNode.removeChild(popper);
      }
      mountedInstances = mountedInstances.filter(function(i) {
        return i !== instance;
      });
      instance.state.isMounted = false;
      invokeHook("onHidden", [instance]);
    }
    function destroy() {
      if (true) {
        warnWhen(instance.state.isDestroyed, createMemoryLeakWarning("destroy"));
      }
      if (instance.state.isDestroyed) {
        return;
      }
      instance.clearDelayTimeouts();
      instance.unmount();
      removeListeners();
      delete reference._tippy;
      instance.state.isDestroyed = true;
      invokeHook("onDestroy", [instance]);
    }
  }
  function tippy2(targets, optionalProps) {
    if (optionalProps === void 0) {
      optionalProps = {};
    }
    var plugins = defaultProps.plugins.concat(optionalProps.plugins || []);
    if (true) {
      validateTargets(targets);
      validateProps(optionalProps, plugins);
    }
    bindGlobalEventListeners();
    var passedProps = Object.assign({}, optionalProps, {
      plugins
    });
    var elements = getArrayOfElements(targets);
    if (true) {
      var isSingleContentElement = isElement(passedProps.content);
      var isMoreThanOneReferenceElement = elements.length > 1;
      warnWhen(isSingleContentElement && isMoreThanOneReferenceElement, ["tippy() was passed an Element as the `content` prop, but more than", "one tippy instance was created by this invocation. This means the", "content element will only be appended to the last tippy instance.", "\n\n", "Instead, pass the .innerHTML of the element, or use a function that", "returns a cloned version of the element instead.", "\n\n", "1) content: element.innerHTML\n", "2) content: () => element.cloneNode(true)"].join(" "));
    }
    var instances = elements.reduce(function(acc, reference) {
      var instance = reference && createTippy(reference, passedProps);
      if (instance) {
        acc.push(instance);
      }
      return acc;
    }, []);
    return isElement(targets) ? instances[0] : instances;
  }
  tippy2.defaultProps = defaultProps;
  tippy2.setDefaultProps = setDefaultProps;
  tippy2.currentInput = currentInput;
  var hideAll = function hideAll2(_temp) {
    var _ref = _temp === void 0 ? {} : _temp, excludedReferenceOrInstance = _ref.exclude, duration = _ref.duration;
    mountedInstances.forEach(function(instance) {
      var isExcluded = false;
      if (excludedReferenceOrInstance) {
        isExcluded = isReferenceElement(excludedReferenceOrInstance) ? instance.reference === excludedReferenceOrInstance : instance.popper === excludedReferenceOrInstance.popper;
      }
      if (!isExcluded) {
        var originalDuration = instance.props.duration;
        instance.setProps({
          duration
        });
        instance.hide();
        if (!instance.state.isDestroyed) {
          instance.setProps({
            duration: originalDuration
          });
        }
      }
    });
  };
  var applyStylesModifier = Object.assign({}, core.applyStyles, {
    effect: function effect(_ref) {
      var state = _ref.state;
      var initialStyles = {
        popper: {
          position: state.options.strategy,
          left: "0",
          top: "0",
          margin: "0"
        },
        arrow: {
          position: "absolute"
        },
        reference: {}
      };
      Object.assign(state.elements.popper.style, initialStyles.popper);
      state.styles = initialStyles;
      if (state.elements.arrow) {
        Object.assign(state.elements.arrow.style, initialStyles.arrow);
      }
    }
  });
  var createSingleton = function createSingleton2(tippyInstances, optionalProps) {
    var _optionalProps$popper;
    if (optionalProps === void 0) {
      optionalProps = {};
    }
    if (true) {
      errorWhen(!Array.isArray(tippyInstances), ["The first argument passed to createSingleton() must be an array of", "tippy instances. The passed value was", String(tippyInstances)].join(" "));
    }
    var individualInstances = tippyInstances;
    var references = [];
    var currentTarget;
    var overrides = optionalProps.overrides;
    var interceptSetPropsCleanups = [];
    var shownOnCreate = false;
    function setReferences() {
      references = individualInstances.map(function(instance) {
        return instance.reference;
      });
    }
    function enableInstances(isEnabled) {
      individualInstances.forEach(function(instance) {
        if (isEnabled) {
          instance.enable();
        } else {
          instance.disable();
        }
      });
    }
    function interceptSetProps(singleton2) {
      return individualInstances.map(function(instance) {
        var originalSetProps2 = instance.setProps;
        instance.setProps = function(props) {
          originalSetProps2(props);
          if (instance.reference === currentTarget) {
            singleton2.setProps(props);
          }
        };
        return function() {
          instance.setProps = originalSetProps2;
        };
      });
    }
    function prepareInstance(singleton2, target) {
      var index = references.indexOf(target);
      if (target === currentTarget) {
        return;
      }
      currentTarget = target;
      var overrideProps = (overrides || []).concat("content").reduce(function(acc, prop) {
        acc[prop] = individualInstances[index].props[prop];
        return acc;
      }, {});
      singleton2.setProps(Object.assign({}, overrideProps, {
        getReferenceClientRect: typeof overrideProps.getReferenceClientRect === "function" ? overrideProps.getReferenceClientRect : function() {
          return target.getBoundingClientRect();
        }
      }));
    }
    enableInstances(false);
    setReferences();
    var plugin = {
      fn: function fn() {
        return {
          onDestroy: function onDestroy() {
            enableInstances(true);
          },
          onHidden: function onHidden() {
            currentTarget = null;
          },
          onClickOutside: function onClickOutside(instance) {
            if (instance.props.showOnCreate && !shownOnCreate) {
              shownOnCreate = true;
              currentTarget = null;
            }
          },
          onShow: function onShow(instance) {
            if (instance.props.showOnCreate && !shownOnCreate) {
              shownOnCreate = true;
              prepareInstance(instance, references[0]);
            }
          },
          onTrigger: function onTrigger(instance, event) {
            prepareInstance(instance, event.currentTarget);
          }
        };
      }
    };
    var singleton = tippy2(div(), Object.assign({}, removeProperties(optionalProps, ["overrides"]), {
      plugins: [plugin].concat(optionalProps.plugins || []),
      triggerTarget: references,
      popperOptions: Object.assign({}, optionalProps.popperOptions, {
        modifiers: [].concat(((_optionalProps$popper = optionalProps.popperOptions) == null ? void 0 : _optionalProps$popper.modifiers) || [], [applyStylesModifier])
      })
    }));
    var originalShow = singleton.show;
    singleton.show = function(target) {
      originalShow();
      if (!currentTarget && target == null) {
        return prepareInstance(singleton, references[0]);
      }
      if (currentTarget && target == null) {
        return;
      }
      if (typeof target === "number") {
        return references[target] && prepareInstance(singleton, references[target]);
      }
      if (individualInstances.includes(target)) {
        var ref = target.reference;
        return prepareInstance(singleton, ref);
      }
      if (references.includes(target)) {
        return prepareInstance(singleton, target);
      }
    };
    singleton.showNext = function() {
      var first = references[0];
      if (!currentTarget) {
        return singleton.show(0);
      }
      var index = references.indexOf(currentTarget);
      singleton.show(references[index + 1] || first);
    };
    singleton.showPrevious = function() {
      var last = references[references.length - 1];
      if (!currentTarget) {
        return singleton.show(last);
      }
      var index = references.indexOf(currentTarget);
      var target = references[index - 1] || last;
      singleton.show(target);
    };
    var originalSetProps = singleton.setProps;
    singleton.setProps = function(props) {
      overrides = props.overrides || overrides;
      originalSetProps(props);
    };
    singleton.setInstances = function(nextInstances) {
      enableInstances(true);
      interceptSetPropsCleanups.forEach(function(fn) {
        return fn();
      });
      individualInstances = nextInstances;
      enableInstances(false);
      setReferences();
      interceptSetProps(singleton);
      singleton.setProps({
        triggerTarget: references
      });
    };
    interceptSetPropsCleanups = interceptSetProps(singleton);
    return singleton;
  };
  var BUBBLING_EVENTS_MAP = {
    mouseover: "mouseenter",
    focusin: "focus",
    click: "click"
  };
  function delegate(targets, props) {
    if (true) {
      errorWhen(!(props && props.target), ["You must specity a `target` prop indicating a CSS selector string matching", "the target elements that should receive a tippy."].join(" "));
    }
    var listeners = [];
    var childTippyInstances = [];
    var disabled = false;
    var target = props.target;
    var nativeProps = removeProperties(props, ["target"]);
    var parentProps = Object.assign({}, nativeProps, {
      trigger: "manual",
      touch: false
    });
    var childProps = Object.assign({}, nativeProps, {
      showOnCreate: true
    });
    var returnValue = tippy2(targets, parentProps);
    var normalizedReturnValue = normalizeToArray(returnValue);
    function onTrigger(event) {
      if (!event.target || disabled) {
        return;
      }
      var targetNode = event.target.closest(target);
      if (!targetNode) {
        return;
      }
      var trigger = targetNode.getAttribute("data-tippy-trigger") || props.trigger || defaultProps.trigger;
      if (targetNode._tippy) {
        return;
      }
      if (event.type === "touchstart" && typeof childProps.touch === "boolean") {
        return;
      }
      if (event.type !== "touchstart" && trigger.indexOf(BUBBLING_EVENTS_MAP[event.type]) < 0) {
        return;
      }
      var instance = tippy2(targetNode, childProps);
      if (instance) {
        childTippyInstances = childTippyInstances.concat(instance);
      }
    }
    function on(node, eventType, handler, options) {
      if (options === void 0) {
        options = false;
      }
      node.addEventListener(eventType, handler, options);
      listeners.push({
        node,
        eventType,
        handler,
        options
      });
    }
    function addEventListeners(instance) {
      var reference = instance.reference;
      on(reference, "touchstart", onTrigger, TOUCH_OPTIONS);
      on(reference, "mouseover", onTrigger);
      on(reference, "focusin", onTrigger);
      on(reference, "click", onTrigger);
    }
    function removeEventListeners() {
      listeners.forEach(function(_ref) {
        var node = _ref.node, eventType = _ref.eventType, handler = _ref.handler, options = _ref.options;
        node.removeEventListener(eventType, handler, options);
      });
      listeners = [];
    }
    function applyMutations(instance) {
      var originalDestroy = instance.destroy;
      var originalEnable = instance.enable;
      var originalDisable = instance.disable;
      instance.destroy = function(shouldDestroyChildInstances) {
        if (shouldDestroyChildInstances === void 0) {
          shouldDestroyChildInstances = true;
        }
        if (shouldDestroyChildInstances) {
          childTippyInstances.forEach(function(instance2) {
            instance2.destroy();
          });
        }
        childTippyInstances = [];
        removeEventListeners();
        originalDestroy();
      };
      instance.enable = function() {
        originalEnable();
        childTippyInstances.forEach(function(instance2) {
          return instance2.enable();
        });
        disabled = false;
      };
      instance.disable = function() {
        originalDisable();
        childTippyInstances.forEach(function(instance2) {
          return instance2.disable();
        });
        disabled = true;
      };
      addEventListeners(instance);
    }
    normalizedReturnValue.forEach(applyMutations);
    return returnValue;
  }
  var animateFill = {
    name: "animateFill",
    defaultValue: false,
    fn: function fn(instance) {
      var _instance$props$rende;
      if (!((_instance$props$rende = instance.props.render) == null ? void 0 : _instance$props$rende.$$tippy)) {
        if (true) {
          errorWhen(instance.props.animateFill, "The `animateFill` plugin requires the default render function.");
        }
        return {};
      }
      var _getChildren = getChildren(instance.popper), box = _getChildren.box, content = _getChildren.content;
      var backdrop = instance.props.animateFill ? createBackdropElement() : null;
      return {
        onCreate: function onCreate() {
          if (backdrop) {
            box.insertBefore(backdrop, box.firstElementChild);
            box.setAttribute("data-animatefill", "");
            box.style.overflow = "hidden";
            instance.setProps({
              arrow: false,
              animation: "shift-away"
            });
          }
        },
        onMount: function onMount() {
          if (backdrop) {
            var transitionDuration = box.style.transitionDuration;
            var duration = Number(transitionDuration.replace("ms", ""));
            content.style.transitionDelay = Math.round(duration / 10) + "ms";
            backdrop.style.transitionDuration = transitionDuration;
            setVisibilityState([backdrop], "visible");
          }
        },
        onShow: function onShow() {
          if (backdrop) {
            backdrop.style.transitionDuration = "0ms";
          }
        },
        onHide: function onHide() {
          if (backdrop) {
            setVisibilityState([backdrop], "hidden");
          }
        }
      };
    }
  };
  function createBackdropElement() {
    var backdrop = div();
    backdrop.className = BACKDROP_CLASS;
    setVisibilityState([backdrop], "hidden");
    return backdrop;
  }
  var mouseCoords = {
    clientX: 0,
    clientY: 0
  };
  var activeInstances = [];
  function storeMouseCoords(_ref) {
    var clientX = _ref.clientX, clientY = _ref.clientY;
    mouseCoords = {
      clientX,
      clientY
    };
  }
  function addMouseCoordsListener(doc) {
    doc.addEventListener("mousemove", storeMouseCoords);
  }
  function removeMouseCoordsListener(doc) {
    doc.removeEventListener("mousemove", storeMouseCoords);
  }
  var followCursor2 = {
    name: "followCursor",
    defaultValue: false,
    fn: function fn(instance) {
      var reference = instance.reference;
      var doc = getOwnerDocument(instance.props.triggerTarget || reference);
      var isInternalUpdate = false;
      var wasFocusEvent = false;
      var isUnmounted = true;
      var prevProps = instance.props;
      function getIsInitialBehavior() {
        return instance.props.followCursor === "initial" && instance.state.isVisible;
      }
      function addListener() {
        doc.addEventListener("mousemove", onMouseMove);
      }
      function removeListener() {
        doc.removeEventListener("mousemove", onMouseMove);
      }
      function unsetGetReferenceClientRect() {
        isInternalUpdate = true;
        instance.setProps({
          getReferenceClientRect: null
        });
        isInternalUpdate = false;
      }
      function onMouseMove(event) {
        var isCursorOverReference = event.target ? reference.contains(event.target) : true;
        var followCursor3 = instance.props.followCursor;
        var clientX = event.clientX, clientY = event.clientY;
        var rect = reference.getBoundingClientRect();
        var relativeX = clientX - rect.left;
        var relativeY = clientY - rect.top;
        if (isCursorOverReference || !instance.props.interactive) {
          instance.setProps({
            getReferenceClientRect: function getReferenceClientRect() {
              var rect2 = reference.getBoundingClientRect();
              var x = clientX;
              var y = clientY;
              if (followCursor3 === "initial") {
                x = rect2.left + relativeX;
                y = rect2.top + relativeY;
              }
              var top = followCursor3 === "horizontal" ? rect2.top : y;
              var right = followCursor3 === "vertical" ? rect2.right : x;
              var bottom = followCursor3 === "horizontal" ? rect2.bottom : y;
              var left = followCursor3 === "vertical" ? rect2.left : x;
              return {
                width: right - left,
                height: bottom - top,
                top,
                right,
                bottom,
                left
              };
            }
          });
        }
      }
      function create() {
        if (instance.props.followCursor) {
          activeInstances.push({
            instance,
            doc
          });
          addMouseCoordsListener(doc);
        }
      }
      function destroy() {
        activeInstances = activeInstances.filter(function(data) {
          return data.instance !== instance;
        });
        if (activeInstances.filter(function(data) {
          return data.doc === doc;
        }).length === 0) {
          removeMouseCoordsListener(doc);
        }
      }
      return {
        onCreate: create,
        onDestroy: destroy,
        onBeforeUpdate: function onBeforeUpdate() {
          prevProps = instance.props;
        },
        onAfterUpdate: function onAfterUpdate(_, _ref2) {
          var followCursor3 = _ref2.followCursor;
          if (isInternalUpdate) {
            return;
          }
          if (followCursor3 !== void 0 && prevProps.followCursor !== followCursor3) {
            destroy();
            if (followCursor3) {
              create();
              if (instance.state.isMounted && !wasFocusEvent && !getIsInitialBehavior()) {
                addListener();
              }
            } else {
              removeListener();
              unsetGetReferenceClientRect();
            }
          }
        },
        onMount: function onMount() {
          if (instance.props.followCursor && !wasFocusEvent) {
            if (isUnmounted) {
              onMouseMove(mouseCoords);
              isUnmounted = false;
            }
            if (!getIsInitialBehavior()) {
              addListener();
            }
          }
        },
        onTrigger: function onTrigger(_, event) {
          if (isMouseEvent(event)) {
            mouseCoords = {
              clientX: event.clientX,
              clientY: event.clientY
            };
          }
          wasFocusEvent = event.type === "focus";
        },
        onHidden: function onHidden() {
          if (instance.props.followCursor) {
            unsetGetReferenceClientRect();
            removeListener();
            isUnmounted = true;
          }
        }
      };
    }
  };
  function getProps(props, modifier) {
    var _props$popperOptions;
    return {
      popperOptions: Object.assign({}, props.popperOptions, {
        modifiers: [].concat((((_props$popperOptions = props.popperOptions) == null ? void 0 : _props$popperOptions.modifiers) || []).filter(function(_ref) {
          var name = _ref.name;
          return name !== modifier.name;
        }), [modifier])
      })
    };
  }
  var inlinePositioning = {
    name: "inlinePositioning",
    defaultValue: false,
    fn: function fn(instance) {
      var reference = instance.reference;
      function isEnabled() {
        return !!instance.props.inlinePositioning;
      }
      var placement;
      var cursorRectIndex = -1;
      var isInternalUpdate = false;
      var modifier = {
        name: "tippyInlinePositioning",
        enabled: true,
        phase: "afterWrite",
        fn: function fn2(_ref2) {
          var state = _ref2.state;
          if (isEnabled()) {
            if (placement !== state.placement) {
              instance.setProps({
                getReferenceClientRect: function getReferenceClientRect() {
                  return _getReferenceClientRect(state.placement);
                }
              });
            }
            placement = state.placement;
          }
        }
      };
      function _getReferenceClientRect(placement2) {
        return getInlineBoundingClientRect(getBasePlacement(placement2), reference.getBoundingClientRect(), arrayFrom(reference.getClientRects()), cursorRectIndex);
      }
      function setInternalProps(partialProps) {
        isInternalUpdate = true;
        instance.setProps(partialProps);
        isInternalUpdate = false;
      }
      function addModifier() {
        if (!isInternalUpdate) {
          setInternalProps(getProps(instance.props, modifier));
        }
      }
      return {
        onCreate: addModifier,
        onAfterUpdate: addModifier,
        onTrigger: function onTrigger(_, event) {
          if (isMouseEvent(event)) {
            var rects = arrayFrom(instance.reference.getClientRects());
            var cursorRect = rects.find(function(rect) {
              return rect.left - 2 <= event.clientX && rect.right + 2 >= event.clientX && rect.top - 2 <= event.clientY && rect.bottom + 2 >= event.clientY;
            });
            cursorRectIndex = rects.indexOf(cursorRect);
          }
        },
        onUntrigger: function onUntrigger() {
          cursorRectIndex = -1;
        }
      };
    }
  };
  function getInlineBoundingClientRect(currentBasePlacement, boundingRect, clientRects, cursorRectIndex) {
    if (clientRects.length < 2 || currentBasePlacement === null) {
      return boundingRect;
    }
    if (clientRects.length === 2 && cursorRectIndex >= 0 && clientRects[0].left > clientRects[1].right) {
      return clientRects[cursorRectIndex] || boundingRect;
    }
    switch (currentBasePlacement) {
      case "top":
      case "bottom": {
        var firstRect = clientRects[0];
        var lastRect = clientRects[clientRects.length - 1];
        var isTop = currentBasePlacement === "top";
        var top = firstRect.top;
        var bottom = lastRect.bottom;
        var left = isTop ? firstRect.left : lastRect.left;
        var right = isTop ? firstRect.right : lastRect.right;
        var width = right - left;
        var height = bottom - top;
        return {
          top,
          bottom,
          left,
          right,
          width,
          height
        };
      }
      case "left":
      case "right": {
        var minLeft = Math.min.apply(Math, clientRects.map(function(rects) {
          return rects.left;
        }));
        var maxRight = Math.max.apply(Math, clientRects.map(function(rects) {
          return rects.right;
        }));
        var measureRects = clientRects.filter(function(rect) {
          return currentBasePlacement === "left" ? rect.left === minLeft : rect.right === maxRight;
        });
        var _top = measureRects[0].top;
        var _bottom = measureRects[measureRects.length - 1].bottom;
        var _left = minLeft;
        var _right = maxRight;
        var _width = _right - _left;
        var _height = _bottom - _top;
        return {
          top: _top,
          bottom: _bottom,
          left: _left,
          right: _right,
          width: _width,
          height: _height
        };
      }
      default: {
        return boundingRect;
      }
    }
  }
  var sticky = {
    name: "sticky",
    defaultValue: false,
    fn: function fn(instance) {
      var reference = instance.reference, popper = instance.popper;
      function getReference() {
        return instance.popperInstance ? instance.popperInstance.state.elements.reference : reference;
      }
      function shouldCheck(value) {
        return instance.props.sticky === true || instance.props.sticky === value;
      }
      var prevRefRect = null;
      var prevPopRect = null;
      function updatePosition() {
        var currentRefRect = shouldCheck("reference") ? getReference().getBoundingClientRect() : null;
        var currentPopRect = shouldCheck("popper") ? popper.getBoundingClientRect() : null;
        if (currentRefRect && areRectsDifferent(prevRefRect, currentRefRect) || currentPopRect && areRectsDifferent(prevPopRect, currentPopRect)) {
          if (instance.popperInstance) {
            instance.popperInstance.update();
          }
        }
        prevRefRect = currentRefRect;
        prevPopRect = currentPopRect;
        if (instance.state.isMounted) {
          requestAnimationFrame(updatePosition);
        }
      }
      return {
        onMount: function onMount() {
          if (instance.props.sticky) {
            updatePosition();
          }
        }
      };
    }
  };
  function areRectsDifferent(rectA, rectB) {
    if (rectA && rectB) {
      return rectA.top !== rectB.top || rectA.right !== rectB.right || rectA.bottom !== rectB.bottom || rectA.left !== rectB.left;
    }
    return true;
  }
  tippy2.setDefaultProps({
    render
  });
  exports.animateFill = animateFill;
  exports.createSingleton = createSingleton;
  exports.default = tippy2;
  exports.delegate = delegate;
  exports.followCursor = followCursor2;
  exports.hideAll = hideAll;
  exports.inlinePositioning = inlinePositioning;
  exports.roundArrow = ROUND_ARROW;
  exports.sticky = sticky;
});

// src/index.js
var import_tippy2 = __toModule(require_tippy_cjs());

// src/buildConfigFromModifiers.js
var import_tippy = __toModule(require_tippy_cjs());
var buildConfigFromModifiers = (modifiers) => {
  const config = {
    plugins: []
  };
  const getModifierArgument = (modifier) => {
    return modifiers[modifiers.indexOf(modifier) + 1];
  };
  if (modifiers.includes("animation")) {
    config.animation = getModifierArgument("animation");
  }
  if (modifiers.includes("duration")) {
    config.duration = parseInt(getModifierArgument("duration"));
  }
  if (modifiers.includes("delay")) {
    const delay = getModifierArgument("delay");
    config.delay = delay.includes("-") ? delay.split("-").map((n) => parseInt(n)) : parseInt(delay);
  }
  if (modifiers.includes("cursor")) {
    config.plugins.push(import_tippy.followCursor);
    const next = getModifierArgument("cursor");
    if (["x", "initial"].includes(next)) {
      config.followCursor = next === "x" ? "horizontal" : "initial";
    } else {
      config.followCursor = true;
    }
  }
  if (modifiers.includes("on")) {
    config.trigger = getModifierArgument("on");
  }
  if (modifiers.includes("arrowless")) {
    config.arrow = false;
  }
  if (modifiers.includes("html")) {
    config.allowHTML = true;
  }
  if (modifiers.includes("interactive")) {
    config.interactive = true;
  }
  if (modifiers.includes("border") && config.interactive) {
    config.interactiveBorder = parseInt(getModifierArgument("border"));
  }
  if (modifiers.includes("debounce") && config.interactive) {
    config.interactiveDebounce = parseInt(getModifierArgument("debounce"));
  }
  if (modifiers.includes("max-width")) {
    config.maxWidth = parseInt(getModifierArgument("max-width"));
  }
  if (modifiers.includes("theme")) {
    config.theme = getModifierArgument("theme");
  }
  if (modifiers.includes("placement")) {
    config.placement = getModifierArgument("placement");
  }
  return config;
};

// src/index.js
function src_default(Alpine) {
  Alpine.magic("tooltip", (el) => {
    return (content, config = {}) => {
      const instance = (0, import_tippy2.default)(el, {
        content,
        trigger: "manual",
        ...config
      });
      instance.show();
      setTimeout(() => {
        instance.hide();
        setTimeout(() => instance.destroy(), config.duration || 300);
      }, config.timeout || 2e3);
    };
  });
  Alpine.directive("tooltip", (el, {modifiers, expression}, {evaluateLater, effect}) => {
    const config = modifiers.length > 0 ? buildConfigFromModifiers(modifiers) : {};
    if (!el.__x_tippy) {
      el.__x_tippy = (0, import_tippy2.default)(el, config);
    }
    const enableTooltip = () => el.__x_tippy.enable();
    const disableTooltip = () => el.__x_tippy.disable();
    const setupTooltip = (content) => {
      if (!content) {
        disableTooltip();
      } else {
        enableTooltip();
        el.__x_tippy.setContent(content);
      }
    };
    if (modifiers.includes("raw")) {
      setupTooltip(expression);
    } else {
      const getContent = evaluateLater(expression);
      effect(() => {
        getContent((content) => {
          if (typeof content === "object") {
            el.__x_tippy.setProps(content);
            enableTooltip();
          } else {
            setupTooltip(content);
          }
        });
      });
    }
  });
}

// builds/module.js
var module_default = src_default;



/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = __webpack_modules__;
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/amd options */
/******/ 	(() => {
/******/ 		__webpack_require__.amdO = {};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/chunk loaded */
/******/ 	(() => {
/******/ 		var deferred = [];
/******/ 		__webpack_require__.O = (result, chunkIds, fn, priority) => {
/******/ 			if(chunkIds) {
/******/ 				priority = priority || 0;
/******/ 				for(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];
/******/ 				deferred[i] = [chunkIds, fn, priority];
/******/ 				return;
/******/ 			}
/******/ 			var notFulfilled = Infinity;
/******/ 			for (var i = 0; i < deferred.length; i++) {
/******/ 				var [chunkIds, fn, priority] = deferred[i];
/******/ 				var fulfilled = true;
/******/ 				for (var j = 0; j < chunkIds.length; j++) {
/******/ 					if ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {
/******/ 						chunkIds.splice(j--, 1);
/******/ 					} else {
/******/ 						fulfilled = false;
/******/ 						if(priority < notFulfilled) notFulfilled = priority;
/******/ 					}
/******/ 				}
/******/ 				if(fulfilled) {
/******/ 					deferred.splice(i--, 1)
/******/ 					var r = fn();
/******/ 					if (r !== undefined) result = r;
/******/ 				}
/******/ 			}
/******/ 			return result;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/jsonp chunk loading */
/******/ 	(() => {
/******/ 		// no baseURI
/******/ 		
/******/ 		// object to store loaded and loading chunks
/******/ 		// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 		// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded
/******/ 		var installedChunks = {
/******/ 			"/js/shopper": 0,
/******/ 			"css/shopper": 0
/******/ 		};
/******/ 		
/******/ 		// no chunk on demand loading
/******/ 		
/******/ 		// no prefetching
/******/ 		
/******/ 		// no preloaded
/******/ 		
/******/ 		// no HMR
/******/ 		
/******/ 		// no HMR manifest
/******/ 		
/******/ 		__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);
/******/ 		
/******/ 		// install a JSONP callback for chunk loading
/******/ 		var webpackJsonpCallback = (parentChunkLoadingFunction, data) => {
/******/ 			var [chunkIds, moreModules, runtime] = data;
/******/ 			// add "moreModules" to the modules object,
/******/ 			// then flag all "chunkIds" as loaded and fire callback
/******/ 			var moduleId, chunkId, i = 0;
/******/ 			if(chunkIds.some((id) => (installedChunks[id] !== 0))) {
/******/ 				for(moduleId in moreModules) {
/******/ 					if(__webpack_require__.o(moreModules, moduleId)) {
/******/ 						__webpack_require__.m[moduleId] = moreModules[moduleId];
/******/ 					}
/******/ 				}
/******/ 				if(runtime) var result = runtime(__webpack_require__);
/******/ 			}
/******/ 			if(parentChunkLoadingFunction) parentChunkLoadingFunction(data);
/******/ 			for(;i < chunkIds.length; i++) {
/******/ 				chunkId = chunkIds[i];
/******/ 				if(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {
/******/ 					installedChunks[chunkId][0]();
/******/ 				}
/******/ 				installedChunks[chunkIds[i]] = 0;
/******/ 			}
/******/ 			return __webpack_require__.O(result);
/******/ 		}
/******/ 		
/******/ 		var chunkLoadingGlobal = self["webpackChunk"] = self["webpackChunk"] || [];
/******/ 		chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));
/******/ 		chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module depends on other loaded chunks and execution need to be delayed
/******/ 	__webpack_require__.O(undefined, ["css/shopper"], () => (__webpack_require__("./resources/js/shopper.js")))
/******/ 	var __webpack_exports__ = __webpack_require__.O(undefined, ["css/shopper"], () => (__webpack_require__("./resources/css/shopper.css")))
/******/ 	__webpack_exports__ = __webpack_require__.O(__webpack_exports__);
/******/ 	
/******/ })()
;